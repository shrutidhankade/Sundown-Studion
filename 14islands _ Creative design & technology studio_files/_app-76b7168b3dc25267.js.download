(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2888],{2843:function(e,t,i){"use strict";i.d(t,{do:function(){return $}});var r,n,a,s=[],o="ResizeObserver loop completed with undelivered notifications.",l=function(){var e;"function"==typeof ErrorEvent?e=new ErrorEvent("error",{message:o}):((e=document.createEvent("Event")).initEvent("error",!1,!1),e.message=o),window.dispatchEvent(e)};(r=n||(n={})).BORDER_BOX="border-box",r.CONTENT_BOX="content-box",r.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box";var u=function(e){return Object.freeze(e)},c=function(e,t){this.inlineSize=e,this.blockSize=t,u(this)},d=function(){function e(e,t,i,r){return this.x=e,this.y=t,this.width=i,this.height=r,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,u(this)}return e.prototype.toJSON=function(){return{x:this.x,y:this.y,top:this.top,right:this.right,bottom:this.bottom,left:this.left,width:this.width,height:this.height}},e.fromRect=function(t){return new e(t.x,t.y,t.width,t.height)},e}(),h=function(e){return e instanceof SVGElement&&"getBBox"in e},f=function(e){if(h(e)){var t=e.getBBox(),i=t.width,r=t.height;return!i&&!r}var n=e.offsetWidth,a=e.offsetHeight;return!(n||a||e.getClientRects().length)},p=function(e){if(e instanceof Element)return!0;var t,i=null===(t=null==e?void 0:e.ownerDocument)||void 0===t?void 0:t.defaultView;return!!(i&&e instanceof i.Element)},m=function(e){switch(e.tagName){case"INPUT":if("image"!==e.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1},g="undefined"!=typeof window?window:{},v=new WeakMap,y=/auto|scroll/,b=/^tb|vertical/,_=/msie|trident/i.test(g.navigator&&g.navigator.userAgent),E=function(e){return parseFloat(e||"0")},S=function(e,t,i){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===i&&(i=!1),new c((i?t:e)||0,(i?e:t)||0)},x=u({devicePixelContentBoxSize:S(),borderBoxSize:S(),contentBoxSize:S(),contentRect:new d(0,0,0,0)}),T=function(e,t){if(void 0===t&&(t=!1),v.has(e)&&!t)return v.get(e);if(f(e))return v.set(e,x),x;var i=getComputedStyle(e),r=h(e)&&e.ownerSVGElement&&e.getBBox(),n=!_&&"border-box"===i.boxSizing,a=b.test(i.writingMode||""),s=!r&&y.test(i.overflowY||""),o=!r&&y.test(i.overflowX||""),l=r?0:E(i.paddingTop),c=r?0:E(i.paddingRight),p=r?0:E(i.paddingBottom),m=r?0:E(i.paddingLeft),g=r?0:E(i.borderTopWidth),T=r?0:E(i.borderRightWidth),w=r?0:E(i.borderBottomWidth),A=r?0:E(i.borderLeftWidth),M=m+c,R=l+p,C=A+T,I=g+w,L=o?e.offsetHeight-I-e.clientHeight:0,k=s?e.offsetWidth-C-e.clientWidth:0,D=r?r.width:E(i.width)-(n?M+C:0)-k,P=r?r.height:E(i.height)-(n?R+I:0)-L,O=D+M+k+C,N=P+R+L+I,U=u({devicePixelContentBoxSize:S(Math.round(D*devicePixelRatio),Math.round(P*devicePixelRatio),a),borderBoxSize:S(O,N,a),contentBoxSize:S(D,P,a),contentRect:new d(m,l,D,P)});return v.set(e,U),U},w=function(e,t,i){var r=T(e,i),a=r.borderBoxSize,s=r.contentBoxSize,o=r.devicePixelContentBoxSize;switch(t){case n.DEVICE_PIXEL_CONTENT_BOX:return o;case n.BORDER_BOX:return a;default:return s}},A=function(e){var t=T(e);this.target=e,this.contentRect=t.contentRect,this.borderBoxSize=u([t.borderBoxSize]),this.contentBoxSize=u([t.contentBoxSize]),this.devicePixelContentBoxSize=u([t.devicePixelContentBoxSize])},M=function(e){if(f(e))return 1/0;for(var t=0,i=e.parentNode;i;)t+=1,i=i.parentNode;return t},R=function(){var e=1/0,t=[];s.forEach(function(i){if(0!==i.activeTargets.length){var r=[];i.activeTargets.forEach(function(t){var i=new A(t.target),n=M(t.target);r.push(i),t.lastReportedSize=w(t.target,t.observedBox),n<e&&(e=n)}),t.push(function(){i.callback.call(i.observer,r,i.observer)}),i.activeTargets.splice(0,i.activeTargets.length)}});for(var i=0;i<t.length;i++)(0,t[i])();return e},C=function(e){s.forEach(function(t){t.activeTargets.splice(0,t.activeTargets.length),t.skippedTargets.splice(0,t.skippedTargets.length),t.observationTargets.forEach(function(i){i.isActive()&&(M(i.target)>e?t.activeTargets.push(i):t.skippedTargets.push(i))})})},I=function(){var e=0;for(C(0);s.some(function(e){return e.activeTargets.length>0});)C(e=R());return s.some(function(e){return e.skippedTargets.length>0})&&l(),e>0},L=[],k=function(e){if(!a){var t=0,i=document.createTextNode("");new MutationObserver(function(){return L.splice(0).forEach(function(e){return e()})}).observe(i,{characterData:!0}),a=function(){i.textContent="".concat(t?t--:t++)}}L.push(e),a()},D=function(e){k(function(){requestAnimationFrame(e)})},P=0,O={attributes:!0,characterData:!0,childList:!0,subtree:!0},N=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],U=function(e){return void 0===e&&(e=0),Date.now()+e},F=!1,B=new(function(){function e(){var e=this;this.stopped=!0,this.listener=function(){return e.schedule()}}return e.prototype.run=function(e){var t=this;if(void 0===e&&(e=250),!F){F=!0;var i=U(e);D(function(){var r=!1;try{r=I()}finally{if(F=!1,e=i-U(),!P)return;r?t.run(1e3):e>0?t.run(e):t.start()}})}},e.prototype.schedule=function(){this.stop(),this.run()},e.prototype.observe=function(){var e=this,t=function(){return e.observer&&e.observer.observe(document.body,O)};document.body?t():g.addEventListener("DOMContentLoaded",t)},e.prototype.start=function(){var e=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),N.forEach(function(t){return g.addEventListener(t,e.listener,!0)}))},e.prototype.stop=function(){var e=this;this.stopped||(this.observer&&this.observer.disconnect(),N.forEach(function(t){return g.removeEventListener(t,e.listener,!0)}),this.stopped=!0)},e}()),V=function(e){!P&&e>0&&B.start(),(P+=e)||B.stop()},z=function(){function e(e,t){this.target=e,this.observedBox=t||n.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return e.prototype.isActive=function(){var e,t=w(this.target,this.observedBox,!0);return h(e=this.target)||m(e)||"inline"!==getComputedStyle(e).display||(this.lastReportedSize=t),this.lastReportedSize.inlineSize!==t.inlineSize||this.lastReportedSize.blockSize!==t.blockSize},e}(),j=function(e,t){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=e,this.callback=t},H=new WeakMap,G=function(e,t){for(var i=0;i<e.length;i+=1)if(e[i].target===t)return i;return -1},W=function(){function e(){}return e.connect=function(e,t){var i=new j(e,t);H.set(e,i)},e.observe=function(e,t,i){var r=H.get(e),n=0===r.observationTargets.length;0>G(r.observationTargets,t)&&(n&&s.push(r),r.observationTargets.push(new z(t,i&&i.box)),V(1),B.schedule())},e.unobserve=function(e,t){var i=H.get(e),r=G(i.observationTargets,t),n=1===i.observationTargets.length;r>=0&&(n&&s.splice(s.indexOf(i),1),i.observationTargets.splice(r,1),V(-1))},e.disconnect=function(e){var t=this,i=H.get(e);i.observationTargets.slice().forEach(function(i){return t.unobserve(e,i.target)}),i.activeTargets.splice(0,i.activeTargets.length)},e}(),$=function(){function e(e){if(0==arguments.length)throw TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof e)throw TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");W.connect(this,e)}return e.prototype.observe=function(e,t){if(0==arguments.length)throw TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!p(e))throw TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");W.observe(this,e,t)},e.prototype.unobserve=function(e){if(0==arguments.length)throw TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!p(e))throw TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");W.unobserve(this,e)},e.prototype.disconnect=function(){W.disconnect(this)},e.toString=function(){return"function ResizeObserver () { [polyfill code] }"},e}()},58684:function(e,t,i){"use strict";i.d(t,{g:function(){return n}});var r=i(19095);function n(e,t,i,n){let a=class extends r.ShaderMaterial{constructor(a={}){let s=Object.entries(e);super({uniforms:s.reduce((e,[t,i])=>{let n=r.UniformsUtils.clone({[t]:{value:i}});return{...e,...n}},{}),vertexShader:t,fragmentShader:i}),this.key="",s.forEach(([e])=>Object.defineProperty(this,e,{get:()=>this.uniforms[e].value,set:t=>this.uniforms[e].value=t})),Object.assign(this,a),n&&n(this)}};return a.key=r.MathUtils.generateUUID(),a}},77733:function(e,t,i){"use strict";i.d(t,{R:function(){return s}});var r=i(50959),n=i(19095),a=i(13214);function s(e,t,i){let s=(0,a.z)(e=>e.size),o=(0,a.z)(e=>e.viewport),l="number"==typeof e?e:s.width*o.dpr,u="number"==typeof t?t:s.height*o.dpr,c=("number"==typeof e?i:e)||{},{samples:d=0,depth:h,...f}=c,p=r.useMemo(()=>{let e=new n.WebGLRenderTarget(l,u,{minFilter:n.LinearFilter,magFilter:n.LinearFilter,type:n.HalfFloatType,...f});return h&&(e.depthTexture=new n.DepthTexture(l,u,n.FloatType)),e.samples=d,e},[]);return r.useLayoutEffect(()=>{p.setSize(l,u),d&&(p.samples=d)},[d,p,l,u]),r.useEffect(()=>()=>p.dispose(),[]),p}},29324:function(e,t,i){"use strict";i.d(t,{m:function(){return o}});var r=i(19095),n=i(13214),a=i(50959);let s=e=>e===Object(e)&&!Array.isArray(e)&&"function"!=typeof e;function o(e,t){let i=(0,n.z)(e=>e.gl),o=(0,n.D)(r.TextureLoader,s(e)?Object.values(e):e);if((0,a.useLayoutEffect)(()=>{null==t||t(o)},[t]),(0,a.useEffect)(()=>{let e=Array.isArray(o)?o:[o];e.forEach(i.initTexture)},[i,o]),!s(e))return o;{let t=Object.keys(e),i={};return t.forEach(e=>Object.assign(i,{[e]:o[t.indexOf(e)]})),i}}o.preload=e=>n.D.preload(r.TextureLoader,e),o.clear=e=>n.D.clear(r.TextureLoader,e)},13214:function(e,t,i){"use strict";let r,n,a;i.d(t,{A:function(){return eo},B:function(){return T},D:function(){return eu},E:function(){return w},a:function(){return S},b:function(){return ev},c:function(){return G},d:function(){return eb},e:function(){return v},g:function(){return e_},i:function(){return E},j:function(){return ep},l:function(){return ed},n:function(){return Q},o:function(){return ee},p:function(){return et},u:function(){return x},z:function(){return es}});var s,o,l=i(19095),u=i(50959),c=i(85259),d=i(31171),h=i(97427),f=i.n(h),p=i(65297),m=i(97367);let g={},v=e=>void Object.assign(g,e),y=e=>"colorSpace"in e||"outputColorSpace"in e,b=()=>{var e;return null!=(e=g.ColorManagement)?e:null},_=e=>e&&e.isOrthographicCamera,E=e=>e&&e.hasOwnProperty("current"),S="undefined"!=typeof window&&(null!=(s=window.document)&&s.createElement||(null==(o=window.navigator)?void 0:o.product)==="ReactNative")?u.useLayoutEffect:u.useEffect;function x(e){let t=u.useRef(e);return S(()=>void(t.current=e),[e]),t}function T({set:e}){return S(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class w extends u.Component{constructor(...e){super(...e),this.state={error:!1}}componentDidCatch(e){this.props.set(e)}render(){return this.state.error?null:this.props.children}}w.getDerivedStateFromError=()=>({error:!0});let A="__default",M=new Map,R=e=>e&&!!e.memoized&&!!e.changes;function C(e){var t;let i="undefined"!=typeof window?null!=(t=window.devicePixelRatio)?t:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],i),e[1]):e}let I=e=>{var t;return null==(t=e.__r3f)?void 0:t.root.getState()},L={obj:e=>e===Object(e)&&!L.arr(e)&&"function"!=typeof e,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,boo:e=>"boolean"==typeof e,und:e=>void 0===e,arr:e=>Array.isArray(e),equ(e,t,{arrays:i="shallow",objects:r="reference",strict:n=!0}={}){let a;if(typeof e!=typeof t||!!e!=!!t)return!1;if(L.str(e)||L.num(e))return e===t;let s=L.obj(e);if(s&&"reference"===r)return e===t;let o=L.arr(e);if(o&&"reference"===i)return e===t;if((o||s)&&e===t)return!0;for(a in e)if(!(a in t))return!1;if(s&&"shallow"===i&&"shallow"===r){for(a in n?t:e)if(!L.equ(e[a],t[a],{strict:n,objects:"reference"}))return!1}else for(a in n?t:e)if(e[a]!==t[a])return!1;if(L.und(a)){if(o&&0===e.length&&0===t.length||s&&0===Object.keys(e).length&&0===Object.keys(t).length)return!0;if(e!==t)return!1}return!0}};function k(e,t){return e.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...t},e}function D(e,t){let i=e;if(!t.includes("-"))return{target:i,key:t};{let r=t.split("-"),n=r.pop();return{target:i=r.reduce((e,t)=>e[t],e),key:n}}}let P=/-\d+$/;function O(e,t,i){if(L.str(i)){if(P.test(i)){let t=i.replace(P,""),{target:r,key:n}=D(e,t);Array.isArray(r[n])||(r[n]=[])}let{target:r,key:n}=D(e,i);t.__r3f.previousAttach=r[n],r[n]=t}else t.__r3f.previousAttach=i(e,t)}function N(e,t,i){var r,n;if(L.str(i)){let{target:r,key:n}=D(e,i),a=t.__r3f.previousAttach;void 0===a?delete r[n]:r[n]=a}else null==(r=t.__r3f)||null==r.previousAttach||r.previousAttach(e,t);null==(n=t.__r3f)||delete n.previousAttach}function U(e,{children:t,key:i,ref:r,...n},{children:a,key:s,ref:o,...l}={},u=!1){var c;let d=null!=(c=null==e?void 0:e.__r3f)?c:{},h=Object.entries(n),f=[];if(u){let e=Object.keys(l);for(let t=0;t<e.length;t++)n.hasOwnProperty(e[t])||h.unshift([e[t],A+"remove"])}h.forEach(([t,i])=>{var r;if(null!=(r=e.__r3f)&&r.primitive&&"object"===t||L.equ(i,l[t]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(t))return f.push([t,i,!0,[]]);let a=[];for(let e in t.includes("-")&&(a=t.split("-")),f.push([t,i,!1,a]),n){let i=n[e];e.startsWith(`${t}-`)&&f.push([e,i,!1,e.split("-")])}});let p={...n};return d.memoizedProps&&d.memoizedProps.args&&(p.args=d.memoizedProps.args),d.memoizedProps&&d.memoizedProps.attach&&(p.attach=d.memoizedProps.attach),{memoized:p,changes:f}}function F(e,t){var i,r,n;let a=null!=(i=e.__r3f)?i:{},s=a.root,o=null!=(r=null==s?void 0:null==s.getState?void 0:s.getState())?r:{},{memoized:u,changes:c}=R(t)?t:U(e,t),d=a.eventCount;e.__r3f&&(e.__r3f.memoizedProps=u);for(let t=0;t<c.length;t++){let[i,r,n,s]=c[t];if(y(e)){let e="srgb",t="srgb-linear";"encoding"===i?(i="colorSpace",r=3001===r?e:t):"outputEncoding"===i&&(i="outputColorSpace",r=3001===r?e:t)}let u=e,d=u[i];if(s.length&&!((d=s.reduce((e,t)=>e[t],e))&&d.set)){let[t,...r]=s.reverse();u=r.reverse().reduce((e,t)=>e[t],e),i=t}if(r===A+"remove"){if(u.constructor){let e=M.get(u.constructor);e||(e=new u.constructor,M.set(u.constructor,e)),r=e[i]}else r=0}if(n)r?a.handlers[i]=r:delete a.handlers[i],a.eventCount=Object.keys(a.handlers).length;else if(d&&d.set&&(d.copy||d instanceof l.Layers)){if(Array.isArray(r))d.fromArray?d.fromArray(r):d.set(...r);else if(d.copy&&r&&r.constructor&&d.constructor===r.constructor)d.copy(r);else if(void 0!==r){let e=d instanceof l.Color;!e&&d.setScalar?d.setScalar(r):d instanceof l.Layers&&r instanceof l.Layers?d.mask=r.mask:d.set(r),b()||o.linear||!e||d.convertSRGBToLinear()}}else if(u[i]=r,u[i]instanceof l.Texture&&u[i].format===l.RGBAFormat&&u[i].type===l.UnsignedByteType){let e=u[i];y(e)&&y(o.gl)?e.colorSpace=o.gl.outputColorSpace:e.encoding=o.gl.outputEncoding}B(e)}if(a.parent&&o.internal&&e.raycast&&d!==a.eventCount){let t=o.internal.interaction.indexOf(e);t>-1&&o.internal.interaction.splice(t,1),a.eventCount&&o.internal.interaction.push(e)}let h=1===c.length&&"onUpdate"===c[0][0];return!h&&c.length&&null!=(n=e.__r3f)&&n.parent&&V(e),e}function B(e){var t,i;let r=null==(t=e.__r3f)?void 0:null==(i=t.root)?void 0:null==i.getState?void 0:i.getState();r&&0===r.internal.frames&&r.invalidate()}function V(e){null==e.onUpdate||e.onUpdate(e)}function z(e,t){e.manual||(_(e)?(e.left=-(t.width/2),e.right=t.width/2,e.top=t.height/2,e.bottom=-(t.height/2)):e.aspect=t.width/t.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function j(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function H(e,t,i,r){let n=i.get(t);n&&(i.delete(t),0===i.size&&(e.delete(r),n.target.releasePointerCapture(r)))}function G(e){function t(e){return e.filter(e=>["Move","Over","Enter","Out","Leave"].some(t=>{var i;return null==(i=e.__r3f)?void 0:i.handlers["onPointer"+t]}))}function i(t){let{internal:i}=e.getState();for(let e of i.hovered.values())if(!t.length||!t.find(t=>t.object===e.object&&t.index===e.index&&t.instanceId===e.instanceId)){let r=e.eventObject,n=r.__r3f,a=null==n?void 0:n.handlers;if(i.hovered.delete(j(e)),null!=n&&n.eventCount){let i={...e,intersections:t};null==a.onPointerOut||a.onPointerOut(i),null==a.onPointerLeave||a.onPointerLeave(i)}}}function r(e,t){for(let i=0;i<t.length;i++){let r=t[i].__r3f;null==r||null==r.handlers.onPointerMissed||r.handlers.onPointerMissed(e)}}return{handlePointer:function(n){switch(n){case"onPointerLeave":case"onPointerCancel":return()=>i([]);case"onLostPointerCapture":return t=>{let{internal:r}=e.getState();"pointerId"in t&&r.capturedMap.has(t.pointerId)&&requestAnimationFrame(()=>{r.capturedMap.has(t.pointerId)&&(r.capturedMap.delete(t.pointerId),i([]))})}}return function(a){let{onPointerMissed:s,internal:o}=e.getState();o.lastEvent.current=a;let u="onPointerMove"===n,c="onClick"===n||"onContextMenu"===n||"onDoubleClick"===n,d=function(t,i){let r=e.getState(),n=new Set,a=[],s=i?i(r.internal.interaction):r.internal.interaction;for(let e=0;e<s.length;e++){let t=I(s[e]);t&&(t.raycaster.camera=void 0)}r.previousRoot||null==r.events.compute||r.events.compute(t,r);let o=s.flatMap(function(e){let i=I(e);if(!i||!i.events.enabled||null===i.raycaster.camera)return[];if(void 0===i.raycaster.camera){var r;null==i.events.compute||i.events.compute(t,i,null==(r=i.previousRoot)?void 0:r.getState()),void 0===i.raycaster.camera&&(i.raycaster.camera=null)}return i.raycaster.camera?i.raycaster.intersectObject(e,!0):[]}).sort((e,t)=>{let i=I(e.object),r=I(t.object);return i&&r&&r.events.priority-i.events.priority||e.distance-t.distance}).filter(e=>{let t=j(e);return!n.has(t)&&(n.add(t),!0)});for(let e of(r.events.filter&&(o=r.events.filter(o,r)),o)){let t=e.object;for(;t;){var l;null!=(l=t.__r3f)&&l.eventCount&&a.push({...e,eventObject:t}),t=t.parent}}if("pointerId"in t&&r.internal.capturedMap.has(t.pointerId))for(let e of r.internal.capturedMap.get(t.pointerId).values())n.has(j(e.intersection))||a.push(e.intersection);return a}(a,u?t:void 0),h=c?function(t){let{internal:i}=e.getState(),r=t.offsetX-i.initialClick[0],n=t.offsetY-i.initialClick[1];return Math.round(Math.sqrt(r*r+n*n))}(a):0;"onPointerDown"===n&&(o.initialClick=[a.offsetX,a.offsetY],o.initialHits=d.map(e=>e.eventObject)),c&&!d.length&&h<=2&&(r(a,o.interaction),s&&s(a)),u&&i(d),function(t,r,n,a){let s=e.getState();if(t.length){let e={stopped:!1};for(let o of t){let u=I(o.object)||s,{raycaster:c,pointer:d,camera:h,internal:f}=u,p=new l.Vector3(d.x,d.y,0).unproject(h),m=e=>{var t,i;return null!=(t=null==(i=f.capturedMap.get(e))?void 0:i.has(o.eventObject))&&t},g=e=>{let t={intersection:o,target:r.target};f.capturedMap.has(e)?f.capturedMap.get(e).set(o.eventObject,t):f.capturedMap.set(e,new Map([[o.eventObject,t]])),r.target.setPointerCapture(e)},v=e=>{let t=f.capturedMap.get(e);t&&H(f.capturedMap,o.eventObject,t,e)},y={};for(let e in r){let t=r[e];"function"!=typeof t&&(y[e]=t)}let b={...o,...y,pointer:d,intersections:t,stopped:e.stopped,delta:n,unprojectedPoint:p,ray:c.ray,camera:h,stopPropagation(){let n="pointerId"in r&&f.capturedMap.get(r.pointerId);if((!n||n.has(o.eventObject))&&(b.stopped=e.stopped=!0,f.hovered.size&&Array.from(f.hovered.values()).find(e=>e.eventObject===o.eventObject))){let e=t.slice(0,t.indexOf(o));i([...e,o])}},target:{hasPointerCapture:m,setPointerCapture:g,releasePointerCapture:v},currentTarget:{hasPointerCapture:m,setPointerCapture:g,releasePointerCapture:v},nativeEvent:r};if(a(b),!0===e.stopped)break}}}(d,a,h,function(e){let t=e.eventObject,i=t.__r3f,s=null==i?void 0:i.handlers;if(null!=i&&i.eventCount){if(u){if(s.onPointerOver||s.onPointerEnter||s.onPointerOut||s.onPointerLeave){let t=j(e),i=o.hovered.get(t);i?i.stopped&&e.stopPropagation():(o.hovered.set(t,e),null==s.onPointerOver||s.onPointerOver(e),null==s.onPointerEnter||s.onPointerEnter(e))}null==s.onPointerMove||s.onPointerMove(e)}else{let i=s[n];i?(!c||o.initialHits.includes(t))&&(r(a,o.interaction.filter(e=>!o.initialHits.includes(e))),i(e)):c&&o.initialHits.includes(t)&&r(a,o.interaction.filter(e=>!o.initialHits.includes(e)))}}})}}}}let W=["set","get","setSize","setFrameloop","setDpr","events","invalidate","advance","size","viewport"],$=e=>!!(null!=e&&e.render),q=u.createContext(null),Y=(e,t)=>{let i=(0,d.Z)((i,r)=>{let n;let a=new l.Vector3,s=new l.Vector3,o=new l.Vector3;function c(e=r().camera,t=s,i=r().size){let{width:n,height:u,top:c,left:d}=i,h=n/u;t instanceof l.Vector3?o.copy(t):o.set(...t);let f=e.getWorldPosition(a).distanceTo(o);if(_(e))return{width:n/e.zoom,height:u/e.zoom,top:c,left:d,factor:1,distance:f,aspect:h};{let t=e.fov*Math.PI/180,i=2*Math.tan(t/2)*f,r=i*(n/u);return{width:r,height:i,top:c,left:d,factor:n/r,distance:f,aspect:h}}}let d=e=>i(t=>({performance:{...t.performance,current:e}})),h=new l.Vector2,f={set:i,get:r,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(t=1)=>e(r(),t),advance:(e,i)=>t(e,i,r()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new l.Clock,pointer:h,mouse:h,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{let e=r();n&&clearTimeout(n),e.performance.current!==e.performance.min&&d(e.performance.min),n=setTimeout(()=>d(r().performance.max),e.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:c},setEvents:e=>i(t=>({...t,events:{...t.events,...e}})),setSize:(e,t,n,a,o)=>{let l=r().camera,u={width:e,height:t,top:a||0,left:o||0,updateStyle:n};i(e=>({size:u,viewport:{...e.viewport,...c(l,s,u)}}))},setDpr:e=>i(t=>{let i=C(e);return{viewport:{...t.viewport,dpr:i,initialDpr:t.viewport.initialDpr||i}}}),setFrameloop:(e="always")=>{let t=r().clock;t.stop(),t.elapsedTime=0,"never"!==e&&(t.start(),t.elapsedTime=0),i(()=>({frameloop:e}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:u.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(e,t,i)=>{let n=r().internal;return n.priority=n.priority+(t>0?1:0),n.subscribers.push({ref:e,priority:t,store:i}),n.subscribers=n.subscribers.sort((e,t)=>e.priority-t.priority),()=>{let i=r().internal;null!=i&&i.subscribers&&(i.priority=i.priority-(t>0?1:0),i.subscribers=i.subscribers.filter(t=>t.ref!==e))}}}};return f}),r=i.getState(),n=r.size,a=r.viewport.dpr,s=r.camera;return i.subscribe(()=>{let{camera:e,size:t,viewport:r,gl:o,set:l}=i.getState();if(t!==n||r.dpr!==a){var u;n=t,a=r.dpr,z(e,t),o.setPixelRatio(r.dpr);let i=null!=(u=t.updateStyle)?u:"undefined"!=typeof HTMLCanvasElement&&o.domElement instanceof HTMLCanvasElement;o.setSize(t.width,t.height,i)}e!==s&&(s=e,l(t=>({viewport:{...t.viewport,...t.viewport.getCurrentViewport(e)}})))}),i.subscribe(t=>e(t)),i};function K(e,t){let i={callback:e};return t.add(i),()=>void t.delete(i)}let X=new Set,Z=new Set,J=new Set,Q=e=>K(e,X),ee=e=>K(e,Z),et=e=>K(e,J);function ei(e,t){if(e.size)for(let{callback:i}of e.values())i(t)}function er(e,t){switch(e){case"before":return ei(X,t);case"after":return ei(Z,t);case"tail":return ei(J,t)}}function en(e,t,i){let s=t.clock.getDelta();for("never"===t.frameloop&&"number"==typeof e&&(s=e-t.clock.elapsedTime,t.clock.oldTime=t.clock.elapsedTime,t.clock.elapsedTime=e),n=t.internal.subscribers,r=0;r<n.length;r++)(a=n[r]).ref.current(a.store.getState(),s,i);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function ea(){let e=u.useContext(q);if(!e)throw Error("R3F: Hooks can only be used within the Canvas component!");return e}function es(e=e=>e,t){return ea()(e,t)}function eo(e,t=0){let i=ea(),r=i.getState().internal.subscribe,n=x(e);return S(()=>r(n,t,i),[t,r,i]),null}function el(e,t){return function(i,...r){let n=new i;return e&&e(n),Promise.all(r.map(e=>new Promise((i,r)=>n.load(e,e=>{e.scene&&Object.assign(e,function(e){let t={nodes:{},materials:{}};return e&&e.traverse(e=>{e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)}),t}(e.scene)),i(e)},t,t=>r(Error(`Could not load ${e}: ${t.message}`))))))}}function eu(e,t,i,r){let n=Array.isArray(t)?t:[t],a=(0,m.Rq)(el(i,r),[e,...n],{equal:L.equ});return Array.isArray(t)?a:a[0]}eu.preload=function(e,t,i){let r=Array.isArray(t)?t:[t];return(0,m.MA)(el(i),[e,...r])},eu.clear=function(e,t){let i=Array.isArray(t)?t:[t];return(0,m.ZH)([e,...i])};let ec=new Map,{invalidate:ed,advance:eh}=function(e){let t,i,r,n=!1;function a(s){for(let l of(i=requestAnimationFrame(a),n=!0,t=0,er("before",s),e.values())){var o;(r=l.store.getState()).internal.active&&("always"===r.frameloop||r.internal.frames>0)&&!(null!=(o=r.gl.xr)&&o.isPresenting)&&(t+=en(s,r))}if(er("after",s),0===t)return er("tail",s),n=!1,cancelAnimationFrame(i)}return{loop:a,invalidate:function t(i,r=1){var s;if(!i)return e.forEach(e=>t(e.store.getState()),r);null!=(s=i.gl.xr)&&s.isPresenting||!i.internal.active||"never"===i.frameloop||(i.internal.frames=Math.min(60,i.internal.frames+r),n||(n=!0,requestAnimationFrame(a)))},advance:function(t,i=!0,r,n){if(i&&er("before",t),r)en(t,r,n);else for(let i of e.values())en(t,i.store.getState());i&&er("after",t)}}}(ec),{reconciler:ef,applyProps:ep}=function(e,t){function i(e,{args:t=[],attach:i,...r},n){let a,s=`${e[0].toUpperCase()}${e.slice(1)}`;if("primitive"===e){if(void 0===r.object)throw Error("R3F: Primitives without 'object' are invalid!");let t=r.object;a=k(t,{type:e,root:n,attach:i,primitive:!0})}else{let r=g[s];if(!r)throw Error(`R3F: ${s} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(t))throw Error("R3F: The args prop must be an array!");a=k(new r(...t),{type:e,root:n,attach:i,memoizedProps:{args:t}})}return void 0===a.__r3f.attach&&(a instanceof l.BufferGeometry?a.__r3f.attach="geometry":a instanceof l.Material&&(a.__r3f.attach="material")),"inject"!==s&&F(a,r),a}function r(e,t){let i=!1;if(t){var r,n;null!=(r=t.__r3f)&&r.attach?O(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.add(t),i=!0),i||null==(n=e.__r3f)||n.objects.push(t),t.__r3f||k(t,{}),t.__r3f.parent=e,V(t),B(t)}}function n(e,t,i){let r=!1;if(t){var n,a;if(null!=(n=t.__r3f)&&n.attach)O(e,t,t.__r3f.attach);else if(t.isObject3D&&e.isObject3D){t.parent=e,t.dispatchEvent({type:"added"});let n=e.children.filter(e=>e!==t),a=n.indexOf(i);e.children=[...n.slice(0,a),t,...n.slice(a)],r=!0}r||null==(a=e.__r3f)||a.objects.push(t),t.__r3f||k(t,{}),t.__r3f.parent=e,V(t),B(t)}}function a(e,t,i=!1){e&&[...e].forEach(e=>s(t,e,i))}function s(e,t,i){if(t){var r,n,s,o,l;t.__r3f&&(t.__r3f.parent=null),null!=(r=e.__r3f)&&r.objects&&(e.__r3f.objects=e.__r3f.objects.filter(e=>e!==t)),null!=(n=t.__r3f)&&n.attach?N(e,t,t.__r3f.attach):t.isObject3D&&e.isObject3D&&(e.remove(t),null!=(o=t.__r3f)&&o.root&&function(e,t){let{internal:i}=e.getState();i.interaction=i.interaction.filter(e=>e!==t),i.initialHits=i.initialHits.filter(e=>e!==t),i.hovered.forEach((e,r)=>{(e.eventObject===t||e.object===t)&&i.hovered.delete(r)}),i.capturedMap.forEach((e,r)=>{H(i.capturedMap,t,e,r)})}(t.__r3f.root,t));let u=null==(s=t.__r3f)?void 0:s.primitive,c=void 0===i?null!==t.dispose&&!u:i;u||(a(null==(l=t.__r3f)?void 0:l.objects,t,c),a(t.children,t,c)),delete t.__r3f,c&&t.dispose&&"Scene"!==t.type&&(0,p.unstable_scheduleCallback)(p.unstable_IdlePriority,()=>{try{t.dispose()}catch(e){}}),B(e)}}let o=()=>console.warn("Text is not allowed in the R3F tree! This could be stray whitespace or characters."),u=f()({createInstance:i,removeChild:s,appendChild:r,appendInitialChild:r,insertBefore:n,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(e,t)=>{if(!t)return;let i=e.getState().scene;i.__r3f&&(i.__r3f.root=e,r(i,t))},removeChildFromContainer:(e,t)=>{t&&s(e.getState().scene,t)},insertInContainerBefore:(e,t,i)=>{if(!t||!i)return;let r=e.getState().scene;r.__r3f&&n(r,t,i)},getRootHostContext:()=>null,getChildHostContext:e=>e,finalizeInitialChildren(e){var t;let i=null!=(t=null==e?void 0:e.__r3f)?t:{};return!!i.handlers},prepareUpdate(e,t,i,r){var n;let a=null!=(n=null==e?void 0:e.__r3f)?n:{};if(a.primitive&&r.object&&r.object!==e)return[!0];{let{args:t=[],children:n,...a}=r,{args:s=[],children:o,...l}=i;if(!Array.isArray(t))throw Error("R3F: the args prop must be an array!");if(t.some((e,t)=>e!==s[t]))return[!0];let u=U(e,a,l,!0);return u.changes.length?[!1,u]:null}},commitUpdate(e,[t,n],a,o,l,u){t?function(e,t,n,a){var o;let l=null==(o=e.__r3f)?void 0:o.parent;if(!l)return;let u=i(t,n,e.__r3f.root);if(e.children){for(let t of e.children)t.__r3f&&r(u,t);e.children=e.children.filter(e=>!e.__r3f)}if(e.__r3f.objects.forEach(e=>r(u,e)),e.__r3f.objects=[],e.__r3f.autoRemovedBeforeAppend||s(l,e),u.parent&&(u.__r3f.autoRemovedBeforeAppend=!0),r(l,u),u.raycast&&u.__r3f.eventCount){let e=u.__r3f.root.getState();e.internal.interaction.push(u)}[a,a.alternate].forEach(e=>{null!==e&&(e.stateNode=u,e.ref&&("function"==typeof e.ref?e.ref(u):e.ref.current=u))})}(e,a,l,u):F(e,n)},commitMount(e,t,i,r){var n;let a=null!=(n=e.__r3f)?n:{};e.raycast&&a.handlers&&a.eventCount&&e.__r3f.root.getState().internal.interaction.push(e)},getPublicInstance:e=>e,prepareForCommit:()=>null,preparePortalMount:e=>k(e.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(e){var t;let{attach:i,parent:r}=null!=(t=e.__r3f)?t:{};i&&r&&N(r,e,i),e.isObject3D&&(e.visible=!1),B(e)},unhideInstance(e,t){var i;let{attach:r,parent:n}=null!=(i=e.__r3f)?i:{};r&&n&&O(n,e,r),(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0),B(e)},createTextInstance:o,hideTextInstance:o,unhideTextInstance:o,getCurrentEventPriority:()=>t?t():c.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:"undefined"!=typeof performance&&L.fun(performance.now)?performance.now:L.fun(Date.now)?Date.now:()=>0,scheduleTimeout:L.fun(setTimeout)?setTimeout:void 0,cancelTimeout:L.fun(clearTimeout)?clearTimeout:void 0});return{reconciler:u,applyProps:F}}(0,function(){var e;let t="undefined"!=typeof self&&self||"undefined"!=typeof window&&window;if(!t)return c.DefaultEventPriority;let i=null==(e=t.event)?void 0:e.type;switch(i){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return c.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return c.ContinuousEventPriority;default:return c.DefaultEventPriority}}),em={objects:"shallow",strict:!1},eg=(e,t)=>{let i="function"==typeof e?e(t):e;return $(i)?i:new l.WebGLRenderer({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0,...e})};function ev(e){let t,i;let r=ec.get(e),n=null==r?void 0:r.fiber,a=null==r?void 0:r.store;r&&console.warn("R3F.createRoot should only be called once!");let s="function"==typeof reportError?reportError:console.error,o=a||Y(ed,eh),d=n||ef.createContainer(o,c.ConcurrentRoot,null,!1,null,"",s,null);r||ec.set(e,{fiber:d,store:o});let h=!1;return{configure(r={}){var n,a;let{gl:s,size:u,scene:c,events:d,onCreated:f,shadows:p=!1,linear:m=!1,flat:g=!1,legacy:v=!1,orthographic:y=!1,frameloop:_="always",dpr:E=[1,2],performance:S,raycaster:x,camera:T,onPointerMissed:w}=r,A=o.getState(),M=A.gl;A.gl||A.set({gl:M=eg(s,e)});let R=A.raycaster;R||A.set({raycaster:R=new l.Raycaster});let{params:I,...D}=x||{};if(L.equ(D,R,em)||ep(R,{...D}),L.equ(I,R.params,em)||ep(R,{params:{...R.params,...I}}),!A.camera||A.camera===i&&!L.equ(i,T,em)){i=T;let e=T instanceof l.Camera,t=e?T:y?new l.OrthographicCamera(0,0,0,0,.1,1e3):new l.PerspectiveCamera(75,0,.1,1e3);e||(t.position.z=5,T&&ep(t,T),A.camera||null!=T&&T.rotation||t.lookAt(0,0,0)),A.set({camera:t})}if(!A.scene){let e;c instanceof l.Scene?e=c:(e=new l.Scene,c&&ep(e,c)),A.set({scene:k(e)})}if(!A.xr){let e=(e,t)=>{let i=o.getState();"never"!==i.frameloop&&eh(e,!0,i,t)},t=()=>{let t=o.getState();t.gl.xr.enabled=t.gl.xr.isPresenting,t.gl.xr.setAnimationLoop(t.gl.xr.isPresenting?e:null),t.gl.xr.isPresenting||ed(t)},i={connect(){let e=o.getState().gl;e.xr.addEventListener("sessionstart",t),e.xr.addEventListener("sessionend",t)},disconnect(){let e=o.getState().gl;e.xr.removeEventListener("sessionstart",t),e.xr.removeEventListener("sessionend",t)}};"function"==typeof(null==(n=M.xr)?void 0:n.addEventListener)&&i.connect(),A.set({xr:i})}if(M.shadowMap){let e=M.shadowMap.enabled,t=M.shadowMap.type;if(M.shadowMap.enabled=!!p,L.boo(p))M.shadowMap.type=l.PCFSoftShadowMap;else if(L.str(p)){let e={basic:l.BasicShadowMap,percentage:l.PCFShadowMap,soft:l.PCFSoftShadowMap,variance:l.VSMShadowMap};M.shadowMap.type=null!=(a=e[p])?a:l.PCFSoftShadowMap}else L.obj(p)&&Object.assign(M.shadowMap,p);(e!==M.shadowMap.enabled||t!==M.shadowMap.type)&&(M.shadowMap.needsUpdate=!0)}let P=b();P&&("enabled"in P?P.enabled=!v:"legacyMode"in P&&(P.legacyMode=v)),ep(M,{outputEncoding:m?3e3:3001,toneMapping:g?l.NoToneMapping:l.ACESFilmicToneMapping}),A.legacy!==v&&A.set(()=>({legacy:v})),A.linear!==m&&A.set(()=>({linear:m})),A.flat!==g&&A.set(()=>({flat:g})),!s||L.fun(s)||$(s)||L.equ(s,M,em)||ep(M,s),d&&!A.events.handlers&&A.set({events:d(o)});let O=function(e,t){if(t)return t;if("undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement&&e.parentElement){let{width:t,height:i,top:r,left:n}=e.parentElement.getBoundingClientRect();return{width:t,height:i,top:r,left:n}}return"undefined"!=typeof OffscreenCanvas&&e instanceof OffscreenCanvas?{width:e.width,height:e.height,top:0,left:0}:{width:0,height:0,top:0,left:0}}(e,u);return L.equ(O,A.size,em)||A.setSize(O.width,O.height,O.updateStyle,O.top,O.left),E&&A.viewport.dpr!==C(E)&&A.setDpr(E),A.frameloop!==_&&A.setFrameloop(_),A.onPointerMissed||A.set({onPointerMissed:w}),S&&!L.equ(S,A.performance,em)&&A.set(e=>({performance:{...e.performance,...S}})),t=f,h=!0,this},render(i){return h||this.configure(),ef.updateContainer(u.createElement(ey,{store:o,children:i,onCreated:t,rootElement:e}),d,null,()=>void 0),o},unmount(){eb(e)}}}function ey({store:e,children:t,onCreated:i,rootElement:r}){return S(()=>{let t=e.getState();t.set(e=>({internal:{...e.internal,active:!0}})),i&&i(t),e.getState().events.connected||null==t.events.connect||t.events.connect(r)},[]),u.createElement(q.Provider,{value:e},t)}function eb(e,t){let i=ec.get(e),r=null==i?void 0:i.fiber;if(r){let n=null==i?void 0:i.store.getState();n&&(n.internal.active=!1),ef.updateContainer(null,r,null,()=>{n&&setTimeout(()=>{try{var i,r,a,s;null==n.events.disconnect||n.events.disconnect(),null==(i=n.gl)||null==(r=i.renderLists)||null==r.dispose||r.dispose(),null==(a=n.gl)||null==a.forceContextLoss||a.forceContextLoss(),null!=(s=n.gl)&&s.xr&&n.xr.disconnect(),function(e){for(let t in e.dispose&&"Scene"!==e.type&&e.dispose(),e)null==t.dispose||t.dispose(),delete e[t]}(n),ec.delete(e),t&&t(e)}catch(e){}},500)})}}function e_(e,t,i){return u.createElement(eE,{key:t.uuid,children:e,container:t,state:i})}function eE({state:e={},children:t,container:i}){let{events:r,size:n,...a}=e,s=ea(),[o]=u.useState(()=>new l.Raycaster),[c]=u.useState(()=>new l.Vector2),h=u.useCallback((e,t)=>{let u;let d={...e};if(Object.keys(e).forEach(i=>{(W.includes(i)||e[i]!==t[i]&&t[i])&&delete d[i]}),t&&n){let i=t.camera;u=e.viewport.getCurrentViewport(i,new l.Vector3,n),i!==e.camera&&z(i,n)}return{...d,scene:i,raycaster:o,pointer:c,mouse:c,previousRoot:s,events:{...e.events,...null==t?void 0:t.events,...r},size:{...e.size,...n},viewport:{...e.viewport,...u},...a}},[e]),[f]=u.useState(()=>{let e=s.getState(),t=(0,d.Z)((t,l)=>({...e,scene:i,raycaster:o,pointer:c,mouse:c,previousRoot:s,events:{...e.events,...r},size:{...e.size,...n},...a,set:t,get:l,setEvents:e=>t(t=>({...t,events:{...t.events,...e}}))}));return t});return u.useEffect(()=>{let e=s.subscribe(e=>f.setState(t=>h(e,t)));return()=>{e(),f.destroy()}},[]),u.useEffect(()=>{f.setState(e=>h(s.getState(),e))},[h]),u.createElement(u.Fragment,null,ef.createPortal(u.createElement(q.Provider,{value:f},t),f,null))}ef.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:u.version}),u.unstable_act},50796:function(e,t,i){"use strict";i.d(t,{Xz:function(){return R}});var r=i(13214),n=i(28957),a=i(50959),s=i(19095),o=i(31110),l=i.n(o);let u=["x","y","top","bottom","left","right","width","height"],c=(e,t)=>u.every(i=>e[i]===t[i]);var d=Object.defineProperty,h=Object.defineProperties,f=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,m=Object.prototype.hasOwnProperty,g=Object.prototype.propertyIsEnumerable,v=(e,t,i)=>t in e?d(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,y=(e,t)=>{for(var i in t||(t={}))m.call(t,i)&&v(e,i,t[i]);if(p)for(var i of p(t))g.call(t,i)&&v(e,i,t[i]);return e},b=(e,t)=>h(e,f(t));function _(e){try{return Object.defineProperties(e,{_currentRenderer:{get:()=>null,set(){}},_currentRenderer2:{get:()=>null,set(){}}})}catch(t){return e}}let E=_(a.createContext(null));class S extends a.Component{render(){return a.createElement(E.Provider,{value:this._reactInternals},this.props.children)}}let{ReactCurrentOwner:x,ReactCurrentDispatcher:T}=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;i(85259),i(97427),i(65297);let w={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function A(e){let{handlePointer:t}=(0,r.c)(e);return{priority:1,enabled:!0,compute(e,t,i){t.pointer.set(e.offsetX/t.size.width*2-1,-(2*(e.offsetY/t.size.height))+1),t.raycaster.setFromCamera(t.pointer,t.camera)},connected:void 0,handlers:Object.keys(w).reduce((e,i)=>({...e,[i]:t(i)}),{}),update:()=>{var t;let{events:i,internal:r}=e.getState();null!=(t=r.lastEvent)&&t.current&&i.handlers&&i.handlers.onPointerMove(r.lastEvent.current)},connect:t=>{var i;let{set:r,events:n}=e.getState();null==n.disconnect||n.disconnect(),r(e=>({events:{...e.events,connected:t}})),Object.entries(null!=(i=n.handlers)?i:[]).forEach(([e,i])=>{let[r,n]=w[e];t.addEventListener(r,i,{passive:n})})},disconnect:()=>{let{set:t,events:i}=e.getState();if(i.connected){var r;Object.entries(null!=(r=i.handlers)?r:[]).forEach(([e,t])=>{if(i&&i.connected instanceof HTMLElement){let[r]=w[e];i.connected.removeEventListener(r,t)}}),t(e=>({events:{...e.events,connected:void 0}}))}}}}let M=a.forwardRef(function({children:e,fallback:t,resize:i,style:o,gl:u,events:d=A,eventSource:h,eventPrefix:f,shadows:p,linear:m,flat:g,legacy:v,orthographic:w,frameloop:M,dpr:R,performance:C,raycaster:I,camera:L,scene:k,onPointerMissed:D,onCreated:P,...O},N){a.useMemo(()=>(0,r.e)(s),[]);let U=function(){let e=function(){var e,t;let i=function(){let e=a.useContext(E);if(null===e)throw Error("its-fine: useFiber must be called within a <FiberProvider />!");let t=a.useId(),i=a.useMemo(()=>{for(let i of[null==x?void 0:x.current,e,null==e?void 0:e.alternate]){if(!i)continue;let e=function e(t,i,r){if(!t)return;if(!0===r(t))return t;let n=i?t.return:t.child;for(;n;){let t=e(n,i,r);if(t)return t;n=i?null:n.sibling}}(i,!1,e=>{let i=e.memoizedState;for(;i;){if(i.memoizedState===t)return!0;i=i.next}});if(e)return e}},[e,t]);return i}(),[r]=a.useState(()=>new Map);r.clear();let n=i;for(;n;){let i=null==(e=n.type)?void 0:e._context;i&&i!==E&&!r.has(i)&&r.set(i,null==(t=null==T?void 0:T.current)?void 0:t.readContext(_(i))),n=n.return}return r}();return a.useMemo(()=>Array.from(e.keys()).reduce((t,i)=>r=>a.createElement(t,null,a.createElement(i.Provider,b(y({},r),{value:e.get(i)}))),e=>a.createElement(S,y({},e))),[e])}(),[F,B]=function(e){var t;let{debounce:i,scroll:r,polyfill:n,offsetSize:s}=void 0===e?{debounce:0,scroll:!1,offsetSize:!1}:e,o=n||("undefined"==typeof window?class{}:window.ResizeObserver);if(!o)throw Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");let[u,d]=(0,a.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),h=(0,a.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:u}),f=i?"number"==typeof i?i:i.scroll:null,p=i?"number"==typeof i?i:i.resize:null,m=(0,a.useRef)(!1);(0,a.useEffect)(()=>(m.current=!0,()=>void(m.current=!1)));let[g,v,y]=(0,a.useMemo)(()=>{let e=()=>{if(!h.current.element)return;let{left:e,top:t,width:i,height:r,bottom:n,right:a,x:o,y:l}=h.current.element.getBoundingClientRect(),u={left:e,top:t,width:i,height:r,bottom:n,right:a,x:o,y:l};h.current.element instanceof HTMLElement&&s&&(u.height=h.current.element.offsetHeight,u.width=h.current.element.offsetWidth),Object.freeze(u),m.current&&!c(h.current.lastBounds,u)&&d(h.current.lastBounds=u)};return[e,p?l()(e,p):e,f?l()(e,f):e]},[d,s,f,p]);function b(){h.current.scrollContainers&&(h.current.scrollContainers.forEach(e=>e.removeEventListener("scroll",y,!0)),h.current.scrollContainers=null),h.current.resizeObserver&&(h.current.resizeObserver.disconnect(),h.current.resizeObserver=null)}function _(){h.current.element&&(h.current.resizeObserver=new o(y),h.current.resizeObserver.observe(h.current.element),r&&h.current.scrollContainers&&h.current.scrollContainers.forEach(e=>e.addEventListener("scroll",y,{capture:!0,passive:!0})))}return t=!!r,(0,a.useEffect)(()=>{if(t)return window.addEventListener("scroll",y,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",y,!0)},[y,t]),(0,a.useEffect)(()=>(window.addEventListener("resize",v),()=>void window.removeEventListener("resize",v)),[v]),(0,a.useEffect)(()=>{b(),_()},[r,y,v]),(0,a.useEffect)(()=>b,[]),[e=>{e&&e!==h.current.element&&(b(),h.current.element=e,h.current.scrollContainers=function e(t){let i=[];if(!t||t===document.body)return i;let{overflow:r,overflowX:n,overflowY:a}=window.getComputedStyle(t);return[r,n,a].some(e=>"auto"===e||"scroll"===e)&&i.push(t),[...i,...e(t.parentElement)]}(e),_())},u,g]}({scroll:!0,debounce:{scroll:50,resize:0},...i}),V=a.useRef(null),z=a.useRef(null);a.useImperativeHandle(N,()=>V.current);let j=(0,r.u)(D),[H,G]=a.useState(!1),[W,$]=a.useState(!1);if(H)throw H;if(W)throw W;let q=a.useRef(null);(0,r.a)(()=>{let t=V.current;B.width>0&&B.height>0&&t&&(q.current||(q.current=(0,r.b)(t)),q.current.configure({gl:u,events:d,shadows:p,linear:m,flat:g,legacy:v,orthographic:w,frameloop:M,dpr:R,performance:C,raycaster:I,camera:L,scene:k,size:B,onPointerMissed:(...e)=>null==j.current?void 0:j.current(...e),onCreated:e=>{null==e.events.connect||e.events.connect(h?(0,r.i)(h)?h.current:h:z.current),f&&e.setEvents({compute:(e,t)=>{let i=e[f+"X"],r=e[f+"Y"];t.pointer.set(i/t.size.width*2-1,-(2*(r/t.size.height))+1),t.raycaster.setFromCamera(t.pointer,t.camera)}}),null==P||P(e)}}),q.current.render(a.createElement(U,null,a.createElement(r.E,{set:$},a.createElement(a.Suspense,{fallback:a.createElement(r.B,{set:G})},e)))))}),a.useEffect(()=>{let e=V.current;if(e)return()=>(0,r.d)(e)},[]);let Y=h?"none":"auto";return a.createElement("div",(0,n.Z)({ref:z,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:Y,...o}},O),a.createElement("div",{ref:F,style:{width:"100%",height:"100%"}},a.createElement("canvas",{ref:V,style:{display:"block"}},t)))}),R=a.forwardRef(function(e,t){return a.createElement(S,null,a.createElement(M,(0,n.Z)({},e,{ref:t})))})},69383:function(e){e.exports=function(){function e(){return(e=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}var i="image-Tb9Ew8CXIwaY6R1kjMvI0uRR-2000x3000-jpg";function r(e){return("image-"+e.split("/").slice(-1)[0]).replace(/\.([a-z]+)$/,"-$1")}var n=[["width","w"],["height","h"],["format","fm"],["download","dl"],["blur","blur"],["sharpen","sharp"],["invert","invert"],["orientation","or"],["minHeight","min-h"],["maxHeight","max-h"],["minWidth","min-w"],["maxWidth","max-w"],["quality","q"],["fit","fit"],["crop","crop"],["saturation","sat"],["auto","auto"],["dpr","dpr"],["pad","pad"]],a=["clip","crop","fill","fillmax","max","scale","min"],s=["top","bottom","left","right","center","focalpoint","entropy"],o=["format"],l=function(){function l(t,i){this.options=void 0,this.options=t?e({},t.options||{},i||{}):e({},i||{})}var u=l.prototype;return u.withOptions=function(i){var r=i.baseUrl||this.options.baseUrl,a={baseUrl:r};for(var s in i)i.hasOwnProperty(s)&&(a[function(e){for(var i,r=function(e,i){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=function(e,i){if(e){if("string"==typeof e)return t(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return t(e,i)}}(e))){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(n);!(i=r()).done;){var a=i.value,s=a[0],o=a[1];if(e===s||e===o)return s}return e}(s)]=i[s]);return new l(this,e({baseUrl:r},a))},u.image=function(e){return this.withOptions({source:e})},u.dataset=function(e){return this.withOptions({dataset:e})},u.projectId=function(e){return this.withOptions({projectId:e})},u.bg=function(e){return this.withOptions({bg:e})},u.dpr=function(e){return this.withOptions(e&&1!==e?{dpr:e}:{})},u.width=function(e){return this.withOptions({width:e})},u.height=function(e){return this.withOptions({height:e})},u.focalPoint=function(e,t){return this.withOptions({focalPoint:{x:e,y:t}})},u.maxWidth=function(e){return this.withOptions({maxWidth:e})},u.minWidth=function(e){return this.withOptions({minWidth:e})},u.maxHeight=function(e){return this.withOptions({maxHeight:e})},u.minHeight=function(e){return this.withOptions({minHeight:e})},u.size=function(e,t){return this.withOptions({width:e,height:t})},u.blur=function(e){return this.withOptions({blur:e})},u.sharpen=function(e){return this.withOptions({sharpen:e})},u.rect=function(e,t,i,r){return this.withOptions({rect:{left:e,top:t,width:i,height:r}})},u.format=function(e){return this.withOptions({format:e})},u.invert=function(e){return this.withOptions({invert:e})},u.orientation=function(e){return this.withOptions({orientation:e})},u.quality=function(e){return this.withOptions({quality:e})},u.forceDownload=function(e){return this.withOptions({download:e})},u.flipHorizontal=function(){return this.withOptions({flipHorizontal:!0})},u.flipVertical=function(){return this.withOptions({flipVertical:!0})},u.ignoreImageParams=function(){return this.withOptions({ignoreImageParams:!0})},u.fit=function(e){if(-1===a.indexOf(e))throw Error('Invalid fit mode "'+e+'"');return this.withOptions({fit:e})},u.crop=function(e){if(-1===s.indexOf(e))throw Error('Invalid crop mode "'+e+'"');return this.withOptions({crop:e})},u.saturation=function(e){return this.withOptions({saturation:e})},u.auto=function(e){if(-1===o.indexOf(e))throw Error('Invalid auto mode "'+e+'"');return this.withOptions({auto:e})},u.pad=function(e){return this.withOptions({pad:e})},u.url=function(){return function(t){var a=e({},t||{}),s=a.source;delete a.source;var o=function(t){var i;if(!t)return null;if("string"==typeof t&&/^https?:\/\//.test(""+t))i={asset:{_ref:r(t)}};else if("string"==typeof t)i={asset:{_ref:t}};else if(t&&"string"==typeof t._ref)i={asset:t};else if(t&&"string"==typeof t._id)i={asset:{_ref:t._id||""}};else if(t&&t.asset&&"string"==typeof t.asset.url)i={asset:{_ref:r(t.asset.url)}};else{if("object"!=typeof t.asset)return null;i=e({},t)}return t.crop&&(i.crop=t.crop),t.hotspot&&(i.hotspot=t.hotspot),function(t){if(t.crop&&t.hotspot)return t;var i=e({},t);return i.crop||(i.crop={left:0,top:0,bottom:0,right:0}),i.hotspot||(i.hotspot={x:.5,y:.5,height:1,width:1}),i}(i)}(s);if(!o)throw Error("Unable to resolve image URL from source ("+JSON.stringify(s)+")");var l=function(e){var t=e.split("-"),r=t[1],n=t[2],a=t[3];if(!r||!n||!a)throw Error("Malformed asset _ref '"+e+"'. Expected an id like \""+i+'".');var s=n.split("x"),o=s[0],l=s[1],u=+o,c=+l;if(!(isFinite(u)&&isFinite(c)))throw Error("Malformed asset _ref '"+e+"'. Expected an id like \""+i+'".');return{id:r,width:u,height:c,format:a}}(o.asset._ref||o.asset._id||""),u=Math.round(o.crop.left*l.width),c=Math.round(o.crop.top*l.height),d={left:u,top:c,width:Math.round(l.width-o.crop.right*l.width-u),height:Math.round(l.height-o.crop.bottom*l.height-c)},h=o.hotspot.height*l.height/2,f=o.hotspot.width*l.width/2,p=o.hotspot.x*l.width,m=o.hotspot.y*l.height;return a.rect||a.focalPoint||a.ignoreImageParams||a.crop||(a=e({},a,function(e,t){var i,r=t.width,n=t.height;if(!(r&&n))return{width:r,height:n,rect:e.crop};var a=e.crop,s=e.hotspot,o=r/n;if(a.width/a.height>o){var l=Math.round(a.height),u=Math.round(l*o),c=Math.max(0,Math.round(a.top)),d=Math.max(0,Math.round(Math.round((s.right-s.left)/2+s.left)-u/2));d<a.left?d=a.left:d+u>a.left+a.width&&(d=a.left+a.width-u),i={left:d,top:c,width:u,height:l}}else{var h=a.width,f=Math.round(h/o),p=Math.max(0,Math.round(a.left)),m=Math.max(0,Math.round(Math.round((s.bottom-s.top)/2+s.top)-f/2));m<a.top?m=a.top:m+f>a.top+a.height&&(m=a.top+a.height-f),i={left:p,top:m,width:h,height:f}}return{width:r,height:n,rect:i}}({crop:d,hotspot:{left:p-f,top:m-h,right:p+f,bottom:m+h}},a))),function(e){var t=(e.baseUrl||"https://cdn.sanity.io").replace(/\/+$/,""),i=e.asset.id+"-"+e.asset.width+"x"+e.asset.height+"."+e.asset.format,r=t+"/images/"+e.projectId+"/"+e.dataset+"/"+i,a=[];if(e.rect){var s=e.rect,o=s.left,l=s.top,u=s.width,c=s.height;(0!==o||0!==l||c!==e.asset.height||u!==e.asset.width)&&a.push("rect="+o+","+l+","+u+","+c)}e.bg&&a.push("bg="+e.bg),e.focalPoint&&(a.push("fp-x="+e.focalPoint.x),a.push("fp-y="+e.focalPoint.y));var d=[e.flipHorizontal&&"h",e.flipVertical&&"v"].filter(Boolean).join("");return(d&&a.push("flip="+d),n.forEach(function(t){var i=t[0],r=t[1];void 0!==e[i]?a.push(r+"="+encodeURIComponent(e[i])):void 0!==e[r]&&a.push(r+"="+encodeURIComponent(e[r]))}),0===a.length)?r:r+"?"+a.join("&")}(e({},a,{asset:l}))}(this.options)},u.toString=function(){return this.url()},l}();return function(e){if(e&&"config"in e&&"function"==typeof e.config){var t=e.config(),i=t.apiHost,r=t.projectId,n=t.dataset;return new l(null,{baseUrl:(i||"https://api.sanity.io").replace(/^https:\/\/api\./,"https://cdn."),projectId:r,dataset:n})}if(e&&"clientConfig"in e&&"object"==typeof e.clientConfig){var a=e.clientConfig,s=a.apiHost,o=a.projectId,u=a.dataset;return new l(null,{baseUrl:(s||"https://api.sanity.io").replace(/^https:\/\/api\./,"https://cdn."),projectId:o,dataset:u})}return new l(null,e)}}()},14813:function(e,t,i){"use strict";var r,n,a=i(50959);function s(){return(s=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}t.Z=function(e){return a.createElement("svg",s({viewBox:"0 0 13 11",fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMid meet"},e),r||(r=a.createElement("rect",{x:1,y:5,width:11,height:1,fill:"currentColor"})),n||(n=a.createElement("path",{d:"M6.93616 10.7958L11.5 5.5L6.93616 0.34082H8.24516L12.9202 5.55982L8.24516 10.7958H6.93616Z",fill:"currentColor"})))}},93936:function(e,t,i){"use strict";var r,n=i(50959);function a(){return(a=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}t.Z=function(e){return n.createElement("svg",a({viewBox:"0 0 110 26",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r||(r=n.createElement("path",{d:"M0.907616 20.1401H5.11172V8.80225C4.67226 9.03662 4.05215 9.25635 3.25137 9.46143C2.45058 9.65674 1.64004 9.75439 0.819725 9.75439L0.277733 7.92334C0.697655 7.92334 1.19082 7.87451 1.75723 7.77686C2.3334 7.6792 2.90957 7.54248 3.48574 7.3667C4.07168 7.18115 4.6039 6.96631 5.08242 6.72217C5.56094 6.46826 5.92226 6.18994 6.1664 5.88721H7.39687V20.1401H11.1029V22.0005H0.907616V20.1401ZM26.2799 20.7407H23.6725V25.5747H21.5045V20.7407H12.1148L11.5729 19.2466L12.3932 18.0454L20.5816 5.88721H23.6725V18.8218H26.2799V20.7407ZM21.5045 18.8218V7.96729L14.3121 18.8218H21.5045ZM31.4666 3.19189C31.4666 3.729 31.2957 4.16846 30.9539 4.51025C30.573 4.83252 30.1727 4.99365 29.7527 4.99365C29.3523 4.99365 28.9715 4.83252 28.6102 4.51025C28.2684 4.18799 28.0975 3.74854 28.0975 3.19189C28.0975 2.63525 28.2684 2.21533 28.6102 1.93213C28.9324 1.62939 29.3133 1.47803 29.7527 1.47803C30.1922 1.47803 30.5926 1.62939 30.9539 1.93213C31.2957 2.23486 31.4666 2.65479 31.4666 3.19189ZM28.6395 22.0005V8.20166H30.9246V22.0005H28.6395ZM42.498 11.5269C42.2832 11.0093 41.8926 10.5698 41.3262 10.2085C40.7695 9.84717 40.0713 9.6665 39.2314 9.6665C38.3916 9.6665 37.7422 9.85693 37.2832 10.2378C36.8242 10.6187 36.5947 11.0972 36.5947 11.6733C36.5947 12.0347 36.6729 12.3374 36.8291 12.5815C36.9854 12.8257 37.21 13.0356 37.5029 13.2114C37.7959 13.3872 38.1328 13.5435 38.5137 13.6802C38.8945 13.8071 39.3047 13.9292 39.7441 14.0464C40.3398 14.2124 40.9404 14.3931 41.5459 14.5884C42.1611 14.7739 42.708 15.0132 43.1865 15.3062C43.665 15.5894 44.0557 15.9507 44.3584 16.3901C44.6611 16.8296 44.8125 17.3911 44.8125 18.0747C44.8125 18.6704 44.6904 19.2319 44.4463 19.7593C44.2119 20.2769 43.8555 20.731 43.377 21.1216C42.9082 21.5122 42.3418 21.8149 41.6777 22.0298C41.0234 22.2544 40.2764 22.3667 39.4365 22.3667C38.3623 22.3667 37.4785 22.2104 36.7852 21.8979C36.0918 21.5854 35.5254 21.2388 35.0859 20.8579C34.5684 20.4185 34.168 19.9204 33.8848 19.3638L35.7158 18.2798C35.9014 18.6997 36.1748 19.0806 36.5361 19.4224C36.8096 19.7056 37.1904 19.9644 37.6787 20.1987C38.1768 20.4233 38.7822 20.5356 39.4951 20.5356C39.876 20.5356 40.252 20.4966 40.623 20.4185C40.9941 20.3306 41.3164 20.1987 41.5898 20.0229C41.873 19.8374 42.0977 19.6177 42.2637 19.3638C42.4395 19.1001 42.5273 18.7876 42.5273 18.4263C42.5273 17.7524 42.2148 17.2544 41.5898 16.9321C40.9746 16.6099 40.1494 16.2974 39.1143 15.9946C38.5479 15.8384 37.9814 15.6626 37.415 15.4673C36.8486 15.2622 36.3359 15.0132 35.877 14.7202C35.4277 14.4175 35.0615 14.0464 34.7783 13.6069C34.5049 13.1675 34.3682 12.6255 34.3682 11.981C34.3682 11.356 34.4951 10.7896 34.749 10.2817C35.0127 9.77393 35.374 9.33936 35.833 8.97803C36.3018 8.6167 36.8389 8.33838 37.4443 8.14307C38.0596 7.93799 38.7236 7.83545 39.4365 7.83545C40.6572 7.83545 41.7168 8.09912 42.6152 8.62646C43.5137 9.14404 44.1045 9.76416 44.3877 10.4868L42.498 11.5269ZM47.6262 0.672363H49.9113V22.0005H47.6262V0.672363ZM57.7641 20.5649C58.3891 20.5649 58.9359 20.4722 59.4047 20.2866C59.8734 20.0913 60.2641 19.8325 60.5766 19.5103C60.8988 19.188 61.1479 18.8267 61.3236 18.4263C61.5092 18.0259 61.602 17.6157 61.602 17.1958V15.9946C61.2895 16.0337 60.85 16.0923 60.2836 16.1704C59.727 16.2388 59.1898 16.312 58.6723 16.3901C58.2719 16.4487 57.8764 16.5317 57.4857 16.6392C57.0951 16.7368 56.7582 16.8638 56.475 17.02C55.9184 17.3618 55.6205 17.8843 55.5814 18.5874C55.5814 19.2417 55.767 19.7349 56.1381 20.0669C56.5189 20.3989 57.0609 20.5649 57.7641 20.5649ZM53.3842 10.9263C53.6479 10.3501 54.0287 9.83252 54.5268 9.37354C54.9467 8.97314 55.4936 8.6167 56.1674 8.3042C56.851 7.9917 57.6762 7.83545 58.643 7.83545C59.6 7.83545 60.4057 7.95752 61.06 8.20166C61.724 8.43604 62.2611 8.76807 62.6713 9.19775C63.0814 9.61768 63.3744 10.1353 63.5502 10.7505C63.7357 11.3657 63.8285 12.0151 63.8285 12.6987V18.3384C63.8285 19.0415 63.9066 19.5054 64.0629 19.73C64.2289 19.9448 64.4779 20.0522 64.81 20.0522C65.0346 20.0522 65.1957 20.0425 65.2934 20.0229C65.391 20.0034 65.4936 19.9839 65.601 19.9644L65.7182 21.7368C65.5619 21.8345 65.3764 21.9126 65.1615 21.9712C64.9564 22.0298 64.6391 22.0591 64.2094 22.0591C63.5746 22.0591 63.057 21.8442 62.6566 21.4146C62.2562 20.9849 62.017 20.4282 61.9389 19.7446C61.5189 20.4868 60.9086 21.1118 60.1078 21.6196C59.307 22.1177 58.4086 22.3667 57.4125 22.3667C56.1039 22.3667 55.0834 22.0347 54.351 21.3706C53.6283 20.7065 53.267 19.8081 53.267 18.6753C53.2865 17.9722 53.4721 17.396 53.8236 16.9468C54.1752 16.4976 54.6098 16.1313 55.1273 15.8481C55.6449 15.5942 56.1918 15.3989 56.768 15.2622C57.3539 15.1157 58.0375 14.9937 58.8187 14.896L61.602 14.5298V12.8745C61.602 11.937 61.3627 11.1802 60.8842 10.604C60.4057 10.0181 59.6488 9.7251 58.6137 9.7251C57.9496 9.7251 57.4076 9.8374 56.9877 10.062C56.5678 10.2769 56.2357 10.5259 55.9916 10.8091C55.7182 11.1509 55.4887 11.5317 55.3031 11.9517L53.3842 10.9263ZM77.775 12.9038C77.775 12.4839 77.7066 12.0835 77.5699 11.7026C77.443 11.312 77.2525 10.9702 76.9986 10.6772C76.7545 10.3843 76.4371 10.1499 76.0465 9.97412C75.6559 9.78857 75.192 9.6958 74.6549 9.6958C73.9713 9.6958 73.3707 9.84717 72.8531 10.1499C72.3453 10.4526 71.9156 10.8433 71.5641 11.3218C71.2223 11.8003 70.9635 12.3423 70.7877 12.9478C70.6217 13.5435 70.5387 14.1392 70.5387 14.7349V22.0005H68.2535V11.0435C68.2535 10.7505 68.2389 10.3306 68.2096 9.78369C68.1803 9.22705 68.1461 8.69971 68.107 8.20166H70.3336C70.3531 8.31885 70.3678 8.49463 70.3775 8.729C70.3873 8.95361 70.3971 9.19287 70.4068 9.44678C70.4166 9.70068 70.4215 9.96436 70.4215 10.2378C70.4215 10.5015 70.4215 10.731 70.4215 10.9263H70.568C70.7242 10.5454 70.9537 10.1743 71.2564 9.81299C71.5592 9.44189 71.9107 9.10986 72.3111 8.81689C72.7115 8.52393 73.1559 8.28955 73.6441 8.11377C74.1324 7.92822 74.6695 7.83545 75.2555 7.83545C75.9293 7.83545 76.5543 7.93311 77.1305 8.12842C77.7164 8.31396 78.2242 8.60693 78.6539 9.00732C79.0836 9.40771 79.4205 9.93018 79.6646 10.5747C79.9186 11.2095 80.0455 11.9761 80.0455 12.8745V22.0005H77.775V12.9038ZM84.9246 15.1011C84.9246 16.8784 85.3445 18.2212 86.1844 19.1294C87.0242 20.0278 88.074 20.4771 89.3338 20.4771C90.5936 20.4771 91.6336 20.0278 92.4539 19.1294C93.2742 18.2212 93.6844 16.8784 93.6844 15.1011C93.6844 13.3237 93.2742 11.981 92.4539 11.0728C91.6336 10.1548 90.5936 9.6958 89.3338 9.6958C88.074 9.6958 87.0242 10.1548 86.1844 11.0728C85.3445 11.981 84.9246 13.3237 84.9246 15.1011ZM95.7791 0.672363V19.1733C95.7791 19.5151 95.7937 19.9644 95.823 20.521C95.8621 21.0679 95.9012 21.561 95.9402 22.0005H93.8602C93.8406 21.9028 93.8211 21.7612 93.8016 21.5757C93.782 21.3804 93.7674 21.1753 93.7576 20.9604C93.7478 20.7358 93.7332 20.5161 93.7137 20.3013C93.6941 20.0767 93.6844 19.8716 93.6844 19.686H93.5379C93.3328 20.0278 93.0691 20.355 92.7469 20.6675C92.4344 20.98 92.073 21.2681 91.6629 21.5317C91.2527 21.7856 90.8035 21.9858 90.3152 22.1323C89.827 22.2886 89.3191 22.3667 88.7918 22.3667C87.9129 22.3667 87.0926 22.1958 86.3309 21.854C85.5789 21.5122 84.9246 21.0288 84.368 20.4038C83.8211 19.769 83.3865 19.0122 83.0643 18.1333C82.742 17.2544 82.5809 16.2729 82.5809 15.189C82.5809 14.1147 82.7469 13.1235 83.0789 12.2153C83.4109 11.2974 83.8602 10.5161 84.4266 9.87158C85.0027 9.21729 85.6766 8.70947 86.448 8.34814C87.2293 7.98682 88.074 7.80615 88.9822 7.80615C89.4803 7.80615 89.9588 7.87939 90.4178 8.02588C90.8768 8.1626 91.3016 8.35303 91.6922 8.59717C92.0828 8.83154 92.4246 9.09521 92.7176 9.38818C93.0203 9.68115 93.2645 9.97412 93.45 10.2671H93.5965C93.5574 9.99365 93.533 9.69092 93.5232 9.35889C93.5135 9.02686 93.5086 8.7583 93.5086 8.55322V0.672363H95.7791ZM107.367 11.5269C107.152 11.0093 106.762 10.5698 106.195 10.2085C105.639 9.84717 104.94 9.6665 104.101 9.6665C103.261 9.6665 102.611 9.85693 102.152 10.2378C101.693 10.6187 101.464 11.0972 101.464 11.6733C101.464 12.0347 101.542 12.3374 101.698 12.5815C101.854 12.8257 102.079 13.0356 102.372 13.2114C102.665 13.3872 103.002 13.5435 103.383 13.6802C103.764 13.8071 104.174 13.9292 104.613 14.0464C105.209 14.2124 105.81 14.3931 106.415 14.5884C107.03 14.7739 107.577 15.0132 108.056 15.3062C108.534 15.5894 108.925 15.9507 109.228 16.3901C109.53 16.8296 109.682 17.3911 109.682 18.0747C109.682 18.6704 109.56 19.2319 109.315 19.7593C109.081 20.2769 108.725 20.731 108.246 21.1216C107.777 21.5122 107.211 21.8149 106.547 22.0298C105.893 22.2544 105.146 22.3667 104.306 22.3667C103.231 22.3667 102.348 22.2104 101.654 21.8979C100.961 21.5854 100.395 21.2388 99.9551 20.8579C99.4375 20.4185 99.0371 19.9204 98.7539 19.3638L100.585 18.2798C100.771 18.6997 101.044 19.0806 101.405 19.4224C101.679 19.7056 102.06 19.9644 102.548 20.1987C103.046 20.4233 103.651 20.5356 104.364 20.5356C104.745 20.5356 105.121 20.4966 105.492 20.4185C105.863 20.3306 106.186 20.1987 106.459 20.0229C106.742 19.8374 106.967 19.6177 107.133 19.3638C107.309 19.1001 107.396 18.7876 107.396 18.4263C107.396 17.7524 107.084 17.2544 106.459 16.9321C105.844 16.6099 105.019 16.2974 103.983 15.9946C103.417 15.8384 102.851 15.6626 102.284 15.4673C101.718 15.2622 101.205 15.0132 100.746 14.7202C100.297 14.4175 99.9307 14.0464 99.6475 13.6069C99.374 13.1675 99.2373 12.6255 99.2373 11.981C99.2373 11.356 99.3643 10.7896 99.6182 10.2817C99.8818 9.77393 100.243 9.33936 100.702 8.97803C101.171 8.6167 101.708 8.33838 102.313 8.14307C102.929 7.93799 103.593 7.83545 104.306 7.83545C105.526 7.83545 106.586 8.09912 107.484 8.62646C108.383 9.14404 108.974 9.76416 109.257 10.4868L107.367 11.5269Z",fill:"currentColor"})))}},80438:function(e){"use strict";/*!
 * assign-symbols <https://github.com/jonschlinkert/assign-symbols>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */e.exports=function(e,t){if(null==e)throw TypeError("expected first argument to be an object.");if(void 0===t||"undefined"==typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return e;for(var i=Object.prototype.propertyIsEnumerable,r=Object(e),n=arguments.length,a=0;++a<n;)for(var s=Object(arguments[a]),o=Object.getOwnPropertySymbols(s),l=0;l<o.length;l++){var u=o[l];i.call(s,u)&&(r[u]=s[u])}return r}},67715:function(e,t){"use strict";t.Z=function(e,t){if(e&&t){var i=Array.isArray(t)?t:t.split(","),r=e.name||"",n=(e.type||"").toLowerCase(),a=n.replace(/\/.*$/,"");return i.some(function(e){var t=e.trim().toLowerCase();return"."===t.charAt(0)?r.toLowerCase().endsWith(t):t.endsWith("/*")?a===t.replace(/\/.*$/,""):n===t})}return!0}},45924:function(e,t,i){"use strict";t.Z=function(){for(var e,t,i=0,r="";i<arguments.length;)(e=arguments[i++])&&(t=function e(t){var i,r,n="";if("string"==typeof t||"number"==typeof t)n+=t;else if("object"==typeof t){if(Array.isArray(t))for(i=0;i<t.length;i++)t[i]&&(r=e(t[i]))&&(n&&(n+=" "),n+=r);else for(i in t)t[i]&&(n&&(n+=" "),n+=i)}return n}(e))&&(r&&(r+=" "),r+=t);return r}},31110:function(e){function t(e,t,i){function r(){var u=Date.now()-o;u<t&&u>=0?n=setTimeout(r,t-u):(n=null,i||(l=e.apply(s,a),s=a=null))}null==t&&(t=100);var n,a,s,o,l,u=function(){s=this,a=arguments,o=Date.now();var u=i&&!n;return n||(n=setTimeout(r,t)),u&&(l=e.apply(s,a),s=a=null),l};return u.clear=function(){n&&(clearTimeout(n),n=null)},u.flush=function(){n&&(l=e.apply(s,a),s=a=null,clearTimeout(n),n=null)},u}t.debounce=t,e.exports=t},54525:function(e){"use strict";var t="%[a-f0-9]{2}",i=RegExp("("+t+")|([^%]+?)","gi"),r=RegExp("("+t+")+","gi");e.exports=function(e){if("string"!=typeof e)throw TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch(t){return function(e){for(var t={"%FE%FF":"��","%FF%FE":"��"},n=r.exec(e);n;){try{t[n[0]]=decodeURIComponent(n[0])}catch(e){var a=function(e){try{return decodeURIComponent(e)}catch(n){for(var t=e.match(i)||[],r=1;r<t.length;r++)t=(e=(function e(t,i){try{return[decodeURIComponent(t.join(""))]}catch(e){}if(1===t.length)return t;i=i||1;var r=t.slice(0,i),n=t.slice(i);return Array.prototype.concat.call([],e(r),e(n))})(t,r).join("")).match(i)||[];return e}}(n[0]);a!==n[0]&&(t[n[0]]=a)}n=r.exec(e)}t["%C2"]="�";for(var s=Object.keys(t),o=0;o<s.length;o++){var l=s[o];e=e.replace(RegExp(l,"g"),t[l])}return e}(e)}}},48396:function(e,t,i){"use strict";var r=i(63566);e.exports=function(e){r(e)||(e={});for(var t=arguments.length,i=1;i<t;i++){var n=arguments[i];r(n)&&function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}(e,n)}return e}},85582:function(e,t,i){"use strict";var r=i(12723),n=i(80438);function a(e){return e&&"object"==typeof e||r(e)}e.exports=Object.assign||function(e){if(null==e)throw TypeError("Cannot convert undefined or null to object");a(e)||(e={});for(var t=1;t<arguments.length;t++){var i,r=arguments[t];(i=r)&&"string"==typeof i&&(r=function(e){var t={};for(var i in e)t[i]=e[i];return t}(r)),a(r)&&(function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}(e,r),n(e,r))}return e}},3341:function(e){"use strict";e.exports=function e(t,i){if(t===i)return!0;if(t&&i&&"object"==typeof t&&"object"==typeof i){if(t.constructor!==i.constructor)return!1;if(Array.isArray(t)){if((r=t.length)!=i.length)return!1;for(n=r;0!=n--;)if(!e(t[n],i[n]))return!1;return!0}if(t.constructor===RegExp)return t.source===i.source&&t.flags===i.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===i.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===i.toString();if((r=(a=Object.keys(t)).length)!==Object.keys(i).length)return!1;for(n=r;0!=n--;)if(!Object.prototype.hasOwnProperty.call(i,a[n]))return!1;for(n=r;0!=n--;){var r,n,a,s=a[n];if(!e(t[s],i[s]))return!1}return!0}return t!=t&&i!=i}},1469:function(e){"use strict";e.exports=function(e,t){for(var i={},r=Object.keys(e),n=Array.isArray(t),a=0;a<r.length;a++){var s=r[a],o=e[s];(n?-1!==t.indexOf(s):t(s,o,e))&&(i[s]=o)}return i}},21603:function(e){"use strict";/*!
 * for-in <https://github.com/jonschlinkert/for-in>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */e.exports=function(e,t,i){for(var r in e)if(!1===t.call(i,e[r],r,e))break}},33780:function(e){/*!
 * get-value <https://github.com/jonschlinkert/get-value>
 *
 * Copyright (c) 2014-2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */e.exports=function(e,i,r,n,a){var s;if(!(null!==(s=e)&&("object"==typeof s||"function"==typeof s))||!i)return e;if(i=t(i),r&&(i+="."+t(r)),n&&(i+="."+t(n)),a&&(i+="."+t(a)),i in e)return e[i];for(var o=i.split("."),l=o.length,u=-1;e&&++u<l;){for(var c=o[u];"\\"===c[c.length-1];)c=c.slice(0,-1)+"."+o[++u];e=e[c]}return e};function t(e){return e?Array.isArray(e)?e.join("."):e:""}},63566:function(e){"use strict";/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015, Jon Schlinkert.
 * Licensed under the MIT License.
 */e.exports=function(e){return null!=e&&("object"==typeof e||"function"==typeof e)}},12723:function(e,t,i){"use strict";/*!
 * is-extendable <https://github.com/jonschlinkert/is-extendable>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var r=i(76805);e.exports=function(e){return r(e)||"function"==typeof e||Array.isArray(e)}},76805:function(e,t,i){"use strict";/*!
 * is-plain-object <https://github.com/jonschlinkert/is-plain-object>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var r=i(48646);function n(e){return!0===r(e)&&"[object Object]"===Object.prototype.toString.call(e)}e.exports=function(e){var t,i;return!1!==n(e)&&"function"==typeof(t=e.constructor)&&!1!==n(i=t.prototype)&&!1!==i.hasOwnProperty("isPrototypeOf")}},48646:function(e){"use strict";/*!
 * isobject <https://github.com/jonschlinkert/isobject>
 *
 * Copyright (c) 2014-2017, Jon Schlinkert.
 * Released under the MIT License.
 */e.exports=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}},30421:function(e,t,i){"use strict";let r,n,a,s;i.d(t,{Zf:function(){return ss},M4:function(){return so}});var o=i(10422),l=i(50959),u=i.t(l,2),c=i(28957);function d(...e){return t=>e.forEach(e=>{"function"==typeof e?e(t):null!=e&&(e.current=t)})}function h(...e){return(0,l.useCallback)(d(...e),e)}let f=(0,l.forwardRef)((e,t)=>{let{children:i,...r}=e,n=l.Children.toArray(i),a=n.find(g);if(a){let e=a.props.children,i=n.map(t=>t!==a?t:l.Children.count(e)>1?l.Children.only(null):(0,l.isValidElement)(e)?e.props.children:null);return(0,l.createElement)(p,(0,c.Z)({},r,{ref:t}),(0,l.isValidElement)(e)?(0,l.cloneElement)(e,void 0,i):null)}return(0,l.createElement)(p,(0,c.Z)({},r,{ref:t}),i)});f.displayName="Slot";let p=(0,l.forwardRef)((e,t)=>{let{children:i,...r}=e;return(0,l.isValidElement)(i)?(0,l.cloneElement)(i,{...function(e,t){let i={...t};for(let r in t){let n=e[r],a=t[r],s=/^on[A-Z]/.test(r);s?n&&a?i[r]=(...e)=>{a(...e),n(...e)}:n&&(i[r]=n):"style"===r?i[r]={...n,...a}:"className"===r&&(i[r]=[n,a].filter(Boolean).join(" "))}return{...e,...i}}(r,i.props),ref:t?d(t,i.ref):i.ref}):l.Children.count(i)>1?l.Children.only(null):null});p.displayName="SlotClone";let m=({children:e})=>(0,l.createElement)(l.Fragment,null,e);function g(e){return(0,l.isValidElement)(e)&&e.type===m}let v=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,t)=>{let i=(0,l.forwardRef)((e,i)=>{let{asChild:r,...n}=e,a=r?f:t;return(0,l.useEffect)(()=>{window[Symbol.for("radix-ui")]=!0},[]),(0,l.createElement)(a,(0,c.Z)({},n,{ref:i}))});return i.displayName=`Primitive.${t}`,{...e,[t]:i}},{}),y=(0,l.forwardRef)((e,t)=>{var i;let{container:r=null==globalThis?void 0:null===(i=globalThis.document)||void 0===i?void 0:i.body,...n}=e;return r?o.createPortal((0,l.createElement)(v.div,(0,c.Z)({},n,{ref:t})),r):null});var b=Object.prototype.hasOwnProperty;function _(e,t){var i,r;if(e===t)return!0;if(e&&t&&(i=e.constructor)===t.constructor){if(i===Date)return e.getTime()===t.getTime();if(i===RegExp)return e.toString()===t.toString();if(i===Array){if((r=e.length)===t.length)for(;r--&&_(e[r],t[r]););return -1===r}if(!i||"object"==typeof e){for(i in r=0,e)if(b.call(e,i)&&++r&&!b.call(t,i)||!(i in t)||!_(e[i],t[i]))return!1;return Object.keys(t).length===r}}return e!=e&&t!=t}function E(e,t){if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;let i=Object.keys(e);if(i.length!==Object.keys(t).length)return!1;for(let r=0;r<i.length;r++)if(!Object.prototype.hasOwnProperty.call(t,i[r])||!Object.is(e[i[r]],t[i[r]]))return!1;return!0}var S=function(e,t,i,r){this.name=e,this.fn=t,this.args=i,this.modifiers=r};function x(e,t){return void 0===t&&(t="simple"),"object"==typeof e?e[t]:e}function T(e,t,i){if(!e.length)return x(t);var r=e.shift(),n=T(e,t,i);return r.perform(n,i)}S.prototype._test=function(e){var t=this.fn;try{T(this.modifiers.slice(),t,this)(e)}catch(e){t=function(){return!1}}try{return T(this.modifiers.slice(),t,this)(e)}catch(e){return!1}},S.prototype._check=function(e){try{T(this.modifiers.slice(),this.fn,this)(e)}catch(e){if(T(this.modifiers.slice(),function(e){return e},this)(!1))return}if(!T(this.modifiers.slice(),this.fn,this)(e))throw null},S.prototype._testAsync=function(e){var t=this;return new Promise(function(i,r){(function e(t,i,r){if(!t.length)return function(e){return Promise.resolve(x(i,"async")(e))};var n=t.shift(),a=e(t,i,r);return n.performAsync(a,r)})(t.modifiers.slice(),t.fn,t)(e).then(function(t){t?i(e):r(null)}).catch(function(e){return r(e)})})};var w=function(e,t,i){this.name=e,this.perform=t,this.performAsync=i},A=function(e){function t(i,r,n,a){for(var s=[],o=arguments.length-4;o-- >0;)s[o]=arguments[o+4];e.call(this,s),e.captureStackTrace&&e.captureStackTrace(this,t),this.rule=i,this.value=r,this.cause=n,this.target=a}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(Error),M=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.chain=e,this.nextRuleModifiers=t};M.prototype._applyRule=function(e,t){var i=this;return function(){for(var r=[],n=arguments.length;n--;)r[n]=arguments[n];return i.chain.push(new S(t,e.apply(i,r),r,i.nextRuleModifiers)),i.nextRuleModifiers=[],i}},M.prototype._applyModifier=function(e,t){return this.nextRuleModifiers.push(new w(t,e.simple,e.async)),this},M.prototype._clone=function(){return new M(this.chain.slice(),this.nextRuleModifiers.slice())},M.prototype.test=function(e){return this.chain.every(function(t){return t._test(e)})},M.prototype.testAll=function(e){var t=[];return this.chain.forEach(function(i){try{i._check(e)}catch(r){t.push(new A(i,e,r))}}),t},M.prototype.check=function(e){this.chain.forEach(function(t){try{t._check(e)}catch(i){throw new A(t,e,i)}})},M.prototype.testAsync=function(e){var t=this;return new Promise(function(i,r){(function e(t,i,r,n){if(i.length){var a=i.shift();a._testAsync(t).then(function(){e(t,i,r,n)},function(e){n(new A(a,t,e))})}else r(t)})(e,t.chain.slice(),i,r)})};var R=function(e,t){return!!t&&"string"==typeof e&&0===e.trim().length||null==e};function C(){return"undefined"!=typeof Proxy?function e(t){return new Proxy(t,{get:function(i,r){if(r in i)return i[r];var n=e(t._clone());return r in L?n._applyModifier(L[r],r):r in I?n._applyRule(I[r],r):r in P?n._applyRule(P[r],r):void 0}})}(new M):function e(t){var i=function(t,i){return Object.keys(t).forEach(function(r){i[r]=function(){for(var n=[],a=arguments.length;a--;)n[a]=arguments[a];return e(i._clone())._applyRule(t[r],r).apply(void 0,n)}}),i},r=i(P,t),n=i(I,r);return Object.keys(L).forEach(function(t){Object.defineProperty(n,t,{get:function(){return e(n._clone())._applyModifier(L[t],t)}})}),n}(new M)}var I={};C.extend=function(e){Object.assign(I,e)},C.clearCustomRules=function(){I={}};var L={not:{simple:function(e){return function(t){return!e(t)}},async:function(e){return function(t){return Promise.resolve(e(t)).then(function(e){return!e}).catch(function(){return!0})}}},some:{simple:function(e){return function(t){return D(t).some(function(t){try{return e(t)}catch(e){return!1}})}},async:function(e){return function(t){return Promise.all(D(t).map(function(t){try{return e(t).catch(function(){return!1})}catch(e){return!1}})).then(function(e){return e.some(Boolean)})}}},every:{simple:function(e){return function(t){return!1!==t&&D(t).every(e)}},async:function(e){return function(t){return Promise.all(D(t).map(e)).then(function(e){return e.every(Boolean)})}}},strict:{simple:function(e,t){return function(i){return k(t)&&i&&"object"==typeof i?Object.keys(t.args[0]).length===Object.keys(i).length&&e(i):e(i)}},async:function(e,t){return function(i){return Promise.resolve(e(i)).then(function(e){return k(t)&&i&&"object"==typeof i?Object.keys(t.args[0]).length===Object.keys(i).length&&e:e}).catch(function(){return!1})}}}};function k(e){return e&&"schema"===e.name&&e.args.length>0&&"object"==typeof e.args[0]}function D(e){return"string"==typeof e?e.split(""):e}var P={equal:function(e){return function(t){return t==e}},exact:function(e){return function(t){return t===e}},number:function(e){return void 0===e&&(e=!0),function(t){return"number"==typeof t&&(e||isFinite(t))}},integer:function(){return function(e){return(Number.isInteger||N)(e)}},numeric:function(){return function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},string:function(){return O("string")},boolean:function(){return O("boolean")},undefined:function(){return O("undefined")},null:function(){return O("null")},array:function(){return O("array")},object:function(){return O("object")},instanceOf:function(e){return function(t){return t instanceof e}},pattern:function(e){return function(t){return e.test(t)}},lowercase:function(){return function(e){return"boolean"==typeof e||e===e.toLowerCase()&&""!==e.trim()}},uppercase:function(){return function(e){return e===e.toUpperCase()&&""!==e.trim()}},vowel:function(){return function(e){return/^[aeiou]+$/i.test(e)}},consonant:function(){return function(e){return/^(?=[^aeiou])([a-z]+)$/i.test(e)}},first:function(e){return function(t){return t[0]==e}},last:function(e){return function(t){return t[t.length-1]==e}},empty:function(){return function(e){return 0===e.length}},length:function(e,t){return function(i){return i.length>=e&&i.length<=(t||e)}},minLength:function(e){return function(t){return t.length>=e}},maxLength:function(e){return function(t){return t.length<=e}},negative:function(){return function(e){return e<0}},positive:function(){return function(e){return e>=0}},between:function(e,t){return function(i){return i>=e&&i<=t}},range:function(e,t){return function(i){return i>=e&&i<=t}},lessThan:function(e){return function(t){return t<e}},lessThanOrEqual:function(e){return function(t){return t<=e}},greaterThan:function(e){return function(t){return t>e}},greaterThanOrEqual:function(e){return function(t){return t>=e}},even:function(){return function(e){return e%2==0}},odd:function(){return function(e){return e%2!=0}},includes:function(e){return function(t){return~t.indexOf(e)}},schema:function(e){return{simple:function(t){var i=[];if(Object.keys(e).forEach(function(r){var n=e[r];try{n.check((t||{})[r])}catch(e){e.target=r,i.push(e)}}),i.length>0)throw i;return!0},async:function(t){var i=[];return Promise.all(Object.keys(e).map(function(r){return e[r].testAsync((t||{})[r]).catch(function(e){e.target=r,i.push(e)})})).then(function(){if(i.length>0)throw i;return!0})}}},passesAnyOf:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return function(t){return e.some(function(e){return e.test(t)})}},optional:function(e,t){return void 0===t&&(t=!1),{simple:function(i){return R(i,t)||void 0===e.check(i)},async:function(i){return R(i,t)||e.testAsync(i)}}}};function O(e){return function(t){return Array.isArray(t)&&"array"===e||null===t&&"null"===e||typeof t===e}}function N(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e}var U=i(40458);let F={toVector:(e,t)=>(void 0===e&&(e=t),Array.isArray(e)?e:[e,e]),add:(e,t)=>[e[0]+t[0],e[1]+t[1]],sub:(e,t)=>[e[0]-t[0],e[1]-t[1]],addTo(e,t){e[0]+=t[0],e[1]+=t[1]},subTo(e,t){e[0]-=t[0],e[1]-=t[1]}};function B(e,t,i){return 0===t||Math.abs(t)===1/0?Math.pow(e,5*i):e*t*i/(t+i*e)}function V(e,t,i,r=.15){return 0===r?Math.max(t,Math.min(e,i)):e<t?-B(t-e,i-t,r)+t:e>i?+B(e-i,i-t,r)+i:e}function z(e,t,i){var r;return(t="symbol"==typeof(r=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?r:String(r))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function j(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function H(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?j(Object(i),!0).forEach(function(t){z(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):j(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}let G={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function W(e){return e?e[0].toUpperCase()+e.slice(1):""}let $=["enter","leave"],q=["gotpointercapture","lostpointercapture"];function Y(e){return"touches"in e}function K(e){return Y(e)?"touch":"pointerType"in e?e.pointerType:"mouse"}function X(e){return Y(e)?("touchend"===e.type||"touchcancel"===e.type?e.changedTouches:e.targetTouches)[0]:e}function Z(e){let t=X(e);return Y(e)?t.identifier:t.pointerId}function J(e){let t=X(e);return[t.clientX,t.clientY]}function Q(e,...t){return"function"==typeof e?e(...t):e}function ee(){}function et(e,t){return Object.assign({},t,e||{})}class ei{constructor(e,t,i){this.ctrl=e,this.args=t,this.key=i,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){let{state:e,shared:t,ingKey:i,args:r}=this;t[i]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=r,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){let t=this.state,i=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=i.from?Q(i.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}computeValues(e){let t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){let e=this.state;e._initial=e._values,e.initial=e.values}compute(e){let{state:t,config:i,shared:r}=this;t.args=this.args;let n=0;if(e&&(t.event=e,i.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,r.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,r.locked=!!document.pointerLockElement,Object.assign(r,function(e){let t={};if("buttons"in e&&(t.buttons=e.buttons),"shiftKey"in e){let{shiftKey:i,altKey:r,metaKey:n,ctrlKey:a}=e;Object.assign(t,{shiftKey:i,altKey:r,metaKey:n,ctrlKey:a})}return t}(e)),r.down=r.pressed=r.buttons%2==1||r.touches>0,n=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){let e=t._delta.map(Math.abs);F.addTo(t._distance,e)}this.axisIntent&&this.axisIntent(e);let[a,s]=t._movement,[o,l]=i.threshold,{_step:u,values:c}=t;if(i.hasCustomTransform?(!1===u[0]&&(u[0]=Math.abs(a)>=o&&c[0]),!1===u[1]&&(u[1]=Math.abs(s)>=l&&c[1])):(!1===u[0]&&(u[0]=Math.abs(a)>=o&&Math.sign(a)*o),!1===u[1]&&(u[1]=Math.abs(s)>=l&&Math.sign(s)*l)),t.intentional=!1!==u[0]||!1!==u[1],!t.intentional)return;let d=[0,0];if(i.hasCustomTransform){let[e,t]=c;d[0]=!1!==u[0]?e-u[0]:0,d[1]=!1!==u[1]?t-u[1]:0}else d[0]=!1!==u[0]?a-u[0]:0,d[1]=!1!==u[1]?s-u[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(d);let h=t.offset,f=t._active&&!t._blocked||t.active;f&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=r[this.ingKey]=t._active,e&&(t.first&&("bounds"in i&&(t._bounds=Q(i.bounds,t)),this.setup&&this.setup()),t.movement=d,this.computeOffset()));let[p,m]=t.offset,[[g,v],[y,b]]=t._bounds;t.overflow=[p<g?-1:p>v?1:0,m<y?-1:m>b?1:0],t._movementBound[0]=!!t.overflow[0]&&(!1===t._movementBound[0]?t._movement[0]:t._movementBound[0]),t._movementBound[1]=!!t.overflow[1]&&(!1===t._movementBound[1]?t._movement[1]:t._movementBound[1]);let _=t._active&&i.rubberband||[0,0];if(t.offset=function(e,[t,i],[r,n]){let[[a,s],[o,l]]=e;return[V(t,a,s,r),V(i,o,l,n)]}(t._bounds,t.offset,_),t.delta=F.sub(t.offset,h),this.computeMovement(),f&&(!t.last||n>32)){t.delta=F.sub(t.offset,h);let e=t.delta.map(Math.abs);F.addTo(t.distance,e),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&n>0&&(t.velocity=[e[0]/n,e[1]/n],t.timeDelta=n)}}emit(){let e=this.state,t=this.shared,i=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!i.triggerAllEvents)return;let r=this.handler(H(H(H({},t),e),{},{[this.aliasKey]:e.values}));void 0!==r&&(e.memo=r)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}class er extends ei{constructor(...e){super(...e),z(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=F.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=F.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){let t=this.state,i=this.config;if(!t.axis&&e){let r="object"==typeof i.axisThreshold?i.axisThreshold[K(e)]:i.axisThreshold;t.axis=function([e,t],i){let r=Math.abs(e),n=Math.abs(t);return r>n&&r>i?"x":n>r&&n>i?"y":void 0}(t._movement,r)}t._blocked=(i.lockDirection||!!i.axis)&&!t.axis||!!i.axis&&i.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0}}}let en=e=>e,ea={enabled:(e=!0)=>e,eventOptions:(e,t,i)=>H(H({},i.shared.eventOptions),e),preventDefault:(e=!1)=>e,triggerAllEvents:(e=!1)=>e,rubberband(e=0){switch(e){case!0:return[.15,.15];case!1:return[0,0];default:return F.toVector(e)}},from:e=>"function"==typeof e?e:null!=e?F.toVector(e):void 0,transform(e,t,i){let r=e||i.shared.transform;return this.hasCustomTransform=!!r,r||en},threshold:e=>F.toVector(e,0)},es=0,eo=H(H({},ea),{},{axis(e,t,{axis:i}){if(this.lockDirection="lock"===i,!this.lockDirection)return i},axisThreshold:(e=es)=>e,bounds(e={}){if("function"==typeof e)return t=>eo.bounds(e(t));if("current"in e)return()=>e.current;if("function"==typeof HTMLElement&&e instanceof HTMLElement)return e;let{left:t=-1/0,right:i=1/0,top:r=-1/0,bottom:n=1/0}=e;return[[t,i],[r,n]]}}),el={ArrowRight:(e,t=1)=>[e*t,0],ArrowLeft:(e,t=1)=>[-1*e*t,0],ArrowUp:(e,t=1)=>[0,-1*e*t],ArrowDown:(e,t=1)=>[0,e*t]},eu="undefined"!=typeof window&&window.document&&window.document.createElement;function ec(){return eu&&"ontouchstart"in window}let ed={isBrowser:eu,gesture:function(){try{return"constructor"in GestureEvent}catch(e){return!1}}(),touch:ec(),touchscreen:ec()||eu&&window.navigator.maxTouchPoints>1,pointer:eu&&"onpointerdown"in window,pointerLock:eu&&"exitPointerLock"in window.document},eh=10,ef={mouse:0,touch:0,pen:8},ep=H(H({},eo),{},{device(e,t,{pointer:{touch:i=!1,lock:r=!1,mouse:n=!1}={}}){return(this.pointerLock=r&&ed.pointerLock,ed.touch&&i)?"touch":this.pointerLock?"mouse":ed.pointer&&!n?"pointer":ed.touch?"touch":"mouse"},preventScrollAxis(e,t,{preventScroll:i}){if(this.preventScrollDelay="number"==typeof i?i:i||void 0===i&&e?250:void 0,ed.touchscreen&&!1!==i)return e||(void 0!==i?"y":void 0)},pointerCapture(e,t,{pointer:{capture:i=!0,buttons:r=1,keys:n=!0}={}}){return this.pointerButtons=r,this.keys=n,!this.pointerLock&&"pointer"===this.device&&i},threshold(e,t,{filterTaps:i=!1,tapsThreshold:r=3,axis:n}){let a=F.toVector(e,i?r:n?1:0);return this.filterTaps=i,this.tapsThreshold=r,a},swipe({velocity:e=.5,distance:t=50,duration:i=250}={}){return{velocity:this.transform(F.toVector(e)),distance:this.transform(F.toVector(t)),duration:i}},delay(e=0){switch(e){case!0:return 180;case!1:return 0;default:return e}},axisThreshold:e=>e?H(H({},ef),e):ef,keyboardDisplacement:(e=eh)=>e});H(H({},ea),{},{device(e,t,{shared:i,pointer:{touch:r=!1}={}}){if(i.target&&!ed.touch&&ed.gesture)return"gesture";if(ed.touch&&r)return"touch";if(ed.touchscreen){if(ed.pointer)return"pointer";if(ed.touch)return"touch"}},bounds(e,t,{scaleBounds:i={},angleBounds:r={}}){let n=e=>{let t=et(Q(i,e),{min:-1/0,max:1/0});return[t.min,t.max]},a=e=>{let t=et(Q(r,e),{min:-1/0,max:1/0});return[t.min,t.max]};return"function"!=typeof i&&"function"!=typeof r?[n(),a()]:e=>[n(e),a(e)]},threshold(e,t,i){this.lockDirection="lock"===i.axis;let r=F.toVector(e,this.lockDirection?[.1,3]:0);return r},modifierKey:e=>void 0===e?"ctrlKey":e,pinchOnWheel:(e=!0)=>e}),H(H({},eo),{},{mouseOnly:(e=!0)=>e}),H(H({},eo),{},{mouseOnly:(e=!0)=>e});let em=new Map,eg=new Map,ev={key:"drag",engine:class extends er{constructor(...e){super(...e),z(this,"ingKey","dragging")}reset(){super.reset();let e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){let e=this.state;if(e._bounds instanceof HTMLElement){let t=e._bounds.getBoundingClientRect(),i=e.currentTarget.getBoundingClientRect(),r={left:t.left-i.left+e.offset[0],right:t.right-i.right+e.offset[0],top:t.top-i.top+e.offset[1],bottom:t.bottom-i.bottom+e.offset[1]};e._bounds=eo.bounds(r)}}cancel(){let e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){let t=this.config,i=this.state;if(null!=e.buttons&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):-1!==t.pointerButtons&&t.pointerButtons!==e.buttons))return;let r=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),r&&r.size>1&&i._pointerActive||(this.start(e),this.setupPointer(e),i._pointerId=Z(e),i._pointerActive=!0,this.computeValues(J(e)),this.computeInitial(),t.preventScrollAxis&&"mouse"!==K(e)?(i._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){let t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){let t=this.state,i=this.config;if(!t._pointerActive)return;let r=Z(e);if(void 0!==t._pointerId&&r!==t._pointerId)return;let n=J(e);if(document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=F.sub(n,t._values),this.computeValues(n)),F.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional){this.timeoutStore.remove("dragDelay"),t.active=!1,this.startPointerDrag(e);return}if(i.preventScrollAxis&&!t._preventScroll){if(!t.axis)return;if(t.axis===i.preventScrollAxis||"xy"===i.preventScrollAxis){t._active=!1,this.clean();return}this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch(e){}let t=this.state,i=this.config;if(!t._active||!t._pointerActive)return;let r=Z(e);if(void 0!==t._pointerId&&r!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);let[n,a]=t._distance;if(t.tap=n<=i.tapsThreshold&&a<=i.tapsThreshold,t.tap&&i.filterTaps)t._force=!0;else{let[e,r]=t._delta,[n,a]=t._movement,[s,o]=i.swipe.velocity,[l,u]=i.swipe.distance,c=i.swipe.duration;if(t.elapsedTime<c){let i=Math.abs(e/t.timeDelta),c=Math.abs(r/t.timeDelta);i>s&&Math.abs(n)>l&&(t.swipe[0]=Math.sign(e)),c>o&&Math.abs(a)>u&&(t.swipe[1]=Math.sign(r))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){let t=this.config,i=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,i,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,i,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,"persist"in e&&"function"==typeof e.persist&&e.persist();let t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){let t=el[e.key];if(t){let i=this.state,r=e.shiftKey?10:e.altKey?.1:1;this.start(e),i._delta=t(this.config.keyboardDisplacement,r),i._keyboardActive=!0,F.addTo(i._movement,i._delta),this.compute(e),this.emit()}}keyUp(e){e.key in el&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){let t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}},resolver:ep},ey={target(e){if(e)return()=>"current"in e?e.current:e},enabled:(e=!0)=>e,window:(e=ed.isBrowser?window:void 0)=>e,eventOptions:({passive:e=!0,capture:t=!1}={})=>({passive:e,capture:t}),transform:e=>e},eb=["target","eventOptions","window","enabled","transform"];function e_(e={},t){let i={};for(let[r,n]of Object.entries(t))switch(typeof n){case"function":i[r]=n.call(i,e[r],r,e);break;case"object":i[r]=e_(e[r],n);break;case"boolean":n&&(i[r]=e[r])}return i}class eE{constructor(e,t){z(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,i,r,n){let a=this._listeners,s=function(e,t=""){let i=G[e],r=i&&i[t]||t;return e+r}(t,i),o=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},l=H(H({},o),n);e.addEventListener(s,r,l);let u=()=>{e.removeEventListener(s,r,l),a.delete(u)};return a.add(u),u}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class eS{constructor(){z(this,"_timeouts",new Map)}add(e,t,i=140,...r){this.remove(e),this._timeouts.set(e,window.setTimeout(t,i,...r))}remove(e){let t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class ex{constructor(e){z(this,"gestures",new Set),z(this,"_targetEventStore",new eE(this)),z(this,"gestureEventStores",{}),z(this,"gestureTimeoutStores",{}),z(this,"handlers",{}),z(this,"config",{}),z(this,"pointerIds",new Set),z(this,"touchIds",new Set),z(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),e.drag&&eT(this,"drag"),e.wheel&&eT(this,"wheel"),e.scroll&&eT(this,"scroll"),e.move&&eT(this,"move"),e.pinch&&eT(this,"pinch"),e.hover&&eT(this,"hover")}setEventIds(e){return Y(e)?(this.touchIds=new Set(Array.from(e.touches).filter(t=>{var i,r;return t.target===e.currentTarget||(null===(i=e.currentTarget)||void 0===i||null===(r=i.contains)||void 0===r?void 0:r.call(i,t.target))}).map(e=>e.identifier)),this.touchIds):"pointerId"in e?("pointerup"===e.type||"pointercancel"===e.type?this.pointerIds.delete(e.pointerId):"pointerdown"===e.type&&this.pointerIds.add(e.pointerId),this.pointerIds):void 0}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=function(e,t,i={}){let{target:r,eventOptions:n,window:a,enabled:s,transform:o}=e,l=function(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)i=a[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)i=a[r],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(e,eb);if(i.shared=e_({target:r,eventOptions:n,window:a,enabled:s,transform:o},ey),t){let e=eg.get(t);i[t]=e_(H({shared:i.shared},l),e)}else for(let e in l){let t=eg.get(e);t&&(i[e]=e_(H({shared:i.shared},l[e]),t))}return i}(e,t,this.config)}clean(){for(let e of(this._targetEventStore.clean(),this.gestures))this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){let t;let i=this.config.shared,r={};if(!i.target||(t=i.target())){if(i.enabled){for(let i of this.gestures){let n=this.config[i],a=ew(r,n.eventOptions,!!t);if(n.enabled){let t=em.get(i);new t(this,e,i).bind(a)}}let n=ew(r,i.eventOptions,!!t);for(let t in this.nativeHandlers)n(t,"",i=>this.nativeHandlers[t](H(H({},this.state.shared),{},{event:i,args:e})),void 0,!0)}for(let e in r)r[e]=function(...e){return 0===e.length?ee:1===e.length?e[0]:function(){let t;for(let i of e)t=i.apply(this,arguments)||t;return t}}(...r[e]);if(!t)return r;for(let e in r){let{device:i,capture:n,passive:a}=function(e){let t=e.substring(2).toLowerCase(),i=!!~t.indexOf("passive");i&&(t=t.replace("passive",""));let r=q.includes(t)?"capturecapture":"capture",n=!!~t.indexOf(r);return n&&(t=t.replace("capture","")),{device:t,capture:n,passive:i}}(e);this._targetEventStore.add(t,i,"",r[e],{capture:n,passive:a})}}}}function eT(e,t){e.gestures.add(t),e.gestureEventStores[t]=new eE(e,t),e.gestureTimeoutStores[t]=new eS}let ew=(e,t,i)=>(r,n,a,s={},o=!1)=>{var l,u;let c=null!==(l=s.capture)&&void 0!==l?l:t.capture,d=null!==(u=s.passive)&&void 0!==u?u:t.passive,h=o?r:function(e,t="",i=!1){let r=G[e],n=r&&r[t]||t;return"on"+W(e)+W(n)+(!function(e=!1,t){return e&&!$.includes(t)}(i,n)?"":"Capture")}(r,n,c);i&&d&&(h+="Passive"),e[h]=e[h]||[],e[h].push(a)};function eA(e,t,{checkForDefaultPrevented:i=!0}={}){return function(r){if(null==e||e(r),!1===i||!r.defaultPrevented)return null==t?void 0:t(r)}}function eM(e,t=[]){let i=[],r=()=>{let t=i.map(e=>(0,l.createContext)(e));return function(i){let r=(null==i?void 0:i[e])||t;return(0,l.useMemo)(()=>({[`__scope${e}`]:{...i,[e]:r}}),[i,r])}};return r.scopeName=e,[function(t,r){let n=(0,l.createContext)(r),a=i.length;function s(t){let{scope:i,children:r,...s}=t,o=(null==i?void 0:i[e][a])||n,u=(0,l.useMemo)(()=>s,Object.values(s));return(0,l.createElement)(o.Provider,{value:u},r)}return i=[...i,r],s.displayName=t+"Provider",[s,function(i,s){let o=(null==s?void 0:s[e][a])||n,u=(0,l.useContext)(o);if(u)return u;if(void 0!==r)return r;throw Error(`\`${i}\` must be used within \`${t}\``)}]},function(...e){let t=e[0];if(1===e.length)return t;let i=()=>{let i=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let r=i.reduce((t,{useScope:i,scopeName:r})=>{let n=i(e),a=n[`__scope${r}`];return{...t,...a}},{});return(0,l.useMemo)(()=>({[`__scope${t.scopeName}`]:r}),[r])}};return i.scopeName=t.scopeName,i}(r,...t)]}function eR(e){let t=(0,l.useRef)(e);return(0,l.useEffect)(()=>{t.current=e}),(0,l.useMemo)(()=>(...e)=>{var i;return null===(i=t.current)||void 0===i?void 0:i.call(t,...e)},[])}let eC="dismissableLayer.update",eI=(0,l.createContext)({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),eL=(0,l.forwardRef)((e,t)=>{var i;let{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:a,onPointerDownOutside:s,onFocusOutside:o,onInteractOutside:u,onDismiss:d,...f}=e,p=(0,l.useContext)(eI),[m,g]=(0,l.useState)(null),y=null!==(i=null==m?void 0:m.ownerDocument)&&void 0!==i?i:null==globalThis?void 0:globalThis.document,[,b]=(0,l.useState)({}),_=h(t,e=>g(e)),E=Array.from(p.layers),[S]=[...p.layersWithOutsidePointerEventsDisabled].slice(-1),x=E.indexOf(S),T=m?E.indexOf(m):-1,w=p.layersWithOutsidePointerEventsDisabled.size>0,A=T>=x,M=function(e,t=null==globalThis?void 0:globalThis.document){let i=eR(e),r=(0,l.useRef)(!1),n=(0,l.useRef)(()=>{});return(0,l.useEffect)(()=>{let e=e=>{if(e.target&&!r.current){let r={originalEvent:e};function a(){eD("dismissableLayer.pointerDownOutside",i,r,{discrete:!0})}"touch"===e.pointerType?(t.removeEventListener("click",n.current),n.current=a,t.addEventListener("click",n.current,{once:!0})):a()}r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",e)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",e),t.removeEventListener("click",n.current)}},[t,i]),{onPointerDownCapture:()=>r.current=!0}}(e=>{let t=e.target,i=[...p.branches].some(e=>e.contains(t));!A||i||(null==s||s(e),null==u||u(e),e.defaultPrevented||null==d||d())},y),R=function(e,t=null==globalThis?void 0:globalThis.document){let i=eR(e),r=(0,l.useRef)(!1);return(0,l.useEffect)(()=>{let e=e=>{e.target&&!r.current&&eD("dismissableLayer.focusOutside",i,{originalEvent:e},{discrete:!1})};return t.addEventListener("focusin",e),()=>t.removeEventListener("focusin",e)},[t,i]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}(e=>{let t=e.target,i=[...p.branches].some(e=>e.contains(t));i||(null==o||o(e),null==u||u(e),e.defaultPrevented||null==d||d())},y);return!function(e,t=null==globalThis?void 0:globalThis.document){let i=eR(e);(0,l.useEffect)(()=>{let e=e=>{"Escape"===e.key&&i(e)};return t.addEventListener("keydown",e),()=>t.removeEventListener("keydown",e)},[i,t])}(e=>{let t=T===p.layers.size-1;t&&(null==a||a(e),!e.defaultPrevented&&d&&(e.preventDefault(),d()))},y),(0,l.useEffect)(()=>{if(m)return n&&(0===p.layersWithOutsidePointerEventsDisabled.size&&(r=y.body.style.pointerEvents,y.body.style.pointerEvents="none"),p.layersWithOutsidePointerEventsDisabled.add(m)),p.layers.add(m),ek(),()=>{n&&1===p.layersWithOutsidePointerEventsDisabled.size&&(y.body.style.pointerEvents=r)}},[m,y,n,p]),(0,l.useEffect)(()=>()=>{m&&(p.layers.delete(m),p.layersWithOutsidePointerEventsDisabled.delete(m),ek())},[m,p]),(0,l.useEffect)(()=>{let e=()=>b({});return document.addEventListener(eC,e),()=>document.removeEventListener(eC,e)},[]),(0,l.createElement)(v.div,(0,c.Z)({},f,{ref:_,style:{pointerEvents:w?A?"auto":"none":void 0,...e.style},onFocusCapture:eA(e.onFocusCapture,R.onFocusCapture),onBlurCapture:eA(e.onBlurCapture,R.onBlurCapture),onPointerDownCapture:eA(e.onPointerDownCapture,M.onPointerDownCapture)}))});function ek(){let e=new CustomEvent(eC);document.dispatchEvent(e)}function eD(e,t,i,{discrete:r}){let n=i.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:i});(t&&n.addEventListener(e,t,{once:!0}),r)?n&&(0,o.flushSync)(()=>n.dispatchEvent(a)):n.dispatchEvent(a)}let eP=(null==globalThis?void 0:globalThis.document)?l.useLayoutEffect:()=>{},eO=u["useId".toString()]||(()=>void 0),eN=0;var eU=i(83083),eF=i(65896);let eB=e=>({name:"arrow",options:e,fn(t){let{element:i,padding:r}="function"==typeof e?e(t):e;if(i&&({}).hasOwnProperty.call(i,"current")){if(null!=i.current)return(0,eU.x7)({element:i.current,padding:r}).fn(t)}else if(i)return(0,eU.x7)({element:i,padding:r}).fn(t);return{}}});var eV="undefined"!=typeof document?l.useLayoutEffect:l.useEffect;function ez(e,t){let i,r,n;if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((i=e.length)!=t.length)return!1;for(r=i;0!=r--;)if(!ez(e[r],t[r]))return!1;return!0}if((i=(n=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(r=i;0!=r--;)if(!({}).hasOwnProperty.call(t,n[r]))return!1;for(r=i;0!=r--;){let i=n[r];if(("_owner"!==i||!e.$$typeof)&&!ez(e[i],t[i]))return!1}return!0}return e!=e&&t!=t}function ej(e){if("undefined"==typeof window)return 1;let t=e.ownerDocument.defaultView||window;return t.devicePixelRatio||1}function eH(e,t){let i=ej(e);return Math.round(t*i)/i}function eG(e){let t=l.useRef(e);return eV(()=>{t.current=e}),t}let eW=(0,l.forwardRef)((e,t)=>{let{children:i,width:r=10,height:n=5,...a}=e;return(0,l.createElement)(v.svg,(0,c.Z)({},a,{ref:t,width:r,height:n,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),e.asChild?i:(0,l.createElement)("polygon",{points:"0,0 30,0 15,10"}))}),e$="Popper",[eq,eY]=eM(e$),[eK,eX]=eq(e$),eZ=(0,l.forwardRef)((e,t)=>{let{__scopePopper:i,virtualRef:r,...n}=e,a=eX("PopperAnchor",i),s=(0,l.useRef)(null),o=h(t,s);return(0,l.useEffect)(()=>{a.onAnchorChange((null==r?void 0:r.current)||s.current)}),r?null:(0,l.createElement)(v.div,(0,c.Z)({},n,{ref:o}))}),eJ="PopperContent",[eQ,e0]=eq(eJ),e1=(0,l.forwardRef)((e,t)=>{var i,r,n,a,s,u,d,f;let{__scopePopper:p,side:m="bottom",sideOffset:g=0,align:y="center",alignOffset:b=0,arrowPadding:_=0,collisionBoundary:E=[],collisionPadding:S=0,sticky:x="partial",hideWhenDetached:T=!1,avoidCollisions:w=!0,onPlaced:A,...M}=e,R=eX(eJ,p),[C,I]=(0,l.useState)(null),L=h(t,e=>I(e)),[k,D]=(0,l.useState)(null),P=function(e){let[t,i]=(0,l.useState)(void 0);return eP(()=>{if(e){i({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let r,n;if(!Array.isArray(t)||!t.length)return;let a=t[0];if("borderBoxSize"in a){let e=a.borderBoxSize,t=Array.isArray(e)?e[0]:e;r=t.inlineSize,n=t.blockSize}else r=e.offsetWidth,n=e.offsetHeight;i({width:r,height:n})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}i(void 0)},[e]),t}(k),O=null!==(i=null==P?void 0:P.width)&&void 0!==i?i:0,N=null!==(r=null==P?void 0:P.height)&&void 0!==r?r:0,U="number"==typeof S?S:{top:0,right:0,bottom:0,left:0,...S},F=Array.isArray(E)?E:[E],B=F.length>0,V={padding:U,boundary:F.filter(e5),altBoundary:B},{refs:z,floatingStyles:j,placement:H,isPositioned:G,middlewareData:W}=function(e){void 0===e&&(e={});let{placement:t="bottom",strategy:i="absolute",middleware:r=[],platform:n,elements:{reference:a,floating:s}={},transform:u=!0,whileElementsMounted:c,open:d}=e,[h,f]=l.useState({x:0,y:0,strategy:i,placement:t,middlewareData:{},isPositioned:!1}),[p,m]=l.useState(r);ez(p,r)||m(r);let[g,v]=l.useState(null),[y,b]=l.useState(null),_=l.useCallback(e=>{e!=T.current&&(T.current=e,v(e))},[v]),E=l.useCallback(e=>{e!==w.current&&(w.current=e,b(e))},[b]),S=a||g,x=s||y,T=l.useRef(null),w=l.useRef(null),A=l.useRef(h),M=eG(c),R=eG(n),C=l.useCallback(()=>{if(!T.current||!w.current)return;let e={placement:t,strategy:i,middleware:p};R.current&&(e.platform=R.current),(0,eF.oo)(T.current,w.current,e).then(e=>{let t={...e,isPositioned:!0};I.current&&!ez(A.current,t)&&(A.current=t,o.flushSync(()=>{f(t)}))})},[p,t,i,R]);eV(()=>{!1===d&&A.current.isPositioned&&(A.current.isPositioned=!1,f(e=>({...e,isPositioned:!1})))},[d]);let I=l.useRef(!1);eV(()=>(I.current=!0,()=>{I.current=!1}),[]),eV(()=>{if(S&&(T.current=S),x&&(w.current=x),S&&x){if(M.current)return M.current(S,x,C);C()}},[S,x,C,M]);let L=l.useMemo(()=>({reference:T,floating:w,setReference:_,setFloating:E}),[_,E]),k=l.useMemo(()=>({reference:S,floating:x}),[S,x]),D=l.useMemo(()=>{let e={position:i,left:0,top:0};if(!k.floating)return e;let t=eH(k.floating,h.x),r=eH(k.floating,h.y);return u?{...e,transform:"translate("+t+"px, "+r+"px)",...ej(k.floating)>=1.5&&{willChange:"transform"}}:{position:i,left:t,top:r}},[i,u,k.floating,h.x,h.y]);return l.useMemo(()=>({...h,update:C,refs:L,elements:k,floatingStyles:D}),[h,C,L,k,D])}({strategy:"fixed",placement:m+("center"!==y?"-"+y:""),whileElementsMounted:eF.Me,elements:{reference:R.anchor},middleware:[(0,eU.cv)({mainAxis:g+N,alignmentAxis:b}),w&&(0,eU.uY)({mainAxis:!0,crossAxis:!1,limiter:"partial"===x?(0,eU.dr)():void 0,...V}),w&&(0,eU.RR)({...V}),(0,eU.dp)({...V,apply:({elements:e,rects:t,availableWidth:i,availableHeight:r})=>{let{width:n,height:a}=t.reference,s=e.floating.style;s.setProperty("--radix-popper-available-width",`${i}px`),s.setProperty("--radix-popper-available-height",`${r}px`),s.setProperty("--radix-popper-anchor-width",`${n}px`),s.setProperty("--radix-popper-anchor-height",`${a}px`)}}),k&&eB({element:k,padding:_}),e4({arrowWidth:O,arrowHeight:N}),T&&(0,eU.Cp)({strategy:"referenceHidden"})]}),[$,q]=e6(H),Y=eR(A);eP(()=>{G&&(null==Y||Y())},[G,Y]);let K=null===(n=W.arrow)||void 0===n?void 0:n.x,X=null===(a=W.arrow)||void 0===a?void 0:a.y,Z=(null===(s=W.arrow)||void 0===s?void 0:s.centerOffset)!==0,[J,Q]=(0,l.useState)();return eP(()=>{C&&Q(window.getComputedStyle(C).zIndex)},[C]),(0,l.createElement)("div",{ref:z.setFloating,"data-radix-popper-content-wrapper":"",style:{...j,transform:G?j.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:J,"--radix-popper-transform-origin":[null===(u=W.transformOrigin)||void 0===u?void 0:u.x,null===(d=W.transformOrigin)||void 0===d?void 0:d.y].join(" ")},dir:e.dir},(0,l.createElement)(eQ,{scope:p,placedSide:$,onArrowChange:D,arrowX:K,arrowY:X,shouldHideArrow:Z},(0,l.createElement)(v.div,(0,c.Z)({"data-side":$,"data-align":q},M,{ref:L,style:{...M.style,animation:G?void 0:"none",opacity:null!==(f=W.hide)&&void 0!==f&&f.referenceHidden?0:void 0}}))))}),e2={top:"bottom",right:"left",bottom:"top",left:"right"},e3=(0,l.forwardRef)(function(e,t){let{__scopePopper:i,...r}=e,n=e0("PopperArrow",i),a=e2[n.placedSide];return(0,l.createElement)("span",{ref:n.onArrowChange,style:{position:"absolute",left:n.arrowX,top:n.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[n.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[n.placedSide],visibility:n.shouldHideArrow?"hidden":void 0}},(0,l.createElement)(eW,(0,c.Z)({},r,{ref:t,style:{...r.style,display:"block"}})))});function e5(e){return null!==e}let e4=e=>({name:"transformOrigin",options:e,fn(t){var i,r,n,a,s;let{placement:o,rects:l,middlewareData:u}=t,c=(null===(i=u.arrow)||void 0===i?void 0:i.centerOffset)!==0,d=c?0:e.arrowWidth,h=c?0:e.arrowHeight,[f,p]=e6(o),m={start:"0%",center:"50%",end:"100%"}[p],g=(null!==(r=null===(n=u.arrow)||void 0===n?void 0:n.x)&&void 0!==r?r:0)+d/2,v=(null!==(a=null===(s=u.arrow)||void 0===s?void 0:s.y)&&void 0!==a?a:0)+h/2,y="",b="";return"bottom"===f?(y=c?m:`${g}px`,b=`${-h}px`):"top"===f?(y=c?m:`${g}px`,b=`${l.floating.height+h}px`):"right"===f?(y=`${-h}px`,b=c?m:`${v}px`):"left"===f&&(y=`${l.floating.width+h}px`,b=c?m:`${v}px`),{data:{x:y,y:b}}}});function e6(e){let[t,i="center"]=e.split("-");return[t,i]}let e8=e=>{let{__scopePopper:t,children:i}=e,[r,n]=(0,l.useState)(null);return(0,l.createElement)(eK,{scope:t,anchor:r,onAnchorChange:n},i)},e7=e=>{let{present:t,children:i}=e,r=function(e){var t;let[i,r]=(0,l.useState)(),n=(0,l.useRef)({}),a=(0,l.useRef)(e),s=(0,l.useRef)("none"),u=e?"mounted":"unmounted",[c,d]=(t={mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}},(0,l.useReducer)((e,i)=>{let r=t[e][i];return null!=r?r:e},u));return(0,l.useEffect)(()=>{let e=e9(n.current);s.current="mounted"===c?e:"none"},[c]),eP(()=>{let t=n.current,i=a.current,r=i!==e;if(r){let r=s.current,n=e9(t);e?d("MOUNT"):"none"===n||(null==t?void 0:t.display)==="none"?d("UNMOUNT"):i&&r!==n?d("ANIMATION_OUT"):d("UNMOUNT"),a.current=e}},[e,d]),eP(()=>{if(i){let e=e=>{let t=e9(n.current),r=t.includes(e.animationName);e.target===i&&r&&(0,o.flushSync)(()=>d("ANIMATION_END"))},t=e=>{e.target===i&&(s.current=e9(n.current))};return i.addEventListener("animationstart",t),i.addEventListener("animationcancel",e),i.addEventListener("animationend",e),()=>{i.removeEventListener("animationstart",t),i.removeEventListener("animationcancel",e),i.removeEventListener("animationend",e)}}d("ANIMATION_END")},[i,d]),{isPresent:["mounted","unmountSuspended"].includes(c),ref:(0,l.useCallback)(e=>{e&&(n.current=getComputedStyle(e)),r(e)},[])}}(t),n="function"==typeof i?i({present:r.isPresent}):l.Children.only(i),a=h(r.ref,n.ref),s="function"==typeof i;return s||r.isPresent?(0,l.cloneElement)(n,{ref:a}):null};function e9(e){return(null==e?void 0:e.animationName)||"none"}e7.displayName="Presence";let te=(0,l.forwardRef)((e,t)=>(0,l.createElement)(v.span,(0,c.Z)({},e,{ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}))),[tt,ti]=eM("Tooltip",[eY]),tr=eY(),tn="tooltip.open",[ta,ts]=tt("TooltipProvider"),to="Tooltip",[tl,tu]=tt(to),tc="TooltipTrigger",td=(0,l.forwardRef)((e,t)=>{let{__scopeTooltip:i,...r}=e,n=tu(tc,i),a=ts(tc,i),s=tr(i),o=(0,l.useRef)(null),u=h(t,o,n.onTriggerChange),d=(0,l.useRef)(!1),f=(0,l.useRef)(!1),p=(0,l.useCallback)(()=>d.current=!1,[]);return(0,l.useEffect)(()=>()=>document.removeEventListener("pointerup",p),[p]),(0,l.createElement)(eZ,(0,c.Z)({asChild:!0},s),(0,l.createElement)(v.button,(0,c.Z)({"aria-describedby":n.open?n.contentId:void 0,"data-state":n.stateAttribute},r,{ref:u,onPointerMove:eA(e.onPointerMove,e=>{"touch"===e.pointerType||f.current||a.isPointerInTransitRef.current||(n.onTriggerEnter(),f.current=!0)}),onPointerLeave:eA(e.onPointerLeave,()=>{n.onTriggerLeave(),f.current=!1}),onPointerDown:eA(e.onPointerDown,()=>{d.current=!0,document.addEventListener("pointerup",p,{once:!0})}),onFocus:eA(e.onFocus,()=>{d.current||n.onOpen()}),onBlur:eA(e.onBlur,n.onClose),onClick:eA(e.onClick,n.onClose)})))}),[th,tf]=tt("TooltipPortal",{forceMount:void 0}),tp="TooltipContent",tm=(0,l.forwardRef)((e,t)=>{let i=tf(tp,e.__scopeTooltip),{forceMount:r=i.forceMount,side:n="top",...a}=e,s=tu(tp,e.__scopeTooltip);return(0,l.createElement)(e7,{present:r||s.open},s.disableHoverableContent?(0,l.createElement)(tb,(0,c.Z)({side:n},a,{ref:t})):(0,l.createElement)(tg,(0,c.Z)({side:n},a,{ref:t})))}),tg=(0,l.forwardRef)((e,t)=>{let i=tu(tp,e.__scopeTooltip),r=ts(tp,e.__scopeTooltip),n=(0,l.useRef)(null),a=h(t,n),[s,o]=(0,l.useState)(null),{trigger:u,onClose:d}=i,f=n.current,{onPointerInTransitChange:p}=r,m=(0,l.useCallback)(()=>{o(null),p(!1)},[p]),g=(0,l.useCallback)((e,t)=>{let i=e.currentTarget,r={x:e.clientX,y:e.clientY},n=function(e,t){let i=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),n=Math.abs(t.right-e.x),a=Math.abs(t.left-e.x);switch(Math.min(i,r,n,a)){case a:return"left";case n:return"right";case i:return"top";case r:return"bottom";default:throw Error("unreachable")}}(r,i.getBoundingClientRect()),a=function(e,t,i=5){let r=[];switch(t){case"top":r.push({x:e.x-i,y:e.y+i},{x:e.x+i,y:e.y+i});break;case"bottom":r.push({x:e.x-i,y:e.y-i},{x:e.x+i,y:e.y-i});break;case"left":r.push({x:e.x+i,y:e.y-i},{x:e.x+i,y:e.y+i});break;case"right":r.push({x:e.x-i,y:e.y-i},{x:e.x-i,y:e.y+i})}return r}(r,n),s=function(e){let{top:t,right:i,bottom:r,left:n}=e;return[{x:n,y:t},{x:i,y:t},{x:i,y:r},{x:n,y:r}]}(t.getBoundingClientRect()),l=function(e){let t=e.slice();return t.sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0),function(e){if(e.length<=1)return e.slice();let t=[];for(let i=0;i<e.length;i++){let r=e[i];for(;t.length>=2;){let e=t[t.length-1],i=t[t.length-2];if((e.x-i.x)*(r.y-i.y)>=(e.y-i.y)*(r.x-i.x))t.pop();else break}t.push(r)}t.pop();let i=[];for(let t=e.length-1;t>=0;t--){let r=e[t];for(;i.length>=2;){let e=i[i.length-1],t=i[i.length-2];if((e.x-t.x)*(r.y-t.y)>=(e.y-t.y)*(r.x-t.x))i.pop();else break}i.push(r)}return(i.pop(),1===t.length&&1===i.length&&t[0].x===i[0].x&&t[0].y===i[0].y)?t:t.concat(i)}(t)}([...a,...s]);o(l),p(!0)},[p]);return(0,l.useEffect)(()=>()=>m(),[m]),(0,l.useEffect)(()=>{if(u&&f){let e=e=>g(e,f),t=e=>g(e,u);return u.addEventListener("pointerleave",e),f.addEventListener("pointerleave",t),()=>{u.removeEventListener("pointerleave",e),f.removeEventListener("pointerleave",t)}}},[u,f,g,m]),(0,l.useEffect)(()=>{if(s){let e=e=>{let t=e.target,i={x:e.clientX,y:e.clientY},r=(null==u?void 0:u.contains(t))||(null==f?void 0:f.contains(t)),n=!function(e,t){let{x:i,y:r}=e,n=!1;for(let e=0,a=t.length-1;e<t.length;a=e++){let s=t[e].x,o=t[e].y,l=t[a].x,u=t[a].y,c=o>r!=u>r&&i<(l-s)*(r-o)/(u-o)+s;c&&(n=!n)}return n}(i,s);r?m():n&&(m(),d())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[u,f,s,d,m]),(0,l.createElement)(tb,(0,c.Z)({},e,{ref:a}))}),[tv,ty]=tt(to,{isInside:!1}),tb=(0,l.forwardRef)((e,t)=>{let{__scopeTooltip:i,children:r,"aria-label":n,onEscapeKeyDown:a,onPointerDownOutside:s,...o}=e,u=tu(tp,i),d=tr(i),{onClose:h}=u;return(0,l.useEffect)(()=>(document.addEventListener(tn,h),()=>document.removeEventListener(tn,h)),[h]),(0,l.useEffect)(()=>{if(u.trigger){let e=e=>{let t=e.target;null!=t&&t.contains(u.trigger)&&h()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[u.trigger,h]),(0,l.createElement)(eL,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:s,onFocusOutside:e=>e.preventDefault(),onDismiss:h},(0,l.createElement)(e1,(0,c.Z)({"data-state":u.stateAttribute},d,o,{ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}}),(0,l.createElement)(m,null,r),(0,l.createElement)(tv,{scope:i,isInside:!0},(0,l.createElement)(te,{id:u.contentId,role:"tooltip"},n||r))))}),t_=(0,l.forwardRef)((e,t)=>{let{__scopeTooltip:i,...r}=e,n=tr(i),a=ty("TooltipArrow",i);return a.isInside?null:(0,l.createElement)(e3,(0,c.Z)({},n,r,{ref:t}))}),tE=e=>{let{__scopeTooltip:t,children:i,open:r,defaultOpen:n=!1,onOpenChange:a,disableHoverableContent:s,delayDuration:o}=e,u=ts(to,e.__scopeTooltip),c=tr(t),[d,h]=(0,l.useState)(null),f=function(e){let[t,i]=l.useState(eO());return eP(()=>{e||i(e=>null!=e?e:String(eN++))},[e]),e||(t?`radix-${t}`:"")}(),p=(0,l.useRef)(0),m=null!=s?s:u.disableHoverableContent,g=null!=o?o:u.delayDuration,v=(0,l.useRef)(!1),[y=!1,b]=function({prop:e,defaultProp:t,onChange:i=()=>{}}){let[r,n]=function({defaultProp:e,onChange:t}){let i=(0,l.useState)(e),[r]=i,n=(0,l.useRef)(r),a=eR(t);return(0,l.useEffect)(()=>{n.current!==r&&(a(r),n.current=r)},[r,n,a]),i}({defaultProp:t,onChange:i}),a=void 0!==e,s=a?e:r,o=eR(i),u=(0,l.useCallback)(t=>{if(a){let i="function"==typeof t?t(e):t;i!==e&&o(i)}else n(t)},[a,e,n,o]);return[s,u]}({prop:r,defaultProp:n,onChange:e=>{e?(u.onOpen(),document.dispatchEvent(new CustomEvent(tn))):u.onClose(),null==a||a(e)}}),_=(0,l.useMemo)(()=>y?v.current?"delayed-open":"instant-open":"closed",[y]),E=(0,l.useCallback)(()=>{window.clearTimeout(p.current),v.current=!1,b(!0)},[b]),S=(0,l.useCallback)(()=>{window.clearTimeout(p.current),b(!1)},[b]),x=(0,l.useCallback)(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{v.current=!0,b(!0)},g)},[g,b]);return(0,l.useEffect)(()=>()=>window.clearTimeout(p.current),[]),(0,l.createElement)(e8,c,(0,l.createElement)(tl,{scope:t,contentId:f,open:y,stateAttribute:_,trigger:d,onTriggerChange:h,onTriggerEnter:(0,l.useCallback)(()=>{u.isOpenDelayed?x():E()},[u.isOpenDelayed,x,E]),onTriggerLeave:(0,l.useCallback)(()=>{m?S():window.clearTimeout(p.current)},[S,m]),onOpen:E,onClose:S,disableHoverableContent:m},i))};function tS(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)i=a[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)i=a[r],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}(r2=n||(n={}))[r2.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",r2[r2.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",r2[r2.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",r2[r2.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",r2[r2.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",r2[r2.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",r2[r2.THEME_ERROR=6]="THEME_ERROR",r2[r2.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",r2[r2.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",r2[r2.EMPTY_KEY=9]="EMPTY_KEY";let tx={[n.UNSUPPORTED_INPUT]:(e,t)=>[`An input with type \`${e}\` input was found at path \`${t}\` but it's not supported yet.`],[n.NO_COMPONENT_FOR_TYPE]:(e,t)=>[`Type \`${e}\` found at path \`${t}\` can't be displayed in panel because no component supports it yet.`],[n.UNKNOWN_INPUT]:(e,t)=>[`input at path \`${e}\` is not recognized.`,t],[n.DUPLICATE_KEYS]:(e,t,i)=>[`Key \`${e}\` of path \`${t}\` already exists at path \`${i}\`. Even nested keys need to be unique. Rename one of the keys.`],[n.ALREADY_REGISTERED_TYPE]:e=>[`Type ${e} has already been registered. You can't register a component with the same type.`],[n.CLIPBOARD_ERROR]:e=>["Error copying the value",e],[n.THEME_ERROR]:(e,t)=>[`Error accessing the theme \`${e}.${t}\` value.`],[n.PATH_DOESNT_EXIST]:e=>[`Error getting the value at path \`${e}\`. There is probably an error in your \`render\` function.`],[n.PATH_DOESNT_EXIST]:e=>[`Error accessing the value at path \`${e}\``],[n.INPUT_TYPE_OVERRIDE]:(e,t,i)=>[`Input at path \`${e}\` already exists with type: \`${t}\`. Its type cannot be overridden with type \`${i}\`.`],[n.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function tT(e,t,...i){let[r,...n]=tx[t](...i);console[e]("LEVA: "+r,...n)}let tw=tT.bind(null,"warn"),tA=tT.bind(null,"log"),tM=["value"],tR=["schema"],tC=["value"],tI=[],tL={};function tk(e){let{value:t}=e,i=tS(e,tM);for(let e of tI){let r=e(t,i);if(r)return r}}function tD(e,t){let{schema:i}=t,r=tS(t,tR);if(e in tL){tw(n.ALREADY_REGISTERED_TYPE,e);return}tI.push((t,r)=>i(t,r)&&e),tL[e]=r}function tP(e,t,i,r){let{normalize:n}=tL[e];if(n)return n(t,i,r);if("object"!=typeof t||!("value"in t))return{value:t};let{value:a}=t,s=tS(t,tC);return{value:a,settings:s}}function tO(e,t,i){let{format:r}=tL[e];return r?r(t,i):t}function tN(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function tU(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?tN(Object(i),!0).forEach(function(t){var r;r=i[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):tN(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}let tF=(e,t,i)=>e>i?i:e<t?t:e,tB=e=>{if(""===e||"number"==typeof e)return e;try{let t=function e(t){if(isNaN(Number(t))){if(tW.test(t)){let i=t.replace(tW,(t,i)=>String(e(i)));return e(i)}if(t$.test(t)){let i=t.replace(t$,(e,t,i)=>String(Math.pow(Number(t),Number(i))));return e(i)}if(tq.test(t)){let i=t.replace(tq,(e,t,i)=>String(Number(t)*Number(i)));return e(i)}if(tY.test(t)){let i=t.replace(tY,(e,t,i)=>{if(0!=i)return String(Number(t)/Number(i));throw Error("Division by zero")});return e(i)}else if(tK.test(t)){let i=t.replace(tK,(e,t,i)=>String(Number(t)+Number(i)));return e(i)}else if(tX.test(t)){let i=t.replace(tX,(e,t,i)=>String(Number(t)-Number(i)));return e(i)}}return Number(t)}(e);if(!isNaN(t))return t}catch(e){}return parseFloat(e)},tV=Math.log(10);function tz(e){let t=Math.abs(+String(e).replace(".",""));if(0===t)return .01;for(;0!==t&&t%10==0;)t/=10;let i=Math.floor(Math.log(t)/tV)+1;return Math.max(Math.pow(10,Math.floor(Math.log10(Math.abs(e)))-i),.001)}let tj=(e,t,i)=>{if(i===t)return 0;let r=tF(e,t,i);return(r-t)/(i-t)},tH=(e,t,i)=>e*(i-t)+t,tG=()=>"_"+Math.random().toString(36).substr(2,9),tW=/\(([0-9+\-*/^ .]+)\)/,t$=/(\d+(?:\.\d+)?) ?\^ ?(\d+(?:\.\d+)?)/,tq=/(\d+(?:\.\d+)?) ?\* ?(\d+(?:\.\d+)?)/,tY=/(\d+(?:\.\d+)?) ?\/ ?(\d+(?:\.\d+)?)/,tK=/(\d+(?:\.\d+)?) ?\+ ?(\d+(?:\.\d+)?)/,tX=/(\d+(?:\.\d+)?) ?- ?(\d+(?:\.\d+)?)/;function tZ(e){return"[object Object]"===Object.prototype.toString.call(e)}let tJ=e=>tZ(e)&&0===Object.keys(e).length;(r3=a||(a={})).BUTTON="BUTTON",r3.BUTTON_GROUP="BUTTON_GROUP",r3.MONITOR="MONITOR",r3.FOLDER="FOLDER",(r5=s||(s={})).SELECT="SELECT",r5.IMAGE="IMAGE",r5.NUMBER="NUMBER",r5.COLOR="COLOR",r5.STRING="STRING",r5.BOOLEAN="BOOLEAN",r5.INTERVAL="INTERVAL",r5.VECTOR3D="VECTOR3D",r5.VECTOR2D="VECTOR2D";let tQ=["type","__customInput"],t0=["render","label","optional","order","disabled","hint","onChange","onEditStart","onEditEnd","transient"],t1=["type"];function t2(e,t,i,r,n){let{value:a,type:s,settings:o}=e;e.value=t5({type:s,value:a,settings:o},t,i,r),e.fromPanel=n}let t3=function(e,t,i){this.type="LEVA_ERROR",this.message="LEVA: "+e,this.previousValue=t,this.error=i};function t5({type:e,value:t,settings:i},r,n,a){let s;let o="SELECT"!==e&&"function"==typeof r?r(t):r;try{s=function(e,t,i,r,n,a){let{sanitize:s}=tL[e];return s?s(t,i,r,n,a):t}(e,o,i,t,n,a)}catch(e){throw new t3(`The value \`${r}\` did not result in a correct value.`,t,e)}return _(s,t)?t:s}let t4=(e,t,i=!1)=>{let r=0;return function(){let n=arguments,a=i&&!r,s=()=>e.apply(this,n);window.clearTimeout(r),r=window.setTimeout(s,t),a&&s()}},t6=e=>e.shiftKey?5:e.altKey?.2:1,t8=["value"],t7=["min","max"],t9=(e,{min:t=-1/0,max:i=1/0,suffix:r})=>{let n=parseFloat(e);if(""===e||isNaN(n))throw Error("Invalid number");let a=tF(n,t,i);return r?a+r:a},ie=e=>{let{value:t}=e,i=tS(e,t8),{min:r=-1/0,max:n=1/0}=i,a=tS(i,t7),s=parseFloat(t),o="string"==typeof t?t.substring((""+s).length):void 0;s=tF(s,r,n);let l=i.step;!l&&(Number.isFinite(r)?l=Number.isFinite(n)?+(Math.abs(n-r)/100).toPrecision(1):+(Math.abs(s-r)/100).toPrecision(1):Number.isFinite(n)&&(l=+(Math.abs(n-s)/100).toPrecision(1)));let u=l?10*tz(l):tz(s);l=l||u/10;let c=Math.round(tF(Math.log10(1/u),0,2));return{value:o?s+o:s,settings:tU({initialValue:s,step:l,pad:c,min:r,max:n,suffix:o},a)}},it=(e,{step:t,initialValue:i})=>i+Math.round((e-i)/t)*t;var ii=Object.freeze({__proto__:null,schema:e=>{if("number"==typeof e)return!0;if("string"==typeof e){let t=parseFloat(e);if(isNaN(t))return!1;let i=e.substring((""+t).length).trim();return i.length<4}return!1},sanitize:t9,format:(e,{pad:t=0,suffix:i})=>{let r=parseFloat(e).toFixed(t);return i?r+i:r},normalize:ie,sanitizeStep:it});function ir(){return(ir=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}let ia=(0,l.createContext)({});function is(){return(0,l.useContext)(ia)}let io=(0,l.createContext)(null),il=(0,l.createContext)(null),iu=(0,l.createContext)(null);function ic(){return(0,l.useContext)(il)}let id=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function ih(e,t){let[i,r]=e.split(" "),n={};return"none"!==i&&(n.boxShadow=`${t.inset?"inset ":""}0 0 0 $borderWidths${[t.key]} $colors${"default"!==i&&i||t.borderColor}`),r&&(n.backgroundColor=r),n}let ip={$inputStyle:()=>e=>ih(e,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>e=>ih(e,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>e=>ih(e,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>e=>ih(e,{key:"$active",borderColor:"$accent1",inset:!0})},{styled:im,css:ig,createTheme:iv,globalCss:iy,keyframes:ib}=(0,U.Th)({prefix:"leva",theme:id(),utils:tU(tU({},ip),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:e=>({"&:focus":ip.$focusStyle()(e)}),$focusWithin:e=>({"&:focus-within":ip.$focusStyle()(e)}),$hover:e=>({"&:hover":ip.$hoverStyle()(e)}),$active:e=>({"&:active":ip.$activeStyle()(e)})})}),i_=iy({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function iE(e,t){let{theme:i}=(0,l.useContext)(io);if(!(e in i)||!(t in i[e]))return tw(n.THEME_ERROR,e,t),"";let r=t;for(;;){let t=i[e][r];if("string"!=typeof t||"$"!==t.charAt(0))return t;r=t.substr(1)}}let iS=im("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),ix=im("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${iS}`]:{paddingLeft:0}}),iT=im(ix,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),iw=im("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),iA=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],iM=["onUpdate"];function iR(e){let{innerLabel:t,value:i,onUpdate:r,onChange:n,onKeyDown:a,type:s,id:o,inputType:u="text",rows:c=0}=e,d=tS(e,iA),{id:h,emitOnEditStart:f,emitOnEditEnd:p,disabled:m}=is(),g=(0,l.useRef)(null),v=c>0,y=v?"textarea":"input",b=(0,l.useCallback)(e=>t=>{let i=t.currentTarget.value;e(i)},[]);l.useEffect(()=>{let e=g.current,t=b(e=>{r(e),p()});return null==e||e.addEventListener("blur",t),()=>null==e?void 0:e.removeEventListener("blur",t)},[b,r,p]);let _=(0,l.useCallback)(e=>{"Enter"===e.key&&b(r)(e)},[b,r]),E=Object.assign({as:y},v?{rows:c}:{},d);return l.createElement(iw,{textArea:v},t&&"string"==typeof t?l.createElement(ix,null,t):t,l.createElement(iS,ir({levaType:s,ref:g,id:o||h,type:u,autoComplete:"off",spellCheck:"false",value:i,onChange:b(n),onFocus:()=>f(),onKeyPress:_,onKeyDown:a,disabled:m},E)))}function iC(e){let{onUpdate:t}=e,i=tS(e,iM),r=(0,l.useCallback)(e=>t(tB(e)),[t]),n=(0,l.useCallback)(e=>{let i="ArrowUp"===e.key?1:"ArrowDown"===e.key?-1:0;if(i){e.preventDefault();let r=e.altKey?.1:e.shiftKey?10:1;t(e=>parseFloat(e)+i*r)}},[t]);return l.createElement(iR,ir({},i,{onUpdate:r,onKeyDown:n,type:"number"}))}let iI=im("div",{}),iL=im("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]}),ik=im("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${iL}::after`]:{opacity:.6},[`${iI}:hover > & + ${iL}::after`]:{opacity:.6},[`${iI}:hover > & > svg`]:{opacity:1}}),iD=im("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${iI}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),iP=im("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${iD} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),iO=im(iP,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),iN=im("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),iU=im("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),iF=im("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}}),iB=im("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${iF}`]:{pointerEvents:"auto"}}}}}),iV=im("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"}),iz=im("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),ij=im(t_,{fill:"$toolTipBackground"});function iH({children:e}){let{className:t}=(0,l.useContext)(io);return l.createElement(y,{className:t},e)}let iG=["align"];function iW(){let{id:e,disable:t,disabled:i}=is();return l.createElement(l.Fragment,null,l.createElement(iU,{id:e+"__disable",type:"checkbox",checked:!i,onChange:()=>t(!i)}),l.createElement("label",{htmlFor:e+"__disable"}))}function i$(e){let{id:t,optional:i,hint:r}=is(),n=e.htmlFor||(t?{htmlFor:t}:null),a=r||"string"!=typeof e.children?null:{title:e.children};return l.createElement(l.Fragment,null,i&&l.createElement(iW,null),void 0!==r?l.createElement(tE,null,l.createElement(td,{asChild:!0},l.createElement(iF,ir({},n,e))),l.createElement(tm,{side:"top",sideOffset:2},l.createElement(iz,null,r,l.createElement(ij,null)))):l.createElement(iF,ir({},n,a,e)))}function iq(e){let{align:t}=e,i=tS(e,iG),{value:r,label:a,key:s,disabled:o}=is(),{hideCopyButton:u}=(0,l.useContext)(iu),[c,d]=(0,l.useState)(!1),h=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[s]:null!=r?r:""})),d(!0)}catch(e){tw(n.CLIPBOARD_ERROR,{[s]:r})}};return l.createElement(iN,{align:t,onPointerLeave:()=>d(!1)},l.createElement(i$,i),!u&&void 0!==s&&!o&&l.createElement("div",{title:`Click to copy ${"string"==typeof a?a:s} value`},c?l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},l.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),l.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):l.createElement("svg",{onClick:h,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},l.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),l.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}let iY=["toggled"],iK=im("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function iX(e){let{toggled:t}=e,i=tS(e,iY);return l.createElement(iK,ir({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${t?0:-90}deg)`}},i),l.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}let iZ=["input"];function iJ(e){let{input:t}=e,i=tS(e,iZ);return t?l.createElement(iO,i):l.createElement(iP,i)}function iQ({value:e,type:t,settings:i,setValue:r}){let[n,a]=(0,l.useState)(tO(t,e,i)),s=(0,l.useRef)(e),o=(0,l.useRef)(i);o.current=i;let u=(0,l.useCallback)(e=>a(tO(t,e,o.current)),[t]),c=(0,l.useCallback)(e=>{try{r(e)}catch(i){let{type:e,previousValue:t}=i;if("LEVA_ERROR"!==e)throw i;u(t)}},[u,r]);return(0,l.useEffect)(()=>{_(e,s.current)||u(e),s.current=e},[e,u]),{displayValue:n,onChange:a,onUpdate:c}}function i0(e,t){let{emitOnEditStart:i,emitOnEditEnd:r}=is();return em.set(ev.key,ev.engine),eg.set(ev.key,ev.resolver),function(e,t={},i,r){let n=l.useMemo(()=>new ex(e),[]);if(n.applyHandlers(e,void 0),n.applyConfig(t,i),l.useEffect(n.effect.bind(n)),l.useEffect(()=>n.clean.bind(n),[]),void 0===t.target)return n.bind.bind(n)}({drag:t=>{t.first&&(document.body.classList.add("leva__panel__dragged"),null==i||i());let n=e(t);return t.last&&(document.body.classList.remove("leva__panel__dragged"),null==r||r()),n}},t||{},"drag")}function i1(){let e=(0,l.useRef)(null),t=(0,l.useRef)({x:0,y:0}),i=(0,l.useCallback)(i=>{Object.assign(t.current,i),e.current&&(e.current.style.transform=`translate3d(${t.current.x}px, ${t.current.y}px, 0)`)},[]);return[e,i]}let i2=["__refCount"],i3=(e,t)=>{if(!e[t])return null;let i=e[t],r=tS(i,i2);return r},i5=im("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),i4=im("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),i6=im("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),i8=im("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),i7=im("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function i9({value:e,min:t,max:i,onDrag:r,step:n,initialValue:a}){let s=(0,l.useRef)(null),o=(0,l.useRef)(null),u=(0,l.useRef)(0),c=iE("sizes","scrubberWidth"),d=i0(({event:l,first:d,xy:[h],movement:[f],memo:p})=>{if(d){let{width:r,left:n}=s.current.getBoundingClientRect();u.current=r-parseFloat(c);let a=(null==l?void 0:l.target)===o.current;p=a?e:tH((h-n)/r,t,i)}let m=p+tH(f/u.current,0,i-t);return r(it(m,{step:n,initialValue:a})),p}),h=tj(e,t,i);return l.createElement(i8,ir({ref:s},d()),l.createElement(i4,null,l.createElement(i7,{style:{left:0,right:`${(1-h)*100}%`}})),l.createElement(i6,{ref:o,style:{left:`calc(${h} * (100% - ${c}))`}}))}let re=l.memo(({label:e,onUpdate:t,step:i,innerLabelTrim:r})=>{let[n,a]=(0,l.useState)(!1),s=i0(({active:e,delta:[r],event:n,memo:s=0})=>(a(e),Math.abs(s+=r/2)>=1&&(t(e=>parseFloat(e)+Math.floor(s)*i*t6(n)),s=0),s));return l.createElement(iT,ir({dragging:n,title:e.length>1?e:""},s()),e.slice(0,r))});function rt({label:e,id:t,displayValue:i,onUpdate:r,onChange:n,settings:a,innerLabelTrim:s=1}){let o=s>0&&l.createElement(re,{label:e,step:a.step,onUpdate:r,innerLabelTrim:s});return l.createElement(iC,{id:t,value:String(i),onUpdate:r,onChange:n,innerLabel:o})}let{sanitizeStep:ri}=ii,rr=tS(ii,["sanitizeStep"]);var rn=tU({component:function(){let e=is(),{label:t,value:i,onUpdate:r,settings:n,id:a}=e,{min:s,max:o}=n,u=o!==1/0&&s!==-1/0;return l.createElement(iJ,{input:!0},l.createElement(iq,null,t),l.createElement(i5,{hasRange:u},u&&l.createElement(i9,ir({value:parseFloat(i),onDrag:r},n)),l.createElement(rt,ir({},e,{id:a,label:"value",innerLabelTrim:u?0:1}))))}},rr),ra=Object.freeze({__proto__:null,schema:(e,t)=>C().schema({options:C().passesAnyOf(C().object(),C().array())}).test(t),sanitize:(e,{values:t})=>{if(0>t.indexOf(e))throw Error("Selected value doesn't match Select options");return e},format:(e,{values:t})=>t.indexOf(e),normalize:e=>{let t,i,{value:r,options:n}=e;return Array.isArray(n)?(i=n,t=n.map(e=>String(e))):(i=Object.values(n),t=Object.keys(n)),"value"in e?i.includes(r)||(t.unshift(String(r)),i.unshift(r)):r=i[0],Object.values(n).includes(r)||(n[String(r)]=r),{value:r,settings:{keys:t,values:i}}}});let rs=im("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),ro=im("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),rl=im("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${ro}:focus + &`]:{$focusStyle:""},[`${ro}:hover + &`]:{$hoverStyle:""}});function ru({displayValue:e,value:t,onUpdate:i,id:r,settings:n,disabled:a}){let{keys:s,values:o}=n,u=(0,l.useRef)();return t===o[e]&&(u.current=s[e]),l.createElement(rs,null,l.createElement(ro,{id:r,value:e,onChange:e=>i(o[Number(e.currentTarget.value)]),disabled:a},s.map((e,t)=>l.createElement("option",{key:e,value:t},e))),l.createElement(rl,null,u.current),l.createElement(iX,{toggled:!0}))}var rc=tU({component:function(){let{label:e,value:t,displayValue:i,onUpdate:r,id:n,disabled:a,settings:s}=is();return l.createElement(iJ,{input:!0},l.createElement(iq,null,e),l.createElement(ru,{id:n,value:t,displayValue:i,onUpdate:r,settings:s,disabled:a}))}},ra),rd=Object.freeze({__proto__:null,schema:e=>C().string().test(e),sanitize:e=>{if("string"!=typeof e)throw Error("Invalid string");return e},normalize:({value:e,editable:t=!0,rows:i=!1})=>({value:e,settings:{editable:t,rows:"number"==typeof i?i:i?5:0}})});let rh=["displayValue","onUpdate","onChange","editable"],rf=im("div",{whiteSpace:"pre-wrap"});function rp(e){let{displayValue:t,onUpdate:i,onChange:r,editable:n=!0}=e,a=tS(e,rh);return n?l.createElement(iR,ir({value:t,onUpdate:i,onChange:r},a)):l.createElement(rf,null,t)}var rm=tU({component:function(){let{label:e,settings:t,displayValue:i,onUpdate:r,onChange:n}=is();return l.createElement(iJ,{input:!0},l.createElement(iq,null,e),l.createElement(rp,ir({displayValue:i,onUpdate:r,onChange:n},t)))}},rd),rg=Object.freeze({__proto__:null,schema:e=>C().boolean().test(e),sanitize:e=>{if("boolean"!=typeof e)throw Error("Invalid boolean");return e}});let rv=im("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function ry({value:e,onUpdate:t,id:i,disabled:r}){return l.createElement(rv,null,l.createElement("input",{id:i,type:"checkbox",checked:e,onChange:e=>t(e.currentTarget.checked),disabled:r}),l.createElement("label",{htmlFor:i},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},l.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}var rb=tU({component:function(){let{label:e,value:t,onUpdate:i,disabled:r,id:n}=is();return l.createElement(iJ,{input:!0},l.createElement(iq,null,e),l.createElement(ry,{value:t,onUpdate:i,id:n,disabled:r}))}},rg);let r_=["locked"];function rE({value:e,id:t,valueKey:i,settings:r,onUpdate:n,innerLabelTrim:a}){let s=(0,l.useRef)(e[i]);s.current=e[i];let o=(0,l.useCallback)(e=>n({[i]:t5({type:"NUMBER",value:s.current,settings:r},e)}),[n,r,i]),u=iQ({type:"NUMBER",value:e[i],settings:r,setValue:o});return l.createElement(rt,{id:t,label:i,value:e[i],displayValue:u.displayValue,onUpdate:u.onUpdate,onChange:u.onChange,settings:r,innerLabelTrim:a})}let rS=im("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});function rx(e){let{locked:t}=e,i=tS(e,r_);return l.createElement("svg",ir({width:"10",height:"10",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i),t?l.createElement("path",{d:"M5 4.63601C5 3.76031 5.24219 3.1054 5.64323 2.67357C6.03934 2.24705 6.64582 1.9783 7.5014 1.9783C8.35745 1.9783 8.96306 2.24652 9.35823 2.67208C9.75838 3.10299 10 3.75708 10 4.63325V5.99999H5V4.63601ZM4 5.99999V4.63601C4 3.58148 4.29339 2.65754 4.91049 1.99307C5.53252 1.32329 6.42675 0.978302 7.5014 0.978302C8.57583 0.978302 9.46952 1.32233 10.091 1.99162C10.7076 2.65557 11 3.57896 11 4.63325V5.99999H12C12.5523 5.99999 13 6.44771 13 6.99999V13C13 13.5523 12.5523 14 12 14H3C2.44772 14 2 13.5523 2 13V6.99999C2 6.44771 2.44772 5.99999 3 5.99999H4ZM3 6.99999H12V13H3V6.99999Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}):l.createElement("path",{d:"M9 3.63601C9 2.76044 9.24207 2.11211 9.64154 1.68623C10.0366 1.26502 10.6432 1 11.5014 1C12.4485 1 13.0839 1.30552 13.4722 1.80636C13.8031 2.23312 14 2.84313 14 3.63325H15C15 2.68242 14.7626 1.83856 14.2625 1.19361C13.6389 0.38943 12.6743 0 11.5014 0C10.4294 0 9.53523 0.337871 8.91218 1.0021C8.29351 1.66167 8 2.58135 8 3.63601V6H1C0.447715 6 0 6.44772 0 7V13C0 13.5523 0.447715 14 1 14H10C10.5523 14 11 13.5523 11 13V7C11 6.44772 10.5523 6 10 6H9V3.63601ZM1 7H10V13H1V7Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}function rT({value:e,onUpdate:t,settings:i,innerLabelTrim:r}){let{id:n,setSettings:a}=is(),{lock:s,locked:o}=i;return l.createElement(rS,{withLock:s},s&&l.createElement(rx,{locked:o,onClick:()=>a({locked:!o})}),Object.keys(e).map((a,s)=>l.createElement(rE,{id:0===s?n:`${n}.${a}`,key:a,valueKey:a,value:e,settings:i[a],onUpdate:t,innerLabelTrim:r})))}let rw=(e,t)=>{let i={},r=0,n=1/0;for(let a in Object.entries(e).forEach(([e,a])=>{i[e]=ie(tU({value:a},t[e])).settings,r=Math.max(r,i[e].step),n=Math.min(n,i[e].pad)}),i){let{step:e,min:s,max:o}=t[a]||{};isFinite(e)||isFinite(s)&&isFinite(o)||(i[a].step=r,i[a].pad=n)}return i},rA=["lock"],rM=["value"];function rR(e,t,i){return(Array.isArray(e)?"array":"object")===t?e:"array"===t?Object.values(e):e.reduce((e,t,r)=>Object.assign(e,{[i[r]]:t}),{})}let rC=(e,t,i)=>{let r=rR(e,"object",t.keys);for(let e in r)r[e]=t9(r[e],t[e]);let n=Object.keys(r),a={};if(n.length===t.keys.length)a=r;else{let e=rR(i,"object",t.keys);if(1===n.length&&t.locked){let t=n[0],i=r[t],s=e[t],o=0!==s?i/s:1;for(let r in e)r===t?a[t]=i:a[r]=e[r]*o}else a=tU(tU({},e),r)}return rR(a,t.format,t.keys)},rI=(e,t)=>rR(e,"object",t.keys),rL=e=>!!e&&("step"in e||"min"in e||"max"in e);function rk(e){return{schema:function(e){let t=C().array().length(e).every.number(),i=t=>{if(!t||"object"!=typeof t)return!1;let i=Object.values(t);return i.length===e&&i.every(e=>isFinite(e))};return e=>t.test(e)||i(e)}(e.length),normalize:t=>{let{value:i}=t;return function(e,t,i=[]){let{lock:r=!1}=t,n=tS(t,rA),a=Array.isArray(e)?"array":"object",s="object"===a?Object.keys(e):i,o=rR(e,"object",s),l=rL(n)?s.reduce((e,t)=>Object.assign(e,{[t]:n}),{}):n,u=rw(o,l);return{value:"array"===a?e:o,settings:tU(tU({},u),{},{format:a,keys:s,lock:r,locked:!1})}}(i,tS(t,rM),e)},format:(e,t)=>rI(e,t),sanitize:(e,t,i)=>rC(e,t,i)}}var rD=i(32738),rP=i(27696);function rO(){return(rO=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function rN(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(i=a[r])>=0||(n[i]=e[i]);return n}function rU(e){var t=(0,l.useRef)(e),i=(0,l.useRef)(function(e){t.current&&t.current(e)});return t.current=e,i.current}var rF=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=1),e>i?i:e<t?t:e},rB=function(e){return"touches"in e},rV=function(e){return e&&e.ownerDocument.defaultView||self},rz=function(e,t,i){var r=e.getBoundingClientRect(),n=rB(t)?function(e,t){for(var i=0;i<e.length;i++)if(e[i].identifier===t)return e[i];return e[0]}(t.touches,i):t;return{left:rF((n.pageX-(r.left+rV(e).pageXOffset))/r.width),top:rF((n.pageY-(r.top+rV(e).pageYOffset))/r.height)}},rj=function(e){rB(e)||e.preventDefault()},rH=l.memo(function(e){var t=e.onMove,i=e.onKey,r=rN(e,["onMove","onKey"]),n=(0,l.useRef)(null),a=rU(t),s=rU(i),o=(0,l.useRef)(null),u=(0,l.useRef)(!1),c=(0,l.useMemo)(function(){var e=function(e){rj(e),(rB(e)?e.touches.length>0:e.buttons>0)&&n.current?a(rz(n.current,e,o.current)):i(!1)},t=function(){return i(!1)};function i(i){var r=u.current,a=rV(n.current),s=i?a.addEventListener:a.removeEventListener;s(r?"touchmove":"mousemove",e),s(r?"touchend":"mouseup",t)}return[function(e){var t=e.nativeEvent,r=n.current;if(r&&(rj(t),(!u.current||rB(t))&&r)){if(rB(t)){u.current=!0;var s=t.changedTouches||[];s.length&&(o.current=s[0].identifier)}r.focus(),a(rz(r,t,o.current)),i(!0)}},function(e){var t=e.which||e.keyCode;t<37||t>40||(e.preventDefault(),s({left:39===t?.05:37===t?-.05:0,top:40===t?.05:38===t?-.05:0}))},i]},[s,a]),d=c[0],h=c[1],f=c[2];return(0,l.useEffect)(function(){return f},[f]),l.createElement("div",rO({},r,{onTouchStart:d,onMouseDown:d,className:"react-colorful__interactive",ref:n,onKeyDown:h,tabIndex:0,role:"slider"}))}),rG=function(e){return e.filter(Boolean).join(" ")},rW=function(e){var t=e.color,i=e.left,r=e.top,n=rG(["react-colorful__pointer",e.className]);return l.createElement("div",{className:n,style:{top:100*(void 0===r?.5:r)+"%",left:100*i+"%"}},l.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:t}}))},r$=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=Math.pow(10,t)),Math.round(i*e)/i},rq=function(e){var t=e.s,i=e.v,r=e.a,n=(200-t)*i/100;return{h:r$(e.h),s:r$(n>0&&n<200?t*i/100/(n<=100?n:200-n)*100:0),l:r$(n/2),a:r$(r,2)}},rY=function(e){var t=rq(e);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},rK=function(e){var t=rq(e);return"hsla("+t.h+", "+t.s+"%, "+t.l+"%, "+t.a+")"},rX=function(e){var t=e.h,i=e.s,r=e.v,n=e.a;t=t/360*6,i/=100,r/=100;var a=Math.floor(t),s=r*(1-i),o=r*(1-(t-a)*i),l=r*(1-(1-t+a)*i),u=a%6;return{r:r$(255*[r,o,s,s,l,r][u]),g:r$(255*[l,r,r,o,s,s][u]),b:r$(255*[s,s,l,r,r,o][u]),a:r$(n,2)}},rZ=function(e){var t=e.r,i=e.g,r=e.b,n=e.a,a=Math.max(t,i,r),s=a-Math.min(t,i,r),o=s?a===t?(i-r)/s:a===i?2+(r-t)/s:4+(t-i)/s:0;return{h:r$(60*(o<0?o+6:o)),s:r$(a?s/a*100:0),v:r$(a/255*100),a:n}},rJ=l.memo(function(e){var t=e.hue,i=e.onChange,r=rG(["react-colorful__hue",e.className]);return l.createElement("div",{className:r},l.createElement(rH,{onMove:function(e){i({h:360*e.left})},onKey:function(e){i({h:rF(t+360*e.left,0,360)})},"aria-label":"Hue","aria-valuenow":r$(t),"aria-valuemax":"360","aria-valuemin":"0"},l.createElement(rW,{className:"react-colorful__hue-pointer",left:t/360,color:rY({h:t,s:100,v:100,a:1})})))}),rQ=l.memo(function(e){var t=e.hsva,i=e.onChange,r={backgroundColor:rY({h:t.h,s:100,v:100,a:1})};return l.createElement("div",{className:"react-colorful__saturation",style:r},l.createElement(rH,{onMove:function(e){i({s:100*e.left,v:100-100*e.top})},onKey:function(e){i({s:rF(t.s+100*e.left,0,100),v:rF(t.v-100*e.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+r$(t.s)+"%, Brightness "+r$(t.v)+"%"},l.createElement(rW,{className:"react-colorful__saturation-pointer",top:1-t.v/100,left:t.s/100,color:rY(t)})))}),r0=function(e,t){if(e===t)return!0;for(var i in e)if(e[i]!==t[i])return!1;return!0};function r1(e,t,i){var r=rU(i),n=(0,l.useState)(function(){return e.toHsva(t)}),a=n[0],s=n[1],o=(0,l.useRef)({color:t,hsva:a});return(0,l.useEffect)(function(){if(!e.equal(t,o.current.color)){var i=e.toHsva(t);o.current={hsva:i,color:t},s(i)}},[t,e]),(0,l.useEffect)(function(){var t;r0(a,o.current.hsva)||e.equal(t=e.fromHsva(a),o.current.color)||(o.current={hsva:a,color:t},r(t))},[a,e,r]),[a,(0,l.useCallback)(function(e){s(function(t){return Object.assign({},t,e)})},[])]}var r2,r3,r5,r4,r6="undefined"!=typeof window?l.useLayoutEffect:l.useEffect,r8=new Map,r7=function(e){r6(function(){var t=e.current?e.current.ownerDocument:document;if(void 0!==t&&!r8.has(t)){var r=t.createElement("style");r.innerHTML='.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}',r8.set(t,r);var n=r4||i.nc;n&&r.setAttribute("nonce",n),t.head.appendChild(r)}},[])},r9=function(e){var t=e.className,i=e.colorModel,r=e.color,n=void 0===r?i.defaultColor:r,a=e.onChange,s=rN(e,["className","colorModel","color","onChange"]),o=(0,l.useRef)(null);r7(o);var u=r1(i,n,a),c=u[0],d=u[1],h=rG(["react-colorful",t]);return l.createElement("div",rO({},s,{ref:o,className:h}),l.createElement(rQ,{hsva:c,onChange:d}),l.createElement(rJ,{hue:c.h,onChange:d,className:"react-colorful__last-control"}))},ne=function(e){var t=e.className,i=e.hsva,r=e.onChange,n={backgroundImage:"linear-gradient(90deg, "+rK(Object.assign({},i,{a:0}))+", "+rK(Object.assign({},i,{a:1}))+")"},a=rG(["react-colorful__alpha",t]),s=r$(100*i.a);return l.createElement("div",{className:a},l.createElement("div",{className:"react-colorful__alpha-gradient",style:n}),l.createElement(rH,{onMove:function(e){r({a:e.left})},onKey:function(e){r({a:rF(i.a+e.left)})},"aria-label":"Alpha","aria-valuetext":s+"%","aria-valuenow":s,"aria-valuemin":"0","aria-valuemax":"100"},l.createElement(rW,{className:"react-colorful__alpha-pointer",left:i.a,color:rK(i)})))},nt=function(e){var t=e.className,i=e.colorModel,r=e.color,n=void 0===r?i.defaultColor:r,a=e.onChange,s=rN(e,["className","colorModel","color","onChange"]),o=(0,l.useRef)(null);r7(o);var u=r1(i,n,a),c=u[0],d=u[1],h=rG(["react-colorful",t]);return l.createElement("div",rO({},s,{ref:o,className:h}),l.createElement(rQ,{hsva:c,onChange:d}),l.createElement(rJ,{hue:c.h,onChange:d}),l.createElement(ne,{hsva:c,onChange:d,className:"react-colorful__last-control"}))},ni={defaultColor:{r:0,g:0,b:0,a:1},toHsva:rZ,fromHsva:rX,equal:r0},nr=function(e){return l.createElement(nt,rO({},e,{colorModel:ni}))},nn={defaultColor:{r:0,g:0,b:0},toHsva:function(e){return rZ({r:e.r,g:e.g,b:e.b,a:1})},fromHsva:function(e){var t;return{r:(t=rX(e)).r,g:t.g,b:t.b}},equal:r0},na=function(e){return l.createElement(r9,rO({},e,{colorModel:nn}))},ns=i(40507),no=i.n(ns),nl=i(99938),nu=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function nc(e,t){var i=function(e){var t=e.name;if(t&&-1!==t.lastIndexOf(".")&&!e.type){var i=t.split(".").pop().toLowerCase(),r=nu.get(i);r&&Object.defineProperty(e,"type",{value:r,writable:!1,configurable:!1,enumerable:!0})}return e}(e);if("string"!=typeof i.path){var r=e.webkitRelativePath;Object.defineProperty(i,"path",{value:"string"==typeof t?t:"string"==typeof r&&r.length>0?r:e.name,writable:!1,configurable:!1,enumerable:!0})}return i}var nd=[".DS_Store","Thumbs.db"];function nh(e){return"object"==typeof e&&null!==e}function nf(e){return e.filter(function(e){return -1===nd.indexOf(e.name)})}function np(e){if(null===e)return[];for(var t=[],i=0;i<e.length;i++){var r=e[i];t.push(r)}return t}function nm(e){if("function"!=typeof e.webkitGetAsEntry)return ng(e);var t=e.webkitGetAsEntry();return t&&t.isDirectory?ny(t):ng(e)}function ng(e){var t=e.getAsFile();return t?Promise.resolve(nc(t)):Promise.reject(e+" is not a File")}function nv(e){return(0,nl.mG)(this,void 0,void 0,function(){return(0,nl.Jh)(this,function(t){return[2,e.isDirectory?ny(e):function(e){return(0,nl.mG)(this,void 0,void 0,function(){return(0,nl.Jh)(this,function(t){return[2,new Promise(function(t,i){e.file(function(i){t(nc(i,e.fullPath))},function(e){i(e)})})]})})}(e)]})})}function ny(e){var t=e.createReader();return new Promise(function(e,i){var r=[];!function n(){var a=this;t.readEntries(function(t){return(0,nl.mG)(a,void 0,void 0,function(){var a;return(0,nl.Jh)(this,function(s){switch(s.label){case 0:if(t.length)return[3,5];s.label=1;case 1:return s.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return e(s.sent()),[3,4];case 3:return i(s.sent()),[3,4];case 4:return[3,6];case 5:a=Promise.all(t.map(nv)),r.push(a),n(),s.label=6;case 6:return[2]}})})},function(e){i(e)})}()})}var nb=i(67715);function n_(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function nE(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n_(Object(i),!0).forEach(function(t){nS(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n_(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function nS(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function nx(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i,r,n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(o)throw r}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return nT(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return nT(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nT(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}var nw=function(e){var t=Array.isArray(e=Array.isArray(e)&&1===e.length?e[0]:e)?"one of ".concat(e.join(", ")):e;return{code:"file-invalid-type",message:"File type must be ".concat(t)}},nA=function(e){return{code:"file-too-large",message:"File is larger than ".concat(e," ").concat(1===e?"byte":"bytes")}},nM=function(e){return{code:"file-too-small",message:"File is smaller than ".concat(e," ").concat(1===e?"byte":"bytes")}},nR={code:"too-many-files",message:"Too many files"};function nC(e,t){var i="application/x-moz-file"===e.type||(0,nb.Z)(e,t);return[i,i?null:nw(t)]}function nI(e,t,i){if(nL(e.size)){if(nL(t)&&nL(i)){if(e.size>i)return[!1,nA(i)];if(e.size<t)return[!1,nM(t)]}else if(nL(t)&&e.size<t)return[!1,nM(t)];else if(nL(i)&&e.size>i)return[!1,nA(i)]}return[!0,null]}function nL(e){return null!=e}function nk(e){return"function"==typeof e.isPropagationStopped?e.isPropagationStopped():void 0!==e.cancelBubble&&e.cancelBubble}function nD(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(e){return"Files"===e||"application/x-moz-file"===e}):!!e.target&&!!e.target.files}function nP(e){e.preventDefault()}function nO(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];return function(e){for(var i=arguments.length,r=Array(i>1?i-1:0),n=1;n<i;n++)r[n-1]=arguments[n];return t.some(function(t){return!nk(e)&&t&&t.apply(void 0,[e].concat(r)),nk(e)})}}var nN=["children"],nU=["open"],nF=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],nB=["refKey","onChange","onClick"];function nV(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i,r,n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a=[],s=!0,o=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){o=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(o)throw r}}return a}}(e,t)||nz(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nz(e,t){if(e){if("string"==typeof e)return nj(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);if("Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return nj(e,t)}}function nj(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function nH(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function nG(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?nH(Object(i),!0).forEach(function(t){nW(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):nH(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function nW(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function n$(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)i=a[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)i=a[r],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var nq=(0,l.forwardRef)(function(e,t){var i=e.children,r=nX(n$(e,nN)),n=r.open,a=n$(r,nU);return(0,l.useImperativeHandle)(t,function(){return{open:n}},[n]),l.createElement(l.Fragment,null,i(nG(nG({},a),{},{open:n})))});nq.displayName="Dropzone";var nY={disabled:!1,getFilesFromEvent:function(e){return(0,nl.mG)(this,void 0,void 0,function(){return(0,nl.Jh)(this,function(t){return nh(e)&&nh(e.dataTransfer)?[2,function(e,t){return(0,nl.mG)(this,void 0,void 0,function(){var i;return(0,nl.Jh)(this,function(r){switch(r.label){case 0:if(null===e)return[2,[]];if(!e.items)return[3,2];if(i=np(e.items).filter(function(e){return"file"===e.kind}),"drop"!==t)return[2,i];return[4,Promise.all(i.map(nm))];case 1:return[2,nf(function e(t){return t.reduce(function(t,i){return(0,nl.fl)(t,Array.isArray(i)?e(i):[i])},[])}(r.sent()))];case 2:return[2,nf(np(e.files).map(function(e){return nc(e)}))]}})})}(e.dataTransfer,e.type)]:nh(e)&&nh(e.target)?[2,np(e.target.files).map(function(e){return nc(e)})]:Array.isArray(e)&&e.every(function(e){return"getFile"in e&&"function"==typeof e.getFile})?[2,function(e){return(0,nl.mG)(this,void 0,void 0,function(){return(0,nl.Jh)(this,function(t){switch(t.label){case 0:return[4,Promise.all(e.map(function(e){return e.getFile()}))];case 1:return[2,t.sent().map(function(e){return nc(e)})]}})})}(e)]:[2,[]]})})},maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0};nq.defaultProps=nY,nq.propTypes={children:no().func,accept:no().oneOfType([no().string,no().arrayOf(no().string)]),multiple:no().bool,preventDropOnDocument:no().bool,noClick:no().bool,noKeyboard:no().bool,noDrag:no().bool,noDragEventsBubbling:no().bool,minSize:no().number,maxSize:no().number,maxFiles:no().number,disabled:no().bool,getFilesFromEvent:no().func,onFileDialogCancel:no().func,onFileDialogOpen:no().func,useFsAccessApi:no().bool,onDragEnter:no().func,onDragLeave:no().func,onDragOver:no().func,onDrop:no().func,onDropAccepted:no().func,onDropRejected:no().func,validator:no().func};var nK={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function nX(){var e,t,i,r,n,a,s,o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},u=nG(nG({},nY),o),c=u.accept,d=u.disabled,h=u.getFilesFromEvent,f=u.maxSize,p=u.minSize,m=u.multiple,g=u.maxFiles,v=u.onDragEnter,y=u.onDragLeave,b=u.onDragOver,_=u.onDrop,E=u.onDropAccepted,S=u.onDropRejected,x=u.onFileDialogCancel,T=u.onFileDialogOpen,w=u.useFsAccessApi,A=u.preventDropOnDocument,M=u.noClick,R=u.noKeyboard,C=u.noDrag,I=u.noDragEventsBubbling,L=u.validator,k=(0,l.useMemo)(function(){return"function"==typeof T?T:nJ},[T]),D=(0,l.useMemo)(function(){return"function"==typeof x?x:nJ},[x]),P=(0,l.useRef)(null),O=(0,l.useRef)(null),N=nV((0,l.useReducer)(nZ,nK),2),U=N[0],F=N[1],B=U.isFocused,V=U.isFileDialogActive,z=U.draggedFiles,j=(0,l.useRef)("undefined"!=typeof window&&window.isSecureContext&&w&&"showOpenFilePicker"in window),H=function(){!j.current&&V&&setTimeout(function(){O.current&&!O.current.files.length&&(F({type:"closeDialog"}),D())},300)};(0,l.useEffect)(function(){return window.addEventListener("focus",H,!1),function(){window.removeEventListener("focus",H,!1)}},[O,V,D,j]);var G=(0,l.useRef)([]),W=function(e){P.current&&P.current.contains(e.target)||(e.preventDefault(),G.current=[])};(0,l.useEffect)(function(){return A&&(document.addEventListener("dragover",nP,!1),document.addEventListener("drop",W,!1)),function(){A&&(document.removeEventListener("dragover",nP),document.removeEventListener("drop",W))}},[P,A]);var $=(0,l.useCallback)(function(e){var t;e.preventDefault(),e.persist(),ea(e),G.current=[].concat(function(e){if(Array.isArray(e))return nj(e)}(t=G.current)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||nz(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),[e.target]),nD(e)&&Promise.resolve(h(e)).then(function(t){(!nk(e)||I)&&(F({draggedFiles:t,isDragActive:!0,type:"setDraggedFiles"}),v&&v(e))})},[h,v,I]),q=(0,l.useCallback)(function(e){e.preventDefault(),e.persist(),ea(e);var t=nD(e);if(t&&e.dataTransfer)try{e.dataTransfer.dropEffect="copy"}catch(e){}return t&&b&&b(e),!1},[b,I]),Y=(0,l.useCallback)(function(e){e.preventDefault(),e.persist(),ea(e);var t=G.current.filter(function(e){return P.current&&P.current.contains(e)}),i=t.indexOf(e.target);-1!==i&&t.splice(i,1),G.current=t,!(t.length>0)&&(F({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),nD(e)&&y&&y(e))},[P,y,I]),K=(0,l.useCallback)(function(e,t){var i=[],r=[];e.forEach(function(e){var t=nV(nC(e,c),2),n=t[0],a=t[1],s=nV(nI(e,p,f),2),o=s[0],l=s[1],u=L?L(e):null;if(n&&o&&!u)i.push(e);else{var d=[a,l];u&&(d=d.concat(u)),r.push({file:e,errors:d.filter(function(e){return e})})}}),(!m&&i.length>1||m&&g>=1&&i.length>g)&&(i.forEach(function(e){r.push({file:e,errors:[nR]})}),i.splice(0)),F({acceptedFiles:i,fileRejections:r,type:"setFiles"}),_&&_(i,r,t),r.length>0&&S&&S(r,t),i.length>0&&E&&E(i,t)},[F,m,c,p,f,g,_,E,S,L]),X=(0,l.useCallback)(function(e){e.preventDefault(),e.persist(),ea(e),G.current=[],nD(e)&&Promise.resolve(h(e)).then(function(t){(!nk(e)||I)&&K(t,e)}),F({type:"reset"})},[h,K,I]),Z=(0,l.useCallback)(function(){if(j.current){F({type:"openDialog"}),k();var e,t={multiple:m,types:[{description:"everything",accept:Array.isArray(e="string"==typeof(e=c)?e.split(","):e)?e.filter(function(e){return"audio/*"===e||"video/*"===e||"image/*"===e||"text/*"===e||/\w+\/[-+.\w]+/g.test(e)}).reduce(function(e,t){return nE(nE({},e),{},nS({},t,[]))},{}):{}}]};window.showOpenFilePicker(t).then(function(e){return h(e)}).then(function(e){K(e,null),F({type:"closeDialog"})}).catch(function(e){e instanceof DOMException&&("AbortError"===e.name||e.code===e.ABORT_ERR)?(D(e),F({type:"closeDialog"})):e instanceof DOMException&&("SecurityError"===e.name||e.code===e.SECURITY_ERR)&&(j.current=!1,O.current&&(O.current.value=null,O.current.click()))});return}O.current&&(F({type:"openDialog"}),k(),O.current.value=null,O.current.click())},[F,k,D,w,K,c,m]),J=(0,l.useCallback)(function(e){P.current&&P.current.isEqualNode(e.target)&&(" "===e.key||"Enter"===e.key||32===e.keyCode||13===e.keyCode)&&(e.preventDefault(),Z())},[P,Z]),Q=(0,l.useCallback)(function(){F({type:"focus"})},[]),ee=(0,l.useCallback)(function(){F({type:"blur"})},[]),et=(0,l.useCallback)(function(){M||(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.navigator.userAgent;return -1!==e.indexOf("MSIE")||-1!==e.indexOf("Trident/")||-1!==e.indexOf("Edge/")}()?setTimeout(Z,0):Z())},[M,Z]),ei=function(e){return d?null:e},er=function(e){return R?null:ei(e)},en=function(e){return C?null:ei(e)},ea=function(e){I&&e.stopPropagation()},es=(0,l.useMemo)(function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.refKey,i=void 0===t?"ref":t,r=e.role,n=e.onKeyDown,a=e.onFocus,s=e.onBlur,o=e.onClick,l=e.onDragEnter,u=e.onDragOver,c=e.onDragLeave,h=e.onDrop,f=n$(e,nF);return nG(nG(nW({onKeyDown:er(nO(n,J)),onFocus:er(nO(a,Q)),onBlur:er(nO(s,ee)),onClick:ei(nO(o,et)),onDragEnter:en(nO(l,$)),onDragOver:en(nO(u,q)),onDragLeave:en(nO(c,Y)),onDrop:en(nO(h,X)),role:"string"==typeof r&&""!==r?r:"button"},i,P),d||R?{}:{tabIndex:0}),f)}},[P,J,Q,ee,et,$,q,Y,X,R,C,d]),eo=(0,l.useCallback)(function(e){e.stopPropagation()},[]),el=(0,l.useMemo)(function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.refKey,i=void 0===t?"ref":t,r=e.onChange,n=e.onClick,a=n$(e,nB);return nG(nG({},nW({accept:c,multiple:m,type:"file",style:{display:"none"},onChange:ei(nO(r,X)),onClick:ei(nO(n,eo)),tabIndex:-1},i,O)),a)}},[O,c,m,X,d]),eu=z.length,ec=eu>0&&(t=(e={files:z,accept:c,minSize:p,maxSize:f,multiple:m,maxFiles:g}).files,i=e.accept,r=e.minSize,n=e.maxSize,a=e.multiple,s=e.maxFiles,(!!a||!(t.length>1))&&(!a||!(s>=1)||!(t.length>s))&&t.every(function(e){var t=nx(nC(e,i),1)[0],a=nx(nI(e,r,n),1)[0];return t&&a}));return nG(nG({},U),{},{isDragAccept:ec,isDragReject:eu>0&&!ec,isFocused:B&&!d,getRootProps:es,getInputProps:el,rootRef:P,inputRef:O,open:ei(Z)})}function nZ(e,t){switch(t.type){case"focus":return nG(nG({},e),{},{isFocused:!0});case"blur":return nG(nG({},e),{},{isFocused:!1});case"openDialog":return nG(nG({},nK),{},{isFileDialogActive:!0});case"closeDialog":return nG(nG({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":var i=t.isDragActive,r=t.draggedFiles;return nG(nG({},e),{},{draggedFiles:r,isDragActive:i});case"setFiles":return nG(nG({},e),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"reset":return nG({},nK);default:return e}}function nJ(){}var nQ=i(31171);Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let n0=e=>(t,i,r)=>{let n=r.subscribe;r.subscribe=(e,t,i)=>{let a=e;if(t){let n=(null==i?void 0:i.equalityFn)||Object.is,s=e(r.getState());a=i=>{let r=e(i);if(!n(s,r)){let e=s;t(s=r,e)}},(null==i?void 0:i.fireImmediately)&&t(s,s)}return n(a)};let a=e(t,i,r);return a};Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var n1=i(31378),n2=i.n(n1);let n3=(...e)=>e.filter(Boolean).join(".");function n5(e,t){return(0,l.useMemo)(e,function(e,t){let i=(0,l.useRef)(),r=t?_:E;return r(e,i.current)||(i.current=e),i.current}(t,!0))}let n4=e=>{let[t,i]=(0,l.useState)(e.getVisiblePaths());return(0,l.useEffect)(()=>{i(e.getVisiblePaths());let t=e.useStore.subscribe(e.getVisiblePaths,i,{equalityFn:E});return()=>t()},[e]),t};function n6(e=3){let t=(0,l.useRef)(null),i=(0,l.useRef)(null),[r,n]=(0,l.useState)(!1),a=(0,l.useCallback)(()=>n(!0),[]),s=(0,l.useCallback)(()=>n(!1),[]);return(0,l.useLayoutEffect)(()=>{if(r){let{bottom:r,top:n,left:a}=t.current.getBoundingClientRect(),{height:s}=i.current.getBoundingClientRect(),o=r+s>window.innerHeight-40?"up":"down";i.current.style.position="fixed",i.current.style.zIndex="10000",i.current.style.left=a+"px","down"===o?i.current.style.top=r+e+"px":i.current.style.bottom=window.innerHeight-n+e+"px"}},[e,r]),{popinRef:t,wrapperRef:i,shown:r,show:a,hide:s}}(0,rD.l7)([rP.Z]);let n8={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};function n7(e,{format:t,hasAlpha:i,isString:r}){let n=n8[t]+(r&&"hex"!==t?"String":""),a=e[n]();return"object"!=typeof a||i?a:function(e,t){let i=tU({},e);return t.forEach(t=>t in e&&delete i[t]),i}(a,["a"])}C.extend({color:()=>e=>(0,rD.Vi)(e).isValid()});let n9=(e,t)=>{let i=(0,rD.Vi)(e);if(!i.isValid())throw Error("Invalid color");return n7(i,t)};var ae=Object.freeze({__proto__:null,schema:e=>C().color().test(e),sanitize:n9,format:(e,t)=>n7((0,rD.Vi)(e),tU(tU({},t),{},{isString:!0,format:"hex"})),normalize:({value:e})=>{let t=(0,rD.y6)(e),i="object"==typeof e?"a"in e:"hex"===t&&8===e.length||/^(rgba)|(hsla)|(hsva)/.test(e),r={format:"name"===t?"hex":t,hasAlpha:i,isString:"string"==typeof e};return{value:n9(e,r),settings:r}}});let at=im("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:'url(\'data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>\')',$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),ai=im("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),ar=im("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function an(e,t){return"rgb"!==t?(0,rD.Vi)(e).toRgb():e}function aa({value:e,displayValue:t,settings:i,onUpdate:r}){let{emitOnEditStart:n,emitOnEditEnd:a}=is(),{format:s,hasAlpha:o}=i,{popinRef:u,wrapperRef:c,shown:d,show:h,hide:f}=n6(),p=(0,l.useRef)(0),[m,g]=(0,l.useState)(()=>an(e,s)),v=o?nr:na,y=()=>{g(an(e,s)),h(),n()},b=()=>{f(),a(),window.clearTimeout(p.current)},_=()=>{p.current=window.setTimeout(b,500)};return(0,l.useEffect)(()=>()=>window.clearTimeout(p.current),[]),l.createElement(l.Fragment,null,l.createElement(at,{ref:u,active:d,onClick:()=>y(),style:{color:t}}),d&&l.createElement(iH,null,l.createElement(iV,{onPointerUp:b}),l.createElement(ar,{ref:c,onMouseEnter:()=>window.clearTimeout(p.current),onMouseLeave:e=>0===e.buttons&&_()},l.createElement(v,{color:m,onChange:r}))))}var as=tU({component:function(){let{value:e,displayValue:t,label:i,onChange:r,onUpdate:n,settings:a}=is();return l.createElement(iJ,{input:!0},l.createElement(iq,null,i),l.createElement(ai,null,l.createElement(aa,{value:e,displayValue:t,onChange:r,onUpdate:n,settings:a}),l.createElement(iR,{value:t,onChange:r,onUpdate:n})))}},ae),ao=tU({component:function(){let{label:e,displayValue:t,onUpdate:i,settings:r}=is();return l.createElement(iJ,{input:!0},l.createElement(iq,null,e),l.createElement(rT,{value:t,settings:r,onUpdate:i}))}},rk(["x","y","z"]));let al=im("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),au=im("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function ac({value:e,settings:t,onUpdate:i}){let r=(0,l.useRef)(),n=(0,l.useRef)(0),a=(0,l.useRef)(0),s=(0,l.useRef)(1),[o,u]=(0,l.useState)(!1),[c,d]=(0,l.useState)(!1),[h,f]=i1(),p=(0,l.useRef)(null),m=(0,l.useRef)(null);(0,l.useLayoutEffect)(()=>{if(o){let{top:e,left:t,width:i,height:r}=p.current.getBoundingClientRect();m.current.style.left=t+i/2+"px",m.current.style.top=e+r/2+"px"}},[o]);let{keys:[g,v],joystick:y}=t,b="invertY"===y?1:-1,{[g]:{step:_},[v]:{step:E}}=t,S=iE("sizes","joystickWidth"),x=iE("sizes","joystickHeight"),T=.8*parseFloat(S)/2,w=.8*parseFloat(x)/2,A=(0,l.useCallback)(()=>{r.current||(d(!0),n.current&&f({x:n.current*T}),a.current&&f({y:-(a.current*w)}),r.current=window.setInterval(()=>{i(e=>{let t=_*n.current*s.current,i=b*E*a.current*s.current;return Array.isArray(e)?{[g]:e[0]+t,[v]:e[1]+i}:{[g]:e[g]+t,[v]:e[v]+i}})},16))},[T,w,i,f,_,E,g,v,b]),M=(0,l.useCallback)(()=>{window.clearTimeout(r.current),r.current=void 0,d(!1)},[]);(0,l.useEffect)(()=>{function e(e){s.current=t6(e)}return window.addEventListener("keydown",e),window.addEventListener("keyup",e),()=>{window.clearTimeout(r.current),window.removeEventListener("keydown",e),window.removeEventListener("keyup",e)}},[]);let R=i0(({first:t,active:r,delta:[o,l],movement:[c,d]})=>{t&&u(!0);let h=tF(c,-T,T),p=tF(d,-w,w);n.current=Math.abs(c)>Math.abs(h)?Math.sign(c-h):0,a.current=Math.abs(d)>Math.abs(p)?Math.sign(p-d):0;let m=e[g],y=e[v];r?(n.current||(m+=o*_*s.current,f({x:h})),a.current||(y-=b*l*E*s.current,f({y:p})),n.current||a.current?A():M(),i({[g]:m,[v]:y})):(u(!1),n.current=0,a.current=0,f({x:0,y:0}),M())});return l.createElement(al,ir({ref:p},R()),o&&l.createElement(iH,null,l.createElement(au,{ref:m,isOutOfBounds:c},l.createElement("div",null),l.createElement("span",{ref:h}))))}let ad=im("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}}),ah=["joystick"],af=rk(["x","y"]);var ap=tU(tU({component:function(){let{label:e,displayValue:t,onUpdate:i,settings:r}=is();return l.createElement(iJ,{input:!0},l.createElement(iq,null,e),l.createElement(ad,{withJoystick:!!r.joystick},r.joystick&&l.createElement(ac,{value:t,settings:r,onUpdate:i}),l.createElement(rT,{value:t,settings:r,onUpdate:i})))}},af),{},{normalize:e=>{let{joystick:t=!0}=e,i=tS(e,ah),{value:r,settings:n}=af.normalize(i);return{value:r,settings:tU(tU({},n),{},{joystick:t})}}}),am=Object.freeze({__proto__:null,sanitize:e=>{if(void 0!==e){if(e instanceof File)try{return URL.createObjectURL(e)}catch(e){return}if("string"==typeof e&&0===e.indexOf("blob:"))return e;throw Error(`Invalid image format [undefined | blob |\xa0File].`)}},schema:(e,t)=>"object"==typeof t&&"image"in t,normalize:({image:e})=>({value:e})});let ag=im("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),av=im("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),ay=im("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),ab=im("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),a_=im("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),aE=im("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});var aS=tU({component:function(){let{label:e,value:t,onUpdate:i,disabled:r}=is(),{popinRef:n,wrapperRef:a,shown:s,show:o,hide:u}=n6(),c=(0,l.useCallback)(e=>{e.length&&i(e[0])},[i]),d=(0,l.useCallback)(e=>{e.stopPropagation(),i(void 0)},[i]),{getRootProps:h,getInputProps:f,isDragAccept:p}=nX({maxFiles:1,accept:"image/*",onDrop:c,disabled:r});return l.createElement(iJ,{input:!0},l.createElement(iq,null,e),l.createElement(ag,null,l.createElement(ay,{ref:n,hasImage:!!t,onPointerDown:()=>!!t&&o(),onPointerUp:u,style:{backgroundImage:t?`url(${t})`:"none"}}),s&&!!t&&l.createElement(iH,null,l.createElement(iV,{onPointerUp:u,style:{cursor:"pointer"}}),l.createElement(ab,{ref:a,style:{backgroundImage:`url(${t})`}})),l.createElement(av,h({isDragAccept:p}),l.createElement("input",f()),l.createElement(a_,null,p?"drop image":"click or drop")),l.createElement(aE,{onClick:d,disabled:!t})))}},am);let ax=C().number(),aT=e=>({min:e[0],max:e[1]}),aw=(e,{bounds:[t,i]},r)=>{let n=Array.isArray(e)?aT(e):e,a={min:r[0],max:r[1]},{min:s,max:o}=tU(tU({},a),n);return[tF(Number(s),t,Math.max(t,o)),tF(Number(o),Math.min(i,s),i)]};var aA=Object.freeze({__proto__:null,schema:(e,t)=>C().array().length(2).every.number().test(e)&&C().schema({min:ax,max:ax}).test(t),format:aT,sanitize:aw,normalize:({value:e,min:t,max:i})=>{let r={min:t,max:i},n=rw(aT(e),{min:r,max:r}),a=tU(tU({},n),{},{bounds:[t,i]}),s=aw(aT(e),a,e);return{value:s,settings:a}}});let aM=["value","bounds","onDrag"],aR=["bounds"],aC=im("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function aI(e){let{value:t,bounds:[i,r],onDrag:n}=e,a=tS(e,aM),s=(0,l.useRef)(null),o=(0,l.useRef)(null),u=(0,l.useRef)(null),c=(0,l.useRef)(0),d=iE("sizes","scrubberWidth"),h=i0(({event:e,first:l,xy:[h],movement:[f],memo:p={}})=>{if(l){let{width:n,left:a}=s.current.getBoundingClientRect();c.current=n-parseFloat(d);let l=(null==e?void 0:e.target)===o.current||(null==e?void 0:e.target)===u.current;p.pos=tH((h-a)/n,i,r);let f=Math.abs(p.pos-t.min)-Math.abs(p.pos-t.max);p.key=f<0||0===f&&p.pos<=t.min?"min":"max",l&&(p.pos=t[p.key])}let m=p.pos+tH(f/c.current,0,r-i);return n({[p.key]:ri(m,a[p.key])}),p}),f=`calc(${tj(t.min,i,r)} * (100% - ${d} - 8px) + 4px)`,p=`calc(${1-tj(t.max,i,r)} * (100% - ${d} - 8px) + 4px)`;return l.createElement(i8,ir({ref:s},h()),l.createElement(i4,null,l.createElement(i7,{style:{left:f,right:p}})),l.createElement(i6,{position:"left",ref:o,style:{left:f}}),l.createElement(i6,{position:"right",ref:u,style:{right:p}}))}var aL=tU({component:function(){let{label:e,displayValue:t,onUpdate:i,settings:r}=is(),n=tS(r,aR);return l.createElement(l.Fragment,null,l.createElement(iJ,{input:!0},l.createElement(iq,null,e),l.createElement(aC,null,l.createElement(aI,ir({value:t},r,{onDrag:i})),l.createElement(rT,{value:t,settings:n,onUpdate:i,innerLabelTrim:0}))))}},aA);let ak=()=>{let e=new Map;return{on:(t,i)=>{let r=e.get(t);void 0===r&&(r=new Set,e.set(t,r)),r.add(i)},off:(t,i)=>{let r=e.get(t);void 0!==r&&(r.delete(i),0===r.size&&e.delete(t))},emit:(t,...i)=>{let r=e.get(t);if(void 0!==r)for(let e of r)e(...i)}}},aD=["type","value"],aP=["onChange","transient","onEditStart","onEditEnd"],aO=new function(){let e=(0,nQ.Z)(n0(()=>({data:{}}))),t=ak();this.storeId=tG(),this.useStore=e;let i={},r=new Set;this.getVisiblePaths=()=>{let e=this.getData(),t=Object.keys(e),n=[];Object.entries(i).forEach(([e,i])=>{i.render&&t.some(t=>0===t.indexOf(e))&&!i.render(this.get)&&n.push(e+".")});let a=[];return r.forEach(t=>{t in e&&e[t].__refCount>0&&n.every(e=>-1===t.indexOf(e))&&(!e[t].render||e[t].render(this.get))&&a.push(t)}),a},this.setOrderedPaths=e=>{e.forEach(e=>r.add(e))},this.orderPaths=e=>(this.setOrderedPaths(e),e),this.disposePaths=t=>{e.setState(e=>{let i=e.data;return t.forEach(e=>{if(e in i){let t=i[e];t.__refCount--,0===t.__refCount&&t.type in a&&delete i[e]}}),{data:i}})},this.dispose=()=>{e.setState(()=>({data:{}}))},this.getFolderSettings=e=>i[e]||{},this.getData=()=>e.getState().data,this.addData=(t,i)=>{e.setState(e=>{let r=e.data;return Object.entries(t).forEach(([e,t])=>{let a=r[e];if(a){let{type:e,value:r}=t,s=tS(t,aD);e!==a.type?tw(n.INPUT_TYPE_OVERRIDE,e):((0===a.__refCount||i)&&Object.assign(a,s),a.__refCount++)}else r[e]=tU(tU({},t),{},{__refCount:1})}),{data:r}})},this.setValueAtPath=(t,i,r)=>{e.setState(e=>{let n=e.data;return t2(n[t],i,t,this,r),{data:n}})},this.setSettingsAtPath=(t,i)=>{e.setState(e=>{let r=e.data;return r[t].settings=tU(tU({},r[t].settings),i),{data:r}})},this.disableInputAtPath=(t,i)=>{e.setState(e=>{let r=e.data;return r[t].disabled=i,{data:r}})},this.set=(t,i)=>{e.setState(e=>{let r=e.data;return Object.entries(t).forEach(([e,t])=>{try{t2(r[e],t,void 0,void 0,i)}catch(e){}}),{data:r}})},this.getInput=e=>{try{return this.getData()[e]}catch(t){tw(n.PATH_DOESNT_EXIST,e)}},this.get=e=>{var t;return null===(t=this.getInput(e))||void 0===t?void 0:t.value},this.emitOnEditStart=e=>{t.emit(`onEditStart:${e}`,this.get(e),e,tU(tU({},this.getInput(e)),{},{get:this.get}))},this.emitOnEditEnd=e=>{t.emit(`onEditEnd:${e}`,this.get(e),e,tU(tU({},this.getInput(e)),{},{get:this.get}))},this.subscribeToEditStart=(e,i)=>{let r=`onEditStart:${e}`;return t.on(r,i),()=>t.off(r,i)},this.subscribeToEditEnd=(e,i)=>{let r=`onEditEnd:${e}`;return t.on(r,i),()=>t.off(r,i)};let s=(e,t,r)=>{let o={};return Object.entries(e).forEach(([e,l])=>{if(""===e)return tw(n.EMPTY_KEY);let u=n3(t,e);if(l.type===a.FOLDER){let e=s(l.schema,u,r);Object.assign(o,e),u in i||(i[u]=l.settings)}else if(e in r)tw(n.DUPLICATE_KEYS,e,u,r[e].path);else{let t=function(e,t,i,r){let n=function e(t,i,r={},n){var s,o;if("object"!=typeof t||Array.isArray(t))return{type:n,input:t,options:tU({key:i,label:i,optional:!1,disabled:!1,order:0},r)};if("__customInput"in t){let{type:r,__customInput:n}=t,a=tS(t,tQ);return e(n,i,a,r)}let{render:l,label:u,optional:c,order:d=0,disabled:h,hint:f,onChange:p,onEditStart:m,onEditEnd:g,transient:v}=t,y=tS(t,t0),b=tU({render:l,key:i,label:null!=u?u:i,hint:f,transient:null!=v?v:!!p,onEditStart:m,onEditEnd:g,disabled:h,optional:c,order:d},r),{type:_}=y,E=tS(y,t1);return(_=null!=n?n:_)in a?{type:_,input:E,options:b}:{type:_,input:n&&tZ(E)&&"value"in E?E.value:tJ(E)?void 0:E,options:tU(tU({},b),{},{onChange:p,optional:null!==(s=b.optional)&&void 0!==s&&s,disabled:null!==(o=b.disabled)&&void 0!==o&&o})}}(e,t),{type:s,input:o,options:l}=n;if(s)return s in a?n:{type:s,input:tP(s,o,i,r),options:l};let u=tk(o);return u?{type:u,input:tP(u,o,i,r),options:l}:!!(u=tk({value:o}))&&{type:u,input:tP(u,{value:o},i,r),options:l}}(l,e,u,o);if(t){let{type:i,options:n,input:a}=t,{onChange:s,transient:l,onEditStart:c,onEditEnd:d}=n,h=tS(n,aP);o[u]=tU(tU(tU({type:i},h),a),{},{fromPanel:!0}),r[e]={path:u,onChange:s,transient:l,onEditStart:c,onEditEnd:d}}else tw(n.UNKNOWN_INPUT,u,l)}}),o};this.getDataFromSchema=e=>{let t={},i=s(e,"",t);return[i,t]}},aN={collapsed:!1},aU=e=>"__levaInput"in e,aF=(e,t)=>{let i={},r=t?t.toLowerCase():null;return e.forEach(e=>{let[t,n]=function(e){let t=e.split(".");return[t.pop(),t.join(".")||void 0]}(e);(!r||t.toLowerCase().indexOf(r)>-1)&&n2()(i,n,{[t]:{__levaInput:!0,path:e}})}),i},aB=["type","label","path","valueKey","value","settings","setValue","disabled"];function aV(e){let{type:t,label:i,path:r,valueKey:a,value:s,settings:o,setValue:u,disabled:c}=e,d=tS(e,aB),{displayValue:h,onChange:f,onUpdate:p}=iQ({type:t,value:s,settings:o,setValue:u}),m=tL[t].component;return m?l.createElement(ia.Provider,{value:tU({key:a,path:r,id:""+r,label:i,displayValue:h,value:s,onChange:f,onUpdate:p,settings:o,setValue:u,disabled:c},d)},l.createElement(iB,{disabled:c},l.createElement(m,null))):(tw(n.NO_COMPONENT_FOR_TYPE,t,r),null)}let az=im("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}}),aj=im("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),aH=im("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),aG=({label:e,opts:t})=>{let i="string"==typeof e&&""===e.trim()?null:e,r=t;return"object"==typeof t.opts&&(void 0!==r.label&&(i=t.label),r=t.opts),{label:i,opts:r}},aW=im("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),a$=(0,l.forwardRef)(function({initialValue:e},t){let i=iE("colors","highlight3"),r=iE("colors","elevation2"),n=iE("colors","highlight1"),[a,s]=(0,l.useMemo)(()=>[(0,rD.Vi)(n).alpha(.4).toRgbString(),(0,rD.Vi)(n).alpha(.1).toRgbString()],[n]),o=(0,l.useRef)([e]),u=(0,l.useRef)(e),c=(0,l.useRef)(e),d=(0,l.useRef)(),h=(0,l.useCallback)((e,t)=>{if(!e)return;let{width:n,height:l}=e,d=new Path2D,h=n/100,f=.05*l;for(let e=0;e<o.current.length;e++){let t=tj(o.current[e],u.current,c.current),i=h*e,r=l-t*(l-2*f)-f;d.lineTo(i,r)}t.clearRect(0,0,n,l);let p=new Path2D(d);p.lineTo(h*(o.current.length+1),l),p.lineTo(0,l),p.lineTo(0,0);let m=t.createLinearGradient(0,0,0,l);m.addColorStop(0,a),m.addColorStop(1,s),t.fillStyle=m,t.fill(p),t.strokeStyle=r,t.lineJoin="round",t.lineWidth=14,t.stroke(d),t.strokeStyle=i,t.lineWidth=2,t.stroke(d)},[i,r,a,s]),[f,p]=function(e){let t=(0,l.useRef)(null),i=(0,l.useRef)(null),r=(0,l.useRef)(!1);return(0,l.useEffect)(()=>{let n=t4(()=>{t.current.width=t.current.offsetWidth*window.devicePixelRatio,t.current.height=t.current.offsetHeight*window.devicePixelRatio,e(t.current,i.current)},250);return window.addEventListener("resize",n),r.current||(n(),r.current=!0),()=>window.removeEventListener("resize",n)},[e]),(0,l.useEffect)(()=>{i.current=t.current.getContext("2d")},[]),[t,i]}(h);return(0,l.useImperativeHandle)(t,()=>({frame:e=>{var t;(void 0===u.current||e<u.current)&&(u.current=e),(void 0===c.current||e>c.current)&&(c.current=e),(t=o.current).push(e),t.length>100&&t.shift(),d.current=requestAnimationFrame(()=>h(f.current,p.current))}}),[f,p,h]),(0,l.useEffect)(()=>()=>cancelAnimationFrame(d.current),[]),l.createElement(aW,{ref:f})}),aq=e=>Number.isFinite(e)?e.toPrecision(2):e.toString(),aY=(0,l.forwardRef)(function({initialValue:e},t){let[i,r]=(0,l.useState)(aq(e));return(0,l.useImperativeHandle)(t,()=>({frame:e=>r(aq(e))}),[]),l.createElement("div",null,i)});function aK(e){return"function"==typeof e?e():e.current}let aX=["type","label","key"],aZ={[a.BUTTON]:function({onClick:e,settings:t,label:i}){let r=ic();return l.createElement(iJ,null,l.createElement(az,{disabled:t.disabled,onClick:()=>e(r.get)},i))},[a.BUTTON_GROUP]:function(e){let{label:t,opts:i}=aG(e),r=ic();return l.createElement(iJ,{input:!!t},t&&l.createElement(iq,null,t),l.createElement(aj,null,Object.entries(i).map(([e,t])=>l.createElement(aH,{key:e,onClick:()=>t(r.get)},e))))},[a.MONITOR]:function({label:e,objectOrFn:t,settings:i}){let r=(0,l.useRef)(),n=(0,l.useRef)(aK(t));return(0,l.useEffect)(()=>{let e=window.setInterval(()=>{var e;document.hidden||null===(e=r.current)||void 0===e||e.frame(aK(t))},i.interval);return()=>window.clearInterval(e)},[t,i.interval]),l.createElement(iJ,{input:!0},l.createElement(iq,{align:"top"},e),i.graph?l.createElement(a$,{ref:r,initialValue:n.current}):l.createElement(aY,{ref:r,initialValue:n.current}))}},aJ=l.memo(({path:e})=>{let[t,{set:i,setSettings:r,disable:s,storeId:o,emitOnEditStart:u,emitOnEditEnd:c}]=function(e){let t=ic(),[i,r]=(0,l.useState)(i3(t.getData(),e)),n=(0,l.useCallback)(i=>t.setValueAtPath(e,i,!0),[e,t]),a=(0,l.useCallback)(i=>t.setSettingsAtPath(e,i),[e,t]),s=(0,l.useCallback)(i=>t.disableInputAtPath(e,i),[e,t]),o=(0,l.useCallback)(()=>t.emitOnEditStart(e),[e,t]),u=(0,l.useCallback)(()=>t.emitOnEditEnd(e),[e,t]);return(0,l.useEffect)(()=>{r(i3(t.getData(),e));let i=t.useStore.subscribe(t=>i3(t.data,e),r,{equalityFn:E});return()=>i()},[t,e]),[i,{set:n,setSettings:a,disable:s,storeId:t.storeId,emitOnEditStart:o,emitOnEditEnd:u}]}(e);if(!t)return null;let{type:d,label:h,key:f}=t,p=tS(t,aX);if(d in a){let t=aZ[d];return l.createElement(t,ir({label:h,path:e},p))}return d in tL?l.createElement(aV,ir({key:o+e,type:d,label:h,storeId:o,path:e,valueKey:f,setValue:i,setSettings:r,disable:s,emitOnEditStart:u,emitOnEditEnd:c},p)):(tA(n.UNSUPPORTED_INPUT,d,e),null)});function aQ({toggle:e,toggled:t,name:i}){return l.createElement(ik,{onClick:()=>e()},l.createElement(iX,{toggled:t}),l.createElement("div",null,i))}let a0=({name:e,path:t,tree:i})=>{let r=ic(),n=n3(t,e),{collapsed:a,color:s}=r.getFolderSettings(n),[o,u]=(0,l.useState)(!a),c=(0,l.useRef)(null),d=iE("colors","folderWidgetColor"),h=iE("colors","folderTextColor");return(0,l.useLayoutEffect)(()=>{c.current.style.setProperty("--leva-colors-folderWidgetColor",s||d),c.current.style.setProperty("--leva-colors-folderTextColor",s||h)},[s,d,h]),l.createElement(iI,{ref:c},l.createElement(aQ,{name:e,toggled:o,toggle:()=>u(e=>!e)}),l.createElement(a1,{parent:n,tree:i,toggled:o}))},a1=l.memo(({isRoot:e=!1,fill:t=!1,flat:i=!1,parent:r,tree:n,toggled:a})=>{let{wrapperRef:s,contentRef:o}=function(e){let t=(0,l.useRef)(null),i=(0,l.useRef)(null),r=(0,l.useRef)(!0);return(0,l.useLayoutEffect)(()=>{e||(t.current.style.height="0px",t.current.style.overflow="hidden")},[]),(0,l.useEffect)(()=>{let n;if(r.current){r.current=!1;return}let a=t.current,s=()=>{e&&(a.style.removeProperty("height"),a.style.removeProperty("overflow"),i.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};a.addEventListener("transitionend",s,{once:!0});let{height:o}=i.current.getBoundingClientRect();return a.style.height=o+"px",e||(a.style.overflow="hidden",n=window.setTimeout(()=>a.style.height="0px",50)),()=>{a.removeEventListener("transitionend",s),clearTimeout(n)}},[e]),{wrapperRef:t,contentRef:i}}(a),u=ic(),c=([e,t])=>{var i;let n=aU(t)?null===(i=u.getInput(t.path))||void 0===i?void 0:i.order:u.getFolderSettings(n3(r,e)).order;return n||0},d=Object.entries(n).sort((e,t)=>c(e)-c(t));return l.createElement(iL,{ref:s,isRoot:e,fill:t,flat:i},l.createElement(iD,{ref:o,isRoot:e,toggled:a},d.map(([e,t])=>aU(t)?l.createElement(aJ,{key:t.path,valueKey:t.valueKey,path:t.path}):l.createElement(a0,{key:e,name:e,path:r,tree:t}))))}),a2=im("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${iO}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),a3=im("i",{$flexCenter:"",width:40,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),a5=im("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),a4=im("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${a3}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),a6=im("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),a8=im("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:40}}}}),a7=l.forwardRef(({setFilter:e,toggle:t},i)=>{let[r,n]=(0,l.useState)(""),a=(0,l.useMemo)(()=>t4(e,250),[e]),s=()=>{e(""),n("")};return(0,l.useEffect)(()=>{a(r)},[r,a]),l.createElement(l.Fragment,null,l.createElement(a6,{ref:i,value:r,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:e=>e.stopPropagation(),onChange:e=>{let i=e.currentTarget.value;t(!0),n(i)}}),l.createElement(a3,{onClick:()=>s(),style:{visibility:r?"visible":"hidden"}},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},l.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function a9({setFilter:e,onDrag:t,onDragStart:i,onDragEnd:r,toggle:n,toggled:a,title:s,drag:o,filterEnabled:u,from:c}){let[d,h]=(0,l.useState)(!1),f=(0,l.useRef)(null);(0,l.useEffect)(()=>{var e,t;d?null===(e=f.current)||void 0===e||e.focus():null===(t=f.current)||void 0===t||t.blur()},[d]);let p=i0(({offset:[e,n],first:a,last:s})=>{t({x:e,y:n}),a&&i({x:e,y:n}),s&&r({x:e,y:n})},{filterTaps:!0,from:({offset:[e,t]})=>[(null==c?void 0:c.x)||e,(null==c?void 0:c.y)||t]});return(0,l.useEffect)(()=>{let e=e=>{"L"===e.key&&e.shiftKey&&e.metaKey&&h(e=>!e)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),l.createElement(l.Fragment,null,l.createElement(a5,{mode:o?"drag":void 0},l.createElement(a3,{active:!a,onClick:()=>n()},l.createElement(iX,{toggled:a,width:12,height:8})),l.createElement(a8,ir({},o?p():{},{drag:o,filterEnabled:u}),void 0===s&&o?l.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},l.createElement("circle",{cx:"2",cy:"2",r:"2"}),l.createElement("circle",{cx:"14",cy:"2",r:"2"}),l.createElement("circle",{cx:"26",cy:"2",r:"2"}),l.createElement("circle",{cx:"2",cy:"12",r:"2"}),l.createElement("circle",{cx:"14",cy:"12",r:"2"}),l.createElement("circle",{cx:"26",cy:"12",r:"2"})):s),u&&l.createElement(a3,{active:d,onClick:()=>h(e=>!e)},l.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},l.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),l.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),l.createElement(a4,{toggled:d},l.createElement(a7,{ref:f,setFilter:e,toggle:n})))}let se=["store","hidden","theme","collapsed"];function st(e){let{store:t,hidden:i=!1,theme:r,collapsed:n=!1}=e,a=tS(e,se),s=n5(()=>(function(e){let t=id();if(!e)return{theme:t,className:""};Object.keys(e).forEach(i=>{Object.assign(t[i],e[i])});let i=iv(t);return{theme:t,className:i.className}})(r),[r]),[o,u]=(0,l.useState)(!n),c="object"==typeof n?!n.collapsed:o,d=(0,l.useMemo)(()=>"object"==typeof n?e=>{"function"==typeof e?n.onChange(!e(!n.collapsed)):n.onChange(!e)}:u,[n]);return!t||i?null:l.createElement(io.Provider,{value:s},l.createElement(si,ir({store:t},a,{toggled:c,setToggle:d,rootClass:s.className})))}let si=l.memo(({store:e,rootClass:t,fill:i=!1,flat:r=!1,neverHide:n=!1,oneLineLabels:a=!1,titleBar:s={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:o=!1,toggled:u,setToggle:c})=>{var d,h;let f=n4(e),[p,m]=(0,l.useState)(""),g=(0,l.useMemo)(()=>aF(f,p),[f,p]),[v,y]=i1(),b=n||f.length>0,_="object"==typeof s&&s.title||void 0,E="object"!=typeof s||null===(d=s.drag)||void 0===d||d,S="object"!=typeof s||null===(h=s.filter)||void 0===h||h,x="object"==typeof s&&s.position||void 0,T="object"==typeof s&&s.onDrag||void 0,w="object"==typeof s&&s.onDragStart||void 0,A="object"==typeof s&&s.onDragEnd||void 0;return l.useEffect(()=>{y({x:null==x?void 0:x.x,y:null==x?void 0:x.y})},[x,y]),i_(),l.createElement(iu.Provider,{value:{hideCopyButton:o}},l.createElement(a2,{ref:v,className:t,fill:i,flat:r,oneLineLabels:a,hideTitleBar:!s,style:{display:b?"block":"none"}},s&&l.createElement(a9,{onDrag:e=>{y(e),null==T||T(e)},onDragStart:e=>null==w?void 0:w(e),onDragEnd:e=>null==A?void 0:A(e),setFilter:m,toggle:e=>c(t=>null!=e?e:!t),toggled:u,title:_,drag:E,filterEnabled:S,from:x}),b&&l.createElement(il.Provider,{value:e},l.createElement(a1,{isRoot:!0,fill:i,flat:r,tree:g,toggled:u}))))}),sr=["isRoot"],sn=!1,sa=null;function ss(e){let{isRoot:t=!1}=e,i=tS(e,sr);return(0,l.useEffect)(()=>(sn=!0,!t&&sa&&(sa.remove(),sa=null),()=>{t||(sn=!1)}),[t]),l.createElement(st,ir({store:aO},i))}function so(e,t,i,r,n){let s,u,c,d,h;let{folderName:f,schema:p,folderSettings:m,hookSettings:g,deps:v}=("string"==typeof e?(h=e,s=t,Array.isArray(i)?d=i:i&&("store"in i?(c=i,d=r):(u=i,Array.isArray(r)?d=r:(c=r,d=n)))):(s=e,Array.isArray(t)?d=t:(c=t,d=i)),{schema:s,folderName:h,folderSettings:u,hookSettings:c,deps:d||[]}),y="function"==typeof p,b=(0,l.useRef)(!1),_=(0,l.useRef)(!0),S=n5(()=>{b.current=!0;let e="function"==typeof p?p():p;return f?{[f]:{type:a.FOLDER,schema:e,settings:tU(tU({},aN),m)}}:e},v),x=!(null!=g&&g.store);(0,l.useEffect)(()=>{x&&!sn&&(!sa&&(sa=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(sa),function(e,t){let i=console.error;console.error=()=>{},o.render(e,t),console.error=i}(l.createElement(ss,{isRoot:!0}),sa))),sn=!0)},[x]);let[T]=(0,l.useState)(()=>(null==g?void 0:g.store)||aO),[w,A]=(0,l.useMemo)(()=>T.getDataFromSchema(S),[T,S]),[M,R,C,I,L]=(0,l.useMemo)(()=>{let e=[],t=[],i={},r={},n={};return Object.values(A).forEach(({path:a,onChange:s,onEditStart:o,onEditEnd:l,transient:u})=>{e.push(a),s?(i[a]=s,u||t.push(a)):t.push(a),o&&(r[a]=o),l&&(n[a]=l)}),[e,t,i,r,n]},[A]),k=(0,l.useMemo)(()=>T.orderPaths(M),[M,T]),D=function(e,t,i){let r=e.useStore(e=>{let r=tU(tU({},i),e.data);return Object.entries(t.reduce((e,t)=>(r&&r.hasOwnProperty(t)&&(e[t]=r[t]),e),{})).reduce((e,[,{value:t,disabled:i,key:r}])=>(e[r]=i?void 0:t,e),{})},E);return r}(T,R,w),P=(0,l.useCallback)(e=>{let t=Object.entries(e).reduce((e,[t,i])=>Object.assign(e,{[A[t].path]:i}),{});T.set(t,!1)},[T,A]),O=(0,l.useCallback)(e=>T.get(A[e].path),[T,A]);return((0,l.useEffect)(()=>{let e=!_.current&&b.current;return T.addData(w,e),_.current=!1,b.current=!1,()=>T.disposePaths(k)},[T,k,w]),(0,l.useEffect)(()=>{let e=[];return Object.entries(C).forEach(([t,i])=>{i(T.get(t),t,tU({initial:!0,get:T.get},T.getInput(t)));let r=T.useStore.subscribe(e=>{let i=e.data[t],r=i.disabled?void 0:i.value;return[r,i]},([e,r])=>i(e,t,tU({initial:!1,get:T.get},r)),{equalityFn:E});e.push(r)}),()=>e.forEach(e=>e())},[T,C]),(0,l.useEffect)(()=>{let e=[];return Object.entries(I).forEach(([t,i])=>e.push(T.subscribeToEditStart(t,i))),Object.entries(L).forEach(([t,i])=>e.push(T.subscribeToEditEnd(t,i))),()=>e.forEach(e=>e())},[I,L,T]),y)?[D,P,O]:D}tD(s.SELECT,rc),tD(s.IMAGE,aS),tD(s.NUMBER,rn),tD(s.COLOR,as),tD(s.STRING,rm),tD(s.BOOLEAN,rb),tD(s.INTERVAL,aL),tD(s.VECTOR3D,ao),tD(s.VECTOR2D,ap)},31378:function(e,t,i){"use strict";var r=i(12723),n=i(12793),a=i(33780),s=i(78930);e.exports=function(e,t,i){if(!r(e))throw TypeError("expected an object");if("string"!=typeof t||null==i)return n.apply(null,arguments);if("string"==typeof i)return s(e,t,i),e;var o=a(e,t);return r(i)&&r(o)&&(i=n({},o,i)),s(e,t,i),e}},12793:function(e,t,i){"use strict";var r=i(12723),n=i(21603);function a(e,t){for(var i=arguments.length,r=0;++r<i;){var a=arguments[r];o(a)&&n(a,s,e)}return e}function s(e,t){if("__proto__"!==t&&"constructor"!==t&&"prototype"!==t){var i=this[t];o(e)&&o(i)?a(i,e):this[t]=e}}function o(e){return r(e)&&!Array.isArray(e)}e.exports=a},3759:function(e){e.exports=function(){var e={80:function(e,t,i){e.exports=i(728).default},728:function(e,t,i){"use strict";i.d(t,{default:function(){return tP}});var r=i(48),n=i.n(r),a=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},s=function(){return("000000"+(2176782336*Math.random()<<0).toString(36)).slice(-6)},o=function(e){return e&&void 0!==e.nodeName?(e.muxId||(e.muxId=e.id||s()),e.muxId):e},l=function(e){e&&void 0!==e.nodeName?e=o(t=e):t=document.querySelector(e);var t,i=t&&t.nodeName?t.nodeName.toLowerCase():"";return[t,e,i]},u=i(640),c=i.n(u),d=c().methodFactory;c().methodFactory=function(e,t,i){var r=d(e,t,i);return function(){for(var e=["[mux]"],t=0;t<arguments.length;t++)e.push(arguments[t]);r.apply(void 0,e)}},c().setLevel(c().getLevel());var h=c();function f(){return"1"===(n().doNotTrack||n().navigator&&n().navigator.doNotTrack)}var p={now:function(){var e=n().performance,t=e&&e.timing,i=t&&t.navigationStart;return Math.round("number"==typeof i&&"function"==typeof e.now?i+e.now():Date.now())}},m=function(e){return g(e)[0]},g=function(e){if("string"!=typeof e||""===e)return["localhost"];var t,i=(e.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/)||[])[4];return i&&(t=(i.match(/[^\.]+\.[^\.]+$/)||[])[0]),[i,t]},v={exists:function(){var e=n().performance;return void 0!==(e&&e.timing)},domContentLoadedEventEnd:function(){var e=n().performance,t=e&&e.timing;return t&&t.domContentLoadedEventEnd},navigationStart:function(){var e=n().performance,t=e&&e.timing;return t&&t.navigationStart}};function y(e,t,i){i=void 0===i?1:i,e[t]=e[t]||0,e[t]+=i}var b=["x-request-id","cf-ray","x-amz-cf-id","x-akamai-request-id"],_=["x-cdn","content-type"].concat(b);function E(e){var t={};return(e=e||"").trim().split(/[\r\n]+/).forEach(function(e){if(e){var i=e.split(": "),r=i.shift();r&&(_.indexOf(r.toLowerCase())>=0||0===r.toLowerCase().indexOf("x-litix-"))&&(t[r]=i.join(": "))}}),t}function S(e){if(e){var t=b.find(function(t){return void 0!==e[t]});return t?e[t]:void 0}}var x=function(e){var t={};for(var i in e){var r=e[i];-1!==r["DATA-ID"].search("io.litix.data.")&&(t[r["DATA-ID"].replace("io.litix.data.","")]=r.VALUE)}return t};function T(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function w(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?T(Object(i),!0).forEach(function(t){var r;r=i[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):T(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var A=function(e){if(!e)return{};var t=v.navigationStart(),i=e.loading,r=i?i.start:e.trequest,n=i?i.first:e.tfirst,a=i?i.end:e.tload;return{bytesLoaded:e.total,requestStart:Math.round(t+r),responseStart:Math.round(t+n),responseEnd:Math.round(t+a)}},M=function(e){if(e&&"function"==typeof e.getAllResponseHeaders)return E(e.getAllResponseHeaders())};function R(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function C(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?R(Object(i),!0).forEach(function(t){var r;r=i[t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):R(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}var I=function(e,t){if(!e||"function"!=typeof e.getRequests)return{};var i=e.getRequests({state:"executed"});if(0===i.length)return{};var r,n=i[i.length-1],a=m(n.url),s=n.url,o=n.bytesLoaded,l=new Date(n.requestStartDate).getTime(),u=new Date(n.firstByteDate).getTime(),c=new Date(n.requestEndDate).getTime(),d=isNaN(n.duration)?0:n.duration,h="function"==typeof t.getMetricsFor?t.getMetricsFor(n.mediaType).HttpList:t.getDashMetrics().getHttpRequests(n.mediaType);return h.length>0&&(r=E(h[h.length-1]._responseHeaders||"")),{requestStart:l,requestResponseStart:u,requestResponseEnd:c,requestBytesLoaded:o,requestResponseHeaders:r,requestMediaDuration:d,requestHostname:a,requestUrl:s,requestId:r?S(r):void 0}},L=function(e,t){var i=t.getQualityFor(e),r=t.getCurrentTrackFor(e).bitrateList;return r?{currentLevel:i,renditionWidth:r[i].width||null,renditionHeight:r[i].height||null,renditionBitrate:r[i].bandwidth}:{}},k=function(e){var t;return null===(t=e.match(/.*codecs\*?="(.*)"/))||void 0===t?void 0:t[1]};function D(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var P=0,O=function(){var e,t;function i(){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,i)}return e=[{key:"on",value:function(e,t,i){return t._eventEmitterGuid=t._eventEmitterGuid||++P,this._listeners=this._listeners||{},this._listeners[e]=this._listeners[e]||[],i&&(t=t.bind(i)),this._listeners[e].push(t),t}},{key:"off",value:function(e,t){var i=this._listeners&&this._listeners[e];i&&i.forEach(function(e,r){e._eventEmitterGuid===t._eventEmitterGuid&&i.splice(r,1)})}},{key:"one",value:function(e,t,i){var r=this;t._eventEmitterGuid=t._eventEmitterGuid||++P;var n=function n(){r.off(e,n),t.apply(i||this,arguments)};n._eventEmitterGuid=t._eventEmitterGuid,this.on(e,n)}},{key:"emit",value:function(e,t){var i=this;if(this._listeners){t=t||{};var r=this._listeners["before*"]||[],n=this._listeners[e]||[],a=this._listeners["after"+e]||[],s=function(t,r){(t=t.slice()).forEach(function(t){t.call(i,{type:e},r)})};s(r,t),s(n,t),s(a,t)}}}],D(i.prototype,e),t&&D(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}();function N(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var U=function(){var e;function t(e){var i=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.pm=e,this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,e.on("playing",function(){i._playheadShouldBeProgressing=!0}),e.on("play",this._startPlaybackHeartbeatInterval.bind(this)),e.on("playing",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adbreakstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplay",this._startPlaybackHeartbeatInterval.bind(this)),e.on("adplaying",this._startPlaybackHeartbeatInterval.bind(this)),e.on("seeking",this._startPlaybackHeartbeatInterval.bind(this)),e.on("devicewake",this._startPlaybackHeartbeatInterval.bind(this)),e.on("viewstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("rebufferstart",this._startPlaybackHeartbeatInterval.bind(this)),e.on("pause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("ended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("viewend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("error",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("aderror",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adpause",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adended",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("adbreakend",this._stopPlaybackHeartbeatInterval.bind(this)),e.on("seeked",function(){e.data.player_is_paused?i._stopPlaybackHeartbeatInterval():i._startPlaybackHeartbeatInterval()}),e.on("timeupdate",function(){null!==i._playbackHeartbeatInterval&&e.emit("playbackheartbeat")}),e.on("devicesleep",function(t,r){null!==i._playbackHeartbeatInterval&&(n().clearInterval(i._playbackHeartbeatInterval),e.emit("playbackheartbeatend",{viewer_time:r.viewer_time}),i._playbackHeartbeatInterval=null)})}return N(t.prototype,[{key:"_startPlaybackHeartbeatInterval",value:function(){var e=this;null===this._playbackHeartbeatInterval&&(this.pm.emit("playbackheartbeat"),this._playbackHeartbeatInterval=n().setInterval(function(){e.pm.emit("playbackheartbeat")},this.pm.playbackHeartbeatTime))}},{key:"_stopPlaybackHeartbeatInterval",value:function(){this._playheadShouldBeProgressing=!1,null!==this._playbackHeartbeatInterval&&(n().clearInterval(this._playbackHeartbeatInterval),this.pm.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)}}]),e&&N(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function F(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var B=(e3=function e(t){var i=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),t.on("viewinit",function(){i.viewErrored=!1}),t.on("error",function(e,r){try{var n=t.errorTranslator({player_error_code:r.player_error_code,player_error_message:r.player_error_message,player_error_context:r.player_error_context});n?(t.data.player_error_code=n.player_error_code||r.player_error_code,t.data.player_error_message=n.player_error_message||r.player_error_message,t.data.player_error_context=n.player_error_context||r.player_error_context,i.viewErrored=!0):(delete t.data.player_error_code,delete t.data.player_error_message,delete t.data.player_error_context)}catch(e){t.mux.log.warn("Exception in error translator callback.",e),i.viewErrored=!0}})},e5&&F(e3.prototype,e5),e4&&F(e3,e4),Object.defineProperty(e3,"prototype",{writable:!1}),e3);function V(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var z=function(){var e,t;function i(e){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,i),this.pm=e,this._watchTimeTrackerLastCheckedTime=null,e.on("playbackheartbeat",this._updateWatchTime.bind(this)),e.on("playbackheartbeatend",this._clearWatchTimeState.bind(this))}return e=[{key:"_updateWatchTime",value:function(e,t){var i=t.viewer_time;null===this._watchTimeTrackerLastCheckedTime&&(this._watchTimeTrackerLastCheckedTime=i),y(this.pm.data,"view_watch_time",i-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=i}},{key:"_clearWatchTimeState",value:function(e,t){this._updateWatchTime(e,t),this._watchTimeTrackerLastCheckedTime=null}}],V(i.prototype,e),t&&V(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}();function j(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var H=function(){var e,t;function i(e){var t=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,i),this.pm=e,this._playbackTimeTrackerLastPlayheadPosition=-1,this._lastTime=p.now(),this._isAdPlaying=!1,this._callbackUpdatePlaybackTime=null;var r=this._startPlaybackTimeTracking.bind(this);e.on("playing",r),e.on("adplaying",r),e.on("seeked",r);var n=this._stopPlaybackTimeTracking.bind(this);e.on("playbackheartbeatend",n),e.on("seeking",n),e.on("adplaying",function(){t._isAdPlaying=!0}),e.on("adended",function(){t._isAdPlaying=!1}),e.on("adpause",function(){t._isAdPlaying=!1}),e.on("adbreakstart",function(){t._isAdPlaying=!1}),e.on("adbreakend",function(){t._isAdPlaying=!1}),e.on("adplay",function(){t._isAdPlaying=!1}),e.on("viewinit",function(){t._playbackTimeTrackerLastPlayheadPosition=-1,t._lastTime=p.now(),t._isAdPlaying=!1,t._callbackUpdatePlaybackTime=null})}return e=[{key:"_startPlaybackTimeTracking",value:function(){null===this._callbackUpdatePlaybackTime&&(this._callbackUpdatePlaybackTime=this._updatePlaybackTime.bind(this),this._playbackTimeTrackerLastPlayheadPosition=this.pm.data.player_playhead_time,this.pm.on("playbackheartbeat",this._callbackUpdatePlaybackTime))}},{key:"_stopPlaybackTimeTracking",value:function(){this._callbackUpdatePlaybackTime&&(this._updatePlaybackTime(),this.pm.off("playbackheartbeat",this._callbackUpdatePlaybackTime),this._callbackUpdatePlaybackTime=null,this._playbackTimeTrackerLastPlayheadPosition=-1)}},{key:"_updatePlaybackTime",value:function(){var e=this.pm.data.player_playhead_time,t=p.now(),i=-1;this._playbackTimeTrackerLastPlayheadPosition>=0&&e>this._playbackTimeTrackerLastPlayheadPosition?i=e-this._playbackTimeTrackerLastPlayheadPosition:this._isAdPlaying&&(i=t-this._lastTime),i>0&&i<=1e3&&y(this.pm.data,"view_content_playback_time",i),this._playbackTimeTrackerLastPlayheadPosition=e,this._lastTime=t}}],j(i.prototype,e),t&&j(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}();function G(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var W=function(){var e,t;function i(e){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,i),this.pm=e;var t=this._updatePlayheadTime.bind(this);e.on("playbackheartbeat",t),e.on("playbackheartbeatend",t),e.on("timeupdate",t),e.on("destroy",function(){e.off("timeupdate",t)})}return e=[{key:"_updateMaxPlayheadPosition",value:function(){this.pm.data.view_max_playhead_position=void 0===this.pm.data.view_max_playhead_position?this.pm.data.player_playhead_time:Math.max(this.pm.data.view_max_playhead_position,this.pm.data.player_playhead_time)}},{key:"_updatePlayheadTime",value:function(e,t){var i=this,r=function(){i.pm.currentFragmentPDT&&i.pm.currentFragmentStart&&(i.pm.data.player_program_time=i.pm.currentFragmentPDT+i.pm.data.player_playhead_time-i.pm.currentFragmentStart)};if(t&&t.player_playhead_time)this.pm.data.player_playhead_time=t.player_playhead_time,r(),this._updateMaxPlayheadPosition();else if(this.pm.getPlayheadTime){var n=this.pm.getPlayheadTime();void 0!==n&&(this.pm.data.player_playhead_time=n,r(),this._updateMaxPlayheadPosition())}}}],G(i.prototype,e),t&&G(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}();function $(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var q=(e6=function e(t){if(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,e),!t.disableRebufferTracking){var i,r=function(e,t){n(t),i=void 0},n=function(e){if(i){var r=e.viewer_time-i;y(t.data,"view_rebuffer_duration",r),i=e.viewer_time,t.data.view_rebuffer_duration>3e5&&(t.emit("viewend"),t.send("viewend"),t.mux.log.warn("Ending view after rebuffering for longer than ".concat(3e5,"ms, future events will be ignored unless a programchange or videochange occurs.")))}t.data.view_watch_time>=0&&t.data.view_rebuffer_count>0&&(t.data.view_rebuffer_frequency=t.data.view_rebuffer_count/t.data.view_watch_time,t.data.view_rebuffer_percentage=t.data.view_rebuffer_duration/t.data.view_watch_time)};t.on("playbackheartbeat",function(e,t){return n(t)}),t.on("rebufferstart",function(e,n){i||(y(t.data,"view_rebuffer_count",1),i=n.viewer_time,t.one("rebufferend",r))}),t.on("viewinit",function(){i=void 0,t.off("rebufferend",r)})}},e8&&$(e6.prototype,e8),e7&&$(e6,e7),Object.defineProperty(e6,"prototype",{writable:!1}),e6);function Y(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var K=function(){var e,t;function i(e){var t=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,i),this.pm=e,e.disableRebufferTracking||e.disablePlayheadRebufferTracking||(this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,e.on("playbackheartbeat",this._checkIfRebuffering.bind(this)),e.on("playbackheartbeatend",this._cleanupRebufferTracker.bind(this)),e.on("seeking",function(){t._cleanupRebufferTracker(null,{viewer_time:p.now()})}))}return e=[{key:"_checkIfRebuffering",value:function(e,t){if(this.pm.seekingTracker.isSeeking||this.pm.adTracker.isAdBreak||!this.pm.playbackHeartbeat._playheadShouldBeProgressing)this._cleanupRebufferTracker(e,t);else if(null!==this._lastCheckedTime){if(this._lastPlayheadTime===this.pm.data.player_playhead_time){var i=t.viewer_time-this._lastPlayheadTimeUpdatedTime;"number"==typeof this.pm.sustainedRebufferThreshold&&i>=this.pm.sustainedRebufferThreshold&&(this._rebuffering||(this._rebuffering=!0,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}))),this._lastCheckedTime=t.viewer_time}else this._cleanupRebufferTracker(e,t,!0)}else this._prepareRebufferTrackerState(t.viewer_time)}},{key:"_clearRebufferTrackerState",value:function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null}},{key:"_prepareRebufferTrackerState",value:function(e){this._lastCheckedTime=e,this._lastPlayheadTime=this.pm.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=e}},{key:"_cleanupRebufferTracker",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this._rebuffering)this._rebuffering=!1,this.pm.emit("rebufferend",{viewer_time:t.viewer_time});else{if(null===this._lastCheckedTime)return;var r=this.pm.data.player_playhead_time-this._lastPlayheadTime,n=t.viewer_time-this._lastPlayheadTimeUpdatedTime;"number"==typeof this.pm.minimumRebufferDuration&&r>0&&n-r>this.pm.minimumRebufferDuration&&(this._lastCheckedTime=null,this.pm.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.pm.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+n-r}))}i?this._prepareRebufferTrackerState(t.viewer_time):this._clearRebufferTrackerState()}}],Y(i.prototype,e),t&&Y(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}();function X(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Z=function(){var e;function t(e){var i=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.pm=e,e.on("viewinit",function(){var t=e.data,r=t.view_id;if(!t.view_program_changed){var n=function(t,n){var a=n.viewer_time;"playing"===t.type&&void 0===e.data.view_time_to_first_frame?i.calculateTimeToFirstFrame(a||p.now(),r):"adplaying"===t.type&&(void 0===e.data.view_time_to_first_frame||i._inPrerollPosition())&&i.calculateTimeToFirstFrame(a||p.now(),r)};e.one("playing",n),e.one("adplaying",n),e.one("viewend",function(){e.off("playing",n),e.off("adplaying",n)})}})}return X(t.prototype,[{key:"_inPrerollPosition",value:function(){return void 0===this.pm.data.view_content_playback_time||this.pm.data.view_content_playback_time<=1e3}},{key:"calculateTimeToFirstFrame",value:function(e,t){t===this.pm.data.view_id&&(this.pm.watchTimeTracker._updateWatchTime(null,{viewer_time:e}),this.pm.data.view_time_to_first_frame=this.pm.data.view_watch_time,(this.pm.data.player_autoplay_on||this.pm.data.video_is_autoplay)&&this.NAVIGATION_START&&(this.pm.data.view_aggregate_startup_time=this.pm.data.view_start+this.pm.data.view_watch_time-this.NAVIGATION_START))}}]),e&&X(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}();function J(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var Q=(e9=function e(t){var i=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),t.on("viewinit",function(){i._lastPlayheadPosition=-1}),["pause","rebufferstart","seeking","error","adbreakstart","hb"].forEach(function(e){t.on(e,function(){if(i._lastPlayheadPosition>=0&&t.data.player_playhead_time>=0&&i._lastPlayerWidth>=0&&i._lastSourceWidth>0&&i._lastPlayerHeight>=0&&i._lastSourceHeight>0){var e=t.data.player_playhead_time-i._lastPlayheadPosition;if(e<0)return void(i._lastPlayheadPosition=-1);var r=Math.min(i._lastPlayerWidth/i._lastSourceWidth,i._lastPlayerHeight/i._lastSourceHeight),n=Math.max(0,r-1),a=Math.max(0,1-r);t.data.view_max_upscale_percentage=Math.max(t.data.view_max_upscale_percentage||0,n),t.data.view_max_downscale_percentage=Math.max(t.data.view_max_downscale_percentage||0,a),y(t.data,"view_total_content_playback_time",e),y(t.data,"view_total_upscaling",n*e),y(t.data,"view_total_downscaling",a*e)}i._lastPlayheadPosition=-1})}),["playing","hb"].forEach(function(e){t.on(e,function(){i._lastPlayheadPosition=t.data.player_playhead_time,i._lastPlayerWidth=t.data.player_width,i._lastPlayerHeight=t.data.player_height,i._lastSourceWidth=t.data.video_source_width,i._lastSourceHeight=t.data.video_source_height})})},te&&J(e9.prototype,te),tt&&J(e9,tt),Object.defineProperty(e9,"prototype",{writable:!1}),e9);function ee(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var et=(ti=function e(t){var i=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),this.isSeeking=!1;var r=-1,n=function(){var e=p.now(),n=(t.data.viewer_time||e)-(r||e);y(t.data,"view_seek_duration",n),t.data.view_max_seek_time=Math.max(t.data.view_max_seek_time||0,n),i.isSeeking=!1,r=-1};t.on("seeking",function(e,a){Object.assign(t.data,a),i.isSeeking&&a.viewer_time-r<=2e3?r=a.viewer_time:(i.isSeeking&&n(),i.isSeeking=!0,r=a.viewer_time,y(t.data,"view_seek_count",1),t.send("seeking"))}),t.on("seeked",function(){n()}),t.on("viewend",function(){i.isSeeking&&(n(),t.send("seeked")),i.isSeeking=!1,r=-1})},tr&&ee(ti.prototype,tr),tn&&ee(ti,tn),Object.defineProperty(ti,"prototype",{writable:!1}),ti);function ei(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,a=[],s=!0,o=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(o)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return er(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?er(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function er(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function en(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ea=function(e,t){e.push(t),e.sort(function(e,t){return e.viewer_time-t.viewer_time})},es=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror","adclicked","adskipped"],eo=function(){var e,t;function i(e){var t=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,i),this.pm=e,e.on("viewinit",function(){t.isAdBreak=!1,t._currentAdRequestNumber=0,t._currentAdResponseNumber=0,t._adRequests=[],t._adResponses=[],t._adHasPlayed=!1,t._wouldBeNewAdPlay=!0,t._prerollPlayTime=void 0}),es.forEach(function(i){return e.on(i,t._updateAdData.bind(t))});var r=function(){t.isAdBreak=!1};e.on("adbreakstart",function(){t.isAdBreak=!0}),e.on("play",r),e.on("playing",r),e.on("viewend",r),e.on("adrequest",function(i,r){r=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdRequestNumber++},r),ea(t._adRequests,r),y(e.data,"view_ad_request_count"),t.inPrerollPosition()&&(e.data.view_preroll_requested=!0,t._adHasPlayed||y(e.data,"view_preroll_request_count"))}),e.on("adresponse",function(i,r){r=Object.assign({ad_request_id:"generatedAdRequestId"+t._currentAdResponseNumber++},r),ea(t._adResponses,r);var n=t.findAdRequest(r.ad_request_id);n&&y(e.data,"view_ad_request_time",Math.max(0,r.viewer_time-n.viewer_time))}),e.on("adplay",function(i,r){t._adHasPlayed=!0,t._wouldBeNewAdPlay&&(t._wouldBeNewAdPlay=!1,y(e.data,"view_ad_played_count")),t.inPrerollPosition()&&!e.data.view_preroll_played&&(e.data.view_preroll_played=!0,t._adRequests.length>0&&(e.data.view_preroll_request_time=Math.max(0,r.viewer_time-t._adRequests[0].viewer_time)),e.data.view_start&&(e.data.view_startup_preroll_request_time=Math.max(0,r.viewer_time-e.data.view_start)),t._prerollPlayTime=r.viewer_time)}),e.on("adplaying",function(i,r){t.inPrerollPosition()&&void 0===e.data.view_preroll_load_time&&void 0!==t._prerollPlayTime&&(e.data.view_preroll_load_time=r.viewer_time-t._prerollPlayTime,e.data.view_startup_preroll_load_time=r.viewer_time-t._prerollPlayTime)}),e.on("adclicked",function(i,r){t._wouldBeNewAdPlay||y(e.data,"view_ad_clicked_count")}),e.on("adskipped",function(i,r){t._wouldBeNewAdPlay||y(e.data,"view_ad_skipped_count")}),e.on("adended",function(){t._wouldBeNewAdPlay=!0}),e.on("aderror",function(){t._wouldBeNewAdPlay=!0})}return e=[{key:"inPrerollPosition",value:function(){return void 0===this.pm.data.view_content_playback_time||this.pm.data.view_content_playback_time<=1e3}},{key:"findAdRequest",value:function(e){for(var t=0;t<this._adRequests.length;t++)if(this._adRequests[t].ad_request_id===e)return this._adRequests[t]}},{key:"_updateAdData",value:function(e,t){if(this.inPrerollPosition()){if(!this.pm.data.view_preroll_ad_tag_hostname&&t.ad_tag_url){var i=ei(g(t.ad_tag_url),2),r=i[0],n=i[1];this.pm.data.view_preroll_ad_tag_domain=n,this.pm.data.view_preroll_ad_tag_hostname=r}if(!this.pm.data.view_preroll_ad_asset_hostname&&t.ad_asset_url){var a=ei(g(t.ad_asset_url),2),s=a[0],o=a[1];this.pm.data.view_preroll_ad_asset_domain=o,this.pm.data.view_preroll_ad_asset_hostname=s}}this.pm.data.ad_asset_url=null==t?void 0:t.ad_asset_url,this.pm.data.ad_tag_url=null==t?void 0:t.ad_tag_url,this.pm.data.ad_creative_id=null==t?void 0:t.ad_creative_id,this.pm.data.ad_id=null==t?void 0:t.ad_id,this.pm.data.ad_universal_id=null==t?void 0:t.ad_universal_id}}],en(i.prototype,e),t&&en(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}();function el(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var eu=(ta=function e(t){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,e);var i,r,a=function(){t.disableRebufferTracking||i&&(y(t.data,"view_waiting_rebuffer_duration",p.now()-i),i=!1,n().clearInterval(r))},s=!1,o=function(){s=!1,a()};t.on("waiting",function(){s&&(t.disableRebufferTracking||(y(t.data,"view_waiting_rebuffer_count",1),i=p.now(),r=n().setInterval(function(){if(i){var e=p.now();y(t.data,"view_waiting_rebuffer_duration",e-i),i=e}},250)))}),t.on("playing",function(){a(),s=!0}),t.on("pause",o),t.on("seeking",o)},ts&&el(ta.prototype,ts),to&&el(ta,to),Object.defineProperty(ta,"prototype",{writable:!1}),ta);function ec(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ed=(tl=function e(t){var i=this;!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,e);var r=function(){i.lastWallClockTime=p.now(),t.on("before*",n)},n=function(e){var r=p.now(),n=i.lastWallClockTime;i.lastWallClockTime=r,r-n>3e4&&(t.emit("devicesleep",{viewer_time:n}),Object.assign(t.data,{viewer_time:n}),t.send("devicesleep"),t.emit("devicewake",{viewer_time:r}),Object.assign(t.data,{viewer_time:r}),t.send("devicewake"))};t.one("playbackheartbeat",r),t.on("playbackheartbeatend",function(){t.off("before*",n),t.one("playbackheartbeat",r)})},tu&&ec(tl.prototype,tu),tc&&ec(tl,tc),Object.defineProperty(tl,"prototype",{writable:!1}),tl),eh=i(375),ef=i(655),ep=i.n(ef),em="muxData",eg=function(){var e;try{e=eh.parse(ep().get(em)||"")}catch(t){e={}}return e},ev=function(e){try{ep().set(em,eh.stringify(e),{expires:365})}catch(e){}},ey=function(){var e=eg();return e.mux_viewer_id=e.mux_viewer_id||a(),e.msn=e.msn||Math.random(),ev(e),{mux_viewer_id:e.mux_viewer_id,mux_sample_number:e.msn}},eb=function(){var e;switch(e_()){case"cellular":e="cellular";break;case"ethernet":e="wired";break;case"wifi":e="wifi";break;case void 0:break;default:e="other"}return e},e_=function(){var e=n().navigator,t=e&&(e.connection||e.mozConnection||e.webkitConnection);return t&&t.type};eb.getConnectionFromAPI=e_;var eE=ex({a:"env",b:"beacon",c:"custom",d:"ad",e:"event",f:"experiment",i:"internal",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"}),eS=ex({ad:"ad",ag:"aggregate",ap:"api",al:"application",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",br:"break",bw:"browser",by:"bytes",ca:"cached",cb:"cancel",cc:"codec",cd:"code",cg:"category",ch:"changed",ck:"clicked",cl:"canceled",cn:"config",co:"count",ce:"counter",cp:"complete",cr:"creative",ct:"content",cu:"current",cx:"connection",cz:"context",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",dr:"drm",dp:"dropped",du:"duration",dv:"device",ec:"encoding",ed:"edge",en:"end",eg:"engine",em:"embed",er:"error",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",ep:"experiments",fa:"failed",fi:"first",fm:"family",ft:"format",fp:"fps",fq:"frequency",fr:"frame",fs:"fullscreen",ha:"has",hb:"holdback",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mf:"manifest",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mx:"mux",ne:"newest",nm:"name",no:"number",on:"on",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pr:"preload",ps:"position",pt:"part",py:"property",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",rm:"remote",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",sd:"skipped",se:"session",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",st:"start",su:"startup",sv:"server",sw:"software",ta:"tag",tc:"tech",te:"text",tg:"target",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",un:"universal",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"});function ex(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[e[i]]=i);return t}function eT(e){var t={},i={};return Object.keys(e).forEach(function(r){var n=!1;if(e.hasOwnProperty(r)&&void 0!==e[r]){var a=r.split("_"),s=a[0],o=eE[s];o||(h.info("Data key word `"+a[0]+"` not expected in "+r),o=s+"_"),a.splice(1).forEach(function(e){"url"===e&&(n=!0),eS[e]?o+=eS[e]:Number(e)&&Math.floor(Number(e))===Number(e)?o+=e:(h.info("Data key word `"+e+"` not expected in "+r),o+="_"+e+"_")}),n?i[o]=e[r]:t[o]=e[r]}}),Object.assign(t,i)}var ew={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:1e4,maxPayloadKBSize:500},eA=["hb","requestcompleted","requestfailed","requestcanceled"],eM=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._beaconUrl=e||"https://img.litix.io",this._eventQueue=[],this._postInFlight=!1,this._failureCount=0,this._sendTimeout=!1,this._options=Object.assign({},ew,t)};eM.prototype.queueEvent=function(e,t){var i=Object.assign({},t);return(this._eventQueue.length<=this._options.maxQueueLength||"eventrateexceeded"===e)&&(this._eventQueue.push(i),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength)},eM.prototype.flushEvents=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&1===this._eventQueue.length?this._eventQueue.pop():(this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending())},eM.prototype.destroy=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.destroyed=!0,e?this._clearBeaconQueue():this.flushEvents(),n().clearTimeout(this._sendTimeout)},eM.prototype._clearBeaconQueue=function(){var e=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,t=this._eventQueue.slice(e);e>0&&Object.assign(t[t.length-1],eT({mux_view_message:"event queue truncated"}));var i=this._createPayload(t);eR(this._beaconUrl,i,!0,function(){})},eM.prototype._sendBeaconQueue=function(){var e=this;if(!this._postInFlight){var t=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0;var i=this._createPayload(t),r=p.now();eR(this._beaconUrl,i,!1,function(i,n){n?(e._eventQueue=t.concat(e._eventQueue),e._failureCount+=1,h.info("Error sending beacon: "+n)):e._failureCount=0,e._roundTripTime=p.now()-r,e._postInFlight=!1})}},eM.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var e=Math.pow(2,this._failureCount-1);return(1+(e*=Math.random()))*this._options.baseTimeBetweenBeacons},eM.prototype._startBeaconSending=function(){var e=this;n().clearTimeout(this._sendTimeout),this.destroyed||(this._sendTimeout=n().setTimeout(function(){e._eventQueue.length&&e._sendBeaconQueue(),e._startBeaconSending()},this._getNextBeaconTime()))},eM.prototype._createPayload=function(e){var t,i,r,n=this,a={transmission_timestamp:Math.round(p.now())};this._roundTripTime&&(a.rtt_ms=Math.round(this._roundTripTime));var s=function(){r=(t=JSON.stringify({metadata:a,events:i||e})).length/1024},o=function(){return r<=n._options.maxPayloadKBSize};return s(),o()||(h.info("Payload size is too big ("+r+" kb). Removing unnecessary events."),i=e.filter(function(e){return -1===eA.indexOf(e.e)}),s()),o()||(h.info("Payload size still too big ("+r+" kb). Cropping fields.."),i.forEach(function(e){for(var t in e){var i=e[t];"string"==typeof i&&i.length>51200&&(e[t]=i.substring(0,51200))}}),s()),t};var eR=function(e,t,i,r){if(i&&navigator&&navigator.sendBeacon&&navigator.sendBeacon(e,t))r();else if(n().fetch)n().fetch(e,{method:"POST",body:t,headers:{"Content-Type":"text/plain"},keepalive:t.length<=57344}).then(function(e){return r(null,e.ok?null:"Error")}).catch(function(e){return r(null,e)});else{if(n().XMLHttpRequest){var a=new(n()).XMLHttpRequest;return a.onreadystatechange=function(){if(4===a.readyState)return r(null,200!==a.status?"error":void 0)},a.open("POST",e),a.setRequestHeader("Content-Type","text/plain"),void a.send(t)}r()}};function eC(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function eI(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function eL(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?eI(Object(i),!0).forEach(function(t){eP(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):eI(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function ek(e){return(ek="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eD(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eP(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var eO=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id"],eN=["adplay","adplaying","adpause","adfirstquartile","admidpoint","adthirdquartile","adended","adresponse","adrequest"],eU=["ad_id","ad_creative_id","ad_universal_id"],eF=["viewstart","error","ended","viewend"],eB=function(){var e,t;function i(e,t){var r,a,s,o,l,u,c,d,h,f,p,m,g,v,y,b,_,E,S,x=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,i),eP(this,"previousBeaconData",null),eP(this,"lastEventTime",0),eP(this,"rateLimited",!1),this.mux=e,this.envKey=t,this.options=x,this.eventQueue=new eM((r=this.envKey,s=(a=this.options).beaconCollectionDomain,o=a.beaconDomain,s?"https://"+s:(r=r||"inferred").match(/^[a-z0-9]+$/)?"https://"+r+"."+(o||"litix.io"):"https://img.litix.io/a.gif")),this.sampleRate=null!==(l=this.options.sampleRate)&&void 0!==l?l:1,this.disableCookies=null!==(u=this.options.disableCookies)&&void 0!==u&&u,this.respectDoNotTrack=null!==(c=this.options.respectDoNotTrack)&&void 0!==c&&c,this.previousBeaconData=null,this.lastEventTime=0,this.rateLimited=!1,this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:null===(d=this.options.platform)||void 0===d?void 0:d.name,viewer_application_version:null===(h=this.options.platform)||void 0===h?void 0:h.version,viewer_application_engine:null===(f=this.options.platform)||void 0===f?void 0:f.layout,viewer_device_name:null===(p=this.options.platform)||void 0===p?void 0:p.product,viewer_device_category:"",viewer_device_manufacturer:null===(m=this.options.platform)||void 0===m?void 0:m.manufacturer,viewer_os_family:null===(g=this.options.platform)||void 0===g||null===(v=g.os)||void 0===v?void 0:v.family,viewer_os_architecture:null===(y=this.options.platform)||void 0===y||null===(b=y.os)||void 0===b?void 0:b.architecture,viewer_os_version:null===(_=this.options.platform)||void 0===_||null===(E=_.os)||void 0===E?void 0:E.version,viewer_connection_type:eb(),page_url:null===n()||void 0===n()||null===(S=n().location)||void 0===S?void 0:S.href},this.viewerData=this.disableCookies?{}:ey()}return e=[{key:"send",value:function(e,t){var i;if(e&&null!=t&&t.view_id){if(this.respectDoNotTrack&&f())return h.info("Not sending `"+e+"` because Do Not Track is enabled");if(!t||"object"!==ek(t))return h.error("A data object was expected in send() but was not provided");var r,n,s=this.disableCookies?{}:(r=eg(),n=p.now(),r.session_start&&(r.sst=r.session_start,delete r.session_start),r.session_id&&(r.sid=r.session_id,delete r.session_id),r.session_expires&&(r.sex=r.session_expires,delete r.session_expires),(!r.sex||r.sex<n)&&(r.sid=a(),r.sst=n),r.sex=n+15e5,ev(r),{session_id:r.sid,session_start:r.sst,session_expires:r.sex}),o=eL(eL(eL(eL(eL({},this.pageLevelData),t),s),this.viewerData),{},{event:e,env_key:this.envKey});o.user_id&&(o.viewer_user_id=o.user_id,delete o.user_id);var l=(null!==(i=o.mux_sample_number)&&void 0!==i?i:0)>=this.sampleRate,u=eT(this._deduplicateBeaconData(e,o));if(this.lastEventTime=this.mux.utils.now(),l)return h.info("Not sending event due to sample rate restriction",e,o,u);if(this.envKey||h.info("Missing environment key (envKey) - beacons will be dropped if the video source is not a valid mux video URL",e,o,u),!this.rateLimited){if(h.info("Sending event",e,o,u),this.rateLimited=!this.eventQueue.queueEvent(e,u),this.mux.WINDOW_UNLOADING&&"viewend"===e)this.eventQueue.destroy(!0);else if(this.mux.WINDOW_HIDDEN&&"hb"===e?this.eventQueue.flushEvents(!0):eF.indexOf(e)>=0&&this.eventQueue.flushEvents(),this.rateLimited)return o.event="eventrateexceeded",u=eT(o),this.eventQueue.queueEvent(o.event,u),h.error("Beaconing disabled due to rate limit.")}}}},{key:"destroy",value:function(){this.eventQueue.destroy(!1)}},{key:"_deduplicateBeaconData",value:function(e,t){var i=this,r={},n=t.view_id;if("-1"===n||"viewstart"===e||"viewend"===e||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=6e5)r=eL({},t),n&&(this.previousBeaconData=r),n&&"viewend"===e&&(this.previousBeaconData=null);else{var a=0===e.indexOf("request");Object.entries(t).forEach(function(t){var n=function(e){if(Array.isArray(e))return e}(t)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,a=[],s=!0,o=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(o)throw n}}return a}}(t,2)||function(e,t){if(e){if("string"==typeof e)return eC(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?eC(e,t):void 0}}(t,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),s=n[0],o=n[1];i.previousBeaconData&&(o!==i.previousBeaconData[s]||eO.indexOf(s)>-1||i.objectHasChanged(a,s,o,i.previousBeaconData[s])||i.eventRequiresKey(e,s))&&(r[s]=o,i.previousBeaconData[s]=o)})}return r}},{key:"objectHasChanged",value:function(e,t,i,r){return!(!e||0!==t.indexOf("request_")||"request_response_headers"!==t&&"object"===ek(i)&&"object"===ek(r)&&Object.keys(i||{}).length===Object.keys(r||{}).length)}},{key:"eventRequiresKey",value:function(e,t){return"renditionchange"===e&&0===t.indexOf("video_source_")||!(!eU.includes(t)||!eN.includes(e))}}],eD(i.prototype,e),t&&eD(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}();function eV(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var ez=(td=function e(t){!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,e);var i=0,r=0,n=0,a=0,s=0,o=0,l=0;t.on("requestcompleted",function(e,o){var l,u,c=o.request_start,d=o.request_response_start,h=o.request_response_end,f=o.request_bytes_loaded;if(a++,d?(l=d-(null!=c?c:0),u=(null!=h?h:0)-d):u=(null!=h?h:0)-(null!=c?c:0),u>0&&f&&f>0){var p=f/u*8e3;s++,r+=f,n+=u,t.data.view_min_request_throughput=Math.min(t.data.view_min_request_throughput||1/0,p),t.data.view_average_request_throughput=r/n*8e3,t.data.view_request_count=a,l>0&&(i+=l,t.data.view_max_request_latency=Math.max(t.data.view_max_request_latency||0,l),t.data.view_average_request_latency=i/s)}}),t.on("requestfailed",function(e,i){a++,o++,t.data.view_request_count=a,t.data.view_request_failed_count=o}),t.on("requestcanceled",function(e,i){a++,l++,t.data.view_request_count=a,t.data.view_request_canceled_count=l})},th&&eV(td.prototype,th),tf&&eV(td,tf),Object.defineProperty(td,"prototype",{writable:!1}),td);function ej(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var eH=(tp=function e(t){var i=this;(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,e),t.on("before*",function(e,r){var n=r.viewer_time,a=p.now(),s=i._lastEventTime;if(i._lastEventTime=a,s&&a-s>36e5){var o=Object.keys(t.data).reduce(function(e,i){var r,n;return 0===i.indexOf("video_")?Object.assign(e,(r={},n=t.data[i],i in r?Object.defineProperty(r,i,{value:n,enumerable:!0,configurable:!0,writable:!0}):r[i]=n,r)):e},{});t.mux.log.info("Received event after at least an hour inactivity, creating a new view"),t.emit("viewinit",Object.assign({viewer_time:n},o)),t.playbackHeartbeat._playheadShouldBeProgressing&&"play"!==e.type&&"adbreakstart"!==e.type&&(t.emit("play",{viewer_time:n}),"playing"!==e.type&&t.emit("playing",{viewer_time:n}))}})},tm&&ej(tp.prototype,tm),tg&&ej(tp,tg),Object.defineProperty(tp,"prototype",{writable:!1}),tp);function eG(e){return(eG="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function eW(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function e$(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function eq(e,t){return(eq=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function eY(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function eK(e){return(eK=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var eX=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange"],eZ=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eq(e,t)}(s,e);var t,i,r,n=(t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,i=eK(s);if(t){var r=eK(this).constructor;e=Reflect.construct(i,arguments,r)}else e=i.apply(this,arguments);return function(e,t){if(t&&("object"===eG(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return eY(e)}(this,e)});function s(e,t,i){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,s),(o=n.call(this)).DOM_CONTENT_LOADED_EVENT_END=v.domContentLoadedEventEnd(),o.NAVIGATION_START=v.navigationStart(),o.mux=e,o.id=t,null!==(r=i)&&void 0!==r&&r.beaconDomain&&o.mux.log.warn("The `beaconDomain` setting has been deprecated in favor of `beaconCollectionDomain`. Please change your integration to use `beaconCollectionDomain` instead of `beaconDomain`."),(i=Object.assign({debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,disablePlayheadRebufferTracking:!1,errorTranslator:function(e){return e}},i)).data=i.data||{},i.data.property_key&&(i.data.env_key=i.data.property_key,delete i.data.property_key),h.setLevel(i.debug?"debug":"warn"),o.getPlayheadTime=i.getPlayheadTime,o.getStateData=i.getStateData||function(){return{}},o.getAdData=i.getAdData||function(){},o.minimumRebufferDuration=i.minimumRebufferDuration,o.sustainedRebufferThreshold=i.sustainedRebufferThreshold,o.playbackHeartbeatTime=i.playbackHeartbeatTime,o.disableRebufferTracking=i.disableRebufferTracking,o.disableRebufferTracking&&o.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),o.disablePlayheadRebufferTracking=i.disablePlayheadRebufferTracking,o.errorTranslator=i.errorTranslator,o.playbackEventDispatcher=new eB(e,i.data.env_key,i),o.data={player_instance_id:a(),mux_sample_rate:i.sampleRate,beacon_domain:i.beaconCollectionDomain||i.beaconDomain},o.data.view_sequence_number=1,o.data.player_sequence_number=1,o.oldEmit=o.emit,o.emit=function(e,t){t=Object.assign({viewer_time:this.mux.utils.now()},t),this.oldEmit(e,t)};var r,o,l=(function(){void 0===this.data.view_start&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}).bind(eY(o));o.on("viewinit",function(e,t){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),Object.assign(this.data,t),this._initializeViewData(),this.one("play",l),this.one("adbreakstart",l)});var u=(function(e){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",e)}).bind(eY(o));if(o.on("videochange",function(e,t){u(t)}),o.on("programchange",function(e,t){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),u(Object.assign(t,{view_program_changed:!0})),l(),this.emit("play"),this.emit("playing")}),o.on("fragmentchange",function(e,t){this.currentFragmentPDT=t.currentFragmentPDT,this.currentFragmentStart=t.currentFragmentStart}),o.on("destroy",o.destroy),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&"function"==typeof window.removeEventListener){var c=function(){var e=void 0!==o.data.view_start;o.mux.WINDOW_HIDDEN="hidden"===document.visibilityState,e&&o.mux.WINDOW_HIDDEN&&(o.data.player_is_paused||o.emit("hb"))};window.addEventListener("visibilitychange",c,!1);var d=function(e){e.persisted||o.destroy()};window.addEventListener("pagehide",d,!1),o.on("destroy",function(){window.removeEventListener("visibilitychange",c),window.removeEventListener("pagehide",d)})}return o.on("playerready",function(e,t){Object.assign(this.data,t)}),eX.forEach(function(e){o.on(e,function(t,i){0!==e.indexOf("ad")&&this._updateStateData(),Object.assign(this.data,i),this._sanitizeData()}),o.on("after"+e,function(){("error"!==e||this.errorTracker.viewErrored)&&this.send(e)})}),o.on("viewend",function(e,t){Object.assign(o.data,t)}),o.one("playerready",function(e){var t=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=t-this.data.player_init_time),!this.mux.PLAYER_TRACKED&&this.NAVIGATION_START&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.DOM_CONTENT_LOADED_EVENT_END)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.DOM_CONTENT_LOADED_EVENT_END||1/0)-this.NAVIGATION_START)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time}),o.longResumeTracker=new eH(eY(o)),o.errorTracker=new B(eY(o)),new ed(eY(o)),o.seekingTracker=new et(eY(o)),o.playheadTime=new W(eY(o)),o.playbackHeartbeat=new U(eY(o)),new Q(eY(o)),o.watchTimeTracker=new z(eY(o)),new H(eY(o)),o.adTracker=new eo(eY(o)),new K(eY(o)),new q(eY(o)),new Z(eY(o)),new eu(eY(o)),new ez(eY(o)),i.hlsjs&&o.addHLSJS(i),i.dashjs&&o.addDashJS(i),o.emit("viewinit",i.data),o}return i=[{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,void 0!==this.data.view_start&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),window.clearTimeout(this._heartBeatTimeout))}},{key:"send",value:function(e){if(this.data.view_id){var t=Object.assign({},this.data);if(void 0===t.video_source_is_live&&(t.player_source_duration===1/0||t.video_source_duration===1/0?t.video_source_is_live=!0:(t.player_source_duration>0||t.video_source_duration>0)&&(t.video_source_is_live=!1)),t.video_source_is_live||["player_program_time","player_manifest_newest_program_time","player_live_edge_program_time","player_program_time","video_holdback","video_part_holdback","video_target_duration","video_part_target_duration"].forEach(function(e){t[e]=void 0}),t.video_source_url=t.video_source_url||t.player_source_url,t.video_source_url){var i,r=function(e){if(Array.isArray(e))return e}(i=g(t.video_source_url))||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,a=[],s=!0,o=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(o)throw n}}return a}}(i,2)||function(e,t){if(e){if("string"==typeof e)return eW(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?eW(e,t):void 0}}(i,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[0],a=r[1];t.video_source_domain=a,t.video_source_hostname=n}delete t.ad_request_id,this.playbackEventDispatcher.send(e,t),this.data.view_sequence_number++,this.data.player_sequence_number++,this._restartHeartBeat(),"viewend"===e&&delete this.data.view_id}}},{key:"_updateStateData",value:function(){Object.assign(this.data,this.getStateData()),this.playheadTime._updatePlayheadTime(),this._sanitizeData()}},{key:"_sanitizeData",value:function(){var e=this;["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"].forEach(function(t){var i=parseInt(e.data[t],10);e.data[t]=isNaN(i)?void 0:i}),["player_source_url","video_source_url"].forEach(function(t){if(e.data[t]){var i=e.data[t].toLowerCase();0!==i.indexOf("data:")&&0!==i.indexOf("blob:")||(e.data[t]="MSE style URL")}})}},{key:"_resetVideoData",value:function(e,t){var i=this;Object.keys(this.data).forEach(function(e){0===e.indexOf("video_")&&delete i.data[e]})}},{key:"_resetViewData",value:function(){var e=this;Object.keys(this.data).forEach(function(t){0===t.indexOf("view_")&&delete e.data[t]}),this.data.view_sequence_number=1}},{key:"_resetErrorData",value:function(e,t){delete this.data.player_error_code,delete this.data.player_error_message}},{key:"_initializeViewData",value:function(){var e=this,t=this.data.view_id=a(),i=function(){t===e.data.view_id&&y(e.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",i):i()}},{key:"_restartHeartBeat",value:function(){var e=this;window.clearTimeout(this._heartBeatTimeout),this.errorTracker.viewErrored||(this._heartBeatTimeout=window.setTimeout(function(){e.data.player_is_paused||e.emit("hb")},1e4))}},{key:"addHLSJS",value:function(e){e.hlsjs?this.hlsjs?this.mux.log.warn("An instance of HLS.js is already being monitored for this player."):(this.hlsjs=e.hlsjs,function(e,t,i){var r=arguments.length>4?arguments[4]:void 0,n=e.log,a=e.utils.secondsToMs,s=function(e){var t,i=parseInt(r.version);return 1===i&&null!==e.programDateTime&&(t=e.programDateTime),0===i&&null!==e.pdt&&(t=e.pdt),t};if(v.exists()){var o=function(i,r){return e.emit(t,i,r)},l=function(e,t){var i=t.levels,r=t.audioTracks,n=t.url,a=t.stats,s=t.networkDetails,l=t.sessionData,u={},c={};i.forEach(function(e,t){u[t]={width:e.width,height:e.height,bitrate:e.bitrate,attrs:e.attrs}}),r.forEach(function(e,t){c[t]={name:e.name,language:e.lang,bitrate:e.bitrate}});var d=A(a),h=d.bytesLoaded,f=d.requestStart,p=d.responseStart,g=d.responseEnd;o("requestcompleted",w(w({},x(l)),{},{request_event_type:e,request_bytes_loaded:h,request_start:f,request_response_start:p,request_response_end:g,request_type:"manifest",request_hostname:m(n),request_response_headers:M(s),request_rendition_lists:{media:u,audio:c,video:{}}}))};i.on(r.Events.MANIFEST_LOADED,l);var u=function(e,t){var i=t.details,r=t.level,n=t.networkDetails,l=A(t.stats),u=l.bytesLoaded,c=l.requestStart,d=l.responseStart,h=l.responseEnd,f=i.fragments[i.fragments.length-1],p=s(f)+a(f.duration);o("requestcompleted",{request_event_type:e,request_bytes_loaded:u,request_start:c,request_response_start:d,request_response_end:h,request_current_level:r,request_type:"manifest",request_hostname:m(i.url),request_response_headers:M(n),video_holdback:i.holdBack&&a(i.holdBack),video_part_holdback:i.partHoldBack&&a(i.partHoldBack),video_part_target_duration:i.partTarget&&a(i.partTarget),video_target_duration:i.targetduration&&a(i.targetduration),video_source_is_live:i.live,player_manifest_newest_program_time:isNaN(p)?void 0:p})};i.on(r.Events.LEVEL_LOADED,u);var c=function(e,t){var i=t.details,r=t.networkDetails,n=A(t.stats);o("requestcompleted",{request_event_type:e,request_bytes_loaded:n.bytesLoaded,request_start:n.requestStart,request_response_start:n.responseStart,request_response_end:n.responseEnd,request_type:"manifest",request_hostname:m(i.url),request_response_headers:M(r)})};i.on(r.Events.AUDIO_TRACK_LOADED,c);var d=function(e,t){var r=t.stats,n=t.networkDetails,a=t.frag,s=A(r=r||a.stats),l=s.bytesLoaded,u=s.requestStart,c=s.responseStart,d=s.responseEnd,h=n?M(n):void 0,f={request_event_type:e,request_bytes_loaded:l,request_start:u,request_response_start:c,request_response_end:d,request_hostname:n?m(n.responseURL):void 0,request_id:h?S(h):void 0,request_response_headers:h,request_media_duration:a.duration,request_url:null==n?void 0:n.responseURL};"main"===a.type?(f.request_type="media",f.request_current_level=a.level,f.request_video_width=(i.levels[a.level]||{}).width,f.request_video_height=(i.levels[a.level]||{}).height,f.request_labeled_bitrate=(i.levels[a.level]||{}).bitrate):f.request_type=a.type,o("requestcompleted",f)};i.on(r.Events.FRAG_LOADED,d);var h=function(e,t){var i=t.frag,r=i.start;o("fragmentchange",{currentFragmentPDT:s(i),currentFragmentStart:a(r)})};i.on(r.Events.FRAG_CHANGED,h);var f=function(e,t){var i,n=t.type,a=t.details,s=t.response,l=t.fatal,u=t.frag,c=t.networkDetails,d=(null==u?void 0:u.url)||t.url||"",h=c?M(c):void 0;a!==r.ErrorDetails.MANIFEST_LOAD_ERROR&&a!==r.ErrorDetails.MANIFEST_LOAD_TIMEOUT&&a!==r.ErrorDetails.FRAG_LOAD_ERROR&&a!==r.ErrorDetails.FRAG_LOAD_TIMEOUT&&a!==r.ErrorDetails.LEVEL_LOAD_ERROR&&a!==r.ErrorDetails.LEVEL_LOAD_TIMEOUT&&a!==r.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&a!==r.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT&&a!==r.ErrorDetails.SUBTITLE_LOAD_ERROR&&a!==r.ErrorDetails.SUBTITLE_LOAD_TIMEOUT&&a!==r.ErrorDetails.KEY_LOAD_ERROR&&a!==r.ErrorDetails.KEY_LOAD_TIMEOUT||o("requestfailed",{request_error:a,request_url:d,request_hostname:m(d),request_id:h?S(h):void 0,request_type:a===r.ErrorDetails.FRAG_LOAD_ERROR||a===r.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":a===r.ErrorDetails.AUDIO_TRACK_LOAD_ERROR||a===r.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT?"audio":a===r.ErrorDetails.SUBTITLE_LOAD_ERROR||a===r.ErrorDetails.SUBTITLE_LOAD_TIMEOUT?"subtitle":a===r.ErrorDetails.KEY_LOAD_ERROR||a===r.ErrorDetails.KEY_LOAD_TIMEOUT?"encryption":"manifest",request_error_code:null==s?void 0:s.code,request_error_text:null==s?void 0:s.text}),l&&o("error",{player_error_code:n,player_error_message:a,player_error_context:"".concat(d?"url: ".concat(d,"\n"):"")+"".concat(s&&(s.code||s.text)?"response: ".concat(s.code,", ").concat(s.text,"\n"):"")+"".concat(t.reason?"failure reason: ".concat(t.reason,"\n"):"")+"".concat(t.level?"level: ".concat(t.level,"\n"):"")+"".concat(t.parent?"parent stream controller: ".concat(t.parent,"\n"):"")+"".concat(t.buffer?"buffer length: ".concat(t.buffer,"\n"):"")+"".concat(t.error?"error: ".concat(t.error,"\n"):"")+"".concat(t.event?"event: ".concat(t.event,"\n"):"")+"".concat(t.err?"error message: ".concat(null===(i=t.err)||void 0===i?void 0:i.message,"\n"):"")})};i.on(r.Events.ERROR,f);var p=function(e,t){var i=t.frag,r=i&&i._url||"";o("requestcanceled",{request_event_type:e,request_url:r,request_type:"media",request_hostname:m(r)})};i.on(r.Events.FRAG_LOAD_EMERGENCY_ABORTED,p);var g=function(e,t){var r=t.level,a=i.levels[r];if(a&&a.attrs&&a.attrs.BANDWIDTH){var s,l=a.attrs.BANDWIDTH,u=parseFloat(a.attrs["FRAME-RATE"]);isNaN(u)||(s=u),l?o("renditionchange",{video_source_fps:s,video_source_bitrate:l,video_source_width:a.width,video_source_height:a.height,video_source_rendition_name:a.name,video_source_codec:null==a?void 0:a.videoCodec}):n.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};i.on(r.Events.LEVEL_SWITCHED,g),i._stopMuxMonitor=function(){i.off(r.Events.MANIFEST_LOADED,l),i.off(r.Events.LEVEL_LOADED,u),i.off(r.Events.AUDIO_TRACK_LOADED,c),i.off(r.Events.FRAG_LOADED,d),i.off(r.Events.FRAG_CHANGED,h),i.off(r.Events.ERROR,f),i.off(r.Events.FRAG_LOAD_EMERGENCY_ABORTED,p),i.off(r.Events.LEVEL_SWITCHED,g),i.off(r.Events.DESTROYING,i._stopMuxMonitor),delete i._stopMuxMonitor},i.on(r.Events.DESTROYING,i._stopMuxMonitor)}else n.warn("performance timing not supported. Not tracking HLS.js.")}(this.mux,this.id,e.hlsjs,{},e.Hls||window.Hls)):this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.")}},{key:"removeHLSJS",value:function(){var e;this.hlsjs&&((e=this.hlsjs)&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor(),this.hlsjs=void 0)}},{key:"addDashJS",value:function(e){e.dashjs?this.dashjs?this.mux.log.warn("An instance of Dash.js is already being monitored for this player."):(this.dashjs=e.dashjs,function(e,t,i){var r=e.log;if(i&&i.on){var n=function(i,r){return e.emit(t,i,r)},a=function(e){var t=e.type,i=(e.data||{}).url;n("requestcompleted",{request_event_type:t,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:m(i),request_url:i})};i.on("manifestLoaded",a);var s={},o=function(e){var t=e.type,r=e.fragmentModel,a=(e.chunk||{}).mediaInfo||{},o=a.type,l=a.bitrateList,u={};(l=l||[]).forEach(function(e,t){u[t]={},u[t].width=e.width,u[t].height=e.height,u[t].bitrate=e.bandwidth,u[t].attrs={}}),"video"===o?s.video=u:"audio"===o?s.audio=u:s.media=u;var c=I(r,i),d=c.requestStart,h=c.requestResponseStart,f=c.requestResponseEnd,p=c.requestResponseHeaders,m=c.requestMediaDuration,g=c.requestHostname,v=c.requestUrl;n("requestcompleted",{request_event_type:t,request_start:d,request_response_start:h,request_response_end:f,request_bytes_loaded:-1,request_type:o+"_init",request_response_headers:p,request_hostname:g,request_id:c.requestId,request_url:v,request_media_duration:m,request_rendition_lists:s})};i.on("initFragmentLoaded",o);var l=function(e){var t=e.type,r=e.fragmentModel,a=e.chunk||{},s=a.mediaInfo,o=a.start,l=(s||{}).type,u=I(r,i),c=u.requestStart,d=u.requestResponseStart,h=u.requestResponseEnd,f=u.requestBytesLoaded,p=u.requestResponseHeaders,m=u.requestMediaDuration,g=u.requestHostname,v=u.requestUrl,y=u.requestId,b=L(l,i),_=b.currentLevel,E=b.renditionWidth,S=b.renditionHeight,x=b.renditionBitrate;n("requestcompleted",{request_event_type:t,request_start:c,request_response_start:d,request_response_end:h,request_bytes_loaded:f,request_type:l,request_response_headers:p,request_hostname:g,request_id:y,request_url:v,request_media_start_time:o,request_media_duration:m,request_current_level:_,request_labeled_bitrate:x,request_video_width:E,request_video_height:S})};i.on("mediaFragmentLoaded",l);var u={video:void 0,audio:void 0,totalBitrate:void 0},c=function(){if(u.video&&"number"==typeof u.video.bitrate){if(u.video.width&&u.video.height){var e=u.video.bitrate;return u.audio&&"number"==typeof u.audio.bitrate&&(e+=u.audio.bitrate),e!==u.totalBitrate?(u.totalBitrate=e,{video_source_bitrate:e,video_source_height:u.video.height,video_source_width:u.video.width,video_source_codec:k(u.video.codec)}):void 0}r.warn("have bitrate info for video but missing width/height")}},d=function(e,t,a){if("number"==typeof e.newQuality){var s=e.mediaType;if("audio"===s||"video"===s){var o=i.getBitrateInfoListFor(s).find(function(t){return t.qualityIndex===e.newQuality});if(o&&"number"==typeof o.bitrate){u[s]=C(C({},o),{},{codec:i.getCurrentTrackFor(s).codec});var l=c();l&&n("renditionchange",l)}else r.warn("missing bitrate info for ".concat(s))}}else r.warn("missing evt.newQuality in qualityChangeRendered event",e)};i.on("qualityChangeRendered",d);var h=function(e){var t=e.request,i=e.mediaType;n("requestcanceled",{request_event_type:(t=t||{}).type+"_"+t.action,request_url:t.url,request_type:i,request_hostname:m(t.url)})};i.on("fragmentLoadingAbandoned",h);var f=function(e){var t,i,r=e.error,a=(null==r||null===(t=r.data)||void 0===t?void 0:t.request)||{},s=(null==r||null===(i=r.data)||void 0===i?void 0:i.response)||{};27===(null==r?void 0:r.code)&&n("requestfailed",{request_error:a.type+"_"+a.action,request_url:a.url,request_hostname:m(a.url),request_type:a.mediaType,request_error_code:s.status,request_error_text:s.statusText});var o="".concat(null!=a&&a.url?"url: ".concat(a.url,"\n"):"")+"".concat(null!=s&&s.status||null!=s&&s.statusText?"response: ".concat(null==s?void 0:s.status,", ").concat(null==s?void 0:s.statusText,"\n"):"");n("error",{player_error_code:null==r?void 0:r.code,player_error_message:null==r?void 0:r.message,player_error_context:o})};i.on("error",f),i._stopMuxMonitor=function(){i.off("manifestLoaded",a),i.off("initFragmentLoaded",o),i.off("mediaFragmentLoaded",l),i.off("qualityChangeRendered",d),i.off("error",f),i.off("fragmentLoadingAbandoned",h),delete i._stopMuxMonitor}}else r.warn("Invalid dash.js player reference. Monitoring blocked.")}(this.mux,this.id,e.dashjs)):this.mux.log.warn("You must pass a valid dashjs instance in order to track it.")}},{key:"removeDashJS",value:function(){var e;this.dashjs&&((e=this.dashjs)&&"function"==typeof e._stopMuxMonitor&&e._stopMuxMonitor(),this.dashjs=void 0)}}],e$(s.prototype,i),r&&e$(s,r),Object.defineProperty(s,"prototype",{writable:!1}),s}(O),eJ=i(153),eQ=i.n(eJ);function e0(e){return(e0="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function e1(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,a=[],s=!0,o=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(o)throw n}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return e2(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?e2(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e2(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}var e3,e5,e4,e6,e8,e7,e9,te,tt,ti,tr,tn,ta,ts,to,tl,tu,tc,td,th,tf,tp,tm,tg,tv,ty=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],tb={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"};n()&&n().WeakMap&&(tv=new WeakMap);var t_=function(e){return this.buffer="",this.manifest={segments:[],serverControl:{},sessionData:{}},this.currentUri={},this.process(e),this.manifest};t_.prototype.process=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.processLine(this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t_.prototype.processLine=function(e){var t=e.indexOf(":"),i=tM(e,t),r=i[0],n=2===i.length?tx(i[1]):void 0;if("#"!==r[0])this.currentUri.uri=r,this.manifest.segments.push(this.currentUri),!this.manifest.targetDuration||"duration"in this.currentUri||(this.currentUri.duration=this.manifest.targetDuration),this.currentUri={};else switch(r){case"#EXT-X-TARGETDURATION":if(!isFinite(n)||n<0)return;this.manifest.targetDuration=n,this.setHoldBack();break;case"#EXT-X-PART-INF":tE(this.manifest,i),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),this.setHoldBack();break;case"#EXT-X-SERVER-CONTROL":tE(this.manifest,i),this.setHoldBack();break;case"#EXTINF":0===n?this.currentUri.duration=.01:n>0&&(this.currentUri.duration=n);break;case"#EXT-X-PROGRAM-DATE-TIME":var a=new Date(n);this.manifest.dateTimeString||(this.manifest.dateTimeString=n,this.manifest.dateTimeObject=a),this.currentUri.dateTimeString=n,this.currentUri.dateTimeObject=a;break;case"#EXT-X-VERSION":tE(this.manifest,i);break;case"#EXT-X-SESSION-DATA":var s=x(tR(i[1]));Object.assign(this.manifest.sessionData,s)}},t_.prototype.setHoldBack=function(){var e=this.manifest,t=e.serverControl,i=e.targetDuration,r=e.partTargetDuration;if(t){var n="holdBack",a="partHoldBack",s=i&&3*i,o=r&&2*r;i&&!t.hasOwnProperty(n)&&(t[n]=s),s&&t[n]<s&&(t[n]=s),r&&!t.hasOwnProperty(a)&&(t[a]=3*r),r&&t[a]<o&&(t[a]=o)}};var tE=function(e,t){var i,r=tS(t[0].replace("#EXT-X-",""));tA(t[1])?(i={},i=Object.assign(tw(t[1]),i)):i=tx(t[1]),e[r]=i},tS=function(e){return e.toLowerCase().replace(/-(\w)/g,function(e){return e[1].toUpperCase()})},tx=function(e){if("yes"===e.toLowerCase()||"no"===e.toLowerCase())return"yes"===e.toLowerCase();var t=-1!==e.indexOf(":")?e:parseFloat(e);return isNaN(t)?e:t},tT=function(e){var t={},i=e.split("=");return i.length>1&&(t[tS(i[0])]=tx(i[1])),t},tw=function(e){for(var t=e.split(","),i={},r=0;t.length>r;r++)i=Object.assign(tT(t[r]),i);return i},tA=function(e){return e.indexOf("=")>-1},tM=function(e,t){return -1===t?[e]:[e.substring(0,t),e.substring(t+1)]},tR=function(e){var t={};if(e){var i=e.search(",");return[e.slice(0,i),e.slice(i+1)].forEach(function(e,i){for(var r=e.replace(/['"]+/g,"").split("="),n=0;n<r.length;n++)"DATA-ID"===r[n]&&(t["DATA-ID"]=r[1-n]),"VALUE"===r[n]&&(t.VALUE=r[1-n])}),{data:t}}},tC={safeCall:function(e,t,i,r){var n=r;if(e&&"function"==typeof e[t])try{n=e[t].apply(e,i)}catch(e){h.info("safeCall error",e)}return n},safeIncrement:y,getComputedStyle:function(e,t){var i;if(e&&t&&n()&&"function"==typeof n().getComputedStyle)return tv&&tv.has(e)&&(i=tv.get(e)),i||(i=n().getComputedStyle(e,null),tv&&tv.set(e,i)),i.getPropertyValue(t)},secondsToMs:function(e){return Math.floor(1e3*e)},assign:Object.assign,headersStringToObject:E,cdnHeadersToRequestId:S,extractHostnameAndDomain:g,extractHostname:m,manifestParser:t_,generateShortID:s,generateUUID:a,now:p.now};function tI(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}var tL={},tk=function e(t){var i=arguments;"string"==typeof t?e.hasOwnProperty(t)?n().setTimeout(function(){i=Array.prototype.splice.call(i,1),e[t].apply(null,i)},0):h.warn("`"+t+"` is an unknown task"):"function"==typeof t?n().setTimeout(function(){t(e)},0):h.warn("`"+t+"` is invalid.")},tD={loaded:p.now(),NAME:"mux-embed",VERSION:"4.28.1",API_VERSION:"2.1",PLAYER_TRACKED:!1,monitor:function(e,t){return function(e,t,i){var r=e1(l(t),3),n=r[0],a=r[1],s=r[2],o=e.log,u=e.utils.getComputedStyle,c=e.utils.secondsToMs;if(!n)return o.error("No element was found with the `"+a+"` query selector.");if("video"!==s&&"audio"!==s)return o.error("The element of `"+a+"` was not a media element.");n.mux&&(n.mux.destroy(),delete n.mux,o.warn("Already monitoring this video element, replacing existing event listeners")),(i=Object.assign({automaticErrorTracking:!0},i)).data=Object.assign({player_software:"HTML5 Video Element",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:e.VERSION},i.data),i.getPlayheadTime=function(){return c(n.currentTime)},i.getStateData=function(){var e,t,r=this.hlsjs&&this.hlsjs.url,a=this.dashjs&&e0("function"===this.dashjs.getSource)&&this.dashjs.getSource(),s={player_is_paused:n.paused,player_playhead_time:c(n.currentTime),player_width:parseInt(u(n,"width")),player_height:parseInt(u(n,"height")),player_autoplay_on:n.autoplay,player_preload_on:n.preload,player_language_code:n.lang,player_is_fullscreen:eQ()&&!!(eQ().fullscreenElement||eQ().webkitFullscreenElement||eQ().mozFullScreenElement||eQ().msFullscreenElement),video_poster_url:n.poster,video_source_url:r||a||n.currentSrc,video_source_duration:c(n.duration),video_source_height:n.videoHeight,video_source_width:n.videoWidth,view_dropped_frame_count:null===(e=n)||void 0===e||null===(t=e.getVideoPlaybackQuality)||void 0===t?void 0:t.call(e).droppedVideoFrames},o=i.getPlayheadTime();if(n.getStartDate&&o>0){var l=n.getStartDate();if(l&&"function"==typeof l.getTime&&l.getTime()){var d=l.getTime();if(s.player_program_time=d+o,n.seekable.length>0){var h=d+n.seekable.end(n.seekable.length-1);s.player_live_edge_program_time=h}}}return s},n.mux=n.mux||{},n.mux.deleted=!1,n.mux.emit=function(t,i){e.emit(a,t,i)};var d=function(){o.error("The monitor for this video element has already been destroyed.")};n.mux.destroy=function(){Object.keys(n.mux.listeners).forEach(function(e){n.removeEventListener(e,n.mux.listeners[e],!1)}),delete n.mux.listeners,n.mux.destroy=d,n.mux.swapElement=d,n.mux.emit=d,n.mux.addHLSJS=d,n.mux.addDashJS=d,n.mux.removeHLSJS=d,n.mux.removeDashJS=d,n.mux.deleted=!0,e.emit(a,"destroy")},n.mux.swapElement=function(t){var i=e1(l(t),3),r=i[0],a=i[1],s=i[2];return r?"video"!==s&&"audio"!==s?e.log.error("The element of `"+a+"` was not a media element."):(r.muxId=n.muxId,delete n.muxId,r.mux=r.mux||{},r.mux.listeners=Object.assign({},n.mux.listeners),delete n.mux.listeners,Object.keys(r.mux.listeners).forEach(function(e){n.removeEventListener(e,r.mux.listeners[e],!1),r.addEventListener(e,r.mux.listeners[e],!1)}),r.mux.swapElement=n.mux.swapElement,r.mux.destroy=n.mux.destroy,delete n.mux,void(n=r)):e.log.error("No element was found with the `"+a+"` query selector.")},n.mux.addHLSJS=function(t){e.addHLSJS(a,t)},n.mux.addDashJS=function(t){e.addDashJS(a,t)},n.mux.removeHLSJS=function(){e.removeHLSJS(a)},n.mux.removeDashJS=function(){e.removeDashJS(a)},e.init(a,i),e.emit(a,"playerready"),n.paused||(e.emit(a,"play"),n.readyState>2&&e.emit(a,"playing")),n.mux.listeners={},ty.forEach(function(t){("error"!==t||i.automaticErrorTracking)&&(n.mux.listeners[t]=function(){var i={};if("error"===t){if(!n.error||1===n.error.code)return;i.player_error_code=n.error.code,i.player_error_message=tb[n.error.code]||n.error.message}e.emit(a,t,i)},n.addEventListener(t,n.mux.listeners[t],!1))})}(tk,e,t)},destroyMonitor:function(e){var t,i=(function(e){if(Array.isArray(e))return e}(t=l(e))||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,n,a=[],s=!0,o=!1;try{for(i=i.call(e);!(s=(r=i.next()).done)&&(a.push(r.value),!t||a.length!==t);s=!0);}catch(e){o=!0,n=e}finally{try{s||null==i.return||i.return()}finally{if(o)throw n}}return a}}(t,1)||function(e,t){if(e){if("string"==typeof e)return tI(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Object"===i&&e.constructor&&(i=e.constructor.name),"Map"===i||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?tI(e,t):void 0}}(t,1)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0];i&&i.mux&&"function"==typeof i.mux.destroy?i.mux.destroy():h.error("A video element monitor for `"+e+"` has not been initialized via `mux.monitor`.")},addHLSJS:function(e,t){var i=o(e);tL[i]?tL[i].addHLSJS(t):h.error("A monitor for `"+i+"` has not been initialized.")},addDashJS:function(e,t){var i=o(e);tL[i]?tL[i].addDashJS(t):h.error("A monitor for `"+i+"` has not been initialized.")},removeHLSJS:function(e){var t=o(e);tL[t]?tL[t].removeHLSJS():h.error("A monitor for `"+t+"` has not been initialized.")},removeDashJS:function(e){var t=o(e);tL[t]?tL[t].removeDashJS():h.error("A monitor for `"+t+"` has not been initialized.")},init:function(e,t){f()&&t&&t.respectDoNotTrack&&h.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var i=o(e);tL[i]=new eZ(tk,i,t)},emit:function(e,t,i){var r=o(e);tL[r]?(tL[r].emit(t,i),"destroy"===t&&delete tL[r]):h.error("A monitor for `"+r+"` has not been initialized.")},checkDoNotTrack:f,log:h,utils:tC,events:{PLAYER_READY:"playerready",VIEW_INIT:"viewinit",VIDEO_CHANGE:"videochange",PLAY:"play",PAUSE:"pause",PLAYING:"playing",TIME_UPDATE:"timeupdate",SEEKING:"seeking",SEEKED:"seeked",REBUFFER_START:"rebufferstart",REBUFFER_END:"rebufferend",ERROR:"error",ENDED:"ended",RENDITION_CHANGE:"renditionchange",ORIENTATION_CHANGE:"orientationchange",AD_REQUEST:"adrequest",AD_RESPONSE:"adresponse",AD_BREAK_START:"adbreakstart",AD_PLAY:"adplay",AD_PLAYING:"adplaying",AD_PAUSE:"adpause",AD_FIRST_QUARTILE:"adfirstquartile",AD_MID_POINT:"admidpoint",AD_THIRD_QUARTILE:"adthirdquartile",AD_ENDED:"adended",AD_BREAK_END:"adbreakend",AD_ERROR:"aderror",REQUEST_COMPLETED:"requestcompleted",REQUEST_FAILED:"requestfailed",REQUEST_CANCELLED:"requestcanceled"},WINDOW_HIDDEN:!1,WINDOW_UNLOADING:!1};Object.assign(tk,tD),void 0!==n()&&"function"==typeof n().addEventListener&&n().addEventListener("pagehide",function(e){e.persisted||(tk.WINDOW_UNLOADING=!0)},!1);var tP=tk},655:function(e,t,i){var r,n;function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e);/*!
 * JavaScript Cookie v2.1.3
 * https://github.com/js-cookie/js-cookie
 *
 * Copyright 2006, 2015 Klaus Hartl & Fagner Brack
 * Released under the MIT license
 */}!function(s){var o=!1;if(void 0===(n="function"==typeof(r=s)?r.call(t,i,t,e):r)||(e.exports=n),o=!0,"object"===a(t)&&(e.exports=s(),o=!0),!o){var l=window.Cookies,u=window.Cookies=s();u.noConflict=function(){return window.Cookies=l,u}}}(function(){var e=function(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var r in i)t[r]=i[r]}return t};return function t(i){function r(t,n,a){var s;if("undefined"!=typeof document){if(arguments.length>1){if("number"==typeof(a=e({path:"/"},r.defaults,a)).expires){var o=new Date;o.setMilliseconds(o.getMilliseconds()+864e5*a.expires),a.expires=o}try{s=JSON.stringify(n),/^[\{\[]/.test(s)&&(n=s)}catch(e){}return n=i.write?i.write(n,t):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=(t=(t=encodeURIComponent(String(t))).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent)).replace(/[\(\)]/g,escape),document.cookie=[t,"=",n,a.expires?"; expires="+a.expires.toUTCString():"",a.path?"; path="+a.path:"",a.domain?"; domain="+a.domain:"",a.secure?"; secure":""].join("")}t||(s={});for(var l=document.cookie?document.cookie.split("; "):[],u=/(%[0-9A-Z]{2})+/g,c=0;c<l.length;c++){var d=l[c].split("="),h=d.slice(1).join("=");'"'===h.charAt(0)&&(h=h.slice(1,-1));try{var f=d[0].replace(u,decodeURIComponent);if(h=i.read?i.read(h,f):i(h,f)||h.replace(u,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(e){}if(t===f){s=h;break}t||(s[f]=h)}catch(e){}}return s}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,i){r(t,"",e(i,{expires:-1}))},r.withConverter=t,r}(function(){})})},153:function(e,t,i){var r,n=void 0!==i.g?i.g:"undefined"!=typeof window?window:{},a=i(558);"undefined"!=typeof document?r=document:(r=n["__GLOBAL_DOCUMENT_CACHE@4"])||(r=n["__GLOBAL_DOCUMENT_CACHE@4"]=a),e.exports=r},48:function(e,t,i){var r;r="undefined"!=typeof window?window:void 0!==i.g?i.g:"undefined"!=typeof self?self:{},e.exports=r},640:function(e,t,i){var r,n;void 0===(n="function"==typeof(r=function(){var e=function(){},t="undefined",i=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function n(e,t){var i=e[t];if("function"==typeof i.bind)return i.bind(e);try{return Function.prototype.bind.call(i,e)}catch(t){return function(){return Function.prototype.apply.apply(i,[e,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function s(t,i){for(var n=0;n<r.length;n++){var a=r[n];this[a]=n<t?e:this.methodFactory(a,t,i)}this.log=this.debug}function o(e,i,r){return function(){typeof console!==t&&(s.call(this,i,r),this[e].apply(this,arguments))}}function l(r,s,l){var u;return"debug"===(u=r)&&(u="log"),typeof console!==t&&("trace"===u&&i?a:void 0!==console[u]?n(console,u):void 0!==console.log?n(console,"log"):e)||o.apply(this,arguments)}function u(e,i,n){var a,o=this;i=null==i?"WARN":i;var u="loglevel";function c(){var e;if(typeof window!==t&&u){try{e=window.localStorage[u]}catch(e){}if(typeof e===t)try{var i=window.document.cookie,r=i.indexOf(encodeURIComponent(u)+"=");-1!==r&&(e=/^([^;]+)/.exec(i.slice(r))[1])}catch(e){}return void 0===o.levels[e]&&(e=void 0),e}}"string"==typeof e?u+=":"+e:"symbol"==typeof e&&(u=void 0),o.name=e,o.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},o.methodFactory=n||l,o.getLevel=function(){return a},o.setLevel=function(i,n){if("string"==typeof i&&void 0!==o.levels[i.toUpperCase()]&&(i=o.levels[i.toUpperCase()]),!("number"==typeof i&&i>=0&&i<=o.levels.SILENT))throw"log.setLevel() called with invalid level: "+i;if(a=i,!1!==n&&function(e){var i=(r[e]||"silent").toUpperCase();if(typeof window!==t&&u){try{return void(window.localStorage[u]=i)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"="+i+";"}catch(e){}}}(i),s.call(o,i,e),typeof console===t&&i<o.levels.SILENT)return"No console available for logging"},o.setDefaultLevel=function(e){i=e,c()||o.setLevel(e,!1)},o.resetLevel=function(){o.setLevel(i,!1),function(){if(typeof window!==t&&u){try{return void window.localStorage.removeItem(u)}catch(e){}try{window.document.cookie=encodeURIComponent(u)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}()},o.enableAll=function(e){o.setLevel(o.levels.TRACE,e)},o.disableAll=function(e){o.setLevel(o.levels.SILENT,e)};var d=c();null==d&&(d=i),o.setLevel(d,!1)}var c=new u,d={};c.getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw TypeError("You must supply a name when creating a logger.");var t=d[e];return t||(t=d[e]=new u(e,c.getLevel(),c.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return c.noConflict=function(){return typeof window!==t&&window.log===c&&(window.log=h),c},c.getLoggers=function(){return d},c.default=c,c})?r.call(t,i,t,e):r)||(e.exports=n)},375:function(e,t){"use strict";var i=Object.prototype.hasOwnProperty;function r(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(e){return null}}function n(e){try{return encodeURIComponent(e)}catch(e){return null}}t.stringify=function(e,t){var r,a,s=[];for(a in"string"!=typeof(t=t||"")&&(t="?"),e)if(i.call(e,a)){if((r=e[a])||null!=r&&!isNaN(r)||(r=""),a=n(a),r=n(r),null===a||null===r)continue;s.push(a+"="+r)}return s.length?t+s.join("&"):""},t.parse=function(e){for(var t,i=/([^=?#&]+)=?([^&]*)/g,n={};t=i.exec(e);){var a=r(t[1]),s=r(t[2]);null===a||null===s||a in n||(n[a]=s)}return n}},558:function(){}},t={};function i(r){var n=t[r];if(void 0!==n)return n.exports;var a=t[r]={exports:{}};return e[r].call(a.exports,a,a.exports,i),a.exports}return i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},i.d=function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i(80)}()},6079:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return i(26053)}])},29480:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"createAsyncLocalStorage",{enumerable:!0,get:function(){return a}});let i=Error("Invariant: AsyncLocalStorage accessed in runtime where it is not available");class r{disable(){throw i}getStore(){}run(){throw i}exit(){throw i}enterWith(){throw i}}let n=globalThis.AsyncLocalStorage;function a(){return n?new n:new r}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},44570:function(e,t,i){"use strict";function r(e){}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"clientHookInServerComponentError",{enumerable:!0,get:function(){return r}}),i(8266),i(50959),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},72687:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{ReadonlyURLSearchParams:function(){return f},useSearchParams:function(){return p},usePathname:function(){return m},ServerInsertedHTMLContext:function(){return l.ServerInsertedHTMLContext},useServerInsertedHTML:function(){return l.useServerInsertedHTML},useRouter:function(){return g},useParams:function(){return v},useSelectedLayoutSegments:function(){return y},useSelectedLayoutSegment:function(){return b},redirect:function(){return u.redirect},notFound:function(){return c.notFound}});let r=i(50959),n=i(20925),a=i(68516),s=i(44570),o=i(86813),l=i(6789),u=i(93081),c=i(37986),d=Symbol("internal for urlsearchparams readonly");function h(){return Error("ReadonlyURLSearchParams cannot be modified")}class f{[Symbol.iterator](){return this[d][Symbol.iterator]()}append(){throw h()}delete(){throw h()}set(){throw h()}sort(){throw h()}constructor(e){this[d]=e,this.entries=e.entries.bind(e),this.forEach=e.forEach.bind(e),this.get=e.get.bind(e),this.getAll=e.getAll.bind(e),this.has=e.has.bind(e),this.keys=e.keys.bind(e),this.values=e.values.bind(e),this.toString=e.toString.bind(e)}}function p(){(0,s.clientHookInServerComponentError)("useSearchParams");let e=(0,r.useContext)(a.SearchParamsContext),t=(0,r.useMemo)(()=>e?new f(e):null,[e]);return t}function m(){return(0,s.clientHookInServerComponentError)("usePathname"),(0,r.useContext)(a.PathnameContext)}function g(){(0,s.clientHookInServerComponentError)("useRouter");let e=(0,r.useContext)(n.AppRouterContext);if(null===e)throw Error("invariant expected app router to be mounted");return e}function v(){(0,s.clientHookInServerComponentError)("useParams");let e=(0,r.useContext)(n.GlobalLayoutRouterContext);return e?function e(t,i){void 0===i&&(i={});let r=t[1];for(let t of Object.values(r)){let r=t[0],n=Array.isArray(r),a=n?r[1]:r;if(!a||a.startsWith("__PAGE__"))continue;let s=n&&("c"===r[2]||"oc"===r[2]);s?i[r[0]]=r[1].split("/"):n&&(i[r[0]]=r[1]),i=e(t,i)}return i}(e.tree):null}function y(e){void 0===e&&(e="children"),(0,s.clientHookInServerComponentError)("useSelectedLayoutSegments");let{tree:t}=(0,r.useContext)(n.LayoutRouterContext);return function e(t,i,r,n){let a;if(void 0===r&&(r=!0),void 0===n&&(n=[]),r)a=t[1][i];else{var s;let e=t[1];a=null!=(s=e.children)?s:Object.values(e)[0]}if(!a)return n;let l=a[0],u=(0,o.getSegmentValue)(l);return!u||u.startsWith("__PAGE__")?n:(n.push(u),e(a,i,!1,n))}(t,e)}function b(e){void 0===e&&(e="children"),(0,s.clientHookInServerComponentError)("useSelectedLayoutSegment");let t=y(e);return 0===t.length?null:t[0]}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},37986:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{notFound:function(){return r},isNotFoundError:function(){return n}});let i="NEXT_NOT_FOUND";function r(){let e=Error(i);throw e.digest=i,e}function n(e){return(null==e?void 0:e.digest)===i}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},93081:function(e,t,i){"use strict";var r,n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{RedirectType:function(){return r},getRedirectError:function(){return o},redirect:function(){return l},isRedirectError:function(){return u},getURLFromRedirectError:function(){return c},getRedirectTypeFromError:function(){return d}});let a=i(89833),s="NEXT_REDIRECT";function o(e,t){let i=Error(s);i.digest=s+";"+t+";"+e;let r=a.requestAsyncStorage.getStore();return r&&(i.mutableCookies=r.mutableCookies),i}function l(e,t){throw void 0===t&&(t="replace"),o(e,t)}function u(e){if("string"!=typeof(null==e?void 0:e.digest))return!1;let[t,i,r]=e.digest.split(";",3);return t===s&&("replace"===i||"push"===i)&&"string"==typeof r}function c(e){return u(e)?e.digest.split(";",3)[2]:null}function d(e){if(!u(e))throw Error("Not a redirect error");return e.digest.split(";",3)[1]}(n=r||(r={})).push="push",n.replace="replace",("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},89833:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"requestAsyncStorage",{enumerable:!0,get:function(){return n}});let r=i(29480),n=(0,r.createAsyncLocalStorage)();("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},86813:function(e,t){"use strict";function i(e){return Array.isArray(e)?e[1]:e}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getSegmentValue",{enumerable:!0,get:function(){return i}}),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},23242:function(e,t){"use strict";var i,r;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{PrefetchKind:function(){return i},ACTION_REFRESH:function(){return n},ACTION_NAVIGATE:function(){return a},ACTION_RESTORE:function(){return s},ACTION_SERVER_PATCH:function(){return o},ACTION_PREFETCH:function(){return l},ACTION_FAST_REFRESH:function(){return u},ACTION_SERVER_ACTION:function(){return c}});let n="refresh",a="navigate",s="restore",o="server-patch",l="prefetch",u="fast-refresh",c="server-action";(r=i||(i={})).AUTO="auto",r.FULL="full",r.TEMPORARY="temporary",("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},86016:function(e,t,i){"use strict";function r(e,t,i,r){return!1}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getDomainLocale",{enumerable:!0,get:function(){return r}}),i(90535),("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},47531:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Image",{enumerable:!0,get:function(){return y}});let r=i(8266),n=i(97144),a=n._(i(50959)),s=i(10422),o=r._(i(39055)),l=i(97530),u=i(16769),c=i(51907);i(35012);let d=i(1175),h=r._(i(62933)),f={deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1};function p(e,t,i,r,n,a){let s=null==e?void 0:e.src;if(!e||e["data-loaded-src"]===s)return;e["data-loaded-src"]=s;let o="decode"in e?e.decode():Promise.resolve();o.catch(()=>{}).then(()=>{if(e.parentElement&&e.isConnected){if("blur"===t&&n(!0),null==i?void 0:i.current){let t=new Event("load");Object.defineProperty(t,"target",{writable:!1,value:e});let r=!1,n=!1;i.current({...t,nativeEvent:t,currentTarget:e,target:e,isDefaultPrevented:()=>r,isPropagationStopped:()=>n,persist:()=>{},preventDefault:()=>{r=!0,t.preventDefault()},stopPropagation:()=>{n=!0,t.stopPropagation()}})}(null==r?void 0:r.current)&&r.current(e)}})}function m(e){let[t,i]=a.version.split("."),r=parseInt(t,10),n=parseInt(i,10);return r>18||18===r&&n>=3?{fetchPriority:e}:{fetchpriority:e}}let g=(0,a.forwardRef)((e,t)=>{let{src:i,srcSet:r,sizes:n,height:s,width:o,decoding:l,className:u,style:c,fetchPriority:d,placeholder:h,loading:f,unoptimized:g,fill:v,onLoadRef:y,onLoadingCompleteRef:b,setBlurComplete:_,setShowAltText:E,onLoad:S,onError:x,...T}=e;return a.default.createElement("img",{...T,...m(d),loading:f,width:o,height:s,decoding:l,"data-nimg":v?"fill":"1",className:u,style:c,sizes:n,srcSet:r,src:i,ref:(0,a.useCallback)(e=>{t&&("function"==typeof t?t(e):"object"==typeof t&&(t.current=e)),e&&(x&&(e.src=e.src),e.complete&&p(e,h,y,b,_,g))},[i,h,y,b,_,x,g,t]),onLoad:e=>{let t=e.currentTarget;p(t,h,y,b,_,g)},onError:e=>{E(!0),"blur"===h&&_(!0),x&&x(e)}})});function v(e){let{isAppRouter:t,imgAttributes:i}=e,r={as:"image",imageSrcSet:i.srcSet,imageSizes:i.sizes,crossOrigin:i.crossOrigin,referrerPolicy:i.referrerPolicy,...m(i.fetchPriority)};return t?((0,s.preload)(i.src,r),null):a.default.createElement(o.default,null,a.default.createElement("link",{key:"__nimg-"+i.src+i.srcSet+i.sizes,rel:"preload",href:i.srcSet?void 0:i.src,...r}))}let y=(0,a.forwardRef)((e,t)=>{let i=(0,a.useContext)(d.RouterContext),r=(0,a.useContext)(c.ImageConfigContext),n=(0,a.useMemo)(()=>{let e=f||r||u.imageConfigDefault,t=[...e.deviceSizes,...e.imageSizes].sort((e,t)=>e-t),i=e.deviceSizes.sort((e,t)=>e-t);return{...e,allSizes:t,deviceSizes:i}},[r]),{onLoad:s,onLoadingComplete:o}=e,p=(0,a.useRef)(s);(0,a.useEffect)(()=>{p.current=s},[s]);let m=(0,a.useRef)(o);(0,a.useEffect)(()=>{m.current=o},[o]);let[y,b]=(0,a.useState)(!1),[_,E]=(0,a.useState)(!1),{props:S,meta:x}=(0,l.getImgProps)(e,{defaultLoader:h.default,imgConf:n,blurComplete:y,showAltText:_});return a.default.createElement(a.default.Fragment,null,a.default.createElement(g,{...S,unoptimized:x.unoptimized,placeholder:x.placeholder,fill:x.fill,onLoadRef:p,onLoadingCompleteRef:m,setBlurComplete:b,setShowAltText:E,ref:t}),x.priority?a.default.createElement(v,{isAppRouter:!i,imgAttributes:S}):null)});("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},99772:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return _}});let r=i(8266),n=r._(i(50959)),a=i(52987),s=i(11309),o=i(39654),l=i(39249),u=i(28e3),c=i(1175),d=i(20925),h=i(59814),f=i(86016),p=i(5731),m=i(23242),g=new Set;function v(e,t,i,r,n,a){if(!a&&!(0,s.isLocalURL)(t))return;if(!r.bypassPrefetchedCheck){let n=void 0!==r.locale?r.locale:"locale"in e?e.locale:void 0,a=t+"%"+i+"%"+n;if(g.has(a))return;g.add(a)}let o=a?e.prefetch(t,n):e.prefetch(t,i,r);Promise.resolve(o).catch(e=>{})}function y(e){return"string"==typeof e?e:(0,o.formatUrl)(e)}let b=n.default.forwardRef(function(e,t){let i,r;let{href:o,as:g,children:b,prefetch:_=null,passHref:E,replace:S,shallow:x,scroll:T,locale:w,onClick:A,onMouseEnter:M,onTouchStart:R,legacyBehavior:C=!1,...I}=e;i=b,C&&("string"==typeof i||"number"==typeof i)&&(i=n.default.createElement("a",null,i));let L=n.default.useContext(c.RouterContext),k=n.default.useContext(d.AppRouterContext),D=null!=L?L:k,P=!L,O=!1!==_,N=null===_?m.PrefetchKind.AUTO:m.PrefetchKind.FULL,{href:U,as:F}=n.default.useMemo(()=>{if(!L){let e=y(o);return{href:e,as:g?y(g):e}}let[e,t]=(0,a.resolveHref)(L,o,!0);return{href:e,as:g?(0,a.resolveHref)(L,g):t||e}},[L,o,g]),B=n.default.useRef(U),V=n.default.useRef(F);C&&(r=n.default.Children.only(i));let z=C?r&&"object"==typeof r&&r.ref:t,[j,H,G]=(0,h.useIntersection)({rootMargin:"200px"}),W=n.default.useCallback(e=>{(V.current!==F||B.current!==U)&&(G(),V.current=F,B.current=U),j(e),z&&("function"==typeof z?z(e):"object"==typeof z&&(z.current=e))},[F,z,U,G,j]);n.default.useEffect(()=>{D&&H&&O&&v(D,U,F,{locale:w},{kind:N},P)},[F,U,H,w,O,null==L?void 0:L.locale,D,P,N]);let $={ref:W,onClick(e){C||"function"!=typeof A||A(e),C&&r.props&&"function"==typeof r.props.onClick&&r.props.onClick(e),D&&!e.defaultPrevented&&function(e,t,i,r,a,o,l,u,c,d){let{nodeName:h}=e.currentTarget,f="A"===h.toUpperCase();if(f&&(function(e){let t=e.currentTarget,i=t.getAttribute("target");return i&&"_self"!==i||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||!c&&!(0,s.isLocalURL)(i)))return;e.preventDefault();let p=()=>{let e=null==l||l;"beforePopState"in t?t[a?"replace":"push"](i,r,{shallow:o,locale:u,scroll:e}):t[a?"replace":"push"](r||i,{forceOptimisticNavigation:!d,scroll:e})};c?n.default.startTransition(p):p()}(e,D,U,F,S,x,T,w,P,O)},onMouseEnter(e){C||"function"!=typeof M||M(e),C&&r.props&&"function"==typeof r.props.onMouseEnter&&r.props.onMouseEnter(e),D&&(O||!P)&&v(D,U,F,{locale:w,priority:!0,bypassPrefetchedCheck:!0},{kind:N},P)},onTouchStart(e){C||"function"!=typeof R||R(e),C&&r.props&&"function"==typeof r.props.onTouchStart&&r.props.onTouchStart(e),D&&(O||!P)&&v(D,U,F,{locale:w,priority:!0,bypassPrefetchedCheck:!0},{kind:N},P)}};if((0,l.isAbsoluteUrl)(F))$.href=F;else if(!C||E||"a"===r.type&&!("href"in r.props)){let e=void 0!==w?w:null==L?void 0:L.locale,t=(null==L?void 0:L.isLocaleDomain)&&(0,f.getDomainLocale)(F,e,null==L?void 0:L.locales,null==L?void 0:L.domainLocales);$.href=t||(0,p.addBasePath)((0,u.addLocale)(F,e,null==L?void 0:L.defaultLocale))}return C?n.default.cloneElement(r,$):n.default.createElement("a",{...I,...$},i)}),_=b;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},59814:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return l}});let r=i(50959),n=i(44560),a="function"==typeof IntersectionObserver,s=new Map,o=[];function l(e){let{rootRef:t,rootMargin:i,disabled:l}=e,u=l||!a,[c,d]=(0,r.useState)(!1),h=(0,r.useRef)(null),f=(0,r.useCallback)(e=>{h.current=e},[]);(0,r.useEffect)(()=>{if(a){if(u||c)return;let e=h.current;if(e&&e.tagName){let r=function(e,t,i){let{id:r,observer:n,elements:a}=function(e){let t;let i={root:e.root||null,margin:e.rootMargin||""},r=o.find(e=>e.root===i.root&&e.margin===i.margin);if(r&&(t=s.get(r)))return t;let n=new Map,a=new IntersectionObserver(e=>{e.forEach(e=>{let t=n.get(e.target),i=e.isIntersecting||e.intersectionRatio>0;t&&i&&t(i)})},e);return t={id:i,observer:a,elements:n},o.push(i),s.set(i,t),t}(i);return a.set(e,t),n.observe(e),function(){if(a.delete(e),n.unobserve(e),0===a.size){n.disconnect(),s.delete(r);let e=o.findIndex(e=>e.root===r.root&&e.margin===r.margin);e>-1&&o.splice(e,1)}}}(e,e=>e&&d(e),{root:null==t?void 0:t.current,rootMargin:i});return r}}else if(!c){let e=(0,n.requestIdleCallback)(()=>d(!0));return()=>(0,n.cancelIdleCallback)(e)}},[u,i,t,c,h.current]);let p=(0,r.useCallback)(()=>{d(!1)},[]);return[f,c,p]}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},32170:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{noSSR:function(){return s},default:function(){return o}});let r=i(8266),n=(i(50959),r._(i(54057)));function a(e){return{default:(null==e?void 0:e.default)||e}}function s(e,t){return delete t.webpack,delete t.modules,e(t)}function o(e,t){let i=n.default,r={loading:e=>{let{error:t,isLoading:i,pastDelay:r}=e;return null}};e instanceof Promise?r.loader=()=>e:"function"==typeof e?r.loader=e:"object"==typeof e&&(r={...r,...e}),r={...r,...t};let o=r.loader;return(r.loadableGenerated&&(r={...r,...r.loadableGenerated},delete r.loadableGenerated),"boolean"!=typeof r.ssr||r.ssr)?i({...r,loader:()=>null!=o?o().then(a):Promise.resolve(a(()=>null))}):(delete r.webpack,delete r.modules,s(i,r))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},97530:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImgProps",{enumerable:!0,get:function(){return o}}),i(35012);let r=i(36657),n=i(16769);function a(e){return void 0!==e.default}function s(e){return void 0===e?e:"number"==typeof e?Number.isFinite(e)?e:NaN:"string"==typeof e&&/^[0-9]+$/.test(e)?parseInt(e,10):NaN}function o(e,t){var i;let o,l,u,{src:c,sizes:d,unoptimized:h=!1,priority:f=!1,loading:p,className:m,quality:g,width:v,height:y,fill:b=!1,style:_,onLoad:E,onLoadingComplete:S,placeholder:x="empty",blurDataURL:T,fetchPriority:w,layout:A,objectFit:M,objectPosition:R,lazyBoundary:C,lazyRoot:I,...L}=e,{imgConf:k,showAltText:D,blurComplete:P,defaultLoader:O}=t,N=k||n.imageConfigDefault;if("allSizes"in N)o=N;else{let e=[...N.deviceSizes,...N.imageSizes].sort((e,t)=>e-t),t=N.deviceSizes.sort((e,t)=>e-t);o={...N,allSizes:e,deviceSizes:t}}let U=L.loader||O;delete L.loader,delete L.srcSet;let F="__next_img_default"in U;if(F){if("custom"===o.loader)throw Error('Image with src "'+c+'" is missing "loader" prop.\nRead more: https://nextjs.org/docs/messages/next-image-missing-loader')}else{let e=U;U=t=>{let{config:i,...r}=t;return e(r)}}if(A){"fill"===A&&(b=!0);let e={intrinsic:{maxWidth:"100%",height:"auto"},responsive:{width:"100%",height:"auto"}}[A];e&&(_={..._,...e});let t={responsive:"100vw",fill:"100vw"}[A];t&&!d&&(d=t)}let B="",V=s(v),z=s(y);if("object"==typeof(i=c)&&(a(i)||void 0!==i.src)){let e=a(c)?c.default:c;if(!e.src)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include src. Received "+JSON.stringify(e));if(!e.height||!e.width)throw Error("An object should only be passed to the image component src parameter if it comes from a static image import. It must include height and width. Received "+JSON.stringify(e));if(l=e.blurWidth,u=e.blurHeight,T=T||e.blurDataURL,B=e.src,!b){if(V||z){if(V&&!z){let t=V/e.width;z=Math.round(e.height*t)}else if(!V&&z){let t=z/e.height;V=Math.round(e.width*t)}}else V=e.width,z=e.height}}let j=!f&&("lazy"===p||void 0===p);(!(c="string"==typeof c?c:B)||c.startsWith("data:")||c.startsWith("blob:"))&&(h=!0,j=!1),o.unoptimized&&(h=!0),F&&c.endsWith(".svg")&&!o.dangerouslyAllowSVG&&(h=!0),f&&(w="high");let H=s(g),G=Object.assign(b?{position:"absolute",height:"100%",width:"100%",left:0,top:0,right:0,bottom:0,objectFit:M,objectPosition:R}:{},D?{}:{color:"transparent"},_),W="blur"===x&&T&&!P?{backgroundSize:G.objectFit||"cover",backgroundPosition:G.objectPosition||"50% 50%",backgroundRepeat:"no-repeat",backgroundImage:'url("data:image/svg+xml;charset=utf-8,'+(0,r.getImageBlurSvg)({widthInt:V,heightInt:z,blurWidth:l,blurHeight:u,blurDataURL:T,objectFit:G.objectFit})+'")'}:{},$=function(e){let{config:t,src:i,unoptimized:r,width:n,quality:a,sizes:s,loader:o}=e;if(r)return{src:i,srcSet:void 0,sizes:void 0};let{widths:l,kind:u}=function(e,t,i){let{deviceSizes:r,allSizes:n}=e;if(i){let e=/(^|\s)(1?\d?\d)vw/g,t=[];for(let r;r=e.exec(i);r)t.push(parseInt(r[2]));if(t.length){let e=.01*Math.min(...t);return{widths:n.filter(t=>t>=r[0]*e),kind:"w"}}return{widths:n,kind:"w"}}if("number"!=typeof t)return{widths:r,kind:"w"};let a=[...new Set([t,2*t].map(e=>n.find(t=>t>=e)||n[n.length-1]))];return{widths:a,kind:"x"}}(t,n,s),c=l.length-1;return{sizes:s||"w"!==u?s:"100vw",srcSet:l.map((e,r)=>o({config:t,src:i,quality:a,width:e})+" "+("w"===u?e:r+1)+u).join(", "),src:o({config:t,src:i,quality:a,width:l[c]})}}({config:o,src:c,unoptimized:h,width:V,quality:H,sizes:d,loader:U}),q={...L,loading:j?"lazy":p,fetchPriority:w,width:V,height:z,decoding:"async",className:m,style:{...G,...W},sizes:$.sizes,srcSet:$.srcSet,src:$.src},Y={unoptimized:h,priority:f,placeholder:x,fill:b};return{props:q,meta:Y}}},36657:function(e,t){"use strict";function i(e){let{widthInt:t,heightInt:i,blurWidth:r,blurHeight:n,blurDataURL:a,objectFit:s}=e,o=r||t,l=n||i,u=a.startsWith("data:image/jpeg")?"%3CfeComponentTransfer%3E%3CfeFuncA type='discrete' tableValues='1 1'/%3E%3C/feComponentTransfer%3E%":"";return o&&l?"%3Csvg xmlns='http%3A//www.w3.org/2000/svg' viewBox='0 0 "+o+" "+l+"'%3E%3Cfilter id='b' color-interpolation-filters='sRGB'%3E%3CfeGaussianBlur stdDeviation='"+(r&&n?"1":"20")+"'/%3E"+u+"%3C/filter%3E%3Cimage preserveAspectRatio='none' filter='url(%23b)' x='0' y='0' height='100%25' width='100%25' href='"+a+"'/%3E%3C/svg%3E":"%3Csvg xmlns='http%3A//www.w3.org/2000/svg'%3E%3Cimage style='filter:blur(20px)' preserveAspectRatio='"+("contain"===s?"xMidYMid":"cover"===s?"xMidYMid slice":"none")+"' x='0' y='0' height='100%25' width='100%25' href='"+a+"'/%3E%3C/svg%3E"}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getImageBlurSvg",{enumerable:!0,get:function(){return i}})},1348:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{default:function(){return u},unstable_getImgProps:function(){return l}});let r=i(8266),n=i(97530),a=i(35012),s=i(47531),o=r._(i(62933)),l=e=>{(0,a.warnOnce)("Warning: unstable_getImgProps() is experimental and may change or be removed at any time. Use at your own risk.");let{props:t}=(0,n.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,i]of Object.entries(t))void 0===i&&delete t[e];return{props:t}},u=s.Image},62933:function(e,t){"use strict";function i(e){let{config:t,src:i,width:r,quality:n}=e;return t.path+"?url="+encodeURIComponent(i)+"&w="+r+"&q="+(n||75)}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r}}),i.__next_img_default=!0;let r=i},55473:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LoadableContext",{enumerable:!0,get:function(){return a}});let r=i(8266),n=r._(i(50959)),a=n.default.createContext(null)},54057:function(e,t,i){"use strict";/**
@copyright (c) 2017-present James Kyle <me@thejameskyle.com>
 MIT License
 Permission is hereby granted, free of charge, to any person obtaining
a copy of this software and associated documentation files (the
"Software"), to deal in the Software without restriction, including
without limitation the rights to use, copy, modify, merge, publish,
distribute, sublicense, and/or sell copies of the Software, and to
permit persons to whom the Software is furnished to do so, subject to
the following conditions:
 The above copyright notice and this permission notice shall be
included in all copies or substantial portions of the Software.
 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE
*/Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return f}});let r=i(8266),n=r._(i(50959)),a=i(55473),s=[],o=[],l=!1;function u(e){let t=e(),i={loading:!0,loaded:null,error:null};return i.promise=t.then(e=>(i.loading=!1,i.loaded=e,e)).catch(e=>{throw i.loading=!1,i.error=e,e}),i}class c{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function d(e){return function(e,t){let i=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t),r=null;function s(){if(!r){let t=new c(e,i);r={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return r.promise()}if(!l){let e=i.webpack?i.webpack():i.modules;e&&o.push(t=>{for(let i of e)if(t.includes(i))return s()})}function u(e,t){!function(){s();let e=n.default.useContext(a.LoadableContext);e&&Array.isArray(i.modules)&&i.modules.forEach(t=>{e(t)})}();let o=n.default.useSyncExternalStore(r.subscribe,r.getCurrentValue,r.getCurrentValue);return n.default.useImperativeHandle(t,()=>({retry:r.retry}),[]),n.default.useMemo(()=>{var t;return o.loading||o.error?n.default.createElement(i.loading,{isLoading:o.loading,pastDelay:o.pastDelay,timedOut:o.timedOut,error:o.error,retry:r.retry}):o.loaded?n.default.createElement((t=o.loaded)&&t.default?t.default:t,e):null},[e,o])}return u.preload=()=>s(),u.displayName="LoadableComponent",n.default.forwardRef(u)}(u,e)}function h(e,t){let i=[];for(;e.length;){let r=e.pop();i.push(r(t))}return Promise.all(i).then(()=>{if(e.length)return h(e,t)})}d.preloadAll=()=>new Promise((e,t)=>{h(s).then(e,t)}),d.preloadReady=e=>(void 0===e&&(e=[]),new Promise(t=>{let i=()=>(l=!0,t());h(o,e).then(i,i)})),window.__NEXT_PRELOADREADY=d.preloadReady;let f=d},6789:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var i in t)Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}(t,{ServerInsertedHTMLContext:function(){return a},useServerInsertedHTML:function(){return s}});let r=i(97144),n=r._(i(50959)),a=n.default.createContext(null);function s(e){let t=(0,n.useContext)(a);t&&t(e)}},52998:function(e,t,i){"use strict";var r=i(11527);i(50959);var n=i(21345),a=i.n(n),s=i(80202);let o={target:"_blank",rel:"noopener noreferrer"},l=e=>{let{ariaLabel:t,to:i,className:n,style:l,children:u,target:c,onClick:d,onMouseEnter:h,onMouseLeave:f,onMouseMove:p,preventScroll:m=!0,...g}=e,v=(0,s.useRouter)().pathname,y=/^\?/.test(i),b={className:n,style:l,target:c,"aria-label":t,onMouseEnter:h,onMouseLeave:f,onMouseMove:p},_={...b,onClick:d};return/^[.#]/.test(i)?(0,r.jsx)(a(),{href:i,scroll:!1,...b,onClick:e=>{let t=document.querySelector(i);t&&t.scrollIntoView({behavior:"smooth"}),d&&d(e)},children:u}):/^(\?|[./])/.test(i)?(0,r.jsx)(a(),{href:y?"".concat(v).concat(i):i,scroll:!m&&!y,..._,children:u}):/^https?:/.test(i)?(0,r.jsx)("a",{...g,..._,href:i,...o,target:c||o.target,children:u}):(0,r.jsx)("a",{...g,..._,href:i,children:u})};t.Z=e=>{let{to:t,...i}=e;return t?(0,r.jsx)(l,{...i,to:t}):(0,r.jsx)("button",{...i})}},74611:function(e,t,i){"use strict";i.d(t,{Z:function(){return r.Z}});var r=i(52998)},44758:function(e,t,i){"use strict";var r=i(11527),n=i(45924),a=i(78334),s=i.n(a);t.Z=e=>{let{as:t="div",className:i,children:a,...o}=e;return(0,r.jsx)(t,{...o,className:(0,n.Z)(s().container,i),children:a})}},42157:function(e,t,i){"use strict";i.d(t,{Z:function(){return r.Z}});var r=i(44758)},94727:function(e,t,i){"use strict";i.d(t,{s:function(){return u},X:function(){return o}});var r=i(11527);i(50959);var n=i(45924),a=i(39891),s=i.n(a);let o=e=>{let{className:t,as:i="div",...a}=e;return(0,r.jsx)(i,{className:(0,n.Z)(s().row,t),...a})},l=Number.isFinite,u=e=>{let{initial:t,medium:i,desktop:a,large:o,className:u,as:c="div",...d}=e;return(0,r.jsx)(c,{className:(0,n.Z)(s().col,[s()["col--".concat(t)]],!!l(i)&&[s()["col--medium--".concat(i)]],!!l(a)&&[s()["col--desktop--".concat(a)]],!!l(o)&&[s()["col--large--".concat(o)]],u),...d})}},49729:function(e,t,i){"use strict";var r=i(11527),n=i(75734),a=i.n(n),s=i(3372);t.Z=e=>{var t,i;let{forwardedRef:n,image:o,alt:l,height:u,width:c,fill:d,ratio:h,...f}=e,p=Number(u||(null==o?void 0:null===(t=o.dimensions)||void 0===t?void 0:t.height)),m=Number(c||(null==o?void 0:null===(i=o.dimensions)||void 0===i?void 0:i.width));return(0,r.jsx)(a(),{ref:n,src:(()=>{try{var e,t;if(!h)return(null===(e=(0,s.iQ)(o))||void 0===e?void 0:e.url())||"";return h>1&&(p=Number((m/h).toFixed(0))),h<1&&(m=Number((p*h).toFixed(0))),(null===(t=(0,s.iQ)(o))||void 0===t?void 0:t.width(m).height(p).url())||""}catch(e){return""}})(),height:p,width:m,alt:l,sizes:"100vw",...f})}},71678:function(e,t,i){"use strict";i.d(t,{Z:function(){return r.Z}});var r=i(49729)},58510:function(e,t,i){"use strict";i.d(t,{_:function(){return h},Z:function(){return d}});var r=i(11527),n=i(80202),a=i(45924),s=i(94727),o=i(8299),l=i(68303),u=i.n(l);let c=e=>{let{overlay:t=!1}=e;return(0,r.jsxs)("section",{children:[!t&&(0,r.jsxs)(o.Z,{tag:"#003",children:["Grid guide",(0,r.jsx)("br",{}),"4/8/12"]}),(0,r.jsxs)(s.X,{className:(0,a.Z)(u().row,t&&u().overlay),children:[(0,r.jsx)(s.s,{initial:1,className:u().col}),(0,r.jsx)(s.s,{initial:1,className:u().col}),(0,r.jsx)(s.s,{initial:1,className:u().col}),(0,r.jsx)(s.s,{initial:1,className:u().col}),(0,r.jsx)(s.s,{initial:0,medium:1,className:u().col}),(0,r.jsx)(s.s,{initial:0,medium:1,className:u().col}),(0,r.jsx)(s.s,{initial:0,medium:1,className:u().col}),(0,r.jsx)(s.s,{initial:0,medium:1,className:u().col}),(0,r.jsx)(s.s,{initial:0,desktop:1,className:u().col}),(0,r.jsx)(s.s,{initial:0,desktop:1,className:u().col}),(0,r.jsx)(s.s,{initial:0,desktop:1,className:u().col}),(0,r.jsx)(s.s,{initial:0,desktop:1,className:u().col})]})]})};var d=c;let h=()=>{let e=void 0!==(0,n.useRouter)().query.guide;return e&&(0,r.jsx)(c,{overlay:!0})}},8299:function(e,t,i){"use strict";i.d(t,{Z:function(){return o}});var r=i(11527),n=i(24061),a=i(70277),s=i.n(a),o=e=>{let{tag:t,children:i}=e;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.Iy,{as:"h2",className:s().helperTitle,"data-title":t,children:i})})}},56711:function(e,t,i){"use strict";i.d(t,{Z:function(){return nI}});var r=i(11527),n=i(45924),a=i(49729),s=i(50959),o=i(60644),l=i(86309),u=i(11861);i(68592);var c=i(12991);i(98373),i(18041);var d=i(85076),h=i(42409),f=i(45717),p=i(79057),m=i(80401),g=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},v=(e,t,i)=>(g(e,t,"read from private field"),i?i.call(e):t.get(e)),y=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},b=(e,t,i)=>(g(e,t,"access private method"),i);let _={RATES:"rates"};class E extends u.RE{constructor(){super(),y(this,ex),y(this,ew),y(this,eS,new m.D(this,_.RATES,{defaultValue:d.DC})),b(this,ex,eT).call(this)}static get observedAttributes(){return[...super.observedAttributes,"aria-multiselectable",h.MediaUIAttributes.MEDIA_PLAYBACK_RATE,_.RATES]}attributeChangedCallback(e,t,i){super.attributeChangedCallback(e,t,i),e===h.MediaUIAttributes.MEDIA_PLAYBACK_RATE&&t!=i?this.value=i:e===_.RATES&&t!=i&&(v(this,eS).value=i,b(this,ex,eT).call(this))}get rates(){return v(this,eS)}set rates(e){e?Array.isArray(e)&&(v(this,eS).value=e.join(" ")):v(this,eS).value="",b(this,ex,eT).call(this)}get mediaPlaybackRate(){return(0,p.Uf)(this,h.MediaUIAttributes.MEDIA_PLAYBACK_RATE,d._S)}set mediaPlaybackRate(e){(0,p.Jv)(this,h.MediaUIAttributes.MEDIA_PLAYBACK_RATE,e)}connectedCallback(){super.connectedCallback(),this.addEventListener("change",b(this,ew,eA))}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("change",b(this,ew,eA))}}eS=new WeakMap,ex=new WeakSet,eT=function(){let e=this.shadowRoot.querySelector("#container");for(let t of(e.textContent="",this.rates)){let i=(0,u.SX)(this.formatOptionText(`${t}x`,t),t,this.mediaPlaybackRate==t);i.prepend((0,u.sz)(this,"select-indicator")),e.append(i)}},ew=new WeakSet,eA=function(){if(!this.value)return;let e=new f.Mq.CustomEvent(h.MediaUIEvents.MEDIA_PLAYBACK_RATE_REQUEST,{composed:!0,bubbles:!0,detail:this.value});this.dispatchEvent(e)},f.Mq.customElements.get("media-playback-rate-listbox")||f.Mq.customElements.define("media-playback-rate-listbox",E);class S extends c._{init(){let e=f.tj.createElement("media-playback-rate-button");e.part.add("button"),e.preventClick=!0;let t=f.tj.createElement("media-playback-rate-listbox");t.part.add("listbox"),t.setAttribute("exportparts","option, option-selected, indicator");let i=this.shadowRoot.querySelector("slot[name=button]"),r=this.shadowRoot.querySelector("slot[name=listbox]");i.textContent="",r.textContent="",i.append(e),r.append(t)}}f.Mq.customElements.get("media-playback-rate-selectmenu")||f.Mq.customElements.define("media-playback-rate-selectmenu",S);var x=i(68995),T=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},w=(e,t,i)=>(T(e,t,"read from private field"),i?i.call(e):t.get(e)),A=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},M=(e,t,i,r)=>(T(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),R=(e,t,i)=>(T(e,t,"access private method"),i);class C extends u.RE{constructor(){super(...arguments),A(this,eC),A(this,eL),A(this,eM,[]),A(this,eR,void 0)}static get observedAttributes(){return[...super.observedAttributes,h.MediaUIAttributes.MEDIA_RENDITION_LIST,h.MediaUIAttributes.MEDIA_RENDITION_SELECTED]}attributeChangedCallback(e,t,i){super.attributeChangedCallback(e,t,i),e===h.MediaUIAttributes.MEDIA_RENDITION_SELECTED&&t!==i?this.value=null!=i?i:"auto":e===h.MediaUIAttributes.MEDIA_RENDITION_LIST&&t!==i&&(M(this,eM,(0,x.MS)(i)),R(this,eC,eI).call(this))}connectedCallback(){super.connectedCallback(),this.addEventListener("change",R(this,eL,ek))}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("change",R(this,eL,ek))}get mediaRenditionList(){return w(this,eM)}set mediaRenditionList(e){M(this,eM,e),R(this,eC,eI).call(this)}get mediaRenditionSelected(){return(0,p.ST)(this,h.MediaUIAttributes.MEDIA_RENDITION_SELECTED)}set mediaRenditionSelected(e){(0,p.Lb)(this,h.MediaUIAttributes.MEDIA_RENDITION_SELECTED,e)}}eM=new WeakMap,eR=new WeakMap,eC=new WeakSet,eI=function(){if(w(this,eR)===JSON.stringify(this.mediaRenditionList))return;M(this,eR,JSON.stringify(this.mediaRenditionList));let e=this.mediaRenditionList.sort((e,t)=>t.height-e.height),t=this.shadowRoot.querySelector("#container");t.textContent="";let i=!this.mediaRenditionSelected;for(let r of e){let e=this.formatOptionText(`${Math.min(r.width,r.height)}p`,r),n=(0,u.SX)(e,`${r.id}`,r.selected&&!i);n.prepend((0,u.sz)(this,"select-indicator")),t.append(n)}let r=(0,u.SX)(this.formatOptionText("Auto"),"auto",i);r.prepend((0,u.sz)(this,"select-indicator")),t.append(r)},eL=new WeakSet,ek=function(){if(null==this.value)return;let e=new f.Mq.CustomEvent(h.MediaUIEvents.MEDIA_RENDITION_REQUEST,{composed:!0,bubbles:!0,detail:this.value});this.dispatchEvent(e)},f.Mq.customElements.get("media-rendition-listbox")||f.Mq.customElements.define("media-rendition-listbox",C);var I=i(8925);let L=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M13.5 2.5h2v6h-2v-2h-11v-2h11v-2Zm4 2h4v2h-4v-2Zm-12 4h2v6h-2v-2h-3v-2h3v-2Zm4 2h12v2h-12v-2Zm1 4h2v6h-2v-2h-8v-2h8v-2Zm4 2h7v2h-7v-2Z" />
</svg>`,k=f.tj.createElement("template");k.innerHTML=`
  <slot name="icon">${L}</slot>
`;class D extends I.Z{static get observedAttributes(){return[...super.observedAttributes,h.MediaUIAttributes.MEDIA_RENDITION_SELECTED,h.MediaUIAttributes.MEDIA_RENDITION_UNAVAILABLE]}constructor(){super({slotTemplate:k})}get mediaRenditionSelected(){return(0,p.ST)(this,h.MediaUIAttributes.MEDIA_RENDITION_SELECTED)}set mediaRenditionSelected(e){(0,p.Lb)(this,h.MediaUIAttributes.MEDIA_RENDITION_SELECTED,e)}}f.Mq.customElements.get("media-rendition-button")||f.Mq.customElements.define("media-rendition-button",D);class P extends c._{static get observedAttributes(){return[...super.observedAttributes,h.MediaUIAttributes.MEDIA_RENDITION_SELECTED,h.MediaUIAttributes.MEDIA_RENDITION_UNAVAILABLE]}init(){let e=f.tj.createElement("media-rendition-button");e.part.add("button"),e.preventClick=!0;let t=f.tj.createElement("media-rendition-listbox");t.part.add("listbox"),t.setAttribute("exportparts","option, option-selected, indicator");let i=this.shadowRoot.querySelector("slot[name=button]"),r=this.shadowRoot.querySelector("slot[name=listbox]");i.textContent="",r.textContent="",i.append(e),r.append(t)}}f.Mq.customElements.get("media-rendition-selectmenu")||f.Mq.customElements.define("media-rendition-selectmenu",P);var O=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},N=(e,t,i)=>(O(e,t,"read from private field"),i?i.call(e):t.get(e)),U=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},F=(e,t,i,r)=>(O(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),B=(e,t,i)=>(O(e,t,"access private method"),i);class V extends u.RE{constructor(){super(...arguments),U(this,eO),U(this,eU),U(this,eD,[]),U(this,eP,void 0)}static get observedAttributes(){return[...super.observedAttributes,h.MediaUIAttributes.MEDIA_AUDIO_TRACK_LIST,h.MediaUIAttributes.MEDIA_AUDIO_TRACK_ENABLED]}attributeChangedCallback(e,t,i){super.attributeChangedCallback(e,t,i),e===h.MediaUIAttributes.MEDIA_AUDIO_TRACK_ENABLED&&t!==i?this.value=i:e===h.MediaUIAttributes.MEDIA_AUDIO_TRACK_LIST&&t!==i&&(F(this,eD,(0,x.Du)(i)),B(this,eO,eN).call(this))}connectedCallback(){super.connectedCallback(),this.addEventListener("change",B(this,eU,eF))}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("change",B(this,eU,eF))}get mediaAudioTrackList(){return N(this,eD)}set mediaAudioTrackList(e){F(this,eD,e),B(this,eO,eN).call(this)}get mediaAudioTrackEnabled(){return(0,p.ST)(this,h.MediaUIAttributes.MEDIA_AUDIO_TRACK_ENABLED)}set mediaAudioTrackEnabled(e){(0,p.Lb)(this,h.MediaUIAttributes.MEDIA_AUDIO_TRACK_ENABLED,e)}}eD=new WeakMap,eP=new WeakMap,eO=new WeakSet,eN=function(){if(N(this,eP)===JSON.stringify(this.mediaAudioTrackList))return;F(this,eP,JSON.stringify(this.mediaAudioTrackList));let e=this.mediaAudioTrackList,t=this.shadowRoot.querySelector("#container");for(let i of(t.textContent="",e)){let e=this.formatOptionText(i.label,i),r=(0,u.SX)(e,`${i.id}`,i.enabled);r.prepend((0,u.sz)(this,"select-indicator")),t.append(r)}},eU=new WeakSet,eF=function(){if(null==this.value)return;let e=new f.Mq.CustomEvent(h.MediaUIEvents.MEDIA_AUDIO_TRACK_REQUEST,{composed:!0,bubbles:!0,detail:this.value});this.dispatchEvent(e)},f.Mq.customElements.get("media-audio-track-listbox")||f.Mq.customElements.define("media-audio-track-listbox",V);let z=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M11 17H9.5V7H11v10Zm-3-3H6.5v-4H8v4Zm6-5h-1.5v6H14V9Zm3 7h-1.5V8H17v8Z"/>
  <path d="M22 12c0 5.523-4.477 10-10 10S2 17.523 2 12 6.477 2 12 2s10 4.477 10 10Zm-2 0a8 8 0 1 0-16 0 8 8 0 0 0 16 0Z"/>
</svg>`,j=f.tj.createElement("template");j.innerHTML=`
  <slot name="icon">${z}</slot>
`;class H extends I.Z{static get observedAttributes(){return[...super.observedAttributes,h.MediaUIAttributes.MEDIA_AUDIO_TRACK_ENABLED,h.MediaUIAttributes.MEDIA_AUDIO_TRACK_UNAVAILABLE]}constructor(){super({slotTemplate:j})}get mediaAudioTrackEnabled(){return(0,p.ST)(this,h.MediaUIAttributes.MEDIA_AUDIO_TRACK_ENABLED)}set mediaAudioTrackEnabled(e){(0,p.Lb)(this,h.MediaUIAttributes.MEDIA_AUDIO_TRACK_ENABLED,e)}}f.Mq.customElements.get("media-audio-track-button")||f.Mq.customElements.define("media-audio-track-button",H);class G extends c._{static get observedAttributes(){return[...super.observedAttributes,h.MediaUIAttributes.MEDIA_AUDIO_TRACK_ENABLED,h.MediaUIAttributes.MEDIA_AUDIO_TRACK_UNAVAILABLE]}init(){let e=f.tj.createElement("media-audio-track-button");e.part.add("button"),e.preventClick=!0;let t=f.tj.createElement("media-audio-track-listbox");t.part.add("listbox"),t.setAttribute("exportparts","option, option-selected, indicator");let i=this.shadowRoot.querySelector("slot[name=button]"),r=this.shadowRoot.querySelector("slot[name=listbox]");i.textContent="",r.textContent="",i.append(e),r.append(t)}}f.Mq.customElements.get("media-audio-track-selectmenu")||f.Mq.customElements.define("media-audio-track-selectmenu",G);var W=i(3759),$=i(43398).Z,q=class extends Error{constructor(e,t=q.MEDIA_ERR_CUSTOM,i,r){var n;super(e),this.name="MediaError",this.code=t,this.context=r,this.fatal=null!=i?i:t>=q.MEDIA_ERR_NETWORK&&t<=q.MEDIA_ERR_ENCRYPTED,this.message||(this.message=null!=(n=q.defaultMessages[this.code])?n:"")}};q.MEDIA_ERR_ABORTED=1,q.MEDIA_ERR_NETWORK=2,q.MEDIA_ERR_DECODE=3,q.MEDIA_ERR_SRC_NOT_SUPPORTED=4,q.MEDIA_ERR_ENCRYPTED=5,q.MEDIA_ERR_CUSTOM=100,q.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail.",3:"A media error caused playback to be aborted. The media could be corrupt or your browser does not support this format.",4:"An unsupported error occurred. The server or network failed, or your browser does not support this format.",5:"The media is encrypted and there are no keys to decrypt it."};var Y=e=>null==e,K=(e,t)=>!Y(t)&&e in t,X={ANY:"any",MUTED:"muted"},Z={ON_DEMAND:"on-demand",LIVE:"live",UNKNOWN:"unknown"},J={MSE:"mse",NATIVE:"native"},Q={HEADER:"header",QUERY:"query",NONE:"none"},ee=Object.values(Q),et={M3U8:"application/vnd.apple.mpegurl",MP4:"video/mp4"},ei={HLS:et.M3U8};Object.keys(ei),[...Object.values(et)];var er=(e,t,i,r,n=e)=>{n.addEventListener(t,i,r),e.addEventListener("teardown",()=>{n.removeEventListener(t,i)},{once:!0})},en=e=>{let t=e.indexOf("?");return t<0?[e]:[e.slice(0,t),e.slice(t)]},ea=e=>{let t=e.type;if(t){let e=t.toUpperCase();return K(e,ei)?ei[e]:t}let{src:i}=e;return i?el(i):""},es=e=>"VOD"===e?Z.ON_DEMAND:Z.LIVE,eo=e=>"EVENT"===e?Number.POSITIVE_INFINITY:"VOD"===e?Number.NaN:0,el=e=>{let t="";try{t=new URL(e).pathname}catch{console.error("invalid url")}let i=t.lastIndexOf(".");if(i<0)return"";let r=t.slice(i+1).toUpperCase();return K(r,et)?et[r]:""},eu=Object.values(X),ec=e=>"boolean"==typeof e||"string"==typeof e&&eu.includes(e),ed=({autoplay:e},t,i)=>{let r=!1,n=!1,a=ec(e)?e:!!e,s=()=>{r||er(t,"playing",()=>{r=!0},{once:!0})};if(s(),er(t,"loadstart",()=>{r=!1,s(),eh(t,a)},{once:!0}),er(t,"loadstart",()=>{i||(n=!Number.isFinite(t.duration)),eh(t,a)},{once:!0}),i&&i.once($.Events.LEVEL_LOADED,(e,t)=>{var i;n=null!=(i=t.details.live)&&i}),!a){let e=()=>{!n||(null!=i&&i.liveSyncPosition?t.currentTime=i.liveSyncPosition:Number.isFinite(t.seekable.end(0))&&(t.currentTime=t.seekable.end(0)))};i&&er(t,"play",()=>{"metadata"===t.preload?i.once($.Events.LEVEL_UPDATED,e):e()},{once:!0})}return e=>{r||eh(t,a=ec(e)?e:!!e)}},eh=(e,t)=>{if(!t)return;let i=e.muted,r=()=>e.muted=i;switch(t){case X.ANY:e.play().catch(()=>{e.muted=!0,e.play().catch(r)});break;case X.MUTED:e.muted=!0,e.play().catch(r);break;default:e.play().catch(()=>{})}},ef=({preload:e,src:t},i,r)=>{let n=e=>{null!=e&&["","none","metadata","auto"].includes(e)?i.setAttribute("preload",e):i.removeAttribute("preload")};if(!r)return n(e),n;let a=!1,s=!1,o=r.config.maxBufferLength,l=r.config.maxBufferSize,u=e=>{n(e);let t=null!=e?e:i.preload;s||"none"===t||("metadata"===t?(r.config.maxBufferLength=1,r.config.maxBufferSize=1):(r.config.maxBufferLength=o,r.config.maxBufferSize=l),c())},c=()=>{!a&&t&&(a=!0,r.loadSource(t))};return er(i,"play",()=>{s=!0,r.config.maxBufferLength=o,r.config.maxBufferSize=l,c()},{once:!0}),u(e),u};function ep(e,t,i,r,n){let a=document.createElement("track");return a.kind=t,a.label=i,r&&(a.srclang=r),n&&(a.id=n),a.track.mode=["subtitles","captions"].includes(t)?"disabled":"hidden",a.setAttribute("data-removeondestroy",""),e.append(a),a.track}var em="cuepoints",eg=Object.freeze({label:em}),ev=(e,{label:t=em}=eg)=>{var i;return null==(i=Array.from(e.querySelectorAll("track")).find(e=>e.track.label===t&&"metadata"===e.track.kind))?void 0:i.track};async function ey(e,t,i=eg){let r=ev(e,i);if(!r){let{label:t=em}=i;(r=ep(e,"metadata",t)).mode="hidden",await new Promise(e=>setTimeout(()=>e(void 0),0))}return"hidden"!==r.mode&&(r.mode="hidden"),[...t].sort(({time:e},{time:t})=>t-e).forEach(({time:t,value:i})=>{var n,a;let s=Array.prototype.findIndex.call(null==r?void 0:r.cues,e=>e.startTime>=t),o=null==(n=null==r?void 0:r.cues)?void 0:n[s],l=o?o.startTime:Number.isFinite(e.duration)?e.duration:Number.MAX_SAFE_INTEGER,u=null==(a=null==r?void 0:r.cues)?void 0:a[s-1];u&&(u.endTime=t);let c=new VTTCue(t,l,JSON.stringify(null!=i?i:null));r.addCue(c)}),r}var eb=e=>({time:e.startTime,value:JSON.parse(e.text)});function e_(e,t={label:em}){var i,r;let n=ev(e,t);if(!(null!=(i=null==n?void 0:n.activeCues)&&i.length))return;let{currentTime:a}=e;return eb(Array.prototype.find.call(null!=(r=n.activeCues)?r:[],({startTime:e,endTime:t})=>e<=a&&t>a))}async function eE(e,t=eg){return new Promise(i=>{er(e,"loadstart",async()=>{let r=await ey(e,[],t);er(e,"cuechange",()=>{let t=e_(e);if(t){let i=new CustomEvent("cuepointchange",{composed:!0,bubbles:!0,detail:t});e.dispatchEvent(i)}},{},r),i(r)})})}var eS,ex,eT,ew,eA,eM,eR,eC,eI,eL,ek,eD,eP,eO,eN,eU,eF,eB,eV,ez,ej=async e=>fetch(e).then(e=>e.text()).then(e=>{let t=e.split(`
`).find((e,t,i)=>t&&i[t-1].startsWith("#EXT-X-STREAM-INF"));return fetch(t).then(e=>e.text()).then(e=>e.split(`
`))}),eH=e=>{var t,i;let r=null==(i=(null!=(t=e.find(e=>e.startsWith("#EXT-X-PLAYLIST-TYPE")))?t:"").split(":")[1])?void 0:i.trim(),n=es(r),a=eo(r),s;if(n===Z.LIVE){let t=e.find(e=>e.startsWith("#EXT-X-PART-INF"));s=t?2*+t.split(":")[1].split("=")[1]:3*+e.find(e=>e.startsWith("#EXT-X-TARGETDURATION")).split(":")[1]}return{streamType:n,targetLiveWindow:a,liveEdgeStartOffset:s}},eG=async(e,t)=>t===et.MP4?{streamType:Z.ON_DEMAND,targetLiveWindow:Number.NaN,liveEdgeStartOffset:void 0}:t===et.M3U8?eH(await ej(e)):(console.error(`Media type ${t} is an unrecognized or unsupported type for src ${e}.`),{streamType:void 0,targetLiveWindow:void 0,liveEdgeStartOffset:void 0}),eW=async(e,t,i=ea({src:e}))=>{var r,n,a;let{streamType:s,targetLiveWindow:o,liveEdgeStartOffset:l}=await eG(e,i);(null!=(r=eK.get(t))?r:{}).liveEdgeStartOffset=l,(null!=(n=eK.get(t))?n:{}).targetLiveWindow=o,t.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0})),(null!=(a=eK.get(t))?a:{}).streamType=s,t.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}))},e$=e=>{var t;let i=e.type,r=es(i),n=eo(i),a,s=!!(null!=(t=e.partList)&&t.length);return r===Z.LIVE&&(a=s?2*e.partTarget:3*e.targetduration),{streamType:r,targetLiveWindow:n,liveEdgeStartOffset:a,lowLatency:s}},eq=(e,t,i)=>{var r,n,a,s,o,l,u,c;let{streamType:d,targetLiveWindow:h,liveEdgeStartOffset:f,lowLatency:p}=e$(e);if(d===Z.LIVE){p?(i.config.backBufferLength=null!=(r=i.userConfig.backBufferLength)?r:4,i.config.maxFragLookUpTolerance=null!=(n=i.userConfig.maxFragLookUpTolerance)?n:.001,i.config.abrBandWidthUpFactor=null!=(a=i.userConfig.abrBandWidthUpFactor)?a:i.config.abrBandWidthFactor):i.config.backBufferLength=null!=(s=i.userConfig.backBufferLength)?s:8;let e=Object.freeze({get length(){return t.seekable.length},start:e=>t.seekable.start(e),end(e){var r;return e>this.length?t.seekable.end(e):null!=(r=i.liveSyncPosition)?r:t.seekable.end(e)}});(null!=(o=eK.get(t))?o:{}).seekable=e}(null!=(l=eK.get(t))?l:{}).liveEdgeStartOffset=f,(null!=(u=eK.get(t))?u:{}).targetLiveWindow=h,t.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0})),(null!=(c=eK.get(t))?c:{}).streamType=d,t.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}))},eY=-1!==(null!=(eV=null==(eB=null==globalThis?void 0:globalThis.navigator)?void 0:eB.userAgent)?eV:"").toLowerCase().indexOf("android"),eK=new WeakMap,eX="mux.com",eZ=null==(ez=$.isSupported)?void 0:ez.call($),eJ=()=>W.utils.now(),eQ=W.utils.generateUUID,e0=(e,{domain:t=eX,maxResolution:i=""}={})=>{if(!e)return;let[r,n=""]=en(e),a=new URL(`https://stream.${t}/${r}.m3u8${n}`);return i&&a.searchParams.set("max_resolution",i),a.toString()},e1=e=>{if(!e)return;let[t]=e.split("?");return t||void 0},e2=e=>{if(!e||!e.startsWith("https://stream."))return;let[t]=new URL(e).pathname.slice(1).split(".m3u8");return t||void 0},e3=e=>{var t,i,r;return null!=(t=null==e?void 0:e.metadata)&&t.video_id?e.metadata.video_id:tl(e)&&null!=(r=null!=(i=e1(e.playbackId))?i:e2(e.src))?r:e.src},e5=e=>{var t;return null==(t=eK.get(e))?void 0:t.error},e4=e=>{var t,i;return null!=(i=null==(t=eK.get(e))?void 0:t.streamType)?i:Z.UNKNOWN},e6=e=>{var t,i;return null!=(i=null==(t=eK.get(e))?void 0:t.targetLiveWindow)?i:Number.NaN},e8=e=>{var t,i;return null!=(i=null==(t=eK.get(e))?void 0:t.seekable)?i:e.seekable},e7=e=>{var t;let i=null==(t=eK.get(e))?void 0:t.liveEdgeStartOffset;if("number"!=typeof i)return Number.NaN;let r=e8(e);return r.length?r.end(r.length-1)-i:Number.NaN},e9=(e,t,i=.001)=>Math.abs(e-t)<=i,te=(e,t,i=.001)=>e>t||e9(e,t,i),tt=e=>e.paused&&te(e.currentTime,e.duration),ti=(e,t)=>e.loop||t?e.ended:e.ended||tt(e),tr=(e,t,i)=>{tn(t,i);let{metadata:r={}}=e,{view_session_id:n=eQ()}=r,a=e3(e);r.view_session_id=n,r.video_id=a,e.metadata=r,eK.set(t,{});let s=ts(e,t);tu(e,t,s),tc(e,t,s),eE(t);let o=ed(e,t,s),l=ef(e,t,s);return{engine:s,setAutoplay:o,setPreload:l}},tn=(e,t)=>{let i=null==t?void 0:t.engine;i&&(i.detachMedia(),i.destroy()),(null==e?void 0:e.mux)&&!e.mux.deleted&&(e.mux.destroy(),delete e.mux),e&&(e.removeAttribute("src"),e.load(),e.removeEventListener("error",th),e.removeEventListener("error",tf),e.removeEventListener("durationchange",td),eK.delete(e),e.dispatchEvent(new Event("teardown")))};function ta(e,t){var i;let r=ea(e);if(r!==et.M3U8)return!0;let n=!r||null==(i=t.canPlayType(r))||i,{preferPlayback:a}=e,s=a===J.MSE,o=a===J.NATIVE;return n&&(o||!(eZ&&(s||eY)))}var ts=(e,t)=>{let{debug:i,streamType:r,startTime:n=-1,metadata:a,preferCmcd:s}=e,o=ea(e)===et.M3U8,l=ta(e,t);if(o&&!l&&eZ){let e=to(r),t=s!==Q.NONE?{useHeaders:s===Q.HEADER,sessionId:null==a?void 0:a.view_session_id,contentId:null==a?void 0:a.video_id}:void 0;return new $({debug:i,startPosition:n,cmcd:t,backBufferLength:30,renderTextTracksNatively:!1,liveDurationInfinity:!0,capLevelToPlayerSize:!0,capLevelOnFPSDrop:!0,...e})}},to=e=>e===Z.LIVE?{backBufferLength:8}:{},tl=({playbackId:e,src:t,customDomain:i})=>{if(e)return!0;if("string"!=typeof t)return!1;let r=null==window?void 0:window.location.href,n=new URL(t,r).hostname.toLocaleLowerCase();return n.includes(eX)||!!i&&n.includes(i.toLocaleLowerCase())},tu=(e,t,i)=>{var r;let{envKey:n}=e,a=tl(e);if(n||a){let{playerInitTime:a,playerSoftwareName:s,playerSoftwareVersion:o,beaconCollectionDomain:l,debug:u,disableCookies:c}=e,d={...e.metadata,video_title:(null==(r=null==e?void 0:e.metadata)?void 0:r.video_title)||void 0};W.monitor(t,{debug:u,beaconCollectionDomain:l,hlsjs:i,Hls:i?$:void 0,automaticErrorTracking:!1,errorTranslator:t=>"string"!=typeof t.player_error_code&&("function"==typeof e.errorTranslator?e.errorTranslator(t):t),disableCookies:c,data:{...n?{env_key:n}:{},player_software_name:s,player_software:s,player_software_version:o,player_init_time:a,...d}})}},tc=(e,t,i)=>{var r;let n=ta(e,t),{src:a}=e;if(t&&n){let i=ea(e);"string"==typeof a?("none"===t.preload?er(t,"loadstart",()=>eW(a,t,i)):eW(a,t,i),t.setAttribute("src",a),e.startTime&&((null!=(r=eK.get(t))?r:{}).startTime=e.startTime,t.addEventListener("durationchange",td,{once:!0}))):t.removeAttribute("src"),t.addEventListener("error",th),t.addEventListener("error",tf),t.addEventListener("emptied",()=>{t.querySelectorAll("track[data-removeondestroy]").forEach(e=>{e.remove()})},{once:!0});let n=()=>{t.ended||!ti(t)||t.dispatchEvent(new Event("ended"))};er(t,"pause",n),er(t,"seeked",n),er(t,"play",()=>{t.ended||!te(t.currentTime,t.duration)||(t.currentTime=t.seekable.start(0))})}else i&&a?(i.once($.Events.LEVEL_LOADED,(e,r)=>{eq(r.details,t,i)}),i.on($.Events.ERROR,(e,i)=>{let r={[$.ErrorTypes.NETWORK_ERROR]:q.MEDIA_ERR_NETWORK,[$.ErrorTypes.MEDIA_ERROR]:q.MEDIA_ERR_DECODE},n=new q("",r[i.type]);n.fatal=i.fatal,n.data=i,t.dispatchEvent(new CustomEvent("error",{detail:n}))}),t.addEventListener("error",tf),function(e,t){if(!("videoTracks"in e))return;let i=new WeakMap;t.on($.Events.MANIFEST_PARSED,function(t,n){r();let a=e.addVideoTrack("main");for(let[e,t]of(a.selected=!0,n.levels.entries())){let r=a.addRendition(t.url[0],t.width,t.height,t.videoCodec,t.bitrate);i.set(t,`${e}`),r.id=`${e}`}}),t.on($.Events.LEVELS_UPDATED,function(t,r){var n;let a=e.videoTracks[null!=(n=e.videoTracks.selectedIndex)?n:0];if(!a)return;let s=r.levels.map(e=>i.get(e));for(let t of e.videoRenditions)t.id&&!s.includes(t.id)&&a.removeRendition(t)}),e.videoRenditions.addEventListener("change",e=>{let i=e.target.selectedIndex;i!=t.nextLevel&&(t.nextLevel=i)});let r=()=>{for(let t of e.videoTracks)e.removeVideoTrack(t)};t.once($.Events.DESTROYING,()=>{r()})}(e,i),function(e,t){t.on($.Events.NON_NATIVE_TEXT_TRACKS_FOUND,(i,{tracks:r})=>{r.forEach(i=>{var r;let n=null!=(r=i.subtitleTrack)?r:i.closedCaptions,a=t.subtitleTracks.findIndex(({lang:e,name:t,type:r})=>e==(null==n?void 0:n.lang)&&t===i.label&&r.toLowerCase()===i.kind);ep(e,i.kind,i.label,null==n?void 0:n.lang,`${i.kind}${a}`)})});let i=()=>{var i;if(!t.subtitleTracks.length)return;let r=Array.from(e.textTracks).find(e=>e.id&&"showing"===e.mode&&["subtitles","captions"].includes(e.kind)),n=`${null==(i=t.subtitleTracks[t.subtitleTrack])?void 0:i.type.toLowerCase()}${t.subtitleTrack}`;if(r&&(t.subtitleTrack<0||(null==r?void 0:r.id)!==n)){let e=t.subtitleTracks.findIndex(({lang:e,name:t,type:i})=>e==r.language&&t===r.label&&i.toLowerCase()===r.kind);t.subtitleTrack=e}r&&(null==r?void 0:r.id)===n&&r.cues&&Array.from(r.cues).forEach(e=>{r.addCue(e)})};e.textTracks.addEventListener("change",i),t.on($.Events.CUES_PARSED,(t,{track:i,cues:r})=>{let n=e.textTracks.getTrackById(i);if(!n)return;let a="disabled"===n.mode;a&&(n.mode="hidden"),r.forEach(e=>{var t;null!=(t=n.cues)&&t.getCueById(e.id)||n.addCue(e)}),a&&(n.mode="disabled")}),t.once($.Events.DESTROYING,()=>{e.textTracks.removeEventListener("change",i),e.querySelectorAll("track[data-removeondestroy]").forEach(e=>{e.remove()})});let r=()=>{Array.from(e.textTracks).forEach(t=>{var i,r;if(!["subtitles","caption"].includes(t.kind)&&"thumbnails"===t.label){if(!(null!=(i=t.cues)&&i.length)){let t=e.querySelector('track[label="thumbnails"]'),i=null!=(r=null==t?void 0:t.getAttribute("src"))?r:"";null==t||t.removeAttribute("src"),setTimeout(()=>{null==t||t.setAttribute("src",i)},0)}"hidden"!==t.mode&&(t.mode="hidden")}})};t.once($.Events.MANIFEST_LOADED,r),t.once($.Events.MEDIA_ATTACHED,r)}(t,i),i.attachMedia(t)):console.error("It looks like the video you're trying to play will not work on this system! If possible, try upgrading to the newest versions of your browser or software.")};function td(e){var t;let i=e.target,r=null==(t=eK.get(i))?void 0:t.startTime;if(r&&function(e,t,i){t&&i>t&&(i=t);for(let t=0;t<e.length;t++)if(e.start(t)<=i&&e.end(t)>=i)return!0;return!1}(i.seekable,i.duration,r)){let e="auto"===i.preload;e&&(i.preload="none"),i.currentTime=r,e&&(i.preload="auto")}}async function th(e){if(!e.isTrusted)return;e.stopImmediatePropagation();let t=e.target;if(!(null!=t&&t.error))return;let{message:i,code:r}=t.error,n=new q(i,r);if(t.src&&(r!==q.MEDIA_ERR_DECODE||void 0!==r))try{let{status:e}=await fetch(t.src);n.data={response:{code:e}}}catch{}t.dispatchEvent(new CustomEvent("error",{detail:n}))}function tf(e){var t,i;if(!(e instanceof CustomEvent)||!(e.detail instanceof q))return;let r=e.target,n=e.detail;n&&n.fatal&&((null!=(t=eK.get(r))?t:{}).error=n,null==(i=r.mux)||i.emit("error",{player_error_code:n.code,player_error_message:n.message,player_error_context:n.context}))}var tp=Object.defineProperty,tm=(e,t,i)=>t in e?tp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,tg=(e,t,i)=>(tm(e,"symbol"!=typeof t?t+"":t,i),i),tv=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},ty=(e,t,i)=>(tv(e,t,"read from private field"),i?i.call(e):t.get(e)),tb=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},t_=(e,t,i,r)=>(tv(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),tE=(e,t,i)=>(tv(e,t,"access private method"),i),tS=class{addEventListener(){}removeEventListener(){}dispatchEvent(e){return!0}};"undefined"==typeof DocumentFragment&&(globalThis.DocumentFragment=class extends tS{});var tx,tT=class extends tS{},tw=class{constructor(e,t={}){tb(this,tx,void 0),t_(this,tx,null==t?void 0:t.detail)}get detail(){return ty(this,tx)}initCustomEvent(){}};tx=new WeakMap;var tA={document:{createElement:function(e,t){return new tT}},DocumentFragment,customElements:{get(e){},define(e,t,i){},upgrade(e){},whenDefined:e=>Promise.resolve(tT)},CustomEvent:tw,EventTarget:tS,HTMLElement:tT,HTMLVideoElement:class extends tS{}},tM="undefined"==typeof window||void 0===globalThis.customElements,tR=tM?tA:globalThis;tM&&tA.document;var tC=(()=>{try{return"0.16.1"}catch{}return"UNKNOWN"})(),tI=e=>{var t,i,r,n,a,s,o,l,u,c,d,h,f,p,m,g,v,y,b,_,E,S,x,T,w,A,M,R,C,I,L,k,D,P,O,N,U,F,B,V;return t=class extends e{constructor(){super(),tb(this,M),tb(this,C),tb(this,L),tb(this,D),tb(this,O),tb(this,U),tb(this,B),tg(this,"castEnabled",!1),tb(this,E,{paused:!1}),tb(this,S,void 0),tb(this,x,{}),tb(this,T,void 0),tb(this,w,void 0),tb(this,A,void 0),t.instances.add(this),tE(this,O,N).call(this)}static get castElement(){return ty(t,i)}static get castEnabled(){return ty(t,r)}static get castState(){var e;return null==(e=ty(t,u,c))?void 0:e.getCastState()}static async exitCast(){try{await ty(t,u,c).endCurrentSession(!0)}catch(e){console.error(e);return}}get castPlayer(){if(t.castElement===this)return ty(this,S)}attributeChangedCallback(e){if(this.castPlayer)switch(e){case"cast-stream-type":case"cast-src":this.load()}}async requestCast(e={}){tE(t,b,_).call(t,e),t_(t,i,this),Object.entries(ty(this,x)).forEach(([e,t])=>{ty(this,S).controller.addEventListener(e,t)});try{await ty(t,u,c).requestSession()}catch{t_(t,i,void 0);return}ty(this,E).paused=super.paused,super.pause(),this.muted=super.muted;try{await this.load()}catch(e){console.error(e)}}async load(){var e,i;if(!this.castPlayer)return super.load();let r=new chrome.cast.media.MediaInfo(this.castSrc,this.castContentType),n=[...this.querySelectorAll("track")].filter(({kind:e,src:t})=>t&&("subtitles"===e||"captions"===e)),a=[],s=0;n.length&&(r.tracks=n.map(e=>{let t=++s;0===a.length&&"showing"===e.track.mode&&a.push(t);let i=new chrome.cast.media.Track(t,chrome.cast.media.TrackType.TEXT);return i.trackContentId=e.src,i.trackContentType="text/vtt",i.subtype="captions"===e.kind?chrome.cast.media.TextTrackType.CAPTIONS:chrome.cast.media.TextTrackType.SUBTITLES,i.name=e.label,i.language=e.srclang,i})),"live"===this.castStreamType?r.streamType=chrome.cast.media.StreamType.LIVE:r.streamType=chrome.cast.media.StreamType.BUFFERED,r.metadata=new chrome.cast.media.GenericMediaMetadata,r.metadata.title=this.title,r.metadata.images=[{url:this.poster}];let o=new chrome.cast.media.LoadRequest(r);o.currentTime=null!=(e=super.currentTime)?e:0,o.autoplay=!ty(this,E).paused,o.activeTrackIds=a,await (null==(i=ty(t,d,h))?void 0:i.loadMedia(o)),this.dispatchEvent(new Event("volumechange"))}play(){var e;if(this.castPlayer){this.castPlayer.isPaused&&(null==(e=this.castPlayer.controller)||e.playOrPause());return}return super.play()}pause(){var e;if(this.castPlayer){this.castPlayer.isPaused||null==(e=this.castPlayer.controller)||e.playOrPause();return}super.pause()}get castSrc(){var e,t,i;return null!=(i=null!=(t=this.getAttribute("cast-src"))?t:null==(e=this.querySelector("source"))?void 0:e.src)?i:this.currentSrc}set castSrc(e){this.castSrc!=e&&this.setAttribute("cast-src",`${e}`)}get castContentType(){var e;return null!=(e=this.getAttribute("cast-content-type"))?e:void 0}set castContentType(e){this.setAttribute("cast-content-type",`${e}`)}get castStreamType(){var e,t;return null!=(t=null!=(e=this.getAttribute("cast-stream-type"))?e:this.streamType)?t:void 0}set castStreamType(e){this.setAttribute("cast-stream-type",`${e}`)}get readyState(){if(this.castPlayer)switch(this.castPlayer.playerState){case chrome.cast.media.PlayerState.IDLE:return 0;case chrome.cast.media.PlayerState.BUFFERING:return 2;default:return 3}return super.readyState}get paused(){return this.castPlayer?this.castPlayer.isPaused:super.paused}get muted(){var e;return this.castPlayer?null==(e=this.castPlayer)?void 0:e.isMuted:super.muted}set muted(e){var t;if(this.castPlayer){(e&&!this.castPlayer.isMuted||!e&&this.castPlayer.isMuted)&&(null==(t=this.castPlayer.controller)||t.muteOrUnmute());return}super.muted=e}get volume(){var e,t;return this.castPlayer?null!=(t=null==(e=this.castPlayer)?void 0:e.volumeLevel)?t:1:super.volume}set volume(e){var t;if(this.castPlayer){this.castPlayer.volumeLevel=e,null==(t=this.castPlayer.controller)||t.setVolumeLevel();return}super.volume=e}get duration(){var e,t;return this.castPlayer&&ty(this,M,R)?null!=(t=null==(e=this.castPlayer)?void 0:e.duration)?t:NaN:super.duration}get currentTime(){var e,t;return this.castPlayer&&ty(this,M,R)?null!=(t=null==(e=this.castPlayer)?void 0:e.currentTime)?t:0:super.currentTime}set currentTime(e){var t;if(this.castPlayer){this.castPlayer.currentTime=e,null==(t=this.castPlayer.controller)||t.seek();return}super.currentTime=e}get onentercast(){return ty(this,T)}set onentercast(e){ty(this,T)&&(this.removeEventListener("entercast",ty(this,T)),t_(this,T,null)),"function"==typeof e&&(t_(this,T,e),this.addEventListener("entercast",e))}get onleavecast(){return ty(this,w)}set onleavecast(e){ty(this,w)&&(this.removeEventListener("leavecast",ty(this,w)),t_(this,w,null)),"function"==typeof e&&(t_(this,w,e),this.addEventListener("leavecast",e))}get oncastchange(){return ty(this,A)}set oncastchange(e){ty(this,A)&&(this.removeEventListener("castchange",ty(this,A)),t_(this,A,null)),"function"==typeof e&&(t_(this,A,e),this.addEventListener("castchange",e))}},i=new WeakMap,r=new WeakMap,n=new WeakMap,a=new WeakSet,s=function(){return"undefined"!=typeof chrome&&chrome.cast&&chrome.cast.isAvailable},o=new WeakSet,l=function(){return"undefined"!=typeof cast&&cast.framework},u=new WeakSet,c=function(){if(ty(t,o,l))return cast.framework.CastContext.getInstance()},d=new WeakSet,h=function(){var e;return null==(e=ty(t,u,c))?void 0:e.getCurrentSession()},f=new WeakSet,p=function(){var e;return null==(e=ty(t,d,h))?void 0:e.getSessionObj().media[0]},m=new WeakSet,g=function(e){return new Promise((i,r)=>{ty(t,f,p).editTracksInfo(e,i,r)})},v=new WeakSet,y=function(e){return new Promise((i,r)=>{ty(t,f,p).getStatus(e,i,r)})},b=new WeakSet,_=function(e){return ty(t,u,c).setOptions({receiverApplicationId:chrome.cast.media.DEFAULT_MEDIA_RECEIVER_APP_ID,autoJoinPolicy:chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,androidReceiverCompatible:!1,language:"en-US",resumeSavedSession:!0,...e})},E=new WeakMap,S=new WeakMap,x=new WeakMap,T=new WeakMap,w=new WeakMap,A=new WeakMap,M=new WeakSet,R=function(){var e;return null==(e=this.castPlayer)?void 0:e.isMediaLoaded},C=new WeakSet,I=function(){ty(t,i)===this&&(Object.entries(ty(this,x)).forEach(([e,t])=>{ty(this,S).controller.removeEventListener(e,t)}),t_(t,i,void 0),this.muted=ty(this,S).isMuted,this.currentTime=ty(this,S).savedPlayerState.currentTime,!1===ty(this,S).savedPlayerState.isPaused&&this.play())},L=new WeakSet,k=function(){this.dispatchEvent(new CustomEvent("castchange",{detail:ty(t,u,c).getCastState()}))},D=new WeakSet,P=async function(){var e;let{SESSION_RESUMED:r}=cast.framework.SessionState;if(ty(t,u,c).getSessionState()===r&&this.castSrc===(null==(e=ty(t,f,p))?void 0:e.media.contentId)){t_(t,i,this),Object.entries(ty(this,x)).forEach(([e,t])=>{ty(this,S).controller.addEventListener(e,t)});try{await tE(t,v,y).call(t,new chrome.cast.media.GetStatusRequest)}catch(e){console.error(e)}ty(this,x)[cast.framework.RemotePlayerEventType.IS_PAUSED_CHANGED](),ty(this,x)[cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED]()}},O=new WeakSet,N=function(){!ty(t,o,l)||this.castEnabled||(this.castEnabled=!0,tE(t,b,_).call(t),this.textTracks.addEventListener("change",tE(this,B,V).bind(this)),tE(this,L,k).call(this),t_(this,S,new cast.framework.RemotePlayer),new cast.framework.RemotePlayerController(ty(this,S)),t_(this,x,{[cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED]:({value:e})=>{!1===e&&tE(this,C,I).call(this),this.dispatchEvent(new Event(e?"entercast":"leavecast"))},[cast.framework.RemotePlayerEventType.DURATION_CHANGED]:()=>{this.dispatchEvent(new Event("durationchange"))},[cast.framework.RemotePlayerEventType.VOLUME_LEVEL_CHANGED]:()=>{this.dispatchEvent(new Event("volumechange"))},[cast.framework.RemotePlayerEventType.IS_MUTED_CHANGED]:()=>{this.dispatchEvent(new Event("volumechange"))},[cast.framework.RemotePlayerEventType.CURRENT_TIME_CHANGED]:()=>{ty(this,M,R)&&this.dispatchEvent(new Event("timeupdate"))},[cast.framework.RemotePlayerEventType.VIDEO_INFO_CHANGED]:()=>{this.dispatchEvent(new Event("resize"))},[cast.framework.RemotePlayerEventType.IS_PAUSED_CHANGED]:()=>{this.dispatchEvent(new Event(this.paused?"pause":"play"))},[cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED]:()=>{var e,t;(null==(e=this.castPlayer)?void 0:e.playerState)!==chrome.cast.media.PlayerState.PAUSED&&this.dispatchEvent(new Event({[chrome.cast.media.PlayerState.PLAYING]:"playing",[chrome.cast.media.PlayerState.BUFFERING]:"waiting",[chrome.cast.media.PlayerState.IDLE]:"emptied"}[null==(t=this.castPlayer)?void 0:t.playerState]))},[cast.framework.RemotePlayerEventType.IS_MEDIA_LOADED_CHANGED]:async()=>{ty(this,M,R)&&(await Promise.resolve(),tE(this,U,F).call(this))}}))},U=new WeakSet,F=function(){tE(this,B,V).call(this)},B=new WeakSet,V=async function(){var e,i,r,n,a,s;if(!this.castPlayer)return;let o=(null!=(i=null==(e=ty(this,S).mediaInfo)?void 0:e.tracks)?i:[]).filter(({type:e})=>e===chrome.cast.media.TrackType.TEXT),l=[...this.textTracks].filter(({kind:e})=>"subtitles"===e||"captions"===e),u=o.map(({language:e,name:t,trackId:i})=>{var r;let{mode:n}=null!=(r=l.find(i=>i.language===e&&i.label===t))?r:{};return!!n&&{mode:n,trackId:i}}).filter(Boolean),c=u.filter(({mode:e})=>"showing"!==e).map(({trackId:e})=>e),f=u.find(({mode:e})=>"showing"===e),p=null!=(a=null==(n=null==(r=ty(t,d,h))?void 0:r.getSessionObj().media[0])?void 0:n.activeTrackIds)?a:[],v=p;if(p.length&&(v=v.filter(e=>!c.includes(e))),null!=f&&f.trackId&&(v=[...v,f.trackId]),s=v=[...new Set(v)],!(p.length===s.length&&p.every(e=>s.includes(e))))try{let e=new chrome.cast.media.EditTracksInfoRequest(v);await tE(t,m,g).call(t,e)}catch(e){console.error(e)}},tb(t,a),tb(t,o),tb(t,u),tb(t,d),tb(t,f),tb(t,m),tb(t,v),tb(t,b),tg(t,"observedAttributes",["cast-src","cast-content-type","cast-stream-type"]),tg(t,"instances",new Set),tb(t,i,void 0),tb(t,r,!1),tg(t,"initCast",()=>{ty(t,a,s)?ty(t,o,l)?ty(t,n).call(t,chrome.cast.isAvailable):customElements.whenDefined("google-cast-button").then(()=>ty(t,n).call(t,chrome.cast.isAvailable)):globalThis.__onGCastApiAvailable=()=>{customElements.whenDefined("google-cast-button").then(()=>ty(t,n).call(t,chrome.cast.isAvailable))}}),tb(t,n,e=>{if(e){t_(t,r,!0);let{CAST_STATE_CHANGED:e}=cast.framework.CastContextEventType;ty(t,u,c).addEventListener(e,e=>{t.instances.forEach(t=>tE(t,L,k).call(t,e))});let{SESSION_STATE_CHANGED:i}=cast.framework.CastContextEventType;ty(t,u,c).addEventListener(i,e=>{t.instances.forEach(t=>tE(t,D,P).call(t,e))}),t.instances.forEach(e=>tE(e,O,N).call(e))}}),t},tL=globalThis.HTMLVideoElement?tI(HTMLVideoElement):tI(Object);globalThis.customElements&&!globalThis.customElements.get("castable-video")&&(customElements.define("castable-video",tL,{extends:"video"}),globalThis.CastableVideoElement=tL),tL.initCast();var tk,tD=["abort","canplay","canplaythrough","durationchange","emptied","encrypted","ended","error","loadeddata","loadedmetadata","loadstart","pause","play","playing","progress","ratechange","seeked","seeking","stalled","suspend","timeupdate","volumechange","waiting","waitingforkey","resize","enterpictureinpicture","leavepictureinpicture","webkitbeginfullscreen","webkitendfullscreen","webkitpresentationmodechanged"],tP=null==(tk=globalThis.document)?void 0:tk.createElement("template");tP&&(tP.innerHTML=`
    <style>
      :host {
        display: inline-block;
        line-height: 0;
      }

      audio {
        max-width: 100%;
        max-height: 100%;
        min-width: 100%;
        min-height: 100%;
      }
    </style>
    <slot></slot>
  `);var tO,tN=null==(tO=globalThis.document)?void 0:tO.createElement("template");tN&&(tN.innerHTML=`
    <style>
      :host {
        display: inline-block;
        line-height: 0;
      }

      video {
        max-width: 100%;
        max-height: 100%;
        min-width: 100%;
        min-height: 100%;
        object-fit: var(--media-object-fit, contain);
        object-position: var(--media-object-position, 50% 50%);
      }

      video::-webkit-media-text-track-container {
        transform: var(--media-webkit-text-track-transform);
        transition: var(--media-webkit-text-track-transition);
      }
    </style>
    <slot></slot>
  `);var tU=(e,{tag:t,is:i})=>{var r,n,a,s,o,l,u,c,d,h,f,p,m;let g=null==(r=globalThis.document)?void 0:r.createElement(t,{is:i}),v=g?function(e){let t=[];for(let i=Object.getPrototypeOf(e);i&&i!==HTMLElement.prototype;i=Object.getPrototypeOf(i))t.push(...Object.getOwnPropertyNames(i));return t}(g):[];return n=class extends e{constructor(){super(),tb(this,c),tb(this,h),tb(this,p),tb(this,l,void 0),tb(this,u,void 0),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.append(this.constructor.template.content.cloneNode(!0)))}static get observedAttributes(){var e,t;return tE(n,s,o).call(n),[...null!=(t=null==(e=null==g?void 0:g.constructor)?void 0:e.observedAttributes)?t:[],"autopictureinpicture","disablepictureinpicture","disableremoteplayback","autoplay","controls","controlslist","crossorigin","loop","muted","playsinline","poster","preload","src"]}get nativeEl(){var e,i;return null!=(i=null!=(e=ty(this,u))?e:this.shadowRoot.querySelector(t))?i:this.querySelector(t)}set nativeEl(e){t_(this,u,e)}get defaultMuted(){return this.hasAttribute("muted")}set defaultMuted(e){this.toggleAttribute("muted",!!e)}get src(){return this.getAttribute("src")}set src(e){this.setAttribute("src",`${e}`)}get preload(){var e,t;return null!=(t=this.getAttribute("preload"))?t:null==(e=this.nativeEl)?void 0:e.preload}set preload(e){this.setAttribute("preload",`${e}`)}attributeChangedCallback(e,t,i){tE(this,c,d).call(this),tE(this,p,m).call(this,e,t,i)}connectedCallback(){tE(this,c,d).call(this)}},a=new WeakMap,s=new WeakSet,o=function(){if(ty(this,a))return;t_(this,a,!0);let e=new Set(this.observedAttributes);for(let t of(e.delete("muted"),v))if(!(t in this.prototype)){if("function"==typeof g[t])this.prototype[t]=function(...e){return tE(this,c,d).call(this),this.call?this.call(t,...e):this.nativeEl[t].apply(this.nativeEl,e)};else{let i={get(){var i,r,n;tE(this,c,d).call(this);let a=t.toLowerCase();if(e.has(a)){let e=this.getAttribute(a);return null!==e&&(""===e||e)}return null!=(n=null==(i=this.get)?void 0:i.call(this,t))?n:null==(r=this.nativeEl)?void 0:r[t]}};t!==t.toUpperCase()&&(i.set=function(i){tE(this,c,d).call(this);let r=t.toLowerCase();if(e.has(r)){!0===i||!1===i||null==i?this.toggleAttribute(r,!!i):this.setAttribute(r,i);return}if(this.set){this.set(t,i);return}this.nativeEl[t]=i}),Object.defineProperty(this.prototype,t,i)}}},l=new WeakMap,u=new WeakMap,c=new WeakSet,d=function(){var e,r;if(ty(this,l))return;if(t_(this,l,!0),!this.nativeEl){let e=document.createElement(t,{is:i});e.part=t,this.shadowRoot.append(e)}for(let e of(this.nativeEl.muted=this.hasAttribute("muted"),v))tE(this,h,f).call(this,e);let n=new Map,a=this.shadowRoot.querySelector("slot:not([name])");for(let t of(null==a||a.addEventListener("slotchange",()=>{let e=new Map(n);a.assignedElements().filter(e=>["track","source"].includes(e.localName)).forEach(t=>{var i,r;e.delete(t);let a=n.get(t);a||(a=t.cloneNode(),n.set(t,a)),null==(r=(i=this.nativeEl).append)||r.call(i,a)}),e.forEach(e=>e.remove())}),this.constructor.Events))null==(r=(e=this.shadowRoot).addEventListener)||r.call(e,t,e=>{e.target===this.nativeEl&&this.dispatchEvent(new CustomEvent(e.type,{detail:e.detail}))},!0)},h=new WeakSet,f=function(e){if(Object.prototype.hasOwnProperty.call(this,e)){let t=this[e];delete this[e],this[e]=t}},p=new WeakSet,m=function(e,t,i){var r,n,a,s;["id","class"].includes(e)||(null===i?null==(n=(r=this.nativeEl).removeAttribute)||n.call(r,e):null==(s=(a=this.nativeEl).setAttribute)||s.call(a,e,i))},tb(n,s),tg(n,"Events",tD),tg(n,"template",t.endsWith("audio")?tP:tN),tb(n,a,void 0),n};globalThis.document&&tU(HTMLElement,{tag:"video"}),globalThis.document&&tU(HTMLElement,{tag:"audio"});var tF=class extends Event{constructor(e,t){super(e),tg(this,"track"),this.track=t.track}},tB=new WeakMap;function tV(e){var t;let i;return null!=(t=tB.get(e))?t:((i=tB.get(e))||tB.set(e,i={}),Object.assign(i,{}))}function tz(e,t){let i=e.videoTracks;tV(t).media=e,tV(t).renditionSet||(tV(t).renditionSet=new Set);let r=tV(i).trackSet;r.add(t);let n=r.size-1;n in tY.prototype||Object.defineProperty(tY.prototype,n,{get(){return[...tV(this).trackSet][n]}}),queueMicrotask(()=>{i.dispatchEvent(new tF("addtrack",{track:t}))})}function tj(e){var t;let i=null==(t=tV(e).media)?void 0:t.videoTracks;i&&(tV(i).trackSet.delete(e),queueMicrotask(()=>{i.dispatchEvent(new tF("removetrack",{track:e}))}))}var tH,tG,tW,t$,tq,tY=class extends EventTarget{constructor(){super(),tb(this,t$),tb(this,tH,void 0),tb(this,tG,void 0),tb(this,tW,void 0),tV(this).trackSet=new Set}[Symbol.iterator](){return ty(this,t$,tq).values()}get length(){return ty(this,t$,tq).size}getTrackById(e){var t;return null!=(t=[...ty(this,t$,tq)].find(t=>t.id===e))?t:null}get selectedIndex(){return[...ty(this,t$,tq)].findIndex(e=>e.selected)}get onaddtrack(){return ty(this,tH)}set onaddtrack(e){ty(this,tH)&&(this.removeEventListener("addtrack",ty(this,tH)),t_(this,tH,void 0)),"function"==typeof e&&(t_(this,tH,e),this.addEventListener("addtrack",e))}get onremovetrack(){return ty(this,tG)}set onremovetrack(e){ty(this,tG)&&(this.removeEventListener("removetrack",ty(this,tG)),t_(this,tG,void 0)),"function"==typeof e&&(t_(this,tG,e),this.addEventListener("removetrack",e))}get onchange(){return ty(this,tW)}set onchange(e){ty(this,tW)&&(this.removeEventListener("change",ty(this,tW)),t_(this,tW,void 0)),"function"==typeof e&&(t_(this,tW,e),this.addEventListener("change",e))}};tH=new WeakMap,tG=new WeakMap,tW=new WeakMap,t$=new WeakSet,tq=function(){return tV(this).trackSet};var tK=class extends Event{constructor(e,t){super(e),tg(this,"rendition"),this.rendition=t.rendition}};function tX(e){return[...tV(e).media.videoTracks].filter(e=>e.selected).flatMap(e=>[...tV(e).renditionSet])}var tZ,tJ,tQ,t0=class extends EventTarget{constructor(){super(...arguments),tb(this,tZ,void 0),tb(this,tJ,void 0),tb(this,tQ,void 0)}[Symbol.iterator](){return tX(this).values()}get length(){return tX(this).length}getRenditionById(e){var t;return null!=(t=tX(this).find(t=>`${t.id}`==`${e}`))?t:null}get selectedIndex(){return tX(this).findIndex(e=>e.selected)}set selectedIndex(e){for(let[t,i]of tX(this).entries())i.selected=t===e}get onaddrendition(){return ty(this,tZ)}set onaddrendition(e){ty(this,tZ)&&(this.removeEventListener("addrendition",ty(this,tZ)),t_(this,tZ,void 0)),"function"==typeof e&&(t_(this,tZ,e),this.addEventListener("addrendition",e))}get onremoverendition(){return ty(this,tJ)}set onremoverendition(e){ty(this,tJ)&&(this.removeEventListener("removerendition",ty(this,tJ)),t_(this,tJ,void 0)),"function"==typeof e&&(t_(this,tJ,e),this.addEventListener("removerendition",e))}get onchange(){return ty(this,tQ)}set onchange(e){ty(this,tQ)&&(this.removeEventListener("change",ty(this,tQ)),t_(this,tQ,void 0)),"function"==typeof e&&(t_(this,tQ,e),this.addEventListener("change",e))}};tZ=new WeakMap,tJ=new WeakMap,tQ=new WeakMap;var t1,t2=class{constructor(){tg(this,"src"),tg(this,"id"),tg(this,"width"),tg(this,"height"),tg(this,"bitrate"),tg(this,"frameRate"),tg(this,"codec"),tb(this,t1,!1)}get selected(){return ty(this,t1)}set selected(e){var t;let i;ty(this,t1)===e||(t_(this,t1,e),t=this,(i=tV(t).media.videoRenditions)&&!tV(i).changeRequested&&(tV(i).changeRequested=!0,queueMicrotask(()=>{delete tV(i).changeRequested,tV(t).track.selected&&i.dispatchEvent(new Event("change"))})))}};t1=new WeakMap;var t3,t5=class{constructor(){tg(this,"id"),tg(this,"kind"),tg(this,"label",""),tg(this,"language",""),tg(this,"sourceBuffer"),tb(this,t3,!1)}addRendition(e,t,i,r,n,a){var s;let o,l,u,c=new t2;return c.src=e,c.width=t,c.height=i,c.frameRate=a,c.bitrate=n,c.codec=r,s=this,o=tV(s).media.videoRenditions,tV(c).media=tV(s).media,tV(c).track=s,(l=tV(s).renditionSet).add(c),(u=l.size-1)in t0.prototype||Object.defineProperty(t0.prototype,u,{get(){return tX(this)[u]}}),queueMicrotask(()=>{s.selected&&o.dispatchEvent(new tK("addrendition",{rendition:c}))}),c}removeRendition(e){let t,i;t=tV(e).media.videoRenditions,i=tV(e).track,tV(i).renditionSet.delete(e),queueMicrotask(()=>{tV(e).track.selected&&t.dispatchEvent(new tK("removerendition",{rendition:e}))})}get selected(){return ty(this,t3)}set selected(e){ty(this,t3)!==e&&(t_(this,t3,e),!0===e&&function(e){var t;let i=null!=(t=tV(e).media.videoTracks)?t:[],r=!1;for(let t of i)t!==e&&(t.selected=!1,r=!0);if(r){if(tV(i).changeRequested)return;tV(i).changeRequested=!0,queueMicrotask(()=>{delete tV(i).changeRequested,i.dispatchEvent(new Event("change"))})}}(this))}};function t4(e){return[...tV(e).media.audioTracks].filter(e=>e.enabled).flatMap(e=>[...tV(e).renditionSet])}t3=new WeakMap;var t6,t8,t7,t9=class extends EventTarget{constructor(){super(...arguments),tb(this,t6,void 0),tb(this,t8,void 0),tb(this,t7,void 0)}[Symbol.iterator](){return t4(this).values()}get length(){return t4(this).length}getRenditionById(e){var t;return null!=(t=t4(this).find(t=>`${t.id}`==`${e}`))?t:null}get selectedIndex(){return t4(this).findIndex(e=>e.selected)}set selectedIndex(e){for(let[t,i]of t4(this).entries())i.selected=t===e}get onaddrendition(){return ty(this,t6)}set onaddrendition(e){ty(this,t6)&&(this.removeEventListener("addrendition",ty(this,t6)),t_(this,t6,void 0)),"function"==typeof e&&(t_(this,t6,e),this.addEventListener("addrendition",e))}get onremoverendition(){return ty(this,t8)}set onremoverendition(e){ty(this,t8)&&(this.removeEventListener("removerendition",ty(this,t8)),t_(this,t8,void 0)),"function"==typeof e&&(t_(this,t8,e),this.addEventListener("removerendition",e))}get onchange(){return ty(this,t7)}set onchange(e){ty(this,t7)&&(this.removeEventListener("change",ty(this,t7)),t_(this,t7,void 0)),"function"==typeof e&&(t_(this,t7,e),this.addEventListener("change",e))}};t6=new WeakMap,t8=new WeakMap,t7=new WeakMap;var ie,it=class{constructor(){tg(this,"src"),tg(this,"id"),tg(this,"bitrate"),tg(this,"codec"),tb(this,ie,!1)}get selected(){return ty(this,ie)}set selected(e){var t;let i;ty(this,ie)===e||(t_(this,ie,e),t=this,(i=tV(t).media.audioRenditions)&&!tV(i).changeRequested&&(tV(i).changeRequested=!0,queueMicrotask(()=>{delete tV(i).changeRequested,tV(t).track.enabled&&i.dispatchEvent(new Event("change"))})))}};function ii(e,t){let i=e.audioTracks;tV(t).media=e,tV(t).renditionSet||(tV(t).renditionSet=new Set);let r=tV(i).trackSet;r.add(t);let n=r.size-1;n in ic.prototype||Object.defineProperty(ic.prototype,n,{get(){return[...tV(this).trackSet][n]}}),queueMicrotask(()=>{i.dispatchEvent(new tF("addtrack",{track:t}))})}function ir(e){var t;let i=null==(t=tV(e).media)?void 0:t.audioTracks;i&&(tV(i).trackSet.delete(e),queueMicrotask(()=>{i.dispatchEvent(new tF("removetrack",{track:e}))}))}ie=new WeakMap;var ia,is,io,il,iu,ic=class extends EventTarget{constructor(){super(),tb(this,il),tb(this,ia,void 0),tb(this,is,void 0),tb(this,io,void 0),tV(this).trackSet=new Set}[Symbol.iterator](){return ty(this,il,iu).values()}get length(){return ty(this,il,iu).size}getTrackById(e){var t;return null!=(t=[...ty(this,il,iu)].find(t=>t.id===e))?t:null}get onaddtrack(){return ty(this,ia)}set onaddtrack(e){ty(this,ia)&&(this.removeEventListener("addtrack",ty(this,ia)),t_(this,ia,void 0)),"function"==typeof e&&(t_(this,ia,e),this.addEventListener("addtrack",e))}get onremovetrack(){return ty(this,is)}set onremovetrack(e){ty(this,is)&&(this.removeEventListener("removetrack",ty(this,is)),t_(this,is,void 0)),"function"==typeof e&&(t_(this,is,e),this.addEventListener("removetrack",e))}get onchange(){return ty(this,io)}set onchange(e){ty(this,io)&&(this.removeEventListener("change",ty(this,io)),t_(this,io,void 0)),"function"==typeof e&&(t_(this,io,e),this.addEventListener("change",e))}};ia=new WeakMap,is=new WeakMap,io=new WeakMap,il=new WeakSet,iu=function(){return tV(this).trackSet};var id,ih=class{constructor(){tg(this,"id"),tg(this,"kind"),tg(this,"label",""),tg(this,"language",""),tg(this,"sourceBuffer"),tb(this,id,!1)}addRendition(e,t,i){var r;let n,a,s,o=new it;return o.src=e,o.codec=t,o.bitrate=i,r=this,n=tV(r).media.audioRenditions,tV(o).media=tV(r).media,tV(o).track=r,(a=tV(r).renditionSet).add(o),(s=a.size-1)in t9.prototype||Object.defineProperty(t9.prototype,s,{get(){return t4(this)[s]}}),queueMicrotask(()=>{r.enabled&&n.dispatchEvent(new tK("addrendition",{rendition:o}))}),o}removeRendition(e){let t,i;t=tV(e).media.audioRenditions,i=tV(e).track,tV(i).renditionSet.delete(e),queueMicrotask(()=>{tV(e).track.enabled&&t.dispatchEvent(new tK("removerendition",{rendition:e}))})}get enabled(){return ty(this,id)}set enabled(e){let t;ty(this,id)===e||(t_(this,id,e),(t=tV(this).media.audioTracks)&&!tV(t).changeRequested&&(tV(t).changeRequested=!0,queueMicrotask(()=>{delete tV(t).changeRequested,t.dispatchEvent(new Event("change"))})))}};id=new WeakMap;var ip=ig(globalThis.HTMLMediaElement,"video"),im=ig(globalThis.HTMLMediaElement,"audio");function ig(e,t){var i;if(null!=e&&e.prototype)return null==(i=Object.getOwnPropertyDescriptor(e.prototype,`${t}Tracks`))?void 0:i.get}tD.push("castchange","entercast","leavecast");var iv,iy,ib,i_,iE,iS,ix,iT,iw,iA=function(e){if(!(null!=e&&e.prototype))return e;let t=ig(e,"video");(!t||`${t}`.includes("[native code]"))&&Object.defineProperty(e.prototype,"videoTracks",{get(){return function(e){var t;let i=tV(e).videoTracks;if(!i&&(i=new tY,tV(e).videoTracks=i,ip)){let r=ip.call(null!=(t=e.nativeEl)?t:e);for(let t of r)tz(e,t);r.addEventListener("change",()=>{i.dispatchEvent(new Event("change"))}),r.addEventListener("addtrack",t=>{if([...i].some(e=>e instanceof t5)){for(let e of r)tj(e);return}tz(e,t.track)}),r.addEventListener("removetrack",e=>{tj(e.track)})}return i}(this)}});let i=ig(e,"audio");(!i||`${i}`.includes("[native code]"))&&Object.defineProperty(e.prototype,"audioTracks",{get(){return function(e){var t;let i=tV(e).audioTracks;if(!i&&(i=new ic,tV(e).audioTracks=i,im)){let r=im.call(null!=(t=e.nativeEl)?t:e);for(let t of r)ii(e,t);r.addEventListener("change",()=>{i.dispatchEvent(new Event("change"))}),r.addEventListener("addtrack",t=>{if([...i].some(e=>e instanceof ih)){for(let e of r)ir(e);return}ii(e,t.track)}),r.addEventListener("removetrack",e=>{ir(e.track)})}return i}(this)}}),"addVideoTrack"in e.prototype||(e.prototype.addVideoTrack=function(e,t="",i=""){let r=new t5;return r.kind=e,r.label=t,r.language=i,tz(this,r),r}),"removeVideoTrack"in e.prototype||(e.prototype.removeVideoTrack=tj),"addAudioTrack"in e.prototype||(e.prototype.addAudioTrack=function(e,t="",i=""){let r=new ih;return r.kind=e,r.label=t,r.language=i,ii(this,r),r}),"removeAudioTrack"in e.prototype||(e.prototype.removeAudioTrack=ir),"videoRenditions"in e.prototype||Object.defineProperty(e.prototype,"videoRenditions",{get(){return r(this)}});let r=e=>{let t=tV(e).videoRenditions;return t||(tV(t=new t0).media=e,tV(e).videoRenditions=t),t};"audioRenditions"in e.prototype||Object.defineProperty(e.prototype,"audioRenditions",{get(){return n(this)}});let n=e=>{let t=tV(e).audioRenditions;return t||(tV(t=new t9).media=e,tV(e).audioRenditions=t),t};return e}(tU(tR.HTMLElement,{tag:"video",is:"castable-video"})),iM={BEACON_COLLECTION_DOMAIN:"beacon-collection-domain",CUSTOM_DOMAIN:"custom-domain",DEBUG:"debug",DISABLE_COOKIES:"disable-cookies",ENV_KEY:"env-key",MAX_RESOLUTION:"max-resolution",METADATA_URL:"metadata-url",PLAYBACK_ID:"playback-id",PLAYER_SOFTWARE_NAME:"player-software-name",PLAYER_SOFTWARE_VERSION:"player-software-version",PREFER_CMCD:"prefer-cmcd",PREFER_PLAYBACK:"prefer-playback",START_TIME:"start-time",STREAM_TYPE:"stream-type",TARGET_LIVE_WINDOW:"target-live-window",LIVE_EDGE_OFFSET:"live-edge-offset",TYPE:"type"},iR=Object.values(iM),iC=class extends iA{constructor(){super(),tb(this,iT),tb(this,iv,void 0),tb(this,iy,void 0),tb(this,ib,void 0),tb(this,i_,{}),tb(this,iE,void 0),tb(this,iS,void 0),tb(this,ix,void 0),t_(this,ib,eJ())}static get observedAttributes(){var e;return[...iR,...null!=(e=iA.observedAttributes)?e:[]]}get preferCmcd(){var e;return null!=(e=this.getAttribute(iM.PREFER_CMCD))?e:void 0}set preferCmcd(e){e!==this.preferCmcd&&(e?ee.includes(e)?this.setAttribute(iM.PREFER_CMCD,e):console.warn(`Invalid value for preferCmcd. Must be one of ${ee.join()}`):this.removeAttribute(iM.PREFER_CMCD))}get playerInitTime(){return ty(this,ib)}get playerSoftwareName(){var e;return null!=(e=ty(this,iS))?e:"mux-video"}set playerSoftwareName(e){t_(this,iS,e)}get playerSoftwareVersion(){var e;return null!=(e=ty(this,iE))?e:tC}set playerSoftwareVersion(e){t_(this,iE,e)}get _hls(){var e;return null==(e=ty(this,iv))?void 0:e.engine}get mux(){return this.nativeEl.mux}get error(){var e;return null!=(e=e5(this.nativeEl))?e:null}get errorTranslator(){return ty(this,ix)}set errorTranslator(e){t_(this,ix,e)}get src(){return this.getAttribute("src")}set src(e){e!==this.src&&(null==e?this.removeAttribute("src"):this.setAttribute("src",e))}get type(){var e;return null!=(e=this.getAttribute(iM.TYPE))?e:void 0}set type(e){e!==this.type&&(e?this.setAttribute(iM.TYPE,e):this.removeAttribute(iM.TYPE))}get autoplay(){let e=this.getAttribute("autoplay");return null!==e&&(""===e||e)}set autoplay(e){e!==this.autoplay&&(e?this.setAttribute("autoplay","string"==typeof e?e:""):this.removeAttribute("autoplay"))}get preload(){let e=this.getAttribute("preload");return""===e?"auto":["none","metadata","auto"].includes(e)?e:super.preload}set preload(e){e!=this.getAttribute("preload")&&(["","none","metadata","auto"].includes(e)?this.setAttribute("preload",e):this.removeAttribute("preload"))}get debug(){return null!=this.getAttribute(iM.DEBUG)}set debug(e){e!==this.debug&&(e?this.setAttribute(iM.DEBUG,""):this.removeAttribute(iM.DEBUG))}get disableCookies(){return this.hasAttribute(iM.DISABLE_COOKIES)}set disableCookies(e){e!==this.disableCookies&&(e?this.setAttribute(iM.DISABLE_COOKIES,""):this.removeAttribute(iM.DISABLE_COOKIES))}get startTime(){let e=this.getAttribute(iM.START_TIME);if(null==e)return;let t=+e;return Number.isNaN(t)?void 0:t}set startTime(e){e!==this.startTime&&(null==e?this.removeAttribute(iM.START_TIME):this.setAttribute(iM.START_TIME,`${e}`))}get playbackId(){var e;return null!=(e=this.getAttribute(iM.PLAYBACK_ID))?e:void 0}set playbackId(e){e!==this.playbackId&&(e?this.setAttribute(iM.PLAYBACK_ID,e):this.removeAttribute(iM.PLAYBACK_ID))}get maxResolution(){var e;return null!=(e=this.getAttribute(iM.MAX_RESOLUTION))?e:void 0}set maxResolution(e){e!==this.maxResolution&&(e?this.setAttribute(iM.MAX_RESOLUTION,e):this.removeAttribute(iM.MAX_RESOLUTION))}get customDomain(){var e;return null!=(e=this.getAttribute(iM.CUSTOM_DOMAIN))?e:void 0}set customDomain(e){e!==this.customDomain&&(e?this.setAttribute(iM.CUSTOM_DOMAIN,e):this.removeAttribute(iM.CUSTOM_DOMAIN))}get ended(){return ti(this.nativeEl,this._hls)}get envKey(){var e;return null!=(e=this.getAttribute(iM.ENV_KEY))?e:void 0}set envKey(e){e!==this.envKey&&(e?this.setAttribute(iM.ENV_KEY,e):this.removeAttribute(iM.ENV_KEY))}get beaconCollectionDomain(){var e;return null!=(e=this.getAttribute(iM.BEACON_COLLECTION_DOMAIN))?e:void 0}set beaconCollectionDomain(e){e!==this.beaconCollectionDomain&&(e?this.setAttribute(iM.BEACON_COLLECTION_DOMAIN,e):this.removeAttribute(iM.BEACON_COLLECTION_DOMAIN))}get streamType(){var e;return null!=(e=this.getAttribute(iM.STREAM_TYPE))?e:e4(this.nativeEl)}set streamType(e){e!==this.streamType&&(e?this.setAttribute(iM.STREAM_TYPE,e):this.removeAttribute(iM.STREAM_TYPE))}get targetLiveWindow(){return this.hasAttribute(iM.TARGET_LIVE_WINDOW)?+this.getAttribute(iM.TARGET_LIVE_WINDOW):e6(this.nativeEl)}set targetLiveWindow(e){e!=this.targetLiveWindow&&(null==e?this.removeAttribute(iM.TARGET_LIVE_WINDOW):this.setAttribute(iM.TARGET_LIVE_WINDOW,`${+e}`))}get liveEdgeStart(){var e,t;if(this.hasAttribute(iM.LIVE_EDGE_OFFSET)){let{liveEdgeOffset:i}=this,r=null!=(e=this.nativeEl.seekable.end(0))?e:0;return Math.max(null!=(t=this.nativeEl.seekable.start(0))?t:0,r-i)}return e7(this.nativeEl)}get liveEdgeOffset(){if(this.hasAttribute(iM.LIVE_EDGE_OFFSET))return+this.getAttribute(iM.LIVE_EDGE_OFFSET)}set liveEdgeOffset(e){e!=this.targetLiveWindow&&(null==e?this.removeAttribute(iM.LIVE_EDGE_OFFSET):this.setAttribute(iM.LIVE_EDGE_OFFSET,`${+e}`))}get seekable(){return e8(this.nativeEl)}async addCuePoints(e){return ey(this.nativeEl,e)}get activeCuePoint(){return e_(this.nativeEl)}get cuePoints(){return function(e,t={label:em}){let i=ev(e,t);return null!=i&&i.cues?Array.from(i.cues,e=>eb(e)):[]}(this.nativeEl)}getStartDate(){return function(e,t){if(t){let i=t.playingDate;if(null!=i)return new Date(i.getTime()-1e3*e.currentTime)}return"function"==typeof e.getStartDate?e.getStartDate():new Date(NaN)}(this.nativeEl,this._hls)}get currentPdt(){return function(e,t){if(t&&t.playingDate)return t.playingDate;if("function"==typeof e.getStartDate){let t=e.getStartDate();return new Date(t.getTime()+1e3*e.currentTime)}return new Date(NaN)}(this.nativeEl,this._hls)}get preferPlayback(){let e=this.getAttribute(iM.PREFER_PLAYBACK);if(e===J.MSE||e===J.NATIVE)return e}set preferPlayback(e){e!==this.preferPlayback&&(e===J.MSE||e===J.NATIVE?this.setAttribute(iM.PREFER_PLAYBACK,e):this.removeAttribute(iM.PREFER_PLAYBACK))}get metadata(){return{...this.getAttributeNames().filter(e=>e.startsWith("metadata-")&&![iM.METADATA_URL].includes(e)).reduce((e,t)=>{let i=this.getAttribute(t);return null!=i&&(e[t.replace(/^metadata-/,"").replace(/-/g,"_")]=i),e},{}),...ty(this,i_)}}set metadata(e){t_(this,i_,null!=e?e:{}),this.mux&&this.mux.emit("hb",ty(this,i_))}load(){t_(this,iv,tr(this,this.nativeEl,ty(this,iv)))}unload(){tn(this.nativeEl,ty(this,iv)),t_(this,iv,void 0)}attributeChangedCallback(e,t,i){var r,n;switch(iA.observedAttributes.includes(e)&&!["src","autoplay","preload"].includes(e)&&super.attributeChangedCallback(e,t,i),e){case iM.PLAYER_SOFTWARE_NAME:this.playerSoftwareName=null!=i?i:void 0;break;case iM.PLAYER_SOFTWARE_VERSION:this.playerSoftwareVersion=null!=i?i:void 0;break;case"src":{let e=!!t,r=!!i;!e&&r?tE(this,iT,iw).call(this):e&&!r?this.unload():e&&r&&(this.unload(),tE(this,iT,iw).call(this));break}case"autoplay":if(i===t)break;null==(r=ty(this,iv))||r.setAutoplay(this.autoplay);break;case"preload":if(i===t)break;null==(n=ty(this,iv))||n.setPreload(i);break;case iM.PLAYBACK_ID:this.src=e0(null!=i?i:void 0,{maxResolution:this.maxResolution,domain:this.customDomain});break;case iM.DEBUG:{let e=this.debug;this.mux&&console.info("Cannot toggle debug mode of mux data after initialization. Make sure you set all metadata to override before setting the src."),this._hls&&(this._hls.config.debug=e);break}case iM.METADATA_URL:i&&fetch(i).then(e=>e.json()).then(e=>this.metadata=e).catch(()=>console.error(`Unable to load or parse metadata JSON from metadata-url ${i}!`));break;case iM.STREAM_TYPE:(null==i||i!==t)&&this.dispatchEvent(new CustomEvent("streamtypechange",{composed:!0,bubbles:!0}));break;case iM.TARGET_LIVE_WINDOW:(null==i||i!==t)&&this.dispatchEvent(new CustomEvent("targetlivewindowchange",{composed:!0,bubbles:!0,detail:this.targetLiveWindow}))}}disconnectedCallback(){this.unload()}};iv=new WeakMap,iy=new WeakMap,ib=new WeakMap,i_=new WeakMap,iE=new WeakMap,iS=new WeakMap,ix=new WeakMap,iT=new WeakSet,iw=async function(){ty(this,iy)||(await t_(this,iy,Promise.resolve()),t_(this,iy,null),this.load())},tR.customElements.get("mux-video")||(tR.customElements.define("mux-video",iC),tR.MuxVideoElement=iC);var iI=i(36488),iL=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},ik=(e,t,i)=>(iL(e,t,"read from private field"),i?i.call(e):t.get(e)),iD=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},iP=(e,t,i,r)=>(iL(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),iO=(e,t,i)=>(iL(e,t,"access private method"),i),iN=class{addEventListener(){}removeEventListener(){}dispatchEvent(e){return!0}};"undefined"==typeof DocumentFragment&&(globalThis.DocumentFragment=class extends iN{});var iU,iF=class extends iN{},iB=class{constructor(e,t={}){iD(this,iU,void 0),iP(this,iU,null==t?void 0:t.detail)}get detail(){return ik(this,iU)}initCustomEvent(){}};iU=new WeakMap;var iV={document:{createElement:function(e,t){return new iF}},DocumentFragment,customElements:{get(e){},define(e,t,i){},upgrade(e){},whenDefined:e=>Promise.resolve(iF)},CustomEvent:iB,EventTarget:iN,HTMLElement:iF,HTMLVideoElement:class extends iN{}},iz="undefined"==typeof window||void 0===globalThis.customElements,ij=iz?iV:globalThis,iH=iz?iV.document:globalThis.document,iG={code:"en"};function iW(e,t=!0){var i;let r=t&&null!=(i=null==iG?void 0:iG[e])?i:e,n=t?iG.code:"en";return new i$(r,n)}var i$=class{constructor(e,t=null!=(iJ=iG.code)?iJ:"en"){this.message=e,this.locale=t}format(e){return this.message.replace(/\{(\w+)\}/g,(t,i)=>{var r;return null!=(r=e[i])?r:""})}toString(){return this.message}};function iq(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function iY(e){return e.replace(/[-_]([a-z])/g,(e,t)=>t.toUpperCase())}function iK(e){if(null==e)return;let t=+e;return Number.isNaN(t)?void 0:t}function iX(e){let t=(function(e){let t={};for(let i in e)null!=e[i]&&(t[i]=e[i]);return new URLSearchParams(t)})(e).toString();return t?"?"+t:""}function iZ(e){let t=(null!=e?e:"").split(".")[1];return t?JSON.parse(decodeURIComponent(atob(t.replace(/-/g,"+").replace(/_/g,"/")).split("").map(function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)}).join(""))):{}}var iJ,iQ,i0,i1,i2=(e,t)=>!!e&&!!t&&(!!e.contains(t)||i2(e,t.getRootNode().host)),i3="mux.com",i5=(()=>{try{return"1.12.1"}catch{}return"UNKNOWN"})(),i4=(e,{maxResolution:t,token:i,domain:r=i3}={})=>`https://stream.${r}/${e}.m3u8${iX(i?{token:i}:{redundant_streams:!0,...t?{max_resolution:t}:{}})}`,i6=(e,{token:t,thumbnailTime:i,domain:r=i3}={})=>{let n=null==t?i:void 0,{aud:a}=iZ(t);if(!(t&&"t"!==a))return`https://image.${r}/${e}/thumbnail.webp${iX({token:t,time:n})}`},i8=(e,{token:t,domain:i=i3}={})=>{let{aud:r}=iZ(t);if(!(t&&"s"!==r))return`https://image.${i}/${e}/storyboard.vtt${iX({token:t,format:"webp"})}`},i7=e=>{if(e){if([Z.LIVE,Z.ON_DEMAND].includes(e))return e;if(null!=e&&e.includes("live"))return Z.LIVE}},i9={crossorigin:"crossOrigin",playsinline:"playsInline"},re=class{constructor(e,t){iD(this,iQ,void 0),iD(this,i0,void 0),iD(this,i1,[]),iP(this,iQ,e),iP(this,i0,t)}[Symbol.iterator](){return ik(this,i1).values()}get length(){return ik(this,i1).length}get value(){var e;return null!=(e=ik(this,i1).join(" "))?e:""}set value(e){var t;e!==this.value&&(iP(this,i1,[]),this.add(...null!=(t=null==e?void 0:e.split(" "))?t:[]))}toString(){return this.value}item(e){return ik(this,i1)[e]}values(){return ik(this,i1).values()}keys(){return ik(this,i1).keys()}forEach(e){ik(this,i1).forEach(e)}add(...e){var t,i;e.forEach(e=>{this.contains(e)||ik(this,i1).push(e)}),(""!==this.value||null!=(t=ik(this,iQ))&&t.hasAttribute(`${ik(this,i0)}`))&&null!=(i=ik(this,iQ))&&i.setAttribute(`${ik(this,i0)}`,`${this.value}`)}remove(...e){var t;e.forEach(e=>{ik(this,i1).splice(ik(this,i1).indexOf(e),1)}),null==(t=ik(this,iQ))||t.setAttribute(`${ik(this,i0)}`,`${this.value}`)}contains(e){return ik(this,i1).includes(e)}toggle(e,t){return void 0!==t?t?(this.add(e),!0):(this.remove(e),!1):this.contains(e)?(this.remove(e),!1):(this.add(e),!0)}replace(e,t){this.remove(e),this.add(t)}};iQ=new WeakMap,i0=new WeakMap,i1=new WeakMap;var rt=`[mux-player ${i5}]`;function ri(...e){console.warn(rt,...e)}function rr(...e){console.error(rt,...e)}function rn(e){var t;let i=null!=(t=e.message)?t:"";e.context&&(i+=` ${e.context}`),e.file&&(i+=` ${iW("Read more: ")}
https://github.com/muxinc/elements/blob/main/errors/${e.file}`),ri(i)}var ra={AUTOPLAY:"autoplay",CROSSORIGIN:"crossorigin",LOOP:"loop",MUTED:"muted",PLAYSINLINE:"playsinline",PRELOAD:"preload"},rs={VOLUME:"volume",PLAYBACKRATE:"playbackrate",MUTED:"muted"},ro=Object.freeze({length:0,start(e){let t=e>>>0;if(t>=this.length)throw new DOMException(`Failed to execute 'start' on 'TimeRanges': The index provided (${t}) is greater than or equal to the maximum bound (${this.length}).`);return 0},end(e){let t=e>>>0;if(t>=this.length)throw new DOMException(`Failed to execute 'end' on 'TimeRanges': The index provided (${t}) is greater than or equal to the maximum bound (${this.length}).`);return 0}}),rl=tD.filter(e=>"error"!==e),ru=Object.values(ra).filter(e=>![ra.PLAYSINLINE].includes(e)),rc=Object.values(rs);function rd(e,t){return e.media?e.media.getAttribute(t):e.getAttribute(t)}var rh=class extends ij.HTMLElement{static get observedAttributes(){return[...ru,...rc]}constructor(){super(),this.querySelectorAll(":scope > track").forEach(e=>{var t;null==(t=this.media)||t.append(e.cloneNode())}),new MutationObserver(e=>{for(let t of e)"childList"===t.type&&(t.removedNodes.forEach(e=>{var t,i;let r=null==(t=this.media)?void 0:t.querySelector(`track[src="${e.src}"]`);r&&(null==(i=this.media)||i.removeChild(r))}),t.addedNodes.forEach(e=>{var t;null==(t=this.media)||t.append(e.cloneNode())}))}).observe(this,{childList:!0,subtree:!0})}attributeChangedCallback(e,t,i){var r,n;switch(e){case rs.MUTED:this.media&&(this.media.muted=null!=i,this.media.defaultMuted=null!=i);return;case rs.VOLUME:{let e=null!=(r=iK(i))?r:1;this.media&&(this.media.volume=e);return}case rs.PLAYBACKRATE:{let e=null!=(n=iK(i))?n:1;this.media&&(this.media.playbackRate=e,this.media.defaultPlaybackRate=e);return}}}play(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.play())?t:Promise.reject()}pause(){var e;null==(e=this.media)||e.pause()}requestCast(e){var t;return null==(t=this.media)?void 0:t.requestCast(e)}get media(){var e;return null==(e=this.shadowRoot)?void 0:e.querySelector("mux-video")}get audioTracks(){return this.media.audioTracks}get videoTracks(){return this.media.videoTracks}get audioRenditions(){return this.media.audioRenditions}get videoRenditions(){return this.media.videoRenditions}get paused(){var e,t;return null==(t=null==(e=this.media)?void 0:e.paused)||t}get duration(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.duration)?t:NaN}get ended(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.ended)&&t}get buffered(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.buffered)?t:ro}get seekable(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.seekable)?t:ro}get readyState(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.readyState)?t:0}get videoWidth(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.videoWidth)?t:0}get videoHeight(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.videoHeight)?t:0}get currentTime(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.currentTime)?t:0}set currentTime(e){this.media&&(this.media.currentTime=Number(e))}get volume(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.volume)?t:1}set volume(e){this.media&&(this.media.volume=Number(e))}get playbackRate(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.playbackRate)?t:1}set playbackRate(e){this.media&&(this.media.playbackRate=Number(e))}get defaultPlaybackRate(){var e;return null!=(e=iK(this.getAttribute(rs.PLAYBACKRATE)))?e:1}set defaultPlaybackRate(e){null!=e?this.setAttribute(rs.PLAYBACKRATE,`${e}`):this.removeAttribute(rs.PLAYBACKRATE)}get crossOrigin(){return rd(this,ra.CROSSORIGIN)}set crossOrigin(e){this.setAttribute(ra.CROSSORIGIN,`${e}`)}get autoplay(){return null!=rd(this,ra.AUTOPLAY)}set autoplay(e){e?this.setAttribute(ra.AUTOPLAY,"string"==typeof e?e:""):this.removeAttribute(ra.AUTOPLAY)}get loop(){return null!=rd(this,ra.LOOP)}set loop(e){e?this.setAttribute(ra.LOOP,""):this.removeAttribute(ra.LOOP)}get muted(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.muted)&&t}set muted(e){this.media&&(this.media.muted=!!e)}get defaultMuted(){return null!=rd(this,ra.MUTED)}set defaultMuted(e){e?this.setAttribute(ra.MUTED,""):this.removeAttribute(ra.MUTED)}get playsInline(){return null!=rd(this,ra.PLAYSINLINE)}set playsInline(e){rr("playsInline is set to true by default and is not currently supported as a setter.")}get preload(){return this.media?this.media.preload:this.getAttribute("preload")}set preload(e){["","none","metadata","auto"].includes(e)?this.setAttribute(ra.PRELOAD,e):this.removeAttribute(ra.PRELOAD)}},rf=`:host {
  --media-control-display: var(--controls);
  --media-loading-indicator-display: var(--loading-indicator);
  --media-dialog-display: var(--dialog);
  --media-play-button-display: var(--play-button);
  --media-live-button-display: var(--live-button);
  --media-seek-backward-button-display: var(--seek-backward-button);
  --media-seek-forward-button-display: var(--seek-forward-button);
  --media-mute-button-display: var(--mute-button);
  --media-captions-button-display: var(--captions-button);
  --media-captions-selectmenu-display: var(--captions-selectmenu, var(--media-captions-button-display));
  --media-rendition-selectmenu-display: var(--rendition-selectmenu);
  --media-airplay-button-display: var(--airplay-button);
  --media-pip-button-display: var(--pip-button);
  --media-fullscreen-button-display: var(--fullscreen-button);
  --media-cast-button-display: var(--cast-button);
  --media-playback-rate-button-display: var(--playback-rate-button);
  --media-volume-range-display: var(--volume-range);
  --media-time-range-display: var(--time-range);
  --media-time-display-display: var(--time-display);
  --media-duration-display-display: var(--duration-display);
  --media-title-display-display: var(--title-display);

  display: inline-block;
  width: 100%;
}

/* Hide custom elements that are not defined yet */
:not(:defined) {
  display: none;
}

a {
  color: #fff;
  font-size: 0.9em;
  text-decoration: underline;
}

media-theme {
  width: 100%;
  height: 100%;
  direction: ltr;
}

::part(top),
[part~='top'] {
  --media-control-display: var(--controls, var(--top-controls));
  --media-play-button-display: var(--play-button, var(--top-play-button));
  --media-live-button-display: var(--live-button, var(--top-live-button));
  --media-seek-backward-button-display: var(--seek-backward-button, var(--top-seek-backward-button));
  --media-seek-forward-button-display: var(--seek-forward-button, var(--top-seek-forward-button));
  --media-mute-button-display: var(--mute-button, var(--top-mute-button));
  --media-captions-button-display: var(--captions-button, var(--top-captions-button));
  --media-captions-selectmenu-display: var(
    --captions-selectmenu,
    var(--media-captions-button-display, var(--top-captions-selectmenu))
  );
  --media-rendition-selectmenu-display: var(--rendition-selectmenu, var(--top-rendition-selectmenu));
  --media-airplay-button-display: var(--airplay-button, var(--top-airplay-button));
  --media-pip-button-display: var(--pip-button, var(--top-pip-button));
  --media-fullscreen-button-display: var(--fullscreen-button, var(--top-fullscreen-button));
  --media-cast-button-display: var(--cast-button, var(--top-cast-button));
  --media-playback-rate-button-display: var(--playback-rate-button, var(--top-playback-rate-button));
  --media-volume-range-display: var(--volume-range, var(--top-volume-range));
  --media-time-range-display: var(--time-range, var(--top-time-range));
  --media-time-display-display: var(--time-display, var(--top-time-display));
  --media-duration-display-display: var(--duration-display, var(--top-duration-display));
  --media-title-display-display: var(--title-display, var(--top-title-display));
}

::part(center),
[part~='center'] {
  --media-control-display: var(--controls, var(--center-controls));
  --media-play-button-display: var(--play-button, var(--center-play-button));
  --media-live-button-display: var(--live-button, var(--center-live-button));
  --media-seek-backward-button-display: var(--seek-backward-button, var(--center-seek-backward-button));
  --media-seek-forward-button-display: var(--seek-forward-button, var(--center-seek-forward-button));
  --media-mute-button-display: var(--mute-button, var(--center-mute-button));
  --media-captions-button-display: var(--captions-button, var(--center-captions-button));
  --media-captions-selectmenu-display: var(
    --captions-selectmenu,
    var(--media-captions-button-display, var(--center-captions-selectmenu))
  );
  --media-rendition-selectmenu-display: var(--rendition-selectmenu, var(--center-rendition-selectmenu));
  --media-airplay-button-display: var(--airplay-button, var(--center-airplay-button));
  --media-pip-button-display: var(--pip-button, var(--center-pip-button));
  --media-fullscreen-button-display: var(--fullscreen-button, var(--center-fullscreen-button));
  --media-cast-button-display: var(--cast-button, var(--center-cast-button));
  --media-playback-rate-button-display: var(--playback-rate-button, var(--center-playback-rate-button));
  --media-volume-range-display: var(--volume-range, var(--center-volume-range));
  --media-time-range-display: var(--time-range, var(--center-time-range));
  --media-time-display-display: var(--time-display, var(--center-time-display));
  --media-duration-display-display: var(--duration-display, var(--center-duration-display));
}

::part(bottom),
[part~='bottom'] {
  --media-control-display: var(--controls, var(--bottom-controls));
  --media-play-button-display: var(--play-button, var(--bottom-play-button));
  --media-live-button-display: var(--live-button, var(--bottom-live-button));
  --media-seek-backward-button-display: var(--seek-backward-button, var(--bottom-seek-backward-button));
  --media-seek-forward-button-display: var(--seek-forward-button, var(--bottom-seek-forward-button));
  --media-mute-button-display: var(--mute-button, var(--bottom-mute-button));
  --media-captions-button-display: var(--captions-button, var(--bottom-captions-button));
  --media-captions-selectmenu-display: var(
    --captions-selectmenu,
    var(--media-captions-button-display, var(--bottom-captions-selectmenu))
  );
  --media-rendition-selectmenu-display: var(--rendition-selectmenu, var(--bottom-rendition-selectmenu));
  --media-airplay-button-display: var(--airplay-button, var(--bottom-airplay-button));
  --media-pip-button-display: var(--pip-button, var(--bottom-pip-button));
  --media-fullscreen-button-display: var(--fullscreen-button, var(--bottom-fullscreen-button));
  --media-cast-button-display: var(--cast-button, var(--bottom-cast-button));
  --media-playback-rate-button-display: var(--playback-rate-button, var(--bottom-playback-rate-button));
  --media-volume-range-display: var(--volume-range, var(--bottom-volume-range));
  --media-time-range-display: var(--time-range, var(--bottom-time-range));
  --media-time-display-display: var(--time-display, var(--bottom-time-display));
  --media-duration-display-display: var(--duration-display, var(--bottom-duration-display));
  --media-title-display-display: var(--title-display, var(--bottom-title-display));
}
`,rp=`
  :host {
    z-index: 100;
    display: var(--media-dialog-display, flex);
    justify-content: center;
    align-items: center;
    width: 100%;
    height: 100%;
    position: absolute;
    top: 0;
    left: 0;
    box-sizing: border-box;
    color: #fff;
    line-height: 18px;
    font-family: Arial, sans-serif;
    padding: var(--media-dialog-backdrop-padding, 0);
    background: var(--media-dialog-backdrop-background,
      linear-gradient(to bottom, rgba(20, 20, 30, 0.7) 50%, rgba(20, 20, 30, 0.9))
    );
    /* Needs to use !important to prevent overwrite of media-chrome */
    transition: var(--media-dialog-transition-open, visibility .2s, opacity .2s) !important;
    transform: var(--media-dialog-transform-open, none) !important;
    visibility: visible !important;
    opacity: 1 !important;
    pointer-events: auto !important;
  }

  :host(:not([open])) {
    /* Needs to use !important to prevent overwrite of media-chrome */
    transition: var(--media-dialog-transition-close, visibility .1s, opacity .1s) !important;
    transform: var(--media-dialog-transform-close, none) !important;
    visibility: hidden !important;
    opacity: 0 !important;
    pointer-events: none !important;
  }

  :focus-visible {
    box-shadow: 0 0 0 2px rgba(27, 127, 204, 0.9);
  }

  .dialog {
    position: relative;
    box-sizing: border-box;
    background: var(--media-dialog-background, none);
    padding: var(--media-dialog-padding, 10px);
    width: min(320px, 100%);
    word-wrap: break-word;
    max-height: 100%;
    overflow: auto;
    text-align: center;
    line-height: 1.4;
  }
`,rm=iH.createElement("template");rm.innerHTML=`
  <style>
    ${rp}
  </style>

  <div class="dialog">
    <slot></slot>
  </div>
`;var rg=class extends ij.HTMLElement{constructor(){var e;super(),this.attachShadow({mode:"open"}),null==(e=this.shadowRoot)||e.appendChild(this.constructor.template.content.cloneNode(!0))}show(){this.setAttribute("open",""),this.dispatchEvent(new CustomEvent("open",{composed:!0,bubbles:!0})),rv(this)}close(){this.hasAttribute("open")&&(this.removeAttribute("open"),this.dispatchEvent(new CustomEvent("close",{composed:!0,bubbles:!0})),this._previouslyFocusedElement instanceof HTMLElement&&this._previouslyFocusedElement.focus())}attributeChangedCallback(e,t,i){"open"===e&&t!==i&&(null!=i?this.show():this.close())}connectedCallback(){this.hasAttribute("role")||this.setAttribute("role","dialog"),this.hasAttribute("open")&&rv(this)}};function rv(e){let t=new CustomEvent("initfocus",{composed:!0,bubbles:!0,cancelable:!0});if(e.dispatchEvent(t),t.defaultPrevented)return;let i=e.querySelector("[autofocus]:not([disabled])");!i&&e.tabIndex>=0&&(i=e),i||(i=function e(t){let i=["button","input","keygen","select","textarea"].map(function(e){return e+":not([disabled])"});i.push('[tabindex]:not([disabled]):not([tabindex=""])');let r=null==t?void 0:t.querySelector(i.join(", "));if(!r&&"attachShadow"in Element.prototype){let i=(null==t?void 0:t.querySelectorAll("*"))||[];for(let t=0;t<i.length&&!(i[t].tagName&&i[t].shadowRoot&&(r=e(i[t].shadowRoot)));t++);}return r}(e.shadowRoot)),e._previouslyFocusedElement=iH.activeElement,iH.activeElement instanceof HTMLElement&&iH.activeElement.blur(),e.addEventListener("transitionend",()=>{i instanceof HTMLElement&&i.focus({preventScroll:!0})},{once:!0})}rg.styles=rp,rg.template=rm,rg.observedAttributes=["open"],ij.customElements.get("media-dialog")||(ij.customElements.define("media-dialog",rg),ij.MediaDialog=rg);var ry=rg,rb=iH.createElement("template");rb.innerHTML=`
  <style>
    ${ry.styles}

    .close {
      background: none;
      color: inherit;
      border: none;
      padding: 0;
      font: inherit;
      cursor: pointer;
      outline: inherit;
      width: 28px;
      height: 28px;
      position: absolute;
      top: 1rem;
      right: 1rem;
    }
  </style>

  <div class="dialog">
    <slot></slot>
  </div>

  <slot name="close">
    <button class="close" tabindex="0">
      <svg fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
      </svg>
    </button>
  </slot>
`;var r_=class extends ry{constructor(){var e,t;super(),null==(t=null==(e=this.shadowRoot)?void 0:e.querySelector(".close"))||t.addEventListener("click",()=>{this.close()})}};r_.template=rb,ij.customElements.get("mxp-dialog")||(ij.customElements.define("mxp-dialog",r_),ij.MxpDialog=r_);var rE=new WeakMap,rS=class{constructor(e,t){this.element=e,this.type=t,this.element.addEventListener(this.type,this);let i=rE.get(this.element);i&&i.set(this.type,this)}set(e){if("function"==typeof e)this.handleEvent=e.bind(this.element);else if("object"==typeof e&&"function"==typeof e.handleEvent)this.handleEvent=e.handleEvent.bind(e);else{this.element.removeEventListener(this.type,this);let e=rE.get(this.element);e&&e.delete(this.type)}}static for(e){rE.has(e.element)||rE.set(e.element,new Map);let t=e.attributeName.slice(2),i=rE.get(e.element);return i&&i.has(t)?i.get(t):new rS(e.element,t)}},rx=new Map,rT=new WeakMap,rw=new WeakMap,rA=class{constructor(e,t,i){this.strings=e,this.values=t,this.processor=i,this.stringsKey=this.strings.join("\x01")}get template(){if(rx.has(this.stringsKey))return rx.get(this.stringsKey);{let e=iH.createElement("template"),t=this.strings.length-1;return e.innerHTML=this.strings.reduce((e,i,r)=>e+i+(r<t?`{{ ${r} }}`:""),""),rx.set(this.stringsKey,e),e}}renderInto(e){var t;let i=this.template;if(rT.get(e)!==i){rT.set(e,i);let t=new iI.R(i,this.values,this.processor);rw.set(e,t),e instanceof iI.X5?e.replace(...t.children):e.appendChild(t);return}let r=rw.get(e);null==(t=null==r?void 0:r.update)||t.call(r,this.values)}},rM={processCallback(e,t,i){var r,n,a;if(i)for(let[e,s]of t){e in i&&(function(e,t){if(e instanceof iI.cf&&t instanceof Element){let i=e.element;return i[e.attributeName]!==t&&(e.element.removeAttributeNS(e.attributeNamespace,e.attributeName),i[e.attributeName]=t),!0}return!1}(n=s,a=null!=(r=i[e])?r:"")||function(e,t){if("boolean"==typeof t&&e instanceof iI.cf){let i=e.attributeNamespace,r=e.element.hasAttributeNS(i,e.attributeName);return t!==r&&(e.booleanValue=t),!0}return!1}(n,a)||n instanceof iI.cf&&n.attributeName.startsWith("on")&&(rS.for(n).set(a),n.element.removeAttributeNS(n.attributeNamespace,n.attributeName),1)||!1===a&&n instanceof iI.X5&&(n.replace(""),1)||a instanceof rA&&n instanceof iI.X5&&(a.renderInto(n),1)||a instanceof DocumentFragment&&n instanceof iI.X5&&(a.childNodes.length&&n.replace(...a.childNodes),1)||function(e,t){if(e instanceof iI.cf){let i=e.attributeNamespace,r=e.element.getAttributeNS(i,e.attributeName);return String(t)!==r&&(e.value=String(t))}e.value=String(t)}(n,a))}}};function rR(e,...t){return new rA(e,t,rM)}var rC=e=>rR`
  <style>
    ${rf}
  </style>
  ${rL(e)}
`,rI=e=>{let t=e.hotKeys?`${e.hotKeys}`:"";return"live"===i7(e.streamType)&&(t+=" noarrowleft noarrowright"),t},rL=e=>{var t,i,r,n,a,s,o,l,u,c,d,h,f,p,m,g,v,y,b,_,E,S,x,T,w,A,M,R,C,I,L,k,D,P,O;let N;return rR`
  <media-theme
    template="${e.themeTemplate||!1}"
    defaultstreamtype="${null!=(t=e.defaultStreamType)&&t}"
    hotkeys="${rI(e)||!1}"
    nohotkeys="${e.noHotKeys||!e.hasSrc||e.isDialogOpen||!1}"
    noautoseektolive="${!!(null!=(i=e.streamType)&&i.includes(Z.LIVE))&&0!==e.targetLiveWindow}"
    novolumepref="${e.novolumepref||!1}"
    disabled="${!e.hasSrc||e.isDialogOpen}"
    audio="${null!=(r=e.audio)&&r}"
    style="${null!=(O={"--media-primary-color":e.primaryColor,"--media-secondary-color":e.secondaryColor},N="",Object.entries(O).forEach(([e,t])=>{null!=t&&(N+=`${iq(e)}: ${t}; `)}),n=N?N.trim():void 0)&&n}"
    defaultsubtitles="${!e.defaultHiddenCaptions}"
    forwardseekoffset="${null!=(a=e.forwardSeekOffset)&&a}"
    backwardseekoffset="${null!=(s=e.backwardSeekOffset)&&s}"
    playbackrates="${null!=(o=e.playbackRates)&&o}"
    defaultshowremainingtime="${null!=(l=e.defaultShowRemainingTime)&&l}"
    hideduration="${null!=(u=e.hideDuration)&&u}"
    title="${null!=(c=e.title)&&c}"
    exportparts="top, center, bottom, layer, media-layer, poster-layer, vertical-layer, centered-layer, gesture-layer, controller, poster, live, play, button, seek-backward, seek-forward, mute, captions, airplay, pip, fullscreen, cast, playback-rate, volume, range, time, display"
  >
    <mux-video
      slot="media"
      target-live-window="${null!=(d=e.targetLiveWindow)&&d}"
      stream-type="${null!=(h=i7(e.streamType))&&h}"
      crossorigin="${null!=(f=e.crossOrigin)?f:""}"
      playsinline
      autoplay="${null!=(p=e.autoplay)&&p}"
      muted="${null!=(m=e.muted)&&m}"
      loop="${null!=(g=e.loop)&&g}"
      preload="${null!=(v=e.preload)&&v}"
      debug="${null!=(y=e.debug)&&y}"
      prefer-cmcd="${null!=(b=e.preferCmcd)&&b}"
      disable-cookies="${null!=(_=e.disableCookies)&&_}"
      prefer-playback="${null!=(E=e.preferPlayback)&&E}"
      start-time="${null!=e.startTime&&e.startTime}"
      beacon-collection-domain="${null!=(S=e.beaconCollectionDomain)&&S}"
      player-software-name="${null!=(x=e.playerSoftwareName)&&x}"
      player-software-version="${null!=(T=e.playerSoftwareVersion)&&T}"
      env-key="${null!=(w=e.envKey)&&w}"
      custom-domain="${null!=(A=e.customDomain)&&A}"
      src="${e.src?e.src:!!e.playbackId&&i4(e.playbackId,{maxResolution:e.maxResolution,domain:e.customDomain,token:e.tokens.playback})}"
      cast-src="${e.src?e.src:!!e.playbackId&&i4(e.playbackId,{maxResolution:e.maxResolution,domain:e.customDomain,token:e.tokens.playback})}"
      exportparts="video"
    >
      ${e.storyboard?rR`<track label="thumbnails" default kind="metadata" src="${e.storyboard}" />`:rR``}
    </mux-video>
    <media-poster-image
      slot="poster"
      part="poster"
      exportparts="poster, img"
      src="${""!==e.poster&&null!=(M=e.poster)&&M}"
      placeholder-src="${null!=(R=e.placeholder)&&R}"
    ></media-poster-image>
    <mxp-dialog
      no-auto-hide
      open="${null!=(C=e.isDialogOpen)&&C}"
      onclose="${e.onCloseErrorDialog}"
      oninitfocus="${e.onInitFocusDialog}"
    >
      ${null!=(I=e.dialog)&&I.title?rR`<h3>${e.dialog.title}</h3>`:rR``}
      <p>
        ${null==(L=e.dialog)?void 0:L.message}
        ${null!=(k=e.dialog)&&k.linkUrl?rR`<a
              href="${e.dialog.linkUrl}"
              target="_blank"
              rel="external noopener"
              aria-label="${null!=(D=e.dialog.linkText)?D:""} ${iW("(opens in a new window)")}"
              >${null!=(P=e.dialog.linkText)?P:e.dialog.linkUrl}</a
            >`:rR``}
      </p>
    </mxp-dialog>
  </media-theme>
`};function rk(e,t,i,r,n){var a,s,o;let l={},u={};switch(e.code){case q.MEDIA_ERR_NETWORK:switch(l.title=iW("Network Error",n),l.message=e.message,null==(a=e.data)?void 0:a.response.code){case 412:l.title=iW("Video is not currently available",n),l.message=iW("The live stream or video file are not yet ready.",n),u.message=iW("This playback-id may belong to a live stream that is not currently active or an asset that is not ready.",n),u.file="412-not-playable.md";break;case 404:l.title=iW("Video does not exist",n),l.message="",u.message=iW("This playback-id does not exist. You may have used an Asset ID or an ID from a different resource.",n),u.file="404-not-found.md";break;case 403:{if(l.title=iW("Invalid playback URL",n),l.message=iW("The video URL or playback-token are formatted with incorrect or incomplete information.",n),u.message=iW("403 error trying to access this playback URL. If this is a signed URL, you might need to provide a playback-token.",n),u.file="missing-signed-tokens.md",!r)break;let{exp:e,aud:t,sub:a}=iZ(r),s=Date.now()>1e3*e,o=a!==i,c="v"!==t,d={};if(s){l.title=iW("Video URL has expired",n),l.message=iW("The video’s secured playback-token has expired.",n),u.message=iW("The video’s secured playback-token has expired.",n),u.context=iW("Expired at: {expiredDate}. Current time: {currentDate}.",n).format({expiredDate:new Intl.DateTimeFormat(iG.code,d).format(1e3*e),currentDate:new Intl.DateTimeFormat(iG.code,d).format(Date.now())}),u.file="403-expired-token.md";break}if(o){l.title=iW("Video URL is formatted incorrectly",n),l.message=iW("The video’s playback ID does not match the one encoded in the playback-token.",n),u.message=iW("The video’s playback ID does not match the one encoded in the playback-token.",n),u.context=iW("Specified playback ID: {playbackId} and the playback ID encoded in the playback-token: {tokenPlaybackId}",n).format({playbackId:i,tokenPlaybackId:a}),u.file="403-playback-id-mismatch.md";break}if(c){l.title=iW("Video URL is formatted incorrectly",n),l.message=iW("The playback-token is formatted with incorrect information.",n),u.message=iW("The playback-token is formatted with incorrect information.",n),u.context=iW("The playback-token has an incorrect aud value: {tokenType}. aud value should be v.",n).format({tokenType:t}),u.file="403-incorrect-aud-value.md";break}u.message=iW("403 error trying to access this playback URL. If this is a signed playback ID, the token might not have been generated correctly.",n),u.file="403-malformatted-token.md"}}break;case q.MEDIA_ERR_DECODE:{let{message:t}=e;l={title:iW("Media Error",n),message:t},u.file="media-decode-error.md";break}case q.MEDIA_ERR_SRC_NOT_SUPPORTED:{let a=null==(o=null==(s=e.data)?void 0:s.response)?void 0:o.code;if(a>=400&&a<500){e.code=q.MEDIA_ERR_NETWORK,e.data={response:{code:a}},{dialog:l,devlog:u}=rk(e,t,i,r);break}l={title:iW("Source Not Supported",n),message:e.message},u.file="media-src-not-supported.md";break}default:l={title:iW("Error",n),message:e.message}}return t&&(l={title:iW("Your device appears to be offline",n),message:iW("Check your internet connection and try reloading this video.",n)}),{dialog:l,devlog:u}}var rD=`<!-- prettier-ignore -->
<template id="media-theme-classic">
  <style>
    :host {
      --_primary-color: var(--media-primary-color, white);
      --_secondary-color: var(--media-secondary-color, rgb(0 0 0 / .75));

      --media-icon-color: var(--_primary-color);
      --media-range-thumb-background: var(--_primary-color);
      --media-range-bar-color: var(--_primary-color);
      --media-control-background: var(--_secondary-color);
      --media-control-hover-background: var(--_secondary-color);
      --media-time-range-buffered-color: rgba(255, 255, 255, 0.4);
      --media-range-track-background:
        linear-gradient(rgba(255, 255, 255, 0.5), rgba(255, 255, 255, 0.5)),
        linear-gradient(rgba(20, 20, 30, 0.7), rgba(20, 20, 30, 0.7));
      --media-preview-thumbnail-border: 0;
      --media-preview-thumbnail-border-radius: 2px 2px 0 0;
      --media-preview-time-border-radius: 0 0 2px 2px;
      --media-preview-time-margin: 0 0 8px;
      --media-preview-time-text-shadow: none;
      --media-listbox-border-radius: 2px;
      --media-listbox-transform-in: translateY(-8px) scale(1);
      --media-listbox-transform-out: translateY(-6px) scale(.99);
      --media-option-hover-background: rgba(255, 255, 255, 0.28);

      color: var(--_primary-color);
      display: inline-block;
      width: 100%;
      height: 100%;
    }

    :host([audio]) {
      --media-preview-time-border-radius: 3px;
      --media-preview-time-margin: 0 0 5px;
      --media-preview-time-text-shadow: none;
    }

    :host([audio]) ::slotted([slot='media']) {
      height: 0px;
    }

    :host([audio]) media-loading-indicator,
    :host([audio]) ::slotted([slot=poster]) {
      display: none;
    }

    :host([audio]) media-controller {
      background: transparent;
    }

    :host([audio]) media-controller::part(vertical-layer) {
      background: transparent;
    }

    :host([audio]) media-control-bar {
      width: 100%;
    }

    [disabled]:not(media-live-button),
    [aria-disabled='true']:not(media-live-button) {
      opacity: 60%;
      cursor: not-allowed;
    }

    media-controller:not([mediasubtitleslist]) media-captions-selectmenu {
      --captions-selectmenu: none;
    }

    /* 0.433s is the transition duration for VTT Regions.
     * Borrowed here, so the captions don't move too fast. */
    media-controller ::slotted([slot='media']) {
      --media-webkit-text-track-transition: transform 0.433s ease-out 0.3s;
    }
    media-controller:is([mediapaused],:not([userinactive])) ::slotted([slot='media']) {
      /* 42px is the height of the control bar and progress bar
       * with an additional 5px as a buffer, to get 47px */
      --media-webkit-text-track-transform: translateY(-47px);
      --media-webkit-text-track-transition: transform 0.15s ease;
    }

    media-volume-range[mediavolumeunavailable] {
      --volume-range: none;
    }

    media-airplay-button[mediaairplayunavailable] {
      --airplay-button: none;
    }

    media-fullscreen-button[mediafullscreenunavailable] {
      --fullscreen-button: none;
    }

    media-cast-button[mediacastunavailable] {
      --cast-button: none;
    }

    media-pip-button[mediapipunavailable] {
      --pip-button: none;
    }

    :host media-time-range {
      color: var(--_primary-color);
      --media-range-thumb-opacity: 0;
    }

    :host(:not([audio])) media-time-range {
      --media-range-padding: 0;
      background: transparent;
      z-index: 10;
      height: 10px;
      bottom: -3px;
      width: 100%;
    }

    media-control-bar {
      --media-control-padding: 4px 3px;
    }

    [breakpointsm] media-control-bar {
      --media-control-padding: 9px 5px;
    }

    [breakpointmd] media-control-bar {
      --media-control-padding: 9px 7px;
    }

    media-control-bar :is([role='button'], [role='switch'], button) {
      line-height: 0;
    }

    media-control-bar :is(media-text-display, media-time-display):first-child {
      --media-control-padding: 9px 5px 9px 10px;
    }

    .spacer {
      flex-grow: 1;
      background-color: var(--media-control-background, rgba(20, 20, 30, 0.7));
    }

    /* Add a small space on the right to have the play button and
     * fullscreen button aligned in relation to the progress bar. */
    media-control-bar:not([slot])::after {
      content: '';
      width: 2px;
      height: 100%;
      background-color: var(--media-control-background, rgba(20, 20, 30, 0.7));
    }

    media-control-bar[slot='top-chrome'] {
      min-height: 42px;
      pointer-events: none;
    }

    :host([title]) media-control-bar[slot='top-chrome']::before {
      content: '';
      position: absolute;
      width: 100%;
      padding-bottom: min(160px, 25%);
      background: linear-gradient(rgb(0 0 0 / 0.4), transparent);
    }

    media-control-bar[slot='top-chrome'] > * {
      --media-control-background: transparent;
      --media-control-hover-background: transparent;
      position: relative;
    }

    media-controller::part(vertical-layer) {
      transition: background-color 1s;
    }

    media-controller:is([mediapaused], :not([userinactive]))::part(vertical-layer) {
      background-color: var(--controls-backdrop-color, var(--controls, transparent));
      transition: background-color 0.25s;
    }

    .center-controls {
      --media-button-icon-width: 100%;
      --media-button-icon-height: auto;
      pointer-events: none;
      width: 100%;
      display: flex;
      flex-flow: row;
      align-items: center;
      justify-content: center;
      filter: drop-shadow(0 0 2px rgb(0 0 0 / 0.25)) drop-shadow(0 0 6px rgb(0 0 0 / 0.25));
      paint-order: stroke;
      stroke: rgba(102, 102, 102, 1);
      stroke-width: 0.3px;
      text-shadow: 0 0 2px rgb(0 0 0 / 0.25), 0 0 6px rgb(0 0 0 / 0.25);
    }

    .center-controls media-play-button {
      --media-control-background: transparent;
      --media-control-hover-background: transparent;
      padding: 0;
      width: max(43px, min(10%, 55px));
    }

    .center-controls media-seek-backward-button,
    .center-controls media-seek-forward-button {
      --media-control-background: transparent;
      --media-control-hover-background: transparent;
      padding: 0;
      margin: 0 2%;
      width: max(33px, min(8%, 40px));
    }

    media-control-bar:not([slot]) media-seek-backward-button {
      padding-right: 5px;
    }

    media-control-bar:not([slot]) media-seek-forward-button {
      padding-left: 5px;
    }

    media-loading-indicator {
      --media-loading-icon-width: 100%;
      --media-button-icon-height: auto;
      display: var(--media-control-display, var(--media-loading-indicator-display, flex));
      pointer-events: none;
      position: absolute;
      width: min(15%, 150px);
      flex-flow: row;
      align-items: center;
      justify-content: center;
    }

    /* Intentionally don't target the div for transition but the children
     of the div. Prevents messing with media-chrome's autohide feature. */
    media-loading-indicator + div * {
      transition: opacity 0.15s;
      opacity: 1;
    }

    media-loading-indicator[medialoading]:not([mediapaused]) ~ div > * {
      opacity: 0;
      transition-delay: 400ms;
    }

    media-volume-range {
      width: min(100%, 100px);
    }

    media-time-display {
      white-space: nowrap;
    }

    :is(media-time-display, media-text-display, media-playback-rate-button[role='button']) {
      color: inherit;
      line-height: 24px;
    }

    :is(.title-display, media-live-button) {
      color: inherit;
      font-size: 16px;
      text-shadow: 0 0 2px rgb(0 0 0 / 0.6);
    }

    :host([audio]) .title-display {
      flex-grow: 1;
      font-size: 21px;
    }
  </style>

  <template partial="TitleDisplay">
    <template if="title">
      <media-text-display part="top title display" class="title-display">
        {{title}}
      </media-text-display>
    </template>
  </template>

  <template partial="PlayButton">
    <media-play-button
      part="{{section ?? 'bottom'}} play button"
      disabled="{{disabled}}"
      aria-disabled="{{disabled}}"
    >
      <svg aria-hidden="true" viewBox="0 0 24 24" slot="play">
        <path d="m6.73 20.93 14.05-8.54a.46.46 0 0 0 0-.78L6.73 3.07a.48.48 0 0 0-.73.39v17.07a.48.48 0 0 0 .73.4Z" />
      </svg>
      <svg aria-hidden="true" viewBox="0 0 24 24" slot="pause">
        <path
          d="M6 19.5a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-15a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5v15ZM14.5 4a.5.5 0 0 0-.5.5v15a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-15a.5.5 0 0 0-.5-.5h-3Z"
        />
      </svg>
    </media-play-button>
  </template>

  <template partial="SeekBackwardButton">
    <media-seek-backward-button
      seekoffset="{{backwardseekoffset}}"
      part="{{section ?? 'bottom'}} seek-backward button"
      disabled="{{disabled}}"
      aria-disabled="{{disabled}}"
    >
      <svg aria-hidden="true" viewBox="0 0 22 24" slot="backward">
        <path d="M11 6V3L5.37 7 11 10.94V8a5.54 5.54 0 0 1 1.9 10.48v2.12A7.5 7.5 0 0 0 11 6Z" />
        <text class="value" transform="translate(2.5 21)" style="font-size: 8px; font-family: 'ArialMT', 'Arial'">
          {{backwardseekoffset}}
        </text>
      </svg>
    </media-seek-backward-button>
  </template>

  <template partial="SeekForwardButton">
    <media-seek-forward-button
      seekoffset="{{forwardseekoffset}}"
      part="{{section ?? 'bottom'}} seek-forward button"
      disabled="{{disabled}}"
      aria-disabled="{{disabled}}"
    >
      <svg aria-hidden="true" viewBox="0 0 22 24" slot="forward">
        <path d="M11 6V3l5.61 4L11 10.94V8a5.54 5.54 0 0 0-1.9 10.48v2.12A7.5 7.5 0 0 1 11 6Z" />
        <text class="value" transform="translate(10 21)" style="font-size: 8px; font-family: 'ArialMT', 'Arial'">
          {{forwardseekoffset}}
        </text>
      </svg>
    </media-seek-forward-button>
  </template>

  <template partial="MuteButton">
    <media-mute-button part="bottom mute button" disabled="{{disabled}}" aria-disabled="{{disabled}}">
      <svg aria-hidden="true" viewBox="0 0 24 24" slot="high">
        <path
          d="m11.14 4.86-4 4a.49.49 0 0 1-.35.14H3.25a.25.25 0 0 0-.25.25v5.5a.25.25 0 0 0 .25.25h3.54a.49.49 0 0 1 .36.15l4 4a.5.5 0 0 0 .85-.36V5.21a.5.5 0 0 0-.86-.35Zm2.74-1.56v1.52A7.52 7.52 0 0 1 19.47 12a7.52 7.52 0 0 1-5.59 7.18v1.52A9 9 0 0 0 21 12a9 9 0 0 0-7.12-8.7Zm3.56 8.7a5.49 5.49 0 0 0-3.56-5.1v1.66a3.93 3.93 0 0 1 0 6.88v1.66a5.49 5.49 0 0 0 3.56-5.1Z"
        />
      </svg>
      <svg aria-hidden="true" viewBox="0 0 24 24" slot="low">
        <path
          d="m11.14 4.853-4 4a.49.49 0 0 1-.35.14H3.25a.25.25 0 0 0-.25.25v5.5a.25.25 0 0 0 .25.25h3.54a.49.49 0 0 1 .36.15l4 4a.5.5 0 0 0 .85-.36V5.203a.5.5 0 0 0-.86-.35Zm6.3 7.14a5.49 5.49 0 0 0-3.56-5.1v1.66a3.93 3.93 0 0 1 0 6.88v1.66a5.49 5.49 0 0 0 3.56-5.1Z"
        />
      </svg>
      <svg aria-hidden="true" viewBox="0 0 24 24" slot="medium">
        <path
          d="m11.14 4.853-4 4a.49.49 0 0 1-.35.14H3.25a.25.25 0 0 0-.25.25v5.5a.25.25 0 0 0 .25.25h3.54a.49.49 0 0 1 .36.15l4 4a.5.5 0 0 0 .85-.36V5.203a.5.5 0 0 0-.86-.35Zm6.3 7.14a5.49 5.49 0 0 0-3.56-5.1v1.66a3.93 3.93 0 0 1 0 6.88v1.66a5.49 5.49 0 0 0 3.56-5.1Z"
        />
      </svg>
      <svg aria-hidden="true" viewBox="0 0 24 24" slot="off">
        <path
          d="m3 4.05 4.48 4.47-.33.33a.49.49 0 0 1-.36.15H3.25a.25.25 0 0 0-.25.25v5.5a.25.25 0 0 0 .25.25h3.54a.49.49 0 0 1 .36.15l4 4a.48.48 0 0 0 .36.15.5.5 0 0 0 .5-.5v-5.75l4.67 4.66a7.71 7.71 0 0 1-2.79 1.47v1.52a9.32 9.32 0 0 0 3.87-1.91L20 21l1-1L4.06 3 3 4.05Zm5.36 5.36 2.39 2.39V17L8 14.26a1.74 1.74 0 0 0-1.24-.51H4.25v-3.5h2.54A1.74 1.74 0 0 0 8 9.74l.36-.33ZM19.47 12a7.19 7.19 0 0 1-.89 3.47l1.11 1.1A8.64 8.64 0 0 0 21 12a9 9 0 0 0-7.12-8.7v1.52A7.52 7.52 0 0 1 19.47 12ZM12 8.88V5.21a.5.5 0 0 0-.5-.5.48.48 0 0 0-.36.15L9.56 6.44 12 8.88ZM15.91 12a4.284 4.284 0 0 1-.07.72l1.22 1.22a5.2 5.2 0 0 0 .38-1.94 5.49 5.49 0 0 0-3.56-5.1v1.66A4 4 0 0 1 15.91 12Z"
        />
      </svg>
    </media-mute-button>
  </template>

  <template partial="RenditionSelect">
    <media-rendition-selectmenu part="bottom rendition selectmenu" disabled="{{disabled}}" aria-disabled="{{disabled}}">
      <media-rendition-button slot="button" part="bottom rendition button">
        <svg slot="icon" viewBox="0 0 18 24">
          <path d="M2.25 14.5a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm6.75 0a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm6.75 0a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z"/>
        </svg>
      </media-rendition-button>
      <media-rendition-listbox slot="listbox" part="bottom rendition listbox">
        <div slot="header">Quality</div>
      </media-rendition-listbox>
    </media-rendition-selectmenu>
  </template>

  <template partial="CaptionsSelect">
    <media-captions-selectmenu part="bottom captions selectmenu" disabled="{{disabled}}" aria-disabled="{{disabled}}">
      <media-captions-button slot="button" part="bottom captions button">
        <svg aria-hidden="true" viewBox="0 0 26 24" slot="on">
          <path d="M22.832 5.68a2.58 2.58 0 0 0-2.3-2.5c-3.62-.24-11.44-.24-15.06 0a2.58 2.58 0 0 0-2.3 2.5c-.23 4.21-.23 8.43 0 12.64a2.58 2.58 0 0 0 2.3 2.5c3.62.24 11.44.24 15.06 0a2.58 2.58 0 0 0 2.3-2.5c.23-4.21.23-8.43 0-12.64Zm-11.41 10.1a3.63 3.63 0 0 1-1.51.32 4.76 4.76 0 0 1-1.63-.27 4 4 0 0 1-1.28-.83 3.67 3.67 0 0 1-.84-1.26 4.23 4.23 0 0 1-.3-1.63 4.28 4.28 0 0 1 .3-1.64 3.53 3.53 0 0 1 .84-1.21 3.89 3.89 0 0 1 1.29-.8 4.76 4.76 0 0 1 1.63-.27 4.06 4.06 0 0 1 1.35.24c.225.091.44.205.64.34a2.7 2.7 0 0 1 .55.52l-1.27 1a1.79 1.79 0 0 0-.6-.46 2 2 0 0 0-.83-.16 2 2 0 0 0-1.56.69 2.35 2.35 0 0 0-.46.77 2.78 2.78 0 0 0-.16 1c-.009.34.046.68.16 1 .104.283.26.545.46.77.188.21.415.38.67.5a2 2 0 0 0 .84.18 1.87 1.87 0 0 0 .9-.21 1.78 1.78 0 0 0 .65-.6l1.38 1a2.88 2.88 0 0 1-1.22 1.01Zm7.52 0a3.63 3.63 0 0 1-1.51.32 4.76 4.76 0 0 1-1.63-.27 3.89 3.89 0 0 1-1.28-.83 3.55 3.55 0 0 1-.85-1.26 4.23 4.23 0 0 1-.3-1.63 4.28 4.28 0 0 1 .3-1.64 3.43 3.43 0 0 1 .85-1.25 3.75 3.75 0 0 1 1.28-.8 4.76 4.76 0 0 1 1.63-.27 4 4 0 0 1 1.35.24c.225.091.44.205.64.34.21.144.395.32.55.52l-1.27 1a1.79 1.79 0 0 0-.6-.46 2 2 0 0 0-.83-.16 2 2 0 0 0-1.56.69 2.352 2.352 0 0 0-.46.77 3.01 3.01 0 0 0-.16 1c-.003.34.05.678.16 1 .108.282.263.542.46.77.188.21.416.38.67.5a2 2 0 0 0 .84.18 1.87 1.87 0 0 0 .9-.21 1.78 1.78 0 0 0 .65-.6l1.38 1a2.82 2.82 0 0 1-1.21 1.05Z"/>
        </svg>
        <svg aria-hidden="true" viewBox="0 0 26 24" slot="off">
          <path d="M22.832 5.68a2.58 2.58 0 0 0-2.3-2.5c-1.81-.12-4.67-.18-7.53-.18-2.86 0-5.72.06-7.53.18a2.58 2.58 0 0 0-2.3 2.5c-.23 4.21-.23 8.43 0 12.64a2.58 2.58 0 0 0 2.3 2.5c1.81.12 4.67.18 7.53.18 2.86 0 5.72-.06 7.53-.18a2.58 2.58 0 0 0 2.3-2.5c.23-4.21.23-8.43 0-12.64Zm-1.49 12.53a1.11 1.11 0 0 1-.91 1.11c-1.67.11-4.45.18-7.43.18-2.98 0-5.76-.07-7.43-.18a1.11 1.11 0 0 1-.91-1.11c-.21-4.137-.21-8.283 0-12.42a1.11 1.11 0 0 1 .91-1.11c1.67-.11 4.43-.18 7.43-.18s5.76.07 7.43.18a1.11 1.11 0 0 1 .91 1.11c.21 4.137.21 8.283 0 12.42ZM10.843 14a1.55 1.55 0 0 1-.76.18 1.57 1.57 0 0 1-.71-.18 1.69 1.69 0 0 1-.57-.42 2.099 2.099 0 0 1-.38-.58 2.47 2.47 0 0 1 0-1.64 2 2 0 0 1 .39-.66 1.73 1.73 0 0 1 .58-.42c.23-.103.479-.158.73-.16.241-.004.48.044.7.14.199.088.373.222.51.39l1.08-.89a2.179 2.179 0 0 0-.47-.44 2.81 2.81 0 0 0-.54-.32 2.91 2.91 0 0 0-.58-.15 2.71 2.71 0 0 0-.56 0 4.08 4.08 0 0 0-1.38.15 3.27 3.27 0 0 0-1.09.67 3.14 3.14 0 0 0-.71 1.06 3.62 3.62 0 0 0-.26 1.39 3.57 3.57 0 0 0 .26 1.38 3 3 0 0 0 .71 1.06c.316.293.687.52 1.09.67.443.16.91.238 1.38.23a3.2 3.2 0 0 0 1.28-.27c.401-.183.747-.47 1-.83l-1.17-.88a1.42 1.42 0 0 1-.53.52Zm6.62 0a1.58 1.58 0 0 1-.76.18 1.54 1.54 0 0 1-.7-.18 1.69 1.69 0 0 1-.57-.42 2.12 2.12 0 0 1-.43-.58 2.29 2.29 0 0 1 .39-2.3 1.84 1.84 0 0 1 1.32-.58c.241-.003.48.045.7.14.199.088.373.222.51.39l1.08-.92a2.43 2.43 0 0 0-.47-.44 3.22 3.22 0 0 0-.53-.29 2.999 2.999 0 0 0-.57-.15 2.87 2.87 0 0 0-.57 0 4.06 4.06 0 0 0-1.36.15 3.17 3.17 0 0 0-1.09.67 3 3 0 0 0-.72 1.06 3.62 3.62 0 0 0-.25 1.39 3.57 3.57 0 0 0 .25 1.38c.16.402.405.764.72 1.06a3.17 3.17 0 0 0 1.09.67c.44.16.904.237 1.37.23.441 0 .877-.092 1.28-.27a2.45 2.45 0 0 0 1-.83l-1.15-.85a1.49 1.49 0 0 1-.54.49Z"/>
        </svg>
      </media-captions-button>
      <media-captions-listbox slot="listbox" part="bottom captions listbox"></media-captions-listbox>
    </media-captions-selectmenu>
  </template>

  <template partial="AirplayButton">
    <media-airplay-button part="bottom airplay button" disabled="{{disabled}}" aria-disabled="{{disabled}}">
      <svg aria-hidden="true" viewBox="0 0 26 24" slot="airplay">
        <path
          d="M13.19 14.22a.25.25 0 0 0-.38 0l-5.46 6.37a.25.25 0 0 0 .19.41h10.92a.25.25 0 0 0 .19-.41l-5.46-6.37Z"
        />
        <path
          d="M22 3H4a1 1 0 0 0-1 1v13a1 1 0 0 0 1 1h2.94L8 16.75H4.25V4.25h17.5v12.5H18L19.06 18H22a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1Z"
        />
      </svg>
    </media-airplay-button>
  </template>

  <template partial="CastButton">
    <media-cast-button part="bottom cast button" disabled="{{disabled}}" aria-disabled="{{disabled}}">
      <svg aria-hidden="true" viewBox="0 0 26 24" slot="enter">
        <path d="M3 15.5V17c2.206 0 4 1.794 4 4h1.5A5.5 5.5 0 0 0 3 15.5Zm0 3V21h2.5A2.5 2.5 0 0 0 3 18.5Z" />
        <path d="M3 12.5V14c3.86 0 7 3.14 7 7h1.5A8.5 8.5 0 0 0 3 12.5Z" />
        <path
          d="M22 3H4a1 1 0 0 0-1 1v6.984c.424 0 .84.035 1.25.086V4.25h17.5v15.5h-8.82c.051.41.086.826.086 1.25H22a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1Z"
        />
      </svg>
      <svg aria-hidden="true" viewBox="0 0 26 24" slot="exit">
        <path d="M3 15.5V17c2.206 0 4 1.794 4 4h1.5A5.5 5.5 0 0 0 3 15.5Zm0 3V21h2.5A2.5 2.5 0 0 0 3 18.5Z" />
        <path d="M3 12.5V14c3.86 0 7 3.14 7 7h1.5A8.5 8.5 0 0 0 3 12.5Z" />
        <path
          d="M22 3H4a1 1 0 0 0-1 1v6.984c.424 0 .84.035 1.25.086V4.25h17.5v15.5h-8.82c.051.41.086.826.086 1.25H22a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1Z"
        />
        <path d="M20.5 5.5h-15v5.811c3.52.906 6.283 3.67 7.189 7.19H20.5V5.5Z" />
      </svg>
    </media-cast-button>
  </template>

  <template partial="PipButton">
    <media-pip-button part="bottom pip button" disabled="{{disabled}}" aria-disabled="{{disabled}}">
      <svg aria-hidden="true" viewBox="0 0 26 24" slot="enter">
        <path
          d="M22 3H4a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h6.75v-1.25h-6.5V4.25h17.5v6.5H23V4a1 1 0 0 0-1-1Zm0 10h-8a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1Zm-.5 6.5h-7v-5h7v5Z"
        />
      </svg>
      <svg aria-hidden="true" viewBox="0 0 26 24" slot="exit">
        <path
          d="M22 3H4a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h6.75v-1.25h-6.5V4.25h17.5v6.5H23V4a1 1 0 0 0-1-1Zm0 10h-8a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1v-6a1 1 0 0 0-1-1Zm-.5 6.5h-7v-5h7v5Z"
        />
      </svg>
    </media-pip-button>
  </template>

  <template partial="FullscreenButton">
    <media-fullscreen-button part="bottom fullscreen button" disabled="{{disabled}}" aria-disabled="{{disabled}}">
      <svg aria-hidden="true" viewBox="0 0 24 24" slot="enter">
        <path
          d="M20.25 14.5a.76.76 0 0 0-.75.75v4.25h-4.25a.75.75 0 1 0 0 1.5h5a.76.76 0 0 0 .75-.75v-5a.76.76 0 0 0-.75-.75Zm0-11.5h-5a.76.76 0 0 0-.75.75.76.76 0 0 0 .75.75h4.25v4.25a.75.75 0 1 0 1.5 0v-5a.76.76 0 0 0-.75-.75ZM8.75 19.5H4.5v-4.25a.76.76 0 0 0-.75-.75.76.76 0 0 0-.75.75v5a.76.76 0 0 0 .75.75h5a.75.75 0 1 0 0-1.5Zm0-16.5h-5a.76.76 0 0 0-.75.75v5a.76.76 0 0 0 .75.75.76.76 0 0 0 .75-.75V4.5h4.25a.76.76 0 0 0 .75-.75.76.76 0 0 0-.75-.75Z"
        />
      </svg>
      <svg aria-hidden="true" viewBox="0 0 24 24" slot="exit">
        <path
          d="M20.25 14.5h-5a.76.76 0 0 0-.75.75v5a.75.75 0 1 0 1.5 0V16h4.25a.75.75 0 1 0 0-1.5Zm-5-5h5a.75.75 0 1 0 0-1.5H16V3.75a.75.75 0 1 0-1.5 0v5a.76.76 0 0 0 .75.75Zm-6.5 5h-5a.75.75 0 1 0 0 1.5H8v4.25a.75.75 0 1 0 1.5 0v-5a.76.76 0 0 0-.75-.75Zm0-11.5a.76.76 0 0 0-.75.75V8H3.75a.75.75 0 0 0 0 1.5h5a.76.76 0 0 0 .75-.75v-5A.76.76 0 0 0 8.75 3Z"
        />
      </svg>
    </media-fullscreen-button>
  </template>

  <template partial="LiveButton">
    <media-live-button
      part="{{section ?? 'top'}} live button"
      disabled="{{disabled}}"
      aria-disabled="{{disabled}}"
    ></media-live-button>
  </template>

  <template partial="PlaybackRateButton">
    <media-playback-rate-button
      rates="{{playbackrates}}"
      part="bottom playback-rate button"
      disabled="{{disabled}}"
      aria-disabled="{{disabled}}"
    ></media-playback-rate-button>
  </template>

  <template partial="VolumeRange">
    <media-volume-range
      part="bottom volume range"
      disabled="{{disabled}}"
      aria-disabled="{{disabled}}"
    ></media-volume-range>
  </template>

  <template partial="TimeDisplay">
    <media-time-display
      remaining="{{defaultshowremainingtime}}"
      showduration="{{!hideduration}}"
      part="bottom time display"
      disabled="{{disabled}}"
      aria-disabled="{{disabled}}"
    ></media-time-display>
  </template>

  <template partial="TimeRange">
    <media-time-range
      part="bottom time range"
      disabled="{{disabled}}"
      aria-disabled="{{disabled}}"
    ></media-time-range>
  </template>

  <media-controller
    part="controller"
    defaultstreamtype="{{defaultstreamtype ?? 'on-demand'}}"
    breakpoints="sm:300 md:700"
    gesturesdisabled="{{disabled}}"
    hotkeys="{{hotkeys}}"
    nohotkeys="{{nohotkeys}}"
    novolumepref="{{novolumepref}}"
    audio="{{audio}}"
    noautoseektolive="{{noautoseektolive}}"
    defaultsubtitles="{{defaultsubtitles}}"
    exportparts="layer, media-layer, poster-layer, vertical-layer, centered-layer, gesture-layer"
  >
    <slot name="media" slot="media"></slot>
    <slot name="poster" slot="poster"></slot>
    <media-loading-indicator slot="centered-chrome" noautohide></media-loading-indicator>

    <template if="audio">

      <template if="streamtype == 'on-demand'">
        <template if="title">
          <media-control-bar>{{>TitleDisplay}}</media-control-bar>
        </template>
        <media-control-bar>
          {{>PlayButton}}
          {{>SeekBackwardButton}}
          {{>SeekForwardButton}}
          {{>TimeDisplay}}
          {{>TimeRange}}
          {{>MuteButton}}
          {{>VolumeRange}}
          {{>PlaybackRateButton}}
          {{>AirplayButton}}
          {{>CastButton}}
        </media-control-bar>
      </template>

      <template if="streamtype == 'live'">

        <template if="targetlivewindow > 0">
          <template if="title">
            <media-control-bar>{{>TitleDisplay}}</media-control-bar>
          </template>
          <media-control-bar>
            {{>PlayButton}}
            {{>LiveButton section="bottom"}}
            {{>SeekBackwardButton}}
            {{>SeekForwardButton}}
            {{>TimeDisplay}}
            {{>TimeRange}}
            {{>MuteButton}}
            {{>VolumeRange}}
            {{>PlaybackRateButton}}
            {{>AirplayButton}}
            {{>CastButton}}
          </media-control-bar>
        </template>

        <template if="!targetlivewindow">
          <template if="title">
            <media-control-bar>{{>TitleDisplay}}</media-control-bar>
          </template>
          <media-control-bar>
            {{>PlayButton}}
            {{>LiveButton section="bottom"}}
            {{>MuteButton}}
            {{>VolumeRange}}
            <div class="spacer"></div>
            {{>AirplayButton}}
            {{>CastButton}}
          </media-control-bar>
        </template>

      </template>
    </template>

    <template if="!audio">

      <template if="streamtype == 'on-demand'">

        <template if="!breakpointsm">
          {{>TimeRange}}
          <media-control-bar>
            {{>PlayButton}}
            {{>MuteButton}}
            <div class="spacer"></div>
            {{>CaptionsSelect}}
            {{>FullscreenButton}}
          </media-control-bar>
        </template>

        <template if="breakpointsm">
          <template if="!breakpointmd">
            <media-control-bar slot="top-chrome">
              {{>TitleDisplay}}
            </media-control-bar>
            <div slot="centered-chrome" class="center-controls">
              {{>SeekBackwardButton section="center"}}
              {{>PlayButton section="center"}}
              {{>SeekForwardButton section="center"}}
            </div>
            {{>TimeRange}}
            <media-control-bar>
              {{>PlayButton}}
              {{>TimeDisplay}}
              {{>MuteButton}}
              {{>VolumeRange}}
              <div class="spacer"></div>
              {{>RenditionSelect}}
              {{>PlaybackRateButton}}
              {{>CaptionsSelect}}
              {{>AirplayButton}}
              {{>CastButton}}
              {{>PipButton}}
              {{>FullscreenButton}}
            </media-control-bar>
          </template>
        </template>

        <template if="breakpointmd">
          <media-control-bar slot="top-chrome">
            {{>TitleDisplay}}
          </media-control-bar>
          <div slot="centered-chrome" class="center-controls">
            {{>PlayButton section="center"}}
          </div>
          {{>TimeRange}}
          <media-control-bar>
            {{>PlayButton}}
            {{>SeekBackwardButton}}
            {{>SeekForwardButton}}
            {{>TimeDisplay}}
            {{>MuteButton}}
            {{>VolumeRange}}
            <div class="spacer"></div>
            {{>RenditionSelect}}
            {{>PlaybackRateButton}}
            {{>CaptionsSelect}}
            {{>AirplayButton}}
            {{>CastButton}}
            {{>PipButton}}
            {{>FullscreenButton}}
          </media-control-bar>
        </template>

      </template>

      <template if="streamtype == 'live'">

        <template if="!targetlivewindow">

          <template if="!breakpointsm">
            <media-control-bar slot="top-chrome">
              {{>LiveButton}}
            </media-control-bar>
            <media-control-bar>
              {{>PlayButton}}
              {{>MuteButton}}
              <div class="spacer"></div>
              {{>CaptionsSelect}}
              {{>FullscreenButton}}
            </media-control-bar>
          </template>

          <template if="breakpointsm">
            <template if="!breakpointmd">
              <media-control-bar slot="top-chrome">
                {{>LiveButton}}
                {{>TitleDisplay}}
              </media-control-bar>
              <div slot="centered-chrome" class="center-controls">
                {{>PlayButton section="center"}}
              </div>
              <media-control-bar>
                {{>PlayButton}}
                {{>MuteButton}}
                {{>VolumeRange}}
                <div class="spacer"></div>
                {{>RenditionSelect}}
                {{>CaptionsSelect}}
                {{>AirplayButton}}
                {{>CastButton}}
                {{>PipButton}}
                {{>FullscreenButton}}
              </media-control-bar>
            </template>
          </template>

          <template if="breakpointmd">
            <media-control-bar slot="top-chrome">
              {{>LiveButton}}
              {{>TitleDisplay}}
            </media-control-bar>
            <div slot="centered-chrome" class="center-controls">
              {{>PlayButton section="center"}}
            </div>
            <media-control-bar>
              {{>PlayButton}}
              {{>MuteButton}}
              {{>VolumeRange}}
              <div class="spacer"></div>
              {{>RenditionSelect}}
              {{>CaptionsSelect}}
              {{>AirplayButton}}
              {{>CastButton}}
              {{>PipButton}}
              {{>FullscreenButton}}
            </media-control-bar>
          </template>
        </template>

        <template if="targetlivewindow > 0">

          <template if="!breakpointsm">
            <media-control-bar slot="top-chrome">
              {{>LiveButton}}
            </media-control-bar>
            {{>TimeRange}}
            <media-control-bar>
              {{>PlayButton}}
              {{>MuteButton}}
              <div class="spacer"></div>
              {{>CaptionsSelect}}
              {{>FullscreenButton}}
            </media-control-bar>
          </template>

          <template if="breakpointsm">
            <template if="!breakpointmd">
              <media-control-bar slot="top-chrome">
                {{>LiveButton}}
                {{>TitleDisplay}}
              </media-control-bar>
              <div slot="centered-chrome" class="center-controls">
                {{>SeekBackwardButton section="center"}}
                {{>PlayButton section="center"}}
                {{>SeekForwardButton section="center"}}
              </div>
              {{>TimeRange}}
              <media-control-bar>
                {{>PlayButton}}
                {{>MuteButton}}
                {{>VolumeRange}}
                <div class="spacer"></div>
                {{>RenditionSelect}}
                {{>CaptionsSelect}}
                {{>AirplayButton}}
                {{>CastButton}}
                {{>PipButton}}
                {{>FullscreenButton}}
              </media-control-bar>
            </template>
          </template>

          <template if="breakpointmd">
            <media-control-bar slot="top-chrome">
              {{>LiveButton}}
              {{>TitleDisplay}}
            </media-control-bar>
            <div slot="centered-chrome" class="center-controls">
              {{>PlayButton section="center"}}
            </div>
            {{>TimeRange}}
            <media-control-bar>
              {{>PlayButton}}
              {{>SeekBackwardButton}}
              {{>SeekForwardButton}}
              {{>MuteButton}}
              {{>VolumeRange}}
              <div class="spacer"></div>
              {{>RenditionSelect}}
              {{>CaptionsSelect}}
              {{>AirplayButton}}
              {{>CastButton}}
              {{>PipButton}}
              {{>FullscreenButton}}
            </media-control-bar>
          </template>

        </template>

      </template>

    </template>

    <slot></slot>

  </media-controller>
</template>
`,rP=iH.createElement("template");"innerHTML"in rP&&(rP.innerHTML=rD);var rO,rN,rU=class extends iI.E${};rU.template=null==(rN=null==(rO=rP.content)?void 0:rO.children)?void 0:rN[0],ij.customElements.get("media-theme-classic")||ij.customElements.define("media-theme-classic",rU);var rF={SRC:"src",POSTER:"poster"},rB={STYLE:"style",DEFAULT_HIDDEN_CAPTIONS:"default-hidden-captions",PRIMARY_COLOR:"primary-color",SECONDARY_COLOR:"secondary-color",FORWARD_SEEK_OFFSET:"forward-seek-offset",BACKWARD_SEEK_OFFSET:"backward-seek-offset",PLAYBACK_TOKEN:"playback-token",THUMBNAIL_TOKEN:"thumbnail-token",STORYBOARD_TOKEN:"storyboard-token",STORYBOARD_SRC:"storyboard-src",THUMBNAIL_TIME:"thumbnail-time",AUDIO:"audio",NOHOTKEYS:"nohotkeys",HOTKEYS:"hotkeys",PLAYBACK_RATES:"playbackrates",DEFAULT_SHOW_REMAINING_TIME:"default-show-remaining-time",TITLE:"title",PLACEHOLDER:"placeholder",THEME:"theme",DEFAULT_STREAM_TYPE:"default-stream-type",TARGET_LIVE_WINDOW:"target-live-window",NO_VOLUME_PREF:"no-volume-pref"},rV=["audio","backwardseekoffset","defaultshowremainingtime","defaultsubtitles","noautoseektolive","disabled","exportparts","forwardseekoffset","hideduration","hotkeys","nohotkeys","playbackrates","defaultstreamtype","streamtype","style","targetlivewindow","template","title","novolumepref"];function rz(e){return e.getAttributeNames().filter(e=>e.startsWith("metadata-")).reduce((t,i)=>{let r=e.getAttribute(i);return null!==r&&(t[i.replace(/^metadata-/,"").replace(/-/g,"_")]=r),t},{})}var rj,rH,rG,rW,r$,rq,rY,rK,rX,rZ,rJ,rQ,r0,r1,r2,r3,r5,r4,r6,r8,r7,r9=Object.values(iM),ne=Object.values(rF),nt=Object.values(rB),ni={dialog:void 0,isDialogOpen:!1},nr=class extends rh{constructor(){super(),iD(this,rq),iD(this,rK),iD(this,rZ),iD(this,rQ),iD(this,r1),iD(this,r3),iD(this,r4),iD(this,r8),iD(this,rj,!1),iD(this,rH,{}),iD(this,rG,!0),iD(this,rW,new re(this,"hotkeys")),iD(this,r$,{...ni,onCloseErrorDialog:()=>iO(this,rZ,rJ).call(this,{dialog:void 0,isDialogOpen:!1}),onInitFocusDialog:e=>{i2(this,iH.activeElement)||e.preventDefault()}}),this.attachShadow({mode:"open"}),iO(this,rK,rX).call(this),this.isConnected&&iO(this,rq,rY).call(this)}static get observedAttributes(){var e;return[...null!=(e=rh.observedAttributes)?e:[],...ne,...r9,...nt]}get mediaTheme(){var e;return null==(e=this.shadowRoot)?void 0:e.querySelector("media-theme")}get mediaController(){var e,t;return null==(t=null==(e=this.mediaTheme)?void 0:e.shadowRoot)?void 0:t.querySelector("media-controller")}connectedCallback(){var e;let t=null==(e=this.shadowRoot)?void 0:e.querySelector("mux-video");t&&(t.metadata=rz(this))}attributeChangedCallback(e,t,i){var r;switch(iO(this,rq,rY).call(this),super.attributeChangedCallback(e,t,i),e){case rB.HOTKEYS:ik(this,rW).value=i;break;case rB.THUMBNAIL_TIME:null!=i&&this.tokens.thumbnail&&ri(iW("Use of thumbnail-time with thumbnail-token is currently unsupported. Ignore thumbnail-time.").format({}));break;case rB.THUMBNAIL_TOKEN:{let{aud:e}=iZ(i);i&&"t"!==e&&ri(iW("The provided thumbnail-token should have audience value 't' instead of '{aud}'.").format({aud:e}));break}case rB.STORYBOARD_TOKEN:{let{aud:e}=iZ(i);i&&"s"!==e&&ri(iW("The provided storyboard-token should have audience value 's' instead of '{aud}'.").format({aud:e}));break}case iM.PLAYBACK_ID:null!=i&&i.includes("?token")&&rr(iW("The specificed playback ID {playbackId} contains a token which must be provided via the playback-token attribute.").format({playbackId:i}));break;case iM.STREAM_TYPE:i&&![Z.LIVE,Z.ON_DEMAND,Z.UNKNOWN].includes(i)?["ll-live","live:dvr","ll-live:dvr"].includes(this.streamType)?this.targetLiveWindow=i.includes("dvr")?Number.POSITIVE_INFINITY:0:rn({file:"invalid-stream-type.md",message:iW("Invalid stream-type value supplied: `{streamType}`. Please provide stream-type as either: `on-demand` or `live`").format({streamType:this.streamType})}):this.targetLiveWindow=i===Z.LIVE?0:Number.NaN}[iM.PLAYBACK_ID,rF.SRC,rB.PLAYBACK_TOKEN].includes(e)&&t!==i&&iP(this,r$,{...ik(this,r$),...ni}),iO(this,rQ,r0).call(this,{[null!=(r=i9[e])?r:iY(e)]:i})}get preferCmcd(){var e;return null!=(e=this.getAttribute(iM.PREFER_CMCD))?e:void 0}set preferCmcd(e){e!==this.preferCmcd&&(e?ee.includes(e)?this.setAttribute(iM.PREFER_CMCD,e):ri(`Invalid value for preferCmcd. Must be one of ${ee.join()}`):this.removeAttribute(iM.PREFER_CMCD))}get hasPlayed(){var e,t;return null!=(t=null==(e=this.mediaController)?void 0:e.hasAttribute("media-has-played"))&&t}get inLiveWindow(){var e;return null==(e=this.mediaController)?void 0:e.hasAttribute("media-time-is-live")}get _hls(){var e;return null==(e=this.media)?void 0:e._hls}get mux(){var e;return null==(e=this.media)?void 0:e.mux}get theme(){var e;return null!=(e=this.getAttribute(rB.THEME))?e:"classic"}set theme(e){this.setAttribute(rB.THEME,`${e}`)}get themeProps(){let e=this.mediaTheme;if(!e)return;let t={};for(let i of e.getAttributeNames()){if(rV.includes(i))continue;let r=e.getAttribute(i);t[iY(i)]=""===r||r}return t}set themeProps(e){var t,i;iO(this,rq,rY).call(this);let r={...this.themeProps,...e};for(let n in r){if(rV.includes(n))continue;let r=null==e?void 0:e[n];"boolean"==typeof r||null==r?null==(t=this.mediaTheme)||t.toggleAttribute(iq(n),!!r):null==(i=this.mediaTheme)||i.setAttribute(iq(n),r)}}get playbackId(){var e;return null!=(e=this.getAttribute(iM.PLAYBACK_ID))?e:void 0}set playbackId(e){e?this.setAttribute(iM.PLAYBACK_ID,e):this.removeAttribute(iM.PLAYBACK_ID)}get src(){var e,t;return this.playbackId?null!=(e=nn(this,rF.SRC))?e:void 0:null!=(t=this.getAttribute(rF.SRC))?t:void 0}set src(e){e?this.setAttribute(rF.SRC,e):this.removeAttribute(rF.SRC)}get poster(){var e;let t=this.getAttribute(rF.POSTER);return null!=t?t:this.playbackId&&!this.audio?i6(this.playbackId,{domain:this.customDomain,thumbnailTime:null!=(e=this.thumbnailTime)?e:this.startTime,token:this.tokens.thumbnail}):void 0}set poster(e){e||""===e?this.setAttribute(rF.POSTER,e):this.removeAttribute(rF.POSTER)}get storyboardSrc(){var e;return null!=(e=this.getAttribute(rB.STORYBOARD_SRC))?e:void 0}set storyboardSrc(e){e?this.setAttribute(rB.STORYBOARD_SRC,e):this.removeAttribute(rB.STORYBOARD_SRC)}get storyboard(){return this.storyboardSrc&&!this.tokens.storyboard?this.storyboardSrc:this.audio||!this.playbackId||!this.streamType||[Z.LIVE,Z.UNKNOWN].includes(this.streamType)?void 0:i8(this.playbackId,{domain:this.customDomain,token:this.tokens.storyboard})}get audio(){return this.hasAttribute(rB.AUDIO)}set audio(e){if(!e){this.removeAttribute(rB.AUDIO);return}this.setAttribute(rB.AUDIO,"")}get hotkeys(){return ik(this,rW)}get nohotkeys(){return this.hasAttribute(rB.NOHOTKEYS)}set nohotkeys(e){if(!e){this.removeAttribute(rB.NOHOTKEYS);return}this.setAttribute(rB.NOHOTKEYS,"")}get thumbnailTime(){return iK(this.getAttribute(rB.THUMBNAIL_TIME))}set thumbnailTime(e){this.setAttribute(rB.THUMBNAIL_TIME,`${e}`)}get title(){var e;return null!=(e=this.getAttribute(rB.TITLE))?e:""}set title(e){e!==this.title&&(e?this.setAttribute(rB.TITLE,e):this.removeAttribute("title"),super.title=e)}get placeholder(){var e;return null!=(e=nn(this,rB.PLACEHOLDER))?e:""}set placeholder(e){this.setAttribute(rB.PLACEHOLDER,`${e}`)}get primaryColor(){var e,t;let i=this.getAttribute(rB.PRIMARY_COLOR);if(null!=i||this.mediaTheme&&(i=null==(t=null==(e=ij.getComputedStyle(this.mediaTheme))?void 0:e.getPropertyValue("--_primary-color"))?void 0:t.trim()))return i}set primaryColor(e){this.setAttribute(rB.PRIMARY_COLOR,`${e}`)}get secondaryColor(){var e,t;let i=this.getAttribute(rB.SECONDARY_COLOR);if(null!=i||this.mediaTheme&&(i=null==(t=null==(e=ij.getComputedStyle(this.mediaTheme))?void 0:e.getPropertyValue("--_secondary-color"))?void 0:t.trim()))return i}set secondaryColor(e){this.setAttribute(rB.SECONDARY_COLOR,`${e}`)}get defaultShowRemainingTime(){return this.hasAttribute(rB.DEFAULT_SHOW_REMAINING_TIME)}set defaultShowRemainingTime(e){e?this.setAttribute(rB.DEFAULT_SHOW_REMAINING_TIME,""):this.removeAttribute(rB.DEFAULT_SHOW_REMAINING_TIME)}get playbackRates(){if(this.hasAttribute(rB.PLAYBACK_RATES))return this.getAttribute(rB.PLAYBACK_RATES).trim().split(/\s*,?\s+/).map(e=>Number(e)).filter(e=>!Number.isNaN(e)).sort((e,t)=>e-t)}set playbackRates(e){if(!e){this.removeAttribute(rB.PLAYBACK_RATES);return}this.setAttribute(rB.PLAYBACK_RATES,e.join(" "))}get forwardSeekOffset(){var e;return null!=(e=iK(this.getAttribute(rB.FORWARD_SEEK_OFFSET)))?e:10}set forwardSeekOffset(e){this.setAttribute(rB.FORWARD_SEEK_OFFSET,`${e}`)}get backwardSeekOffset(){var e;return null!=(e=iK(this.getAttribute(rB.BACKWARD_SEEK_OFFSET)))?e:10}set backwardSeekOffset(e){this.setAttribute(rB.BACKWARD_SEEK_OFFSET,`${e}`)}get defaultHiddenCaptions(){return this.hasAttribute(rB.DEFAULT_HIDDEN_CAPTIONS)}set defaultHiddenCaptions(e){e?this.setAttribute(rB.DEFAULT_HIDDEN_CAPTIONS,""):this.removeAttribute(rB.DEFAULT_HIDDEN_CAPTIONS)}get playerSoftwareName(){var e;return null!=(e=this.getAttribute(iM.PLAYER_SOFTWARE_NAME))?e:"mux-player"}get playerSoftwareVersion(){var e;return null!=(e=this.getAttribute(iM.PLAYER_SOFTWARE_VERSION))?e:i5}get beaconCollectionDomain(){var e;return null!=(e=this.getAttribute(iM.BEACON_COLLECTION_DOMAIN))?e:void 0}set beaconCollectionDomain(e){e!==this.beaconCollectionDomain&&(e?this.setAttribute(iM.BEACON_COLLECTION_DOMAIN,e):this.removeAttribute(iM.BEACON_COLLECTION_DOMAIN))}get maxResolution(){var e;return null!=(e=this.getAttribute(iM.MAX_RESOLUTION))?e:void 0}set maxResolution(e){e!==this.maxResolution&&(e?this.setAttribute(iM.MAX_RESOLUTION,e):this.removeAttribute(iM.MAX_RESOLUTION))}get customDomain(){var e;return null!=(e=this.getAttribute(iM.CUSTOM_DOMAIN))?e:void 0}set customDomain(e){e!==this.customDomain&&(e?this.setAttribute(iM.CUSTOM_DOMAIN,e):this.removeAttribute(iM.CUSTOM_DOMAIN))}get envKey(){var e;return null!=(e=nn(this,iM.ENV_KEY))?e:void 0}set envKey(e){this.setAttribute(iM.ENV_KEY,`${e}`)}get noVolumePref(){return this.hasAttribute(rB.NO_VOLUME_PREF)}set noVolumePref(e){e?this.setAttribute(rB.NO_VOLUME_PREF,""):this.removeAttribute(rB.NO_VOLUME_PREF)}get debug(){return null!=nn(this,iM.DEBUG)}set debug(e){e?this.setAttribute(iM.DEBUG,""):this.removeAttribute(iM.DEBUG)}get disableCookies(){return null!=nn(this,iM.DISABLE_COOKIES)}set disableCookies(e){e?this.setAttribute(iM.DISABLE_COOKIES,""):this.removeAttribute(iM.DISABLE_COOKIES)}get streamType(){var e,t,i;return null!=(i=null!=(t=this.getAttribute(iM.STREAM_TYPE))?t:null==(e=this.media)?void 0:e.streamType)?i:Z.UNKNOWN}set streamType(e){this.setAttribute(iM.STREAM_TYPE,`${e}`)}get defaultStreamType(){var e,t,i;return null!=(i=null!=(t=this.getAttribute(rB.DEFAULT_STREAM_TYPE))?t:null==(e=this.mediaController)?void 0:e.getAttribute(rB.DEFAULT_STREAM_TYPE))?i:Z.ON_DEMAND}set defaultStreamType(e){e?this.setAttribute(rB.DEFAULT_STREAM_TYPE,e):this.removeAttribute(rB.DEFAULT_STREAM_TYPE)}get targetLiveWindow(){var e,t;return this.hasAttribute(rB.TARGET_LIVE_WINDOW)?+this.getAttribute(rB.TARGET_LIVE_WINDOW):null!=(t=null==(e=this.media)?void 0:e.targetLiveWindow)?t:Number.NaN}set targetLiveWindow(e){e!=this.targetLiveWindow&&(null==e?this.removeAttribute(rB.TARGET_LIVE_WINDOW):this.setAttribute(rB.TARGET_LIVE_WINDOW,`${+e}`))}get liveEdgeStart(){var e;return null==(e=this.media)?void 0:e.liveEdgeStart}get startTime(){return iK(nn(this,iM.START_TIME))}set startTime(e){this.setAttribute(iM.START_TIME,`${e}`)}get preferPlayback(){let e=this.getAttribute(iM.PREFER_PLAYBACK);if(e===J.MSE||e===J.NATIVE)return e}set preferPlayback(e){e!==this.preferPlayback&&(e===J.MSE||e===J.NATIVE?this.setAttribute(iM.PREFER_PLAYBACK,e):this.removeAttribute(iM.PREFER_PLAYBACK))}get metadata(){var e;return null==(e=this.media)?void 0:e.metadata}set metadata(e){if(iO(this,rq,rY).call(this),!this.media){rr("underlying media element missing when trying to set metadata. metadata will not be set.");return}this.media.metadata={...rz(this),...e}}async addCuePoints(e){var t;if(iO(this,rq,rY).call(this),!this.media){rr("underlying media element missing when trying to addCuePoints. cuePoints will not be added.");return}return null==(t=this.media)?void 0:t.addCuePoints(e)}get activeCuePoint(){var e;return null==(e=this.media)?void 0:e.activeCuePoint}get cuePoints(){var e,t;return null!=(t=null==(e=this.media)?void 0:e.cuePoints)?t:[]}getStartDate(){var e;return null==(e=this.media)?void 0:e.getStartDate()}get currentPdt(){var e;return null==(e=this.media)?void 0:e.currentPdt}get tokens(){let e=this.getAttribute(rB.PLAYBACK_TOKEN),t=this.getAttribute(rB.THUMBNAIL_TOKEN),i=this.getAttribute(rB.STORYBOARD_TOKEN);return{...ik(this,rH),...null!=e?{playback:e}:{},...null!=t?{thumbnail:t}:{},...null!=i?{storyboard:i}:{}}}set tokens(e){iP(this,rH,null!=e?e:{})}get playbackToken(){var e;return null!=(e=this.getAttribute(rB.PLAYBACK_TOKEN))?e:void 0}set playbackToken(e){this.setAttribute(rB.PLAYBACK_TOKEN,`${e}`)}get thumbnailToken(){var e;return null!=(e=this.getAttribute(rB.THUMBNAIL_TOKEN))?e:void 0}set thumbnailToken(e){this.setAttribute(rB.THUMBNAIL_TOKEN,`${e}`)}get storyboardToken(){var e;return null!=(e=this.getAttribute(rB.STORYBOARD_TOKEN))?e:void 0}set storyboardToken(e){this.setAttribute(rB.STORYBOARD_TOKEN,`${e}`)}addTextTrack(e,t,i,r){var n;let a=null==(n=this.media)?void 0:n.nativeEl;if(a)return ep(a,e,t,i,r)}removeTextTrack(e){var t;let i=null==(t=this.media)?void 0:t.nativeEl;if(i){let t;return void(null==(t=Array.prototype.find.call(i.querySelectorAll("track"),t=>t.track===e))||t.remove())}}get textTracks(){var e;return null==(e=this.media)?void 0:e.textTracks}};function nn(e,t){return e.media?e.media.getAttribute(t):e.getAttribute(t)}rj=new WeakMap,rH=new WeakMap,rG=new WeakMap,rW=new WeakMap,r$=new WeakMap,rq=new WeakSet,rY=function(){var e,t,i,r;if(!ik(this,rj)){iP(this,rj,!0),iO(this,rQ,r0).call(this);try{if(customElements.upgrade(this.mediaTheme),!(this.mediaTheme instanceof ij.HTMLElement))throw""}catch{rr("<media-theme> failed to upgrade!")}try{if(customElements.upgrade(this.media),!(this.media instanceof iC))throw""}catch{rr("<mux-video> failed to upgrade!")}try{if(customElements.upgrade(this.mediaController),!(this.mediaController instanceof l.LZ))throw""}catch{rr("<media-controller> failed to upgrade!")}r=this,r.querySelectorAll(":scope > track").forEach(e=>{var t;null==(t=r.media)||t.append(e.cloneNode())}),rl.forEach(e=>{var t;null==(t=r.media)||t.addEventListener(e,e=>{r.dispatchEvent(new Event(e.type))})}),iO(this,r1,r2).call(this),iO(this,r3,r5).call(this),iO(this,r4,r6).call(this),iP(this,rG,null==(t=null==(e=this.mediaController)?void 0:e.hasAttribute("userinactive"))||t),iO(this,r8,r7).call(this),null==(i=this.media)||i.addEventListener("streamtypechange",()=>{iO(this,rQ,r0).call(this)})}},rK=new WeakSet,rX=function(){var e,t;try{null==(e=null==window?void 0:window.CSS)||e.registerProperty({name:"--media-primary-color",syntax:"<color>",inherits:!0}),null==(t=null==window?void 0:window.CSS)||t.registerProperty({name:"--media-secondary-color",syntax:"<color>",inherits:!0})}catch{}},rZ=new WeakSet,rJ=function(e){Object.assign(ik(this,r$),e),iO(this,rQ,r0).call(this)},rQ=new WeakSet,r0=function(e={}){var t,i,r;let n;(function(e,t){e.renderInto(t)})(rC((t={...ik(this,r$),...e},{src:!this.playbackId&&this.src,playbackId:this.playbackId,hasSrc:!!this.playbackId||!!this.src,poster:this.poster,storyboard:this.storyboard,storyboardSrc:this.getAttribute(rB.STORYBOARD_SRC),placeholder:this.getAttribute("placeholder"),themeTemplate:function(e){var t,i;let r=e.theme;if(r){let n=null==(i=null==(t=e.getRootNode())?void 0:t.getElementById)?void 0:i.call(t,r);if(n&&n instanceof HTMLTemplateElement)return n;r.startsWith("media-theme-")||(r=`media-theme-${r}`);let a=ij.customElements.get(r);if(null!=a&&a.template)return a.template}}(this),thumbnailTime:!this.tokens.thumbnail&&this.thumbnailTime,autoplay:this.autoplay,crossOrigin:this.crossOrigin,loop:this.loop,noHotKeys:this.hasAttribute(rB.NOHOTKEYS),hotKeys:this.getAttribute(rB.HOTKEYS),muted:this.muted,paused:this.paused,preload:this.preload,envKey:this.envKey,preferCmcd:this.preferCmcd,debug:this.debug,disableCookies:this.disableCookies,tokens:this.tokens,beaconCollectionDomain:this.beaconCollectionDomain,maxResolution:this.maxResolution,metadata:this.metadata,playerSoftwareName:this.playerSoftwareName,playerSoftwareVersion:this.playerSoftwareVersion,startTime:this.startTime,preferPlayback:this.preferPlayback,audio:this.audio,defaultStreamType:this.defaultStreamType,targetLiveWindow:this.getAttribute(iM.TARGET_LIVE_WINDOW),streamType:i7(this.getAttribute(iM.STREAM_TYPE)),primaryColor:this.primaryColor,secondaryColor:this.secondaryColor,forwardSeekOffset:this.forwardSeekOffset,backwardSeekOffset:this.backwardSeekOffset,defaultHiddenCaptions:this.defaultHiddenCaptions,defaultShowRemainingTime:this.defaultShowRemainingTime,hideDuration:(n=null==(r=this.mediaController)?void 0:r.querySelector("media-time-display"))&&"none"===getComputedStyle(n).getPropertyValue("--media-duration-display-display").trim(),playbackRates:this.getAttribute(rB.PLAYBACK_RATES),customDomain:null!=(i=this.getAttribute(iM.CUSTOM_DOMAIN))?i:void 0,title:this.getAttribute(rB.TITLE),novolumepref:this.hasAttribute(rB.NO_VOLUME_PREF),...t})),this.shadowRoot)},r1=new WeakSet,r2=function(){let e=e=>{var t,i;if(!(null!=e&&e.startsWith("theme-")))return;let r=e.replace(/^theme-/,"");if(rV.includes(r))return;let n=this.getAttribute(e);null!=n?null==(t=this.mediaTheme)||t.setAttribute(r,n):null==(i=this.mediaTheme)||i.removeAttribute(r)};new MutationObserver(t=>{for(let{attributeName:i}of t)e(i)}).observe(this,{attributes:!0}),this.getAttributeNames().forEach(e)},r3=new WeakSet,r5=function(){var e;this.addEventListener("error",e=>{let{detail:t}=e;if(t instanceof q||(t=new q(t.message,t.code,t.fatal)),!(null!=t&&t.fatal)){ri(t),t.data&&ri(`${t.name} data:`,t.data);return}let{dialog:i,devlog:r}=rk(t,!window.navigator.onLine,this.playbackId,this.playbackToken);r.message&&rn(r),rr(t),t.data&&rr(`${t.name} data:`,t.data),iO(this,rZ,rJ).call(this,{isDialogOpen:!0,dialog:i})}),this.media&&(this.media.errorTranslator=(e={})=>{var t,i,r;if(!((null==(t=this.media)?void 0:t.error)instanceof q))return e;let{devlog:n}=rk(null==(i=this.media)?void 0:i.error,!window.navigator.onLine,this.playbackId,this.playbackToken,!1);return{player_error_code:null==(r=this.media)?void 0:r.error.code,player_error_message:n.message?String(n.message):e.player_error_message,player_error_context:n.context?String(n.context):e.player_error_context}}),null==(e=this.media)||e.addEventListener("error",e=>{var t,i;let{detail:r}=e;if(!r){let{message:e,code:n}=null!=(i=null==(t=this.media)?void 0:t.error)?i:{};r=new q(e,n)}null!=r&&r.fatal&&this.dispatchEvent(new CustomEvent("error",{detail:r}))})},r4=new WeakSet,r6=function(){var e,t,i,r;let n=()=>iO(this,rQ,r0).call(this);null==(t=null==(e=this.media)?void 0:e.textTracks)||t.addEventListener("addtrack",n),null==(r=null==(i=this.media)?void 0:i.textTracks)||r.addEventListener("removetrack",n)},r8=new WeakSet,r7=function(){var e,t;let i=/.*Version\/.*Safari\/.*/.test(navigator.userAgent);if(!/Firefox/i.test(navigator.userAgent))return;let r,n=new WeakMap,a=()=>this.streamType===Z.LIVE&&!this.secondaryColor&&this.offsetWidth>=800,s=(e,t,r=!1)=>{a()||Array.from(e&&e.activeCues||[]).forEach(e=>{if(!(!e.snapToLines||e.line<-5||e.line>=0&&e.line<10)){if(!t||this.paused){let t=e.text.split(`
`).length,a=i?-2:-3;this.streamType===Z.LIVE&&(a=i?-1:-2);let s=a-t;(e.line!==s||r)&&(n.has(e)||n.set(e,e.line),e.line=s-1,e.line=s)}else setTimeout(()=>{e.line=n.get(e)||"auto"},500)}})},o=()=>{var e,t;s(r,null!=(t=null==(e=this.mediaController)?void 0:e.hasAttribute("userinactive"))&&t)},l=()=>{var e,t;let i=Array.from((null==(t=null==(e=this.mediaController)?void 0:e.media)?void 0:t.textTracks)||[]).filter(e=>["subtitles","captions"].includes(e.kind)&&"showing"===e.mode)[0];i!==r&&(null==r||r.removeEventListener("cuechange",o)),null==(r=i)||r.addEventListener("cuechange",o),s(r,ik(this,rG))};if(l(),null==(e=this.textTracks)||e.addEventListener("change",l),null==(t=this.textTracks)||t.addEventListener("addtrack",l),navigator.userAgent.includes("Chrome/")){let e=()=>{s(r,ik(this,rG),!0),this.paused||window.requestAnimationFrame(e)};this.addEventListener("playing",()=>{e()})}this.addEventListener("userinactivechange",()=>{var e,t;let i=null==(t=null==(e=this.mediaController)?void 0:e.hasAttribute("userinactive"))||t;ik(this,rG)!==i&&(iP(this,rG,i),s(r,ik(this,rG)))})},ij.customElements.get("mux-player")||(ij.customElements.define("mux-player",nr),ij.MuxPlayerElement=nr);var na={className:"class",classname:"class",htmlFor:"for",crossOrigin:"crossorigin",viewBox:"viewBox",playsInline:"playsinline",autoPlay:"autoplay",playbackRate:"playbackrate"},ns=e=>null==e,no=(e,t)=>!ns(t)&&e in t,nl=e=>e.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`),nu=(e,t)=>{if(!("boolean"==typeof t&&!t))return no(e,na)?na[e]:/[A-Z]/.test(e)?nl(e):e},nc=(e,t)=>"boolean"==typeof e?"":e,nd=(e={})=>Object.entries(e).reduce((e,[t,i])=>{let r=nu(t,i);if(!r)return e;let n=nc(i,t);return e[r]=n,e},{}),nh=(...e)=>{let t=(0,s.useRef)(null);return(0,s.useEffect)(()=>{e.forEach(e=>{e&&("function"==typeof e?e(t.current):e.current=t.current)})},[e]),t},nf=Object.prototype.hasOwnProperty,np=(e,t)=>{if(Object.is(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;if(Array.isArray(e))return!!Array.isArray(t)&&e.length===t.length&&e.some((e,i)=>t[i]===e);let i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(let r=0;r<i.length;r++)if(!nf.call(t,i[r])||!Object.is(e[i[r]],t[i[r]]))return!1;return!0},nm=(e,t,i)=>!np(t,e[i]),ng=(e,t,i)=>{e[i]=t},nv=(e,t,i,r=ng,n=nm)=>(0,s.useEffect)(()=>{let a=null==i?void 0:i.current;a&&n(a,t,e)&&r(a,t,e)},[null==i?void 0:i.current,t]),ny=(()=>{try{return"1.12.1"}catch{}return"UNKNOWN"})(),nb=s.forwardRef(({children:e,...t},i)=>s.createElement("mux-player",nd({...t,ref:i}),e)),n_=(e,t,i)=>(0,s.useEffect)(()=>{let r=null==t?void 0:t.current;if(!(!r||!i))return r.addEventListener(e,i),()=>{r.removeEventListener(e,i)}},[null==t?void 0:t.current,i]),nE=(e,t)=>{let{onAbort:i,onCanPlay:r,onCanPlayThrough:n,onEmptied:a,onLoadStart:s,onLoadedData:o,onLoadedMetadata:l,onProgress:u,onDurationChange:c,onVolumeChange:d,onRateChange:h,onResize:f,onWaiting:p,onPlay:m,onPlaying:g,onTimeUpdate:v,onPause:y,onSeeking:b,onSeeked:_,onStalled:E,onSuspend:S,onEnded:x,onError:T,onCuePointChange:w,onCuePointsChange:A,metadata:M,tokens:R,paused:C,playbackId:I,playbackRates:L,currentTime:k,themeProps:D,...P}=t;return nv("playbackRates",L,e),nv("metadata",M,e),nv("themeProps",D,e),nv("tokens",R,e),nv("playbackId",I,e),nv("paused",C,e,(e,t)=>{null!=t&&(t?e.pause():e.play())},(e,t,i)=>(!e.hasAttribute("autoplay")||!!e.hasPlayed)&&nm(e,t,i)),nv("currentTime",k,e,(e,t)=>{null!=t&&(e.currentTime=t)}),n_("abort",e,i),n_("canplay",e,r),n_("canplaythrough",e,n),n_("emptied",e,a),n_("loadstart",e,s),n_("loadeddata",e,o),n_("loadedmetadata",e,l),n_("progress",e,u),n_("durationchange",e,c),n_("volumechange",e,d),n_("ratechange",e,h),n_("resize",e,f),n_("waiting",e,p),n_("play",e,m),n_("playing",e,g),n_("timeupdate",e,v),n_("pause",e,y),n_("seeking",e,b),n_("seeked",e,_),n_("stalled",e,E),n_("suspend",e,S),n_("ended",e,x),n_("error",e,T),n_("cuepointchange",e,w),n_("cuepointschange",e,A),[P]},nS=s.forwardRef((e,t)=>{let i=(0,s.useRef)(null),r=nh(i,t),[n]=nE(i,e);return s.createElement(nb,{ref:r,playerSoftwareName:"mux-player-react",playerSoftwareVersion:ny,...n})}),nx=i(3982),nT=i(68879),nw=i.n(nT);let nA=async e=>{let t="https://stream.mux.com/".concat(e),i=["high.mp4","medium.mp4","low.mp4"],r="";for(;i.length;){let e;let n=i.shift();try{e=await fetch("".concat(t,"/").concat(n),{method:"HEAD"})}catch(e){console.error("Failed to fetch the mp4 source ".concat(n))}if(404!==e.status){r="".concat(t,"/").concat(n);break}}return r},nM=e=>{let{data:t}=e,{title:i,playbackId:n,autoplay:a,controls:l}=t,u=(0,s.useRef)(null),c=(0,o.Y)(u,{margin:"100%",once:!0}),[d,h]=(0,s.useState)(!1),f=(0,o.Y)(u),[p,m]=(0,s.useState)(""),g=(0,s.useRef)(!1);return nA(n).then(e=>m(e)),(0,s.useEffect)(()=>{d&&a&&u.current&&(f&&!g.current?u.current.play().then(()=>{g.current=!0}):(u.current.pause(),g.current=!1))},[d,f,a]),(0,r.jsx)(nS,{ref:u,muted:!0,playsInline:!0,loop:a,metadata:i&&c?{video_title:i}:void 0,src:p,className:nw().muxVideo,thumbnailTime:0,style:{"--controls":l?"unset":"none","--media-object-fit":"cover"},onLoadedMetadata:()=>h(!0),onError:e=>console.error(e)})};var nR=(0,s.memo)(e=>{let{data:t,className:i}=e,n=!(0,nx.Z)(e=>e.showCoverPlane),a=null==t?void 0:t.aspectRatio;return(0,r.jsx)("div",{style:{aspectRatio:a},className:i,children:n?(0,r.jsx)(nM,{data:t}):null})}),nC=i(24061),nI=e=>{var t,i;let{data:s,className:o}=e,l=null==s?void 0:s.media,u=null==l?void 0:null===(t=l.image)||void 0===t?void 0:t.caption;if(!l)return null;switch(null==l?void 0:l.type){case"image":return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.Z,{alt:(null==l?void 0:null===(i=l.image)||void 0===i?void 0:i.alt)||"",className:(0,n.Z)(nw().image,o),fill:!0,image:null==l?void 0:l.image,loading:"lazy"}),u&&(0,r.jsx)(nC.YS,{children:u})]});case"video":return(0,r.jsx)(nR,{className:(0,n.Z)(nw().video,o),data:null==l?void 0:l.video});default:return null}}},14379:function(e,t,i){"use strict";var r=i(92854),n=i(3982);t.Z=e=>{(0,r.cr)({withCoverPlane:!0}),n.Z.setState({coverColor:e})}},42830:function(e,t,i){"use strict";var r=i(11527);i(50959);var n=i(45924),a=i(24061),s=i(32718),o=i.n(s);t.Z=e=>{let{label:t,suffix:i,as:s,className:l,...u}=e,c=Array.isArray(i)?i.map(e=>e.name).join(", "):i;return(0,r.jsxs)(a.H6,{as:s,className:(0,n.Z)(o().labelWrapper,l),...u,children:[(0,r.jsx)("span",{className:o().label,children:t}),i.length&&(0,r.jsxs)("span",{className:o().suffixWrapper,children:[(0,r.jsx)("span",{className:o().dash}),(0,r.jsx)("span",{className:o().suffix,children:c})]})]})}},37276:function(e,t,i){"use strict";i.d(t,{Z:function(){return r.Z}});var r=i(42830)},98819:function(e,t,i){"use strict";var r=i(11527),n=i(50959),a=i(74611),s=i(45924),o=i(80202),l=i(14813),u=i(89602),c=i.n(u);t.Z=e=>{let{to:t,children:i,className:u,textClassName:d,arrowClassName:h,onClick:f,type:p="internal",underline:m="double",hasArrow:g=!1}=e,{pathname:v}=(0,o.useRouter)(),y=(0,n.useRef)("/contact"===v),b={[c().none]:"none"===m,[c().single]:"single"===m,[c().double]:"double"===m,[c().contact]:y.current};return(0,r.jsxs)(a.Z,{className:(0,s.Z)(c().link,b,u),onClick:f,to:t,children:[(0,r.jsx)("span",{className:(0,s.Z)(c().label,d),children:i}),g&&(0,r.jsx)(l.Z,{className:(0,s.Z)(c().arrow,[c()[p]],h)})]})}},11305:function(e,t,i){"use strict";i.d(t,{Z:function(){return r.Z}});var r=i(98819)},46685:function(e,t,i){"use strict";i.d(t,{Z:function(){return w}});var r=i(11527),n=i(45924),a=i(24061),s=i(74611),o=i(50959),l=i(42281),u=i(11444),c=i(65888);function d(){let e=!1,t=new Set,i={subscribe:e=>(t.add(e),()=>void t.delete(e)),start(i,r){(0,l.k)(e,"controls.start() should only be called after a component has mounted. Consider calling within a useEffect hook.");let n=[];return t.forEach(e=>{n.push((0,c.d)(e,i,{transitionOverride:r}))}),Promise.all(n)},set:i=>((0,l.k)(e,"controls.set() should only be called after a component has mounted. Consider calling within a useEffect hook."),t.forEach(e=>{(0,u.gg)(e,i)})),stop(){t.forEach(e=>{!function(e){e.values.forEach(e=>e.stop())}(e)})},mount:()=>(e=!0,()=>{e=!1,i.stop()})};return i}var h=i(23090),f=i(59089),p=i(59295),m=i(91306),g=i(95158),v=i.n(g),y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"above",[i,r]=(0,o.useState)(!1),n={};for(let e in v())if(e.includes("breakpoint")){let t=e.replace("breakpoint-",""),i=parseInt(v()[e].replace("px",""));n[t]=i}let a=n[e],s="above"===t?a:a-1,l="above"===t?"min":"max";return(0,o.useEffect)(()=>{let e=()=>{let e=window.matchMedia("(".concat(l,"-width: ").concat(s,"px)"));r(e.matches)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[s,l]),i},b=i(24433),_=i.n(b),E=e=>{var t;let{children:i,stagger:a=.04,className:s}=e,[l,u]=(0,o.useState)(!1),c=y("desktop"),g=function(){let e=(0,h.h)(d);return(0,f.L)(e.mount,[]),e}();return((0,o.useEffect)(()=>{c&&l&&(g.set({y:"0%",opacity:1}),g.start(e=>({opacity:[1,.3,1],transition:{times:[0,.5,1],duration:.4,delay:e.index*a,ease:m.U2}})))},[c,l,g,a]),i&&"string"==typeof i)?(0,r.jsx)("span",{className:(0,n.Z)(s),onMouseEnter:()=>u(!0),onMouseLeave:()=>u(!1),children:null===(t=i.split(""))||void 0===t?void 0:t.map((e,t)=>(0,r.jsx)(p.E.span,{className:(0,n.Z)(_().character),animate:g,custom:{index:t},children:" "===e?"\xa0":e},"hoverAnimation-".concat(e,"-").concat(t)))}):null},S=i(14813),x=i(22050),T=i.n(x),w=e=>{let{to:t,children:i,type:o="internal",textComponent:l=a.Iy,hasArrow:u=!1,onClick:c,className:d,textClassName:h,arrowClassName:f,preventScroll:p=!1,hoverStagger:m}=e;return(0,r.jsx)(s.Z,{to:t,onClick:c,className:(0,n.Z)(T().link,{[T().hasArrow]:u},d),...p&&{preventScroll:p},children:(0,r.jsxs)(l,{as:"span",className:(0,n.Z)(T().text,h),children:[(0,r.jsx)(E,{stagger:m,children:i}),u&&(0,r.jsx)(S.Z,{className:(0,n.Z)(T().arrow,[T()[o]],f)})]})})}},93178:function(e,t,i){"use strict";i.d(t,{Z:function(){return r.Z}});var r=i(46685)},8329:function(e,t,i){"use strict";i.d(t,{Z:function(){return ef}});var r=i(11527),n=i(50959),a=i(45924);function s(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?s(Object(i),!0).forEach(function(t){var r,n;r=t,n=i[t],(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function l(e){return"span"===e._type&&"text"in e&&"string"==typeof e.text&&(void 0===e.marks||Array.isArray(e.marks)&&e.marks.every(e=>"string"==typeof e))}function u(e){return"string"==typeof e._type&&"@"!==e._type[0]&&(!("markDefs"in e)||!e.markDefs||Array.isArray(e.markDefs)&&e.markDefs.every(e=>"string"==typeof e._key))&&"children"in e&&Array.isArray(e.children)&&e.children.every(e=>"object"==typeof e&&"_type"in e)}function c(e){return u(e)&&"listItem"in e&&"string"==typeof e.listItem&&(void 0===e.level||"number"==typeof e.level)}function d(e){return"@list"===e._type}function h(e){return"@span"===e._type}function f(e){return"@text"===e._type}let p=["strong","em","code","underline","strike-through"];function m(e,t,i){if(!l(e)||!e.marks||!e.marks.length)return[];let r=e.marks.slice(),n={};return r.forEach(e=>{n[e]=1;for(let r=t+1;r<i.length;r++){let t=i[r];if(t&&l(t)&&Array.isArray(t.marks)&&-1!==t.marks.indexOf(e))n[e]++;else break}}),r.sort((e,t)=>(function(e,t,i){let r=e[t],n=e[i];if(r!==n)return n-r;let a=p.indexOf(t),s=p.indexOf(i);return a!==s?a-s:t.localeCompare(i)})(n,e,t))}function g(e,t,i){return{_type:"@list",_key:"".concat(e._key||"".concat(t),"-parent"),mode:i,level:e.level||1,listItem:e.listItem,children:[e]}}function v(e,t){let i=t.level||1,r=t.listItem||"normal",n="string"==typeof t.listItem;if(d(e)&&(e.level||1)===i&&n&&(e.listItem||"normal")===r)return e;if(!("children"in e))return;let a=e.children[e.children.length-1];return a&&!l(a)?v(a,t):void 0}let y=["block","list","listItem","marks","types"],b=["listItem"],_=["_key"];function E(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function S(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?E(Object(i),!0).forEach(function(t){var r,n;r=t,n=i[t],(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):E(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function x(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)i=a[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)i=a[r],!(t.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function T(e,t,i){let r=t[i],n=e[i];return"function"==typeof r||r&&"function"==typeof n?r:r?S(S({},n),r):n}let w={textDecoration:"underline"},A=(e,t)=>"[@portabletext/react] Unknown ".concat(e,", specify a component for it in the `components.").concat(t,"` prop"),M=e=>A('block type "'.concat(e,'"'),"types"),R=e=>A('mark type "'.concat(e,'"'),"marks"),C=e=>A('block style "'.concat(e,'"'),"block"),I=e=>A('list style "'.concat(e,'"'),"list"),L=e=>A('list item style "'.concat(e,'"'),"listItem");function k(e){console.warn(e)}let D={display:"none"},P={types:{},block:{normal:e=>{let{children:t}=e;return(0,r.jsx)("p",{children:t})},blockquote:e=>{let{children:t}=e;return(0,r.jsx)("blockquote",{children:t})},h1:e=>{let{children:t}=e;return(0,r.jsx)("h1",{children:t})},h2:e=>{let{children:t}=e;return(0,r.jsx)("h2",{children:t})},h3:e=>{let{children:t}=e;return(0,r.jsx)("h3",{children:t})},h4:e=>{let{children:t}=e;return(0,r.jsx)("h4",{children:t})},h5:e=>{let{children:t}=e;return(0,r.jsx)("h5",{children:t})},h6:e=>{let{children:t}=e;return(0,r.jsx)("h6",{children:t})}},marks:{em:e=>{let{children:t}=e;return(0,r.jsx)("em",{children:t})},strong:e=>{let{children:t}=e;return(0,r.jsx)("strong",{children:t})},code:e=>{let{children:t}=e;return(0,r.jsx)("code",{children:t})},underline:e=>{let{children:t}=e;return(0,r.jsx)("span",{style:w,children:t})},"strike-through":e=>{let{children:t}=e;return(0,r.jsx)("del",{children:t})},link:e=>{let{children:t,value:i}=e;return(0,r.jsx)("a",{href:null==i?void 0:i.href,children:t})}},list:{number:e=>{let{children:t}=e;return(0,r.jsx)("ol",{children:t})},bullet:e=>{let{children:t}=e;return(0,r.jsx)("ul",{children:t})}},listItem:e=>{let{children:t}=e;return(0,r.jsx)("li",{children:t})},hardBreak:()=>(0,r.jsx)("br",{}),unknownType:e=>{let{value:t,isInline:i}=e,n=M(t._type);return i?(0,r.jsx)("span",{style:D,children:n}):(0,r.jsx)("div",{style:D,children:n})},unknownMark:e=>{let{markType:t,children:i}=e;return(0,r.jsx)("span",{className:"unknown__pt__mark__".concat(t),children:i})},unknownList:e=>{let{children:t}=e;return(0,r.jsx)("ul",{children:t})},unknownListItem:e=>{let{children:t}=e;return(0,r.jsx)("li",{children:t})},unknownBlockStyle:e=>{let{children:t}=e;return(0,r.jsx)("p",{children:t})}};function O(e){let{value:t,components:i,listNestingMode:a,onMissingComponent:s=k}=e,l=s||F,u=Array.isArray(t)?t:[t],d=function(e,t){let i;let r=[];for(let a=0;a<e.length;a++){let s=e[a];if(s){var n;if(!c(s)){r.push(s),i=void 0;continue}if(!i){i=g(s,a,t),r.push(i);continue}if(n=i,(s.level||1)===n.level&&s.listItem===n.listItem){i.children.push(s);continue}if((s.level||1)>i.level){let e=g(s,a,t);if("html"===t){let t=i.children[i.children.length-1],r=o(o({},t),{},{children:[...t.children,e]});i.children[i.children.length-1]=r}else i.children.push(e);i=e;continue}if((s.level||1)<i.level){let e=r[r.length-1],n=e&&v(e,s);if(n){(i=n).children.push(s);continue}i=g(s,a,t),r.push(i);continue}if(s.listItem!==i.listItem){let e=r[r.length-1],n=e&&v(e,{level:s.level||1});if(n&&n.listItem===s.listItem){(i=n).children.push(s);continue}i=g(s,a,t),r.push(i);continue}console.warn("Unknown state encountered for block",s),r.push(s)}}return r}(u,a||"html"),h=(0,n.useMemo)(()=>i?function(e,t){let{block:i,list:r,listItem:n,marks:a,types:s}=t,o=x(t,y);return S(S({},e),{},{block:T(e,t,"block"),list:T(e,t,"list"),listItem:T(e,t,"listItem"),marks:T(e,t,"marks"),types:T(e,t,"types")},o)}(P,i):P,[i]),f=(0,n.useMemo)(()=>N(h,l),[h,l]),p=d.map((e,t)=>f({node:e,index:t,isInline:!1,renderNode:f}));return(0,r.jsx)(r.Fragment,{children:p})}let N=(e,t)=>function i(n){let{node:a,index:s,isInline:o}=n,l=a._key||"node-".concat(s);return d(a)?function(n,a,s){let o=n.children.map((e,t)=>i({node:e._key?e:S(S({},e),{},{_key:"li-".concat(a,"-").concat(t)}),index:t,isInline:!1,renderNode:i})),l=e.list,u="function"==typeof l?l:l[n.listItem],c=u||e.unknownList;if(c===e.unknownList){let e=n.listItem||"bullet";t(I(e),{nodeType:"listStyle",type:e})}return(0,r.jsx)(c,{value:n,index:a,isInline:!1,renderNode:i,children:o},s)}(a,s,l):c(a)?function(n,a,s){let o=U({node:n,index:a,isInline:!1,renderNode:i}),l=e.listItem,u="function"==typeof l?l:l[n.listItem],c=u||e.unknownListItem;if(c===e.unknownListItem){let e=n.listItem||"bullet";t(L(e),{type:e,nodeType:"listItemStyle"})}let d=o.children;if(n.style&&"normal"!==n.style){let{listItem:e}=n,t=x(n,b);d=i({node:t,index:a,isInline:!1,renderNode:i})}return(0,r.jsx)(c,{value:n,index:a,isInline:!1,renderNode:i,children:d},s)}(a,s,l):h(a)?function(n,a,s){let{markDef:o,markType:l,markKey:u}=n,c=e.marks[l]||e.unknownMark,d=n.children.map((e,t)=>i({node:e,index:t,isInline:!0,renderNode:i}));return c===e.unknownMark&&t(R(l),{nodeType:"mark",type:l}),(0,r.jsx)(c,{text:function e(t){let i="";return t.children.forEach(t=>{f(t)?i+=t.text:h(t)&&(i+=e(t))}),i}(n),value:o,markType:l,markKey:u,renderNode:i,children:d},s)}(a,0,l):a._type in e.types?function(t,n,a,s){let o=e.types[t._type];return o?(0,r.jsx)(o,S({},{value:t,isInline:s,index:n,renderNode:i}),a):null}(a,s,l,o):u(a)?function(n,a,s,o){let l=U({node:n,index:a,isInline:o,renderNode:i}),{_key:u}=l,c=x(l,_),d=c.node.style||"normal",h="function"==typeof e.block?e.block:e.block[d],f=h||e.unknownBlockStyle;return f===e.unknownBlockStyle&&t(C(d),{nodeType:"blockStyle",type:d}),(0,r.jsx)(f,S(S({},c),{},{value:c.node,renderNode:i}),s)}(a,s,l,o):f(a)?function(t,i){if("\n"===t.text){let t=e.hardBreak;return t?(0,r.jsx)(t,{},i):"\n"}return t.text}(a,l):function(n,a,s,o){t(M(n._type),{nodeType:"block",type:n._type});let l=e.unknownType;return(0,r.jsx)(l,S({},{value:n,isInline:o,index:a,renderNode:i}),s)}(a,s,l,o)};function U(e){let{node:t,index:i,isInline:r,renderNode:n}=e,a=function(e){var t;let{children:i,markDefs:r=[]}=e;if(!i||!i.length)return[];let n=i.map(m),a={_type:"@span",children:[],markType:"<unknown>"},s=[a];for(let e=0;e<i.length;e++){let a=i[e];if(!a)continue;let o=n[e]||[],u=1;if(s.length>1)for(;u<s.length;u++){let e=(null==(t=s[u])?void 0:t.markKey)||"",i=o.indexOf(e);if(-1===i)break;o.splice(i,1)}let c=(s=s.slice(0,u))[s.length-1];if(c){for(let e of o){let t=r.find(t=>t._key===e),i=t?t._type:e,n={_type:"@span",_key:a._key,children:[],markDef:t,markType:i,markKey:e};c.children.push(n),s.push(n),c=n}if(l(a)){let e=a.text.split("\n");for(let t=e.length;t-- >1;)e.splice(t,0,"\n");c.children=c.children.concat(e.map(e=>({_type:"@text",text:e})))}else c.children=c.children.concat(a)}}return a.children}(t),s=a.map((e,t)=>n({node:e,isInline:!0,index:t,renderNode:n}));return{_key:t._key||"block-".concat(i),children:s,index:i,isInline:r,node:t}}function F(){}var B=i(13940),V=i.n(B);let z=e=>{let{as:t="li",children:i,className:n,...s}=e;return(0,r.jsx)(t,{...s,className:(0,a.Z)(n),children:i})},j=e=>{let{isOrderedList:t,...i}=e;return(0,r.jsx)(z,{as:"ul",className:(0,a.Z)(V().list,{[V().isOrderedList]:t}),...i})},H=e=>(0,r.jsx)(z,{as:"li",className:(0,a.Z)(V().item),...e}),G=e=>(0,r.jsx)(z,{as:"span",className:(0,a.Z)(V().marker),...e});var W=i(24061),$=i(11305),q=i(56711),Y=e=>{let{condition:t,container:i,fallback:r,children:n}=e;return t?i(n):r?r(n):n},K=i(20762),X=i(55129),Z=i(14379),J=i(67666),Q=i(13197),ee=i(44758),et=i(94727),ei=i(52998),er=i(71678),en=i(37276),ea=i(77980),es=i.n(ea),eo=i(87984),el=i.n(eo);let eu=el()(()=>i.e(4052).then(i.bind(i,64052)),{loadableGenerated:{webpack:()=>[64052]},ssr:!1});var ec=e=>{var t;let{data:i}=e,s=i.type===J.G.CaseStudy?"Case":"Journal",o=(0,n.useRef)(null),l=(0,X.Z)();return(0,r.jsx)(ee.Z,{as:"span",className:(0,a.Z)(es().container),children:(0,r.jsxs)(et.X,{as:"span",children:[(0,r.jsx)(et.s,{desktop:3,as:"span",className:(0,a.Z)(es().content),children:(0,r.jsxs)(ei.Z,{to:i.to,className:(0,a.Z)(es().link),onClick:e=>{e.metaKey||(0,Z.Z)(i.coverColor)},children:[(0,r.jsx)(W.Iy,{className:(0,a.Z)(es().body),as:"span",children:Q.C.SeeAlso}),(0,r.jsxs)("span",{className:(0,a.Z)(es().image),children:[(0,r.jsx)(er.Z,{className:(0,a.Z)(K.W2.hiddenWhenSmooth),alt:(null===(t=i.thumbnail)||void 0===t?void 0:t.alt)||"",fill:!0,forwardedRef:o,image:i.thumbnail,loading:"eager",ratio:1.5,sizes:"23.6vw"}),l&&(0,r.jsx)(K.bA,{children:(0,r.jsx)(K.e,{track:o,children:e=>(0,r.jsx)(eu,{element:o,parallaxSpeed:.11,hasReducedRipples:!0,...e})})})]}),(0,r.jsx)(en.Z,{label:i.name,suffix:s,as:"span"})]})}),(0,r.jsx)(et.s,{desktop:9,as:"span"})]})})},ed=i(43928),eh=i.n(ed),ef=e=>{let{className:t,defaultTextComponent:i=W.H6,hasMargins:s=!0,listComponent:o=W.H6,underlineLinks:l="double",linkHasArrow:u=!1,useItalic:c=!1,value:d}=e,h=(0,n.useMemo)(()=>({block:{normal:e=>{var t;let{children:n}=e;return"object"==typeof n[0]||"string"==typeof n[0]&&(null===(t=n[0])||void 0===t?void 0:t.length)>0?(0,r.jsx)(i,{as:"p",children:n}):null},h2:e=>{let{children:t}=e;return(0,r.jsx)(i,{as:"h2",children:t})}},list:{bullet:e=>{let{children:t}=e;return(0,r.jsx)(j,{children:t})},number:e=>{let{children:t}=e;return(0,r.jsx)(j,{as:"ol",isOrderedList:!0,children:t})}},listItem:{bullet:e=>{let{children:t}=e;return(0,r.jsxs)(H,{children:[(0,r.jsx)(G,{children:(0,r.jsx)(o,{as:"span"})}),(0,r.jsx)(o,{className:(0,a.Z)(eh().listChild),as:"span",children:t})]})},number:e=>{let{children:t}=e;return(0,r.jsxs)(H,{children:[(0,r.jsx)(G,{children:(0,r.jsx)(o,{as:"span"})}),(0,r.jsx)(o,{className:(0,a.Z)(eh().listChild),as:"span",children:t})]})}},types:{flexiMedia:e=>{let{value:t}=e;return(0,r.jsx)(q.Z,{data:t})}},marks:{strong:e=>{let{children:t}=e;return(0,r.jsx)("strong",{className:(0,a.Z)(eh().strong),children:t})},em:e=>{let{children:t}=e;return(0,r.jsx)("em",{className:(0,a.Z)(eh().emphasis,{[eh().useItalic]:c}),children:t})},code:e=>{let{children:t}=e;return(0,r.jsx)("code",{className:(0,a.Z)(eh().code),children:t})},flexiLink:e=>{let{children:t,value:i}=e;return(0,r.jsx)(Y,{condition:i.crossLinkThumbnail,container:e=>(0,r.jsxs)(r.Fragment,{children:[e,(0,r.jsx)(ec,{data:{...i.crossLinkThumbnail,to:i.url}})]}),children:(0,r.jsx)($.Z,{to:i.url,type:i.type,underline:l,hasArrow:u,children:t})})}}}),[i,o,l,u,c]);return(0,r.jsx)("div",{className:(0,a.Z)(eh().RichText,t,{[eh().hasMargins]:s}),children:(0,r.jsx)(O,{value:d,components:h})})}},33118:function(e,t,i){"use strict";i.d(t,{Z:function(){return r.Z}});var r=i(8329)},24061:function(e,t,i){"use strict";i.d(t,{Iy:function(){return m},YS:function(){return g},H1:function(){return u},H2:function(){return c},H3:function(){return d},H4:function(){return h},H5:function(){return f},H6:function(){return p},zt:function(){return o}});var r=i(11527),n=i(45924),a=i(25616),s=i.n(a);let o={h1:"h1",h2:"h2",caseStudyH2:"caseStudyH2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",body:"body",caption:"caption"},l=e=>{let{as:t="span",scale:i="body",children:a,className:l,...u}=e;return(0,r.jsx)(t,{...u,className:(0,n.Z)(s()[o["".concat(i)]],l),children:a})},u=e=>(0,r.jsx)(l,{as:"h1",scale:"h1",...e}),c=e=>(0,r.jsx)(l,{as:"h2",scale:"h2",...e}),d=e=>(0,r.jsx)(l,{as:"h3",scale:"h3",...e}),h=e=>(0,r.jsx)(l,{as:"h4",scale:"h4",...e}),f=e=>(0,r.jsx)(l,{as:"h5",scale:"h5",...e}),p=e=>(0,r.jsx)(l,{as:"h6",scale:"h6",...e}),m=e=>(0,r.jsx)(l,{as:"p",scale:"body",...e}),g=e=>(0,r.jsx)(l,{as:"span",scale:"caption",...e})},13197:function(e,t,i){"use strict";var r,n;i.d(t,{C:function(){return r}}),(n=r||(r={})).Awards="Awards",n.Industry="Industry",n.JobIn="Job in",n.Location="Location",n.MoreProjects="More Work",n.PublishedDate="Published date",n.ReadingTime="Reading time",n.SeeAlso="See also",n.ThisIsAbout="This is about",n.NotFoundHomeLink="Bring me Home"},3982:function(e,t,i){"use strict";i.d(t,{u:function(){return f},Z:function(){return h}});let r=e=>{let t;let i=new Set,r=(e,r)=>{let n="function"==typeof e?e(t):e;if(!Object.is(n,t)){let e=t;t=(null!=r?r:"object"!=typeof n)?n:Object.assign({},t,n),i.forEach(i=>i(t,e))}},n=()=>t,a={setState:r,getState:n,subscribe:e=>(i.add(e),()=>i.delete(e)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),i.clear()}};return t=e(r,n,a),a},n=e=>e?r(e):r;var a,s=i(50959),o=i(7231);let{useSyncExternalStoreWithSelector:l}=o,u=e=>{"function"!=typeof e&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");let t="function"==typeof e?n(e):e,i=(e,i)=>(function(e,t=e.getState,i){let r=l(e.subscribe,e.getState,e.getServerState||e.getState,t,i);return(0,s.useDebugValue)(r),r})(t,e,i);return Object.assign(i,t),i};var c=()=>(0,s.useEffect)(()=>{let e=Array.from(document.querySelectorAll('link[rel="stylesheet"][data-n-p]')).map(e=>({element:e,href:e.getAttribute("href")}));e.forEach(e=>{let{element:t}=e;return t.removeAttribute("data-n-p")});let t=[],i=new MutationObserver(i=>{let r=i.filter(e=>{let{target:t}=e;return"STYLE"===t.nodeName&&t.hasAttribute("data-n-href")}).map(e=>{let{target:t}=e;return{element:t,href:t.getAttribute("data-n-href")}});r.forEach(e=>{let{element:i,href:r}=e,n=t.includes(r);n?i.remove():(i.setAttribute("data-fouc-fix-n-href",r),i.removeAttribute("data-n-href"),t.push(r))}),e=e.reduce((e,i)=>{let{element:r,href:n}=i,a=t.includes(n);return a?r.remove():e.push(i),e},[])});return i.observe(document.head,{subtree:!0,attributeFilter:["media"]}),()=>i.disconnect()},[]);let d=(a=(e,t)=>({pageTheme:"light",setPageTheme:t=>e({pageTheme:t}),heroTextColor:"",setHeroTextColor:t=>e({heroTextColor:t}),debug:!1,showCoverPlane:!1,coverColor:void 0,showJournalEntries:!0,setShowJournalEntries:t=>e({showJournalEntries:t}),mobileMenuPageTransition:!1}))?u(a):u;var h=d;let f=()=>(c(),null)},21673:function(e,t,i){"use strict";var r=i(50959),n=i(92854),a=i(20762),s=i(3982);t.Z=()=>{let{isCanvasAvailable:e}=(0,a.hP)(),{transitionStateTo:t,transitionStateFrom:i}=(0,n.Cx)({onExiting:async t=>{let{data:i,done:r}=t;(null==i?void 0:i.withCoverPlane)&&e?(s.Z.setState({showCoverPlane:!0}),document.documentElement.classList.add("with-cover-plane"),await new Promise(e=>setTimeout(e,1e3)),document.documentElement.classList.remove("with-cover-plane")):(null==i?void 0:i.withMobileMenu)?(s.Z.setState({mobileMenuPageTransition:!0}),await new Promise(e=>setTimeout(e,500)),s.Z.setState({mobileMenuPageTransition:!1})):await new Promise(e=>setTimeout(e,500)),r()}}),[o,l]=(0,r.useState)("in");return(0,r.useEffect)(()=>{"exiting"===i&&l("out")},[i]),(0,r.useEffect)(()=>{("appearing"===t||"entering"===t)&&l("in")},[t]),"in"===o}},55129:function(e,t,i){"use strict";var r=i(50959),n=i(20762),a=i(95158),s=i.n(a);t.Z=()=>{let e=(0,n.gt)(e=>e.isCanvasAvailable),[t,i]=(0,r.useState)(null);return(0,r.useEffect)(()=>{function e(){let e=function(){let e=!!window.matchMedia("(min-width: ".concat(s()["breakpoint-desktop"],")")).matches,t=window.matchMedia("(hover: hover) and (pointer: fine)").matches,i=!!window.matchMedia("(prefers-reduced-motion: reduce").matches;return e&&t&&!i}();i(e)}return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[i]),t&&e}},26053:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return eT}});var r=i(11527);i(11405),i(32625),i(66705);var n=i(8301),a=i.n(n),s=i(80202),o=i(50959),l=i(20762),u=i(55129),c=i(92854),d=i(21673),h=()=>{let e=(0,d.Z)();return(0,o.useEffect)(()=>{e&&window.scrollTo(0,0)},[e]),null},f=e=>{var t;let{children:i}=e,n=(0,s.useRouter)();return(0,r.jsxs)(c.xv,{pageName:null===(t=n.asPath)||void 0===t?void 0:t.split("?")[0],children:[i,(0,r.jsx)(h,{})]})},p=i(80887),m=i(45924),g=i(3982),v=i(94727),y=i(74611),b=i(42157),_=i(93178),E=i(93936),S=i(24646),x=i.n(S),T=e=>{var t;let{data:i,pathname:n,isScrollingDown:a,disableTransition:s,isPageTransitioning:l,pageTheme:u}=e,[c,d]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{d(-1!==navigator.platform.indexOf("Win"))},[]),(0,r.jsx)(b.Z,{className:(0,m.Z)(x().container,[x()[u]],{[x().isHidden]:a&&!l,[x().hasTransition]:!s,[x().isPageTransitioning]:l}),children:(0,r.jsxs)(v.X,{className:(0,m.Z)(x().row),children:[(0,r.jsx)(v.s,{initial:6,desktop:6,children:(0,r.jsx)("div",{className:(0,m.Z)(x().logoWrapper),children:(0,r.jsx)(y.Z,{to:"/",className:(0,m.Z)(x().logoLink),ariaLabel:"Homepage",children:(0,r.jsx)(E.Z,{})})})}),(0,r.jsx)(v.s,{initial:6,desktop:6,children:(0,r.jsx)("nav",{className:(0,m.Z)(x().nav),children:(0,r.jsx)("ul",{className:(0,m.Z)(x().list),children:null==i?void 0:null===(t=i.links)||void 0===t?void 0:t.map(e=>{let{label:t,url:i}=e;if(t&&i)return(0,r.jsx)("li",{className:(0,m.Z)(x().item,{[x().isActive]:i===n}),children:(0,r.jsx)(_.Z,{to:i,className:(0,m.Z)(x().link,{[x().isWindows]:c}),preventScroll:!0,children:t})},"item-".concat(i))})})})})]})})},w=i(24061),A=i(60539),M=i.n(A),R=e=>{let{index:t,url:i,isActive:n,label:a,onLinkClick:s}=e;return(0,r.jsx)("li",{className:(0,m.Z)(M().item,{[M().isActive]:n}),children:(0,r.jsx)(y.Z,{to:i,className:(0,m.Z)(M().link),onClick:()=>s(t),children:(0,r.jsx)(w.H2,{as:"span",className:(0,m.Z)(M().label),children:a})})},"item-".concat(i))},C=e=>{var t;let{data:i,pathname:n,isScrollingDown:a,disableTransition:s,theme:l,pageTheme:u,isPageTransitioning:d}=e,[h,f]=(0,o.useState)(!1),[p,v]=(0,o.useState)(-1),_=(0,g.Z)(e=>e.mobileMenuPageTransition),S=e=>{h&&(v(e),(0,c.cr)({withMobileMenu:!0}))};return(0,o.useEffect)(()=>{_&&f(!1)},[_,f]),(0,o.useEffect)(()=>{h?document.documentElement.style.setProperty("overflow","hidden"):document.documentElement.style.removeProperty("overflow")},[h]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:(0,m.Z)(M().bar,[M()[h?u:l]],{[M().isHidden]:a&&!d,[M().hasTransition]:!s,[M().isPageTransitioning]:d}),children:(0,r.jsxs)(b.Z,{className:(0,m.Z)(M().barContainer),children:[(0,r.jsx)(y.Z,{to:"/",className:(0,m.Z)(M().logoLink),onClick:S,ariaLabel:"Homepage",children:(0,r.jsx)(E.Z,{})}),(0,r.jsx)("div",{className:(0,m.Z)(M().buttons),children:(0,r.jsx)(y.Z,{className:(0,m.Z)(M().button),onClick:()=>{f(e=>!e)},children:(0,r.jsxs)(w.Iy,{className:(0,m.Z)(M().label),children:[(0,r.jsx)("span",{className:(0,m.Z)(M().menuLabel,{[M().active]:!h}),children:null==i?void 0:i.mobileButton}),(0,r.jsx)("span",{className:(0,m.Z)(M().closeLabel,{[M().active]:h}),children:"close"})]})})})]})}),(0,r.jsx)("div",{className:(0,m.Z)(M().dialog,[M()[u]],{[M().isDialogOpen]:h,[M().hasDelay]:_}),children:(0,r.jsx)("nav",{children:(0,r.jsx)("ul",{children:null==i?void 0:null===(t=i.links)||void 0===t?void 0:t.map((e,t)=>{let{label:i,url:a}=e;if(i&&a)return(0,r.jsx)(R,{url:a,label:i,index:t,isActive:_?p===t:a===n,onLinkClick:S},"item-".concat(a))})})})})]})},I=i(90585),L=i.n(I),k=e=>{let{data:t}=e,[i,n]=(0,o.useState)(!1),[a,s]=(0,o.useState)(!1),u=(0,p.usePathname)(),c=(0,g.Z)(e=>e.pageTheme),h=(0,g.Z)(e=>e.heroTextColor),{onScroll:f}=(0,l.uW)(),v=(0,o.useRef)({lastY:0}).current,y=!(0,d.Z)();(0,o.useEffect)(()=>f(e=>{let t=e.scroll-v.lastY;t>0&&e.scroll>0&&!i?n(!0):t<0&&i&&n(!1);let r=0===e.scroll;r!==a&&s(r),v.lastY=e.scroll}),[f,v,i,a]);let b=h?"white"===h?"dark":"light":c;return(0,r.jsxs)("header",{className:(0,m.Z)(L().header,[L()[b]]),children:[(0,r.jsx)(C,{data:t,pathname:u,isScrollingDown:i,disableTransition:a,isPageTransitioning:y,theme:b,pageTheme:c}),(0,r.jsx)(T,{data:t,pathname:u,isScrollingDown:i,disableTransition:a,isPageTransitioning:y,pageTheme:c})]})},D=i(60644),P=i(44758),O=i(33118),N=i(30421),U=i(13214),F=i(19095);let B=e=>Math.sqrt(1-Math.pow(e-1,2));class V{initTexture(){this.canvas=document.createElement("canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.ctx=this.canvas.getContext("2d"),this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.texture=new F.Texture(this.canvas),this.canvas.id="touchTexture",this.canvas.style.width=this.canvas.style.height="".concat(this.canvas.width,"px")}update(e){this.clear(),this.trail.forEach((t,i)=>{t.age+=1e3*e,t.age>this.maxAge&&this.trail.splice(i,1)}),this.trail.length||(this.force=0),this.trail.forEach(e=>{this.drawTouch(e)}),this.texture.needsUpdate=!0}clear(){this.ctx.globalCompositeOperation="source-over",this.ctx.fillStyle="black",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}addTouch(e){let t=this.trail[this.trail.length-1];if(t){let i=t.x-e.x,r=t.y-e.y,n=i*i+r*r,a=Math.max(this.minForce,Math.min(1e4*n,1));if(this.force=function(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.9;return t*i+e*(1-i)}(a,this.force,this.smoothing),this.interpolate){let e=Math.ceil(n/Math.pow(.5*this.radius/this.interpolate,2));if(e>1)for(let n=1;n<e;n++)this.trail.push({x:t.x-i/e*n,y:t.y-r/e*n,age:0,force:a})}}this.trail.push({x:e.x,y:e.y,age:0,force:this.force})}drawTouch(e){let t={x:e.x*this.width,y:(1-e.y)*this.height},i=1;i=(e.age<.3*this.maxAge?this.ease(e.age/(.3*this.maxAge)):this.ease(1-(e.age-.3*this.maxAge)/(.7*this.maxAge)))*e.force,this.ctx.globalCompositeOperation=this.blend;let r=this.size*this.radius*i,n=this.ctx.createRadialGradient(t.x,t.y,Math.max(0,.25*r),t.x,t.y,Math.max(0,r));n.addColorStop(0,"rgba(255, 255, 255, ".concat(this.intensity,")")),n.addColorStop(1,"rgba(0, 0, 0, 0.0)"),this.ctx.beginPath(),this.ctx.fillStyle=n,this.ctx.arc(t.x,t.y,Math.max(0,r),0,2*Math.PI),this.ctx.fill()}constructor({width:e=256,height:t=256,maxAge:i=750,radius:r=.3,intensity:n=.2,interpolate:a=0,smoothing:s=0,minForce:o=.3,blend:l="screen",ease:u=B}={}){this.width=e,this.height=t,this.size=Math.min(this.width,this.height),this.maxAge=i,this.radius=r,this.intensity=n,this.ease=u,this.interpolate=a,this.smoothing=s,this.minForce=o,this.blend=l,this.trail=[],this.force=0,this.initTexture()}}var z=i(29324),j=i(77733),H=i(58684);let G=(0,H.g)({time:0,delta:0,trailTexture:null,map:null,bgColor:new F.Color(""),fadeSpeed:.14,lineStrength:1,bleedSpeed:.1,bleedThreshold:1.08,displacement:.5,noiseFrequency:15,noiseOctaves:3,saturation:.95,luminosity:.5,bleedBlur:0,lineBlur:0,aspectRatio:1},"\n    varying vec2 vUv;\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n    }\n  ","#define GLSLIFY 1\n// Fractal noise from https://github.com/yiwenl/glsl-fbm\n// Modified signature to accept num octaves as an optional 2nd parameter\n\n#define NUM_OCTAVES 5\n\nfloat rand(vec2 n) {\n    return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\n}\n\nfloat noise(vec2 p){\n    vec2 ip = floor(p);\n    vec2 u = fract(p);\n    u = u*u*(3.0-2.0*u);\n\n    float res = mix(\n    mix(rand(ip),rand(ip+vec2(1.0,0.0)),u.x),\n    mix(rand(ip+vec2(0.0,1.0)),rand(ip+vec2(1.0,1.0)),u.x),u.y);\n    return res*res;\n}\n\nfloat fbm(vec2 x, int numOctaves) {\n    float v = 0.0;\n    float a = 0.5;\n    vec2 shift = vec2(100);\n    // Rotate to reduce axial bias\n    mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.50));\n    for (int i = 0; i < numOctaves; ++i) {\n    v += a * noise(x);\n    x = rot * x * 2.0 + shift;\n    a *= 0.5;\n    }\n    return v;\n}\n\nfloat fbm(vec2 x) {\n    return fbm(x, NUM_OCTAVES);\n}\n\nfloat hue2rgb(float f1, float f2, float hue) {\n    if (hue < 0.0)\n        hue += 1.0;\n    else if (hue > 1.0)\n        hue -= 1.0;\n    float res;\n    if ((6.0 * hue) < 1.0)\n        res = f1 + (f2 - f1) * 6.0 * hue;\n    else if ((2.0 * hue) < 1.0)\n        res = f2;\n    else if ((3.0 * hue) < 2.0)\n        res = f1 + (f2 - f1) * ((2.0 / 3.0) - hue) * 6.0;\n    else\n        res = f1;\n    return res;\n}\n\nvec3 hsl2rgb(vec3 hsl) {\n    vec3 rgb;\n    \n    if (hsl.y == 0.0) {\n        rgb = vec3(hsl.z); // Luminance\n    } else {\n        float f2;\n        \n        if (hsl.z < 0.5)\n            f2 = hsl.z * (1.0 + hsl.y);\n        else\n            f2 = hsl.z + hsl.y - hsl.y * hsl.z;\n            \n        float f1 = 2.0 * hsl.z - f2;\n        \n        rgb.r = hue2rgb(f1, f2, hsl.x + (1.0/3.0));\n        rgb.g = hue2rgb(f1, f2, hsl.x);\n        rgb.b = hue2rgb(f1, f2, hsl.x - (1.0/3.0));\n    }   \n    return rgb;\n}\n\nvec3 hsl2rgb(float h, float s, float l) {\n    return hsl2rgb(vec3(h, s, l));\n}\n\nfloat blendDarken(float base, float blend) {\n	return min(blend,base);\n}\n\nvec3 blendDarken(vec3 base, vec3 blend) {\n	return vec3(blendDarken(base.r,blend.r),blendDarken(base.g,blend.g),blendDarken(base.b,blend.b));\n}\n\nvec3 blendDarken(vec3 base, vec3 blend, float opacity) {\n	return (blendDarken(base, blend) * opacity + base * (1.0 - opacity));\n}\n\nuniform vec3 bgColor;\nuniform float time;\nuniform float delta;\nuniform float fadeSpeed;\nuniform float lineStrength;\nuniform float bleedSpeed;\nuniform float bleedThreshold;\n\nuniform float displacement;\nuniform float noiseFrequency;\nuniform int noiseOctaves;\nuniform float bleedBlur;\nuniform float lineBlur;\nuniform float saturation;\nuniform float luminosity;\n\nuniform float aspectRatio;\nuniform sampler2D map;\nuniform sampler2D trailTexture;\n\nvarying vec2 vUv;\n\nvoid main() {\n    vec2 aspect = vec2(1.0, aspectRatio);\n\n    // Trail texture - drawing input\n    vec4 trail = texture2D(trailTexture, vUv, lineBlur);\n\n    // FBO frame (we draw on top of last frame)\n    vec4 texel = texture2D(map, vUv);\n    \n    // Displacement amount\n    float amp = displacement * 0.01;\n\n    // FBM noise\n    vec2 disp = fbm(vUv * noiseFrequency, noiseOctaves) * amp * aspect;\n\n    // Create bleed based on noise\n    vec4 texel2 = texture2D(map, vec2(vUv.x + disp.x, vUv.y), bleedBlur);\n    vec4 texel3 = texture2D(map, vec2(vUv.x, vUv.y + disp.y), bleedBlur);\n    vec4 texel4 = texture2D(map, vec2(vUv.x - disp.x, vUv.y), bleedBlur);\n    vec4 texel5 = texture2D(map, vec2(vUv.x, vUv.y - disp.y), bleedBlur);\n\n    vec3 fcolor = texel.rgb;\n         fcolor = blendDarken(fcolor, texel2.rgb);\n         fcolor = blendDarken(fcolor, texel3.rgb);\n         fcolor = blendDarken(fcolor, texel4.rgb);\n         fcolor = blendDarken(fcolor, texel5.rgb);\n\n    // LINE COLOR\n    vec3 gradientColor = hsl2rgb(mod(time*100./360.0, 1.0), saturation, luminosity);\n    float line = smoothstep(0.0, 1.0, trail.r);\n    vec3 lineColor = mix(vec3(1.), gradientColor, line);\n\n    // Mix last frame with new bleed color\n    vec3 waterColor = blendDarken(texel.rgb, fcolor.rgb * (1. + bleedThreshold * delta), bleedSpeed);\n\n    // Blend watercolor with line\n    vec3 finalColor = blendDarken(waterColor.rgb, lineColor.rgb, lineStrength);\n\n    // Fade out old drawings towards bg color\n    gl_FragColor.rgba = vec4(min(bgColor, finalColor * (1. + fadeSpeed * delta)), 1.);\n\n    // debug noise\n    // gl_FragColor.rgba = vec4(vec3(fbm(vUv * noiseFrequency, noiseOctaves)), 1.0);\n\n    // debug trail\n    // gl_FragColor.rgba = vec4(trail.rgb, 1.0);\n\n    #include <colorspace_fragment>\n}");function W(e){let{width:t,height:i,samples:n=8,frames:a=1/0,stencilBuffer:s=!1,depthBuffer:l=!1,generateMipmaps:u=!1,trailTexture:c,bgColor:d,...h}=e,f=(0,z.m)("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII="),p=(0,o.useRef)(),m=(0,o.useRef)(),{size:g,viewport:v,gl:y}=(0,U.z)(),[b]=(0,o.useState)(new F.Scene),_=(0,j.R)((t||g.width)*v.dpr,(i||g.height)*v.dpr,{samples:n,stencilBuffer:s,depthBuffer:l,generateMipmaps:u}),[E]=(0,o.useState)(new F.OrthographicCamera(-.5,.5,.5,-.5,1,2)),S=0;(0,U.A)((e,t)=>{let{state:i,clock:r}=e;p.current.time=r.getElapsedTime(),(a===1/0||S<a)&&(p.current.time=r.getElapsedTime(),p.current.delta=t,E.position.z=1.5,y.setRenderTarget(_),y.render(b,E),p.current.map=_.texture,y.setRenderTarget(null),S++,(0,U.l)())}),(0,o.useEffect)(()=>{y.setRenderTarget(_),p.current.map=f,y.render(b,E),y.setRenderTarget(null)},[_,f,b,E,y,g]);let x=(0,N.M4)("draw.watercolor",{fadeSpeed:{value:.62,min:0,max:1,step:.01},lineStrength:{value:1,min:0,max:1,step:.01},bleedSpeed:{value:.3,min:0,max:1,step:.01},bleedThreshold:{value:1.6,min:1.01,max:5,step:.01},saturation:{value:.7,min:0,max:1,step:.01},luminosity:{value:.48,min:0,max:1,step:.01}}),T=(0,N.M4)("draw.noise",{noiseFrequency:{value:22,min:1,max:100,step:1},noiseOctaves:{value:4,min:1,max:5,step:1},displacement:{value:.49,min:0,max:1,step:.01}});return(0,r.jsxs)(r.Fragment,{children:[(0,U.g)((0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("mesh",{ref:m,children:[(0,r.jsx)("planeGeometry",{args:[1,1]}),(0,r.jsx)("colorBleedMaterial",{ref:p,trailTexture:c,map:f,bgColor:d,aspectRatio:t/i,...x,...T},G.key)]})}),b),(0,r.jsx)("primitive",{object:_.texture,...h})]})}(0,U.e)({ColorBleedMaterial:G});var $=i(95158),q=i.n($);function Y(e){let{scale:t,inViewport:i}=e,{scaleMultiplier:n}=(0,l.hP)(),{alwaysOn:a,...s}=(0,N.M4)("draw.trail",{radius:{value:.06,min:0,max:.1,step:.01},maxAge:{value:50,min:0,max:1e3,step:25},intensity:{value:1,min:0,max:1},minForce:{value:.6,min:0,max:1,step:.1},interpolate:{value:2,min:0,max:5,step:1},smoothing:{value:0,min:0,max:1,step:.1},alwaysOn:!0}),[u,d]=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{width:t,height:i,maxAge:r,radius:n,intensity:a,interpolate:s,smoothing:l,minForce:u,blend:c,ease:d}=e,h=(0,o.useMemo)(()=>new V(e),[t,i,r,n,a,s,l,u,c,d]);(0,U.A)((e,t)=>void h.update(t));let f=(0,o.useCallback)(e=>h.addTouch(e.uv),[h]);return[h.texture,f]}({width:512,height:512*(t.y/t.x),...s,ease:e=>e}),[h,f]=(0,o.useState)(!1),{transitionStateFrom:p}=(0,c.Cx)(),m=p===c.Z9.EXITING;return(0,r.jsxs)("mesh",{scale:t,onPointerMove:function(e){(h||a)&&d(e)},onPointerDown:()=>f(!0),onPointerUp:()=>f(!1),onPointerCancel:()=>f(!1),visible:!m,children:[(0,r.jsx)("planeGeometry",{}),(0,r.jsx)("meshBasicMaterial",{children:(0,r.jsx)(W,{width:t.x/n,height:t.y/n,trailTexture:u,attach:"map",frames:i?1/0:0,bgColor:q()["color-white"]})})]})}var K=i(76905),X=i.n(K),Z=e=>{let{data:t}=e,i=(0,o.useRef)(null),n=(0,g.Z)(e=>e.pageTheme),a=(0,o.useRef)(null),s=(0,D.Y)(a,{amount:.33,once:!0}),u=(0,o.useRef)(null),c=(0,D.Y)(u,{once:!0});if(!t)return null;let{title:d,email:h,copyright:f,links:p}=t,b=t.isContactPage;return(0,r.jsxs)("footer",{ref:i,className:(0,m.Z)(X().footer,[X()[n]],{[X().isContactPage]:b}),children:[(0,r.jsx)(l.bA,{children:e=>{let{hasSmoothScrollbar:t}=e;if(t&&!b)return(0,r.jsx)(l.e,{track:i,children:e=>(0,r.jsx)(Y,{...e})})}}),(0,r.jsxs)(P.Z,{className:(0,m.Z)(X().container),children:[!b&&(0,r.jsxs)("div",{ref:a,className:(0,m.Z)(X().topContent,s&&X().isInView),children:[!!d&&d.length>0&&(0,r.jsx)(O.Z,{value:d,defaultTextComponent:w.H4,hasMargins:!1,className:(0,m.Z)(X().title)}),!!(null==h?void 0:h.url)&&!!(null==h?void 0:h.label)&&(0,r.jsxs)(v.X,{children:[(0,r.jsx)(v.s,{initial:1,medium:4,desktop:6}),(0,r.jsx)(v.s,{initial:3,medium:4,desktop:6,children:(0,r.jsx)(y.Z,{to:h.url,className:X().email,children:(0,r.jsx)(w.H4,{className:(0,m.Z)(X().label),children:h.label})})})]})]}),(0,r.jsxs)("div",{ref:u,className:(0,m.Z)(X().bottomBar,c&&X().isInView),children:[(0,r.jsxs)(v.X,{children:[(0,r.jsx)(v.s,{initial:1,medium:4,desktop:6,children:!!f&&(0,r.jsx)(w.Iy,{as:"span",className:(0,m.Z)(X().copyright,X().desktop),children:f})}),!!p&&p.length>0&&(0,r.jsx)(v.s,{initial:3,medium:4,desktop:6,children:(0,r.jsx)("ul",{className:(0,m.Z)(X().links),children:p.map(e=>(0,r.jsx)("li",{className:X().link,children:(0,r.jsx)(_.Z,{to:e.url,children:e.label})},"footer-link-".concat(e.url)))})})]}),!!f&&(0,r.jsx)("div",{className:(0,m.Z)(X().copyrightRow,X().mobile),children:(0,r.jsxs)(v.X,{children:[(0,r.jsx)(v.s,{initial:1,medium:4,desktop:0}),(0,r.jsx)(v.s,{initial:3,medium:4,desktop:6,children:(0,r.jsx)(w.Iy,{as:"span",className:(0,m.Z)(X().copyright),children:f})})]})})]})]})]})},J=i(60023),Q=i.n(J),ee=i(8329),et=i(95755),ei=i.n(et),er=function(e){let{data:t}=e,[i,n]=(0,o.useState)(!0),[a,s]=(0,o.useState)(!1),{transitionState:l}=(0,c.Cx)(),u=l===c.Z9.APPEARED||l===c.Z9.ENTERED;function d(e,t,i){window.dataLayer.push(arguments)}return(0,o.useEffect)(()=>{let e=null!==window.localStorage.getItem("consentMode");n(e),e&&s(!0)},[]),window.dataLayer=window.dataLayer||[],(0,r.jsx)("div",{className:(0,m.Z)(ei().cookieBar,{[ei().isVisible]:u&&!i,[ei().isHideAnimationEnded]:a}),onTransitionEnd:()=>i&&s(!0),children:(0,r.jsxs)("div",{className:(0,m.Z)(ei().cookieBarInner),children:[(0,r.jsx)(ee.Z,{value:null==t?void 0:t.copy,defaultTextComponent:w.Iy,underlineLinks:"none",linkHasArrow:!0,className:(0,m.Z)(ei().copy)}),(0,r.jsxs)("div",{className:(0,m.Z)(ei().buttons),children:[(0,r.jsx)("button",{onClick:()=>{n(!0);let e={ad_storage:"denied",analytics_storage:"denied"};window.localStorage.setItem("consentMode",JSON.stringify(e)),d("consent","update",e)},className:(0,m.Z)(ei().button,ei().rejectButton),children:(0,r.jsx)(w.Iy,{className:(0,m.Z)(ei().label),children:null==t?void 0:t.reject})}),(0,r.jsx)("button",{onClick:()=>{n(!0);let e={ad_storage:"granted",analytics_storage:"granted"};window.localStorage.setItem("consentMode",JSON.stringify(e)),d("consent","update",e)},className:(0,m.Z)(ei().button,ei().acceptButton),children:(0,r.jsx)(w.Iy,{className:(0,m.Z)(ei().label),children:null==t?void 0:t.accept})})]})]})})},en=function(e){let{data:t}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(Q(),{id:"gtag",strategy:"afterInteractive",dangerouslySetInnerHTML:{__html:"\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n\n            if(localStorage.getItem('consentMode') === null){\n              gtag('consent', 'default', {\n                'ad_storage': 'denied',\n                'analytics_storage': 'denied'\n              });\n            } else {\n              gtag('consent', 'default', JSON.parse(localStorage.getItem('consentMode')));\n            }\n            "}}),(0,r.jsx)(Q(),{id:"gtmScript",strategy:"afterInteractive",dangerouslySetInnerHTML:{__html:"\n            window.dataLayer = window.dataLayer || [];\n            function gtag(){dataLayer.push(arguments);}\n            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n            new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n            j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n            'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n            })(window,document,'script','dataLayer','".concat(null==t?void 0:t.gtmId,"');")}}),(null==t?void 0:t.gtmId)&&(0,r.jsx)(er,{data:t})]})},ea=()=>{let e=(0,s.useRouter)(),t=(0,g.Z)(e=>e.debug);return(0,o.useEffect)(()=>{void 0!==e.query.debug&&g.Z.setState({debug:!0})},[e]),(0,r.jsx)(N.Zf,{hidden:!t})};class es extends o.Component{static getDerivedStateFromError(e){return console.log("caught WEBL ERROR"),{hasError:!0}}render(){return this.props.children}constructor(e){super(e),this.state={hasError:!1}}}var eo=i(87984),el=i.n(eo),eu=i(18678),ec=i(92594),ed=i(91306);let eh=(0,H.g)({uTime:0,uDisplace:1,uFullscreenProgress:0,uNoiseProgress:0,uCircleProgress:0,uPlaneSize:new F.Vector2(0,0),uWindowSize:new F.Vector2(0,0),uColor:new F.Color(0,0,0),uOpacity:1,uNoiseAmplitude:.4,uNoiseFrequency:2,uNoiseSpeed:-.5,uNoiseOctaves:3},"#define GLSLIFY 1\n// Fractal noise from https://github.com/yiwenl/glsl-fbm\n// Modified signature to accept num octaves as an optional 2nd parameter\n\n#define NUM_OCTAVES 5\n\nfloat rand(vec2 n) {\n    return fract(sin(dot(n, vec2(12.9898, 4.1414))) * 43758.5453);\n}\n\nfloat noise(vec2 p){\n    vec2 ip = floor(p);\n    vec2 u = fract(p);\n    u = u*u*(3.0-2.0*u);\n\n    float res = mix(\n    mix(rand(ip),rand(ip+vec2(1.0,0.0)),u.x),\n    mix(rand(ip+vec2(0.0,1.0)),rand(ip+vec2(1.0,1.0)),u.x),u.y);\n    return res*res;\n}\n\nfloat fbm(vec2 x, int numOctaves) {\n    float v = 0.0;\n    float a = 0.5;\n    vec2 shift = vec2(100);\n    // Rotate to reduce axial bias\n    mat2 rot = mat2(cos(0.5), sin(0.5), -sin(0.5), cos(0.50));\n    for (int i = 0; i < numOctaves; ++i) {\n    v += a * noise(x);\n    x = rot * x * 2.0 + shift;\n    a *= 0.5;\n    }\n    return v;\n}\n\nfloat fbm(vec2 x) {\n    return fbm(x, NUM_OCTAVES);\n}\n\nuniform vec2 uPlaneSize;\nuniform vec2 uWindowSize;\nuniform float uNoiseProgress;\nuniform float uFullscreenProgress;\n\nuniform float uTime;\nuniform float uDisplace;\nuniform float uNoiseAmplitude;\nuniform float uNoiseFrequency;\nuniform float uNoiseSpeed;\nuniform int uNoiseOctaves;\n\nvarying vec2 vUv;\nvarying float vNoise;\n\nvoid main() {\n  vUv = uv;\n\n  vec4 wPos = modelMatrix * vec4(position, 1.);\n  vec3 pos = position;\n\n  // Distort mesh using Fractal noise\n  vNoise = fbm(wPos.xy * uNoiseFrequency + uTime * uNoiseSpeed, uNoiseOctaves);\n  pos *= mix(1., 1. - vNoise * uNoiseAmplitude, uDisplace * (1. - pow(uNoiseProgress, 2.))) * 2.; // /w overshoot\n\n  // Scale mesh to fullscreen\n  vec4 defaultState = modelMatrix * vec4(pos, 1.0);\n  vec4 fullscreenState = vec4(pos, 1.0);\n  fullscreenState.x *= uWindowSize.x / uPlaneSize.x;\n  fullscreenState.y *= uWindowSize.y / uPlaneSize.y;\n  vec4 currentState = mix(defaultState, fullscreenState, pow(uFullscreenProgress, 2.));\n\n  gl_Position = projectionMatrix * viewMatrix * currentState;\n}\n","#define GLSLIFY 1\nuniform float uCircleProgress;\nuniform float uOpacity;\nuniform vec3 uColor;\nuniform float uTime;\n\nvarying vec2 vUv;\nvarying float vNoise;\n\nvoid main() {\n  float p = pow(uCircleProgress, 4.);\n  float d =distance(vUv, vec2(.5));\n  d = smoothstep(\n    .35 + .1 * (vNoise * .5 + abs(sin(uTime)) * .5) + p * .55, \n    .5 + p * .5, \n  d); // circle to square /w blurry edge\n  d = clamp(d, 0., 1.);\n\n  gl_FragColor = vec4(uColor, (1. - d) * uOpacity);\n}");(0,U.e)({CoverPlaneMaterial:eh});let ef=e=>e?{r:e.r/255,g:e.g/255,b:e.b/255}:{r:0,g:0,b:0};var ep=()=>{let e=(0,o.useRef)(),t=(0,o.useRef)(null),{requestRender:i}=(0,l.hP)(),n=(0,U.z)(e=>e.viewport).getCurrentViewport(),a=.4*Math.max(n.height,n.width),s=(0,g.Z)(e=>e.showCoverPlane),u=(0,g.Z)(e=>e.coverColor),c=!(0,d.Z)();(0,eu.q_)({from:{p:0},to:{p:c&&s?1:0},onStart:e=>{let{value:{p:i}}=e;(0,U.l)(),c&&s&&t.current&&(t.current.visible=!0)},onChange:t=>{let{value:{p:i}}=t;(0,U.l)(),e.current&&(e.current.uOpacity=i)},onRest:e=>{let{value:{p:i}}=e;if(0===i&&!c){if(g.Z.setState({showCoverPlane:!1,coverColor:void 0}),!t.current)return;t.current.visible=!1}},config:{duration:c?0:500},delay:c?0:300});let h={from:{p:0},to:{p:s?1:0}};return(0,eu.q_)({...h,onStart:()=>(0,U.l)(),onChange:e=>{let{value:{p:i}}=e;(0,U.l)(),t.current&&t.current.scale.set(i,i,1)},config:{duration:s?1e3:0},easing:ec.M4}),(0,eu.q_)({...h,onStart:()=>(0,U.l)(),onChange:t=>{let{value:{p:i}}=t;(0,U.l)(),e.current&&(e.current.uFullscreenProgress=i)},config:{duration:s?1e3:0},delay:s?200:0,easing:ed.U2}),(0,eu.q_)({...h,onStart:()=>(0,U.l)(),onChange:t=>{let{value:{p:i}}=t;(0,U.l)(),e.current&&(e.current.uNoiseProgress=i)},config:{duration:s?1500:0}}),(0,eu.q_)({...h,onStart:()=>(0,U.l)(),onChange:t=>{let{value:{p:i}}=t;(0,U.l)(),e.current&&(e.current.uCircleProgress=i)},config:{duration:s?1e3:0},delay:s?500:0}),(0,o.useEffect)(()=>{let i=i=>{if(!t.current||!e.current)return;let r=i.x/n.factor-.5*n.width,a=-1*(i.y/n.factor-.5*n.height);t.current.position.set(r,a,0)};return window.addEventListener("click",i),()=>window.removeEventListener("click",i)},[n]),(0,o.useEffect)(()=>{e.current&&(e.current.uColor=ef(u))},[u]),(0,U.A)((t,r)=>{e.current&&(e.current.uTime+=r,i())}),(0,r.jsxs)("mesh",{ref:t,renderOrder:10,scale:0,children:[(0,r.jsx)("planeGeometry",{args:[a,a,256,256]}),(0,r.jsx)("coverPlaneMaterial",{ref:e,uPlaneSize:[a,a],uWindowSize:[n.width,n.height],transparent:!0,depthTest:!1},eh.key)]})};let em=el()(()=>Promise.all([i.e(897),i.e(7871),i.e(6303),i.e(7271)]).then(i.bind(i,17271)),{loadableGenerated:{webpack:()=>[17271]}});var eg=e=>{let{eventSource:t}=e,i=void 0!==(0,s.useRouter)().query.debug;return(0,r.jsx)(l.sc,{debug:i,scaleMultiplier:.01,flat:!0,gl:{depth:!1},style:{pointerEvents:"none"},dpr:[1,1.8],eventSource:t,eventPrefix:"client",frameloop:"demand",onCreated:e=>{let{gl:t}=e;t.capabilities.isWebGL2||(l.gt.setState({isCanvasAvailable:!1}),document.documentElement.classList.remove("js-has-global-canvas"),document.documentElement.classList.add("js-global-canvas-error"))},children:e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Suspense,{fallback:null,children:e}),(0,r.jsx)(em,{}),(0,r.jsx)(ep,{})]})})},ev=e=>{let{children:t,menuNavigation:i,cookieBar:n,footer:a}=e,s=(0,u.Z)(),c=(0,o.useRef)(null);return(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{ref:c,children:[(0,r.jsx)(es,{children:(0,r.jsx)(k,{data:i})}),(0,r.jsxs)(f,{children:[t,(0,r.jsx)(Z,{data:a}),(0,r.jsx)(en,{data:n})]}),(0,r.jsx)(l.i6,{enabled:!1!==s,scrollRestoration:"manual"}),(0,r.jsx)(eg,{eventSource:c}),(0,r.jsx)(ea,{})]})})},ey=i(58510),eb=i(37817);let e_={title:"14islands",description:"",thumbnail:"",url:"https://www.14islands.com/"};var eE=e=>{let{pageData:t,siteData:i,titlePrefix:n="",slug:s}=e,o=(null==t?void 0:t.title)||(null==i?void 0:i.title)||e_.title,l=(n?"".concat(n," "):"")+o,u=(null==t?void 0:t.description)||(null==i?void 0:i.description)||e_.description,c=(null==t?void 0:t.image)||(null==i?void 0:i.image)?(0,eb.uH)((null==t?void 0:t.image)||(null==i?void 0:i.image)).url():e_.thumbnail,d=s&&"".concat(e_.url).concat(s)||e_.url;return(0,r.jsxs)(a(),{children:[(0,r.jsx)("title",{children:l}),(0,r.jsx)("meta",{name:"description",content:u}),(0,r.jsx)("meta",{name:"title",property:"og:title",content:l}),(0,r.jsx)("meta",{name:"description",property:"og:description",content:u}),(0,r.jsx)("meta",{name:"image",property:"og:image",content:c}),(0,r.jsx)("meta",{name:"type",property:"og:type",content:"website"}),(0,r.jsx)("meta",{name:"url",property:"og:url",content:d}),(0,r.jsx)("meta",{name:"twitter:title",content:l}),(0,r.jsx)("meta",{name:"twitter:description",content:u}),(0,r.jsx)("meta",{name:"twitter:image",content:c}),(0,r.jsx)("meta",{name:"twitter:card",content:"summary_large_image"})]})},eS=i(67666),ex=e=>{let{data:t}=e,i=null==t?void 0:t.isIndexable,n=null==t?void 0:t.hasCanonicalLink,s=null==t?void 0:t.canonicalLink;return i||n?i?n?(0,r.jsx)(a(),{children:(0,r.jsx)("link",{rel:"canonical",href:"internal"===s.type?eS.L+(null==s?void 0:s.url):null==s?void 0:s.url})}):void 0:(0,r.jsx)(a(),{children:(0,r.jsx)("meta",{name:"robots",content:"noindex"})}):null};function eT(e){var t,i,n,o,l,u,c,d;let{Component:h,pageProps:f}=e,p=(0,s.useRouter)().pathname.includes("[...studio]");return p?(0,r.jsx)(h,{...f}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(a(),{children:[(0,r.jsx)("link",{rel:"preconnect",href:"https://cdn.sanity.io"}),(0,r.jsx)("link",{rel:"preconnect",href:"https://www.googletagmanager.com"})]}),(0,r.jsx)(eE,{pageData:null==f?void 0:null===(t=f.data)||void 0===t?void 0:t.metadata,slug:null==f?void 0:null===(i=f.data)||void 0===i?void 0:i.slug,siteData:null==f?void 0:null===(n=f.siteSettings)||void 0===n?void 0:n.metadata,titlePrefix:null==f?void 0:null===(o=f.siteSettings)||void 0===o?void 0:o.titlePrefix}),(0,r.jsx)(ex,{data:null==f?void 0:null===(l=f.data)||void 0===l?void 0:l.seo}),(0,r.jsx)(ev,{menuNavigation:null==f?void 0:null===(u=f.siteSettings)||void 0===u?void 0:u.menuNavigation,cookieBar:null==f?void 0:null===(c=f.siteSettings)||void 0===c?void 0:c.cookieBar,footer:null==f?void 0:null===(d=f.siteSettings)||void 0===d?void 0:d.footer,children:(0,r.jsx)(h,{...f})}),(0,r.jsx)(ey._,{}),(0,r.jsx)(g.u,{})]})}},11217:function(e,t,i){"use strict";i.d(t,{Sx:function(){return s},gx:function(){return a},hH:function(){return n},tW:function(){return o}});var r=i(14224);let n=!1,a=l("production","Missing environment variable: NEXT_PUBLIC_SANITY_DATASET"),s=l("f3tpxs09","Missing environment variable: NEXT_PUBLIC_SANITY_PROJECT_ID");r.env.SANITY_API_READ_TOKEN;let o="2023-06-26";function l(e,t){if(void 0===e)throw Error(t);return e}},3372:function(e,t,i){"use strict";i.d(t,{iQ:function(){return o}});var r=i(69383),n=i.n(r),a=i(11217);let s=n()({projectId:a.Sx||"",dataset:a.gx||""}),o=e=>{var t;if(null==e?void 0:null===(t=e.asset)||void 0===t?void 0:t._ref)return null==s?void 0:s.image(e).auto("format").fit("max")}},37817:function(e,t,i){"use strict";i.d(t,{A5:function(){return o},qi:function(){return s},uH:function(){return l}});var r=i(69383),n=i.n(r),a=i(11217);let s=e=>e=(e=(e=(e=(e=(e=e.toLowerCase()).normalize("NFD").replace(/[\u0300-\u036f]/g,"")).replace(/[^\w\s-]/g,"")).replace(/\s+/g,"-")).replace(/-{2,}/g,"-")).replace(/^-+|-+$/g,""),o="Alternative text should be provided to improve accessibility and SEO",l=e=>n()({dataset:a.gx,projectId:a.Sx}).image(e)},67666:function(e,t,i){"use strict";var r,n;i.d(t,{G:function(){return r},L:function(){return a}}),(n=r||(r={})).CaseStudy="caseStudy",n.Contact="page.contact",n.Culture="page.culture",n.GenericPage="genericPage",n.JobAd="jobAd",n.Journal="page.journal",n.JournalEntry="journalEntry",n.Services="page.services",n.SiteSettings="siteSettings",n.Work="page.work";let a="https://14islands.com"},32625:function(){},11405:function(){},66705:function(){},78334:function(e){e.exports={container:"Container_container__WBa4B",undrawAnimation:"Container_undrawAnimation__W6jgU",drawAnimation:"Container_drawAnimation__Wkqup",fadeIn:"Container_fadeIn__dy3rj"}},39891:function(e){e.exports={row:"Grid_row__NqHRm",col:"Grid_col__i_g9G","col--0":"Grid_col--0__gGkIX","col--1":"Grid_col--1__r2hrH","col--2":"Grid_col--2__8NxRl","col--3":"Grid_col--3__nOY_1","col--4":"Grid_col--4__KiBcQ","col--medium--0":"Grid_col--medium--0__LO6Cw","col--medium--1":"Grid_col--medium--1__9Cujw","col--medium--2":"Grid_col--medium--2__fElpA","col--medium--3":"Grid_col--medium--3__PdLPY","col--medium--4":"Grid_col--medium--4__vUkEY","col--medium--5":"Grid_col--medium--5__xsMFk","col--medium--6":"Grid_col--medium--6__tAceh","col--medium--7":"Grid_col--medium--7__3vyiZ","col--medium--8":"Grid_col--medium--8__tLwA7","col--desktop--0":"Grid_col--desktop--0__69eMn","col--desktop--1":"Grid_col--desktop--1__GFV12","col--desktop--2":"Grid_col--desktop--2__wEGkO","col--desktop--3":"Grid_col--desktop--3__4J2xY","col--desktop--4":"Grid_col--desktop--4__kcedd","col--desktop--5":"Grid_col--desktop--5__xvOln","col--desktop--6":"Grid_col--desktop--6__ZsOj9","col--desktop--7":"Grid_col--desktop--7__8ZMSL","col--desktop--8":"Grid_col--desktop--8__towUM","col--desktop--9":"Grid_col--desktop--9__eejQ4","col--desktop--10":"Grid_col--desktop--10__bgv5i","col--desktop--11":"Grid_col--desktop--11__g3ih9","col--desktop--12":"Grid_col--desktop--12__NmpM3","col--large--0":"Grid_col--large--0__YqJ94","col--large--1":"Grid_col--large--1__t79Fj","col--large--2":"Grid_col--large--2__uokw7","col--large--3":"Grid_col--large--3__OVBfZ","col--large--4":"Grid_col--large--4___ra_g","col--large--5":"Grid_col--large--5__hPI8p","col--large--6":"Grid_col--large--6__jywKH","col--large--7":"Grid_col--large--7__y__Iz","col--large--8":"Grid_col--large--8__7naFV","col--large--9":"Grid_col--large--9__GpT9R","col--large--10":"Grid_col--large--10__R44_s","col--large--11":"Grid_col--large--11__ed27_","col--large--12":"Grid_col--large--12__Uaaul",undrawAnimation:"Grid_undrawAnimation__OVZMq",drawAnimation:"Grid_drawAnimation__IATsd",fadeIn:"Grid_fadeIn__E7UCl"}},68303:function(e){e.exports={title:"Guide_title__ow7_J",row:"Guide_row__IgdG7",overlay:"Guide_overlay__wwe5I",col:"Guide_col__78og3",undrawAnimation:"Guide_undrawAnimation__qYqcU",drawAnimation:"Guide_drawAnimation__o8cfk",fadeIn:"Guide_fadeIn__4gX5M"}},70277:function(e){e.exports={helperTitle:"HelperTitle_helperTitle__31Ptp"}},24433:function(e){e.exports={character:"HoverAnimation_character__j_zSa",undrawAnimation:"HoverAnimation_undrawAnimation__Dknt9",drawAnimation:"HoverAnimation_drawAnimation__Twm0q",fadeIn:"HoverAnimation_fadeIn__p_qY9"}},68879:function(e){e.exports={image:"Media_image__E0M_G",muxVideo:"Media_muxVideo__j28sp",undrawAnimation:"Media_undrawAnimation__xfjzq",drawAnimation:"Media_drawAnimation__dr_NU",fadeIn:"Media_fadeIn__Aeqb4"}},95755:function(e){e.exports={cookieBar:"CookieBar_cookieBar__w0Oqo",isVisible:"CookieBar_isVisible__ydeFY",isHideAnimationEnded:"CookieBar_isHideAnimationEnded__2k_mg",cookieBarInner:"CookieBar_cookieBarInner__wrt8R",copy:"CookieBar_copy__9qIso",button:"CookieBar_button__mfaLw",label:"CookieBar_label__C4ZCU",acceptButton:"CookieBar_acceptButton__NcLAc",rejectButton:"CookieBar_rejectButton__RcVtw",undrawAnimation:"CookieBar_undrawAnimation__mL_7k",drawAnimation:"CookieBar_drawAnimation__rSkl7",fadeIn:"CookieBar_fadeIn__1I8pm"}},77980:function(e){e.exports={container:"CrossLinkThumbnail_container__PlY12",link:"CrossLinkThumbnail_link__enFl8",body:"CrossLinkThumbnail_body__hAU7k",image:"CrossLinkThumbnail_image__aTuj5",undrawAnimation:"CrossLinkThumbnail_undrawAnimation__ihZdW",drawAnimation:"CrossLinkThumbnail_drawAnimation__8fWay",fadeIn:"CrossLinkThumbnail_fadeIn__oL6xf"}},32718:function(e){e.exports={labelWrapper:"DashedLabel_labelWrapper__xHNuc",suffixWrapper:"DashedLabel_suffixWrapper__f72me",dash:"DashedLabel_dash__kEdHl",suffix:"DashedLabel_suffix__dQ9IO",undrawAnimation:"DashedLabel_undrawAnimation__pxO_y",drawAnimation:"DashedLabel_drawAnimation__crql_",fadeIn:"DashedLabel_fadeIn__FC51z"}},76905:function(e){e.exports={label:"Footer_label__cC0nG",footer:"Footer_footer__2aKFm",isContactPage:"Footer_isContactPage__9P5i4",lightGrey:"Footer_lightGrey__ZZcEg",beige:"Footer_beige__1FlUw",dark:"Footer_dark__XTX4H",container:"Footer_container__EXrH2",topContent:"Footer_topContent__Zgn3P",title:"Footer_title__304ar",isInView:"Footer_isInView__xT8N2",email:"Footer_email__30K2w",undrawAnimation:"Footer_undrawAnimation__K6ZtD",drawAnimation:"Footer_drawAnimation__uo1pv",bottomBar:"Footer_bottomBar__BymNW",mobile:"Footer_mobile__GV8xs",desktop:"Footer_desktop__rIxa7",copyrightRow:"Footer_copyrightRow__NBoBW",copyright:"Footer_copyright__RQyXm",links:"Footer_links__IPH9D",fadeIn:"Footer_fadeIn__yXdAh",link:"Footer_link__aRNy3"}},89602:function(e){e.exports={contact:"InlineLink_contact__P8etS",label:"InlineLink_label__4MpwN",double:"InlineLink_double__OJhGE",single:"InlineLink_single__Sr0xs",link:"InlineLink_link__X4wJl",undrawAnimation:"InlineLink_undrawAnimation__c_KqY",drawAnimation:"InlineLink_drawAnimation__8GzzO",undrawAnimationThin:"InlineLink_undrawAnimationThin__O347b",drawAnimationThin:"InlineLink_drawAnimationThin__VLcou",arrow:"InlineLink_arrow__UlKAY",external:"InlineLink_external__xx8Ep",internal:"InlineLink_internal__qeS_y",fadeIn:"InlineLink_fadeIn__edzCp"}},22050:function(e){e.exports={link:"Link_link__7fkoZ",text:"Link_text__ABtB5",arrow:"Link_arrow__QmHXJ",external:"Link_external__UGSOu",internal:"Link_internal__de70T",undrawAnimation:"Link_undrawAnimation__eBGuY",drawAnimation:"Link_drawAnimation__FDZQW",fadeIn:"Link_fadeIn____moE"}},13940:function(e){e.exports={list:"List_list__HfENv",item:"List_item__D43Bc",isOrderedList:"List_isOrderedList__bgEzM",marker:"List_marker___Mt1Z",undrawAnimation:"List_undrawAnimation__wTTIY",drawAnimation:"List_drawAnimation__R2EJD",fadeIn:"List_fadeIn__3HSvc"}},24646:function(e){e.exports={container:"Desktop_container__OGc0R",lightGrey:"Desktop_lightGrey__rVPZ1",beige:"Desktop_beige___BEs_",dark:"Desktop_dark__CFCNx",hasTransition:"Desktop_hasTransition__YoANy",isPageTransitioning:"Desktop_isPageTransitioning__MKJdR",isHidden:"Desktop_isHidden__5v9B8",row:"Desktop_row__gknIT",logoWrapper:"Desktop_logoWrapper__jIWjS",fadeIn:"Desktop_fadeIn__i3tLS",logoLink:"Desktop_logoLink__VPsJ8",nav:"Desktop_nav__iHP2d",list:"Desktop_list__V4_qU",item:"Desktop_item__Ly0hN",link:"Desktop_link__3I3Lu",isWindows:"Desktop_isWindows__B_A8v",isActive:"Desktop_isActive__3aTfD",undrawAnimation:"Desktop_undrawAnimation__qLhfg",drawAnimation:"Desktop_drawAnimation__ns6Id"}},90585:function(e){e.exports={header:"MenuNavigation_header__ttLld",lightGrey:"MenuNavigation_lightGrey__jnoo6",beige:"MenuNavigation_beige__vnQ20",dark:"MenuNavigation_dark__NR0kv",undrawAnimation:"MenuNavigation_undrawAnimation__YX4FU",drawAnimation:"MenuNavigation_drawAnimation__7cOYP",fadeIn:"MenuNavigation_fadeIn__R_CmV"}},60539:function(e){e.exports={bar:"Mobile_bar__tTAEo",lightGrey:"Mobile_lightGrey__jrSWS",beige:"Mobile_beige__s_KhK",dark:"Mobile_dark__sSqRQ",hasTransition:"Mobile_hasTransition__xVqL4",isPageTransitioning:"Mobile_isPageTransitioning__7mKl7",isHidden:"Mobile_isHidden__Lq4Js",barContainer:"Mobile_barContainer__nUj3h",fadeIn:"Mobile_fadeIn__u1I68",logoLink:"Mobile_logoLink__gqa_O",buttons:"Mobile_buttons__BRq4z",button:"Mobile_button__6OCzn",open:"Mobile_open__ew_CV",fadeInOut:"Mobile_fadeInOut__3DgLX",label:"Mobile_label__Skc_r",menuLabel:"Mobile_menuLabel__GNeBd",active:"Mobile_active__Qf6St",closeLabel:"Mobile_closeLabel__hjFhQ",dialog:"Mobile_dialog__74g_Z",isDialogOpen:"Mobile_isDialogOpen__iHizm",hasDelay:"Mobile_hasDelay__KRin4",dialogContainer:"Mobile_dialogContainer__SboBv",item:"Mobile_item__1a67P",isActive:"Mobile_isActive__xeaMg",linkAnimation:"Mobile_linkAnimation__mm4BR",link:"Mobile_link__9ET7m",undrawAnimation:"Mobile_undrawAnimation__nFlMt",drawAnimation:"Mobile_drawAnimation__3Jadd"}},43928:function(e){e.exports={RichText:"RichText_RichText__5_OZ8",hasMargins:"RichText_hasMargins__JNZ5v",listChild:"RichText_listChild__9mHfG",strong:"RichText_strong__UZV_F",emphasis:"RichText_emphasis__1zkOa",useItalic:"RichText_useItalic__s6FEW",code:"RichText_code__XIqQy",undrawAnimation:"RichText_undrawAnimation__b0Hlq",drawAnimation:"RichText_drawAnimation__XesQL",fadeIn:"RichText_fadeIn__xoNUi"}},25616:function(e){e.exports={body:"Text_body__aVpiO",caption:"Text_caption__rFBR7",h6:"Text_h6__pc8A_",h5:"Text_h5__2jwjX",h4:"Text_h4__mKc5U",h3:"Text_h3__gND_e",caseStudyH2:"Text_caseStudyH2__3aLLs",h2:"Text_h2__36k7Q",h1:"Text_h1__bzUnA",undrawAnimation:"Text_undrawAnimation__OVIdE",drawAnimation:"Text_drawAnimation__HyFZK",fadeIn:"Text_fadeIn__srPVc"}},95158:function(e){e.exports={"breakpoint-medium":"600px","breakpoint-desktop":"900px","breakpoint-large":"1400px","color-almost-black":"#070707","color-background":"#f2f2f2","color-grey-highlight-dark":"#797979","color-grey-highlight-light":"#a2a2a9","color-sand-highlight":"#a59d92","color-sand":"#eae5df","color-white":"#fff","color-beige-theme-animated-text-highlight-bg":"#e4ded7","color-dark-theme-animated-text-highlight-bg":"#26272a","base-width":"1728 px"}},87984:function(e,t,i){e.exports=i(32170)},8301:function(e,t,i){e.exports=i(39055)},75734:function(e,t,i){e.exports=i(1348)},21345:function(e,t,i){e.exports=i(99772)},80887:function(e,t,i){e.exports=i(72687)},80202:function(e,t,i){e.exports=i(43128)},60023:function(e,t,i){e.exports=i(78198)},14224:function(e){var t,i,r,n=e.exports={};function a(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===a||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(i){try{return t.call(null,e,0)}catch(i){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:a}catch(e){t=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(e){i=s}}();var l=[],u=!1,c=-1;function d(){u&&r&&(u=!1,r.length?l=r.concat(l):c=-1,l.length&&h())}function h(){if(!u){var e=o(d);u=!0;for(var t=l.length;t;){for(r=l,l=[];++c<t;)r&&r[c].run();c=-1,t=l.length}r=null,u=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}n.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];l.push(new f(e,t)),1!==l.length||u||o(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw Error("process.chdir is not supported")},n.umask=function(){return 0}},74049:function(e,t,i){"use strict";var r=i(36257);function n(){}function a(){}a.resetWarningCache=n,e.exports=function(){function e(e,t,i,n,a,s){if(s!==r){var o=Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw o.name="Invariant Violation",o}}function t(){return e}e.isRequired=e;var i={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:a,resetWarningCache:n};return i.PropTypes=i,i}},40507:function(e,t,i){e.exports=i(74049)()},36257:function(e){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},80418:function(e,t,i){"use strict";let r=i(45632),n=i(54525),a=i(34214),s=i(1469),o=e=>null==e;function l(e){if("string"!=typeof e||1!==e.length)throw TypeError("arrayFormatSeparator must be single character string")}function u(e,t){return t.encode?t.strict?r(e):encodeURIComponent(e):e}function c(e,t){return t.decode?n(e):e}function d(e){let t=e.indexOf("#");return -1!==t&&(e=e.slice(0,t)),e}function h(e){e=d(e);let t=e.indexOf("?");return -1===t?"":e.slice(t+1)}function f(e,t){return t.parseNumbers&&!Number.isNaN(Number(e))&&"string"==typeof e&&""!==e.trim()?e=Number(e):t.parseBooleans&&null!==e&&("true"===e.toLowerCase()||"false"===e.toLowerCase())&&(e="true"===e.toLowerCase()),e}function p(e,t){l((t=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},t)).arrayFormatSeparator);let i=function(e){let t;switch(e.arrayFormat){case"index":return(e,i,r)=>{if(t=/\[(\d*)\]$/.exec(e),e=e.replace(/\[\d*\]$/,""),!t){r[e]=i;return}void 0===r[e]&&(r[e]={}),r[e][t[1]]=i};case"bracket":return(e,i,r)=>{if(t=/(\[\])$/.exec(e),e=e.replace(/\[\]$/,""),!t){r[e]=i;return}if(void 0===r[e]){r[e]=[i];return}r[e]=[].concat(r[e],i)};case"comma":case"separator":return(t,i,r)=>{let n="string"==typeof i&&i.includes(e.arrayFormatSeparator),a="string"==typeof i&&!n&&c(i,e).includes(e.arrayFormatSeparator);i=a?c(i,e):i;let s=n||a?i.split(e.arrayFormatSeparator).map(t=>c(t,e)):null===i?i:c(i,e);r[t]=s};default:return(e,t,i)=>{if(void 0===i[e]){i[e]=t;return}i[e]=[].concat(i[e],t)}}}(t),r=Object.create(null);if("string"!=typeof e||!(e=e.trim().replace(/^[?#&]/,"")))return r;for(let n of e.split("&")){if(""===n)continue;let[e,s]=a(t.decode?n.replace(/\+/g," "):n,"=");s=void 0===s?null:["comma","separator"].includes(t.arrayFormat)?s:c(s,t),i(c(e,t),s,r)}for(let e of Object.keys(r)){let i=r[e];if("object"==typeof i&&null!==i)for(let e of Object.keys(i))i[e]=f(i[e],t);else r[e]=f(i,t)}return!1===t.sort?r:(!0===t.sort?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce((e,t)=>{let i=r[t];return i&&"object"==typeof i&&!Array.isArray(i)?e[t]=function e(t){return Array.isArray(t)?t.sort():"object"==typeof t?e(Object.keys(t)).sort((e,t)=>Number(e)-Number(t)).map(e=>t[e]):t}(i):e[t]=i,e},Object.create(null))}t.extract=h,t.parse=p,t.stringify=(e,t)=>{if(!e)return"";l((t=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},t)).arrayFormatSeparator);let i=i=>t.skipNull&&o(e[i])||t.skipEmptyString&&""===e[i],r=function(e){switch(e.arrayFormat){case"index":return t=>(i,r)=>{let n=i.length;return void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?i:null===r?[...i,[u(t,e),"[",n,"]"].join("")]:[...i,[u(t,e),"[",u(n,e),"]=",u(r,e)].join("")]};case"bracket":return t=>(i,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?i:null===r?[...i,[u(t,e),"[]"].join("")]:[...i,[u(t,e),"[]=",u(r,e)].join("")];case"comma":case"separator":return t=>(i,r)=>null==r||0===r.length?i:0===i.length?[[u(t,e),"=",u(r,e)].join("")]:[[i,u(r,e)].join(e.arrayFormatSeparator)];default:return t=>(i,r)=>void 0===r||e.skipNull&&null===r||e.skipEmptyString&&""===r?i:null===r?[...i,u(t,e)]:[...i,[u(t,e),"=",u(r,e)].join("")]}}(t),n={};for(let t of Object.keys(e))i(t)||(n[t]=e[t]);let a=Object.keys(n);return!1!==t.sort&&a.sort(t.sort),a.map(i=>{let n=e[i];return void 0===n?"":null===n?u(i,t):Array.isArray(n)?n.reduce(r(i),[]).join("&"):u(i,t)+"="+u(n,t)}).filter(e=>e.length>0).join("&")},t.parseUrl=(e,t)=>{t=Object.assign({decode:!0},t);let[i,r]=a(e,"#");return Object.assign({url:i.split("?")[0]||"",query:p(h(e),t)},t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:c(r,t)}:{})},t.stringifyUrl=(e,i)=>{i=Object.assign({encode:!0,strict:!0},i);let r=d(e.url).split("?")[0]||"",n=t.extract(e.url),a=t.parse(n,{sort:!1}),s=Object.assign(a,e.query),o=t.stringify(s,i);o&&(o=`?${o}`);let l=function(e){let t="",i=e.indexOf("#");return -1!==i&&(t=e.slice(i)),t}(e.url);return e.fragmentIdentifier&&(l=`#${u(e.fragmentIdentifier,i)}`),`${r}${o}${l}`},t.pick=(e,i,r)=>{r=Object.assign({parseFragmentIdentifier:!0},r);let{url:n,query:a,fragmentIdentifier:o}=t.parseUrl(e,r);return t.stringifyUrl({url:n,query:s(a,i),fragmentIdentifier:o},r)},t.exclude=(e,i,r)=>{let n=Array.isArray(i)?e=>!i.includes(e):(e,t)=>!i(e,t);return t.pick(e,n,r)}},23406:function(e,t){"use strict";/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */t.ConcurrentRoot=1,t.ContinuousEventPriority=4,t.DefaultEventPriority=16,t.DiscreteEventPriority=1},45658:function(e,t,i){/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */e.exports=function(e){"use strict";var t,r,n,a,s,o={},l=i(50959),u=i(65297),c=Object.assign;function d(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,i=1;i<arguments.length;i++)t+="&args[]="+encodeURIComponent(arguments[i]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var h=l.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,f=Symbol.for("react.element"),p=Symbol.for("react.portal"),m=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),b=Symbol.for("react.context"),_=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),S=Symbol.for("react.suspense_list"),x=Symbol.for("react.memo"),T=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var w=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var A=Symbol.iterator;function M(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=A&&e[A]||e["@@iterator"])?e:null}function R(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case m:return"Fragment";case p:return"Portal";case v:return"Profiler";case g:return"StrictMode";case E:return"Suspense";case S:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case b:return(e.displayName||"Context")+".Consumer";case y:return(e._context.displayName||"Context")+".Provider";case _:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case x:return null!==(t=e.displayName||null)?t:R(e.type)||"Memo";case T:t=e._payload,e=e._init;try{return R(e(t))}catch(e){}}return null}function C(e){var t=e,i=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do 0!=(4098&(t=e).flags)&&(i=t.return),e=t.return;while(e)}return 3===t.tag?i:null}function I(e){if(C(e)!==e)throw Error(d(188))}function L(e){var t=e.alternate;if(!t){if(null===(t=C(e)))throw Error(d(188));return t!==e?null:e}for(var i=e,r=t;;){var n=i.return;if(null===n)break;var a=n.alternate;if(null===a){if(null!==(r=n.return)){i=r;continue}break}if(n.child===a.child){for(a=n.child;a;){if(a===i)return I(n),e;if(a===r)return I(n),t;a=a.sibling}throw Error(d(188))}if(i.return!==r.return)i=n,r=a;else{for(var s=!1,o=n.child;o;){if(o===i){s=!0,i=n,r=a;break}if(o===r){s=!0,r=n,i=a;break}o=o.sibling}if(!s){for(o=a.child;o;){if(o===i){s=!0,i=a,r=n;break}if(o===r){s=!0,r=a,i=n;break}o=o.sibling}if(!s)throw Error(d(189))}}if(i.alternate!==r)throw Error(d(190))}if(3!==i.tag)throw Error(d(188));return i.stateNode.current===i?e:t}function k(e){return null!==(e=L(e))?function e(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){var i=e(t);if(null!==i)return i;t=t.sibling}return null}(e):null}var D,P=Array.isArray,O=e.getPublicInstance,N=e.getRootHostContext,U=e.getChildHostContext,F=e.prepareForCommit,B=e.resetAfterCommit,V=e.createInstance,z=e.appendInitialChild,j=e.finalizeInitialChildren,H=e.prepareUpdate,G=e.shouldSetTextContent,W=e.createTextInstance,$=e.scheduleTimeout,q=e.cancelTimeout,Y=e.noTimeout,K=e.isPrimaryRenderer,X=e.supportsMutation,Z=e.supportsPersistence,J=e.supportsHydration,Q=e.getInstanceFromNode,ee=e.preparePortalMount,et=e.getCurrentEventPriority,ei=e.detachDeletedInstance,er=e.supportsMicrotasks,en=e.scheduleMicrotask,ea=e.supportsTestSelectors,es=e.findFiberRoot,eo=e.getBoundingRect,el=e.getTextContent,eu=e.isHiddenSubtree,ec=e.matchAccessibilityRole,ed=e.setFocusIfFocusable,eh=e.setupIntersectionObserver,ef=e.appendChild,ep=e.appendChildToContainer,em=e.commitTextUpdate,eg=e.commitMount,ev=e.commitUpdate,ey=e.insertBefore,eb=e.insertInContainerBefore,e_=e.removeChild,eE=e.removeChildFromContainer,eS=e.resetTextContent,ex=e.hideInstance,eT=e.hideTextInstance,ew=e.unhideInstance,eA=e.unhideTextInstance,eM=e.clearContainer,eR=e.cloneInstance,eC=e.createContainerChildSet,eI=e.appendChildToContainerChildSet,eL=e.finalizeContainerChildren,ek=e.replaceContainerChildren,eD=e.cloneHiddenInstance,eP=e.cloneHiddenTextInstance,eO=e.canHydrateInstance,eN=e.canHydrateTextInstance,eU=e.canHydrateSuspenseInstance,eF=e.isSuspenseInstancePending,eB=e.isSuspenseInstanceFallback,eV=e.registerSuspenseInstanceRetry,ez=e.getNextHydratableSibling,ej=e.getFirstHydratableChild,eH=e.getFirstHydratableChildWithinContainer,eG=e.getFirstHydratableChildWithinSuspenseInstance,eW=e.hydrateInstance,e$=e.hydrateTextInstance,eq=e.hydrateSuspenseInstance,eY=e.getNextHydratableInstanceAfterSuspenseInstance,eK=e.commitHydratedContainer,eX=e.commitHydratedSuspenseInstance,eZ=e.clearSuspenseBoundary,eJ=e.clearSuspenseBoundaryFromContainer,eQ=e.shouldDeleteUnhydratedTailInstances,e0=e.didNotMatchHydratedContainerTextInstance,e1=e.didNotMatchHydratedTextInstance;function e2(e){if(void 0===D)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var e3=!1;function e5(e,t){if(!e||e3)return"";e3=!0;var i=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t){if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var r=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){r=e}e.call(t.prototype)}}else{try{throw Error()}catch(e){r=e}e()}}catch(t){if(t&&r&&"string"==typeof t.stack){for(var n=t.stack.split("\n"),a=r.stack.split("\n"),s=n.length-1,o=a.length-1;1<=s&&0<=o&&n[s]!==a[o];)o--;for(;1<=s&&0<=o;s--,o--)if(n[s]!==a[o]){if(1!==s||1!==o)do if(s--,0>--o||n[s]!==a[o]){var l="\n"+n[s].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=s&&0<=o);break}}}finally{e3=!1,Error.prepareStackTrace=i}return(e=e?e.displayName||e.name:"")?e2(e):""}var e4=Object.prototype.hasOwnProperty,e6=[],e8=-1;function e7(e){return{current:e}}function e9(e){0>e8||(e.current=e6[e8],e6[e8]=null,e8--)}function te(e,t){e6[++e8]=e.current,e.current=t}var tt={},ti=e7(tt),tr=e7(!1),tn=tt;function ta(e,t){var i=e.type.contextTypes;if(!i)return tt;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var n,a={};for(n in i)a[n]=t[n];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function ts(e){return null!=(e=e.childContextTypes)}function to(){e9(tr),e9(ti)}function tl(e,t,i){if(ti.current!==tt)throw Error(d(168));te(ti,t),te(tr,i)}function tu(e,t,i){var r=e.stateNode;if(t=t.childContextTypes,"function"!=typeof r.getChildContext)return i;for(var n in r=r.getChildContext())if(!(n in t))throw Error(d(108,function(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return R(t);case 8:return t===g?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"==typeof t)return t.displayName||t.name||null;if("string"==typeof t)return t}return null}(e)||"Unknown",n));return c({},i,r)}function tc(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||tt,tn=ti.current,te(ti,e),te(tr,tr.current),!0}function td(e,t,i){var r=e.stateNode;if(!r)throw Error(d(169));i?(e=tu(e,t,tn),r.__reactInternalMemoizedMergedChildContext=e,e9(tr),e9(ti),te(ti,e)):e9(tr),te(tr,i)}var th=Math.clz32?Math.clz32:function(e){return 0==(e>>>=0)?32:31-(tf(e)/tp|0)|0},tf=Math.log,tp=Math.LN2,tm=64,tg=4194304;function tv(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function ty(e,t){var i=e.pendingLanes;if(0===i)return 0;var r=0,n=e.suspendedLanes,a=e.pingedLanes,s=268435455&i;if(0!==s){var o=s&~n;0!==o?r=tv(o):0!=(a&=s)&&(r=tv(a))}else 0!=(s=i&~n)?r=tv(s):0!==a&&(r=tv(a));if(0===r)return 0;if(0!==t&&t!==r&&0==(t&n)&&((n=r&-r)>=(a=t&-t)||16===n&&0!=(4194240&a)))return t;if(0!=(4&r)&&(r|=16&i),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)n=1<<(i=31-th(t)),r|=e[i],t&=~n;return r}function tb(e){return 0!=(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function t_(e){for(var t=[],i=0;31>i;i++)t.push(e);return t}function tE(e,t,i){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-th(t)]=i}function tS(e,t){var i=e.entangledLanes|=t;for(e=e.entanglements;i;){var r=31-th(i),n=1<<r;n&t|e[r]&t&&(e[r]|=t),i&=~n}}var tx=0;function tT(e){return 1<(e&=-e)?4<e?0!=(268435455&e)?16:536870912:4:1}var tw=u.unstable_scheduleCallback,tA=u.unstable_cancelCallback,tM=u.unstable_shouldYield,tR=u.unstable_requestPaint,tC=u.unstable_now,tI=u.unstable_ImmediatePriority,tL=u.unstable_UserBlockingPriority,tk=u.unstable_NormalPriority,tD=u.unstable_IdlePriority,tP=null,tO=null,tN="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},tU=null,tF=!1,tB=!1;function tV(){if(!tB&&null!==tU){tB=!0;var e=0,t=tx;try{var i=tU;for(tx=1;e<i.length;e++){var r=i[e];do r=r(!0);while(null!==r)}tU=null,tF=!1}catch(t){throw null!==tU&&(tU=tU.slice(e+1)),tw(tI,tV),t}finally{tx=t,tB=!1}}return null}var tz=h.ReactCurrentBatchConfig;function tj(e,t){if(tN(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var i=Object.keys(e),r=Object.keys(t);if(i.length!==r.length)return!1;for(r=0;r<i.length;r++){var n=i[r];if(!e4.call(t,n)||!tN(e[n],t[n]))return!1}return!0}function tH(e,t){if(e&&e.defaultProps)for(var i in t=c({},t),e=e.defaultProps)void 0===t[i]&&(t[i]=e[i]);return t}var tG=e7(null),tW=null,t$=null,tq=null;function tY(){tq=t$=tW=null}function tK(e,t,i){K?(te(tG,t._currentValue),t._currentValue=i):(te(tG,t._currentValue2),t._currentValue2=i)}function tX(e){var t=tG.current;e9(tG),K?e._currentValue=t:e._currentValue2=t}function tZ(e,t,i){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===i)break;e=e.return}}function tJ(e,t){tW=e,tq=t$=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!=(e.lanes&t)&&(r1=!0),e.firstContext=null)}function tQ(e){var t=K?e._currentValue:e._currentValue2;if(tq!==e){if(e={context:e,memoizedValue:t,next:null},null===t$){if(null===tW)throw Error(d(308));t$=e,tW.dependencies={lanes:0,firstContext:e}}else t$=t$.next=e}return t}var t0=null,t1=!1;function t2(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function t3(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function t5(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function t4(e,t){var i=e.updateQueue;null!==i&&(i=i.shared,null!==nK&&0!=(1&e.mode)&&0==(2&nY)?(null===(e=i.interleaved)?(t.next=t,null===t0?t0=[i]:t0.push(i)):(t.next=e.next,e.next=t),i.interleaved=t):(null===(e=i.pending)?t.next=t:(t.next=e.next,e.next=t),i.pending=t))}function t6(e,t,i){if(null!==(t=t.updateQueue)&&(t=t.shared,0!=(4194240&i))){var r=t.lanes;r&=e.pendingLanes,i|=r,t.lanes=i,tS(e,i)}}function t8(e,t){var i=e.updateQueue,r=e.alternate;if(null!==r&&i===(r=r.updateQueue)){var n=null,a=null;if(null!==(i=i.firstBaseUpdate)){do{var s={eventTime:i.eventTime,lane:i.lane,tag:i.tag,payload:i.payload,callback:i.callback,next:null};null===a?n=a=s:a=a.next=s,i=i.next}while(null!==i);null===a?n=a=t:a=a.next=t}else n=a=t;i={baseState:r.baseState,firstBaseUpdate:n,lastBaseUpdate:a,shared:r.shared,effects:r.effects},e.updateQueue=i;return}null===(e=i.lastBaseUpdate)?i.firstBaseUpdate=t:e.next=t,i.lastBaseUpdate=t}function t7(e,t,i,r){var n=e.updateQueue;t1=!1;var a=n.firstBaseUpdate,s=n.lastBaseUpdate,o=n.shared.pending;if(null!==o){n.shared.pending=null;var l=o,u=l.next;l.next=null,null===s?a=u:s.next=u,s=l;var d=e.alternate;null!==d&&(o=(d=d.updateQueue).lastBaseUpdate)!==s&&(null===o?d.firstBaseUpdate=u:o.next=u,d.lastBaseUpdate=l)}if(null!==a){var h=n.baseState;for(s=0,d=u=l=null,o=a;;){var f=o.lane,p=o.eventTime;if((r&f)===f){null!==d&&(d=d.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=e,g=o;switch(f=t,p=i,g.tag){case 1:if("function"==typeof(m=g.payload)){h=m.call(p,h,f);break e}h=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null==(f="function"==typeof(m=g.payload)?m.call(p,h,f):m))break e;h=c({},h,f);break e;case 2:t1=!0}}null!==o.callback&&0!==o.lane&&(e.flags|=64,null===(f=n.effects)?n.effects=[o]:f.push(o))}else p={eventTime:p,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(u=d=p,l=h):d=d.next=p,s|=f;if(null===(o=o.next)){if(null===(o=n.shared.pending))break;o=(f=o).next,f.next=null,n.lastBaseUpdate=f,n.shared.pending=null}}if(null===d&&(l=h),n.baseState=l,n.firstBaseUpdate=u,n.lastBaseUpdate=d,null!==(t=n.shared.interleaved)){n=t;do s|=n.lane,n=n.next;while(n!==t)}else null===a&&(n.shared.lanes=0);n2|=s,e.lanes=s,e.memoizedState=h}}function t9(e,t,i){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],n=r.callback;if(null!==n){if(r.callback=null,r=i,"function"!=typeof n)throw Error(d(191,n));n.call(r)}}}var ie=(new l.Component).refs;function it(e,t,i,r){t=e.memoizedState,i=null==(i=i(r,t))?t:c({},t,i),e.memoizedState=i,0===e.lanes&&(e.updateQueue.baseState=i)}var ii={isMounted:function(e){return!!(e=e._reactInternals)&&C(e)===e},enqueueSetState:function(e,t,i){e=e._reactInternals;var r=ac(),n=ad(e),a=t5(r,n);a.payload=t,null!=i&&(a.callback=i),t4(e,a),null!==(t=ah(e,n,r))&&t6(t,e,n)},enqueueReplaceState:function(e,t,i){e=e._reactInternals;var r=ac(),n=ad(e),a=t5(r,n);a.tag=1,a.payload=t,null!=i&&(a.callback=i),t4(e,a),null!==(t=ah(e,n,r))&&t6(t,e,n)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var i=ac(),r=ad(e),n=t5(i,r);n.tag=2,null!=t&&(n.callback=t),t4(e,n),null!==(t=ah(e,r,i))&&t6(t,e,r)}};function ir(e,t,i,r,n,a,s){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,a,s):!t.prototype||!t.prototype.isPureReactComponent||!tj(i,r)||!tj(n,a)}function ia(e,t,i){var r=!1,n=tt,a=t.contextType;return"object"==typeof a&&null!==a?a=tQ(a):(n=ts(t)?tn:ti.current,a=(r=null!=(r=t.contextTypes))?ta(e,n):tt),t=new t(i,a),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ii,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=a),t}function is(e,t,i,r){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(i,r),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(i,r),t.state!==e&&ii.enqueueReplaceState(t,t.state,null)}function io(e,t,i,r){var n=e.stateNode;n.props=i,n.state=e.memoizedState,n.refs=ie,t2(e);var a=t.contextType;"object"==typeof a&&null!==a?n.context=tQ(a):(a=ts(t)?tn:ti.current,n.context=ta(e,a)),n.state=e.memoizedState,"function"==typeof(a=t.getDerivedStateFromProps)&&(it(e,t,a,i),n.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof n.getSnapshotBeforeUpdate||"function"!=typeof n.UNSAFE_componentWillMount&&"function"!=typeof n.componentWillMount||(t=n.state,"function"==typeof n.componentWillMount&&n.componentWillMount(),"function"==typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),t!==n.state&&ii.enqueueReplaceState(n,n.state,null),t7(e,i,n,r),n.state=e.memoizedState),"function"==typeof n.componentDidMount&&(e.flags|=4194308)}var il=[],iu=0,ic=null,id=0,ih=[],ip=0,im=null,ig=1,iv="";function iy(e,t){il[iu++]=id,il[iu++]=ic,ic=e,id=t}function ib(e,t,i){ih[ip++]=ig,ih[ip++]=iv,ih[ip++]=im,im=e;var r=ig;e=iv;var n=32-th(r)-1;r&=~(1<<n),i+=1;var a=32-th(t)+n;if(30<a){var s=n-n%5;a=(r&(1<<s)-1).toString(32),r>>=s,n-=s,ig=1<<32-th(t)+n|i<<n|r,iv=a+e}else ig=1<<a|i<<n|r,iv=e}function i_(e){null!==e.return&&(iy(e,1),ib(e,1,0))}function iE(e){for(;e===ic;)ic=il[--iu],il[iu]=null,id=il[--iu],il[iu]=null;for(;e===im;)im=ih[--ip],ih[ip]=null,iv=ih[--ip],ih[ip]=null,ig=ih[--ip],ih[ip]=null}var iS=null,ix=null,iT=!1,iw=!1,iA=null;function iM(e,t){var i=aF(5,null,null,0);i.elementType="DELETED",i.stateNode=t,i.return=e,null===(t=e.deletions)?(e.deletions=[i],e.flags|=16):t.push(i)}function iR(e,t){switch(e.tag){case 5:return null!==(t=eO(t,e.type,e.pendingProps))&&(e.stateNode=t,iS=e,ix=ej(t),!0);case 6:return null!==(t=eN(t,e.pendingProps))&&(e.stateNode=t,iS=e,ix=null,!0);case 13:if(null!==(t=eU(t))){var i=null!==im?{id:ig,overflow:iv}:null;return e.memoizedState={dehydrated:t,treeContext:i,retryLane:1073741824},(i=aF(18,null,null,0)).stateNode=t,i.return=e,e.child=i,iS=e,ix=null,!0}return!1;default:return!1}}function iC(e){return 0!=(1&e.mode)&&0==(128&e.flags)}function iI(e){if(iT){var t=ix;if(t){var i=t;if(!iR(e,t)){if(iC(e))throw Error(d(418));t=ez(i);var r=iS;t&&iR(e,t)?iM(r,i):(e.flags=-4097&e.flags|2,iT=!1,iS=e)}}else{if(iC(e))throw Error(d(418));e.flags=-4097&e.flags|2,iT=!1,iS=e}}}function iL(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;iS=e}function ik(e){if(!J||e!==iS)return!1;if(!iT)return iL(e),iT=!0,!1;if(3!==e.tag&&(5!==e.tag||eQ(e.type)&&!G(e.type,e.memoizedProps))){var t=ix;if(t){if(iC(e)){for(e=ix;e;)e=ez(e);throw Error(d(418))}for(;t;)iM(e,t),t=ez(t)}}if(iL(e),13===e.tag){if(!J)throw Error(d(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(d(317));ix=eY(e)}else ix=iS?ez(e.stateNode):null;return!0}function iD(){J&&(ix=iS=null,iw=iT=!1)}function iP(e){null===iA?iA=[e]:iA.push(e)}function iO(e,t,i){if(null!==(e=i.ref)&&"function"!=typeof e&&"object"!=typeof e){if(i._owner){if(i=i._owner){if(1!==i.tag)throw Error(d(309));var r=i.stateNode}if(!r)throw Error(d(147,e));var n=r,a=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===a?t.ref:((t=function(e){var t=n.refs;t===ie&&(t=n.refs={}),null===e?delete t[a]:t[a]=e})._stringRef=a,t)}if("string"!=typeof e)throw Error(d(284));if(!i._owner)throw Error(d(290,e))}return e}function iN(e,t){throw Error(d(31,"[object Object]"===(e=Object.prototype.toString.call(t))?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function iU(e){return(0,e._init)(e._payload)}function iF(e){function t(t,i){if(e){var r=t.deletions;null===r?(t.deletions=[i],t.flags|=16):r.push(i)}}function i(i,r){if(!e)return null;for(;null!==r;)t(i,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function n(e,t){return(e=aV(e,t)).index=0,e.sibling=null,e}function a(t,i,r){return(t.index=r,e)?null!==(r=t.alternate)?(r=r.index)<i?(t.flags|=2,i):r:(t.flags|=2,i):(t.flags|=1048576,i)}function s(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,i,r){return null===t||6!==t.tag?(t=aG(i,e.mode,r)).return=e:(t=n(t,i)).return=e,t}function l(e,t,i,r){var a=i.type;return a===m?c(e,t,i.props.children,r,i.key):(null!==t&&(t.elementType===a||"object"==typeof a&&null!==a&&a.$$typeof===T&&iU(a)===t.type)?(r=n(t,i.props)).ref=iO(e,t,i):(r=az(i.type,i.key,i.props,null,e.mode,r)).ref=iO(e,t,i),r.return=e,r)}function u(e,t,i,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==i.containerInfo||t.stateNode.implementation!==i.implementation?(t=aW(i,e.mode,r)).return=e:(t=n(t,i.children||[])).return=e,t}function c(e,t,i,r,a){return null===t||7!==t.tag?(t=aj(i,e.mode,r,a)).return=e:(t=n(t,i)).return=e,t}function h(e,t,i){if("string"==typeof t&&""!==t||"number"==typeof t)return(t=aG(""+t,e.mode,i)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case f:return(i=az(t.type,t.key,t.props,null,e.mode,i)).ref=iO(e,null,t),i.return=e,i;case p:return(t=aW(t,e.mode,i)).return=e,t;case T:var r=t._init;return h(e,r(t._payload),i)}if(P(t)||M(t))return(t=aj(t,e.mode,i,null)).return=e,t;iN(e,t)}return null}function g(e,t,i,r){var n=null!==t?t.key:null;if("string"==typeof i&&""!==i||"number"==typeof i)return null!==n?null:o(e,t,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case f:return i.key===n?l(e,t,i,r):null;case p:return i.key===n?u(e,t,i,r):null;case T:return g(e,t,(n=i._init)(i._payload),r)}if(P(i)||M(i))return null!==n?null:c(e,t,i,r,null);iN(e,i)}return null}function v(e,t,i,r,n){if("string"==typeof r&&""!==r||"number"==typeof r)return o(t,e=e.get(i)||null,""+r,n);if("object"==typeof r&&null!==r){switch(r.$$typeof){case f:return l(t,e=e.get(null===r.key?i:r.key)||null,r,n);case p:return u(t,e=e.get(null===r.key?i:r.key)||null,r,n);case T:return v(e,t,i,(0,r._init)(r._payload),n)}if(P(r)||M(r))return c(t,e=e.get(i)||null,r,n,null);iN(t,r)}return null}return function o(l,u,c,y){if("object"==typeof c&&null!==c&&c.type===m&&null===c.key&&(c=c.props.children),"object"==typeof c&&null!==c){switch(c.$$typeof){case f:e:{for(var b=c.key,_=u;null!==_;){if(_.key===b){if((b=c.type)===m){if(7===_.tag){i(l,_.sibling),(u=n(_,c.props.children)).return=l,l=u;break e}}else if(_.elementType===b||"object"==typeof b&&null!==b&&b.$$typeof===T&&iU(b)===_.type){i(l,_.sibling),(u=n(_,c.props)).ref=iO(l,_,c),u.return=l,l=u;break e}i(l,_);break}t(l,_),_=_.sibling}c.type===m?((u=aj(c.props.children,l.mode,y,c.key)).return=l,l=u):((y=az(c.type,c.key,c.props,null,l.mode,y)).ref=iO(l,u,c),y.return=l,l=y)}return s(l);case p:e:{for(_=c.key;null!==u;){if(u.key===_){if(4===u.tag&&u.stateNode.containerInfo===c.containerInfo&&u.stateNode.implementation===c.implementation){i(l,u.sibling),(u=n(u,c.children||[])).return=l,l=u;break e}i(l,u);break}t(l,u),u=u.sibling}(u=aW(c,l.mode,y)).return=l,l=u}return s(l);case T:return o(l,u,(_=c._init)(c._payload),y)}if(P(c))return function(n,s,o,l){for(var u=null,c=null,d=s,f=s=0,p=null;null!==d&&f<o.length;f++){d.index>f?(p=d,d=null):p=d.sibling;var m=g(n,d,o[f],l);if(null===m){null===d&&(d=p);break}e&&d&&null===m.alternate&&t(n,d),s=a(m,s,f),null===c?u=m:c.sibling=m,c=m,d=p}if(f===o.length)return i(n,d),iT&&iy(n,f),u;if(null===d){for(;f<o.length;f++)null!==(d=h(n,o[f],l))&&(s=a(d,s,f),null===c?u=d:c.sibling=d,c=d);return iT&&iy(n,f),u}for(d=r(n,d);f<o.length;f++)null!==(p=v(d,n,f,o[f],l))&&(e&&null!==p.alternate&&d.delete(null===p.key?f:p.key),s=a(p,s,f),null===c?u=p:c.sibling=p,c=p);return e&&d.forEach(function(e){return t(n,e)}),iT&&iy(n,f),u}(l,u,c,y);if(M(c))return function(n,s,o,l){var u=M(o);if("function"!=typeof u)throw Error(d(150));if(null==(o=u.call(o)))throw Error(d(151));for(var c=u=null,f=s,p=s=0,m=null,y=o.next();null!==f&&!y.done;p++,y=o.next()){f.index>p?(m=f,f=null):m=f.sibling;var b=g(n,f,y.value,l);if(null===b){null===f&&(f=m);break}e&&f&&null===b.alternate&&t(n,f),s=a(b,s,p),null===c?u=b:c.sibling=b,c=b,f=m}if(y.done)return i(n,f),iT&&iy(n,p),u;if(null===f){for(;!y.done;p++,y=o.next())null!==(y=h(n,y.value,l))&&(s=a(y,s,p),null===c?u=y:c.sibling=y,c=y);return iT&&iy(n,p),u}for(f=r(n,f);!y.done;p++,y=o.next())null!==(y=v(f,n,p,y.value,l))&&(e&&null!==y.alternate&&f.delete(null===y.key?p:y.key),s=a(y,s,p),null===c?u=y:c.sibling=y,c=y);return e&&f.forEach(function(e){return t(n,e)}),iT&&iy(n,p),u}(l,u,c,y);iN(l,c)}return"string"==typeof c&&""!==c||"number"==typeof c?(c=""+c,null!==u&&6===u.tag?(i(l,u.sibling),(u=n(u,c)).return=l):(i(l,u),(u=aG(c,l.mode,y)).return=l),s(l=u)):i(l,u)}}var iB=iF(!0),iV=iF(!1),iz={},ij=e7(iz),iH=e7(iz),iG=e7(iz);function iW(e){if(e===iz)throw Error(d(174));return e}function i$(e,t){te(iG,t),te(iH,e),te(ij,iz),e=N(t),e9(ij),te(ij,e)}function iq(){e9(ij),e9(iH),e9(iG)}function iY(e){var t=iW(iG.current),i=iW(ij.current);t=U(i,e.type,t),i!==t&&(te(iH,e),te(ij,t))}function iK(e){iH.current===e&&(e9(ij),e9(iH))}var iX=e7(0);function iZ(e){for(var t=e;null!==t;){if(13===t.tag){var i=t.memoizedState;if(null!==i&&(null===(i=i.dehydrated)||eF(i)||eB(i)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!=(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var iJ=[];function iQ(){for(var e=0;e<iJ.length;e++){var t=iJ[e];K?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}iJ.length=0}var i0=h.ReactCurrentDispatcher,i1=h.ReactCurrentBatchConfig,i2=0,i3=null,i5=null,i4=null,i6=!1,i8=!1,i7=0,i9=0;function re(){throw Error(d(321))}function rt(e,t){if(null===t)return!1;for(var i=0;i<t.length&&i<e.length;i++)if(!tN(e[i],t[i]))return!1;return!0}function ri(e,t,i,r,n,a){if(i2=a,i3=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,i0.current=null===e||null===e.memoizedState?rF:rB,e=i(r,n),i8){a=0;do{if(i8=!1,i7=0,25<=a)throw Error(d(301));a+=1,i4=i5=null,t.updateQueue=null,i0.current=rV,e=i(r,n)}while(i8)}if(i0.current=rU,t=null!==i5&&null!==i5.next,i2=0,i4=i5=i3=null,i6=!1,t)throw Error(d(300));return e}function rr(){var e=0!==i7;return i7=0,e}function rn(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===i4?i3.memoizedState=i4=e:i4=i4.next=e,i4}function ra(){if(null===i5){var e=i3.alternate;e=null!==e?e.memoizedState:null}else e=i5.next;var t=null===i4?i3.memoizedState:i4.next;if(null!==t)i4=t,i5=e;else{if(null===e)throw Error(d(310));e={memoizedState:(i5=e).memoizedState,baseState:i5.baseState,baseQueue:i5.baseQueue,queue:i5.queue,next:null},null===i4?i3.memoizedState=i4=e:i4=i4.next=e}return i4}function rs(e,t){return"function"==typeof t?t(e):t}function ro(e){var t=ra(),i=t.queue;if(null===i)throw Error(d(311));i.lastRenderedReducer=e;var r=i5,n=r.baseQueue,a=i.pending;if(null!==a){if(null!==n){var s=n.next;n.next=a.next,a.next=s}r.baseQueue=n=a,i.pending=null}if(null!==n){a=n.next,r=r.baseState;var o=s=null,l=null,u=a;do{var c=u.lane;if((i2&c)===c)null!==l&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};null===l?(o=l=h,s=r):l=l.next=h,i3.lanes|=c,n2|=c}u=u.next}while(null!==u&&u!==a);null===l?s=r:l.next=o,tN(r,t.memoizedState)||(r1=!0),t.memoizedState=r,t.baseState=s,t.baseQueue=l,i.lastRenderedState=r}if(null!==(e=i.interleaved)){n=e;do a=n.lane,i3.lanes|=a,n2|=a,n=n.next;while(n!==e)}else null===n&&(i.lanes=0);return[t.memoizedState,i.dispatch]}function rl(e){var t=ra(),i=t.queue;if(null===i)throw Error(d(311));i.lastRenderedReducer=e;var r=i.dispatch,n=i.pending,a=t.memoizedState;if(null!==n){i.pending=null;var s=n=n.next;do a=e(a,s.action),s=s.next;while(s!==n);tN(a,t.memoizedState)||(r1=!0),t.memoizedState=a,null===t.baseQueue&&(t.baseState=a),i.lastRenderedState=a}return[a,r]}function ru(){}function rc(e,t){var i=i3,r=ra(),n=t(),a=!tN(r.memoizedState,n);if(a&&(r.memoizedState=n,r1=!0),r=r.queue,rE(rf.bind(null,i,r,e),[e]),r.getSnapshot!==t||a||null!==i4&&1&i4.memoizedState.tag){if(i.flags|=2048,rg(9,rh.bind(null,i,r,n,t),void 0,null),null===nK)throw Error(d(349));0!=(30&i2)||rd(i,t,n)}return n}function rd(e,t,i){e.flags|=16384,e={getSnapshot:t,value:i},null===(t=i3.updateQueue)?(t={lastEffect:null,stores:null},i3.updateQueue=t,t.stores=[e]):null===(i=t.stores)?t.stores=[e]:i.push(e)}function rh(e,t,i,r){t.value=i,t.getSnapshot=r,rp(t)&&ah(e,1,-1)}function rf(e,t,i){return i(function(){rp(t)&&ah(e,1,-1)})}function rp(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!tN(e,i)}catch(e){return!0}}function rm(e){var t=rn();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rs,lastRenderedState:e},t.queue=e,e=e.dispatch=rk.bind(null,i3,e),[t.memoizedState,e]}function rg(e,t,i,r){return e={tag:e,create:t,destroy:i,deps:r,next:null},null===(t=i3.updateQueue)?(t={lastEffect:null,stores:null},i3.updateQueue=t,t.lastEffect=e.next=e):null===(i=t.lastEffect)?t.lastEffect=e.next=e:(r=i.next,i.next=e,e.next=r,t.lastEffect=e),e}function rv(){return ra().memoizedState}function ry(e,t,i,r){var n=rn();i3.flags|=e,n.memoizedState=rg(1|t,i,void 0,void 0===r?null:r)}function rb(e,t,i,r){var n=ra();r=void 0===r?null:r;var a=void 0;if(null!==i5){var s=i5.memoizedState;if(a=s.destroy,null!==r&&rt(r,s.deps)){n.memoizedState=rg(t,i,a,r);return}}i3.flags|=e,n.memoizedState=rg(1|t,i,a,r)}function r_(e,t){return ry(8390656,8,e,t)}function rE(e,t){return rb(2048,8,e,t)}function rS(e,t){return rb(4,2,e,t)}function rx(e,t){return rb(4,4,e,t)}function rT(e,t){return"function"==typeof t?(t(e=e()),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function rw(e,t,i){return i=null!=i?i.concat([e]):null,rb(4,4,rT.bind(null,t,e),i)}function rA(){}function rM(e,t){var i=ra();t=void 0===t?null:t;var r=i.memoizedState;return null!==r&&null!==t&&rt(t,r[1])?r[0]:(i.memoizedState=[e,t],e)}function rR(e,t){var i=ra();t=void 0===t?null:t;var r=i.memoizedState;return null!==r&&null!==t&&rt(t,r[1])?r[0]:(e=e(),i.memoizedState=[e,t],e)}function rC(e,t){var i=tx;tx=0!==i&&4>i?i:4,e(!0);var r=i1.transition;i1.transition={};try{e(!1),t()}finally{tx=i,i1.transition=r}}function rI(){return ra().memoizedState}function rL(e,t,i){var r=ad(e);i={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null},rD(e)?rP(t,i):(rO(e,t,i),null!==(e=ah(e,r,i=ac()))&&rN(e,t,r))}function rk(e,t,i){var r=ad(e),n={lane:r,action:i,hasEagerState:!1,eagerState:null,next:null};if(rD(e))rP(t,n);else{rO(e,t,n);var a=e.alternate;if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,o=a(s,i);if(n.hasEagerState=!0,n.eagerState=o,tN(o,s))return}catch(e){}finally{}null!==(e=ah(e,r,i=ac()))&&rN(e,t,r)}}function rD(e){var t=e.alternate;return e===i3||null!==t&&t===i3}function rP(e,t){i8=i6=!0;var i=e.pending;null===i?t.next=t:(t.next=i.next,i.next=t),e.pending=t}function rO(e,t,i){null!==nK&&0!=(1&e.mode)&&0==(2&nY)?(null===(e=t.interleaved)?(i.next=i,null===t0?t0=[t]:t0.push(t)):(i.next=e.next,e.next=i),t.interleaved=i):(null===(e=t.pending)?i.next=i:(i.next=e.next,e.next=i),t.pending=i)}function rN(e,t,i){if(0!=(4194240&i)){var r=t.lanes;r&=e.pendingLanes,i|=r,t.lanes=i,tS(e,i)}}var rU={readContext:tQ,useCallback:re,useContext:re,useEffect:re,useImperativeHandle:re,useInsertionEffect:re,useLayoutEffect:re,useMemo:re,useReducer:re,useRef:re,useState:re,useDebugValue:re,useDeferredValue:re,useTransition:re,useMutableSource:re,useSyncExternalStore:re,useId:re,unstable_isNewReconciler:!1},rF={readContext:tQ,useCallback:function(e,t){return rn().memoizedState=[e,void 0===t?null:t],e},useContext:tQ,useEffect:r_,useImperativeHandle:function(e,t,i){return i=null!=i?i.concat([e]):null,ry(4194308,4,rT.bind(null,t,e),i)},useLayoutEffect:function(e,t){return ry(4194308,4,e,t)},useInsertionEffect:function(e,t){return ry(4,2,e,t)},useMemo:function(e,t){var i=rn();return t=void 0===t?null:t,e=e(),i.memoizedState=[e,t],e},useReducer:function(e,t,i){var r=rn();return t=void 0!==i?i(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=rL.bind(null,i3,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},rn().memoizedState=e},useState:rm,useDebugValue:rA,useDeferredValue:function(e){var t=rm(e),i=t[0],r=t[1];return r_(function(){var t=i1.transition;i1.transition={};try{r(e)}finally{i1.transition=t}},[e]),i},useTransition:function(){var e=rm(!1),t=e[0];return e=rC.bind(null,e[1]),rn().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,i){var r=i3,n=rn();if(iT){if(void 0===i)throw Error(d(407));i=i()}else{if(i=t(),null===nK)throw Error(d(349));0!=(30&i2)||rd(r,t,i)}n.memoizedState=i;var a={value:i,getSnapshot:t};return n.queue=a,r_(rf.bind(null,r,a,e),[e]),r.flags|=2048,rg(9,rh.bind(null,r,a,i,t),void 0,null),i},useId:function(){var e=rn(),t=nK.identifierPrefix;if(iT){var i=iv,r=ig;t=":"+t+"R"+(i=(r&~(1<<32-th(r)-1)).toString(32)+i),0<(i=i7++)&&(t+="H"+i.toString(32)),t+=":"}else t=":"+t+"r"+(i=i9++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},rB={readContext:tQ,useCallback:rM,useContext:tQ,useEffect:rE,useImperativeHandle:rw,useInsertionEffect:rS,useLayoutEffect:rx,useMemo:rR,useReducer:ro,useRef:rv,useState:function(){return ro(rs)},useDebugValue:rA,useDeferredValue:function(e){var t=ro(rs),i=t[0],r=t[1];return rE(function(){var t=i1.transition;i1.transition={};try{r(e)}finally{i1.transition=t}},[e]),i},useTransition:function(){return[ro(rs)[0],ra().memoizedState]},useMutableSource:ru,useSyncExternalStore:rc,useId:rI,unstable_isNewReconciler:!1},rV={readContext:tQ,useCallback:rM,useContext:tQ,useEffect:rE,useImperativeHandle:rw,useInsertionEffect:rS,useLayoutEffect:rx,useMemo:rR,useReducer:rl,useRef:rv,useState:function(){return rl(rs)},useDebugValue:rA,useDeferredValue:function(e){var t=rl(rs),i=t[0],r=t[1];return rE(function(){var t=i1.transition;i1.transition={};try{r(e)}finally{i1.transition=t}},[e]),i},useTransition:function(){return[rl(rs)[0],ra().memoizedState]},useMutableSource:ru,useSyncExternalStore:rc,useId:rI,unstable_isNewReconciler:!1};function rz(e,t){try{var i="",r=t;do i+=function(e){switch(e.tag){case 5:return e2(e.type);case 16:return e2("Lazy");case 13:return e2("Suspense");case 19:return e2("SuspenseList");case 0:case 2:case 15:return e=e5(e.type,!1);case 11:return e=e5(e.type.render,!1);case 1:return e=e5(e.type,!0);default:return""}}(r),r=r.return;while(r);var n=i}catch(e){n="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:n}}function rj(e,t){try{console.error(t.value)}catch(e){setTimeout(function(){throw e})}}var rH="function"==typeof WeakMap?WeakMap:Map;function rG(e,t,i){(i=t5(-1,i)).tag=3,i.payload={element:null};var r=t.value;return i.callback=function(){ae||(ae=!0,at=r),rj(e,t)},i}function rW(e,t,i){(i=t5(-1,i)).tag=3;var r=e.type.getDerivedStateFromError;if("function"==typeof r){var n=t.value;i.payload=function(){return r(n)},i.callback=function(){rj(e,t)}}var a=e.stateNode;return null!==a&&"function"==typeof a.componentDidCatch&&(i.callback=function(){rj(e,t),"function"!=typeof r&&(null===ai?ai=new Set([this]):ai.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:null!==i?i:""})}),i}function r$(e,t,i){var r=e.pingCache;if(null===r){r=e.pingCache=new rH;var n=new Set;r.set(t,n)}else void 0===(n=r.get(t))&&(n=new Set,r.set(t,n));n.has(i)||(n.add(i),e=aD.bind(null,e,t,i),t.then(e,e))}function rq(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function rY(e,t,i,r,n){return 0==(1&e.mode)?e===t?e.flags|=65536:(e.flags|=128,i.flags|=131072,i.flags&=-52805,1===i.tag&&(null===i.alternate?i.tag=17:((t=t5(-1,1)).tag=2,t4(i,t))),i.lanes|=1):(e.flags|=65536,e.lanes=n),e}function rK(e){e.flags|=4}function rX(e,t){if(null!==e&&e.child===t.child)return!0;if(0!=(16&t.flags))return!1;for(e=t.child;null!==e;){if(0!=(12854&e.flags)||0!=(12854&e.subtreeFlags))return!1;e=e.sibling}return!0}if(X)t=function(e,t){for(var i=t.child;null!==i;){if(5===i.tag||6===i.tag)z(e,i.stateNode);else if(4!==i.tag&&null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;i=i.return}i.sibling.return=i.return,i=i.sibling}},r=function(){},n=function(e,t,i,r,n){(e=e.memoizedProps)!==r&&(i=H(t.stateNode,i,e,r,n,iW(ij.current)),(t.updateQueue=i)&&rK(t))},a=function(e,t,i,r){i!==r&&rK(t)};else if(Z){t=function(e,i,r,n){for(var a=i.child;null!==a;){if(5===a.tag){var s=a.stateNode;r&&n&&(s=eD(s,a.type,a.memoizedProps,a)),z(e,s)}else if(6===a.tag)s=a.stateNode,r&&n&&(s=eP(s,a.memoizedProps,a)),z(e,s);else if(4!==a.tag){if(22===a.tag&&null!==a.memoizedState)null!==(s=a.child)&&(s.return=a),t(e,a,!0,!0);else if(null!==a.child){a.child.return=a,a=a.child;continue}}if(a===i)break;for(;null===a.sibling;){if(null===a.return||a.return===i)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};var rZ=function(e,t,i,r){for(var n=t.child;null!==n;){if(5===n.tag){var a=n.stateNode;i&&r&&(a=eD(a,n.type,n.memoizedProps,n)),eI(e,a)}else if(6===n.tag)a=n.stateNode,i&&r&&(a=eP(a,n.memoizedProps,n)),eI(e,a);else if(4!==n.tag){if(22===n.tag&&null!==n.memoizedState)null!==(a=n.child)&&(a.return=n),rZ(e,n,!0,!0);else if(null!==n.child){n.child.return=n,n=n.child;continue}}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};r=function(e,t){var i=t.stateNode;if(!rX(e,t)){var r=eC(e=i.containerInfo);rZ(r,t,!1,!1),i.pendingChildren=r,rK(t),eL(e,r)}},n=function(e,i,r,n,a){var s=e.stateNode,o=e.memoizedProps;if((e=rX(e,i))&&o===n)i.stateNode=s;else{var l=i.stateNode,u=iW(ij.current),c=null;o!==n&&(c=H(l,r,o,n,a,u)),e&&null===c?i.stateNode=s:(j(s=eR(s,c,r,o,n,i,e,l),r,n,a,u)&&rK(i),i.stateNode=s,e?rK(i):t(s,i,!1,!1))}},a=function(e,t,i,r){i!==r?(e=iW(iG.current),i=iW(ij.current),t.stateNode=W(r,e,i,t),rK(t)):t.stateNode=e.stateNode}}else r=function(){},n=function(){},a=function(){};function rJ(e,t){if(!iT)switch(e.tailMode){case"hidden":t=e.tail;for(var i=null;null!==t;)null!==t.alternate&&(i=t),t=t.sibling;null===i?e.tail=null:i.sibling=null;break;case"collapsed":i=e.tail;for(var r=null;null!==i;)null!==i.alternate&&(r=i),i=i.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function rQ(e){var t=null!==e.alternate&&e.alternate.child===e.child,i=0,r=0;if(t)for(var n=e.child;null!==n;)i|=n.lanes|n.childLanes,r|=14680064&n.subtreeFlags,r|=14680064&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)i|=n.lanes|n.childLanes,r|=n.subtreeFlags,r|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=r,e.childLanes=i,t}var r0=h.ReactCurrentOwner,r1=!1;function r2(e,t,i,r){t.child=null===e?iV(t,null,i,r):iB(t,e.child,i,r)}function r3(e,t,i,r,n){i=i.render;var a=t.ref;return(tJ(t,n),r=ri(e,t,i,r,a,n),i=rr(),null===e||r1)?(iT&&i&&i_(t),t.flags|=1,r2(e,t,r,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,nd(e,t,n))}function r5(e,t,i,r,n){if(null===e){var a=i.type;return"function"!=typeof a||aB(a)||void 0!==a.defaultProps||null!==i.compare||void 0!==i.defaultProps?((e=az(i.type,null,r,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,r4(e,t,a,r,n))}if(a=e.child,0==(e.lanes&n)){var s=a.memoizedProps;if((i=null!==(i=i.compare)?i:tj)(s,r)&&e.ref===t.ref)return nd(e,t,n)}return t.flags|=1,(e=aV(a,r)).ref=t.ref,e.return=t,t.child=e}function r4(e,t,i,r,n){if(null!==e&&tj(e.memoizedProps,r)&&e.ref===t.ref){if(r1=!1,0==(e.lanes&n))return t.lanes=e.lanes,nd(e,t,n);0!=(131072&e.flags)&&(r1=!0)}return r7(e,t,i,r,n)}function r6(e,t,i){var r=t.pendingProps,n=r.children,a=null!==e?e.memoizedState:null;if("hidden"===r.mode){if(0==(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null},te(nQ,nJ),nJ|=i;else{if(0==(1073741824&i))return e=null!==a?a.baseLanes|i:i,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null},t.updateQueue=null,te(nQ,nJ),nJ|=e,null;t.memoizedState={baseLanes:0,cachePool:null},r=null!==a?a.baseLanes:i,te(nQ,nJ),nJ|=r}}else null!==a?(r=a.baseLanes|i,t.memoizedState=null):r=i,te(nQ,nJ),nJ|=r;return r2(e,t,n,i),t.child}function r8(e,t){var i=t.ref;(null===e&&null!==i||null!==e&&e.ref!==i)&&(t.flags|=512,t.flags|=2097152)}function r7(e,t,i,r,n){var a=ts(i)?tn:ti.current;return(a=ta(t,a),tJ(t,n),i=ri(e,t,i,r,a,n),r=rr(),null===e||r1)?(iT&&r&&i_(t),t.flags|=1,r2(e,t,i,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,nd(e,t,n))}function r9(e,t,i,r,n){if(ts(i)){var a=!0;tc(t)}else a=!1;if(tJ(t,n),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),ia(t,i,r),io(t,i,r,n),r=!0;else if(null===e){var s=t.stateNode,o=t.memoizedProps;s.props=o;var l=s.context,u=i.contextType;u="object"==typeof u&&null!==u?tQ(u):ta(t,u=ts(i)?tn:ti.current);var c=i.getDerivedStateFromProps,d="function"==typeof c||"function"==typeof s.getSnapshotBeforeUpdate;d||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==r||l!==u)&&is(t,s,r,u),t1=!1;var h=t.memoizedState;s.state=h,t7(t,r,s,n),l=t.memoizedState,o!==r||h!==l||tr.current||t1?("function"==typeof c&&(it(t,i,c,r),l=t.memoizedState),(o=t1||ir(t,i,o,r,h,l,u))?(d||"function"!=typeof s.UNSAFE_componentWillMount&&"function"!=typeof s.componentWillMount||("function"==typeof s.componentWillMount&&s.componentWillMount(),"function"==typeof s.UNSAFE_componentWillMount&&s.UNSAFE_componentWillMount()),"function"==typeof s.componentDidMount&&(t.flags|=4194308)):("function"==typeof s.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),s.props=r,s.state=l,s.context=u,r=o):("function"==typeof s.componentDidMount&&(t.flags|=4194308),r=!1)}else{s=t.stateNode,t3(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:tH(t.type,o),s.props=u,d=t.pendingProps,h=s.context,l="object"==typeof(l=i.contextType)&&null!==l?tQ(l):ta(t,l=ts(i)?tn:ti.current);var f=i.getDerivedStateFromProps;(c="function"==typeof f||"function"==typeof s.getSnapshotBeforeUpdate)||"function"!=typeof s.UNSAFE_componentWillReceiveProps&&"function"!=typeof s.componentWillReceiveProps||(o!==d||h!==l)&&is(t,s,r,l),t1=!1,h=t.memoizedState,s.state=h,t7(t,r,s,n);var p=t.memoizedState;o!==d||h!==p||tr.current||t1?("function"==typeof f&&(it(t,i,f,r),p=t.memoizedState),(u=t1||ir(t,i,u,r,h,p,l)||!1)?(c||"function"!=typeof s.UNSAFE_componentWillUpdate&&"function"!=typeof s.componentWillUpdate||("function"==typeof s.componentWillUpdate&&s.componentWillUpdate(r,p,l),"function"==typeof s.UNSAFE_componentWillUpdate&&s.UNSAFE_componentWillUpdate(r,p,l)),"function"==typeof s.componentDidUpdate&&(t.flags|=4),"function"==typeof s.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),s.props=r,s.state=p,s.context=l,r=u):("function"!=typeof s.componentDidUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!=typeof s.getSnapshotBeforeUpdate||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),r=!1)}return ne(e,t,i,r,a,n)}function ne(e,t,i,r,n,a){r8(e,t);var s=0!=(128&t.flags);if(!r&&!s)return n&&td(t,i,!1),nd(e,t,a);r=t.stateNode,r0.current=t;var o=s&&"function"!=typeof i.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&s?(t.child=iB(t,e.child,null,a),t.child=iB(t,null,o,a)):r2(e,t,o,a),t.memoizedState=r.state,n&&td(t,i,!0),t.child}function nt(e){var t=e.stateNode;t.pendingContext?tl(e,t.pendingContext,t.pendingContext!==t.context):t.context&&tl(e,t.context,!1),i$(e,t.containerInfo)}function ni(e,t,i,r,n){return iD(),iP(n),t.flags|=256,r2(e,t,i,r),t.child}var nr={dehydrated:null,treeContext:null,retryLane:0};function nn(e){return{baseLanes:e,cachePool:null}}function na(e,t,i){var r,n,a,s,o,l,u,c,h,f,p,m,g,v,y=t.pendingProps,b=iX.current,_=!1,E=0!=(128&t.flags);if((v=E)||(v=(null===e||null!==e.memoizedState)&&0!=(2&b)),v?(_=!0,t.flags&=-129):(null===e||null!==e.memoizedState)&&(b|=1),te(iX,1&b),null===e)return(iI(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated))?(0==(1&t.mode)?t.lanes=1:eB(e)?t.lanes=8:t.lanes=1073741824,null):(b=y.children,e=y.fallback,_?(y=t.mode,_=t.child,b={mode:"hidden",children:b},0==(1&y)&&null!==_?(_.childLanes=0,_.pendingProps=b):_=aH(b,y,0,null),e=aj(e,y,i,null),_.return=t,e.return=t,_.sibling=e,t.child=_,t.child.memoizedState=nn(i),t.memoizedState=nr,e):ns(t,b));if(null!==(b=e.memoizedState)&&null!==(v=b.dehydrated)){if(E)return 256&t.flags?(t.flags&=-257,no(e,t,i,Error(d(422)))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(_=y.fallback,b=t.mode,y=aH({mode:"visible",children:y.children},b,0,null),_=aj(_,b,i,null),_.flags|=2,y.return=t,_.return=t,y.sibling=_,t.child=y,0!=(1&t.mode)&&iB(t,e.child,null,i),t.child.memoizedState=nn(i),t.memoizedState=nr,_);if(0==(1&t.mode))t=no(e,t,i,null);else if(eB(v))t=no(e,t,i,Error(d(419)));else if(y=0!=(i&e.childLanes),r1||y){if(null!==(y=nK)){switch(i&-i){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}0!==(y=0!=(_&(y.suspendedLanes|i))?0:_)&&y!==b.retryLane&&(b.retryLane=y,ah(e,y,-1))}aw(),t=no(e,t,i,Error(d(421)))}else eF(v)?(t.flags|=128,t.child=e.child,eV(v,t=aO.bind(null,e)),t=null):(i=b.treeContext,J&&(ix=eG(v),iS=t,iT=!0,iA=null,iw=!1,null!==i&&(ih[ip++]=ig,ih[ip++]=iv,ih[ip++]=im,ig=i.id,iv=i.overflow,im=t)),t=ns(t,t.pendingProps.children),t.flags|=4096);return t}return _?(r=e,n=t,a=y.children,s=y.fallback,o=i,l=n.mode,u=(r=r.child).sibling,c={mode:"hidden",children:a},0==(1&l)&&n.child!==r?((a=n.child).childLanes=0,a.pendingProps=c,n.deletions=null):(a=aV(r,c)).subtreeFlags=14680064&r.subtreeFlags,null!==u?s=aV(u,s):(s=aj(s,l,o,null),s.flags|=2),s.return=n,a.return=n,a.sibling=s,n.child=a,y=s,_=t.child,b=e.child.memoizedState,_.memoizedState=null===b?nn(i):{baseLanes:b.baseLanes|i,cachePool:null},_.childLanes=e.childLanes&~i,t.memoizedState=nr,y):(h=e,f=t,p=y.children,m=i,g=h.child,h=g.sibling,p=aV(g,{mode:"visible",children:p}),0==(1&f.mode)&&(p.lanes=m),p.return=f,p.sibling=null,null!==h&&(null===(m=f.deletions)?(f.deletions=[h],f.flags|=16):m.push(h)),i=f.child=p,t.memoizedState=null,i)}function ns(e,t){return(t=aH({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function no(e,t,i,r){return null!==r&&iP(r),iB(t,e.child,null,i),e=ns(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function nl(e,t,i){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),tZ(e.return,t,i)}function nu(e,t,i,r,n){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:i,tailMode:n}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=i,a.tailMode=n)}function nc(e,t,i){var r=t.pendingProps,n=r.revealOrder,a=r.tail;if(r2(e,t,r.children,i),0!=(2&(r=iX.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!=(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&nl(e,i,t);else if(19===e.tag)nl(e,i,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(te(iX,r),0==(1&t.mode))t.memoizedState=null;else switch(n){case"forwards":for(n=null,i=t.child;null!==i;)null!==(e=i.alternate)&&null===iZ(e)&&(n=i),i=i.sibling;null===(i=n)?(n=t.child,t.child=null):(n=i.sibling,i.sibling=null),nu(t,!1,n,i,a);break;case"backwards":for(i=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===iZ(e)){t.child=n;break}e=n.sibling,n.sibling=i,i=n,n=e}nu(t,!0,i,null,a);break;case"together":nu(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function nd(e,t,i){if(null!==e&&(t.dependencies=e.dependencies),n2|=t.lanes,0==(i&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(d(153));if(null!==t.child){for(i=aV(e=t.child,e.pendingProps),t.child=i,i.return=t;null!==e.sibling;)e=e.sibling,(i=i.sibling=aV(e,e.pendingProps)).return=t;i.sibling=null}return t.child}var nh=!1,nf=!1,np="function"==typeof WeakSet?WeakSet:Set,nm=null;function ng(e,t){var i=e.ref;if(null!==i){if("function"==typeof i)try{i(null)}catch(i){ak(e,t,i)}else i.current=null}}function nv(e,t,i){try{i()}catch(i){ak(e,t,i)}}var ny=!1;function nb(e,t,i){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var n=r=r.next;do{if((n.tag&e)===e){var a=n.destroy;n.destroy=void 0,void 0!==a&&nv(t,i,a)}n=n.next}while(n!==r)}}function n_(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var i=t=t.next;do{if((i.tag&e)===e){var r=i.create;i.destroy=r()}i=i.next}while(i!==t)}}function nE(e){var t=e.ref;if(null!==t){var i=e.stateNode;e=5===e.tag?O(i):i,"function"==typeof t?t(e):t.current=e}}function nS(e,t,i){if(tO&&"function"==typeof tO.onCommitFiberUnmount)try{tO.onCommitFiberUnmount(tP,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e=e.next;do{var n=r,a=n.destroy;n=n.tag,void 0!==a&&(0!=(2&n)?nv(t,i,a):0!=(4&n)&&nv(t,i,a)),r=r.next}while(r!==e)}break;case 1:if(ng(t,i),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){ak(t,i,e)}break;case 5:ng(t,i);break;case 4:X?nM(e,t,i):Z&&Z&&(i=eC(t=t.stateNode.containerInfo),ek(t,i))}}function nx(e,t,i){for(var r=t;;)if(nS(e,r,i),null===r.child||X&&4===r.tag){if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}else r.child.return=r,r=r.child}function nT(e){return 5===e.tag||3===e.tag||4===e.tag}function nw(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||nT(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags||null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function nA(e){if(X){e:{for(var t=e.return;null!==t;){if(nT(t))break e;t=t.return}throw Error(d(160))}var i=t;switch(i.tag){case 5:t=i.stateNode,32&i.flags&&(eS(t),i.flags&=-33),i=nw(e),function e(t,i,r){var n=t.tag;if(5===n||6===n)t=t.stateNode,i?ey(r,t,i):ef(r,t);else if(4!==n&&null!==(t=t.child))for(e(t,i,r),t=t.sibling;null!==t;)e(t,i,r),t=t.sibling}(e,i,t);break;case 3:case 4:t=i.stateNode.containerInfo,i=nw(e),function e(t,i,r){var n=t.tag;if(5===n||6===n)t=t.stateNode,i?eb(r,t,i):ep(r,t);else if(4!==n&&null!==(t=t.child))for(e(t,i,r),t=t.sibling;null!==t;)e(t,i,r),t=t.sibling}(e,i,t);break;default:throw Error(d(161))}}}function nM(e,t,i){for(var r,n,a=t,s=!1;;){if(!s){s=a.return;e:for(;;){if(null===s)throw Error(d(160));switch(r=s.stateNode,s.tag){case 5:n=!1;break e;case 3:case 4:r=r.containerInfo,n=!0;break e}s=s.return}s=!0}if(5===a.tag||6===a.tag)nx(e,a,i),n?eE(r,a.stateNode):e_(r,a.stateNode);else if(18===a.tag)n?eJ(r,a.stateNode):eZ(r,a.stateNode);else if(4===a.tag){if(null!==a.child){r=a.stateNode.containerInfo,n=!0,a.child.return=a,a=a.child;continue}}else if(nS(e,a,i),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(s=!1)}a.sibling.return=a.return,a=a.sibling}}function nR(e,t){if(X){switch(t.tag){case 0:case 11:case 14:case 15:nb(3,t,t.return),n_(3,t),nb(5,t,t.return);return;case 1:case 12:case 17:return;case 5:var i=t.stateNode;if(null!=i){var r=t.memoizedProps;e=null!==e?e.memoizedProps:r;var n=t.type,a=t.updateQueue;t.updateQueue=null,null!==a&&ev(i,a,n,e,r,t)}return;case 6:if(null===t.stateNode)throw Error(d(162));i=t.memoizedProps,em(t.stateNode,null!==e?e.memoizedProps:i,i);return;case 3:J&&null!==e&&e.memoizedState.isDehydrated&&eK(t.stateNode.containerInfo);return;case 13:case 19:nC(t);return}throw Error(d(163))}switch(t.tag){case 0:case 11:case 14:case 15:nb(3,t,t.return),n_(3,t),nb(5,t,t.return);return;case 12:case 22:case 23:return;case 13:case 19:nC(t);return;case 3:J&&null!==e&&e.memoizedState.isDehydrated&&eK(t.stateNode.containerInfo)}e:if(Z){switch(t.tag){case 1:case 5:case 6:break e;case 3:case 4:ek((t=t.stateNode).containerInfo,t.pendingChildren);break e}throw Error(d(163))}}function nC(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var i=e.stateNode;null===i&&(i=e.stateNode=new np),t.forEach(function(t){var r=aN.bind(null,e,t);i.has(t)||(i.add(t),t.then(r,r))})}}function nI(e){for(;null!==nm;){var t=nm;if(0!=(8772&t.flags)){var i=t.alternate;try{if(0!=(8772&t.flags))switch(t.tag){case 0:case 11:case 15:nf||n_(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!nf){if(null===i)r.componentDidMount();else{var n=t.elementType===t.type?i.memoizedProps:tH(t.type,i.memoizedProps);r.componentDidUpdate(n,i.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}}var a=t.updateQueue;null!==a&&t9(t,a,r);break;case 3:var s=t.updateQueue;if(null!==s){if(i=null,null!==t.child)switch(t.child.tag){case 5:i=O(t.child.stateNode);break;case 1:i=t.child.stateNode}t9(t,s,i)}break;case 5:var o=t.stateNode;null===i&&4&t.flags&&eg(o,t.type,t.memoizedProps,t);break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:break;case 13:if(J&&null===t.memoizedState){var l=t.alternate;if(null!==l){var u=l.memoizedState;if(null!==u){var c=u.dehydrated;null!==c&&eX(c)}}}break;default:throw Error(d(163))}nf||512&t.flags&&nE(t)}catch(e){ak(t,t.return,e)}}if(t===e){nm=null;break}if(null!==(i=t.sibling)){i.return=t.return,nm=i;break}nm=t.return}}function nL(e){for(;null!==nm;){var t=nm;if(t===e){nm=null;break}var i=t.sibling;if(null!==i){i.return=t.return,nm=i;break}nm=t.return}}function nk(e){for(;null!==nm;){var t=nm;try{switch(t.tag){case 0:case 11:case 15:var i=t.return;try{n_(4,t)}catch(e){ak(t,i,e)}break;case 1:var r=t.stateNode;if("function"==typeof r.componentDidMount){var n=t.return;try{r.componentDidMount()}catch(e){ak(t,n,e)}}var a=t.return;try{nE(t)}catch(e){ak(t,a,e)}break;case 5:var s=t.return;try{nE(t)}catch(e){ak(t,s,e)}}}catch(e){ak(t,t.return,e)}if(t===e){nm=null;break}var o=t.sibling;if(null!==o){o.return=t.return,nm=o;break}nm=t.return}}var nD=0,nP=1,nO=2,nN=3,nU=4;if("function"==typeof Symbol&&Symbol.for){var nF=Symbol.for;nD=nF("selector.component"),nP=nF("selector.has_pseudo_class"),nO=nF("selector.role"),nN=nF("selector.test_id"),nU=nF("selector.text")}function nB(e){var t=Q(e);if(null!=t){if("string"!=typeof t.memoizedProps["data-testname"])throw Error(d(364));return t}if(null===(e=es(e)))throw Error(d(362));return e.stateNode.current}function nV(e,t){switch(t.$$typeof){case nD:if(e.type===t.value)return!0;break;case nP:e:{t=t.value,e=[e,0];for(var i=0;i<e.length;){var r=e[i++],n=e[i++],a=t[n];if(5!==r.tag||!eu(r)){for(;null!=a&&nV(r,a);)a=t[++n];if(n===t.length){t=!0;break e}for(r=r.child;null!==r;)e.push(r,n),r=r.sibling}}t=!1}return t;case nO:if(5===e.tag&&ec(e.stateNode,t.value))return!0;break;case nU:if((5===e.tag||6===e.tag)&&null!==(e=el(e))&&0<=e.indexOf(t.value))return!0;break;case nN:if(5===e.tag&&"string"==typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase())return!0;break;default:throw Error(d(365))}return!1}function nz(e){switch(e.$$typeof){case nD:return"<"+(R(e.value)||"Unknown")+">";case nP:return":has("+(nz(e)||"")+")";case nO:return'[role="'+e.value+'"]';case nU:return'"'+e.value+'"';case nN:return'[data-testname="'+e.value+'"]';default:throw Error(d(365))}}function nj(e,t){var i=[];e=[e,0];for(var r=0;r<e.length;){var n=e[r++],a=e[r++],s=t[a];if(5!==n.tag||!eu(n)){for(;null!=s&&nV(n,s);)s=t[++a];if(a===t.length)i.push(n);else for(n=n.child;null!==n;)e.push(n,a),n=n.sibling}}return i}function nH(e,t){if(!ea)throw Error(d(363));e=nj(e=nB(e),t),t=[],e=Array.from(e);for(var i=0;i<e.length;){var r=e[i++];if(5===r.tag)eu(r)||t.push(r.stateNode);else for(r=r.child;null!==r;)e.push(r),r=r.sibling}return t}var nG=Math.ceil,nW=h.ReactCurrentDispatcher,n$=h.ReactCurrentOwner,nq=h.ReactCurrentBatchConfig,nY=0,nK=null,nX=null,nZ=0,nJ=0,nQ=e7(0),n0=0,n1=null,n2=0,n3=0,n5=0,n4=null,n6=null,n8=0,n7=1/0;function n9(){n7=tC()+500}var ae=!1,at=null,ai=null,ar=!1,an=null,aa=0,as=0,ao=null,al=-1,au=0;function ac(){return 0!=(6&nY)?tC():-1!==al?al:al=tC()}function ad(e){return 0==(1&e.mode)?1:0!=(2&nY)&&0!==nZ?nZ&-nZ:null!==tz.transition?(0===au&&(e=tm,0==(4194240&(tm<<=1))&&(tm=64),au=e),au):0!==(e=tx)?e:et()}function ah(e,t,i){if(50<as)throw as=0,ao=null,Error(d(185));var r=af(e,t);return null===r?null:(tE(r,t,i),(0==(2&nY)||r!==nK)&&(r===nK&&(0==(2&nY)&&(n3|=t),4===n0&&ay(r,nZ)),ap(r,i),1===t&&0===nY&&0==(1&e.mode)&&(n9(),tF&&tV())),r)}function af(e,t){e.lanes|=t;var i=e.alternate;for(null!==i&&(i.lanes|=t),i=e,e=e.return;null!==e;)e.childLanes|=t,null!==(i=e.alternate)&&(i.childLanes|=t),i=e,e=e.return;return 3===i.tag?i.stateNode:null}function ap(e,t){var i,r,n,a=e.callbackNode;!function(e,t){for(var i=e.suspendedLanes,r=e.pingedLanes,n=e.expirationTimes,a=e.pendingLanes;0<a;){var s=31-th(a),o=1<<s,l=n[s];-1===l?(0==(o&i)||0!=(o&r))&&(n[s]=function(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return -1}}(o,t)):l<=t&&(e.expiredLanes|=o),a&=~o}}(e,t);var s=ty(e,e===nK?nZ:0);if(0===s)null!==a&&tA(a),e.callbackNode=null,e.callbackPriority=0;else if(t=s&-s,e.callbackPriority!==t){if(null!=a&&tA(a),1===t){0===e.tag&&(tF=!0),i=ab.bind(null,e),null===tU?tU=[i]:tU.push(i),er?en(function(){0===nY&&tV()}):tw(tI,tV),a=null}else{switch(tT(s)){case 1:a=tI;break;case 4:a=tL;break;case 16:default:a=tk;break;case 536870912:a=tD}r=a,n=am.bind(null,e),a=tw(r,n)}e.callbackPriority=t,e.callbackNode=a}}function am(e,t){if(al=-1,au=0,0!=(6&nY))throw Error(d(327));var i=e.callbackNode;if(aI()&&e.callbackNode!==i)return null;var r=ty(e,e===nK?nZ:0);if(0===r)return null;if(0!=(30&r)||0!=(r&e.expiredLanes)||t)t=aA(e,r);else{t=r;var n=nY;nY|=2;var a=aT();for((nK!==e||nZ!==t)&&(n9(),aS(e,t));;)try{!function(){for(;null!==nX&&!tM();)aM(nX)}();break}catch(t){ax(e,t)}tY(),nW.current=a,nY=n,null!==nX?t=0:(nK=null,nZ=0,t=n0)}if(0!==t){if(2===t&&0!==(n=tb(e))&&(r=n,t=ag(e,n)),1===t)throw i=n1,aS(e,0),ay(e,r),ap(e,tC()),i;if(6===t)ay(e,r);else{if(n=e.current.alternate,0==(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var i=t.updateQueue;if(null!==i&&null!==(i=i.stores))for(var r=0;r<i.length;r++){var n=i[r],a=n.getSnapshot;n=n.value;try{if(!tN(a(),n))return!1}catch(e){return!1}}}if(i=t.child,16384&t.subtreeFlags&&null!==i)i.return=t,t=i;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(n)&&(2===(t=aA(e,r))&&0!==(a=tb(e))&&(r=a,t=ag(e,a)),1===t))throw i=n1,aS(e,0),ay(e,r),ap(e,tC()),i;switch(e.finishedWork=n,e.finishedLanes=r,t){case 0:case 1:throw Error(d(345));case 2:case 5:aC(e,n6);break;case 3:if(ay(e,r),(130023424&r)===r&&10<(t=n8+500-tC())){if(0!==ty(e,0))break;if(((n=e.suspendedLanes)&r)!==r){ac(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=$(aC.bind(null,e,n6),t);break}aC(e,n6);break;case 4:if(ay(e,r),(4194240&r)===r)break;for(n=-1,t=e.eventTimes;0<r;){var s=31-th(r);a=1<<s,(s=t[s])>n&&(n=s),r&=~a}if(r=n,10<(r=(120>(r=tC()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*nG(r/1960))-r)){e.timeoutHandle=$(aC.bind(null,e,n6),r);break}aC(e,n6);break;default:throw Error(d(329))}}}return ap(e,tC()),e.callbackNode===i?am.bind(null,e):null}function ag(e,t){var i=n4;return e.current.memoizedState.isDehydrated&&(aS(e,t).flags|=256),2!==(e=aA(e,t))&&(t=n6,n6=i,null!==t&&av(t)),e}function av(e){null===n6?n6=e:n6.push.apply(n6,e)}function ay(e,t){for(t&=~n5,t&=~n3,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var i=31-th(t),r=1<<i;e[i]=-1,t&=~r}}function ab(e){if(0!=(6&nY))throw Error(d(327));aI();var t=ty(e,0);if(0==(1&t))return ap(e,tC()),null;var i=aA(e,t);if(0!==e.tag&&2===i){var r=tb(e);0!==r&&(t=r,i=ag(e,r))}if(1===i)throw i=n1,aS(e,0),ay(e,t),ap(e,tC()),i;if(6===i)throw Error(d(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,aC(e,n6),ap(e,tC()),null}function a_(e){null!==an&&0===an.tag&&0==(6&nY)&&aI();var t=nY;nY|=1;var i=nq.transition,r=tx;try{if(nq.transition=null,tx=1,e)return e()}finally{tx=r,nq.transition=i,0==(6&(nY=t))&&tV()}}function aE(){nJ=nQ.current,e9(nQ)}function aS(e,t){e.finishedWork=null,e.finishedLanes=0;var i=e.timeoutHandle;if(i!==Y&&(e.timeoutHandle=Y,q(i)),null!==nX)for(i=nX.return;null!==i;){var r=i;switch(iE(r),r.tag){case 1:null!=(r=r.type.childContextTypes)&&to();break;case 3:iq(),e9(tr),e9(ti),iQ();break;case 5:iK(r);break;case 4:iq();break;case 13:case 19:e9(iX);break;case 10:tX(r.type._context);break;case 22:case 23:aE()}i=i.return}if(nK=e,nX=e=aV(e.current,null),nZ=nJ=t,n0=0,n1=null,n5=n3=n2=0,n6=n4=null,null!==t0){for(t=0;t<t0.length;t++)if(null!==(r=(i=t0[t]).interleaved)){i.interleaved=null;var n=r.next,a=i.pending;if(null!==a){var s=a.next;a.next=n,r.next=s}i.pending=r}t0=null}return e}function ax(e,t){for(;;){var i=nX;try{if(tY(),i0.current=rU,i6){for(var r=i3.memoizedState;null!==r;){var n=r.queue;null!==n&&(n.pending=null),r=r.next}i6=!1}if(i2=0,i4=i5=i3=null,i8=!1,i7=0,n$.current=null,null===i||null===i.return){n0=1,n1=t,nX=null;break}e:{var a=e,s=i.return,o=i,l=t;if(t=nZ,o.flags|=32768,null!==l&&"object"==typeof l&&"function"==typeof l.then){var u=l,c=o,h=c.tag;if(0==(1&c.mode)&&(0===h||11===h||15===h)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var p=rq(s);if(null!==p){p.flags&=-257,rY(p,s,o,a,t),1&p.mode&&r$(a,u,t),t=p,l=u;var m=t.updateQueue;if(null===m){var g=new Set;g.add(l),t.updateQueue=g}else m.add(l);break e}if(0==(1&t)){r$(a,u,t),aw();break e}l=Error(d(426))}else if(iT&&1&o.mode){var v=rq(s);if(null!==v){0==(65536&v.flags)&&(v.flags|=256),rY(v,s,o,a,t),iP(l);break e}}a=l,4!==n0&&(n0=2),null===n4?n4=[a]:n4.push(a),l=rz(l,o),o=s;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t;var y=rG(o,l,t);t8(o,y);break e;case 1:a=l;var b=o.type,_=o.stateNode;if(0==(128&o.flags)&&("function"==typeof b.getDerivedStateFromError||null!==_&&"function"==typeof _.componentDidCatch&&(null===ai||!ai.has(_)))){o.flags|=65536,t&=-t,o.lanes|=t;var E=rW(o,a,t);t8(o,E);break e}}o=o.return}while(null!==o)}aR(i)}catch(e){t=e,nX===i&&null!==i&&(nX=i=i.return);continue}break}}function aT(){var e=nW.current;return nW.current=rU,null===e?rU:e}function aw(){(0===n0||3===n0||2===n0)&&(n0=4),null===nK||0==(268435455&n2)&&0==(268435455&n3)||ay(nK,nZ)}function aA(e,t){var i=nY;nY|=2;var r=aT();for(nK===e&&nZ===t||aS(e,t);;)try{!function(){for(;null!==nX;)aM(nX)}();break}catch(t){ax(e,t)}if(tY(),nY=i,nW.current=r,null!==nX)throw Error(d(261));return nK=null,nZ=0,n0}function aM(e){var t=s(e.alternate,e,nJ);e.memoizedProps=e.pendingProps,null===t?aR(e):nX=t,n$.current=null}function aR(e){var i=e;do{var s=i.alternate;if(e=i.return,0==(32768&i.flags)){if(null!==(s=function(e,i,s){var o=i.pendingProps;switch(iE(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return rQ(i),null;case 1:case 17:return ts(i.type)&&to(),rQ(i),null;case 3:return o=i.stateNode,iq(),e9(tr),e9(ti),iQ(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(null===e||null===e.child)&&(ik(i)?rK(i):null===e||e.memoizedState.isDehydrated&&0==(256&i.flags)||(i.flags|=1024,null!==iA&&(av(iA),iA=null))),r(e,i),rQ(i),null;case 5:iK(i),s=iW(iG.current);var l=i.type;if(null!==e&&null!=i.stateNode)n(e,i,l,o,s),e.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!o){if(null===i.stateNode)throw Error(d(166));return rQ(i),null}if(e=iW(ij.current),ik(i)){if(!J)throw Error(d(175));e=eW(i.stateNode,i.type,i.memoizedProps,s,e,i,!iw),i.updateQueue=e,null!==e&&rK(i)}else{var u=V(l,o,s,e,i);t(u,i,!1,!1),i.stateNode=u,j(u,l,o,s,e)&&rK(i)}null!==i.ref&&(i.flags|=512,i.flags|=2097152)}return rQ(i),null;case 6:if(e&&null!=i.stateNode)a(e,i,e.memoizedProps,o);else{if("string"!=typeof o&&null===i.stateNode)throw Error(d(166));if(e=iW(iG.current),s=iW(ij.current),ik(i)){if(!J)throw Error(d(176));if(e=i.stateNode,o=i.memoizedProps,(s=e$(e,o,i,!iw))&&null!==(l=iS))switch(u=0!=(1&l.mode),l.tag){case 3:e0(l.stateNode.containerInfo,e,o,u);break;case 5:e1(l.type,l.memoizedProps,l.stateNode,e,o,u)}s&&rK(i)}else i.stateNode=W(o,e,s,i)}return rQ(i),null;case 13:if(e9(iX),o=i.memoizedState,iT&&null!==ix&&0!=(1&i.mode)&&0==(128&i.flags)){for(e=ix;e;)e=ez(e);return iD(),i.flags|=98560,i}if(null!==o&&null!==o.dehydrated){if(o=ik(i),null===e){if(!o)throw Error(d(318));if(!J)throw Error(d(344));if(!(e=null!==(e=i.memoizedState)?e.dehydrated:null))throw Error(d(317));eq(e,i)}else iD(),0==(128&i.flags)&&(i.memoizedState=null),i.flags|=4;return rQ(i),null}if(null!==iA&&(av(iA),iA=null),0!=(128&i.flags))return i.lanes=s,i;return o=null!==o,s=!1,null===e?ik(i):s=null!==e.memoizedState,o&&!s&&(i.child.flags|=8192,0!=(1&i.mode)&&(null===e||0!=(1&iX.current)?0===n0&&(n0=3):aw())),null!==i.updateQueue&&(i.flags|=4),rQ(i),null;case 4:return iq(),r(e,i),null===e&&ee(i.stateNode.containerInfo),rQ(i),null;case 10:return tX(i.type._context),rQ(i),null;case 19:if(e9(iX),null===(l=i.memoizedState))return rQ(i),null;if(o=0!=(128&i.flags),null===(u=l.rendering)){if(o)rJ(l,!1);else{if(0!==n0||null!==e&&0!=(128&e.flags))for(e=i.child;null!==e;){if(null!==(u=iZ(e))){for(i.flags|=128,rJ(l,!1),null!==(e=u.updateQueue)&&(i.updateQueue=e,i.flags|=4),i.subtreeFlags=0,e=s,o=i.child;null!==o;)s=o,l=e,s.flags&=14680066,null===(u=s.alternate)?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,l=u.dependencies,s.dependencies=null===l?null:{lanes:l.lanes,firstContext:l.firstContext}),o=o.sibling;return te(iX,1&iX.current|2),i.child}e=e.sibling}null!==l.tail&&tC()>n7&&(i.flags|=128,o=!0,rJ(l,!1),i.lanes=4194304)}}else{if(!o){if(null!==(e=iZ(u))){if(i.flags|=128,o=!0,null!==(e=e.updateQueue)&&(i.updateQueue=e,i.flags|=4),rJ(l,!0),null===l.tail&&"hidden"===l.tailMode&&!u.alternate&&!iT)return rQ(i),null}else 2*tC()-l.renderingStartTime>n7&&1073741824!==s&&(i.flags|=128,o=!0,rJ(l,!1),i.lanes=4194304)}l.isBackwards?(u.sibling=i.child,i.child=u):(null!==(e=l.last)?e.sibling=u:i.child=u,l.last=u)}if(null!==l.tail)return i=l.tail,l.rendering=i,l.tail=i.sibling,l.renderingStartTime=tC(),i.sibling=null,e=iX.current,te(iX,o?1&e|2:1&e),i;return rQ(i),null;case 22:case 23:return aE(),o=null!==i.memoizedState,null!==e&&null!==e.memoizedState!==o&&(i.flags|=8192),o&&0!=(1&i.mode)?0!=(1073741824&nJ)&&(rQ(i),X&&6&i.subtreeFlags&&(i.flags|=8192)):rQ(i),null;case 24:case 25:return null}throw Error(d(156,i.tag))}(s,i,nJ))){nX=s;return}}else{if(null!==(s=function(e,t){switch(iE(t),t.tag){case 1:return ts(t.type)&&to(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return iq(),e9(tr),e9(ti),iQ(),0!=(65536&(e=t.flags))&&0==(128&e)?(t.flags=-65537&e|128,t):null;case 5:return iK(t),null;case 13:if(e9(iX),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(d(340));iD()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return e9(iX),null;case 4:return iq(),null;case 10:return tX(t.type._context),null;case 22:case 23:return aE(),null;default:return null}}(s,i))){s.flags&=32767,nX=s;return}if(null!==e)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{n0=6,nX=null;return}}if(null!==(i=i.sibling)){nX=i;return}nX=i=e}while(null!==i);0===n0&&(n0=5)}function aC(e,t){var i=tx,r=nq.transition;try{nq.transition=null,tx=1,function(e,t,i){do aI();while(null!==an);if(0!=(6&nY))throw Error(d(327));var r=e.finishedWork,n=e.finishedLanes;if(null!==r){if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(d(177));e.callbackNode=null,e.callbackPriority=0;var a=r.lanes|r.childLanes;if(function(e,t){var i=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<i;){var n=31-th(i),a=1<<n;t[n]=0,r[n]=-1,e[n]=-1,i&=~a}}(e,a),e===nK&&(nX=nK=null,nZ=0),0==(2064&r.subtreeFlags)&&0==(2064&r.flags)||ar||(ar=!0,s=tk,o=function(){return aI(),null},tw(s,o)),a=0!=(15990&r.flags),0!=(15990&r.subtreeFlags)||a){a=nq.transition,nq.transition=null;var s,o,l,u,c=tx;tx=1;var h=nY;nY|=4,n$.current=null,function(e,t){for(F(e.containerInfo),nm=t;null!==nm;)if(t=(e=nm).child,0!=(1028&e.subtreeFlags)&&null!==t)t.return=e,nm=t;else for(;null!==nm;){e=nm;try{var i=e.alternate;if(0!=(1024&e.flags))switch(e.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==i){var r=i.memoizedProps,n=i.memoizedState,a=e.stateNode,s=a.getSnapshotBeforeUpdate(e.elementType===e.type?r:tH(e.type,r),n);a.__reactInternalSnapshotBeforeUpdate=s}break;case 3:X&&eM(e.stateNode.containerInfo);break;default:throw Error(d(163))}}catch(t){ak(e,e.return,t)}if(null!==(t=e.sibling)){t.return=e.return,nm=t;break}nm=e.return}i=ny,ny=!1}(e,r),function(e,t){for(nm=t;null!==nm;){var i=(t=nm).deletions;if(null!==i)for(var r=0;r<i.length;r++){var n=i[r];try{var a=e;X?nM(a,n,t):nx(a,n,t);var s=n.alternate;null!==s&&(s.return=null),n.return=null}catch(e){ak(n,t,e)}}if(i=t.child,0!=(12854&t.subtreeFlags)&&null!==i)i.return=t,nm=i;else for(;null!==nm;){t=nm;try{var o=t.flags;if(32&o&&X&&eS(t.stateNode),512&o){var l=t.alternate;if(null!==l){var u=l.ref;null!==u&&("function"==typeof u?u(null):u.current=null)}}if(8192&o)switch(t.tag){case 13:if(null!==t.memoizedState){var c=t.alternate;(null===c||null===c.memoizedState)&&(n8=tC())}break;case 22:var d=null!==t.memoizedState,h=t.alternate,f=null!==h&&null!==h.memoizedState;if(i=t,X){e:if(r=i,n=d,a=null,X)for(var p=r;;){if(5===p.tag){if(null===a){a=p;var m=p.stateNode;n?ex(m):ew(p.stateNode,p.memoizedProps)}}else if(6===p.tag){if(null===a){var g=p.stateNode;n?eT(g):eA(g,p.memoizedProps)}}else if((22!==p.tag&&23!==p.tag||null===p.memoizedState||p===r)&&null!==p.child){p.child.return=p,p=p.child;continue}if(p===r)break;for(;null===p.sibling;){if(null===p.return||p.return===r)break e;a===p&&(a=null),p=p.return}a===p&&(a=null),p.sibling.return=p.return,p=p.sibling}}if(d&&!f&&0!=(1&i.mode)){nm=i;for(var v=i.child;null!==v;){for(i=nm=v;null!==nm;){var y=(r=nm).child;switch(r.tag){case 0:case 11:case 14:case 15:nb(4,r,r.return);break;case 1:ng(r,r.return);var b=r.stateNode;if("function"==typeof b.componentWillUnmount){var _=r.return;try{b.props=r.memoizedProps,b.state=r.memoizedState,b.componentWillUnmount()}catch(e){ak(r,_,e)}}break;case 5:ng(r,r.return);break;case 22:if(null!==r.memoizedState){nL(i);continue}}null!==y?(y.return=r,nm=y):nL(i)}v=v.sibling}}}switch(4102&o){case 2:nA(t),t.flags&=-3;break;case 6:nA(t),t.flags&=-3,nR(t.alternate,t);break;case 4096:t.flags&=-4097;break;case 4100:t.flags&=-4097,nR(t.alternate,t);break;case 4:nR(t.alternate,t)}}catch(e){ak(t,t.return,e)}if(null!==(i=t.sibling)){i.return=t.return,nm=i;break}nm=t.return}}}(e,r,n),B(e.containerInfo),e.current=r,l=r,u=e,nm=l,function e(t,i,r){for(var n=0!=(1&t.mode);null!==nm;){var a=nm,s=a.child;if(22===a.tag&&n){var o=null!==a.memoizedState||nh;if(!o){var l=a.alternate,u=null!==l&&null!==l.memoizedState||nf;l=nh;var c=nf;if(nh=o,(nf=u)&&!c)for(nm=a;null!==nm;)u=(o=nm).child,22===o.tag&&null!==o.memoizedState?nk(a):null!==u?(u.return=o,nm=u):nk(a);for(;null!==s;)nm=s,e(s,i,r),s=s.sibling;nm=a,nh=l,nf=c}nI(t,i,r)}else 0!=(8772&a.subtreeFlags)&&null!==s?(s.return=a,nm=s):nI(t,i,r)}}(l,u,n),tR(),nY=h,tx=c,nq.transition=a}else e.current=r;if(ar&&(ar=!1,an=e,aa=n),0===(a=e.pendingLanes)&&(ai=null),function(e){if(tO&&"function"==typeof tO.onCommitFiberRoot)try{tO.onCommitFiberRoot(tP,e,void 0,128==(128&e.current.flags))}catch(e){}}(r.stateNode,i),ap(e,tC()),null!==t)for(i=e.onRecoverableError,r=0;r<t.length;r++)i(t[r]);if(ae)throw ae=!1,e=at,at=null,e;0!=(1&aa)&&0!==e.tag&&aI(),0!=(1&(a=e.pendingLanes))?e===ao?as++:(as=0,ao=e):as=0,tV()}}(e,t,i)}finally{nq.transition=r,tx=i}return null}function aI(){if(null!==an){var e=tT(aa),t=nq.transition,i=tx;try{if(nq.transition=null,tx=16>e?16:e,null===an)var r=!1;else{if(e=an,an=null,aa=0,0!=(6&nY))throw Error(d(331));var n=nY;for(nY|=4,nm=e.current;null!==nm;){var a=nm,s=a.child;if(0!=(16&nm.flags)){var o=a.deletions;if(null!==o){for(var l=0;l<o.length;l++){var u=o[l];for(nm=u;null!==nm;){var c=nm;switch(c.tag){case 0:case 11:case 15:nb(8,c,a)}var h=c.child;if(null!==h)h.return=c,nm=h;else for(;null!==nm;){var f=(c=nm).sibling,p=c.return;if(!function e(t){var i=t.alternate;null!==i&&(t.alternate=null,e(i)),t.child=null,t.deletions=null,t.sibling=null,5===t.tag&&null!==(i=t.stateNode)&&ei(i),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}(c),c===u){nm=null;break}if(null!==f){f.return=p,nm=f;break}nm=p}}}var m=a.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}nm=a}}if(0!=(2064&a.subtreeFlags)&&null!==s)s.return=a,nm=s;else for(;null!==nm;){if(a=nm,0!=(2048&a.flags))switch(a.tag){case 0:case 11:case 15:nb(9,a,a.return)}var y=a.sibling;if(null!==y){y.return=a.return,nm=y;break}nm=a.return}}var b=e.current;for(nm=b;null!==nm;){var _=(s=nm).child;if(0!=(2064&s.subtreeFlags)&&null!==_)_.return=s,nm=_;else for(s=b;null!==nm;){if(o=nm,0!=(2048&o.flags))try{switch(o.tag){case 0:case 11:case 15:n_(9,o)}}catch(e){ak(o,o.return,e)}if(o===s){nm=null;break}var E=o.sibling;if(null!==E){E.return=o.return,nm=E;break}nm=o.return}}if(nY=n,tV(),tO&&"function"==typeof tO.onPostCommitFiberRoot)try{tO.onPostCommitFiberRoot(tP,e)}catch(e){}r=!0}return r}finally{tx=i,nq.transition=t}}return!1}function aL(e,t,i){t=rz(i,t),t=rG(e,t,1),t4(e,t),t=ac(),null!==(e=af(e,1))&&(tE(e,1,t),ap(e,t))}function ak(e,t,i){if(3===e.tag)aL(e,e,i);else for(;null!==t;){if(3===t.tag){aL(t,e,i);break}if(1===t.tag){var r=t.stateNode;if("function"==typeof t.type.getDerivedStateFromError||"function"==typeof r.componentDidCatch&&(null===ai||!ai.has(r))){e=rz(i,e),e=rW(t,e,1),t4(t,e),e=ac(),null!==(t=af(t,1))&&(tE(t,1,e),ap(t,e));break}}t=t.return}}function aD(e,t,i){var r=e.pingCache;null!==r&&r.delete(t),t=ac(),e.pingedLanes|=e.suspendedLanes&i,nK===e&&(nZ&i)===i&&(4===n0||3===n0&&(130023424&nZ)===nZ&&500>tC()-n8?aS(e,0):n5|=i),ap(e,t)}function aP(e,t){0===t&&(0==(1&e.mode)?t=1:(t=tg,0==(130023424&(tg<<=1))&&(tg=4194304)));var i=ac();null!==(e=af(e,t))&&(tE(e,t,i),ap(e,i))}function aO(e){var t=e.memoizedState,i=0;null!==t&&(i=t.retryLane),aP(e,i)}function aN(e,t){var i=0;switch(e.tag){case 13:var r=e.stateNode,n=e.memoizedState;null!==n&&(i=n.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(d(314))}null!==r&&r.delete(t),aP(e,i)}function aU(e,t,i,r){this.tag=e,this.key=i,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function aF(e,t,i,r){return new aU(e,t,i,r)}function aB(e){return!(!(e=e.prototype)||!e.isReactComponent)}function aV(e,t){var i=e.alternate;return null===i?((i=aF(e.tag,t,e.key,e.mode)).elementType=e.elementType,i.type=e.type,i.stateNode=e.stateNode,i.alternate=e,e.alternate=i):(i.pendingProps=t,i.type=e.type,i.flags=0,i.subtreeFlags=0,i.deletions=null),i.flags=14680064&e.flags,i.childLanes=e.childLanes,i.lanes=e.lanes,i.child=e.child,i.memoizedProps=e.memoizedProps,i.memoizedState=e.memoizedState,i.updateQueue=e.updateQueue,t=e.dependencies,i.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},i.sibling=e.sibling,i.index=e.index,i.ref=e.ref,i}function az(e,t,i,r,n,a){var s=2;if(r=e,"function"==typeof e)aB(e)&&(s=1);else if("string"==typeof e)s=5;else e:switch(e){case m:return aj(i.children,n,a,t);case g:s=8,n|=8;break;case v:return(e=aF(12,i,t,2|n)).elementType=v,e.lanes=a,e;case E:return(e=aF(13,i,t,n)).elementType=E,e.lanes=a,e;case S:return(e=aF(19,i,t,n)).elementType=S,e.lanes=a,e;case w:return aH(i,n,a,t);default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case y:s=10;break e;case b:s=9;break e;case _:s=11;break e;case x:s=14;break e;case T:s=16,r=null;break e}throw Error(d(130,null==e?e:typeof e,""))}return(t=aF(s,i,t,n)).elementType=e,t.type=r,t.lanes=a,t}function aj(e,t,i,r){return(e=aF(7,e,r,t)).lanes=i,e}function aH(e,t,i,r){return(e=aF(22,e,r,t)).elementType=w,e.lanes=i,e.stateNode={},e}function aG(e,t,i){return(e=aF(6,e,null,t)).lanes=i,e}function aW(e,t,i){return(t=aF(4,null!==e.children?e.children:[],e.key,t)).lanes=i,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function a$(e,t,i,r,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Y,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=t_(0),this.expirationTimes=t_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=t_(0),this.identifierPrefix=r,this.onRecoverableError=n,J&&(this.mutableSourceEagerHydrationData=null)}function aq(e,t,i,r,n,a,s,o,l){return e=new a$(e,t,i,o,l),1===t?(t=1,!0===a&&(t|=8)):t=0,a=aF(3,null,null,t),e.current=a,a.stateNode=e,a.memoizedState={element:r,isDehydrated:i,cache:null,transitions:null},t2(a),e}function aY(e){if(!e)return tt;e=e._reactInternals;e:{if(C(e)!==e||1!==e.tag)throw Error(d(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(ts(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(d(171))}if(1===e.tag){var i=e.type;if(ts(i))return tu(e,i,t)}return t}function aK(e){var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(d(188));throw Error(d(268,e=Object.keys(e).join(",")))}return null===(e=k(t))?null:e.stateNode}function aX(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var i=e.retryLane;e.retryLane=0!==i&&i<t?i:t}}function aZ(e,t){aX(e,t),(e=e.alternate)&&aX(e,t)}function aJ(e){return null===(e=k(e))?null:e.stateNode}function aQ(){return null}return s=function(e,t,i){if(null!==e){if(e.memoizedProps!==t.pendingProps||tr.current)r1=!0;else{if(0==(e.lanes&i)&&0==(128&t.flags))return r1=!1,function(e,t,i){switch(t.tag){case 3:nt(t),iD();break;case 5:iY(t);break;case 1:ts(t.type)&&tc(t);break;case 4:i$(t,t.stateNode.containerInfo);break;case 10:tK(t,t.type._context,t.memoizedProps.value);break;case 13:var r=t.memoizedState;if(null!==r){if(null!==r.dehydrated)return te(iX,1&iX.current),t.flags|=128,null;if(0!=(i&t.child.childLanes))return na(e,t,i);return te(iX,1&iX.current),null!==(e=nd(e,t,i))?e.sibling:null}te(iX,1&iX.current);break;case 19:if(r=0!=(i&t.childLanes),0!=(128&e.flags)){if(r)return nc(e,t,i);t.flags|=128}var n=t.memoizedState;if(null!==n&&(n.rendering=null,n.tail=null,n.lastEffect=null),te(iX,iX.current),!r)return null;break;case 22:case 23:return t.lanes=0,r6(e,t,i)}return nd(e,t,i)}(e,t,i);r1=0!=(131072&e.flags)}}else r1=!1,iT&&0!=(1048576&t.flags)&&ib(t,id,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps;var n=ta(t,ti.current);tJ(t,i),n=ri(null,t,r,e,n,i);var a=rr();return t.flags|=1,"object"==typeof n&&null!==n&&"function"==typeof n.render&&void 0===n.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,ts(r)?(a=!0,tc(t)):a=!1,t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,t2(t),n.updater=ii,t.stateNode=n,n._reactInternals=t,io(t,r,e,i),t=ne(null,t,r,!0,a,i)):(t.tag=0,iT&&a&&i_(t),r2(null,t,n,i),t=t.child),t;case 16:r=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,r=(n=r._init)(r._payload),t.type=r,n=t.tag=function(e){if("function"==typeof e)return aB(e)?1:0;if(null!=e){if((e=e.$$typeof)===_)return 11;if(e===x)return 14}return 2}(r),e=tH(r,e),n){case 0:t=r7(null,t,r,e,i);break e;case 1:t=r9(null,t,r,e,i);break e;case 11:t=r3(null,t,r,e,i);break e;case 14:t=r5(null,t,r,tH(r.type,e),i);break e}throw Error(d(306,r,""))}return t;case 0:return r=t.type,n=t.pendingProps,n=t.elementType===r?n:tH(r,n),r7(e,t,r,n,i);case 1:return r=t.type,n=t.pendingProps,n=t.elementType===r?n:tH(r,n),r9(e,t,r,n,i);case 3:e:{if(nt(t),null===e)throw Error(d(387));r=t.pendingProps,n=(a=t.memoizedState).element,t3(e,t),t7(t,r,null,i);var s=t.memoizedState;if(r=s.element,J&&a.isDehydrated){if(a={element:r,isDehydrated:!1,cache:s.cache,transitions:s.transitions},t.updateQueue.baseState=a,t.memoizedState=a,256&t.flags){t=ni(e,t,r,i,n=Error(d(423)));break e}if(r!==n){t=ni(e,t,r,i,n=Error(d(424)));break e}for(J&&(ix=eH(t.stateNode.containerInfo),iS=t,iT=!0,iA=null,iw=!1),i=iV(t,null,r,i),t.child=i;i;)i.flags=-3&i.flags|4096,i=i.sibling}else{if(iD(),r===n){t=nd(e,t,i);break e}r2(e,t,r,i)}t=t.child}return t;case 5:return iY(t),null===e&&iI(t),r=t.type,n=t.pendingProps,a=null!==e?e.memoizedProps:null,s=n.children,G(r,n)?s=null:null!==a&&G(r,a)&&(t.flags|=32),r8(e,t),r2(e,t,s,i),t.child;case 6:return null===e&&iI(t),null;case 13:return na(e,t,i);case 4:return i$(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=iB(t,null,r,i):r2(e,t,r,i),t.child;case 11:return r=t.type,n=t.pendingProps,n=t.elementType===r?n:tH(r,n),r3(e,t,r,n,i);case 7:return r2(e,t,t.pendingProps,i),t.child;case 8:case 12:return r2(e,t,t.pendingProps.children,i),t.child;case 10:e:{if(r=t.type._context,n=t.pendingProps,a=t.memoizedProps,s=n.value,tK(t,r,s),null!==a){if(tN(a.value,s)){if(a.children===n.children&&!tr.current){t=nd(e,t,i);break e}}else for(null!==(a=t.child)&&(a.return=t);null!==a;){var o=a.dependencies;if(null!==o){s=a.child;for(var l=o.firstContext;null!==l;){if(l.context===r){if(1===a.tag){(l=t5(-1,i&-i)).tag=2;var u=a.updateQueue;if(null!==u){var c=(u=u.shared).pending;null===c?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}a.lanes|=i,null!==(l=a.alternate)&&(l.lanes|=i),tZ(a.return,i,t),o.lanes|=i;break}l=l.next}}else if(10===a.tag)s=a.type===t.type?null:a.child;else if(18===a.tag){if(null===(s=a.return))throw Error(d(341));s.lanes|=i,null!==(o=s.alternate)&&(o.lanes|=i),tZ(s,i,t),s=a.sibling}else s=a.child;if(null!==s)s.return=a;else for(s=a;null!==s;){if(s===t){s=null;break}if(null!==(a=s.sibling)){a.return=s.return,s=a;break}s=s.return}a=s}}r2(e,t,n.children,i),t=t.child}return t;case 9:return n=t.type,r=t.pendingProps.children,tJ(t,i),n=tQ(n),r=r(n),t.flags|=1,r2(e,t,r,i),t.child;case 14:return n=tH(r=t.type,t.pendingProps),n=tH(r.type,n),r5(e,t,r,n,i);case 15:return r4(e,t,t.type,t.pendingProps,i);case 17:return r=t.type,n=t.pendingProps,n=t.elementType===r?n:tH(r,n),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,ts(r)?(e=!0,tc(t)):e=!1,tJ(t,i),ia(t,r,n),io(t,r,n,i),ne(null,t,r,!0,e,i);case 19:return nc(e,t,i);case 22:return r6(e,t,i)}throw Error(d(156,t.tag))},o.attemptContinuousHydration=function(e){13===e.tag&&(ah(e,134217728,ac()),aZ(e,134217728))},o.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=ac(),i=ad(e);ah(e,i,t),aZ(e,i)}},o.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var i=tv(t.pendingLanes);0!==i&&(tS(t,1|i),ap(t,tC()),0==(6&nY)&&(n9(),tV()))}break;case 13:var r=ac();a_(function(){return ah(e,1,r)}),aZ(e,1)}},o.batchedUpdates=function(e,t){var i=nY;nY|=1;try{return e(t)}finally{0===(nY=i)&&(n9(),tF&&tV())}},o.createComponentSelector=function(e){return{$$typeof:nD,value:e}},o.createContainer=function(e,t,i,r,n,a,s){return aq(e,t,!1,null,i,r,n,a,s)},o.createHasPseudoClassSelector=function(e){return{$$typeof:nP,value:e}},o.createHydrationContainer=function(e,t,i,r,n,a,s,o,l){return(e=aq(i,r,!0,e,n,a,s,o,l)).context=aY(null),i=e.current,(a=t5(r=ac(),n=ad(i))).callback=null!=t?t:null,t4(i,a),e.current.lanes=n,tE(e,n,r),ap(e,r),e},o.createPortal=function(e,t,i){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:p,key:null==r?null:""+r,children:e,containerInfo:t,implementation:i}},o.createRoleSelector=function(e){return{$$typeof:nO,value:e}},o.createTestNameSelector=function(e){return{$$typeof:nN,value:e}},o.createTextSelector=function(e){return{$$typeof:nU,value:e}},o.deferredUpdates=function(e){var t=tx,i=nq.transition;try{return nq.transition=null,tx=16,e()}finally{tx=t,nq.transition=i}},o.discreteUpdates=function(e,t,i,r,n){var a=tx,s=nq.transition;try{return nq.transition=null,tx=1,e(t,i,r,n)}finally{tx=a,nq.transition=s,0===nY&&n9()}},o.findAllNodes=nH,o.findBoundingRects=function(e,t){if(!ea)throw Error(d(363));t=nH(e,t),e=[];for(var i=0;i<t.length;i++)e.push(eo(t[i]));for(t=e.length-1;0<t;t--){i=e[t];for(var r=i.x,n=r+i.width,a=i.y,s=a+i.height,o=t-1;0<=o;o--)if(t!==o){var l=e[o],u=l.x,c=u+l.width,h=l.y,f=h+l.height;if(r>=u&&a>=h&&n<=c&&s<=f){e.splice(t,1);break}if(r!==u||i.width!==l.width||f<a||h>s){if(!(a!==h||i.height!==l.height||c<r||u>n)){u>r&&(l.width+=u-r,l.x=r),c<n&&(l.width=n-u),e.splice(t,1);break}}else{h>a&&(l.height+=h-a,l.y=a),f<s&&(l.height=s-h),e.splice(t,1);break}}}return e},o.findHostInstance=aK,o.findHostInstanceWithNoPortals=function(e){return null===(e=null!==(e=L(e))?function e(t){if(5===t.tag||6===t.tag)return t;for(t=t.child;null!==t;){if(4!==t.tag){var i=e(t);if(null!==i)return i}t=t.sibling}return null}(e):null)?null:e.stateNode},o.findHostInstanceWithWarning=function(e){return aK(e)},o.flushControlled=function(e){var t=nY;nY|=1;var i=nq.transition,r=tx;try{nq.transition=null,tx=1,e()}finally{tx=r,nq.transition=i,0===(nY=t)&&(n9(),tV())}},o.flushPassiveEffects=aI,o.flushSync=a_,o.focusWithin=function(e,t){if(!ea)throw Error(d(363));for(t=Array.from(t=nj(e=nB(e),t)),e=0;e<t.length;){var i=t[e++];if(!eu(i)){if(5===i.tag&&ed(i.stateNode))return!0;for(i=i.child;null!==i;)t.push(i),i=i.sibling}}return!1},o.getCurrentUpdatePriority=function(){return tx},o.getFindAllNodesFailureDescription=function(e,t){if(!ea)throw Error(d(363));var i=0,r=[];e=[nB(e),0];for(var n=0;n<e.length;){var a=e[n++],s=e[n++],o=t[s];if((5!==a.tag||!eu(a))&&(nV(a,o)&&(r.push(nz(o)),++s>i&&(i=s)),s<t.length))for(a=a.child;null!==a;)e.push(a,s),a=a.sibling}if(i<t.length){for(e=[];i<t.length;i++)e.push(nz(t[i]));return"findAllNodes was able to match part of the selector:\n  "+r.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},o.getPublicRootInstance=function(e){return(e=e.current).child?5===e.child.tag?O(e.child.stateNode):e.child.stateNode:null},o.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:h.ReactCurrentDispatcher,findHostInstanceByFiber:aJ,findFiberByHostInstance:e.findFiberByHostInstance||aQ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"},"undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)e=!0;else{try{tP=t.inject(e),tO=t}catch(e){}e=!!t.checkDCE}}return e},o.isAlreadyRendering=function(){return!1},o.observeVisibleRects=function(e,t,i,r){if(!ea)throw Error(d(363));var n=eh(e=nH(e,t),i,r).disconnect;return{disconnect:function(){n()}}},o.registerMutableSourceForHydration=function(e,t){var i=t._getVersion;i=i(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i)},o.runWithPriority=function(e,t){var i=tx;try{return tx=e,t()}finally{tx=i}},o.shouldError=function(){return null},o.shouldSuspend=function(){return!1},o.updateContainer=function(e,t,i,r){var n=t.current,a=ac(),s=ad(n);return i=aY(i),null===t.context?t.context=i:t.pendingContext=i,(t=t5(a,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),t4(n,t),null!==(e=ah(n,s,a))&&t6(e,n,s),s},o}},85259:function(e,t,i){"use strict";e.exports=i(23406)},97427:function(e,t,i){"use strict";e.exports=i(45658)},70247:function(e,t){"use strict";/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function i(e,t){var i=e.length;for(e.push(t);0<i;){var r=i-1>>>1,n=e[r];if(0<a(n,t))e[r]=t,e[i]=n,i=r;else break}}function r(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],i=e.pop();if(i!==t){e[0]=i;for(var r=0,n=e.length,s=n>>>1;r<s;){var o=2*(r+1)-1,l=e[o],u=o+1,c=e[u];if(0>a(l,i))u<n&&0>a(c,l)?(e[r]=c,e[u]=i,r=u):(e[r]=l,e[o]=i,r=o);else if(u<n&&0>a(c,i))e[r]=c,e[u]=i,r=u;else break}}return t}function a(e,t){var i=e.sortIndex-t.sortIndex;return 0!==i?i:e.id-t.id}if("object"==typeof performance&&"function"==typeof performance.now){var s,o=performance;t.unstable_now=function(){return o.now()}}else{var l=Date,u=l.now();t.unstable_now=function(){return l.now()-u}}var c=[],d=[],h=1,f=null,p=3,m=!1,g=!1,v=!1,y="function"==typeof setTimeout?setTimeout:null,b="function"==typeof clearTimeout?clearTimeout:null,_="undefined"!=typeof setImmediate?setImmediate:null;function E(e){for(var t=r(d);null!==t;){if(null===t.callback)n(d);else if(t.startTime<=e)n(d),t.sortIndex=t.expirationTime,i(c,t);else break;t=r(d)}}function S(e){if(v=!1,E(e),!g){if(null!==r(c))g=!0,D(x);else{var t=r(d);null!==t&&P(S,t.startTime-e)}}}function x(e,i){g=!1,v&&(v=!1,b(A),A=-1),m=!0;var a=p;try{for(E(i),f=r(c);null!==f&&(!(f.expirationTime>i)||e&&!C());){var s=f.callback;if("function"==typeof s){f.callback=null,p=f.priorityLevel;var o=s(f.expirationTime<=i);i=t.unstable_now(),"function"==typeof o?f.callback=o:f===r(c)&&n(c),E(i)}else n(c);f=r(c)}if(null!==f)var l=!0;else{var u=r(d);null!==u&&P(S,u.startTime-i),l=!1}return l}finally{f=null,p=a,m=!1}}"undefined"!=typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var T=!1,w=null,A=-1,M=5,R=-1;function C(){return!(t.unstable_now()-R<M)}function I(){if(null!==w){var e=t.unstable_now();R=e;var i=!0;try{i=w(!0,e)}finally{i?s():(T=!1,w=null)}}else T=!1}if("function"==typeof _)s=function(){_(I)};else if("undefined"!=typeof MessageChannel){var L=new MessageChannel,k=L.port2;L.port1.onmessage=I,s=function(){k.postMessage(null)}}else s=function(){y(I,0)};function D(e){w=e,T||(T=!0,s())}function P(e,i){A=y(function(){e(t.unstable_now())},i)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,D(x))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return r(c)},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var i=p;p=t;try{return e()}finally{p=i}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var i=p;p=e;try{return t()}finally{p=i}},t.unstable_scheduleCallback=function(e,n,a){var s=t.unstable_now();switch(a="object"==typeof a&&null!==a&&"number"==typeof(a=a.delay)&&0<a?s+a:s,e){case 1:var o=-1;break;case 2:o=250;break;case 5:o=1073741823;break;case 4:o=1e4;break;default:o=5e3}return o=a+o,e={id:h++,callback:n,priorityLevel:e,startTime:a,expirationTime:o,sortIndex:-1},a>s?(e.sortIndex=a,i(d,e),null===r(c)&&e===r(d)&&(v?(b(A),A=-1):v=!0,P(S,a-s))):(e.sortIndex=o,i(c,e),g||m||(g=!0,D(x))),e},t.unstable_shouldYield=C,t.unstable_wrapCallback=function(e){var t=p;return function(){var i=p;p=t;try{return e.apply(this,arguments)}finally{p=i}}}},65297:function(e,t,i){"use strict";e.exports=i(70247)},78930:function(e,t,i){"use strict";/*!
 * set-value <https://github.com/jonschlinkert/set-value>
 *
 * Copyright (c) 2014-2015, 2017, Jon Schlinkert.
 * Released under the MIT License.
 */var r=i(69593),n=i(48396),a=i(76805),s=i(63566);function o(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e}e.exports=function(e,t,i){if(!s(e)||(Array.isArray(t)&&(t=[].concat.apply([],t).join(".")),"string"!=typeof t))return e;for(var l=r(t,{sep:".",brackets:!0}).filter(o),u=l.length,c=-1,d=e;++c<u;){var h=l[c];if(c!==u-1){s(d[h])||(d[h]={}),d=d[h];continue}a(d[h])&&a(i)?d[h]=n({},d[h],i):d[h]=i}return e}},34214:function(e){"use strict";e.exports=(e,t)=>{if(!("string"==typeof e&&"string"==typeof t))throw TypeError("Expected the arguments to be of type `string`");if(""===t)return[e];let i=e.indexOf(t);return -1===i?[e]:[e.slice(0,i),e.slice(i+t.length)]}},69593:function(e,t,i){"use strict";/*!
 * split-string <https://github.com/jonschlinkert/split-string>
 *
 * Copyright (c) 2015-2017, Jon Schlinkert.
 * Released under the MIT License.
 */var r=i(85582);function n(e,t,i,r){var a=e.indexOf(t,i);return"\\"===e.charAt(a-1)?n(e,t,a+1):a}e.exports=function(e,t,i){if("string"!=typeof e)throw TypeError("expected a string");"function"==typeof t&&(i=t,t=null),"string"==typeof t&&(t={sep:t});var a,s,o=r({sep:"."},t),l=o.quotes||['"',"'","`"];!0===o.brackets?a={"<":">","(":")","[":"]","{":"}"}:o.brackets&&(a=o.brackets);var u=[],c=[],d=[""],h=o.sep,f=e.length,p=-1;function m(){if(a&&c.length)return a[c[c.length-1]]}for(;++p<f;){var g,v,y=e[p],b=e[p+1],_={val:y,idx:p,arr:d,str:e};if(u.push(_),"\\"===y){_.val=!0===(g=p,"function"==typeof o.keepEscaping?o.keepEscaping(e,g):!0===o.keepEscaping||"\\"===e[g+1])?y+b:b,_.escaped=!0,"function"==typeof i&&i(_),d[d.length-1]+=_.val,p++;continue}if(a&&a[y]){c.push(y);var E=m(),S=p+1;if(-1!==e.indexOf(E,S+1))for(;c.length&&S<f;){var x=e[++S];if("\\"===x){x++;continue}if(-1!==l.indexOf(x)){S=n(e,x,S+1);continue}if(E=m(),c.length&&-1===e.indexOf(E,S+1))break;if(a[x]){c.push(x);continue}E===x&&c.pop()}if(-1===(s=S)){d[d.length-1]+=y;continue}y=e.slice(p,s+1),_.val=y,_.idx=p=s}if(-1!==l.indexOf(y)){if(-1===(s=n(e,y,p+1))){d[d.length-1]+=y;continue}y=!0===(v=y,!0===o.keepDoubleQuotes&&'"'===v||!0===o.keepSingleQuotes&&"'"===v||o.keepQuotes)?e.slice(p,s+1):e.slice(p+1,s),_.val=y,_.idx=p=s}if("function"==typeof i&&(i(_,u),y=_.val,p=_.idx),_.val===h&&!1!==_.split){d.push("");continue}d[d.length-1]+=_.val}return d}},45632:function(e){"use strict";e.exports=e=>encodeURIComponent(e).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`)},97367:function(e,t,i){"use strict";i.d(t,{MA:function(){return l},Rq:function(){return o},ZH:function(){return u}});let r=e=>"object"==typeof e&&"function"==typeof e.then,n=[];function a(e,t,i=(e,t)=>e===t){if(e===t)return!0;if(!e||!t)return!1;let r=e.length;if(t.length!==r)return!1;for(let n=0;n<r;n++)if(!i(e[n],t[n]))return!1;return!0}function s(e,t=null,i=!1,s={}){for(let r of(null===t&&(t=[e]),n))if(a(t,r.keys,r.equal)){if(i)return;if(Object.prototype.hasOwnProperty.call(r,"error"))throw r.error;if(Object.prototype.hasOwnProperty.call(r,"response"))return s.lifespan&&s.lifespan>0&&(r.timeout&&clearTimeout(r.timeout),r.timeout=setTimeout(r.remove,s.lifespan)),r.response;if(!i)throw r.promise}let o={keys:t,equal:s.equal,remove:()=>{let e=n.indexOf(o);-1!==e&&n.splice(e,1)},promise:(r(e)?e:e(...t)).then(e=>{o.response=e,s.lifespan&&s.lifespan>0&&(o.timeout=setTimeout(o.remove,s.lifespan))}).catch(e=>o.error=e)};if(n.push(o),!i)throw o.promise}let o=(e,t,i)=>s(e,t,!1,i),l=(e,t,i)=>void s(e,t,!0,i),u=e=>{if(void 0===e||0===e.length)n.splice(0,n.length);else{let t=n.find(t=>a(e,t.keys,t.equal));t&&t.remove()}}},12415:function(e,t,i){"use strict";/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=i(50959),n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},a=r.useState,s=r.useEffect,o=r.useLayoutEffect,l=r.useDebugValue;function u(e){var t=e.getSnapshot;e=e.value;try{var i=t();return!n(e,i)}catch(e){return!0}}var c="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var i=t(),r=a({inst:{value:i,getSnapshot:t}}),n=r[0].inst,c=r[1];return o(function(){n.value=i,n.getSnapshot=t,u(n)&&c({inst:n})},[e,i,t]),s(function(){return u(n)&&c({inst:n}),e(function(){u(n)&&c({inst:n})})},[e]),l(i),i};t.useSyncExternalStore=void 0!==r.useSyncExternalStore?r.useSyncExternalStore:c},2179:function(e,t,i){"use strict";/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var r=i(50959),n=i(4322),a="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},s=n.useSyncExternalStore,o=r.useRef,l=r.useEffect,u=r.useMemo,c=r.useDebugValue;t.useSyncExternalStoreWithSelector=function(e,t,i,r,n){var d=o(null);if(null===d.current){var h={hasValue:!1,value:null};d.current=h}else h=d.current;d=u(function(){function e(e){if(!l){if(l=!0,s=e,e=r(e),void 0!==n&&h.hasValue){var t=h.value;if(n(t,e))return o=t}return o=e}if(t=o,a(s,e))return t;var i=r(e);return void 0!==n&&n(t,i)?t:(s=e,o=i)}var s,o,l=!1,u=void 0===i?null:i;return[function(){return e(t())},null===u?void 0:function(){return e(u())}]},[t,i,r,n]);var f=s(e,d[0],d[1]);return l(function(){h.hasValue=!0,h.value=f},[f]),c(f),f}},4322:function(e,t,i){"use strict";e.exports=i(12415)},7231:function(e,t,i){"use strict";e.exports=i(2179)},81093:function(e){let t=new Proxy({},{get:function(e,t){return e.hasOwnProperty(t)||(e[t]=n(t)),e[t]}});class i extends Array{constructor(e,t){if(!(t=function e(t){return t instanceof Array&&1===t.length&&t[0]instanceof Array?e(t[0]):t}(t)).every(e=>"Number"===u(e)))throw TypeError("All arguments must be numbers.");if(t.length>1&&t.length!==e)throw Error("Argument list must be empty, have a single number, or have a length equal to the dimension.");0===t.length&&(t=[0]),1===t.length&&"Number"===u(t[0])&&(t=Array(e).fill(t[0])),e>1?super(...t):(super(1),this[0]=t[0]),Reflect.defineProperty(this,"pop",{value:void 0,enumerable:!1}),Reflect.defineProperty(this,"push",{value:void 0,enumerable:!1}),Reflect.defineProperty(this,"shift",{value:void 0,enumerable:!1}),Reflect.defineProperty(this,"unshift",{value:void 0,enumerable:!1})}get magnitude(){return this.pnorm(2)}div(e){o(e,this.dim,!0),"Number"===u(e)&&(e=Array(this.dim).fill(e));let i=[];for(let t=0;t<this.length;++t)i[t]=this[t]/e[t];return t[this.dim](i)}minus(e){o(e,this.dim,!0),"Number"===u(e)&&(e=Array(this.dim).fill(e));let i=[];for(let t=0;t<this.dim;++t)i[t]=this[t]-e[t];return t[this.dim](i)}neg(){return t[this.dim](this.times(-1))}plus(e){o(e,this.dim,!0),"Number"===u(e)&&(e=Array(this.dim).fill(e));let i=[];for(let t=0;t<this.dim;++t)i[t]=this[t]+e[t];return t[this.dim](i)}pow(e){let i=[];for(let t=0;t<this.dim;++t)i[t]=Math.pow(this[t],e);return t[this.dim](i)}times(e){o(e,this.dim,!0),"Number"===u(e)&&(e=Array(this.dim).fill(e));let i=[];for(let t=0;t<this.dim;++t)i[t]=this[t]*e[t];return t[this.dim](i)}dot(e){o(e,this.dim);let t=0;for(let i=0;i<this.dim;++i)t+=this[i]*e[i];return t}normalize(){return this.div(this.magnitude)}pnorm(e){let t=0;for(let i=0;i<this.dim;++i)t+=Math.pow(Math.abs(this[i]),e);return Math.pow(t,1/e)}reflect(e){let t=e.normalize();return this.minus(t.times(2*this.dot(t)))}argmax(){let e=this.max();return this.reduce((t,i,r)=>i===e?t.concat([r]):t,[])}argmin(){let e=this.min();return this.reduce((t,i,r)=>i===e?t.concat([r]):t,[])}choose(e){if(!Array.isArray(e))throw TypeError("Argument must be a list of indices.");if(!e.every(e=>e<this.dim&&l(e.toString())))throw RangeError("All elements of argument must be valid indices.");let i=[];return e.forEach(e=>i.push(this[e])),t[i.length](i)}copy(){return t[this.dim](this)}equals(e){return e.length===this.dim&&e.every((e,t)=>this[t]===e)}approximatelyEquals(e,t=1e-8){return e.length===this.dim&&e.every((e,i)=>Math.abs(this[i]-e)<t)}max(){return Math.max(...this)}min(){return Math.min(...this)}sum(){return this.reduce((e,t)=>e+t,0)}toArray(){return Array.from(this)}concat(...e){let i=super.concat.apply(this.toArray(),e);return t[i.length](i)}filter(...e){let i=super.filter.apply(this.toArray(),e);return i.length>0?t[i.length](i):i}map(...e){let t=super.map(...e);return t.every(e=>"Number"===u(e))?t:t.toArray()}slice(...e){let i=super.slice.apply(this.toArray(),e);return i.length>0?t[i.length](i):i}splice(...e){let t=this.toArray();if(t.splice(...e),t.length!==this.dim)throw Error("All removed elements must be replaced.");if(!t.every(e=>"Number"===u(e)))throw TypeError("All elements must be numbers.");t.forEach((e,t)=>{this[t]=e})}toString(){return this.reduce((e,t,i)=>e+t+(i===this.dim-1?" ":", "),"[ ")+"]"}}let r={set:function(e,t,i){if("length"===t)return!1;if(l(t)){if(Number(t)>=e.dim)throw RangeError("Vector may not have more elements than dimension.");if("Number"===u(i))return e[t]=i,!0;throw TypeError("Vectors may only contain numbers.")}let r=s(t.toString());return e.dim<=4&&!!r&&(function(e,t,i,r){if(1===t.length){if("Number"!==u(r))throw TypeError("Must set to a number");e[i[t]]=r;return}if(!Array.isArray(r))throw TypeError("Right-hand side must be an array.");if(t.length!==r.length)throw TypeError("Right-hand side must have matching length.");if(!r.every(e=>"Number"===u(e)))throw TypeError("All new values must be numbers.");if(t.split("").some(t=>i[t]>=e.dim))return;let n=!0;for(let e=0,i={};e<t.length;++e){if(i.hasOwnProperty(t[e])){n=!1;break}i[t[e]]=!0}if(!n)throw SyntaxError("Swizzle assignment does not allow symbols to be repeated.");t.split("").map(e=>i[e]).forEach((t,i)=>{e[t]=r[i]})}(e,t.toString(),r,i),!0)},get:function(e,i){let r=s(i.toString());return e.dim<=4&&r?function(e,i,r){let n=i.length;if(1===n)return e[r[i]];let a=i.split("").reduce((t,i)=>{let n=r[i];return t&&n<e.dim?t.concat([e[n]]):void 0},[]);return a?new t[n](...a):void 0}(e,i,r):e[i]}};function n(e){if(!((e=Number(e))in t)){if(isNaN(e))throw TypeError("Dimension must be coercible to a number.");if(e<=0||!Number.isInteger(e))throw RangeError("Dimension must be positive.");let n="vec"+e,a={[n]:class extends i{constructor(...t){if(1===t.length&&t[0]instanceof i){var r;if(t[0].dim>e)throw TypeError("Cannot demote vectors.");r=t[0].toArray(),t=[...Array(e)].map((e,t)=>t<r.length?r[t]:0)}super(e,t),Reflect.defineProperty(this,"dim",{value:e,writable:!1,enumerable:!1})}}}[n];t[e]=function(...e){let t=new a(...e);return Object.preventExtensions(t),new Proxy(t,r)}}return t[e]}let a=[{x:0,y:1,z:2,w:3},{r:0,g:1,b:2,a:3},{s:0,t:1,p:2,q:3}];function s(e){return a.find(t=>e.split("").every(e=>e in t))}function o(e,t,i=!1){if((!i||"Number"!==u(e))&&(!e.length||e.length!==t))throw TypeError(`Invalid argument. Input must have matching dimension${i?"or be a scalar":""}.`)}function l(e){return!isNaN(e)&&Number(e).toString()===e&&Number.isInteger(Number(e))&&Number(e)>=0}function u(e){return Object.prototype.toString.call(e).slice(8,-1)}e.exports={getVecType:n,isVec:function(e){return e instanceof i},vec2:t[2],vec3:t[3],vec4:t[4],add:function(...e){let i=e[0].dim;if(!e.every(e=>e.dim===i))throw TypeError("All vectors must have the same dimension.");return e.reduce((e,t)=>e.plus(t),t[i]())},multiply:function(...e){let i=e[0].dim;if(!e.every(e=>e.dim===i))throw TypeError("All vectors must have the same dimension.");return e.reduce((e,t)=>e.times(t),t[i](1))},lerp:function(e,t,i){if(e.dim!==t.dim)throw TypeError("Vectors must have the same dimension.");return i=i<0?0:i>1?1:i,e.plus(t.minus(e).times(i))},slerp:function(e,t,i){if(e.dim!==t.dim)throw TypeError("Vectors must have the same dimension.");i=i<0?0:i>1?1:i;let r=e.normalize().dot(t.normalize());r=r<-1?-1:r>1?1:r;let n=Math.acos(r)*i,a=t.minus(e.times(r)).normalize(),s=e.magnitude+(t.magnitude-e.magnitude)*i;return e.times(Math.cos(n)).plus(a.times(Math.sin(n))).normalize().times(s)}}},31171:function(e,t,i){"use strict";i.d(t,{Z:function(){return s}});var r=i(50959);let n="undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),a=n?r.useEffect:r.useLayoutEffect;function s(e){let t="function"==typeof e?function(e){let t;let i=new Set,r=(e,r)=>{let n="function"==typeof e?e(t):e;if(n!==t){let e=t;t=r?n:Object.assign({},t,n),i.forEach(i=>i(t,e))}},n=()=>t,a=(e,r=n,a=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let s=r(t);function o(){let i=r(t);if(!a(s,i)){let t=s;e(s=i,t)}}return i.add(o),()=>i.delete(o)},s={setState:r,getState:n,subscribe:(e,t,r)=>t||r?a(e,t,r):(i.add(e),()=>i.delete(e)),destroy:()=>i.clear()};return t=e(r,n,s),s}(e):e,i=(e=t.getState,i=Object.is)=>{let n;let[,s]=(0,r.useReducer)(e=>e+1,0),o=t.getState(),l=(0,r.useRef)(o),u=(0,r.useRef)(e),c=(0,r.useRef)(i),d=(0,r.useRef)(!1),h=(0,r.useRef)();void 0===h.current&&(h.current=e(o));let f=!1;(l.current!==o||u.current!==e||c.current!==i||d.current)&&(n=e(o),f=!i(h.current,n)),a(()=>{f&&(h.current=n),l.current=o,u.current=e,c.current=i,d.current=!1});let p=(0,r.useRef)(o);a(()=>{let e=()=>{try{let e=t.getState(),i=u.current(e);c.current(h.current,i)||(l.current=e,h.current=i,s())}catch(e){d.current=!0,s()}},i=t.subscribe(e);return t.getState()!==p.current&&e(),i},[]);let m=f?n:h.current;return(0,r.useDebugValue)(m),m};return Object.assign(i,t),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");let e=[i,t];return{next(){let t=e.length<=0;return{value:e.shift(),done:t}}}},i}},20762:function(e,t,i){"use strict";let r;i.d(t,{sc:function(){return ee},e:function(){return es},i6:function(){return eh},bA:function(){return el},W2:function(){return ef},gt:function(){return P},D:function(){return ec},hP:function(){return $},uW:function(){return en}});var n=i(50959),a=i(13214),s=i(50796),o=i(2843),l=i(80418),u=i(31171),c=i(19095),d=Object.defineProperty,h=new Map,f=new WeakMap,p=0,m=void 0;n.Component;var g=i(31110),v=i(81093);let y=[],b=(e,t,i)=>(function(e,t,i=!1,r={}){for(let e of y)if(function(e,t,i=(e,t)=>e===t){if(e===t)return!0;if(!e||!t)return!1;let r=e.length;if(t.length!==r)return!1;for(let n=0;n<r;n++)if(!i(e[n],t[n]))return!1;return!0}(t,e.keys,e.equal)){if(i)return;if(Object.prototype.hasOwnProperty.call(e,"error"))throw e.error;if(Object.prototype.hasOwnProperty.call(e,"response"))return e.response;if(!i)throw e.promise}let n={keys:t,equal:r.equal,promise:e(...t).then(e=>n.response=e).then(()=>{r.lifespan&&r.lifespan>0&&setTimeout(()=>{let e=y.indexOf(n);-1!==e&&y.splice(e,1)},r.lifespan)}).catch(e=>n.error=e)};if(y.push(n),!i)throw n.promise})(e,t,!1,i);var _=new Promise(e=>{let t=new Image;t.addEventListener("error",()=>e(!1)),t.addEventListener("load",()=>e(1===t.width)),t.src="data:image/webp;base64,UklGRiQAAABXRUJQVlA4IBgAAAAwAQCdASoBAAEAAwA0JaQAA3AA/vuUAAA="}).catch(()=>!1),E=i(3341);function S(){return(S=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function x(e,t,i){return Math.max(e,Math.min(t,i))}class T{advance(e){var t,i,r,n;if(!this.isRunning)return;let a=!1;if(this.lerp)this.value=(i=this.value,r=this.to,(1-(n=1-Math.exp(-60*this.lerp*e)))*i+n*r),Math.round(this.value)===this.to&&(this.value=this.to,a=!0);else{this.currentTime+=e;let t=x(0,this.currentTime/this.duration,1);a=t>=1;let i=a?1:this.easing(t);this.value=this.from+(this.to-this.from)*i}null==(t=this.onUpdate)||t.call(this,this.value,{completed:a}),a&&this.stop()}stop(){this.isRunning=!1}fromTo(e,t,{lerp:i=.1,duration:r=1,easing:n=e=>e,onUpdate:a}){this.from=this.value=e,this.to=t,this.lerp=i,this.duration=r,this.easing=n,this.currentTime=0,this.isRunning=!0,this.onUpdate=a}}class w{constructor({wrapper:e,content:t,autoResize:i=!0}={}){if(this.resize=()=>{this.onWrapperResize(),this.onContentResize()},this.onWrapperResize=()=>{this.wrapper===window?(this.width=window.innerWidth,this.height=window.innerHeight):(this.width=this.wrapper.clientWidth,this.height=this.wrapper.clientHeight)},this.onContentResize=()=>{this.scrollHeight=this.content.scrollHeight,this.scrollWidth=this.content.scrollWidth},this.wrapper=e,this.content=t,i){var r;let e;let t=(r=this.resize,function(){let t=arguments,i=this;clearTimeout(e),e=setTimeout(function(){r.apply(i,t)},250)});this.wrapper!==window&&(this.wrapperResizeObserver=new ResizeObserver(t),this.wrapperResizeObserver.observe(this.wrapper)),this.contentResizeObserver=new ResizeObserver(t),this.contentResizeObserver.observe(this.content)}this.resize()}destroy(){var e,t;null==(e=this.wrapperResizeObserver)||e.disconnect(),null==(t=this.contentResizeObserver)||t.disconnect()}get limit(){return{x:this.scrollWidth-this.width,y:this.scrollHeight-this.height}}}class A{constructor(){this.events={}}emit(e,...t){let i=this.events[e]||[];for(let e=0,r=i.length;e<r;e++)i[e](...t)}on(e,t){var i;return(null==(i=this.events[e])?void 0:i.push(t))||(this.events[e]=[t]),()=>{var i;this.events[e]=null==(i=this.events[e])?void 0:i.filter(e=>t!==e)}}off(e,t){var i;this.events[e]=null==(i=this.events[e])?void 0:i.filter(e=>t!==e)}destroy(){this.events={}}}class M{constructor(e,{wheelMultiplier:t=1,touchMultiplier:i=2,normalizeWheel:r=!1}){this.onTouchStart=e=>{let{clientX:t,clientY:i}=e.targetTouches?e.targetTouches[0]:e;this.touchStart.x=t,this.touchStart.y=i,this.lastDelta={x:0,y:0}},this.onTouchMove=e=>{let{clientX:t,clientY:i}=e.targetTouches?e.targetTouches[0]:e,r=-(t-this.touchStart.x)*this.touchMultiplier,n=-(i-this.touchStart.y)*this.touchMultiplier;this.touchStart.x=t,this.touchStart.y=i,this.lastDelta={x:r,y:n},this.emitter.emit("scroll",{deltaX:r,deltaY:n,event:e})},this.onTouchEnd=e=>{this.emitter.emit("scroll",{deltaX:this.lastDelta.x,deltaY:this.lastDelta.y,event:e})},this.onWheel=e=>{let{deltaX:t,deltaY:i}=e;this.normalizeWheel&&(t=x(-100,t,100),i=x(-100,i,100)),t*=this.wheelMultiplier,i*=this.wheelMultiplier,this.emitter.emit("scroll",{deltaX:t,deltaY:i,event:e})},this.element=e,this.wheelMultiplier=t,this.touchMultiplier=i,this.normalizeWheel=r,this.touchStart={x:null,y:null},this.emitter=new A,this.element.addEventListener("wheel",this.onWheel,{passive:!1}),this.element.addEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.addEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.addEventListener("touchend",this.onTouchEnd,{passive:!1})}on(e,t){return this.emitter.on(e,t)}destroy(){this.emitter.destroy(),this.element.removeEventListener("wheel",this.onWheel,{passive:!1}),this.element.removeEventListener("touchstart",this.onTouchStart,{passive:!1}),this.element.removeEventListener("touchmove",this.onTouchMove,{passive:!1}),this.element.removeEventListener("touchend",this.onTouchEnd,{passive:!1})}}class R{constructor({wrapper:e=window,content:t=document.documentElement,wheelEventsTarget:i=e,smoothWheel:r=!0,smoothTouch:n=!1,syncTouch:a=!1,syncTouchLerp:s=.1,__iosNoInertiaSyncTouchLerp:o=.4,touchInertiaMultiplier:l=35,duration:u,easing:c=e=>Math.min(1,1.001-Math.pow(2,-10*e)),lerp:d=u&&.1,infinite:h=!1,orientation:f="vertical",gestureOrientation:p="vertical",touchMultiplier:m=1,wheelMultiplier:g=1,normalizeWheel:v=!1,autoResize:y=!0}={}){this.onVirtualScroll=({deltaX:e,deltaY:t,event:i})=>{if(i.ctrlKey)return;let r=i.type.includes("touch"),n=i.type.includes("wheel");if("vertical"===this.options.gestureOrientation&&0===t||"horizontal"===this.options.gestureOrientation&&0===e||r&&"vertical"===this.options.gestureOrientation&&0===this.scroll&&!this.options.infinite&&t<=0)return;let a=i.composedPath();if((a=a.slice(0,a.indexOf(this.rootElement))).find(e=>{var t;return(null==e.hasAttribute?void 0:e.hasAttribute("data-lenis-prevent"))||r&&(null==e.hasAttribute?void 0:e.hasAttribute("data-lenis-prevent-touch"))||n&&(null==e.hasAttribute?void 0:e.hasAttribute("data-lenis-prevent-wheel"))||(null==(t=e.classList)?void 0:t.contains("lenis"))}))return;if(this.isStopped||this.isLocked)return void i.preventDefault();if(this.isSmooth=(this.options.smoothTouch||this.options.syncTouch)&&r||this.options.smoothWheel&&n,!this.isSmooth)return this.isScrolling=!1,void this.animate.stop();i.preventDefault();let s=t;"both"===this.options.gestureOrientation?s=Math.abs(t)>Math.abs(e)?t:e:"horizontal"===this.options.gestureOrientation&&(s=e);let o=r&&this.options.syncTouch,l=r&&"touchend"===i.type&&Math.abs(s)>1;l&&(s=this.velocity*this.options.touchInertiaMultiplier),this.scrollTo(this.targetScroll+s,S({programmatic:!1},o&&{lerp:l?this.syncTouchLerp:this.options.__iosNoInertiaSyncTouchLerp}))},this.onScroll=()=>{if(!this.isScrolling){let e=this.animatedScroll;this.animatedScroll=this.targetScroll=this.actualScroll,this.velocity=0,this.direction=Math.sign(this.animatedScroll-e),this.emit()}},window.lenisVersion="1.0.23",e!==document.documentElement&&e!==document.body||(e=window),this.options={wrapper:e,content:t,wheelEventsTarget:i,smoothWheel:r,smoothTouch:n,syncTouch:a,syncTouchLerp:s,__iosNoInertiaSyncTouchLerp:o,touchInertiaMultiplier:l,duration:u,easing:c,lerp:d,infinite:h,gestureOrientation:p,orientation:f,touchMultiplier:m,wheelMultiplier:g,normalizeWheel:v,autoResize:y},this.dimensions=new w({wrapper:e,content:t,autoResize:y}),this.rootElement.classList.add("lenis"),this.velocity=0,this.isStopped=!1,this.isSmooth=r||n,this.isScrolling=!1,this.targetScroll=this.animatedScroll=this.actualScroll,this.animate=new T,this.emitter=new A,this.options.wrapper.addEventListener("scroll",this.onScroll,{passive:!1}),this.virtualScroll=new M(i,{touchMultiplier:m,wheelMultiplier:g,normalizeWheel:v}),this.virtualScroll.on("scroll",this.onVirtualScroll)}destroy(){this.emitter.destroy(),this.options.wrapper.removeEventListener("scroll",this.onScroll,{passive:!1}),this.virtualScroll.destroy(),this.dimensions.destroy(),this.rootElement.classList.remove("lenis"),this.rootElement.classList.remove("lenis-smooth"),this.rootElement.classList.remove("lenis-scrolling"),this.rootElement.classList.remove("lenis-stopped")}on(e,t){return this.emitter.on(e,t)}off(e,t){return this.emitter.off(e,t)}setScroll(e){this.isHorizontal?this.rootElement.scrollLeft=e:this.rootElement.scrollTop=e}resize(){this.dimensions.resize()}emit(){this.emitter.emit("scroll",this)}reset(){this.isLocked=!1,this.isScrolling=!1,this.velocity=0,this.animate.stop()}start(){this.isStopped=!1,this.reset()}stop(){this.isStopped=!0,this.animate.stop(),this.reset()}raf(e){let t=e-(this.time||e);this.time=e,this.animate.advance(.001*t)}scrollTo(e,{offset:t=0,immediate:i=!1,lock:r=!1,duration:n=this.options.duration,easing:a=this.options.easing,lerp:s=!n&&this.options.lerp,onComplete:o=null,force:l=!1,programmatic:u=!0}={}){if(!this.isStopped||l){if(["top","left","start"].includes(e))e=0;else if(["bottom","right","end"].includes(e))e=this.limit;else{var c;let i;if("string"==typeof e?i=document.querySelector(e):null!=(c=e)&&c.nodeType&&(i=e),i){if(this.options.wrapper!==window){let e=this.options.wrapper.getBoundingClientRect();t-=this.isHorizontal?e.left:e.top}let r=i.getBoundingClientRect();e=(this.isHorizontal?r.left:r.top)+this.animatedScroll}}if("number"==typeof e){if(e+=t,e=Math.round(e),this.options.infinite?u&&(this.targetScroll=this.animatedScroll=this.scroll):e=x(0,e,this.limit),i)return this.animatedScroll=this.targetScroll=e,this.setScroll(this.scroll),this.reset(),this.emit(),void(null==o||o());if(!u){if(e===this.targetScroll)return;this.targetScroll=e}this.animate.fromTo(this.animatedScroll,e,{duration:n,easing:a,lerp:s,onUpdate:(e,{completed:t})=>{r&&(this.isLocked=!0),this.isScrolling=!0,this.velocity=e-this.animatedScroll,this.direction=Math.sign(this.velocity),this.animatedScroll=e,this.setScroll(this.scroll),u&&(this.targetScroll=e),t&&(r&&(this.isLocked=!1),requestAnimationFrame(()=>{this.isScrolling=!1}),this.velocity=0,null==o||o()),this.emit()}})}}}get rootElement(){return this.options.wrapper===window?this.options.content:this.options.wrapper}get limit(){return this.dimensions.limit[this.isHorizontal?"x":"y"]}get isHorizontal(){return"horizontal"===this.options.orientation}get actualScroll(){return this.isHorizontal?this.rootElement.scrollLeft:this.rootElement.scrollTop}get scroll(){var e;return this.options.infinite?(this.animatedScroll%(e=this.limit)+e)%e:this.animatedScroll}get progress(){return 0===this.limit?1:this.scroll/this.limit}get isSmooth(){return this.__isSmooth}set isSmooth(e){this.__isSmooth!==e&&(this.rootElement.classList.toggle("lenis-smooth",e),this.__isSmooth=e)}get isScrolling(){return this.__isScrolling}set isScrolling(e){this.__isScrolling!==e&&(this.rootElement.classList.toggle("lenis-scrolling",e),this.__isScrolling=e)}get isStopped(){return this.__isStopped}set isStopped(e){this.__isStopped!==e&&(this.rootElement.classList.toggle("lenis-stopped",e),this.__isStopped=e)}get className(){let e="lenis";return this.isStopped&&(e+=" lenis-stopped"),this.isScrolling&&(e+=" lenis-scrolling"),this.isSmooth&&(e+=" lenis-smooth"),e}}function C(){return(C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function I(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(i=a[r])>=0||(n[i]=e[i]);return n}function L(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,"string");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:String(t)}let k="undefined"!=typeof window?n.useLayoutEffect:n.useEffect,D={PRIORITY_PRELOAD:0,PRIORITY_SCISSORS:1,PRIORITY_GLOBAL:1e3,DEFAULT_SCALE_MULTIPLIER:1,preloadQueue:[]},P=(0,u.Z)(e=>({debug:!1,scaleMultiplier:D.DEFAULT_SCALE_MULTIPLIER,globalRender:!0,globalPriority:D.PRIORITY_GLOBAL,globalClearDepth:!1,globalRenderQueue:!1,clearGlobalRenderQueue:()=>e(()=>({globalRenderQueue:!1})),isCanvasAvailable:!0,hasSmoothScrollbar:!1,canvasChildren:{},renderToCanvas:(t,i,r={})=>e(({canvasChildren:e})=>Object.getOwnPropertyDescriptor(e,t)?(e[t].instances+=1,e[t].props.inactive=!1,{canvasChildren:e}):{canvasChildren:C({},e,{[t]:{mesh:i,props:r,instances:1}})}),updateCanvas:(t,i)=>e(({canvasChildren:e})=>{if(!e[t])return;let{[t]:{mesh:r,props:n,instances:a}}=e;return{canvasChildren:C({},e,{[t]:{mesh:r,props:C({},n,i),instances:a}})}}),removeFromCanvas:(t,i=!0)=>e(({canvasChildren:e})=>{var r;return(null==(r=e[t])?void 0:r.instances)>1?(e[t].instances-=1,{canvasChildren:e}):i?{canvasChildren:I(e,[t].map(L))}:(e[t].instances=0,e[t].props.inactive=!0,{canvasChildren:C({},e)})}),pageReflow:0,requestReflow:()=>{e(e=>({pageReflow:e.pageReflow+1}))},scroll:{y:0,x:0,limit:0,velocity:0,progress:0,direction:0,scrollDirection:void 0},__lenis:void 0,scrollTo:()=>{},onScroll:()=>()=>{}})),O=()=>{let e=P(e=>e.requestReflow),t=P(e=>e.debug);return(0,n.useEffect)(()=>{let i=new(window.ResizeObserver||o.do)(()=>{e(),t&&console.log("ResizeManager","document.body height changed")});return i.observe(document.body),()=>{null==i||i.disconnect()}},[]),null},N=["makeDefault","margin"],U=(0,n.forwardRef)((e,t)=>{let{makeDefault:i=!1,margin:r=0}=e,s=I(e,N),o=(0,a.z)(e=>e.set),l=(0,a.z)(e=>e.camera),u=(0,a.z)(e=>e.size),c=(0,a.z)(e=>e.viewport),d=(0,n.useRef)(null);(0,n.useImperativeHandle)(t,()=>d.current);let h=P(e=>e.pageReflow),f=P(e=>e.scaleMultiplier),{fov:p,distance:m,aspect:g}=(0,n.useMemo)(()=>{var e;let t=(u.height+2*r)*f,i=(u.width+2*r)*f/t,n=s.fov||50,a=null==s||null==(e=s.position)?void 0:e[2];return a?n=180/Math.PI*2*Math.atan(t/(2*a)):a=t/(2*Math.tan(n/2*Math.PI/180)),{fov:n,distance:a,aspect:i}},[u,f,h]);return k(()=>{d.current.lookAt(0,0,0),d.current.updateProjectionMatrix(),d.current.updateMatrixWorld(),o(e=>({viewport:C({},e.viewport,c.getCurrentViewport(l))}))},[u,f,h]),k(()=>{if(i)return o(()=>({camera:d.current})),()=>o(()=>({camera:l}))},[d,i,o]),n.createElement("perspectiveCamera",C({ref:d,position:[0,0,m],onUpdate:e=>e.updateProjectionMatrix(),near:.1,aspect:g,fov:p,far:2*m},s))}),F=["makeDefault","margin"],B=(0,n.forwardRef)((e,t)=>{let{makeDefault:i=!1,margin:r=0}=e,s=I(e,F),o=(0,a.z)(e=>e.set),l=(0,a.z)(e=>e.camera),u=(0,a.z)(e=>e.size),c=P(e=>e.pageReflow),d=P(e=>e.scaleMultiplier),h=(0,n.useMemo)(()=>Math.max(u.width*d,u.height*d),[u,c,d]),f=(0,n.useRef)(null);return(0,n.useImperativeHandle)(t,()=>f.current),k(()=>{f.current.lookAt(0,0,0),f.current.updateProjectionMatrix(),f.current.updateMatrixWorld()},[h,u]),k(()=>{if(i)return o(()=>({camera:f.current})),()=>o(()=>({camera:l}))},[f,i,o]),n.createElement("orthographicCamera",C({left:-(u.width*d/2)-r*d,right:u.width*d/2+r*d,top:u.height*d/2+r*d,bottom:-(u.height*d/2)-r*d,far:2*h,position:[0,0,h],near:.001,ref:f,onUpdate:e=>e.updateProjectionMatrix()},s))});function V(e,t){e&&(!1===t?(e.wasFrustumCulled=e.frustumCulled,e.wasVisible=e.visible,e.visible=!0,e.frustumCulled=!1):(e.visible=!!e.wasVisible,e.frustumCulled=!!e.wasFrustumCulled),e.children.forEach(e=>V(e,t)))}let z=new c.Vector2,j=(e=[0])=>{P.getState().globalRenderQueue=P.getState().globalRenderQueue||[0],P.getState().globalRenderQueue=[...P.getState().globalRenderQueue||[],...e]},H=({gl:e,scene:t,camera:i,left:r,top:n,width:a,height:s,layer:o=0,autoClear:l=!1,clearDepth:u=!1})=>{t&&i&&(e.autoClear=l,e.setScissor(r,n,a,s),e.setScissorTest(!0),i.layers.set(o),u&&e.clearDepth(),e.render(t,i),e.setScissorTest(!1))},G=({gl:e,scene:t,camera:i,left:r,top:n,width:a,height:s,layer:o=0,scissor:l=!0,autoClear:u=!1,clearDepth:c=!1})=>{t&&i&&(e.getSize(z),e.autoClear=u,e.setViewport(r,n,a,s),e.setScissor(r,n,a,s),e.setScissorTest(l),i.layers.set(o),c&&e.clearDepth(),e.render(t,i),e.setScissorTest(!1),e.setViewport(0,0,z.x,z.y))},W=(e,t,i=0,r)=>{D.preloadQueue.push((n,a,s)=>{n.setScissorTest(!1),V(e||a,!1),t.layers.set(i),n.render(e||a,t||s),V(e||a,!0),r&&r()}),(0,a.l)()},$=()=>{let e=P(e=>e.isCanvasAvailable),t=P(e=>e.hasSmoothScrollbar),i=P(e=>e.requestReflow),r=P(e=>e.pageReflow),a=P(e=>e.debug),s=P(e=>e.scaleMultiplier);return(0,n.useEffect)(()=>{a&&(window._scrollRig=window._scrollRig||{},window._scrollRig.reflow=i)},[]),{debug:a,isCanvasAvailable:e,hasSmoothScrollbar:t,scaleMultiplier:s,preloadScene:W,requestRender:j,renderScissor:H,renderViewport:G,reflow:i,reflowCompleted:r}},q=({children:e})=>{let t=(0,a.z)(e=>e.gl),i=P(e=>e.canvasChildren),r=$();return(0,n.useEffect)(()=>{Object.keys(i).length||(r.debug&&console.log("GlobalRenderer","auto render empty canvas"),t.clear(),r.requestRender(),(0,a.l)())},[i]),r.debug&&console.log("GlobalChildren",Object.keys(i).length),n.createElement(n.Fragment,null,e,Object.keys(i).map(e=>{let{mesh:t,props:a}=i[e];return"function"==typeof t?n.createElement(n.Fragment,{key:e},t(C({key:e},r,a))):(0,n.cloneElement)(t,C({key:e},a))}))},Y=()=>{let e=(0,a.z)(e=>e.gl),t=(0,a.z)(e=>e.frameloop),i=P(e=>e.globalClearDepth),r=P(e=>e.globalPriority),n=$();return k(()=>{e.debug.checkShaderErrors=n.debug},[n.debug]),(0,a.A)(({camera:t,scene:i})=>{D.preloadQueue.length&&(D.preloadQueue.forEach(r=>r(e,i,t)),e.clear(),D.preloadQueue=[],n.debug&&console.log("GlobalRenderer","preload complete. trigger global render"),n.requestRender(),(0,a.l)())},D.PRIORITY_PRELOAD),(0,a.A)(({camera:r,scene:n})=>{let a=P.getState().globalRenderQueue;("always"===t||a)&&(r.layers.disableAll(),a?a.forEach(e=>{r.layers.enable(e)}):r.layers.enable(0),i&&e.clearDepth(),e.render(n,r)),P.getState().clearGlobalRenderQueue()},r),null};class K extends n.Component{constructor(e){super(e),this.state={error:!1},this.props=e}static getDerivedStateFromError(e){return{error:e}}render(){return this.state.error?(this.props.onError&&this.props.onError(this.state.error),null):this.props.children}}var X="8.12.2";let Z=["children","as","gl","style","orthographic","camera","debug","scaleMultiplier","globalRender","globalPriority","globalClearDepth"],J=["children","onError"];"undefined"!=typeof window&&(r=window.ResizeObserver||o.do);let Q=e=>{let{children:t,as:i=s.Xz,gl:a,style:o,orthographic:u,camera:c,debug:d,scaleMultiplier:h=D.DEFAULT_SCALE_MULTIPLIER,globalRender:f=!0,globalPriority:p=D.PRIORITY_GLOBAL,globalClearDepth:m=!1}=e,g=I(e,Z),v=P(e=>e.globalRender);return k(()=>{"undefined"!=typeof window&&(window.__r3f_scroll_rig=X);let e=(0,l.parse)(window.location.search);(d||void 0!==e.debug)&&(P.setState({debug:!0}),console.info("@14islands/r3f-scroll-rig@"+X))},[d]),k(()=>{(0,n.startTransition)(()=>{P.setState({scaleMultiplier:h,globalRender:f,globalPriority:p,globalClearDepth:m})})},[h,p,f,m]),n.createElement(i,C({id:"ScrollRig-canvas",camera:{manual:!0},gl:C({failIfMajorPerformanceCaveat:!0},a),resize:{scroll:!1,debounce:0,polyfill:r},style:C({position:"fixed",top:0,left:0,right:0,height:"100vh"},o)},g),!u&&n.createElement(U,C({manual:!0,makeDefault:!0},c)),u&&n.createElement(B,C({manual:!0,makeDefault:!0},c)),v&&n.createElement(Y,null),"function"==typeof t?t(n.createElement(q,null)):n.createElement(q,null,t),n.createElement(O,null))},ee=e=>{let{children:t,onError:i}=e,r=I(e,J);return k(()=>{document.documentElement.classList.add("js-has-global-canvas")},[]),n.createElement(K,{onError:e=>{i&&i(e),P.setState({isCanvasAvailable:!1}),document.documentElement.classList.remove("js-has-global-canvas"),document.documentElement.classList.add("js-global-canvas-error")}},n.createElement(Q,C({},r),t),n.createElement("noscript",null,n.createElement("style",null,"\n          .ScrollRig-visibilityHidden,\n          .ScrollRig-transparentColor {\n            visibility: unset;\n            color: unset;\n          }\n          ")))},et=({scale:e})=>n.createElement("mesh",{scale:e},n.createElement("planeGeometry",null),n.createElement("shaderMaterial",{args:[{uniforms:{color:{value:new c.Color("hotpink")}},vertexShader:"\n            void main() {\n              gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n            }\n          ",fragmentShader:"\n            uniform vec3 color;\n            uniform float opacity;\n            void main() {\n              gl_FragColor.rgba = vec4(color, .5);\n            }\n          "}],transparent:!0})),ei="undefined"!=typeof window;function er({debounce:e=0}={}){let[t,i]=(0,n.useState)({width:ei?window.innerWidth:1/0,height:ei?window.innerHeight:1/0});return(0,n.useEffect)(()=>{let r;let n=document.getElementById("ScrollRig-canvas");function a(){let e=n?n.clientWidth:window.innerWidth,r=n?n.clientHeight:window.innerHeight;e===t.width&&r===t.height||i({width:e,height:r})}let s=g.debounce(a,e),l=window.ResizeObserver||o.do;return n?(r=new l(s)).observe(n):window.addEventListener("resize",s),a(),()=>{var e;window.removeEventListener("resize",s),null==(e=r)||e.disconnect()}},[t,i]),t}let en=()=>({enabled:P(e=>e.hasSmoothScrollbar),scroll:P(e=>e.scroll),scrollTo:P(e=>e.scrollTo),onScroll:P(e=>e.onScroll),__lenis:P(e=>e.__lenis)}),ea=["track","children","margin","inViewportMargin","inViewportThreshold","visible","hideOffscreen","scissor","debug","as","priority"];function es(e){let{track:t,children:i,margin:r=0,inViewportMargin:s,inViewportThreshold:o,visible:l=!0,hideOffscreen:u=!0,scissor:d=!1,debug:g=!1,as:y="scene",priority:b=D.PRIORITY_SCISSORS}=e,_=I(e,ea),E=(0,n.useCallback)(e=>{null!==e&&x(e)},[]),[S,x]=(0,n.useState)(d?new c.Scene:null),{requestRender:T,renderScissor:w}=$(),A=P(e=>e.globalRender),{bounds:M,scale:R,position:L,scrollState:O,inViewport:N}=function(e,t){let i=er(),{scroll:r,onScroll:a}=en(),s=P(e=>e.scaleMultiplier),o=P(e=>e.pageReflow),l=P(e=>e.debug),{rootMargin:u,threshold:c,autoUpdate:d,wrapper:g}=(0,n.useMemo)(()=>{let e={rootMargin:"0%",threshold:0,autoUpdate:!0},i=t||{};return Object.keys(i).map((t,r)=>{void 0!==i[t]&&(e[t]=i[t])}),e},[t]),{ref:y,inView:b}=function({threshold:e,delay:t,trackVisibility:i,rootMargin:r,root:a,triggerOnce:s,skip:o,initialInView:l,fallbackInView:u,onChange:c}={}){var d;let[g,v]=n.useState(null),y=n.useRef(),[b,_]=n.useState({inView:!!l,entry:void 0});y.current=c,n.useEffect(()=>{let n;if(!o&&g)return n=function(e,t,i={},r=m){if(void 0===window.IntersectionObserver&&void 0!==r){let n=e.getBoundingClientRect();return t(r,{isIntersecting:r,target:e,intersectionRatio:"number"==typeof i.threshold?i.threshold:0,time:0,boundingClientRect:n,intersectionRect:n,rootBounds:n}),()=>{}}let{id:n,observer:a,elements:s}=function(e){let t=Object.keys(e).sort().filter(t=>void 0!==e[t]).map(t=>{var i;return`${t}_${"root"===t?(i=e.root)?(f.has(i)||(p+=1,f.set(i,p.toString())),f.get(i)):"0":e[t]}`}).toString(),i=h.get(t);if(!i){let r;let n=new Map,a=new IntersectionObserver(t=>{t.forEach(t=>{var i;let a=t.isIntersecting&&r.some(e=>t.intersectionRatio>=e);e.trackVisibility&&void 0===t.isVisible&&(t.isVisible=a),null==(i=n.get(t.target))||i.forEach(e=>{e(a,t)})})},e);r=a.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),i={id:t,observer:a,elements:n},h.set(t,i)}return i}(i),o=s.get(e)||[];return s.has(e)||s.set(e,o),o.push(t),a.observe(e),function(){o.splice(o.indexOf(t),1),0===o.length&&(s.delete(e),a.unobserve(e)),0===s.size&&(a.disconnect(),h.delete(n))}}(g,(e,t)=>{_({inView:e,entry:t}),y.current&&y.current(e,t),t.isIntersecting&&s&&n&&(n(),n=void 0)},{root:a,rootMargin:r,threshold:e,trackVisibility:i,delay:t},u),()=>{n&&n()}},[Array.isArray(e)?e.toString():e,g,a,r,s,o,i,u,t]);let E=null==(d=b.entry)?void 0:d.target,S=n.useRef();g||!E||s||o||S.current===E||(S.current=E,_({inView:!!l,entry:void 0}));let x=[v,b.inView,b.entry];return x.ref=x[0],x.inView=x[1],x.entry=x[2],x}({rootMargin:u,threshold:c});k(()=>{y(e.current)},[e,null==e?void 0:e.current]);let[_,E]=(0,n.useState)(v.vec3(0,0,0)),S=(0,n.useRef)({inViewport:!1,progress:-1,visibility:-1,viewport:-1}).current,x=(0,n.useRef)({top:0,bottom:0,left:0,right:0,width:0,height:0}).current,[T,w]=(0,n.useState)(x),A=(0,n.useRef)({top:0,bottom:0,left:0,right:0,width:0,height:0,x:0,y:0,positiveYUpBottom:0}).current,M=(0,n.useRef)(v.vec3(0,0,0)).current;k(()=>{var t;let r=null==(t=e.current)?void 0:t.getBoundingClientRect();if(!r)return;let n=g?g.scrollTop:window.scrollY,a=g?g.scrollLeft:window.scrollX;x.top=r.top+n,x.bottom=r.bottom+n,x.left=r.left+a,x.right=r.right+a,x.width=r.width,x.height=r.height,w(C({},x)),E(v.vec3((null==x?void 0:x.width)*s,(null==x?void 0:x.height)*s,1)),l&&console.log("useTracker.getBoundingClientRect:",x,"intialScroll:",{initialY:n,initialX:a},"size:",i,"pageReflow:",o)},[e,i,o,s,l]);let R=(0,n.useCallback)(({onlyUpdateInViewport:t=!1,scroll:n}={})=>{if(!e.current||t&&!S.inViewport)return;let a=n||r;A.top=x.top-(a.y||0),A.bottom=x.bottom-(a.y||0),A.left=x.left-(a.x||0),A.right=x.right-(a.x||0),A.width=x.width,A.height=x.height,A.x=A.left+.5*x.width-.5*i.width,A.y=A.top+.5*x.height-.5*i.height,A.positiveYUpBottom=i.height-A.bottom,M.x=A.x*s,M.y=-1*A.y*s;let o="horizontal"===a.scrollDirection,l=o?"width":"height",u=i[l]-A[o?"left":"top"];S.progress=0+(u-0)*1/(i[l]+A[l]-0),S.visibility=0+(u-0)*1/(A[l]-0),S.viewport=0+(u-0)*1/(i[l]-0)},[e,i,s,r]);return k(()=>{S.inViewport=b,R({onlyUpdateInViewport:!1}),l&&console.log("useTracker.inViewport:",b,"update()")},[b]),k(()=>{R({onlyUpdateInViewport:!1}),l&&console.log("useTracker.update on resize/reflow")},[R,o]),(0,n.useEffect)(()=>{if(d)return a(e=>R({onlyUpdateInViewport:!0}))},[d,R,a]),{scale:_,inViewport:b,rect:T,bounds:A,position:M,scrollState:S,update:R}}(t,{rootMargin:s,threshold:o});k(()=>{S&&(S.visible=u?N&&l:l)},[S,N,u,l]),(0,n.useEffect)(()=>{S&&(S.position.y=L.y,S.position.x=L.x)},[R,S,N]),(0,a.A)(({gl:e,camera:t})=>{S&&S.visible&&(S.position.y=L.y,S.position.x=L.x,d?w({gl:e,scene:S,camera:t,left:M.left-r,top:M.positiveYUpBottom-r,width:M.width+2*r,height:M.height+2*r}):T())},A?b:void 0);let U=n.createElement(n.Fragment,null,(!i||g)&&R&&n.createElement(et,{scale:R}),i&&S&&R&&i(C({track:t,margin:r,scene:S,scale:R,scrollState:O,inViewport:N,priority:b},_)));return d&&S?(0,a.g)(U,S):n.createElement(y,{ref:E},U)}let eo=["children","id","dispose"],el=(0,n.forwardRef)((e,t)=>{let{children:i,id:r,dispose:a=!0}=e,s=I(e,eo);return i&&function(e,t={},{key:i,dispose:r=!0}={}){let a=P(e=>e.updateCanvas),s=P(e=>e.renderToCanvas),o=P(e=>e.removeFromCanvas),l=(0,n.useMemo)(()=>i||c.MathUtils.generateUUID(),[]);k(()=>{s(l,e,C({},t,{inactive:!1}))},[l]),(0,n.useEffect)(()=>()=>{o(l,r)},[l]);let u=(0,n.useCallback)(e=>{a(l,e)},[a,l]);(0,n.useEffect)(()=>{u(t)},[...Object.values(t)])}(i,C({},s,{ref:t}),{key:r,dispose:a}),null}),eu=!1;function ec(e,{initTexture:t=!0,premultiplyAlpha:i="default"}={}){var r,s;let o=(0,a.z)(e=>e.gl),l=er(),u=P(e=>e.debug),[d,h]=(0,n.useState)(null==(r=e.current)?void 0:r.currentSrc);(0,n.useEffect)(()=>{let t=e.current,i=()=>{var t;h(null==(t=e.current)?void 0:t.currentSrc)};return null==t||t.addEventListener("load",i),()=>null==t?void 0:t.removeEventListener("load",i)},[e,d,h]);let f=b(()=>(c.DefaultLoadingManager.itemStart("waiting for DOM image"),new Promise(t=>{let i=e.current;function r(){t(null==i?void 0:i.currentSrc),c.DefaultLoadingManager.itemEnd("waiting for DOM image")}null==i||i.addEventListener("load",r,{once:!0}),null!=i&&i.complete&&(null==i||i.removeEventListener("load",r),r())})),[e,l,null==(s=e.current)?void 0:s.currentSrc,d],{equal:E}),p=!function(){let e=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),t=navigator.userAgent.indexOf("Firefox")>-1,i=t?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1;return"undefined"==typeof createImageBitmap||e||t&&98>Number(i)}()?c.ImageBitmapLoader:c.TextureLoader,m=(0,a.D)(p,f,e=>{e instanceof c.ImageBitmapLoader&&(e.setOptions({colorSpaceConversion:"none",premultiplyAlpha:i,imageOrientation:"flipY"}),e.setRequestHeader({Accept:(eu?"image/webp,":"")+"*/*"}))}),g=(0,n.useMemo)(()=>m instanceof c.Texture?m:m instanceof ImageBitmap?new c.CanvasTexture(m):void 0,[m]);return(0,n.useEffect)(function(){t&&o.initTexture(g),u&&console.log("useImageAsTexture","initTexture()")},[o,g,t]),g}_.then(e=>{eu=e});let ed=(0,n.forwardRef)(({children:e,enabled:t=!0,locked:i=!1,scrollRestoration:r="auto",disablePointerOnScroll:a=!0,horizontal:s=!1,scrollInContainer:o=!1,updateGlobalState:l=!0,onScroll:u,config:c={},invalidate:d=()=>{},addEffect:h},f)=>{let p=(0,n.useRef)(),m=(0,n.useRef)(!1),g=P(e=>e.scroll);(0,n.useImperativeHandle)(f,()=>({start:()=>{var e;return null==(e=p.current)?void 0:e.start()},stop:()=>{var e;return null==(e=p.current)?void 0:e.stop()},on:(e,t)=>{var i;return null==(i=p.current)?void 0:i.on(e,t)},notify:()=>{var e;return null==(e=p.current)?void 0:e.emit()},emit:()=>{var e;return null==(e=p.current)?void 0:e.emit()},scrollTo:(e,t)=>{var i;return null==(i=p.current)?void 0:i.scrollTo(e,t)},raf:e=>{var t;return null==(t=p.current)?void 0:t.raf(e)},__lenis:p.current}));let v=(0,n.useCallback)(e=>{a&&m.current!==e&&(m.current=e,document.documentElement.style.pointerEvents=e?"none":"auto")},[a,m]);return k(()=>{"scrollRestoration"in window.history&&(window.history.scrollRestoration=r)},[]),k(()=>{let e;let i=document.documentElement,r=document.body,n=document.body.firstElementChild;if(i.classList.toggle("ScrollRig-scrollHtml",o),r.classList.toggle("ScrollRig-scrollWrapper",o),o&&Object.assign(c,{smoothTouch:!0,wrapper:r,content:n}),p.current=new R(C({orientation:s?"horizontal":"vertical"},c,t?{}:{smoothWheel:!1,syncTouch:!1,smoothTouch:!1})),h)e=h(e=>{var t;return null==(t=p.current)?void 0:t.raf(e)});else{let t;t=requestAnimationFrame(function e(i){var r;null==(r=p.current)||r.raf(i),t=requestAnimationFrame(e)}),e=()=>cancelAnimationFrame(t)}return()=>{var t;e(),null==(t=p.current)||t.destroy()}},[t]),k(()=>{let e=p.current,t=({scroll:e,limit:t,velocity:i,direction:r,progress:n})=>{let a=s?e:0;l&&(g.y=s?0:e,g.x=a,g.limit=t,g.velocity=i,g.direction=r,g.progress=n||0),Math.abs(i)>1.5&&v(!0),1>Math.abs(i)&&v(!1),u&&u({scroll:e,limit:t,velocity:i,direction:r,progress:n}),d()};return null==e||e.on("scroll",t),l&&(g.scrollDirection=s?"horizontal":"vertical",P.setState({__lenis:e,scrollTo:(...t)=>{null==e||e.scrollTo(...t)},onScroll:t=>(null==e||e.on("scroll",t),null==e||e.emit(),()=>null==e?void 0:e.off("scroll",t))}),P.getState().scroll.y=window.scrollY,P.getState().scroll.x=window.scrollX),null==e||e.emit(),()=>{null==e||e.off("scroll",t),l&&P.setState({__lenis:void 0,onScroll:()=>()=>{},scrollTo:()=>{}})}},[t]),k(()=>{let e=()=>d(),t=()=>v(!1);return window.addEventListener("pointermove",t),window.addEventListener("pointerdown",t),window.addEventListener("wheel",e),()=>{window.removeEventListener("pointermove",t),window.removeEventListener("pointerdown",t),window.removeEventListener("wheel",e)}},[]),(0,n.useEffect)(()=>(l&&(document.documentElement.classList.toggle("js-smooth-scrollbar-enabled",t),document.documentElement.classList.toggle("js-smooth-scrollbar-disabled",!t),P.setState({hasSmoothScrollbar:t})),()=>{document.documentElement.classList.remove("js-smooth-scrollbar-enabled"),document.documentElement.classList.remove("js-smooth-scrollbar-disabled")}),[t]),(0,n.useEffect)(()=>{var e,t;i?null==(e=p.current)||e.stop():null==(t=p.current)||t.start()},[i]),e?e({}):null});var eh=(0,n.forwardRef)(function(e,t){let i=P(e=>e.isCanvasAvailable);return n.createElement(ed,C(i?{key:"r3f",ref:t,invalidate:a.l,addEffect:a.n}:{key:"native",ref:t},e))});let ef={hidden:"ScrollRig-visibilityHidden",hiddenWhenSmooth:"ScrollRig-visibilityHidden ScrollRig-hiddenIfSmooth",transparentColor:"ScrollRig-transparentColor",transparentColorWhenSmooth:"ScrollRig-transparentColor ScrollRig-hiddenIfSmooth"}},92854:function(e,t,i){"use strict";i.d(t,{xv:function(){return q},Z9:function(){return s},cr:function(){return Y},Cx:function(){return z}});var r,n,a,s,o=i(50959),l=i(31171),u=i(28957),c=i(60045),d=i(40767);function h(e,t){return e.replace(RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}var f=i(10422),p={disabled:!1},m=o.createContext(null),g=function(e){return e.scrollTop},v="unmounted",y="exited",b="entering",_="entered",E="exiting",S=function(e){function t(t,i){r=e.call(this,t,i)||this;var r,n,a=i&&!i.isMounting?t.enter:t.appear;return r.appearStatus=null,t.in?a?(n=y,r.appearStatus=b):n=_:n=t.unmountOnExit||t.mountOnEnter?v:y,r.state={status:n},r.nextCallback=null,r}(0,d.Z)(t,e),t.getDerivedStateFromProps=function(e,t){return e.in&&t.status===v?{status:y}:null};var i=t.prototype;return i.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},i.componentDidUpdate=function(e){var t=null;if(e!==this.props){var i=this.state.status;this.props.in?i!==b&&i!==_&&(t=b):(i===b||i===_)&&(t=E)}this.updateStatus(!1,t)},i.componentWillUnmount=function(){this.cancelNextCallback()},i.getTimeouts=function(){var e,t,i,r=this.props.timeout;return e=t=i=r,null!=r&&"number"!=typeof r&&(e=r.exit,t=r.enter,i=void 0!==r.appear?r.appear:t),{exit:e,enter:t,appear:i}},i.updateStatus=function(e,t){if(void 0===e&&(e=!1),null!==t){if(this.cancelNextCallback(),t===b){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:f.findDOMNode(this);i&&g(i)}this.performEnter(e)}else this.performExit()}else this.props.unmountOnExit&&this.state.status===y&&this.setState({status:v})},i.performEnter=function(e){var t=this,i=this.props.enter,r=this.context?this.context.isMounting:e,n=this.props.nodeRef?[r]:[f.findDOMNode(this),r],a=n[0],s=n[1],o=this.getTimeouts(),l=r?o.appear:o.enter;if(!e&&!i||p.disabled){this.safeSetState({status:_},function(){t.props.onEntered(a)});return}this.props.onEnter(a,s),this.safeSetState({status:b},function(){t.props.onEntering(a,s),t.onTransitionEnd(l,function(){t.safeSetState({status:_},function(){t.props.onEntered(a,s)})})})},i.performExit=function(){var e=this,t=this.props.exit,i=this.getTimeouts(),r=this.props.nodeRef?void 0:f.findDOMNode(this);if(!t||p.disabled){this.safeSetState({status:y},function(){e.props.onExited(r)});return}this.props.onExit(r),this.safeSetState({status:E},function(){e.props.onExiting(r),e.onTransitionEnd(i.exit,function(){e.safeSetState({status:y},function(){e.props.onExited(r)})})})},i.cancelNextCallback=function(){null!==this.nextCallback&&(this.nextCallback.cancel(),this.nextCallback=null)},i.safeSetState=function(e,t){t=this.setNextCallback(t),this.setState(e,t)},i.setNextCallback=function(e){var t=this,i=!0;return this.nextCallback=function(r){i&&(i=!1,t.nextCallback=null,e(r))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},i.onTransitionEnd=function(e,t){this.setNextCallback(t);var i=this.props.nodeRef?this.props.nodeRef.current:f.findDOMNode(this),r=null==e&&!this.props.addEndListener;if(!i||r){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var n=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],a=n[0],s=n[1];this.props.addEndListener(a,s)}null!=e&&setTimeout(this.nextCallback,e)},i.render=function(){var e=this.state.status;if(e===v)return null;var t=this.props,i=t.children,r=(t.in,t.mountOnEnter,t.unmountOnExit,t.appear,t.enter,t.exit,t.timeout,t.addEndListener,t.onEnter,t.onEntering,t.onEntered,t.onExit,t.onExiting,t.onExited,t.nodeRef,(0,c.Z)(t,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]));return o.createElement(m.Provider,{value:null},"function"==typeof i?i(e,r):o.cloneElement(o.Children.only(i),r))},t}(o.Component);function x(){}S.contextType=m,S.propTypes={},S.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:x,onEntering:x,onEntered:x,onExit:x,onExiting:x,onExited:x},S.UNMOUNTED=v,S.EXITED=y,S.ENTERING=b,S.ENTERED=_,S.EXITING=E;var T=function(e,t){return e&&t&&t.split(" ").forEach(function(t){e.classList?e.classList.remove(t):"string"==typeof e.className?e.className=h(e.className,t):e.setAttribute("class",h(e.className&&e.className.baseVal||"",t))})},w=function(e){function t(){for(var t,i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this).appliedClasses={appear:{},enter:{},exit:{}},t.onEnter=function(e,i){var r=t.resolveArguments(e,i),n=r[0],a=r[1];t.removeClasses(n,"exit"),t.addClass(n,a?"appear":"enter","base"),t.props.onEnter&&t.props.onEnter(e,i)},t.onEntering=function(e,i){var r=t.resolveArguments(e,i),n=r[0],a=r[1];t.addClass(n,a?"appear":"enter","active"),t.props.onEntering&&t.props.onEntering(e,i)},t.onEntered=function(e,i){var r=t.resolveArguments(e,i),n=r[0],a=r[1]?"appear":"enter";t.removeClasses(n,a),t.addClass(n,a,"done"),t.props.onEntered&&t.props.onEntered(e,i)},t.onExit=function(e){var i=t.resolveArguments(e)[0];t.removeClasses(i,"appear"),t.removeClasses(i,"enter"),t.addClass(i,"exit","base"),t.props.onExit&&t.props.onExit(e)},t.onExiting=function(e){var i=t.resolveArguments(e)[0];t.addClass(i,"exit","active"),t.props.onExiting&&t.props.onExiting(e)},t.onExited=function(e){var i=t.resolveArguments(e)[0];t.removeClasses(i,"exit"),t.addClass(i,"exit","done"),t.props.onExited&&t.props.onExited(e)},t.resolveArguments=function(e,i){return t.props.nodeRef?[t.props.nodeRef.current,e]:[e,i]},t.getClassNames=function(e){var i=t.props.classNames,r="string"==typeof i,n=r?(r&&i?i+"-":"")+e:i[e],a=r?n+"-active":i[e+"Active"],s=r?n+"-done":i[e+"Done"];return{baseClassName:n,activeClassName:a,doneClassName:s}},t}(0,d.Z)(t,e);var i=t.prototype;return i.addClass=function(e,t,i){var r,n=this.getClassNames(t)[i+"ClassName"],a=this.getClassNames("enter").doneClassName;"appear"===t&&"done"===i&&a&&(n+=" "+a),"active"===i&&e&&g(e),n&&(this.appliedClasses[t][i]=n,r=n,e&&r&&r.split(" ").forEach(function(t){var i,r;return i=e,r=t,void(i.classList?i.classList.add(r):(i.classList?r&&i.classList.contains(r):-1!==(" "+(i.className.baseVal||i.className)+" ").indexOf(" "+r+" "))||("string"==typeof i.className?i.className=i.className+" "+r:i.setAttribute("class",(i.className&&i.className.baseVal||"")+" "+r)))}))},i.removeClasses=function(e,t){var i=this.appliedClasses[t],r=i.base,n=i.active,a=i.done;this.appliedClasses[t]={},r&&T(e,r),n&&T(e,n),a&&T(e,a)},i.render=function(){var e=this.props,t=(e.classNames,(0,c.Z)(e,["classNames"]));return o.createElement(S,(0,u.Z)({},t,{onEnter:this.onEnter,onEntered:this.onEntered,onEntering:this.onEntering,onExit:this.onExit,onExiting:this.onExiting,onExited:this.onExited}))},t}(o.Component);w.defaultProps={classNames:""},w.propTypes={};var A=i(2207);function M(e,t){var i=Object.create(null);return e&&o.Children.map(e,function(e){return e}).forEach(function(e){i[e.key]=t&&(0,o.isValidElement)(e)?t(e):e}),i}function R(e,t,i){return null!=i[t]?i[t]:e.props[t]}var C=Object.values||function(e){return Object.keys(e).map(function(t){return e[t]})},I=function(e){function t(t,i){var r,n=(r=e.call(this,t,i)||this).handleExited.bind((0,A.Z)(r));return r.state={contextValue:{isMounting:!0},handleExited:n,firstRender:!0},r}(0,d.Z)(t,e);var i=t.prototype;return i.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},i.componentWillUnmount=function(){this.mounted=!1},t.getDerivedStateFromProps=function(e,t){var i,r,n=t.children,a=t.handleExited;return{children:t.firstRender?M(e.children,function(t){return(0,o.cloneElement)(t,{onExited:a.bind(null,t),in:!0,appear:R(t,"appear",e),enter:R(t,"enter",e),exit:R(t,"exit",e)})}):(Object.keys(r=function(e,t){function i(i){return i in t?t[i]:e[i]}e=e||{},t=t||{};var r,n=Object.create(null),a=[];for(var s in e)s in t?a.length&&(n[s]=a,a=[]):a.push(s);var o={};for(var l in t){if(n[l])for(r=0;r<n[l].length;r++){var u=n[l][r];o[n[l][r]]=i(u)}o[l]=i(l)}for(r=0;r<a.length;r++)o[a[r]]=i(a[r]);return o}(n,i=M(e.children))).forEach(function(t){var s=r[t];if((0,o.isValidElement)(s)){var l=t in n,u=t in i,c=n[t],d=(0,o.isValidElement)(c)&&!c.props.in;u&&(!l||d)?r[t]=(0,o.cloneElement)(s,{onExited:a.bind(null,s),in:!0,exit:R(s,"exit",e),enter:R(s,"enter",e)}):u||!l||d?u&&l&&(0,o.isValidElement)(c)&&(r[t]=(0,o.cloneElement)(s,{onExited:a.bind(null,s),in:c.props.in,exit:R(s,"exit",e),enter:R(s,"enter",e)})):r[t]=(0,o.cloneElement)(s,{in:!1})}}),r),firstRender:!1}},i.handleExited=function(e,t){var i=M(this.props.children);e.key in i||(e.props.onExited&&e.props.onExited(t),this.mounted&&this.setState(function(t){var i=(0,u.Z)({},t.children);return delete i[e.key],{children:i}}))},i.render=function(){var e=this.props,t=e.component,i=e.childFactory,r=(0,c.Z)(e,["component","childFactory"]),n=this.state.contextValue,a=C(this.state.children).map(i);return(delete r.appear,delete r.enter,delete r.exit,null===t)?o.createElement(m.Provider,{value:n},a):o.createElement(m.Provider,{value:n},o.createElement(t,r,a))},t}(o.Component);I.propTypes={},I.defaultProps={component:"div",childFactory:function(e){return e}};var L={out:"out-in",in:"in-out"},k=function(e,t,i){return function(){var r;e.props[t]&&(r=e.props)[t].apply(r,arguments),i()}},D=((n={})[L.out]=function(e){var t=e.current,i=e.changeState;return o.cloneElement(t,{in:!1,onExited:k(t,"onExited",function(){i(b,null)})})},n[L.in]=function(e){var t=e.current,i=e.changeState,r=e.children;return[t,o.cloneElement(r,{in:!0,onEntered:k(r,"onEntered",function(){i(b)})})]},n),P=((a={})[L.out]=function(e){var t=e.children,i=e.changeState;return o.cloneElement(t,{in:!0,onEntered:k(t,"onEntered",function(){i(_,o.cloneElement(t,{in:!0}))})})},a[L.in]=function(e){var t=e.current,i=e.children,r=e.changeState;return[o.cloneElement(t,{in:!1,onExited:k(t,"onExited",function(){r(_,o.cloneElement(i,{in:!0}))})}),o.cloneElement(i,{in:!0})]},a),O=function(e){function t(){for(var t,i=arguments.length,r=Array(i),n=0;n<i;n++)r[n]=arguments[n];return(t=e.call.apply(e,[this].concat(r))||this).state={status:_,current:null},t.appeared=!1,t.changeState=function(e,i){void 0===i&&(i=t.state.current),t.setState({status:e,current:i})},t}(0,d.Z)(t,e);var i=t.prototype;return i.componentDidMount=function(){this.appeared=!0},t.getDerivedStateFromProps=function(e,t){var i,r;return null==e.children?{current:null}:t.status===b&&e.mode===L.in?{status:b}:t.current&&!((i=t.current)===(r=e.children)||o.isValidElement(i)&&o.isValidElement(r)&&null!=i.key&&i.key===r.key)?{status:E}:{current:o.cloneElement(e.children,{in:!0})}},i.render=function(){var e,t=this.props,i=t.children,r=t.mode,n=this.state,a=n.status,s=n.current,l={children:i,current:s,changeState:this.changeState,status:a};switch(a){case b:e=P[r](l);break;case E:e=D[r](l);break;case _:e=s}return o.createElement(m.Provider,{value:{isMounting:!this.appeared}},e)},t}(o.Component);O.propTypes={},O.defaultProps={mode:L.out};var N=i(11527);(r=s||(s={})).SUSPENDED="suspended",r.APPEAR="appear",r.APPEARING="appearing",r.APPEARED="appeared",r.EXIT="exit",r.EXITING="exiting",r.EXITED="exited",r.ENTER="enter",r.ENTERING="entering",r.ENTERED="entered";let U=function(e){let t;let i=new Set,r=(e,r)=>{let n="function"==typeof e?e(t):e;if(n!==t){let e=t;t=r?n:Object.assign({},t,n),i.forEach(i=>i(t,e))}},n=()=>t,a=(e,r=n,a=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let s=r(t);function o(){let i=r(t);if(!a(s,i)){let t=s;e(s=i,t)}}return i.add(o),()=>i.delete(o)},s={setState:r,getState:n,subscribe:(e,t,r)=>t||r?a(e,t,r):(i.add(e),()=>i.delete(e)),destroy:()=>i.clear()};return t=e(r,n,s),s}(e=>({transitionStateTo:s.SUSPENDED,transitionStateFrom:s.SUSPENDED,transitionConfig:null,exitDone:()=>{},enterDone:()=>{},from:null,to:null,data:null,onEnteringCount:0,onExitingCount:0,applyTransitionConfig:()=>e(e=>{var t;return{data:null==(t=e.transitionConfig)?void 0:t.data,transitionConfig:null}}),suspendedRoute:null})),F=(0,l.Z)(U),B="undefined"!=typeof window?o.useLayoutEffect:o.useEffect,V=(0,o.createContext)("both");function z({onEnter:e,onEntering:t,onEntered:i,onExit:r,onExiting:n}={}){let a=(0,o.useContext)(V),s=F(e=>e.transitionStateTo),l=F(e=>e.transitionStateFrom),u=F(e=>e.enterDone),c=F(e=>e.exitDone),d=F(e=>e.from),h=F(e=>e.to),f=F(e=>e.data),p=a===U.getState().to,m=a===U.getState().from;return B(()=>(p&&t&&U.setState({onEnteringCount:U.getState().onEnteringCount+1}),()=>{p&&t&&U.setState({onEnteringCount:U.getState().onEnteringCount-1})}),[p,t]),B(()=>(m&&n&&U.setState({onExitingCount:U.getState().onExitingCount+1}),()=>{m&&n&&U.setState({onExitingCount:U.getState().onExitingCount-1})}),[m,n]),(0,o.useEffect)(function(){p&&("appear"===s?null==e||e({isAppearing:!0,from:U.getState().from,to:U.getState().to}):"appearing"===s?null==t||t({isAppearing:!0,done:u,from:U.getState().from,to:U.getState().to}):"appeared"===s?null==i||i({isAppearing:!0,from:U.getState().from,to:U.getState().to}):"enter"===s?null==e||e({isAppearing:!1,from:U.getState().from,to:U.getState().to}):"entering"===s?null==t||t({isAppearing:!1,from:U.getState().from,to:U.getState().to,done:u,data:U.getState().data}):"entered"===s&&(null==i||i({isAppearing:!1,from:U.getState().from,to:U.getState().to})))},[s]),B(function(){m&&("exit"===l?null==r||r({to:U.getState().to}):"exiting"===l&&(null==n||n({from:U.getState().from,to:U.getState().to,done:c,data:U.getState().data})))},[l]),"both"===a?{transitionStateTo:s,transitionStateFrom:l,from:d,to:h,data:f}:{transitionState:p?s:l,from:d,to:h,data:f}}function j(){return(j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}function H(e){let t=e.replace(/\//g,"-");return t.startsWith("-")?t.substring(1):t}let G=["children","pathname","className","timeout","detectAnimationEnd","detectTransitionEnd"],W=({pathname:e,className:t})=>{let i=!U.getState().from;return(0,o.useEffect)(()=>(U.setState({suspendedRoute:e}),()=>{U.setState({suspendedRoute:null})}),[]),(0,N.jsx)("div",{className:`${t} ${t}-${H(e)} ${t}-${i?"appear":"enter"}-suspended`})};function $(e){let{children:t,pathname:i,className:r,timeout:n,detectAnimationEnd:a,detectTransitionEnd:l}=e,u=function(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)t.indexOf(i=a[r])>=0||(n[i]=e[i]);return n}(e,G),c=(0,o.useRef)(null);return(0,N.jsx)(o.Suspense,{fallback:(0,N.jsx)(W,{pathname:i,className:r}),children:(0,N.jsx)(w,j({nodeRef:c,addEndListener:e=>{if(!c.current)return;let t=i===U.getState().to,r=i===U.getState().from;(t&&0===U.getState().onEnteringCount||r&&0===U.getState().onExitingCount)&&(a&&c.current.addEventListener("animationend",e,!1),l&&c.current.addEventListener("transitionend",e,!1)),t?U.setState({enterDone:e}):r&&U.setState({exitDone:e})},timeout:n,classNames:r,appear:!0,unmountOnExit:!0},u,{onEnter:e=>{U.setState({transitionStateTo:e?s.APPEAR:s.ENTER}),u.onEnter&&u.onEnter()},onEntering:e=>{U.setState({transitionStateTo:e?s.APPEARING:s.ENTERING}),u.onEntering&&u.onEntering()},onEntered:e=>{U.setState({transitionStateTo:e?s.APPEARED:s.ENTERED}),u.onEntered&&u.onEntered()},onExit:()=>{U.setState({transitionStateFrom:s.EXIT}),u.onExit&&u.onExit()},onExiting:()=>{U.setState({transitionStateFrom:s.EXITING}),u.onExiting&&u.onExiting()},onExited:()=>{U.setState({transitionStateFrom:s.EXITED}),u.onExited&&u.onExited()},children:(0,N.jsx)("div",{className:`${r} ${r}-${H(i)}`,ref:c,children:(0,N.jsx)(V.Provider,{value:i,children:t})})}),i)})}function q({children:e,pageName:t,mode:i="out-in",className:r="page",timeout:n,detectAnimationEnd:a=!0,detectTransitionEnd:l=!0}){function u(){return(0,N.jsx)($,{pathname:t,className:r,timeout:n,detectAnimationEnd:a,detectTransitionEnd:l,children:e},t)}(0,o.useMemo)(()=>{U.getState().to=t,U.getState().transitionStateTo=s.SUSPENDED,U.getState().transitionStateFrom=s.SUSPENDED},[t]),B(()=>(U.getState().applyTransitionConfig(),()=>{U.setState({from:t})}),[t]);let[c,d]=(0,o.useState)(0);return B(()=>{let e=U.getState().suspendedRoute;e&&t!==e&&d(c+1)},[t,c,d]),(0,N.jsx)(o.Fragment,{children:"sync"===i?(0,N.jsx)(I,{component:null,appear:!0,enter:!0,exit:!0,children:u()}):(0,N.jsx)(O,{mode:i,children:u()})},c)}function Y(e){U.setState({transitionConfig:{data:e}})}},2207:function(e,t,i){"use strict";function r(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}i.d(t,{Z:function(){return r}})},28957:function(e,t,i){"use strict";function r(){return(r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}i.d(t,{Z:function(){return r}})},40767:function(e,t,i){"use strict";i.d(t,{Z:function(){return n}});var r=i(75345);function n(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,(0,r.Z)(e,t)}},60045:function(e,t,i){"use strict";function r(e,t){if(null==e)return{};var i,r,n={},a=Object.keys(e);for(r=0;r<a.length;r++)i=a[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}i.d(t,{Z:function(){return r}})},75345:function(e,t,i){"use strict";function r(e,t){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}i.d(t,{Z:function(){return r}})},83083:function(e,t,i){"use strict";i.d(t,{Cp:function(){return d},RR:function(){return l},US:function(){return s},cv:function(){return f},dp:function(){return g},dr:function(){return m},oo:function(){return a},uY:function(){return p},x7:function(){return o}});var r=i(56029);function n(e,t,i){let n,{reference:a,floating:s}=e,o=(0,r.Qq)(t),l=(0,r.Wh)(t),u=(0,r.I4)(l),c=(0,r.k3)(t),d="y"===o,h=a.x+a.width/2-s.width/2,f=a.y+a.height/2-s.height/2,p=a[u]/2-s[u]/2;switch(c){case"top":n={x:h,y:a.y-s.height};break;case"bottom":n={x:h,y:a.y+a.height};break;case"right":n={x:a.x+a.width,y:f};break;case"left":n={x:a.x-s.width,y:f};break;default:n={x:a.x,y:a.y}}switch((0,r.hp)(t)){case"start":n[l]-=p*(i&&d?-1:1);break;case"end":n[l]+=p*(i&&d?-1:1)}return n}let a=async(e,t,i)=>{let{placement:r="bottom",strategy:a="absolute",middleware:s=[],platform:o}=i,l=s.filter(Boolean),u=await (null==o.isRTL?void 0:o.isRTL(t)),c=await o.getElementRects({reference:e,floating:t,strategy:a}),{x:d,y:h}=n(c,r,u),f=r,p={},m=0;for(let i=0;i<l.length;i++){let{name:s,fn:g}=l[i],{x:v,y:y,data:b,reset:_}=await g({x:d,y:h,initialPlacement:r,placement:f,strategy:a,middlewareData:p,rects:c,platform:o,elements:{reference:e,floating:t}});if(d=null!=v?v:d,h=null!=y?y:h,p={...p,[s]:{...p[s],...b}},_&&m<=50){m++,"object"==typeof _&&(_.placement&&(f=_.placement),_.rects&&(c=!0===_.rects?await o.getElementRects({reference:e,floating:t,strategy:a}):_.rects),{x:d,y:h}=n(c,f,u)),i=-1;continue}}return{x:d,y:h,placement:f,strategy:a,middlewareData:p}};async function s(e,t){var i;void 0===t&&(t={});let{x:n,y:a,platform:s,rects:o,elements:l,strategy:u}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:p=0}=(0,r.ku)(t,e),m=(0,r.yd)(p),g=l[f?"floating"===h?"reference":"floating":h],v=(0,r.JB)(await s.getClippingRect({element:null==(i=await (null==s.isElement?void 0:s.isElement(g)))||i?g:g.contextElement||await (null==s.getDocumentElement?void 0:s.getDocumentElement(l.floating)),boundary:c,rootBoundary:d,strategy:u})),y="floating"===h?{...o.floating,x:n,y:a}:o.reference,b=await (null==s.getOffsetParent?void 0:s.getOffsetParent(l.floating)),_=await (null==s.isElement?void 0:s.isElement(b))&&await (null==s.getScale?void 0:s.getScale(b))||{x:1,y:1},E=(0,r.JB)(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:b,strategy:u}):y);return{top:(v.top-E.top+m.top)/_.y,bottom:(E.bottom-v.bottom+m.bottom)/_.y,left:(v.left-E.left+m.left)/_.x,right:(E.right-v.right+m.right)/_.x}}let o=e=>({name:"arrow",options:e,async fn(t){let{x:i,y:n,placement:a,rects:s,platform:o,elements:l,middlewareData:u}=t,{element:c,padding:d=0}=(0,r.ku)(e,t)||{};if(null==c)return{};let h=(0,r.yd)(d),f={x:i,y:n},p=(0,r.Wh)(a),m=(0,r.I4)(p),g=await o.getDimensions(c),v="y"===p,y=v?"clientHeight":"clientWidth",b=s.reference[m]+s.reference[p]-f[p]-s.floating[m],_=f[p]-s.reference[p],E=await (null==o.getOffsetParent?void 0:o.getOffsetParent(c)),S=E?E[y]:0;S&&await (null==o.isElement?void 0:o.isElement(E))||(S=l.floating[y]||s.floating[m]);let x=S/2-g[m]/2-1,T=(0,r.VV)(h[v?"top":"left"],x),w=(0,r.VV)(h[v?"bottom":"right"],x),A=S-g[m]-w,M=S/2-g[m]/2+(b/2-_/2),R=(0,r.uZ)(T,M,A),C=!u.arrow&&null!=(0,r.hp)(a)&&M!=R&&s.reference[m]/2-(M<T?T:w)-g[m]/2<0,I=C?M<T?M-T:M-A:0;return{[p]:f[p]+I,data:{[p]:R,centerOffset:M-R-I,...C&&{alignmentOffset:I}},reset:C}}}),l=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var i,n,a,o,l;let{placement:u,middlewareData:c,rects:d,initialPlacement:h,platform:f,elements:p}=t,{mainAxis:m=!0,crossAxis:g=!0,fallbackPlacements:v,fallbackStrategy:y="bestFit",fallbackAxisSideDirection:b="none",flipAlignment:_=!0,...E}=(0,r.ku)(e,t);if(null!=(i=c.arrow)&&i.alignmentOffset)return{};let S=(0,r.k3)(u),x=(0,r.k3)(h)===h,T=await (null==f.isRTL?void 0:f.isRTL(p.floating)),w=v||(x||!_?[(0,r.pw)(h)]:(0,r.gy)(h));v||"none"===b||w.push(...(0,r.KX)(h,_,b,T));let A=[h,...w],M=await s(t,E),R=[],C=(null==(n=c.flip)?void 0:n.overflows)||[];if(m&&R.push(M[S]),g){let e=(0,r.i8)(u,d,T);R.push(M[e[0]],M[e[1]])}if(C=[...C,{placement:u,overflows:R}],!R.every(e=>e<=0)){let e=((null==(a=c.flip)?void 0:a.index)||0)+1,t=A[e];if(t)return{data:{index:e,overflows:C},reset:{placement:t}};let i=null==(o=C.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:o.placement;if(!i)switch(y){case"bestFit":{let e=null==(l=C.map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:l[0];e&&(i=e);break}case"initialPlacement":i=h}if(u!==i)return{reset:{placement:i}}}return{}}}};function u(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function c(e){return r.mA.some(t=>e[t]>=0)}let d=function(e){return void 0===e&&(e={}),{name:"hide",options:e,async fn(t){let{rects:i}=t,{strategy:n="referenceHidden",...a}=(0,r.ku)(e,t);switch(n){case"referenceHidden":{let e=await s(t,{...a,elementContext:"reference"}),r=u(e,i.reference);return{data:{referenceHiddenOffsets:r,referenceHidden:c(r)}}}case"escaped":{let e=await s(t,{...a,altBoundary:!0}),r=u(e,i.floating);return{data:{escapedOffsets:r,escaped:c(r)}}}default:return{}}}}};async function h(e,t){let{placement:i,platform:n,elements:a}=e,s=await (null==n.isRTL?void 0:n.isRTL(a.floating)),o=(0,r.k3)(i),l=(0,r.hp)(i),u="y"===(0,r.Qq)(i),c=["left","top"].includes(o)?-1:1,d=s&&u?-1:1,h=(0,r.ku)(t,e),{mainAxis:f,crossAxis:p,alignmentAxis:m}="number"==typeof h?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...h};return l&&"number"==typeof m&&(p="end"===l?-1*m:m),u?{x:p*d,y:f*c}:{x:f*c,y:p*d}}let f=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){let{x:i,y:r}=t,n=await h(t,e);return{x:i+n.x,y:r+n.y,data:n}}}},p=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){let{x:i,y:n,placement:a}=t,{mainAxis:o=!0,crossAxis:l=!1,limiter:u={fn:e=>{let{x:t,y:i}=e;return{x:t,y:i}}},...c}=(0,r.ku)(e,t),d={x:i,y:n},h=await s(t,c),f=(0,r.Qq)((0,r.k3)(a)),p=(0,r.Rn)(f),m=d[p],g=d[f];if(o){let e=m+h["y"===p?"top":"left"],t=m-h["y"===p?"bottom":"right"];m=(0,r.uZ)(e,m,t)}if(l){let e="y"===f?"top":"left",t="y"===f?"bottom":"right",i=g+h[e],n=g-h[t];g=(0,r.uZ)(i,g,n)}let v=u.fn({...t,[p]:m,[f]:g});return{...v,data:{x:v.x-i,y:v.y-n}}}}},m=function(e){return void 0===e&&(e={}),{options:e,fn(t){let{x:i,y:n,placement:a,rects:s,middlewareData:o}=t,{offset:l=0,mainAxis:u=!0,crossAxis:c=!0}=(0,r.ku)(e,t),d={x:i,y:n},h=(0,r.Qq)(a),f=(0,r.Rn)(h),p=d[f],m=d[h],g=(0,r.ku)(l,t),v="number"==typeof g?{mainAxis:g,crossAxis:0}:{mainAxis:0,crossAxis:0,...g};if(u){let e="y"===f?"height":"width",t=s.reference[f]-s.floating[e]+v.mainAxis,i=s.reference[f]+s.reference[e]-v.mainAxis;p<t?p=t:p>i&&(p=i)}if(c){var y,b;let e="y"===f?"width":"height",t=["top","left"].includes((0,r.k3)(a)),i=s.reference[h]-s.floating[e]+(t&&(null==(y=o.offset)?void 0:y[h])||0)+(t?0:v.crossAxis),n=s.reference[h]+s.reference[e]+(t?0:(null==(b=o.offset)?void 0:b[h])||0)-(t?v.crossAxis:0);m<i?m=i:m>n&&(m=n)}return{[f]:p,[h]:m}}}},g=function(e){return void 0===e&&(e={}),{name:"size",options:e,async fn(t){let i,n;let{placement:a,rects:o,platform:l,elements:u}=t,{apply:c=()=>{},...d}=(0,r.ku)(e,t),h=await s(t,d),f=(0,r.k3)(a),p=(0,r.hp)(a),m="y"===(0,r.Qq)(a),{width:g,height:v}=o.floating;"top"===f||"bottom"===f?(i=f,n=p===(await (null==l.isRTL?void 0:l.isRTL(u.floating))?"start":"end")?"left":"right"):(n=f,i="end"===p?"top":"bottom");let y=v-h[i],b=g-h[n],_=!t.middlewareData.shift,E=y,S=b;if(m){let e=g-h.left-h.right;S=p||_?(0,r.VV)(b,e):e}else{let e=v-h.top-h.bottom;E=p||_?(0,r.VV)(y,e):e}if(_&&!p){let e=(0,r.Fp)(h.left,0),t=(0,r.Fp)(h.right,0),i=(0,r.Fp)(h.top,0),n=(0,r.Fp)(h.bottom,0);m?S=g-2*(0!==e||0!==t?e+t:(0,r.Fp)(h.left,h.right)):E=v-2*(0!==i||0!==n?i+n:(0,r.Fp)(h.top,h.bottom))}await c({...t,availableWidth:S,availableHeight:E});let x=await l.getDimensions(u.floating);return g!==x.width||v!==x.height?{reset:{rects:!0}}:{}}}}},65896:function(e,t,i){"use strict";i.d(t,{Me:function(){return k},oo:function(){return D}});var r=i(56029),n=i(83083);function a(e){return l(e)?(e.nodeName||"").toLowerCase():"#document"}function s(e){var t;return(null==e?void 0:null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function o(e){var t;return null==(t=(l(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function l(e){return e instanceof Node||e instanceof s(e).Node}function u(e){return e instanceof Element||e instanceof s(e).Element}function c(e){return e instanceof HTMLElement||e instanceof s(e).HTMLElement}function d(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof s(e).ShadowRoot)}function h(e){let{overflow:t,overflowX:i,overflowY:r,display:n}=g(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+i)&&!["inline","contents"].includes(n)}function f(e){let t=p(),i=g(e);return"none"!==i.transform||"none"!==i.perspective||!!i.containerType&&"normal"!==i.containerType||!t&&!!i.backdropFilter&&"none"!==i.backdropFilter||!t&&!!i.filter&&"none"!==i.filter||["transform","perspective","filter"].some(e=>(i.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(i.contain||"").includes(e))}function p(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}function m(e){return["html","body","#document"].includes(a(e))}function g(e){return s(e).getComputedStyle(e)}function v(e){return u(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function y(e){if("html"===a(e))return e;let t=e.assignedSlot||e.parentNode||d(e)&&e.host||o(e);return d(t)?t.host:t}function b(e,t,i){var r;void 0===t&&(t=[]),void 0===i&&(i=!0);let n=function e(t){let i=y(t);return m(i)?t.ownerDocument?t.ownerDocument.body:t.body:c(i)&&h(i)?i:e(i)}(e),a=n===(null==(r=e.ownerDocument)?void 0:r.body),o=s(n);return a?t.concat(o,o.visualViewport||[],h(n)?n:[],o.frameElement&&i?b(o.frameElement):[]):t.concat(n,b(n,[],i))}function _(e){let t=g(e),i=parseFloat(t.width)||0,n=parseFloat(t.height)||0,a=c(e),s=a?e.offsetWidth:i,o=a?e.offsetHeight:n,l=(0,r.NM)(i)!==s||(0,r.NM)(n)!==o;return l&&(i=s,n=o),{width:i,height:n,$:l}}function E(e){return u(e)?e:e.contextElement}function S(e){let t=E(e);if(!c(t))return(0,r.ze)(1);let i=t.getBoundingClientRect(),{width:n,height:a,$:s}=_(t),o=(s?(0,r.NM)(i.width):i.width)/n,l=(s?(0,r.NM)(i.height):i.height)/a;return o&&Number.isFinite(o)||(o=1),l&&Number.isFinite(l)||(l=1),{x:o,y:l}}let x=(0,r.ze)(0);function T(e){let t=s(e);return p()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:x}function w(e,t,i,n){var a;void 0===t&&(t=!1),void 0===i&&(i=!1);let o=e.getBoundingClientRect(),l=E(e),c=(0,r.ze)(1);t&&(n?u(n)&&(c=S(n)):c=S(e));let d=(void 0===(a=i)&&(a=!1),n&&(!a||n===s(l))&&a)?T(l):(0,r.ze)(0),h=(o.left+d.x)/c.x,f=(o.top+d.y)/c.y,p=o.width/c.x,m=o.height/c.y;if(l){let e=s(l),t=n&&u(n)?s(n):n,i=e.frameElement;for(;i&&n&&t!==e;){let e=S(i),t=i.getBoundingClientRect(),r=g(i),n=t.left+(i.clientLeft+parseFloat(r.paddingLeft))*e.x,a=t.top+(i.clientTop+parseFloat(r.paddingTop))*e.y;h*=e.x,f*=e.y,p*=e.x,m*=e.y,h+=n,f+=a,i=s(i).frameElement}}return(0,r.JB)({width:p,height:m,x:h,y:f})}function A(e){return w(o(e)).left+v(e).scrollLeft}function M(e,t,i){let n;if("viewport"===t)n=function(e,t){let i=s(e),r=o(e),n=i.visualViewport,a=r.clientWidth,l=r.clientHeight,u=0,c=0;if(n){a=n.width,l=n.height;let e=p();(!e||e&&"fixed"===t)&&(u=n.offsetLeft,c=n.offsetTop)}return{width:a,height:l,x:u,y:c}}(e,i);else if("document"===t)n=function(e){let t=o(e),i=v(e),n=e.ownerDocument.body,a=(0,r.Fp)(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),s=(0,r.Fp)(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight),l=-i.scrollLeft+A(e),u=-i.scrollTop;return"rtl"===g(n).direction&&(l+=(0,r.Fp)(t.clientWidth,n.clientWidth)-a),{width:a,height:s,x:l,y:u}}(o(e));else if(u(t))n=function(e,t){let i=w(e,!0,"fixed"===t),n=i.top+e.clientTop,a=i.left+e.clientLeft,s=c(e)?S(e):(0,r.ze)(1),o=e.clientWidth*s.x,l=e.clientHeight*s.y,u=a*s.x,d=n*s.y;return{width:o,height:l,x:u,y:d}}(t,i);else{let i=T(e);n={...t,x:t.x-i.x,y:t.y-i.y}}return(0,r.JB)(n)}function R(e,t){return c(e)&&"fixed"!==g(e).position?t?t(e):e.offsetParent:null}function C(e,t){let i=s(e);if(!c(e))return i;let r=R(e,t);for(;r&&["table","td","th"].includes(a(r))&&"static"===g(r).position;)r=R(r,t);return r&&("html"===a(r)||"body"===a(r)&&"static"===g(r).position&&!f(r))?i:r||function(e){let t=y(e);for(;c(t)&&!m(t);){if(f(t))return t;t=y(t)}return null}(e)||i}let I=async function(e){let{reference:t,floating:i,strategy:n}=e,s=this.getOffsetParent||C,l=this.getDimensions;return{reference:function(e,t,i){let n=c(t),s=o(t),l="fixed"===i,u=w(e,!0,l,t),d={scrollLeft:0,scrollTop:0},f=(0,r.ze)(0);if(n||!n&&!l){if(("body"!==a(t)||h(s))&&(d=v(t)),n){let e=w(t,!0,l,t);f.x=e.x+t.clientLeft,f.y=e.y+t.clientTop}else s&&(f.x=A(s))}return{x:u.left+d.scrollLeft-f.x,y:u.top+d.scrollTop-f.y,width:u.width,height:u.height}}(t,await s(i),n),floating:{x:0,y:0,...await l(i)}}},L={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:i,strategy:n}=e,s=c(i),l=o(i);if(i===l)return t;let u={scrollLeft:0,scrollTop:0},d=(0,r.ze)(1),f=(0,r.ze)(0);if((s||!s&&"fixed"!==n)&&(("body"!==a(i)||h(l))&&(u=v(i)),c(i))){let e=w(i);d=S(i),f.x=e.x+i.clientLeft,f.y=e.y+i.clientTop}return{width:t.width*d.x,height:t.height*d.y,x:t.x*d.x-u.scrollLeft*d.x+f.x,y:t.y*d.y-u.scrollTop*d.y+f.y}},getDocumentElement:o,getClippingRect:function(e){let{element:t,boundary:i,rootBoundary:n,strategy:s}=e,o="clippingAncestors"===i?function(e,t){let i=t.get(e);if(i)return i;let r=b(e,[],!1).filter(e=>u(e)&&"body"!==a(e)),n=null,s="fixed"===g(e).position,o=s?y(e):e;for(;u(o)&&!m(o);){let t=g(o),i=f(o);i||"fixed"!==t.position||(n=null);let a=s?!i&&!n:!i&&"static"===t.position&&!!n&&["absolute","fixed"].includes(n.position)||h(o)&&!i&&function e(t,i){let r=y(t);return!(r===i||!u(r)||m(r))&&("fixed"===g(r).position||e(r,i))}(e,o);a?r=r.filter(e=>e!==o):n=t,o=y(o)}return t.set(e,r),r}(t,this._c):[].concat(i),l=[...o,n],c=l[0],d=l.reduce((e,i)=>{let n=M(t,i,s);return e.top=(0,r.Fp)(n.top,e.top),e.right=(0,r.VV)(n.right,e.right),e.bottom=(0,r.VV)(n.bottom,e.bottom),e.left=(0,r.Fp)(n.left,e.left),e},M(t,c,s));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}},getOffsetParent:C,getElementRects:I,getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){return _(e)},getScale:S,isElement:u,isRTL:function(e){return"rtl"===g(e).direction}};function k(e,t,i,n){let a;void 0===n&&(n={});let{ancestorScroll:s=!0,ancestorResize:l=!0,elementResize:u="function"==typeof ResizeObserver,layoutShift:c="function"==typeof IntersectionObserver,animationFrame:d=!1}=n,h=E(e),f=s||l?[...h?b(h):[],...b(t)]:[];f.forEach(e=>{s&&e.addEventListener("scroll",i,{passive:!0}),l&&e.addEventListener("resize",i)});let p=h&&c?function(e,t){let i,n=null,a=o(e);function s(){clearTimeout(i),n&&n.disconnect(),n=null}return!function o(l,u){void 0===l&&(l=!1),void 0===u&&(u=1),s();let{left:c,top:d,width:h,height:f}=e.getBoundingClientRect();if(l||t(),!h||!f)return;let p=(0,r.GW)(d),m=(0,r.GW)(a.clientWidth-(c+h)),g=(0,r.GW)(a.clientHeight-(d+f)),v=(0,r.GW)(c),y={rootMargin:-p+"px "+-m+"px "+-g+"px "+-v+"px",threshold:(0,r.Fp)(0,(0,r.VV)(1,u))||1},b=!0;function _(e){let t=e[0].intersectionRatio;if(t!==u){if(!b)return o();t?o(!1,t):i=setTimeout(()=>{o(!1,1e-7)},100)}b=!1}try{n=new IntersectionObserver(_,{...y,root:a.ownerDocument})}catch(e){n=new IntersectionObserver(_,y)}n.observe(e)}(!0),s}(h,i):null,m=-1,g=null;u&&(g=new ResizeObserver(e=>{let[r]=e;r&&r.target===h&&g&&(g.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{g&&g.observe(t)})),i()}),h&&!d&&g.observe(h),g.observe(t));let v=d?w(e):null;return d&&function t(){let r=w(e);v&&(r.x!==v.x||r.y!==v.y||r.width!==v.width||r.height!==v.height)&&i(),v=r,a=requestAnimationFrame(t)}(),i(),()=>{f.forEach(e=>{s&&e.removeEventListener("scroll",i),l&&e.removeEventListener("resize",i)}),p&&p(),g&&g.disconnect(),g=null,d&&cancelAnimationFrame(a)}}let D=(e,t,i)=>{let r=new Map,a={platform:L,...i},s={...a.platform,_c:r};return(0,n.oo)(e,t,{...a,platform:s})}},56029:function(e,t,i){"use strict";i.d(t,{Fp:function(){return a},GW:function(){return o},I4:function(){return g},JB:function(){return w},KX:function(){return S},NM:function(){return s},Qq:function(){return v},Rn:function(){return m},VV:function(){return n},Wh:function(){return y},gy:function(){return _},hp:function(){return p},i8:function(){return b},k3:function(){return f},ku:function(){return h},mA:function(){return r},pw:function(){return x},uZ:function(){return d},yd:function(){return T},ze:function(){return l}});let r=["top","right","bottom","left"],n=Math.min,a=Math.max,s=Math.round,o=Math.floor,l=e=>({x:e,y:e}),u={left:"right",right:"left",bottom:"top",top:"bottom"},c={start:"end",end:"start"};function d(e,t,i){return a(e,n(t,i))}function h(e,t){return"function"==typeof e?e(t):e}function f(e){return e.split("-")[0]}function p(e){return e.split("-")[1]}function m(e){return"x"===e?"y":"x"}function g(e){return"y"===e?"height":"width"}function v(e){return["top","bottom"].includes(f(e))?"y":"x"}function y(e){return m(v(e))}function b(e,t,i){void 0===i&&(i=!1);let r=p(e),n=y(e),a=g(n),s="x"===n?r===(i?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[a]>t.floating[a]&&(s=x(s)),[s,x(s)]}function _(e){let t=x(e);return[E(e),t,E(t)]}function E(e){return e.replace(/start|end/g,e=>c[e])}function S(e,t,i,r){let n=p(e),a=function(e,t,i){let r=["left","right"],n=["right","left"];switch(e){case"top":case"bottom":if(i)return t?n:r;return t?r:n;case"left":case"right":return t?["top","bottom"]:["bottom","top"];default:return[]}}(f(e),"start"===i,r);return n&&(a=a.map(e=>e+"-"+n),t&&(a=a.concat(a.map(E)))),a}function x(e){return e.replace(/left|right|bottom|top/g,e=>u[e])}function T(e){return"number"!=typeof e?{top:0,right:0,bottom:0,left:0,...e}:{top:e,right:e,bottom:e,left:e}}function w(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}},18678:function(e,t,i){"use strict";i.d(t,{q_:function(){return t1}});var r,n,a,s=i(13214),o=i(50959),l=Object.defineProperty,u={};((e,t)=>{for(var i in t)l(e,i,{get:t[i],enumerable:!0})})(u,{assign:()=>z,colors:()=>F,createStringInterpolator:()=>r,skipAnimation:()=>B,to:()=>n,willAdvance:()=>V});var c=A(),d=e=>S(e,c),h=A();d.write=e=>S(e,h);var f=A();d.onStart=e=>S(e,f);var p=A();d.onFrame=e=>S(e,p);var m=A();d.onFinish=e=>S(e,m);var g=[];d.setTimeout=(e,t)=>{let i=d.now()+t,r=()=>{let e=g.findIndex(e=>e.cancel==r);~e&&g.splice(e,1),_-=~e?1:0},n={time:i,handler:e,cancel:r};return g.splice(v(i),0,n),_+=1,x(),n};var v=e=>~(~g.findIndex(t=>t.time>e)||~g.length);d.cancel=e=>{f.delete(e),p.delete(e),m.delete(e),c.delete(e),h.delete(e)},d.sync=e=>{E=!0,d.batchedUpdates(e),E=!1},d.throttle=e=>{let t;function i(){try{e(...t)}finally{t=null}}function r(...e){t=e,d.onStart(i)}return r.handler=e,r.cancel=()=>{f.delete(i),t=null},r};var y="undefined"!=typeof window?window.requestAnimationFrame:()=>{};d.use=e=>y=e,d.now="undefined"!=typeof performance?()=>performance.now():Date.now,d.batchedUpdates=e=>e(),d.catch=console.error,d.frameLoop="always",d.advance=()=>{"demand"!==d.frameLoop?console.warn("Cannot call the manual advancement of rafz whilst frameLoop is not set as demand"):w()};var b=-1,_=0,E=!1;function S(e,t){E?(t.delete(e),e(0)):(t.add(e),x())}function x(){b<0&&(b=0,"demand"!==d.frameLoop&&y(T))}function T(){~b&&(y(T),d.batchedUpdates(w))}function w(){let e=b;b=d.now();let t=v(b);if(t&&(M(g.splice(0,t),e=>e.handler()),_-=t),!_){b=-1;return}f.flush(),c.flush(e?Math.min(64,b-e):16.667),p.flush(),h.flush(),m.flush()}function A(){let e=new Set,t=e;return{add(i){_+=t!=e||e.has(i)?0:1,e.add(i)},delete:i=>(_-=t==e&&e.has(i)?1:0,e.delete(i)),flush(i){t.size&&(e=new Set,_-=t.size,M(t,t=>t(i)&&e.add(t)),_+=e.size,t=e)}}}function M(e,t){e.forEach(e=>{try{t(e)}catch(e){d.catch(e)}})}function R(){}var C=(e,t,i)=>Object.defineProperty(e,t,{value:i,writable:!0,configurable:!0}),I={arr:Array.isArray,obj:e=>!!e&&"Object"===e.constructor.name,fun:e=>"function"==typeof e,str:e=>"string"==typeof e,num:e=>"number"==typeof e,und:e=>void 0===e};function L(e,t){if(I.arr(e)){if(!I.arr(t)||e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}return e===t}var k=(e,t)=>e.forEach(t);function D(e,t,i){if(I.arr(e)){for(let r=0;r<e.length;r++)t.call(i,e[r],`${r}`);return}for(let r in e)e.hasOwnProperty(r)&&t.call(i,e[r],r)}var P=e=>I.und(e)?[]:I.arr(e)?e:[e];function O(e,t){if(e.size){let i=Array.from(e);e.clear(),k(i,t)}}var N=(e,...t)=>O(e,e=>e(...t)),U=()=>"undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),F=null,B=!1,V=R,z=e=>{e.to&&(n=e.to),e.now&&(d.now=e.now),void 0!==e.colors&&(F=e.colors),null!=e.skipAnimation&&(B=e.skipAnimation),e.createStringInterpolator&&(r=e.createStringInterpolator),e.requestAnimationFrame&&d.use(e.requestAnimationFrame),e.batchedUpdates&&(d.batchedUpdates=e.batchedUpdates),e.willAdvance&&(V=e.willAdvance),e.frameLoop&&(d.frameLoop=e.frameLoop)},j=new Set,H=[],G=[],W=0,$={get idle(){return!j.size&&!H.length},start(e){W>e.priority?(j.add(e),d.onStart(q)):(Y(e),d(X))},advance:X,sort(e){if(W)d.onFrame(()=>$.sort(e));else{let t=H.indexOf(e);~t&&(H.splice(t,1),K(e))}},clear(){H=[],j.clear()}};function q(){j.forEach(Y),j.clear(),d(X)}function Y(e){H.includes(e)||K(e)}function K(e){H.splice(function(e,t){let i=e.findIndex(t);return i<0?e.length:i}(H,t=>t.priority>e.priority),0,e)}function X(e){let t=G;for(let i=0;i<H.length;i++){let r=H[i];W=r.priority,r.idle||(V(r),r.advance(e),r.idle||t.push(r))}return W=0,(G=H).length=0,(H=t).length>0}var Z="[-+]?\\d*\\.?\\d+",J=Z+"%";function Q(...e){return"\\(\\s*("+e.join(")\\s*,\\s*(")+")\\s*\\)"}var ee=RegExp("rgb"+Q(Z,Z,Z)),et=RegExp("rgba"+Q(Z,Z,Z,Z)),ei=RegExp("hsl"+Q(Z,J,J)),er=RegExp("hsla"+Q(Z,J,J,Z)),en=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,ea=/^#([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,es=/^#([0-9a-fA-F]{6})$/,eo=/^#([0-9a-fA-F]{8})$/;function el(e,t,i){return(i<0&&(i+=1),i>1&&(i-=1),i<1/6)?e+(t-e)*6*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}function eu(e,t,i){let r=i<.5?i*(1+t):i+t-i*t,n=2*i-r,a=el(n,r,e+1/3),s=el(n,r,e),o=el(n,r,e-1/3);return Math.round(255*a)<<24|Math.round(255*s)<<16|Math.round(255*o)<<8}function ec(e){let t=parseInt(e,10);return t<0?0:t>255?255:t}function ed(e){let t=parseFloat(e);return(t%360+360)%360/360}function eh(e){let t=parseFloat(e);return t<0?0:t>1?255:Math.round(255*t)}function ef(e){let t=parseFloat(e);return t<0?0:t>100?1:t/100}function ep(e){let t;let i="number"==typeof e?e>>>0===e&&e>=0&&e<=4294967295?e:null:(t=es.exec(e))?parseInt(t[1]+"ff",16)>>>0:F&&void 0!==F[e]?F[e]:(t=ee.exec(e))?(ec(t[1])<<24|ec(t[2])<<16|ec(t[3])<<8|255)>>>0:(t=et.exec(e))?(ec(t[1])<<24|ec(t[2])<<16|ec(t[3])<<8|eh(t[4]))>>>0:(t=en.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+"ff",16)>>>0:(t=eo.exec(e))?parseInt(t[1],16)>>>0:(t=ea.exec(e))?parseInt(t[1]+t[1]+t[2]+t[2]+t[3]+t[3]+t[4]+t[4],16)>>>0:(t=ei.exec(e))?(255|eu(ed(t[1]),ef(t[2]),ef(t[3])))>>>0:(t=er.exec(e))?(eu(ed(t[1]),ef(t[2]),ef(t[3]))|eh(t[4]))>>>0:null;if(null===i)return e;i=i||0;let r=(4278190080&i)>>>24,n=(16711680&i)>>>16,a=(65280&i)>>>8,s=(255&i)/255;return`rgba(${r}, ${n}, ${a}, ${s})`}var em=(e,t,i)=>{if(I.fun(e))return e;if(I.arr(e))return em({range:e,output:t,extrapolate:i});if(I.str(e.output[0]))return r(e);let n=e.output,a=e.range||[0,1],s=e.extrapolateLeft||e.extrapolate||"extend",o=e.extrapolateRight||e.extrapolate||"extend",l=e.easing||(e=>e);return t=>{let i=function(e,t){for(var i=1;i<t.length-1&&!(t[i]>=e);++i);return i-1}(t,a);return function(e,t,i,r,n,a,s,o,l){let u=l?l(e):e;if(u<t){if("identity"===s)return u;"clamp"===s&&(u=t)}if(u>i){if("identity"===o)return u;"clamp"===o&&(u=i)}return r===n?r:t===i?e<=t?r:n:(t===-1/0?u=-u:i===1/0?u-=t:u=(u-t)/(i-t),u=a(u),r===-1/0?u=-u:n===1/0?u+=r:u=u*(n-r)+r,u)}(t,a[i],a[i+1],n[i],n[i+1],l,s,o,e.map)}},eg=Symbol.for("FluidValue.get"),ev=Symbol.for("FluidValue.observers"),ey=e=>!!(e&&e[eg]),eb=e=>e&&e[eg]?e[eg]():e,e_=e=>e[ev]||null;function eE(e,t){let i=e[ev];i&&i.forEach(e=>{e.eventObserved?e.eventObserved(t):e(t)})}var eS=class{constructor(e){if(!e&&!(e=this.get))throw Error("Unknown getter");ex(this,e)}},ex=(e,t)=>eA(e,eg,t);function eT(e,t){if(e[eg]){let i=e[ev];i||eA(e,ev,i=new Set),!i.has(t)&&(i.add(t),e.observerAdded&&e.observerAdded(i.size,t))}return t}function ew(e,t){let i=e[ev];if(i&&i.has(t)){let r=i.size-1;r?i.delete(t):e[ev]=null,e.observerRemoved&&e.observerRemoved(r,t)}}var eA=(e,t,i)=>Object.defineProperty(e,t,{value:i,writable:!0,configurable:!0}),eM=/[+\-]?(?:0|[1-9]\d*)(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,eR=/(#(?:[0-9a-f]{2}){2,4}|(#[0-9a-f]{3})|(rgb|hsl)a?\((-?\d+%?[,\s]+){2,3}\s*[\d\.]+%?\))/gi,eC=RegExp(`(${eM.source})(%|[a-z]+)`,"i"),eI=/rgba\(([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+), ([0-9\.-]+)\)/gi,eL=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/,ek=e=>{let[t,i]=eD(e);if(!t||U())return e;let r=window.getComputedStyle(document.documentElement).getPropertyValue(t);if(r)return r.trim();if(i&&i.startsWith("--")){let e=window.getComputedStyle(document.documentElement).getPropertyValue(i);if(e)return e}else if(i&&eL.test(i))return ek(i);else if(i)return i;return e},eD=e=>{let t=eL.exec(e);if(!t)return[,];let[,i,r]=t;return[i,r]},eP=(e,t,i,r,n)=>`rgba(${Math.round(t)}, ${Math.round(i)}, ${Math.round(r)}, ${n})`,eO=e=>{a||(a=F?RegExp(`(${Object.keys(F).join("|")})(?!\\w)`,"g"):/^\b$/);let t=e.output.map(e=>eb(e).replace(eL,ek).replace(eR,ep).replace(a,ep)),i=t.map(e=>e.match(eM).map(Number)),r=i[0].map((e,t)=>i.map(e=>{if(!(t in e))throw Error('The arity of each "output" value must be equal');return e[t]})),n=r.map(t=>em({...e,output:t}));return e=>{let i=!eC.test(t[0])&&t.find(e=>eC.test(e))?.replace(eM,""),r=0;return t[0].replace(eM,()=>`${n[r++](e)}${i||""}`).replace(eI,eP)}},eN="react-spring: ",eU=e=>{let t=!1;if("function"!=typeof e)throw TypeError(`${eN}once requires a function parameter`);return(...i)=>{t||(e(...i),t=!0)}},eF=eU(console.warn),eB=eU(console.warn);function eV(e){return I.str(e)&&("#"==e[0]||/\d/.test(e)||!U()&&eL.test(e)||e in(F||{}))}var ez=U()?o.useEffect:o.useLayoutEffect,ej=()=>{let e=(0,o.useRef)(!1);return ez(()=>(e.current=!0,()=>{e.current=!1}),[]),e};function eH(){let e=(0,o.useState)()[1],t=ej();return()=>{t.current&&e(Math.random())}}var eG=e=>(0,o.useEffect)(e,eW),eW=[];function e$(e){let t=(0,o.useRef)();return(0,o.useEffect)(()=>{t.current=e}),t.current}var eq=Symbol.for("Animated:node"),eY=e=>!!e&&e[eq]===e,eK=e=>e&&e[eq],eX=(e,t)=>C(e,eq,t),eZ=e=>e&&e[eq]&&e[eq].getPayload(),eJ=class{constructor(){eX(this,this)}getPayload(){return this.payload||[]}},eQ=class extends eJ{constructor(e){super(),this._value=e,this.done=!0,this.durationProgress=0,I.num(this._value)&&(this.lastPosition=this._value)}static create(e){return new eQ(e)}getPayload(){return[this]}getValue(){return this._value}setValue(e,t){return I.num(e)&&(this.lastPosition=e,t&&(e=Math.round(e/t)*t,this.done&&(this.lastPosition=e))),this._value!==e&&(this._value=e,!0)}reset(){let{done:e}=this;this.done=!1,I.num(this._value)&&(this.elapsedTime=0,this.durationProgress=0,this.lastPosition=this._value,e&&(this.lastVelocity=null),this.v0=null)}},e0=class extends eQ{constructor(e){super(0),this._string=null,this._toString=em({output:[e,e]})}static create(e){return new e0(e)}getValue(){let e=this._string;return null==e?this._string=this._toString(this._value):e}setValue(e){if(I.str(e)){if(e==this._string)return!1;this._string=e,this._value=1}else{if(!super.setValue(e))return!1;this._string=null}return!0}reset(e){e&&(this._toString=em({output:[this.getValue(),e]})),this._value=0,super.reset()}},e1={dependencies:null},e2=class extends eJ{constructor(e){super(),this.source=e,this.setValue(e)}getValue(e){let t={};return D(this.source,(i,r)=>{eY(i)?t[r]=i.getValue(e):ey(i)?t[r]=eb(i):e||(t[r]=i)}),t}setValue(e){this.source=e,this.payload=this._makePayload(e)}reset(){this.payload&&k(this.payload,e=>e.reset())}_makePayload(e){if(e){let t=new Set;return D(e,this._addToPayload,t),Array.from(t)}}_addToPayload(e){e1.dependencies&&ey(e)&&e1.dependencies.add(e);let t=eZ(e);t&&k(t,e=>this.add(e))}},e3=class extends e2{constructor(e){super(e)}static create(e){return new e3(e)}getValue(){return this.source.map(e=>e.getValue())}setValue(e){let t=this.getPayload();return e.length==t.length?t.map((t,i)=>t.setValue(e[i])).some(Boolean):(super.setValue(e.map(e5)),!0)}};function e5(e){let t=eV(e)?e0:eQ;return t.create(e)}function e4(e){let t=eK(e);return t?t.constructor:I.arr(e)?e3:eV(e)?e0:eQ}var e6=(e,t)=>{let i=!I.fun(e)||e.prototype&&e.prototype.isReactComponent;return(0,o.forwardRef)((r,n)=>{let a=(0,o.useRef)(null),s=i&&(0,o.useCallback)(e=>{a.current=(n&&(I.fun(n)?n(e):n.current=e),e)},[n]),[l,u]=function(e,t){let i=new Set;return e1.dependencies=i,e.style&&(e={...e,style:t.createAnimatedStyle(e.style)}),e=new e2(e),e1.dependencies=null,[e,i]}(r,t),c=eH(),h=()=>{let e=a.current;if(i&&!e)return;let r=!!e&&t.applyAnimatedValues(e,l.getValue(!0));!1===r&&c()},f=new e8(h,u),p=(0,o.useRef)();ez(()=>(p.current=f,k(u,e=>eT(e,f)),()=>{p.current&&(k(p.current.deps,e=>ew(e,p.current)),d.cancel(p.current.update))})),(0,o.useEffect)(h,[]),eG(()=>()=>{let e=p.current;k(e.deps,t=>ew(t,e))});let m=t.getComponentProps(l.getValue());return o.createElement(e,{...m,ref:s})})},e8=class{constructor(e,t){this.update=e,this.deps=t}eventObserved(e){"change"==e.type&&d.write(this.update)}},e7=Symbol.for("AnimatedComponent"),e9=e=>I.str(e)?e:e&&I.str(e.displayName)?e.displayName:I.fun(e)&&e.name||null;function te(e,...t){return I.fun(e)?e(...t):e}var tt=(e,t)=>!0===e||!!(t&&e&&(I.fun(e)?e(t):P(e).includes(t))),ti=(e,t)=>I.obj(e)?t&&e[t]:e,tr=(e,t)=>!0===e.default?e[t]:e.default?e.default[t]:void 0,tn=e=>e,ta=(e,t=tn)=>{let i=ts;e.default&&!0!==e.default&&(i=Object.keys(e=e.default));let r={};for(let n of i){let i=t(e[n],n);I.und(i)||(r[n]=i)}return r},ts=["config","onProps","onStart","onChange","onPause","onResume","onRest"],to={config:1,from:1,to:1,ref:1,loop:1,reset:1,pause:1,cancel:1,reverse:1,immediate:1,default:1,delay:1,onProps:1,onStart:1,onChange:1,onPause:1,onResume:1,onRest:1,onResolve:1,items:1,trail:1,sort:1,expires:1,initial:1,enter:1,update:1,leave:1,children:1,onDestroyed:1,keys:1,callId:1,parentId:1};function tl(e){let t=function(e){let t={},i=0;if(D(e,(e,r)=>{!to[r]&&(t[r]=e,i++)}),i)return t}(e);if(t){let i={to:t};return D(e,(e,r)=>r in t||(i[r]=e)),i}return{...e}}function tu(e){return e=eb(e),I.arr(e)?e.map(tu):eV(e)?u.createStringInterpolator({range:[0,1],output:[e,e]})(1):e}function tc(e){return I.fun(e)||I.arr(e)&&I.obj(e[0])}var td={tension:170,friction:26,mass:1,damping:1,easing:e=>e,clamp:!1},th=class{constructor(){this.velocity=0,Object.assign(this,td)}};function tf(e,t){if(I.und(t.decay)){let i=!I.und(t.tension)||!I.und(t.friction);!i&&I.und(t.frequency)&&I.und(t.damping)&&I.und(t.mass)||(e.duration=void 0,e.decay=void 0),i&&(e.frequency=void 0)}else e.duration=void 0}var tp=[],tm=class{constructor(){this.changed=!1,this.values=tp,this.toValues=null,this.fromValues=tp,this.config=new th,this.immediate=!1}};function tg(e,{key:t,props:i,defaultProps:r,state:n,actions:a}){return new Promise((s,o)=>{let l,c;let h=tt(i.cancel??r?.cancel,t);if(h)m();else{I.und(i.pause)||(n.paused=tt(i.pause,t));let e=r?.pause;!0!==e&&(e=n.paused||tt(e,t)),l=te(i.delay||0,t),e?(n.resumeQueue.add(p),a.pause()):(a.resume(),p())}function f(){n.resumeQueue.add(p),n.timeouts.delete(c),c.cancel(),l=c.time-d.now()}function p(){l>0&&!u.skipAnimation?(n.delayed=!0,c=d.setTimeout(m,l),n.pauseQueue.add(f),n.timeouts.add(c)):m()}function m(){n.delayed&&(n.delayed=!1),n.pauseQueue.delete(f),n.timeouts.delete(c),e<=(n.cancelId||0)&&(h=!0);try{a.start({...i,callId:e,cancel:h},s)}catch(e){o(e)}}})}var tv=(e,t)=>1==t.length?t[0]:t.some(e=>e.cancelled)?t_(e.get()):t.every(e=>e.noop)?ty(e.get()):tb(e.get(),t.every(e=>e.finished)),ty=e=>({value:e,noop:!0,finished:!0,cancelled:!1}),tb=(e,t,i=!1)=>({value:e,finished:t,cancelled:i}),t_=e=>({value:e,cancelled:!0,finished:!1});function tE(e,t,i,r){let{callId:n,parentId:a,onRest:s}=t,{asyncTo:o,promise:l}=i;return a||e!==o||t.reset?i.promise=(async()=>{let c,h,f;i.asyncId=n,i.asyncTo=e;let p=ta(t,(e,t)=>"onRest"===t?void 0:e),m=new Promise((e,t)=>(c=e,h=t)),g=e=>{let t=n<=(i.cancelId||0)&&t_(r)||n!==i.asyncId&&tb(r,!1);if(t)throw e.result=t,h(e),e},v=(e,t)=>{let a=new tx,s=new tT;return(async()=>{if(u.skipAnimation)throw tS(i),s.result=tb(r,!1),h(s),s;g(a);let o=I.obj(e)?{...e}:{...t,to:e};o.parentId=n,D(p,(e,t)=>{I.und(o[t])&&(o[t]=e)});let l=await r.start(o);return g(a),i.paused&&await new Promise(e=>{i.resumeQueue.add(e)}),l})()};if(u.skipAnimation)return tS(i),tb(r,!1);try{let t;t=I.arr(e)?(async e=>{for(let t of e)await v(t)})(e):Promise.resolve(e(v,r.stop.bind(r))),await Promise.all([t.then(c),m]),f=tb(r.get(),!0,!1)}catch(e){if(e instanceof tx)f=e.result;else if(e instanceof tT)f=e.result;else throw e}finally{n==i.asyncId&&(i.asyncId=a,i.asyncTo=a?o:void 0,i.promise=a?l:void 0)}return I.fun(s)&&d.batchedUpdates(()=>{s(f,r,r.item)}),f})():l}function tS(e,t){O(e.timeouts,e=>e.cancel()),e.pauseQueue.clear(),e.resumeQueue.clear(),e.asyncId=e.asyncTo=e.promise=void 0,t&&(e.cancelId=t)}var tx=class extends Error{constructor(){super("An async animation has been interrupted. You see this error because you forgot to use `await` or `.catch(...)` on its returned promise.")}},tT=class extends Error{constructor(){super("SkipAnimationSignal")}},tw=e=>e instanceof tM,tA=1,tM=class extends eS{constructor(){super(...arguments),this.id=tA++,this._priority=0}get priority(){return this._priority}set priority(e){this._priority!=e&&(this._priority=e,this._onPriorityChange(e))}get(){let e=eK(this);return e&&e.getValue()}to(...e){return u.to(this,e)}interpolate(...e){return eF(`${eN}The "interpolate" function is deprecated in v9 (use "to" instead)`),u.to(this,e)}toJSON(){return this.get()}observerAdded(e){1==e&&this._attach()}observerRemoved(e){0==e&&this._detach()}_attach(){}_detach(){}_onChange(e,t=!1){eE(this,{type:"change",parent:this,value:e,idle:t})}_onPriorityChange(e){this.idle||$.sort(this),eE(this,{type:"priority",parent:this,priority:e})}},tR=Symbol.for("SpringPhase"),tC=e=>(1&e[tR])>0,tI=e=>(2&e[tR])>0,tL=e=>(4&e[tR])>0,tk=(e,t)=>t?e[tR]|=3:e[tR]&=-3,tD=(e,t)=>t?e[tR]|=4:e[tR]&=-5,tP=class extends tM{constructor(e,t){if(super(),this.animation=new tm,this.defaultProps={},this._state={paused:!1,delayed:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._pendingCalls=new Set,this._lastCallId=0,this._lastToId=0,this._memoizedDuration=0,!I.und(e)||!I.und(t)){let i=I.obj(e)?{...e}:{...t,from:e};I.und(i.default)&&(i.default=!0),this.start(i)}}get idle(){return!(tI(this)||this._state.asyncTo)||tL(this)}get goal(){return eb(this.animation.to)}get velocity(){let e=eK(this);return e instanceof eQ?e.lastVelocity||0:e.getPayload().map(e=>e.lastVelocity||0)}get hasAnimated(){return tC(this)}get isAnimating(){return tI(this)}get isPaused(){return tL(this)}get isDelayed(){return this._state.delayed}advance(e){let t=!0,i=!1,r=this.animation,{toValues:n}=r,{config:a}=r,s=eZ(r.to);!s&&ey(r.to)&&(n=P(eb(r.to))),r.values.forEach((o,l)=>{if(o.done)return;let u=o.constructor==e0?1:s?s[l].lastPosition:n[l],c=r.immediate,d=u;if(!c){let t;if(d=o.lastPosition,a.tension<=0){o.done=!0;return}let i=o.elapsedTime+=e,n=r.fromValues[l],s=null!=o.v0?o.v0:o.v0=I.arr(a.velocity)?a.velocity[l]:a.velocity,h=a.precision||(n==u?.005:Math.min(1,.001*Math.abs(u-n)));if(I.und(a.duration)){if(a.decay){let e=!0===a.decay?.998:a.decay,r=Math.exp(-(1-e)*i);d=n+s/(1-e)*(1-r),c=Math.abs(o.lastPosition-d)<=h,t=s*r}else{t=null==o.lastVelocity?s:o.lastVelocity;let i=a.restVelocity||h/10,r=a.clamp?0:a.bounce,l=!I.und(r),f=n==u?o.v0>0:n<u,p=Math.ceil(e/1);for(let e=0;e<p&&!(!(Math.abs(t)>i)&&(c=Math.abs(u-d)<=h));++e){l&&(d==u||d>u==f)&&(t=-t*r,d=u);let e=-(1e-6*a.tension)*(d-u),i=-(.001*a.friction)*t,n=(e+i)/a.mass;t+=1*n,d+=1*t}}}else{let r=1;a.duration>0&&(this._memoizedDuration!==a.duration&&(this._memoizedDuration=a.duration,o.durationProgress>0&&(o.elapsedTime=a.duration*o.durationProgress,i=o.elapsedTime+=e)),r=(r=(a.progress||0)+i/this._memoizedDuration)>1?1:r<0?0:r,o.durationProgress=r),t=((d=n+a.easing(r)*(u-n))-o.lastPosition)/e,c=1==r}o.lastVelocity=t,Number.isNaN(d)&&(console.warn("Got NaN while animating:",this),c=!0)}s&&!s[l].done&&(c=!1),c?o.done=!0:t=!1,o.setValue(d,a.round)&&(i=!0)});let o=eK(this),l=o.getValue();if(t){let e=eb(r.to);(l!==e||i)&&!a.decay?(o.setValue(e),this._onChange(e)):i&&a.decay&&this._onChange(l),this._stop()}else i&&this._onChange(l)}set(e){return d.batchedUpdates(()=>{this._stop(),this._focus(e),this._set(e)}),this}pause(){this._update({pause:!0})}resume(){this._update({pause:!1})}finish(){if(tI(this)){let{to:e,config:t}=this.animation;d.batchedUpdates(()=>{this._onStart(),t.decay||this._set(e,!1),this._stop()})}return this}update(e){let t=this.queue||(this.queue=[]);return t.push(e),this}start(e,t){let i;return I.und(e)?(i=this.queue||[],this.queue=[]):i=[I.obj(e)?e:{...t,to:e}],Promise.all(i.map(e=>{let t=this._update(e);return t})).then(e=>tv(this,e))}stop(e){let{to:t}=this.animation;return this._focus(this.get()),tS(this._state,e&&this._lastCallId),d.batchedUpdates(()=>this._stop(t,e)),this}reset(){this._update({reset:!0})}eventObserved(e){"change"==e.type?this._start():"priority"==e.type&&(this.priority=e.priority+1)}_prepareNode(e){let t=this.key||"",{to:i,from:r}=e;(null==(i=I.obj(i)?i[t]:i)||tc(i))&&(i=void 0),null==(r=I.obj(r)?r[t]:r)&&(r=void 0);let n={to:i,from:r};return tC(this)||(e.reverse&&([i,r]=[r,i]),r=eb(r),I.und(r)?eK(this)||this._set(i):this._set(r)),n}_update({...e},t){let{key:i,defaultProps:r}=this;e.default&&Object.assign(r,ta(e,(e,t)=>/^on/.test(t)?ti(e,i):e)),tV(this,e,"onProps"),tz(this,"onProps",e,this);let n=this._prepareNode(e);if(Object.isFrozen(this))throw Error("Cannot animate a `SpringValue` object that is frozen. Did you forget to pass your component to `animated(...)` before animating its props?");let a=this._state;return tg(++this._lastCallId,{key:i,props:e,defaultProps:r,state:a,actions:{pause:()=>{tL(this)||(tD(this,!0),N(a.pauseQueue),tz(this,"onPause",tb(this,tO(this,this.animation.to)),this))},resume:()=>{tL(this)&&(tD(this,!1),tI(this)&&this._resume(),N(a.resumeQueue),tz(this,"onResume",tb(this,tO(this,this.animation.to)),this))},start:this._merge.bind(this,n)}}).then(i=>{if(e.loop&&i.finished&&!(t&&i.noop)){let t=tN(e);if(t)return this._update(t,!0)}return i})}_merge(e,t,i){if(t.cancel)return this.stop(!0),i(t_(this));let r=!I.und(e.to),n=!I.und(e.from);if(r||n){if(!(t.callId>this._lastToId))return i(t_(this));this._lastToId=t.callId}let{key:a,defaultProps:s,animation:o}=this,{to:l,from:u}=o,{to:c=l,from:h=u}=e;n&&!r&&(!t.default||I.und(c))&&(c=h),t.reverse&&([c,h]=[h,c]);let f=!L(h,u);f&&(o.from=h),h=eb(h);let p=!L(c,l);p&&this._focus(c);let m=tc(t.to),{config:g}=o,{decay:v,velocity:y}=g;(r||n)&&(g.velocity=0),t.config&&!m&&function(e,t,i){for(let r in i&&(tf(i={...i},t),t={...i,...t}),tf(e,t),Object.assign(e,t),td)null==e[r]&&(e[r]=td[r]);let{frequency:r,damping:n}=e,{mass:a}=e;I.und(r)||(r<.01&&(r=.01),n<0&&(n=0),e.tension=Math.pow(2*Math.PI/r,2)*a,e.friction=4*Math.PI*n*a/r)}(g,te(t.config,a),t.config!==s.config?te(s.config,a):void 0);let b=eK(this);if(!b||I.und(c))return i(tb(this,!0));let _=I.und(t.reset)?n&&!t.default:!I.und(h)&&tt(t.reset,a),E=_?h:this.get(),S=tu(c),x=I.num(S)||I.arr(S)||eV(S),T=!m&&(!x||tt(s.immediate||t.immediate,a));if(p){let e=e4(c);if(e!==b.constructor){if(T)b=this._set(S);else throw Error(`Cannot animate between ${b.constructor.name} and ${e.name}, as the "to" prop suggests`)}}let w=b.constructor,A=ey(c),M=!1;if(!A){let e=_||!tC(this)&&f;(p||e)&&(A=!(M=L(tu(E),S))),(L(o.immediate,T)||T)&&L(g.decay,v)&&L(g.velocity,y)||(A=!0)}if(M&&tI(this)&&(o.changed&&!_?A=!0:A||this._stop(l)),!m&&((A||ey(l))&&(o.values=b.getPayload(),o.toValues=ey(c)?null:w==e0?[1]:P(S)),o.immediate==T||(o.immediate=T,T||_||this._set(l)),A)){let{onRest:e}=o;k(tB,e=>tV(this,t,e));let r=tb(this,tO(this,l));N(this._pendingCalls,r),this._pendingCalls.add(i),o.changed&&d.batchedUpdates(()=>{o.changed=!_,e?.(r,this),_?te(s.onRest,r):o.onStart?.(r,this)})}_&&this._set(E),m?i(tE(t.to,t,this._state,this)):A?this._start():tI(this)&&!p?this._pendingCalls.add(i):i(ty(E))}_focus(e){let t=this.animation;e!==t.to&&(e_(this)&&this._detach(),t.to=e,e_(this)&&this._attach())}_attach(){let e=0,{to:t}=this.animation;ey(t)&&(eT(t,this),tw(t)&&(e=t.priority+1)),this.priority=e}_detach(){let{to:e}=this.animation;ey(e)&&ew(e,this)}_set(e,t=!0){let i=eb(e);if(!I.und(i)){let e=eK(this);if(!e||!L(i,e.getValue())){let r=e4(i);e&&e.constructor==r?e.setValue(i):eX(this,r.create(i)),e&&d.batchedUpdates(()=>{this._onChange(i,t)})}}return eK(this)}_onStart(){let e=this.animation;e.changed||(e.changed=!0,tz(this,"onStart",tb(this,tO(this,e.to)),this))}_onChange(e,t){t||(this._onStart(),te(this.animation.onChange,e,this)),te(this.defaultProps.onChange,e,this),super._onChange(e,t)}_start(){let e=this.animation;eK(this).reset(eb(e.to)),e.immediate||(e.fromValues=e.values.map(e=>e.lastPosition)),tI(this)||(tk(this,!0),tL(this)||this._resume())}_resume(){u.skipAnimation?this.finish():$.start(this)}_stop(e,t){if(tI(this)){tk(this,!1);let i=this.animation;k(i.values,e=>{e.done=!0}),i.toValues&&(i.onChange=i.onPause=i.onResume=void 0),eE(this,{type:"idle",parent:this});let r=t?t_(this.get()):tb(this.get(),tO(this,e??i.to));N(this._pendingCalls,r),i.changed&&(i.changed=!1,tz(this,"onRest",r,this))}}};function tO(e,t){let i=tu(t),r=tu(e.get());return L(r,i)}function tN(e,t=e.loop,i=e.to){let r=te(t);if(r){let n=!0!==r&&tl(r),a=(n||e).reverse,s=!n||n.reset;return tU({...e,loop:t,default:!1,pause:void 0,to:!a||tc(i)?i:void 0,from:s?e.from:void 0,reset:s,...n})}}function tU(e){let{to:t,from:i}=e=tl(e),r=new Set;return I.obj(t)&&tF(t,r),I.obj(i)&&tF(i,r),e.keys=r.size?Array.from(r):null,e}function tF(e,t){D(e,(e,i)=>null!=e&&t.add(i))}var tB=["onStart","onRest","onChange","onPause","onResume"];function tV(e,t,i){e.animation[i]=t[i]!==tr(t,i)?ti(t[i],e.key):void 0}function tz(e,t,...i){e.animation[t]?.(...i),e.defaultProps[t]?.(...i)}var tj=["onStart","onChange","onRest"],tH=1,tG=class{constructor(e,t){this.id=tH++,this.springs={},this.queue=[],this._lastAsyncId=0,this._active=new Set,this._changed=new Set,this._started=!1,this._state={paused:!1,pauseQueue:new Set,resumeQueue:new Set,timeouts:new Set},this._events={onStart:new Map,onChange:new Map,onRest:new Map},this._onFrame=this._onFrame.bind(this),t&&(this._flush=t),e&&this.start({default:!0,...e})}get idle(){return!this._state.asyncTo&&Object.values(this.springs).every(e=>e.idle&&!e.isDelayed&&!e.isPaused)}get item(){return this._item}set item(e){this._item=e}get(){let e={};return this.each((t,i)=>e[i]=t.get()),e}set(e){for(let t in e){let i=e[t];I.und(i)||this.springs[t].set(i)}}update(e){return e&&this.queue.push(tU(e)),this}start(e){let{queue:t}=this;return(e?t=P(e).map(tU):this.queue=[],this._flush)?this._flush(this,t):(tZ(this,t),tW(this,t))}stop(e,t){if(!!e!==e&&(t=e),t){let i=this.springs;k(P(t),t=>i[t].stop(!!e))}else tS(this._state,this._lastAsyncId),this.each(t=>t.stop(!!e));return this}pause(e){if(I.und(e))this.start({pause:!0});else{let t=this.springs;k(P(e),e=>t[e].pause())}return this}resume(e){if(I.und(e))this.start({pause:!1});else{let t=this.springs;k(P(e),e=>t[e].resume())}return this}each(e){D(this.springs,e)}_onFrame(){let{onStart:e,onChange:t,onRest:i}=this._events,r=this._active.size>0,n=this._changed.size>0;(r&&!this._started||n&&!this._started)&&(this._started=!0,O(e,([e,t])=>{t.value=this.get(),e(t,this,this._item)}));let a=!r&&this._started,s=n||a&&i.size?this.get():null;n&&t.size&&O(t,([e,t])=>{t.value=s,e(t,this,this._item)}),a&&(this._started=!1,O(i,([e,t])=>{t.value=s,e(t,this,this._item)}))}eventObserved(e){if("change"==e.type)this._changed.add(e.parent),e.idle||this._active.add(e.parent);else{if("idle"!=e.type)return;this._active.delete(e.parent)}d.onFrame(this._onFrame)}};function tW(e,t){return Promise.all(t.map(t=>t$(e,t))).then(t=>tv(e,t))}async function t$(e,t,i){let{keys:r,to:n,from:a,loop:s,onRest:o,onResolve:l}=t,u=I.obj(t.default)&&t.default;s&&(t.loop=!1),!1===n&&(t.to=null),!1===a&&(t.from=null);let c=I.arr(n)||I.fun(n)?n:void 0;c?(t.to=void 0,t.onRest=void 0,u&&(u.onRest=void 0)):k(tj,i=>{let r=t[i];if(I.fun(r)){let n=e._events[i];t[i]=({finished:e,cancelled:t})=>{let i=n.get(r);i?(e||(i.finished=!1),t&&(i.cancelled=!0)):n.set(r,{value:null,finished:e||!1,cancelled:t||!1})},u&&(u[i]=t[i])}});let h=e._state;!h.paused===t.pause?(h.paused=t.pause,N(t.pause?h.pauseQueue:h.resumeQueue)):h.paused&&(t.pause=!0);let f=(r||Object.keys(e.springs)).map(i=>e.springs[i].start(t)),p=!0===t.cancel||!0===tr(t,"cancel");(c||p&&h.asyncId)&&f.push(tg(++e._lastAsyncId,{props:t,state:h,actions:{pause:R,resume:R,start(t,i){p?(tS(h,e._lastAsyncId),i(t_(e))):(t.onRest=o,i(tE(c,t,h,e)))}}})),h.paused&&await new Promise(e=>{h.resumeQueue.add(e)});let m=tv(e,await Promise.all(f));if(s&&m.finished&&!(i&&m.noop)){let i=tN(t,s,n);if(i)return tZ(e,[i]),t$(e,i,!0)}return l&&d.batchedUpdates(()=>l(m,e,e.item)),m}function tq(e,t){let i={...e.springs};return t&&k(P(t),e=>{I.und(e.keys)&&(e=tU(e)),I.obj(e.to)||(e={...e,to:void 0}),tX(i,e,e=>tK(e))}),tY(e,i),i}function tY(e,t){D(t,(t,i)=>{e.springs[i]||(e.springs[i]=t,eT(t,e))})}function tK(e,t){let i=new tP;return i.key=e,t&&eT(i,t),i}function tX(e,t,i){t.keys&&k(t.keys,r=>{let n=e[r]||(e[r]=i(r));n._prepareNode(t)})}function tZ(e,t){k(t,t=>{tX(e.springs,t,t=>tK(t,e))})}var tJ=({children:e,...t})=>{let i=(0,o.useContext)(tQ),r=t.pause||!!i.pause,n=t.immediate||!!i.immediate;t=function(e,t){let[i]=(0,o.useState)(()=>({inputs:t,result:e()})),r=(0,o.useRef)(),n=r.current,a=n;if(a){let i=!!(t&&a.inputs&&function(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}(t,a.inputs));i||(a={inputs:t,result:e()})}else a=i;return(0,o.useEffect)(()=>{r.current=a,n==i&&(i.inputs=i.result=void 0)},[a]),a.result}(()=>({pause:r,immediate:n}),[r,n]);let{Provider:a}=tQ;return o.createElement(a,{value:t},e)},tQ=(Object.assign(tJ,o.createContext({})),tJ.Provider._context=tJ,tJ.Consumer._context=tJ,tJ);tJ.Provider=tQ.Provider,tJ.Consumer=tQ.Consumer;var t0=()=>{let e=[],t=function(t){eB(`${eN}Directly calling start instead of using the api object is deprecated in v9 (use ".start" instead), this will be removed in later 0.X.0 versions`);let r=[];return k(e,(e,n)=>{if(I.und(t))r.push(e.start());else{let a=i(t,e,n);a&&r.push(e.start(a))}}),r};t.current=e,t.add=function(t){e.includes(t)||e.push(t)},t.delete=function(t){let i=e.indexOf(t);~i&&e.splice(i,1)},t.pause=function(){return k(e,e=>e.pause(...arguments)),this},t.resume=function(){return k(e,e=>e.resume(...arguments)),this},t.set=function(t){k(e,(e,i)=>{let r=I.fun(t)?t(i,e):t;r&&e.set(r)})},t.start=function(t){let i=[];return k(e,(e,r)=>{if(I.und(t))i.push(e.start());else{let n=this._getProps(t,e,r);n&&i.push(e.start(n))}}),i},t.stop=function(){return k(e,e=>e.stop(...arguments)),this},t.update=function(t){return k(e,(e,i)=>e.update(this._getProps(t,e,i))),this};let i=function(e,t,i){return I.fun(e)?e(i,t):e};return t._getProps=i,t};function t1(e,t){let i=I.fun(e),[[r],n]=function(e,t,i){let r=I.fun(t)&&t;r&&!i&&(i=[]);let n=(0,o.useMemo)(()=>r||3==arguments.length?t0():void 0,[]),a=(0,o.useRef)(0),s=eH(),l=(0,o.useMemo)(()=>({ctrls:[],queue:[],flush(e,t){let i=tq(e,t),r=a.current>0&&!l.queue.length&&!Object.keys(i).some(t=>!e.springs[t]);return r?tW(e,t):new Promise(r=>{tY(e,i),l.queue.push(()=>{r(tW(e,t))}),s()})}}),[]),u=(0,o.useRef)([...l.ctrls]),c=[],d=e$(e)||0;function h(e,i){for(let n=e;n<i;n++){let e=u.current[n]||(u.current[n]=new tG(null,l.flush)),i=r?r(n,e):t[n];i&&(c[n]=function(e){let t=tU(e);return I.und(t.default)&&(t.default=ta(t)),t}(i))}}(0,o.useMemo)(()=>{k(u.current.slice(e,d),e=>{e.ref?.delete(e),n?.delete(e),e.stop(!0)}),u.current.length=e,h(d,e)},[e]),(0,o.useMemo)(()=>{h(0,Math.min(d,e))},i);let f=u.current.map((e,t)=>tq(e,c[t])),p=(0,o.useContext)(tJ),m=e$(p),g=p!==m&&function(e){for(let t in e)return!0;return!1}(p);ez(()=>{a.current++,l.ctrls=u.current;let{queue:e}=l;e.length&&(l.queue=[],k(e,e=>e())),k(u.current,(e,t)=>{n?.add(e),g&&e.start({default:p});let i=c[t];if(i){var r;(r=i.ref)&&e.ref!==r&&(e.ref?.delete(e),r.add(e),e.ref=r),e.ref?e.queue.push(i):e.start(i)}})}),eG(()=>()=>{k(l.ctrls,e=>e.stop(!0))});let v=f.map(e=>({...e}));return n?[v,n]:v}(1,i?e:[e],i?t||[]:t);return i||2==arguments.length?[r,n]:r}var t2=class extends tM{constructor(e,t){super(),this.source=e,this.idle=!0,this._active=new Set,this.calc=em(...t);let i=this._get(),r=e4(i);eX(this,r.create(i))}advance(e){let t=this._get(),i=this.get();L(t,i)||(eK(this).setValue(t),this._onChange(t,this.idle)),!this.idle&&t5(this._active)&&t4(this)}_get(){let e=I.arr(this.source)?this.source.map(eb):P(eb(this.source));return this.calc(...e)}_start(){this.idle&&!t5(this._active)&&(this.idle=!1,k(eZ(this),e=>{e.done=!1}),u.skipAnimation?(d.batchedUpdates(()=>this.advance()),t4(this)):$.start(this))}_attach(){let e=1;k(P(this.source),t=>{ey(t)&&eT(t,this),tw(t)&&(t.idle||this._active.add(t),e=Math.max(e,t.priority+1))}),this.priority=e,this._start()}_detach(){k(P(this.source),e=>{ey(e)&&ew(e,this)}),this._active.clear(),t4(this)}eventObserved(e){"change"==e.type?e.idle?this.advance():(this._active.add(e.parent),this._start()):"idle"==e.type?this._active.delete(e.parent):"priority"==e.type&&(this.priority=P(this.source).reduce((e,t)=>Math.max(e,(tw(t)?t.priority:0)+1),0))}};function t3(e){return!1!==e.idle}function t5(e){return!e.size||Array.from(e).every(t3)}function t4(e){e.idle||(e.idle=!0,k(eZ(e),e=>{e.done=!0}),eE(e,{type:"idle",parent:e}))}u.assign({createStringInterpolator:eO,to:(e,t)=>new t2(e,t)}),$.advance;var t6=["primitive"].concat(Object.keys(i(19095)).filter(e=>/^[A-Z]/.test(e)).map(e=>e[0].toLowerCase()+e.slice(1)));u.assign({createStringInterpolator:eO,colors:{transparent:0,aliceblue:4042850303,antiquewhite:4209760255,aqua:16777215,aquamarine:2147472639,azure:4043309055,beige:4126530815,bisque:4293182719,black:255,blanchedalmond:4293643775,blue:65535,blueviolet:2318131967,brown:2771004159,burlywood:3736635391,burntsienna:3934150143,cadetblue:1604231423,chartreuse:2147418367,chocolate:3530104575,coral:4286533887,cornflowerblue:1687547391,cornsilk:4294499583,crimson:3692313855,cyan:16777215,darkblue:35839,darkcyan:9145343,darkgoldenrod:3095792639,darkgray:2846468607,darkgreen:6553855,darkgrey:2846468607,darkkhaki:3182914559,darkmagenta:2332068863,darkolivegreen:1433087999,darkorange:4287365375,darkorchid:2570243327,darkred:2332033279,darksalmon:3918953215,darkseagreen:2411499519,darkslateblue:1211993087,darkslategray:793726975,darkslategrey:793726975,darkturquoise:13554175,darkviolet:2483082239,deeppink:4279538687,deepskyblue:12582911,dimgray:1768516095,dimgrey:1768516095,dodgerblue:512819199,firebrick:2988581631,floralwhite:4294635775,forestgreen:579543807,fuchsia:4278255615,gainsboro:3705462015,ghostwhite:4177068031,gold:4292280575,goldenrod:3668254975,gray:2155905279,green:8388863,greenyellow:2919182335,grey:2155905279,honeydew:4043305215,hotpink:4285117695,indianred:3445382399,indigo:1258324735,ivory:4294963455,khaki:4041641215,lavender:3873897215,lavenderblush:4293981695,lawngreen:2096890111,lemonchiffon:4294626815,lightblue:2916673279,lightcoral:4034953471,lightcyan:3774873599,lightgoldenrodyellow:4210742015,lightgray:3553874943,lightgreen:2431553791,lightgrey:3553874943,lightpink:4290167295,lightsalmon:4288707327,lightseagreen:548580095,lightskyblue:2278488831,lightslategray:2005441023,lightslategrey:2005441023,lightsteelblue:2965692159,lightyellow:4294959359,lime:16711935,limegreen:852308735,linen:4210091775,magenta:4278255615,maroon:2147483903,mediumaquamarine:1724754687,mediumblue:52735,mediumorchid:3126187007,mediumpurple:2473647103,mediumseagreen:1018393087,mediumslateblue:2070474495,mediumspringgreen:16423679,mediumturquoise:1221709055,mediumvioletred:3340076543,midnightblue:421097727,mintcream:4127193855,mistyrose:4293190143,moccasin:4293178879,navajowhite:4292783615,navy:33023,oldlace:4260751103,olive:2155872511,olivedrab:1804477439,orange:4289003775,orangered:4282712319,orchid:3664828159,palegoldenrod:4008225535,palegreen:2566625535,paleturquoise:2951671551,palevioletred:3681588223,papayawhip:4293907967,peachpuff:4292524543,peru:3448061951,pink:4290825215,plum:3718307327,powderblue:2967529215,purple:2147516671,rebeccapurple:1714657791,red:4278190335,rosybrown:3163525119,royalblue:1097458175,saddlebrown:2336560127,salmon:4202722047,sandybrown:4104413439,seagreen:780883967,seashell:4294307583,sienna:2689740287,silver:3233857791,skyblue:2278484991,slateblue:1784335871,slategray:1887473919,slategrey:1887473919,snow:4294638335,springgreen:16744447,steelblue:1182971135,tan:3535047935,teal:8421631,thistle:3636451583,tomato:4284696575,turquoise:1088475391,violet:4001558271,wheat:4125012991,white:4294967295,whitesmoke:4126537215,yellow:4294902015,yellowgreen:2597139199},frameLoop:"demand"}),(0,s.n)(()=>{d.advance()}),((e,{applyAnimatedValues:t=()=>!1,createAnimatedStyle:i=e=>new e2(e),getComponentProps:r=e=>e}={})=>{let n={applyAnimatedValues:t,createAnimatedStyle:i,getComponentProps:r},a=e=>{let t=e9(e)||"Anonymous";return(e=I.str(e)?a[e]||(a[e]=e6(e,n)):e[e7]||(e[e7]=e6(e,n))).displayName=`Animated(${t})`,e};return D(e,(t,i)=>{I.arr(e)&&(i=e9(t)),a[i]=a(t)}),{animated:a}})(t6,{applyAnimatedValues:s.j}).animated},40458:function(e,t,i){"use strict";i.d(t,{Th:function(){return Q},zo:function(){return et}});var r,n=i(50959),a="colors",s="sizes",o="space",l={gap:o,gridGap:o,columnGap:o,gridColumnGap:o,rowGap:o,gridRowGap:o,inset:o,insetBlock:o,insetBlockEnd:o,insetBlockStart:o,insetInline:o,insetInlineEnd:o,insetInlineStart:o,margin:o,marginTop:o,marginRight:o,marginBottom:o,marginLeft:o,marginBlock:o,marginBlockEnd:o,marginBlockStart:o,marginInline:o,marginInlineEnd:o,marginInlineStart:o,padding:o,paddingTop:o,paddingRight:o,paddingBottom:o,paddingLeft:o,paddingBlock:o,paddingBlockEnd:o,paddingBlockStart:o,paddingInline:o,paddingInlineEnd:o,paddingInlineStart:o,top:o,right:o,bottom:o,left:o,scrollMargin:o,scrollMarginTop:o,scrollMarginRight:o,scrollMarginBottom:o,scrollMarginLeft:o,scrollMarginX:o,scrollMarginY:o,scrollMarginBlock:o,scrollMarginBlockEnd:o,scrollMarginBlockStart:o,scrollMarginInline:o,scrollMarginInlineEnd:o,scrollMarginInlineStart:o,scrollPadding:o,scrollPaddingTop:o,scrollPaddingRight:o,scrollPaddingBottom:o,scrollPaddingLeft:o,scrollPaddingX:o,scrollPaddingY:o,scrollPaddingBlock:o,scrollPaddingBlockEnd:o,scrollPaddingBlockStart:o,scrollPaddingInline:o,scrollPaddingInlineEnd:o,scrollPaddingInlineStart:o,fontSize:"fontSizes",background:a,backgroundColor:a,backgroundImage:a,borderImage:a,border:a,borderBlock:a,borderBlockEnd:a,borderBlockStart:a,borderBottom:a,borderBottomColor:a,borderColor:a,borderInline:a,borderInlineEnd:a,borderInlineStart:a,borderLeft:a,borderLeftColor:a,borderRight:a,borderRightColor:a,borderTop:a,borderTopColor:a,caretColor:a,color:a,columnRuleColor:a,fill:a,outline:a,outlineColor:a,stroke:a,textDecorationColor:a,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:s,minBlockSize:s,maxBlockSize:s,inlineSize:s,minInlineSize:s,maxInlineSize:s,width:s,minWidth:s,maxWidth:s,height:s,minHeight:s,maxHeight:s,flexBasis:s,gridTemplateColumns:s,gridTemplateRows:s,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},u=(e,t)=>"function"==typeof t?{"()":Function.prototype.toString.call(t)}:t,c=()=>{let e=Object.create(null);return(t,i,...r)=>{let n=JSON.stringify(t,u);return n in e?e[n]:e[n]=i(t,...r)}},d=Symbol.for("sxs.internal"),h=(e,t)=>Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)),f=e=>{for(let t in e)return!0;return!1},{hasOwnProperty:p}=Object.prototype,m=e=>e.includes("-")?e:e.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()),g=/\s+(?![^()]*\))/,v=e=>t=>e(..."string"==typeof t?String(t).split(g):[t]),y={appearance:e=>({WebkitAppearance:e,appearance:e}),backfaceVisibility:e=>({WebkitBackfaceVisibility:e,backfaceVisibility:e}),backdropFilter:e=>({WebkitBackdropFilter:e,backdropFilter:e}),backgroundClip:e=>({WebkitBackgroundClip:e,backgroundClip:e}),boxDecorationBreak:e=>({WebkitBoxDecorationBreak:e,boxDecorationBreak:e}),clipPath:e=>({WebkitClipPath:e,clipPath:e}),content:e=>({content:e.includes('"')||e.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(e)?e:`"${e}"`}),hyphens:e=>({WebkitHyphens:e,hyphens:e}),maskImage:e=>({WebkitMaskImage:e,maskImage:e}),maskSize:e=>({WebkitMaskSize:e,maskSize:e}),tabSize:e=>({MozTabSize:e,tabSize:e}),textSizeAdjust:e=>({WebkitTextSizeAdjust:e,textSizeAdjust:e}),userSelect:e=>({WebkitUserSelect:e,userSelect:e}),marginBlock:v((e,t)=>({marginBlockStart:e,marginBlockEnd:t||e})),marginInline:v((e,t)=>({marginInlineStart:e,marginInlineEnd:t||e})),maxSize:v((e,t)=>({maxBlockSize:e,maxInlineSize:t||e})),minSize:v((e,t)=>({minBlockSize:e,minInlineSize:t||e})),paddingBlock:v((e,t)=>({paddingBlockStart:e,paddingBlockEnd:t||e})),paddingInline:v((e,t)=>({paddingInlineStart:e,paddingInlineEnd:t||e}))},b=/([\d.]+)([^]*)/,_=(e,t)=>e.length?e.reduce((e,i)=>(e.push(...t.map(e=>e.includes("&")?e.replace(/&/g,/[ +>|~]/.test(i)&&/&.*&/.test(e)?`:is(${i})`:i):i+" "+e)),e),[]):t,E=(e,t)=>e in S&&"string"==typeof t?t.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,(t,i,r,n)=>i+("stretch"===r?`-moz-available${n};${m(e)}:${i}-webkit-fill-available`:`-moz-fit-content${n};${m(e)}:${i}fit-content`)+n):String(t),S={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},x=e=>e?e+"-":"",T=(e,t,i)=>e.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,(e,r,n,a,s)=>"$"==a==!!n?e:(r||"--"==a?"calc(":"")+"var(--"+("$"===a?x(t)+(s.includes("$")?"":x(i))+s.replace(/\$/g,"-"):s)+")"+(r||"--"==a?"*"+(r||"")+(n||"1")+")":"")),w=/\s*,\s*(?![^()]*\))/,A=Object.prototype.toString,M=(e,t,i,r,n)=>{let a,s,o;let l=(e,t,i)=>{let u,c;let d=e=>{var h;for(u in e){let f=64===u.charCodeAt(0),p=f&&Array.isArray(e[u])?e[u]:[e[u]];for(c of p){let e=/[A-Z]/.test(h=u)?h:h.replace(/-[^]/g,e=>e[1].toUpperCase()),p="object"==typeof c&&c&&c.toString===A&&(!r.utils[e]||!t.length);if(e in r.utils&&!p){let t=r.utils[e];if(t!==s){s=t,d(t(c)),s=null;continue}}else if(e in y){let t=y[e];if(t!==o){o=t,d(t(c)),o=null;continue}}if(f&&(u=(u.slice(1) in r.media?"@media "+r.media[u.slice(1)]:u).replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,(e,t,i,r,n,a)=>{let s=b.test(t),o=.0625*(s?-1:1),[l,u]=s?[r,t]:[t,r];return"("+("="===i[0]?"":">"===i[0]===s?"max-":"min-")+l+":"+("="!==i[0]&&1===i.length?u.replace(b,(e,t,r)=>Number(t)+o*(">"===i?1:-1)+r):u)+(n?") and ("+(">"===n[0]?"min-":"max-")+l+":"+(1===n.length?a.replace(b,(e,t,i)=>Number(t)+o*(">"===n?-1:1)+i):a):"")+")"})),p){let e=f?i.concat(u):[...i],r=f?[...t]:_(t,u.split(w));void 0!==a&&n(R(...a)),a=void 0,l(c,r,e)}else void 0===a&&(a=[[],t,i]),u=f||36!==u.charCodeAt(0)?u:`--${x(r.prefix)}${u.slice(1).replace(/\$/g,"-")}`,c=p?c:"number"==typeof c?c&&e in C?String(c)+"px":String(c):T(E(e,null==c?"":c),r.prefix,r.themeMap[e]),a[0].push(`${f?`${u} `:`${m(u)}:`}${c}`)}}};d(e),void 0!==a&&n(R(...a)),a=void 0};l(e,t,i)},R=(e,t,i)=>`${i.map(e=>`${e}{`).join("")}${t.length?`${t.join(",")}{`:""}${e.join(";")}${t.length?"}":""}${Array(i.length?i.length+1:0).join("}")}`,C={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},I=e=>String.fromCharCode(e+(e>25?39:97)),L=e=>(e=>{let t,i="";for(t=Math.abs(e);t>52;t=t/52|0)i=I(t%52)+i;return I(t%52)+i})(((e,t)=>{let i=t.length;for(;i;)e=33*e^t.charCodeAt(--i);return e})(5381,JSON.stringify(e))>>>0),k=["themed","global","styled","onevar","resonevar","allvar","inline"],D=e=>{if(e.href&&!e.href.startsWith(location.origin))return!1;try{return!!e.cssRules}catch(e){return!1}},P=e=>{let t;let i=()=>{let{cssRules:e}=t.sheet;return[].map.call(e,(i,r)=>{let{cssText:n}=i,a="";if(n.startsWith("--sxs"))return"";if(e[r-1]&&(a=e[r-1].cssText).startsWith("--sxs")){if(!i.cssRules.length)return"";for(let e in t.rules)if(t.rules[e].group===i)return`--sxs{--sxs:${[...t.rules[e].cache].join(" ")}}${n}`;return i.cssRules.length?`${a}${n}`:""}return n}).join("")},r=()=>{if(t){let{rules:e,sheet:i}=t;if(!i.deleteRule){for(;3===Object(Object(i.cssRules)[0]).type;)i.cssRules.splice(0,1);i.cssRules=[]}for(let t in e)delete e[t]}let n=Object(e).styleSheets||[];for(let e of n)if(D(e)){for(let n=0,a=e.cssRules;a[n];++n){let s=Object(a[n]);if(1!==s.type)continue;let o=Object(a[n+1]);if(4!==o.type)continue;++n;let{cssText:l}=s;if(!l.startsWith("--sxs"))continue;let u=l.slice(14,-3).trim().split(/\s+/),c=k[u[0]];c&&(t||(t={sheet:e,reset:r,rules:{},toString:i}),t.rules[c]={group:o,index:n,cache:new Set(u)})}if(t)break}if(!t){let n=(e,t)=>({type:t,cssRules:[],insertRule(e,t){this.cssRules.splice(t,0,n(e,{import:3,undefined:1}[(e.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return"@media{}"===e?`@media{${[].map.call(this.cssRules,e=>e.cssText).join("")}}`:e}});t={sheet:e?(e.head||e).appendChild(document.createElement("style")).sheet:n("","text/css"),rules:{},reset:r,toString:i}}let{sheet:a,rules:s}=t;for(let e=k.length-1;e>=0;--e){let t=k[e];if(!s[t]){let i=k[e+1],r=s[i]?s[i].index:a.cssRules.length;a.insertRule("@media{}",r),a.insertRule(`--sxs{--sxs:${e}}`,r),s[t]={group:a.cssRules[r+1],index:r,cache:new Set([e])}}O(s[t])}};return r(),t},O=e=>{let t=e.group,i=t.cssRules.length;e.apply=e=>{try{t.insertRule(e,i),++i}catch(e){}}},N=Symbol(),U=c(),F=(e,t)=>U(e,()=>(...i)=>{let r={type:null,composers:new Set};for(let t of i)if(null!=t){if(t[d])for(let e of(null==r.type&&(r.type=t[d].type),t[d].composers))r.composers.add(e);else t.constructor!==Object||t.$$typeof?null==r.type&&(r.type=t):r.composers.add(B(t,e))}return null==r.type&&(r.type="span"),r.composers.size||r.composers.add(["PJLV",{},[],[],{},[]]),V(e,r,t)}),B=({variants:e,compoundVariants:t,defaultVariants:i,...r},n)=>{let a=`${x(n.prefix)}c-${L(r)}`,s=[],o=[],l=Object.create(null),u=[];for(let e in i)l[e]=String(i[e]);if("object"==typeof e&&e)for(let t in e){p.call(l,t)||(l[t]="undefined");let i=e[t];for(let e in i){let r={[t]:String(e)};"undefined"===String(e)&&u.push(t);let n=i[e],a=[r,n,!f(n)];s.push(a)}}if("object"==typeof t&&t)for(let e of t){let{css:t,...i}=e;for(let e in t="object"==typeof t&&t||{},i)i[e]=String(i[e]);let r=[i,t,!f(t)];o.push(r)}return[a,r,s,o,l,u]},V=(e,t,i)=>{let[r,n,a,s]=z(t.composers),o="function"==typeof t.type||t.type.$$typeof?(e=>{function t(){for(let i=0;i<t[N].length;i++){let[r,n]=t[N][i];e.rules[r].apply(n)}return t[N]=[],null}return t[N]=[],t.rules={},k.forEach(e=>t.rules[e]={apply:i=>t[N].push([e,i])}),t})(i):null,l=(o||i).rules,u=`.${r}${n.length>1?`:where(.${n.slice(1).join(".")})`:""}`,c=c=>{c="object"==typeof c&&c||H;let{css:d,...h}=c,f={};for(let e in a)if(delete h[e],e in c){let t=c[e];"object"==typeof t&&t?f[e]={"@initial":a[e],...t}:(t=String(t),f[e]="undefined"!==t||s.has(e)?t:a[e])}else f[e]=a[e];let p=new Set([...n]);for(let[r,n,a,s]of t.composers){i.rules.styled.cache.has(r)||(i.rules.styled.cache.add(r),M(n,[`.${r}`],[],e,e=>{l.styled.apply(e)}));let t=j(a,f,e.media),o=j(s,f,e.media,!0);for(let n of t)if(void 0!==n)for(let[t,a,s]of n){let n=`${r}-${L(a)}-${t}`;p.add(n);let o=(s?i.rules.resonevar:i.rules.onevar).cache,u=s?l.resonevar:l.onevar;o.has(n)||(o.add(n),M(a,[`.${n}`],[],e,e=>{u.apply(e)}))}for(let t of o)if(void 0!==t)for(let[n,a]of t){let t=`${r}-${L(a)}-${n}`;p.add(t),i.rules.allvar.cache.has(t)||(i.rules.allvar.cache.add(t),M(a,[`.${t}`],[],e,e=>{l.allvar.apply(e)}))}}if("object"==typeof d&&d){let t=`${r}-i${L(d)}-css`;p.add(t),i.rules.inline.cache.has(t)||(i.rules.inline.cache.add(t),M(d,[`.${t}`],[],e,e=>{l.inline.apply(e)}))}for(let e of String(c.className||"").trim().split(/\s+/))e&&p.add(e);let m=h.className=[...p].join(" ");return{type:t.type,className:m,selector:u,props:h,toString:()=>m,deferredInjector:o}};return h(c,{className:r,selector:u,[d]:t,toString:()=>(i.rules.styled.cache.has(r)||c(),r)})},z=e=>{let t="",i=[],r={},n=[];for(let[a,,,,s,o]of e)for(let e in""===t&&(t=a),i.push(a),n.push(...o),s){let t=s[e];(void 0===r[e]||"undefined"!==t||o.includes(t))&&(r[e]=t)}return[t,i,r,new Set(n)]},j=(e,t,i,r)=>{let n=[];t:for(let[a,s,o]of e){if(o)continue;let e,l=0,u=!1;for(e in a){let r=a[e],n=t[e];if(n!==r){if("object"!=typeof n||!n)continue t;{let e,t,a=0;for(let s in n){if(r===String(n[s])){if("@initial"!==s){let e=s.slice(1);(t=t||[]).push(e in i?i[e]:s.replace(/^@media ?/,"")),u=!0}l+=a,e=!0}++a}if(t&&t.length&&(s={["@media "+t.join(", ")]:s}),!e)continue t}}}(n[l]=n[l]||[]).push([r?"cv":`${e}-${a[e]}`,s,u])}return n},H={},G=c(),W=(e,t)=>G(e,()=>(...i)=>{let r=()=>{for(let r of i){let i=L(r="object"==typeof r&&r||{});if(!t.rules.global.cache.has(i)){if(t.rules.global.cache.add(i),"@import"in r){let e=[].indexOf.call(t.sheet.cssRules,t.rules.themed.group)-1;for(let i of[].concat(r["@import"]))i=i.includes('"')||i.includes("'")?i:`"${i}"`,t.sheet.insertRule(`@import ${i};`,e++);delete r["@import"]}M(r,[],[],e,e=>{t.rules.global.apply(e)})}}return""};return h(r,{toString:r})}),$=c(),q=(e,t)=>$(e,()=>i=>{let r=`${x(e.prefix)}k-${L(i)}`,n=()=>{if(!t.rules.global.cache.has(r)){t.rules.global.cache.add(r);let n=[];M(i,[],[],e,e=>n.push(e));let a=`@keyframes ${r}{${n.join("")}}`;t.rules.global.apply(a)}return r};return h(n,{get name(){return n()},toString:n})}),Y=class{constructor(e,t,i,r){this.token=null==e?"":String(e),this.value=null==t?"":String(t),this.scale=null==i?"":String(i),this.prefix=null==r?"":String(r)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+x(this.prefix)+x(this.scale)+this.token}toString(){return this.computedValue}},K=c(),X=(e,t)=>K(e,()=>(i,r)=>{r="object"==typeof i&&i||Object(r);let n=`.${i=(i="string"==typeof i?i:"")||`${x(e.prefix)}t-${L(r)}`}`,a={},s=[];for(let t in r)for(let i in a[t]={},r[t]){let n=`--${x(e.prefix)}${t}-${i}`,o=T(String(r[t][i]),e.prefix,t);a[t][i]=new Y(i,o,t,e.prefix),s.push(`${n}:${o}`)}let o=()=>{if(s.length&&!t.rules.themed.cache.has(i)){t.rules.themed.cache.add(i);let n=`${r===e.theme?":root,":""}.${i}{${s.join(";")}}`;t.rules.themed.apply(n)}return i};return{...a,get className(){return o()},selector:n,toString:o}}),Z=c(),J=c(),Q=e=>{let t=(e=>{let t=!1,i=Z(e,e=>{t=!0;let i="prefix"in(e="object"==typeof e&&e||{})?String(e.prefix):"",r="object"==typeof e.media&&e.media||{},n="object"==typeof e.root?e.root||null:globalThis.document||null,a="object"==typeof e.theme&&e.theme||{},s={prefix:i,media:r,theme:a,themeMap:"object"==typeof e.themeMap&&e.themeMap||{...l},utils:"object"==typeof e.utils&&e.utils||{}},o=P(n),u={css:F(s,o),globalCss:W(s,o),keyframes:q(s,o),createTheme:X(s,o),reset(){o.reset(),u.theme.toString()},theme:{},sheet:o,config:s,prefix:i,getCssText:o.toString,toString:o.toString};return String(u.theme=u.createTheme(a)),u});return t||i.reset(),i})(e);return t.styled=(({config:e,sheet:t})=>J(e,()=>{let i=F(e,t);return(...e)=>{let t=i(...e),r=t[d].type,a=n.forwardRef((e,i)=>{let a=e&&e.as||r,{props:s,deferredInjector:o}=t(e);return delete s.as,s.ref=i,o?n.createElement(n.Fragment,null,n.createElement(a,s),n.createElement(o,null)):n.createElement(a,s)});return a.className=t.className,a.displayName=`Styled.${r.displayName||r.name||r}`,a.selector=t.selector,a.toString=()=>t.selector,a[d]=t[d],a}}))(t),t},ee=()=>r||(r=Q()),et=(...e)=>ee().styled(...e)},32738:function(e,t,i){"use strict";i.d(t,{Vi:function(){return I},l7:function(){return k},y6:function(){return w}});var r={grad:.9,turn:360,rad:360/(2*Math.PI)},n=function(e){return"string"==typeof e?e.length>0:"number"==typeof e},a=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=Math.pow(10,t)),Math.round(i*e)/i+0},s=function(e,t,i){return void 0===t&&(t=0),void 0===i&&(i=1),e>i?i:e>t?e:t},o=function(e){return(e=isFinite(e)?e%360:0)>0?e:e+360},l=function(e){return{r:s(e.r,0,255),g:s(e.g,0,255),b:s(e.b,0,255),a:s(e.a)}},u=function(e){return{r:a(e.r),g:a(e.g),b:a(e.b),a:a(e.a,3)}},c=/^#([0-9a-f]{3,8})$/i,d=function(e){var t=e.toString(16);return t.length<2?"0"+t:t},h=function(e){var t=e.r,i=e.g,r=e.b,n=e.a,a=Math.max(t,i,r),s=a-Math.min(t,i,r),o=s?a===t?(i-r)/s:a===i?2+(r-t)/s:4+(t-i)/s:0;return{h:60*(o<0?o+6:o),s:a?s/a*100:0,v:a/255*100,a:n}},f=function(e){var t=e.h,i=e.s,r=e.v,n=e.a;t=t/360*6,i/=100,r/=100;var a=Math.floor(t),s=r*(1-i),o=r*(1-(t-a)*i),l=r*(1-(1-t+a)*i),u=a%6;return{r:255*[r,o,s,s,l,r][u],g:255*[l,r,r,o,s,s][u],b:255*[s,s,l,r,r,o][u],a:n}},p=function(e){return{h:o(e.h),s:s(e.s,0,100),l:s(e.l,0,100),a:s(e.a)}},m=function(e){return{h:a(e.h),s:a(e.s),l:a(e.l),a:a(e.a,3)}},g=function(e){var t,i;return f((t=e.s,{h:e.h,s:(t*=((i=e.l)<50?i:100-i)/100)>0?2*t/(i+t)*100:0,v:i+t,a:e.a}))},v=function(e){var t,i,r,n;return{h:(t=h(e)).h,s:(n=(200-(i=t.s))*(r=t.v)/100)>0&&n<200?i*r/100/(n<=100?n:200-n)*100:0,l:n/2,a:t.a}},y=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,b=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,_=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,E=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,S={string:[[function(e){var t=c.exec(e);return t?(e=t[1]).length<=4?{r:parseInt(e[0]+e[0],16),g:parseInt(e[1]+e[1],16),b:parseInt(e[2]+e[2],16),a:4===e.length?a(parseInt(e[3]+e[3],16)/255,2):1}:6===e.length||8===e.length?{r:parseInt(e.substr(0,2),16),g:parseInt(e.substr(2,2),16),b:parseInt(e.substr(4,2),16),a:8===e.length?a(parseInt(e.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(e){var t=_.exec(e)||E.exec(e);return t?t[2]!==t[4]||t[4]!==t[6]?null:l({r:Number(t[1])/(t[2]?100/255:1),g:Number(t[3])/(t[4]?100/255:1),b:Number(t[5])/(t[6]?100/255:1),a:void 0===t[7]?1:Number(t[7])/(t[8]?100:1)}):null},"rgb"],[function(e){var t,i,n=y.exec(e)||b.exec(e);return n?g(p({h:(t=n[1],void 0===(i=n[2])&&(i="deg"),Number(t)*(r[i]||1)),s:Number(n[3]),l:Number(n[4]),a:void 0===n[5]?1:Number(n[5])/(n[6]?100:1)})):null},"hsl"]],object:[[function(e){var t=e.r,i=e.g,r=e.b,a=e.a;return n(t)&&n(i)&&n(r)?l({r:Number(t),g:Number(i),b:Number(r),a:Number(void 0===a?1:a)}):null},"rgb"],[function(e){var t=e.h,i=e.s,r=e.l,a=e.a;return n(t)&&n(i)&&n(r)?g(p({h:Number(t),s:Number(i),l:Number(r),a:Number(void 0===a?1:a)})):null},"hsl"],[function(e){var t,i=e.h,r=e.s,a=e.v,l=e.a;return n(i)&&n(r)&&n(a)?f({h:o((t={h:Number(i),s:Number(r),v:Number(a),a:Number(void 0===l?1:l)}).h),s:s(t.s,0,100),v:s(t.v,0,100),a:s(t.a)}):null},"hsv"]]},x=function(e,t){for(var i=0;i<t.length;i++){var r=t[i][0](e);if(r)return[r,t[i][1]]}return[null,void 0]},T=function(e){return"string"==typeof e?x(e.trim(),S.string):"object"==typeof e&&null!==e?x(e,S.object):[null,void 0]},w=function(e){return T(e)[1]},A=function(e,t){var i=v(e);return{h:i.h,s:s(i.s+100*t,0,100),l:i.l,a:i.a}},M=function(e){return(299*e.r+587*e.g+114*e.b)/1e3/255},R=function(e,t){var i=v(e);return{h:i.h,s:i.s,l:s(i.l+100*t,0,100),a:i.a}},C=function(){function e(e){this.parsed=T(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return e.prototype.isValid=function(){return null!==this.parsed},e.prototype.brightness=function(){return a(M(this.rgba),2)},e.prototype.isDark=function(){return .5>M(this.rgba)},e.prototype.isLight=function(){return M(this.rgba)>=.5},e.prototype.toHex=function(){var e,t,i,r,n,s;return t=(e=u(this.rgba)).r,i=e.g,r=e.b,s=(n=e.a)<1?d(a(255*n)):"","#"+d(t)+d(i)+d(r)+s},e.prototype.toRgb=function(){return u(this.rgba)},e.prototype.toRgbString=function(){var e,t,i,r,n;return t=(e=u(this.rgba)).r,i=e.g,r=e.b,(n=e.a)<1?"rgba("+t+", "+i+", "+r+", "+n+")":"rgb("+t+", "+i+", "+r+")"},e.prototype.toHsl=function(){return m(v(this.rgba))},e.prototype.toHslString=function(){var e,t,i,r,n;return t=(e=m(v(this.rgba))).h,i=e.s,r=e.l,(n=e.a)<1?"hsla("+t+", "+i+"%, "+r+"%, "+n+")":"hsl("+t+", "+i+"%, "+r+"%)"},e.prototype.toHsv=function(){var e;return{h:a((e=h(this.rgba)).h),s:a(e.s),v:a(e.v),a:a(e.a,3)}},e.prototype.invert=function(){var e;return I({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a})},e.prototype.saturate=function(e){return void 0===e&&(e=.1),I(A(this.rgba,e))},e.prototype.desaturate=function(e){return void 0===e&&(e=.1),I(A(this.rgba,-e))},e.prototype.grayscale=function(){return I(A(this.rgba,-1))},e.prototype.lighten=function(e){return void 0===e&&(e=.1),I(R(this.rgba,e))},e.prototype.darken=function(e){return void 0===e&&(e=.1),I(R(this.rgba,-e))},e.prototype.rotate=function(e){return void 0===e&&(e=15),this.hue(this.hue()+e)},e.prototype.alpha=function(e){var t;return"number"==typeof e?I({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):a(this.rgba.a,3)},e.prototype.hue=function(e){var t=v(this.rgba);return"number"==typeof e?I({h:e,s:t.s,l:t.l,a:t.a}):a(t.h)},e.prototype.isEqual=function(e){return this.toHex()===I(e).toHex()},e}(),I=function(e){return e instanceof C?e:new C(e)},L=[],k=function(e){e.forEach(function(e){0>L.indexOf(e)&&(e(C,S),L.push(e))})}},27696:function(e,t,i){"use strict";function r(e,t){var i={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},r={};for(var n in i)r[i[n]]=n;var a={};e.prototype.toName=function(t){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var n,s=r[this.toHex()];if(s)return s;if(null==t?void 0:t.closest){var o=this.toRgb(),l=1/0,u="black";if(!a.length)for(var c in i)a[c]=new e(i[c]).toRgb();for(var d in i){var h=(n=a[d],Math.pow(o.r-n.r,2)+Math.pow(o.g-n.g,2)+Math.pow(o.b-n.b,2));h<l&&(l=h,u=d)}return u}},t.string.push([function(t){var r=t.toLowerCase(),n="transparent"===r?"#0000":i[r];return n?new e(n).toRgb():null},"name"])}i.d(t,{Z:function(){return r}})},92594:function(e,t,i){"use strict";i.d(t,{M4:function(){return a},Oo:function(){return s},oP:function(){return n}});var r=i(22727);function n(e){return(0,r.N)(1-+e)}function a(e){return 1-(0,r.N)(e)}function s(e){return((e*=2)<=1?(0,r.N)(1-e):2-(0,r.N)(e-1))/2}},22727:function(e,t,i){"use strict";function r(e){return(Math.pow(2,-10*e)-9765625e-10)*1.0009775171065494}i.d(t,{N:function(){return r}})},91306:function(e,t,i){"use strict";function r(e){return e*e}function n(e){return e*(2-e)}function a(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}i.d(t,{Kl:function(){return r},U2:function(){return a},u4:function(){return n}})},52026:function(e,t,i){"use strict";i.d(t,{S:function(){return d}});var r=i(13537),n=i(65681),a=i(42281),s=i(83883);function o(e,t){return e*Math.sqrt(1-t*t)}let l=["duration","bounce"],u=["stiffness","damping","mass"];function c(e,t){return t.some(t=>void 0!==e[t])}function d({keyframes:e,restDelta:t,restSpeed:i,...d}){let h;let f=e[0],p=e[e.length-1],m={done:!1,value:f},{stiffness:g,damping:v,mass:y,velocity:b,duration:_,isResolvedFromDuration:E}=function(e){let t={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...e};if(!c(e,u)&&c(e,l)){let i=function({duration:e=800,bounce:t=.25,velocity:i=0,mass:n=1}){let l,u;(0,a.K)(e<=(0,r.w)(10),"Spring duration must be 10 seconds or less");let c=1-t;c=(0,s.u)(.05,1,c),e=(0,s.u)(.01,10,(0,r.X)(e)),c<1?(l=t=>{let r=t*c,n=r*e,a=o(t,c);return .001-(r-i)/a*Math.exp(-n)},u=t=>{let r=t*c,n=r*e,a=Math.pow(c,2)*Math.pow(t,2)*e,s=o(Math.pow(t,2),c),u=-l(t)+.001>0?-1:1;return u*((n*i+i-a)*Math.exp(-n))/s}):(l=t=>{let r=Math.exp(-t*e),n=(t-i)*e+1;return -.001+r*n},u=t=>{let r=Math.exp(-t*e),n=(i-t)*(e*e);return r*n});let d=5/e,h=function(e,t,i){let r=i;for(let i=1;i<12;i++)r-=e(r)/t(r);return r}(l,u,d);if(e=(0,r.w)(e),isNaN(h))return{stiffness:100,damping:10,duration:e};{let t=Math.pow(h,2)*n;return{stiffness:t,damping:2*c*Math.sqrt(n*t),duration:e}}}(e);(t={...t,...i,velocity:0,mass:1}).isResolvedFromDuration=!0}return t}(d),S=b?-(0,r.X)(b):0,x=v/(2*Math.sqrt(g*y)),T=p-f,w=(0,r.X)(Math.sqrt(g/y)),A=5>Math.abs(T);if(i||(i=A?.01:2),t||(t=A?.005:.5),x<1){let e=o(w,x);h=t=>{let i=Math.exp(-x*w*t);return p-i*((S+x*w*T)/e*Math.sin(e*t)+T*Math.cos(e*t))}}else if(1===x)h=e=>p-Math.exp(-w*e)*(T+(S+w*T)*e);else{let e=w*Math.sqrt(x*x-1);h=t=>{let i=Math.exp(-x*w*t),r=Math.min(e*t,300);return p-i*((S+x*w*T)*Math.sinh(r)+e*T*Math.cosh(r))/e}}return{calculatedDuration:E&&_||null,next:e=>{let r=h(e);if(E)m.done=e>=_;else{let a=S;0!==e&&(a=x<1?(0,n.P)(h,e,r):0);let s=Math.abs(a)<=i,o=Math.abs(p-r)<=t;m.done=s&&o}return m.value=m.done?p:r,m}}}},91785:function(e,t,i){"use strict";i.d(t,{E:function(){return r},i:function(){return n}});let r=2e4;function n(e){let t=0,i=e.next(t);for(;!i.done&&t<r;)t+=50,i=e.next(t);return t>=r?1/0:t}},65681:function(e,t,i){"use strict";i.d(t,{P:function(){return n}});var r=i(37968);function n(e,t,i){let n=Math.max(t-5,0);return(0,r.R)(i-e(n),t-n)}},93939:function(e,t,i){"use strict";let r;i.d(t,{v:function(){return ev}});var n,a=i(42281),s=i(13537);let o={current:!1},l=e=>Array.isArray(e)&&"number"==typeof e[0],u=([e,t,i,r])=>`cubic-bezier(${e}, ${t}, ${i}, ${r})`,c={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:u([0,.65,.55,1]),circOut:u([.55,0,1,.45]),backIn:u([.31,.01,.66,-.59]),backOut:u([.33,1.53,.69,.99])};var d=i(63613);let h=(e,t,i)=>(((1-3*i+3*t)*e+(3*i-6*t))*e+3*t)*e;function f(e,t,i,r){if(e===t&&i===r)return d.Z;let n=t=>(function(e,t,i,r,n){let a,s;let o=0;do(a=h(s=t+(i-t)/2,r,n)-e)>0?i=s:t=s;while(Math.abs(a)>1e-7&&++o<12);return s})(t,0,1,e,i);return e=>0===e||1===e?e:h(n(e),t,r)}let p=f(.42,0,1,1),m=f(0,0,.58,1),g=f(.42,0,.58,1);var v=i(62418),y=i(11438),b=i(63699),_=i(55023);let E=f(.33,1.53,.69,.99),S=(0,_.M)(E),x=(0,b.o)(S),T={linear:d.Z,easeIn:p,easeInOut:g,easeOut:m,circIn:y.Z7,circInOut:y.X7,circOut:y.Bn,backIn:S,backInOut:x,backOut:E,anticipate:e=>(e*=2)<1?.5*S(e):.5*(2-Math.pow(2,-10*(e-1)))},w=e=>{if(Array.isArray(e)){(0,a.k)(4===e.length,"Cubic bezier arrays must contain four numerical values.");let[t,i,r,n]=e;return f(t,i,r,n)}return"string"==typeof e?((0,a.k)(void 0!==T[e],`Invalid easing type '${e}'`),T[e]):e};var A=i(9161),M=i(83883),R=i(71605);function C(e,t,i){return(i<0&&(i+=1),i>1&&(i-=1),i<1/6)?e+(t-e)*6*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}var I=i(36775),L=i(75937),k=i(44624);let D=(e,t,i)=>{let r=e*e;return Math.sqrt(Math.max(0,i*(t*t-r)+r))},P=[I.$,L.m,k.J],O=e=>P.find(t=>t.test(e));function N(e){let t=O(e);(0,a.k)(!!t,`'${e}' is not an animatable color. Use the equivalent color code instead.`);let i=t.parse(e);return t===k.J&&(i=function({hue:e,saturation:t,lightness:i,alpha:r}){e/=360,i/=100;let n=0,a=0,s=0;if(t/=100){let r=i<.5?i*(1+t):i+t-i*t,o=2*i-r;n=C(o,r,e+1/3),a=C(o,r,e),s=C(o,r,e-1/3)}else n=a=s=i;return{red:Math.round(255*n),green:Math.round(255*a),blue:Math.round(255*s),alpha:r}}(i)),i}let U=(e,t)=>{let i=N(e),r=N(t),n={...i};return e=>(n.red=D(i.red,r.red,e),n.green=D(i.green,r.green,e),n.blue=D(i.blue,r.blue,e),n.alpha=(0,R.C)(i.alpha,r.alpha,e),L.m.transform(n))};var F=i(56893),B=i(34989);let V=(e,t)=>i=>`${i>0?t:e}`;function z(e,t){return"number"==typeof e?i=>(0,R.C)(e,t,i):A.$.test(e)?U(e,t):e.startsWith("var(")?V(e,t):G(e,t)}let j=(e,t)=>{let i=[...e],r=i.length,n=e.map((e,i)=>z(e,t[i]));return e=>{for(let t=0;t<r;t++)i[t]=n[t](e);return i}},H=(e,t)=>{let i={...e,...t},r={};for(let n in i)void 0!==e[n]&&void 0!==t[n]&&(r[n]=z(e[n],t[n]));return e=>{for(let t in r)i[t]=r[t](e);return i}},G=(e,t)=>{let i=B.P.createTransformer(t),r=(0,B.V)(e),n=(0,B.V)(t),s=r.numVars===n.numVars&&r.numColors===n.numColors&&r.numNumbers>=n.numNumbers;return s?(0,F.z)(j(r.values,n.values),i):((0,a.K)(!0,`Complex values '${e}' and '${t}' too different to mix. Ensure all colors are of the same type, and that each contains the same quantity of number and color values. Falling back to instant transition.`),V(e,t))};var W=i(45974);let $=(e,t)=>i=>(0,R.C)(e,t,i);function q(e,t,{clamp:i=!0,ease:r,mixer:n}={}){let s=e.length;if((0,a.k)(s===t.length,"Both input and output ranges must be the same length"),1===s)return()=>t[0];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());let o=function(e,t,i){let r=[],n=i||function(e){if("number"==typeof e);else if("string"==typeof e)return A.$.test(e)?U:G;else if(Array.isArray(e))return j;else if("object"==typeof e)return H;return $}(e[0]),a=e.length-1;for(let i=0;i<a;i++){let a=n(e[i],e[i+1]);if(t){let e=Array.isArray(t)?t[i]||d.Z:t;a=(0,F.z)(e,a)}r.push(a)}return r}(t,r,n),l=o.length,u=t=>{let i=0;if(l>1)for(;i<e.length-2&&!(t<e[i+1]);i++);let r=(0,W.Y)(e[i],e[i+1],t);return o[i](r)};return i?t=>u((0,M.u)(e[0],e[s-1],t)):u}var Y=i(28852);function K({duration:e=300,keyframes:t,times:i,ease:r="easeInOut"}){let n=(0,v.N)(r)?r.map(w):w(r),a={done:!1,value:t[0]},s=(i&&i.length===t.length?i:(0,Y.Y)(t)).map(t=>t*e),o=q(s,t,{ease:Array.isArray(n)?n:t.map(()=>n||g).splice(0,t.length-1)});return{calculatedDuration:e,next:t=>(a.value=o(t),a.done=t>=e,a)}}var X=i(52026),Z=i(65681);function J({keyframes:e,velocity:t=0,power:i=.8,timeConstant:r=325,bounceDamping:n=10,bounceStiffness:a=500,modifyTarget:s,min:o,max:l,restDelta:u=.5,restSpeed:c}){let d,h;let f=e[0],p={done:!1,value:f},m=e=>void 0!==o&&e<o||void 0!==l&&e>l,g=e=>void 0===o?l:void 0===l?o:Math.abs(o-e)<Math.abs(l-e)?o:l,v=i*t,y=f+v,b=void 0===s?y:s(y);b!==y&&(v=b-f);let _=e=>-v*Math.exp(-e/r),E=e=>b+_(e),S=e=>{let t=_(e),i=E(e);p.done=Math.abs(t)<=u,p.value=p.done?b:i},x=e=>{m(p.value)&&(d=e,h=(0,X.S)({keyframes:[p.value,g(p.value)],velocity:(0,Z.P)(E,e,p.value),damping:n,stiffness:a,restDelta:u,restSpeed:c}))};return x(0),{calculatedDuration:null,next:e=>{let t=!1;return(h||void 0!==d||(t=!0,S(e),x(e)),void 0!==d&&e>d)?h.next(e-d):(t||S(e),p)}}}var Q=i(4801);let ee=e=>{let t=({timestamp:t})=>e(t);return{start:()=>Q.Wi.update(t,!0),stop:()=>(0,Q.Pn)(t),now:()=>Q.frameData.isProcessing?Q.frameData.timestamp:performance.now()}};var et=i(91785);let ei={decay:J,inertia:J,tween:K,keyframes:K,spring:X.S};function er({autoplay:e=!0,delay:t=0,driver:i=ee,keyframes:r,type:n="keyframes",repeat:a=0,repeatDelay:o=0,repeatType:l="loop",onPlay:u,onStop:c,onComplete:d,onUpdate:h,...f}){let p,m,g,v,y,b=1,_=!1,E=()=>{m=new Promise(e=>{p=e})};E();let S=ei[n]||K;S!==K&&"number"!=typeof r[0]&&(v=q([0,100],r,{clamp:!1}),r=[0,100]);let x=S({...f,keyframes:r});"mirror"===l&&(y=S({...f,keyframes:[...r].reverse(),velocity:-(f.velocity||0)}));let T="idle",w=null,A=null,R=null;null===x.calculatedDuration&&a&&(x.calculatedDuration=(0,et.i)(x));let{calculatedDuration:C}=x,I=1/0,L=1/0;null!==C&&(L=(I=C+o)*(a+1)-o);let k=0,D=e=>{if(null===A)return;b>0&&(A=Math.min(A,e)),b<0&&(A=Math.min(e-L/b,A)),k=null!==w?w:Math.round(e-A)*b;let i=k-t*(b>=0?1:-1),n=b>=0?i<0:i>L;k=Math.max(i,0),"finished"===T&&null===w&&(k=L);let s=k,u=x;if(a){let e=k/I,t=Math.floor(e),i=e%1;!i&&e>=1&&(i=1),1===i&&t--,t=Math.min(t,a+1);let r=!!(t%2);r&&("reverse"===l?(i=1-i,o&&(i-=o/I)):"mirror"===l&&(u=y));let n=(0,M.u)(0,1,i);k>L&&(n="reverse"===l&&r?1:0),s=n*I}let c=n?{done:!1,value:r[0]}:u.next(s);v&&(c.value=v(c.value));let{done:d}=c;n||null===C||(d=b>=0?k>=L:k<=0);let f=null===w&&("finished"===T||"running"===T&&d);return h&&h(c.value),f&&N(),c},P=()=>{g&&g.stop(),g=void 0},O=()=>{T="idle",P(),p(),E(),A=R=null},N=()=>{T="finished",d&&d(),P(),p()},U=()=>{if(_)return;g||(g=i(D));let e=g.now();u&&u(),null!==w?A=e-w:A&&"finished"!==T||(A=e),"finished"===T&&E(),R=A,w=null,T="running",g.start()};e&&U();let F={then:(e,t)=>m.then(e,t),get time(){return(0,s.X)(k)},set time(newTime){k=newTime=(0,s.w)(newTime),null===w&&g&&0!==b?A=g.now()-newTime/b:w=newTime},get duration(){let e=null===x.calculatedDuration?(0,et.i)(x):x.calculatedDuration;return(0,s.X)(e)},get speed(){return b},set speed(newSpeed){if(newSpeed===b||!g)return;b=newSpeed,F.time=(0,s.X)(k)},get state(){return T},play:U,pause:()=>{T="paused",w=k},stop:()=>{_=!0,"idle"!==T&&(T="idle",c&&c(),O())},cancel:()=>{null!==R&&D(R),O()},complete:()=>{T="finished"},sample:e=>(A=0,D(e))};return F}let en=(n=()=>Object.hasOwnProperty.call(Element.prototype,"animate"),()=>(void 0===r&&(r=n()),r)),ea=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),es=(e,t)=>"spring"===t.type||"backgroundColor"===e||!function e(t){return!!(!t||"string"==typeof t&&c[t]||l(t)||Array.isArray(t)&&t.every(e))}(t.ease);var eo=i(51426);let el={type:"spring",stiffness:500,damping:25,restSpeed:10},eu=e=>({type:"spring",stiffness:550,damping:0===e?2*Math.sqrt(550):30,restSpeed:10}),ec={type:"keyframes",duration:.8},ed={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},eh=(e,{keyframes:t})=>t.length>2?ec:eo.G.has(e)?e.startsWith("scale")?eu(t[1]):el:ed,ef=(e,t)=>"zIndex"!==e&&!!("number"==typeof t||Array.isArray(t)||"string"==typeof t&&(B.P.test(t)||"0"===t)&&!t.startsWith("url("));var ep=i(27479),em=i(65483),eg=i(55237);let ev=(e,t,i,r={})=>n=>{let h=(0,eg.e)(r,e)||{},f=h.delay||r.delay||0,{elapsed:p=0}=r;p-=(0,s.w)(f);let m=function(e,t,i,r){let n,a;let s=ef(t,i);n=Array.isArray(i)?[...i]:[null,i];let o=void 0!==r.from?r.from:e.get(),l=[];for(let e=0;e<n.length;e++){var u;null===n[e]&&(n[e]=0===e?o:n[e-1]),("number"==typeof(u=n[e])?0===u:null!==u?"none"===u||"0"===u||(0,em.W)(u):void 0)&&l.push(e),"string"==typeof n[e]&&"none"!==n[e]&&"0"!==n[e]&&(a=n[e])}if(s&&l.length&&a)for(let e=0;e<l.length;e++){let i=l[e];n[i]=(0,ep.T)(t,a)}return n}(t,e,i,h),g=m[0],v=m[m.length-1],y=ef(e,g),b=ef(e,v);(0,a.K)(y===b,`You are trying to animate ${e} from "${g}" to "${v}". ${g} is not an animatable value - to enable this animation set ${g} to a value animatable to ${v} via the \`style\` property.`);let _={keyframes:m,velocity:t.getVelocity(),ease:"easeOut",...h,delay:-p,onUpdate:e=>{t.set(e),h.onUpdate&&h.onUpdate(e)},onComplete:()=>{n(),h.onComplete&&h.onComplete()}};if((0,eg.r)(h)||(_={..._,...eh(e,_)}),_.duration&&(_.duration=(0,s.w)(_.duration)),_.repeatDelay&&(_.repeatDelay=(0,s.w)(_.repeatDelay)),!y||!b||o.current||!1===h.type)return function({keyframes:e,delay:t,onUpdate:i,onComplete:r}){let n=()=>(i&&i(e[e.length-1]),r&&r(),{time:0,speed:1,duration:0,play:d.Z,pause:d.Z,stop:d.Z,then:e=>(e(),Promise.resolve()),cancel:d.Z,complete:d.Z});return t?er({keyframes:[0,1],duration:0,delay:t,onComplete:n}):n()}(o.current?{..._,delay:0}:_);if(t.owner&&t.owner.current instanceof HTMLElement&&!t.owner.getProps().onUpdate){let i=function(e,t,{onUpdate:i,onComplete:r,...n}){let a,o;let d=en()&&ea.has(t)&&!n.repeatDelay&&"mirror"!==n.repeatType&&0!==n.damping&&"inertia"!==n.type;if(!d)return!1;let h=!1,f=()=>{o=new Promise(e=>{a=e})};f();let{keyframes:p,duration:m=300,ease:g,times:v}=n;if(es(t,n)){let e=er({...n,repeat:0,delay:0}),t={done:!1,value:p[0]},i=[],r=0;for(;!t.done&&r<2e4;)i.push((t=e.sample(r)).value),r+=10;v=void 0,p=i,m=r-10,g="linear"}let y=function(e,t,i,{delay:r=0,duration:n,repeat:a=0,repeatType:s="loop",ease:o,times:d}={}){let h={[t]:i};d&&(h.offset=d);let f=function e(t){if(t)return l(t)?u(t):Array.isArray(t)?t.map(e):c[t]}(o);return Array.isArray(f)&&(h.easing=f),e.animate(h,{delay:r,duration:n,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:a+1,direction:"reverse"===s?"alternate":"normal"})}(e.owner.current,t,p,{...n,duration:m,ease:g,times:v}),b=()=>y.cancel(),_=()=>{Q.Wi.update(b),a(),f()};return y.onfinish=()=>{e.set(function(e,{repeat:t,repeatType:i="loop"}){let r=t&&"loop"!==i&&t%2==1?0:e.length-1;return e[r]}(p,n)),r&&r(),_()},{then:(e,t)=>o.then(e,t),get timeline(){return y.timeline},set timeline(timeline){y.timeline=timeline,y.onfinish=null},get time(){return(0,s.X)(y.currentTime||0)},set time(newTime){y.currentTime=(0,s.w)(newTime)},get speed(){return y.playbackRate},set speed(newSpeed){y.playbackRate=newSpeed},get duration(){return(0,s.X)(m)},play:()=>{h||(y.play(),(0,Q.Pn)(b))},pause:()=>y.pause(),stop:()=>{if(h=!0,"idle"===y.playState)return;let{currentTime:t}=y;if(t){let i=er({...n,autoplay:!1});e.setWithVelocity(i.sample(t-10).value,i.sample(t).value,10)}_()},complete:()=>y.finish(),cancel:_}}(t,e,_);if(i)return i}return er(_)}},10532:function(e,t,i){"use strict";i.d(t,{D:function(){return s}});var r=i(93939),n=i(9955),a=i(35978);function s(e,t,i){let s=(0,a.i)(e)?e:(0,n.B)(e);return s.start((0,r.v)("",s,t,i)),s.animation}},73452:function(e,t,i){"use strict";i.d(t,{w:function(){return c}});var r=i(51426),n=i(61816);let a="data-"+(0,n.D)("framerAppearId");var s=i(93939),o=i(58222),l=i(11444),u=i(4801);function c(e,t,{delay:i=0,transitionOverride:n,type:c}={}){let{transition:d=e.getDefaultTransition(),transitionEnd:h,...f}=e.makeTargetAnimatable(t),p=e.getValue("willChange");n&&(d=n);let m=[],g=c&&e.animationState&&e.animationState.getState()[c];for(let t in f){let n=e.getValue(t),l=f[t];if(!n||void 0===l||g&&function({protectedKeys:e,needsAnimating:t},i){let r=e.hasOwnProperty(i)&&!0!==t[i];return t[i]=!1,r}(g,t))continue;let c={delay:i,elapsed:0,...d};if(window.HandoffAppearAnimations&&!n.hasAnimated){let i=e.getProps()[a];i&&(c.elapsed=window.HandoffAppearAnimations(i,t,n,u.Wi))}n.start((0,s.v)(t,n,l,e.shouldReduceMotion&&r.G.has(t)?{type:!1}:c));let h=n.animation;(0,o.L)(p)&&(p.add(t),h.then(()=>p.remove(t))),m.push(h)}return h&&Promise.all(m).then(()=>{h&&(0,l.CD)(e,h)}),m}},65888:function(e,t,i){"use strict";i.d(t,{d:function(){return o}});var r=i(77643),n=i(73452);function a(e,t,i={}){let o=(0,r.x)(e,t,i.custom),{transition:l=e.getDefaultTransition()||{}}=o||{};i.transitionOverride&&(l=i.transitionOverride);let u=o?()=>Promise.all((0,n.w)(e,o,i)):()=>Promise.resolve(),c=e.variantChildren&&e.variantChildren.size?(r=0)=>{let{delayChildren:n=0,staggerChildren:o,staggerDirection:u}=l;return function(e,t,i=0,r=0,n=1,o){let l=[],u=(e.variantChildren.size-1)*r,c=1===n?(e=0)=>e*r:(e=0)=>u-e*r;return Array.from(e.variantChildren).sort(s).forEach((e,r)=>{e.notify("AnimationStart",t),l.push(a(e,t,{...o,delay:i+c(r)}).then(()=>e.notify("AnimationComplete",t)))}),Promise.all(l)}(e,t,n+r,o,u,i)}:()=>Promise.resolve(),{when:d}=l;if(!d)return Promise.all([u(),c(i.delay)]);{let[e,t]="beforeChildren"===d?[u,c]:[c,u];return e().then(()=>t())}}function s(e,t){return e.sortNodePosition(t)}function o(e,t,i={}){let s;if(e.notify("AnimationStart",t),Array.isArray(t)){let r=t.map(t=>a(e,t,i));s=Promise.all(r)}else if("string"==typeof t)s=a(e,t,i);else{let a="function"==typeof t?(0,r.x)(e,t,i.custom):t;s=Promise.all((0,n.w)(e,a,i))}return s.then(()=>e.notify("AnimationComplete",t))}},74626:function(e,t,i){"use strict";function r(e){return"object"==typeof e&&"function"==typeof e.start}i.d(t,{H:function(){return r}})},6619:function(e,t,i){"use strict";i.d(t,{C:function(){return r}});let r=e=>Array.isArray(e)},55237:function(e,t,i){"use strict";function r({when:e,delay:t,delayChildren:i,staggerChildren:r,staggerDirection:n,repeat:a,repeatType:s,repeatDelay:o,from:l,elapsed:u,...c}){return!!Object.keys(c).length}function n(e,t){return e[t]||e.default||e}i.d(t,{e:function(){return n},r:function(){return r}})},41438:function(e,t,i){"use strict";i.d(t,{p:function(){return n}});var r=i(50959);let n=(0,r.createContext)({})},30628:function(e,t,i){"use strict";i.d(t,{O:function(){return n}});var r=i(50959);let n=(0,r.createContext)(null)},11438:function(e,t,i){"use strict";i.d(t,{Bn:function(){return s},X7:function(){return o},Z7:function(){return a}});var r=i(63699),n=i(55023);let a=e=>1-Math.sin(Math.acos(e)),s=(0,n.M)(a),o=(0,r.o)(s)},63699:function(e,t,i){"use strict";i.d(t,{o:function(){return r}});let r=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2},55023:function(e,t,i){"use strict";i.d(t,{M:function(){return r}});let r=e=>t=>1-e(1-t)},62418:function(e,t,i){"use strict";i.d(t,{N:function(){return r}});let r=e=>Array.isArray(e)&&"number"!=typeof e[0]},4801:function(e,t,i){"use strict";i.d(t,{Pn:function(){return s},Wi:function(){return a},frameData:function(){return o},S6:function(){return l}});var r=i(63613);let n=["prepare","read","update","preRender","render","postRender"],{schedule:a,cancel:s,state:o,steps:l}=function(e,t){let i=!1,r=!0,a={delta:0,timestamp:0,isProcessing:!1},s=n.reduce((e,t)=>(e[t]=function(e){let t=[],i=[],r=0,n=!1,a=!1,s=new WeakSet,o={schedule:(e,a=!1,o=!1)=>{let l=o&&n,u=l?t:i;return a&&s.add(e),-1===u.indexOf(e)&&(u.push(e),l&&n&&(r=t.length)),e},cancel:e=>{let t=i.indexOf(e);-1!==t&&i.splice(t,1),s.delete(e)},process:l=>{if(n){a=!0;return}if(n=!0,[t,i]=[i,t],i.length=0,r=t.length)for(let i=0;i<r;i++){let r=t[i];r(l),s.has(r)&&(o.schedule(r),e())}n=!1,a&&(a=!1,o.process(l))}};return o}(()=>i=!0),e),{}),o=e=>s[e].process(a),l=s=>{i=!1,a.delta=r?1e3/60:Math.max(Math.min(s-a.timestamp,40),1),a.timestamp=s,a.isProcessing=!0,n.forEach(o),a.isProcessing=!1,i&&t&&(r=!1,e(l))},u=()=>{i=!0,r=!0,a.isProcessing||e(l)},c=n.reduce((e,t)=>{let r=s[t];return e[t]=(e,t=!1,n=!1)=>(i||u(),r.schedule(e,t,n)),e},{});return{schedule:c,cancel:e=>n.forEach(t=>s[t].cancel(e)),state:a,steps:s}}("undefined"!=typeof requestAnimationFrame?requestAnimationFrame:r.Z,!0)},90787:function(e,t,i){"use strict";i.d(t,{A:function(){return n}});let r={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},n={};for(let e in r)n[e]={isEnabled:t=>r[e].some(e=>!!t[e])}},6857:function(e,t,i){"use strict";i.d(t,{j:function(){return a}});var r=i(23265),n=i(51426);function a(e,{layout:t,layoutId:i}){return n.G.has(e)||e.startsWith("origin")||(t||void 0!==i)&&(!!r.P[e]||"opacity"===e)}},1497:function(e,t,i){"use strict";function r({top:e,left:t,right:i,bottom:r}){return{x:{min:t,max:i},y:{min:e,max:r}}}function n({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function a(e,t){if(!t)return e;let i=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:i.y,left:i.x,bottom:r.y,right:r.x}}i.d(t,{d7:function(){return a},i8:function(){return r},z2:function(){return n}})},87973:function(e,t,i){"use strict";i.d(t,{D2:function(){return m},YY:function(){return u},am:function(){return d},o2:function(){return l},q2:function(){return a}});var r=i(71605),n=i(40178);function a(e,t,i){return i+t*(e-i)}function s(e,t,i,r,n){return void 0!==n&&(e=r+n*(e-r)),r+i*(e-r)+t}function o(e,t=0,i=1,r,n){e.min=s(e.min,t,i,r,n),e.max=s(e.max,t,i,r,n)}function l(e,{x:t,y:i}){o(e.x,t.translate,t.scale,t.originPoint),o(e.y,i.translate,i.scale,i.originPoint)}function u(e,t,i,r=!1){let a,s;let o=i.length;if(o){t.x=t.y=1;for(let u=0;u<o;u++){s=(a=i[u]).projectionDelta;let o=a.instance;(!o||!o.style||"contents"!==o.style.display)&&(r&&a.options.layoutScroll&&a.scroll&&a!==a.root&&m(e,{x:-a.scroll.offset.x,y:-a.scroll.offset.y}),s&&(t.x*=s.x.scale,t.y*=s.y.scale,l(e,s)),r&&(0,n.ud)(a.latestValues)&&m(e,a.latestValues))}t.x=c(t.x),t.y=c(t.y)}}function c(e){return Number.isInteger(e)?e:e>1.0000000000001||e<.999999999999?e:1}function d(e,t){e.min=e.min+t,e.max=e.max+t}function h(e,t,[i,n,a]){let s=void 0!==t[a]?t[a]:.5,l=(0,r.C)(e.min,e.max,s);o(e,t[i],t[n],l,t.scale)}let f=["x","scaleX","originX"],p=["y","scaleY","originY"];function m(e,t){h(e.x,t,f),h(e.y,t,p)}},96510:function(e,t,i){"use strict";i.d(t,{dO:function(){return s},wc:function(){return n}});let r=()=>({translate:0,scale:1,origin:0,originPoint:0}),n=()=>({x:r(),y:r()}),a=()=>({min:0,max:0}),s=()=>({x:a(),y:a()})},23265:function(e,t,i){"use strict";i.d(t,{B:function(){return n},P:function(){return r}});let r={};function n(e){Object.assign(r,e)}},40178:function(e,t,i){"use strict";function r(e){return void 0===e||1===e}function n({scale:e,scaleX:t,scaleY:i}){return!r(e)||!r(t)||!r(i)}function a(e){return n(e)||s(e)||e.z||e.rotate||e.rotateX||e.rotateY}function s(e){var t,i;return(t=e.x)&&"0%"!==t||(i=e.y)&&"0%"!==i}i.d(t,{D_:function(){return s},Lj:function(){return n},ud:function(){return a}})},68594:function(e,t,i){"use strict";i.d(t,{J:function(){return a},z:function(){return s}});var r=i(1497),n=i(87973);function a(e,t){return(0,r.i8)((0,r.d7)(e.getBoundingClientRect(),t))}function s(e,t,i){let r=a(e,i),{scroll:s}=t;return s&&((0,n.am)(r.x,s.offset.x),(0,n.am)(r.y,s.offset.y)),r}},32926:function(e,t,i){"use strict";i.d(t,{J:function(){return $}});var r=i(11444),n=i(42281),a=i(43175);let s=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function o(e,t,i=1){(0,n.k)(i<=4,`Max CSS variable fallback depth detected in property "${e}". This may indicate a circular fallback dependency.`);let[r,l]=function(e){let t=s.exec(e);if(!t)return[,];let[,i,r]=t;return[i,r]}(e);if(!r)return;let u=window.getComputedStyle(t).getPropertyValue(r);return u?u.trim():(0,a.tm)(l)?o(l,t,i+1):l}var l=i(6619),u=i(51426),c=i(1930),d=i(50783),h=i(20265),f=i(37030);let p=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),m=e=>p.has(e),g=e=>Object.keys(e).some(m),v=e=>e===h.Rx||e===f.px,y=(e,t)=>parseFloat(e.split(", ")[t]),b=(e,t)=>(i,{transform:r})=>{if("none"===r||!r)return 0;let n=r.match(/^matrix3d\((.+)\)$/);if(n)return y(n[1],t);{let t=r.match(/^matrix\((.+)\)$/);return t?y(t[1],e):0}},_=new Set(["x","y","z"]),E=u._.filter(e=>!_.has(e)),S={width:({x:e},{paddingLeft:t="0",paddingRight:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),height:({y:e},{paddingTop:t="0",paddingBottom:i="0"})=>e.max-e.min-parseFloat(t)-parseFloat(i),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:b(4,13),y:b(5,14)};S.translateX=S.x,S.translateY=S.y;let x=(e,t,i)=>{let r=t.measureViewportBox(),n=t.current,a=getComputedStyle(n),{display:s}=a,o={};"none"===s&&t.setStaticValue("display",e.display||"block"),i.forEach(e=>{o[e]=S[e](r,a)}),t.render();let l=t.measureViewportBox();return i.forEach(i=>{let r=t.getValue(i);r&&r.jump(o[i]),e[i]=S[i](l,a)}),e},T=(e,t,i={},r={})=>{t={...t},r={...r};let a=Object.keys(t).filter(m),s=[],o=!1,u=[];if(a.forEach(a=>{let d;let h=e.getValue(a);if(!e.hasValue(a))return;let p=i[a],m=(0,c.C)(p),g=t[a];if((0,l.C)(g)){let e=g.length,t=null===g[0]?1:0;p=g[t],m=(0,c.C)(p);for(let i=t;i<e&&null!==g[i];i++)d?(0,n.k)((0,c.C)(g[i])===d,"All keyframes must be of the same type"):(d=(0,c.C)(g[i]),(0,n.k)(d===m||v(m)&&v(d),"Keyframes must be of the same dimension as the current value"))}else d=(0,c.C)(g);if(m!==d){if(v(m)&&v(d)){let e=h.get();"string"==typeof e&&h.set(parseFloat(e)),"string"==typeof g?t[a]=parseFloat(g):Array.isArray(g)&&d===f.px&&(t[a]=g.map(parseFloat))}else(null==m?void 0:m.transform)&&(null==d?void 0:d.transform)&&(0===p||0===g)?0===p?h.set(d.transform(p)):t[a]=m.transform(g):(o||(s=function(e){let t=[];return E.forEach(i=>{let r=e.getValue(i);void 0!==r&&(t.push([i,r.get()]),r.set(i.startsWith("scale")?1:0))}),t.length&&e.render(),t}(e),o=!0),u.push(a),r[a]=void 0!==r[a]?r[a]:t[a],h.jump(g))}}),!u.length)return{target:t,transitionEnd:r};{let i=u.indexOf("height")>=0?window.pageYOffset:null,n=x(t,e,u);return s.length&&s.forEach(([t,i])=>{e.getValue(t).set(i)}),e.render(),d.j&&null!==i&&window.scrollTo({top:i}),{target:n,transitionEnd:r}}},w=(e,t,i,r)=>{var n,s;let l=function(e,{...t},i){let r=e.current;if(!(r instanceof Element))return{target:t,transitionEnd:i};for(let n in i&&(i={...i}),e.values.forEach(e=>{let t=e.get();if(!(0,a.tm)(t))return;let i=o(t,r);i&&e.set(i)}),t){let e=t[n];if(!(0,a.tm)(e))continue;let s=o(e,r);s&&(t[n]=s,i||(i={}),void 0===i[n]&&(i[n]=e))}return{target:t,transitionEnd:i}}(e,t,r);return t=l.target,r=l.transitionEnd,n=t,s=r,g(n)?T(e,n,i,s):{target:n,transitionEnd:s}};var A=i(96510),M=i(29793);let R={current:null},C={current:!1};var I=i(60871),L=i(9955),k=i(58222),D=i(35978),P=i(36048),O=i(94385),N=i(27727),U=i(90787),F=i(42789),B=i(82617),V=i(4801);let z=Object.keys(U.A),j=z.length,H=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],G=F.V.length;class W{constructor({parent:e,props:t,presenceContext:i,reducedMotionConfig:r,visualState:n},a={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>V.Wi.render(this.render,!1,!0);let{latestValues:s,renderState:o}=n;this.latestValues=s,this.baseTarget={...s},this.initialValues=t.initial?{...s}:{},this.renderState=o,this.parent=e,this.props=t,this.presenceContext=i,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=a,this.isControllingVariants=(0,P.G)(t),this.isVariantNode=(0,P.M)(t),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);let{willChange:l,...u}=this.scrapeMotionValuesFromProps(t,{});for(let e in u){let t=u[e];void 0!==s[e]&&(0,D.i)(t)&&(t.set(s[e],!1),(0,k.L)(l)&&l.add(e))}}scrapeMotionValuesFromProps(e,t){return{}}mount(e){this.current=e,B.R.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((e,t)=>this.bindToMotionValue(t,e)),C.current||function(){if(C.current=!0,d.j){if(window.matchMedia){let e=window.matchMedia("(prefers-reduced-motion)"),t=()=>R.current=e.matches;e.addListener(t),t()}else R.current=!1}}(),this.shouldReduceMotion="never"!==this.reducedMotionConfig&&("always"===this.reducedMotionConfig||R.current),this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){for(let e in B.R.delete(this.current),this.projection&&this.projection.unmount(),(0,V.Pn)(this.notifyUpdate),(0,V.Pn)(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this),this.events)this.events[e].clear();for(let e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,t){let i=u.G.has(e),r=t.on("change",t=>{this.latestValues[e]=t,this.props.onUpdate&&V.Wi.update(this.notifyUpdate,!1,!0),i&&this.projection&&(this.projection.isTransformDirty=!0)}),n=t.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{r(),n()})}sortNodePosition(e){return this.current&&this.sortInstanceNodePosition&&this.type===e.type?this.sortInstanceNodePosition(this.current,e.current):0}loadFeatures({children:e,...t},i,r,n){let a,s;for(let e=0;e<j;e++){let i=z[e],{isEnabled:r,Feature:n,ProjectionNode:o,MeasureLayout:l}=U.A[i];o&&(a=o),r(t)&&(!this.features[i]&&n&&(this.features[i]=new n(this)),l&&(s=l))}if(!this.projection&&a){this.projection=new a(this.latestValues,this.parent&&this.parent.projection);let{layoutId:e,layout:i,drag:r,dragConstraints:s,layoutScroll:o,layoutRoot:l}=t;this.projection.setOptions({layoutId:e,layout:i,alwaysMeasureLayout:!!r||s&&(0,M.I)(s),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:"string"==typeof i?i:"both",initialPromotionConfig:n,layoutScroll:o,layoutRoot:l})}return s}updateFeatures(){for(let e in this.features){let t=this.features[e];t.isMounted?t.update():(t.mount(),t.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):(0,A.dO)()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,t){this.latestValues[e]=t}makeTargetAnimatable(e,t=!0){return this.makeTargetAnimatableFromInstance(e,this.props,t)}update(e,t){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=t;for(let t=0;t<H.length;t++){let i=H[t];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);let r=e["on"+i];r&&(this.propEventSubscriptions[i]=this.on(i,r))}this.prevMotionValues=function(e,t,i){let{willChange:r}=t;for(let n in t){let a=t[n],s=i[n];if((0,D.i)(a))e.addValue(n,a),(0,k.L)(r)&&r.add(n);else if((0,D.i)(s))e.addValue(n,(0,L.B)(a,{owner:e})),(0,k.L)(r)&&r.remove(n);else if(s!==a){if(e.hasValue(n)){let t=e.getValue(n);t.hasAnimated||t.set(a)}else{let t=e.getStaticValue(n);e.addValue(n,(0,L.B)(void 0!==t?t:a,{owner:e}))}}}for(let r in i)void 0===t[r]&&e.removeValue(r);return t}(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){let e=this.parent&&this.parent.getVariantContext()||{};return void 0!==this.props.initial&&(e.initial=this.props.initial),e}let t={};for(let e=0;e<G;e++){let i=F.V[e],r=this.props[i];((0,O.$)(r)||!1===r)&&(t[i]=r)}return t}addVariantChild(e){let t=this.getClosestVariantNode();if(t)return t.variantChildren&&t.variantChildren.add(e),()=>t.variantChildren.delete(e)}addValue(e,t){t!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,t)),this.values.set(e,t),this.latestValues[e]=t.get()}removeValue(e){this.values.delete(e);let t=this.valueSubscriptions.get(e);t&&(t(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,t){if(this.props.values&&this.props.values[e])return this.props.values[e];let i=this.values.get(e);return void 0===i&&void 0!==t&&(i=(0,L.B)(t,{owner:this}),this.addValue(e,i)),i}readValue(e){var t;return void 0===this.latestValues[e]&&this.current?null!==(t=this.getBaseTargetFromProps(this.props,e))&&void 0!==t?t:this.readValueFromInstance(this.current,e,this.options):this.latestValues[e]}setBaseTarget(e,t){this.baseTarget[e]=t}getBaseTarget(e){var t;let{initial:i}=this.props,r="string"==typeof i||"object"==typeof i?null===(t=(0,N.o)(this.props,i))||void 0===t?void 0:t[e]:void 0;if(i&&void 0!==r)return r;let n=this.getBaseTargetFromProps(this.props,e);return void 0===n||(0,D.i)(n)?void 0!==this.initialValues[e]&&void 0===r?void 0:this.baseTarget[e]:n}on(e,t){return this.events[e]||(this.events[e]=new I.L),this.events[e].add(t)}notify(e,...t){this.events[e]&&this.events[e].notify(...t)}}class $ extends W{sortInstanceNodePosition(e,t){return 2&e.compareDocumentPosition(t)?1:-1}getBaseTargetFromProps(e,t){return e.style?e.style[t]:void 0}removeValueFromRenderState(e,{vars:t,style:i}){delete t[e],delete i[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:t,...i},{transformValues:n},a){let s=(0,r.P$)(i,e||{},this);if(n&&(t&&(t=n(t)),i&&(i=n(i)),s&&(s=n(s))),a){(0,r.GJ)(this,i,s);let e=w(this,i,s,t);t=e.transitionEnd,i=e.target}return{transition:e,transitionEnd:t,...i}}}},59295:function(e,t,i){"use strict";let r;i.d(t,{E:function(){return t8}});var n,a=i(50959);let s=(0,a.createContext)({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"}),o=(0,a.createContext)({});var l=i(30628),u=i(59089);let c=(0,a.createContext)({strict:!1});var d=i(29793),h=i(94385),f=i(36048);function p(e){return Array.isArray(e)?e.join(" "):e}var m=i(90787),g=i(50783),v=i(41438);let y=(0,a.createContext)({}),b=Symbol.for("motionComponentSymbol"),_=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function E(e){if("string"!=typeof e||e.includes("-"));else if(_.indexOf(e)>-1||/[A-Z]/.test(e))return!0;return!1}var S=i(6857),x=i(35978),T=i(63475);let w=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function A(e,t,i){for(let r in t)(0,x.i)(t[r])||(0,S.j)(r,i)||(e[r]=t[r])}function M(e,t,i){let r={},n=function(e,t,i){let r=e.style||{},n={};return A(n,r,e),Object.assign(n,function({transformTemplate:e},t,i){return(0,a.useMemo)(()=>{let r=w();return(0,T.r)(r,t,{enableHardwareAcceleration:!i},e),Object.assign({},r.vars,r.style)},[t])}(e,t,i)),e.transformValues?e.transformValues(n):n}(e,t,i);return e.drag&&!1!==e.dragListener&&(r.draggable=!1,n.userSelect=n.WebkitUserSelect=n.WebkitTouchCallout="none",n.touchAction=!0===e.drag?"none":`pan-${"x"===e.drag?"y":"x"}`),void 0===e.tabIndex&&(e.onTap||e.onTapStart||e.whileTap)&&(r.tabIndex=0),r.style=n,r}let R=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onLayoutAnimationStart","onLayoutAnimationComplete","onLayoutMeasure","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","ignoreStrict","viewport"]);function C(e){return e.startsWith("while")||e.startsWith("drag")&&"draggable"!==e||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||R.has(e)}let I=e=>!C(e);try{(n=require("@emotion/is-prop-valid").default)&&(I=e=>e.startsWith("on")?!C(e):n(e))}catch(e){}var L=i(36155);let k=()=>({...w(),attrs:{}});var D=i(70135);function P(e,t,i,r){let n=(0,a.useMemo)(()=>{let i=k();return(0,L.i)(i,t,{enableHardwareAcceleration:!1},(0,D.a)(r),e.transformTemplate),{...i.attrs,style:{...i.style}}},[t]);if(e.style){let t={};A(t,e.style,e),n.style={...t,...n.style}}return n}var O=i(67256),N=i(17162),U=i(74626),F=i(27727),B=i(23090),V=i(86289);function z(e){let t=(0,x.i)(e)?e.get():e;return(0,V.p)(t)?t.toValue():t}let j=e=>(t,i)=>{let r=(0,a.useContext)(o),n=(0,a.useContext)(l.O),s=()=>(function({scrapeMotionValuesFromProps:e,createRenderState:t,onMount:i},r,n,a){let s={latestValues:function(e,t,i,r){let n={},a=r(e,{});for(let e in a)n[e]=z(a[e]);let{initial:s,animate:o}=e,l=(0,f.G)(e),u=(0,f.M)(e);t&&u&&!l&&!1!==e.inherit&&(void 0===s&&(s=t.initial),void 0===o&&(o=t.animate));let c=!!i&&!1===i.initial;c=c||!1===s;let d=c?o:s;if(d&&"boolean"!=typeof d&&!(0,U.H)(d)){let t=Array.isArray(d)?d:[d];t.forEach(t=>{let i=(0,F.o)(e,t);if(!i)return;let{transitionEnd:r,transition:a,...s}=i;for(let e in s){let t=s[e];if(Array.isArray(t)){let e=c?t.length-1:0;t=t[e]}null!==t&&(n[e]=t)}for(let e in r)n[e]=r[e]})}return n}(r,n,a,e),renderState:t()};return i&&(s.mount=e=>i(r,e,s)),s})(e,t,r,n);return i?s():(0,B.h)(s)},H={useVisualState:j({scrapeMotionValuesFromProps:N.U,createRenderState:k,onMount:(e,t,{renderState:i,latestValues:r})=>{try{i.dimensions="function"==typeof t.getBBox?t.getBBox():t.getBoundingClientRect()}catch(e){i.dimensions={x:0,y:0,width:0,height:0}}(0,L.i)(i,r,{enableHardwareAcceleration:!1},(0,D.a)(t.tagName),e.transformTemplate),(0,O.K)(t,i)}})};var G=i(3993);let W={useVisualState:j({scrapeMotionValuesFromProps:G.U,createRenderState:w})};function $(e,t,i,r={passive:!0}){return e.addEventListener(t,i,r),()=>e.removeEventListener(t,i)}let q=e=>"mouse"===e.pointerType?"number"!=typeof e.button||e.button<=0:!1!==e.isPrimary;function Y(e,t="page"){return{point:{x:e[t+"X"],y:e[t+"Y"]}}}let K=e=>t=>q(t)&&e(t,Y(t));function X(e,t,i,r){return $(e,t,K(i),r)}var Z=i(56893);function J(e){let t=null;return()=>null===t&&(t=e,()=>{t=null})}let Q=J("dragHorizontal"),ee=J("dragVertical");function et(e){let t=!1;if("y"===e)t=ee();else if("x"===e)t=Q();else{let e=Q(),i=ee();e&&i?t=()=>{e(),i()}:(e&&e(),i&&i())}return t}function ei(){let e=et(!0);return!e||(e(),!1)}class er{constructor(e){this.isMounted=!1,this.node=e}update(){}}var en=i(4801);function ea(e,t){let i="pointer"+(t?"enter":"leave"),r="onHover"+(t?"Start":"End");return X(e.current,i,(i,n)=>{if("touch"===i.type||ei())return;let a=e.getProps();e.animationState&&a.whileHover&&e.animationState.setActive("whileHover",t),a[r]&&en.Wi.update(()=>a[r](i,n))},{passive:!e.getProps()[r]})}let es=(e,t)=>!!t&&(e===t||es(e,t.parentElement));var eo=i(63613);function el(e,t){if(!t)return;let i=new PointerEvent("pointer"+e);t(i,Y(i))}let eu=new WeakMap,ec=new WeakMap,ed=e=>{let t=eu.get(e.target);t&&t(e)},eh=e=>{e.forEach(ed)},ef={some:0,all:1};var ep=i(6619);function em(e,t){if(!Array.isArray(t))return!1;let i=t.length;if(i!==e.length)return!1;for(let r=0;r<i;r++)if(t[r]!==e[r])return!1;return!0}var eg=i(77643),ev=i(42789),ey=i(65888);let eb=[...ev.e].reverse(),e_=ev.e.length;function eE(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}let eS=0;var ex=i(42281),eT=i(13537);let ew=(e,t)=>Math.abs(e-t);class eA{constructor(e,t,{transformPagePoint:i}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let e=eC(this.lastMoveEventInfo,this.history),t=null!==this.startEvent,i=function(e,t){let i=ew(e.x,t.x),r=ew(e.y,t.y);return Math.sqrt(i**2+r**2)}(e.offset,{x:0,y:0})>=3;if(!t&&!i)return;let{point:r}=e,{timestamp:n}=en.frameData;this.history.push({...r,timestamp:n});let{onStart:a,onMove:s}=this.handlers;t||(a&&a(this.lastMoveEvent,e),this.startEvent=this.lastMoveEvent),s&&s(this.lastMoveEvent,e)},this.handlePointerMove=(e,t)=>{this.lastMoveEvent=e,this.lastMoveEventInfo=eM(t,this.transformPagePoint),en.Wi.update(this.updatePoint,!0)},this.handlePointerUp=(e,t)=>{if(this.end(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;let{onEnd:i,onSessionEnd:r}=this.handlers,n=eC("pointercancel"===e.type?this.lastMoveEventInfo:eM(t,this.transformPagePoint),this.history);this.startEvent&&i&&i(e,n),r&&r(e,n)},!q(e))return;this.handlers=t,this.transformPagePoint=i;let r=Y(e),n=eM(r,this.transformPagePoint),{point:a}=n,{timestamp:s}=en.frameData;this.history=[{...a,timestamp:s}];let{onSessionStart:o}=t;o&&o(e,eC(n,this.history)),this.removeListeners=(0,Z.z)(X(window,"pointermove",this.handlePointerMove),X(window,"pointerup",this.handlePointerUp),X(window,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),(0,en.Pn)(this.updatePoint)}}function eM(e,t){return t?{point:t(e.point)}:e}function eR(e,t){return{x:e.x-t.x,y:e.y-t.y}}function eC({point:e},t){return{point:e,delta:eR(e,eI(t)),offset:eR(e,t[0]),velocity:function(e,t){if(e.length<2)return{x:0,y:0};let i=e.length-1,r=null,n=eI(e);for(;i>=0&&(r=e[i],!(n.timestamp-r.timestamp>(0,eT.w)(.1)));)i--;if(!r)return{x:0,y:0};let a=(0,eT.X)(n.timestamp-r.timestamp);if(0===a)return{x:0,y:0};let s={x:(n.x-r.x)/a,y:(n.y-r.y)/a};return s.x===1/0&&(s.x=0),s.y===1/0&&(s.y=0),s}(t,0)}}function eI(e){return e[e.length-1]}var eL=i(45974),ek=i(71605);function eD(e){return e.max-e.min}function eP(e,t=0,i=.01){return Math.abs(e-t)<=i}function eO(e,t,i,r=.5){e.origin=r,e.originPoint=(0,ek.C)(t.min,t.max,e.origin),e.scale=eD(i)/eD(t),(eP(e.scale,1,1e-4)||isNaN(e.scale))&&(e.scale=1),e.translate=(0,ek.C)(i.min,i.max,e.origin)-e.originPoint,(eP(e.translate)||isNaN(e.translate))&&(e.translate=0)}function eN(e,t,i,r){eO(e.x,t.x,i.x,r?r.originX:void 0),eO(e.y,t.y,i.y,r?r.originY:void 0)}function eU(e,t,i){e.min=i.min+t.min,e.max=e.min+eD(t)}function eF(e,t,i){e.min=t.min-i.min,e.max=e.min+eD(t)}function eB(e,t,i){eF(e.x,t.x,i.x),eF(e.y,t.y,i.y)}var eV=i(83883);function ez(e,t,i){return{min:void 0!==t?e.min+t:void 0,max:void 0!==i?e.max+i-(e.max-e.min):void 0}}function ej(e,t){let i=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([i,r]=[r,i]),{min:i,max:r}}function eH(e,t,i){return{min:eG(e,t),max:eG(e,i)}}function eG(e,t){return"number"==typeof e?e:e[t]||0}var eW=i(96510);function e$(e){return[e("x"),e("y")]}var eq=i(68594),eY=i(1497),eK=i(37030),eX=i(93939);let eZ=new WeakMap;class eJ{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=(0,eW.dO)(),this.visualElement=e}start(e,{snapToCursor:t=!1}={}){let{presenceContext:i}=this.visualElement;i&&!1===i.isPresent||(this.panSession=new eA(e,{onSessionStart:e=>{this.stopAnimation(),t&&this.snapToCursor(Y(e,"page").point)},onStart:(e,t)=>{let{drag:i,dragPropagation:r,onDragStart:n}=this.getProps();if(i&&!r&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=et(i),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),e$(e=>{let t=this.getAxisMotionValue(e).get()||0;if(eK.aQ.test(t)){let{projection:i}=this.visualElement;if(i&&i.layout){let r=i.layout.layoutBox[e];if(r){let e=eD(r);t=e*(parseFloat(t)/100)}}}this.originPoint[e]=t}),n&&en.Wi.update(()=>n(e,t),!1,!0);let{animationState:a}=this.visualElement;a&&a.setActive("whileDrag",!0)},onMove:(e,t)=>{let{dragPropagation:i,dragDirectionLock:r,onDirectionLock:n,onDrag:a}=this.getProps();if(!i&&!this.openGlobalLock)return;let{offset:s}=t;if(r&&null===this.currentDirection){this.currentDirection=function(e,t=10){let i=null;return Math.abs(e.y)>t?i="y":Math.abs(e.x)>t&&(i="x"),i}(s),null!==this.currentDirection&&n&&n(this.currentDirection);return}this.updateAxis("x",t.point,s),this.updateAxis("y",t.point,s),this.visualElement.render(),a&&a(e,t)},onSessionEnd:(e,t)=>this.stop(e,t)},{transformPagePoint:this.visualElement.getTransformPagePoint()}))}stop(e,t){let i=this.isDragging;if(this.cancel(),!i)return;let{velocity:r}=t;this.startAnimation(r);let{onDragEnd:n}=this.getProps();n&&en.Wi.update(()=>n(e,t))}cancel(){this.isDragging=!1;let{projection:e,animationState:t}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;let{dragPropagation:i}=this.getProps();!i&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),t&&t.setActive("whileDrag",!1)}updateAxis(e,t,i){let{drag:r}=this.getProps();if(!i||!eQ(e,r,this.currentDirection))return;let n=this.getAxisMotionValue(e),a=this.originPoint[e]+i[e];this.constraints&&this.constraints[e]&&(a=function(e,{min:t,max:i},r){return void 0!==t&&e<t?e=r?(0,ek.C)(t,e,r.min):Math.max(e,t):void 0!==i&&e>i&&(e=r?(0,ek.C)(i,e,r.max):Math.min(e,i)),e}(a,this.constraints[e],this.elastic[e])),n.set(a)}resolveConstraints(){let{dragConstraints:e,dragElastic:t}=this.getProps(),{layout:i}=this.visualElement.projection||{},r=this.constraints;e&&(0,d.I)(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&i?this.constraints=function(e,{top:t,left:i,bottom:r,right:n}){return{x:ez(e.x,i,n),y:ez(e.y,t,r)}}(i.layoutBox,e):this.constraints=!1,this.elastic=function(e=.35){return!1===e?e=0:!0===e&&(e=.35),{x:eH(e,"left","right"),y:eH(e,"top","bottom")}}(t),r!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&e$(e=>{this.getAxisMotionValue(e)&&(this.constraints[e]=function(e,t){let i={};return void 0!==t.min&&(i.min=t.min-e.min),void 0!==t.max&&(i.max=t.max-e.min),i}(i.layoutBox[e],this.constraints[e]))})}resolveRefConstraints(){var e;let{dragConstraints:t,onMeasureDragConstraints:i}=this.getProps();if(!t||!(0,d.I)(t))return!1;let r=t.current;(0,ex.k)(null!==r,"If `dragConstraints` is set as a React ref, that ref must be passed to another component's `ref` prop.");let{projection:n}=this.visualElement;if(!n||!n.layout)return!1;let a=(0,eq.z)(r,n.root,this.visualElement.getTransformPagePoint()),s={x:ej((e=n.layout.layoutBox).x,a.x),y:ej(e.y,a.y)};if(i){let e=i((0,eY.z2)(s));this.hasMutatedConstraints=!!e,e&&(s=(0,eY.i8)(e))}return s}startAnimation(e){let{drag:t,dragMomentum:i,dragElastic:r,dragTransition:n,dragSnapToOrigin:a,onDragTransitionEnd:s}=this.getProps(),o=this.constraints||{},l=e$(s=>{if(!eQ(s,t,this.currentDirection))return;let l=o&&o[s]||{};a&&(l={min:0,max:0});let u={type:"inertia",velocity:i?e[s]:0,bounceStiffness:r?200:1e6,bounceDamping:r?40:1e7,timeConstant:750,restDelta:1,restSpeed:10,...n,...l};return this.startAxisValueAnimation(s,u)});return Promise.all(l).then(s)}startAxisValueAnimation(e,t){let i=this.getAxisMotionValue(e);return i.start((0,eX.v)(e,i,0,t))}stopAnimation(){e$(e=>this.getAxisMotionValue(e).stop())}getAxisMotionValue(e){let t="_drag"+e.toUpperCase(),i=this.visualElement.getProps(),r=i[t];return r||this.visualElement.getValue(e,(i.initial?i.initial[e]:void 0)||0)}snapToCursor(e){e$(t=>{let{drag:i}=this.getProps();if(!eQ(t,i,this.currentDirection))return;let{projection:r}=this.visualElement,n=this.getAxisMotionValue(t);if(r&&r.layout){let{min:i,max:a}=r.layout.layoutBox[t];n.set(e[t]-(0,ek.C)(i,a,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;let{drag:e,dragConstraints:t}=this.getProps(),{projection:i}=this.visualElement;if(!(0,d.I)(t)||!i||!this.constraints)return;this.stopAnimation();let r={x:0,y:0};e$(e=>{let t=this.getAxisMotionValue(e);if(t){let i=t.get();r[e]=function(e,t){let i=.5,r=eD(e),n=eD(t);return n>r?i=(0,eL.Y)(t.min,t.max-r,e.min):r>n&&(i=(0,eL.Y)(e.min,e.max-n,t.min)),(0,eV.u)(0,1,i)}({min:i,max:i},this.constraints[e])}});let{transformTemplate:n}=this.visualElement.getProps();this.visualElement.current.style.transform=n?n({},""):"none",i.root&&i.root.updateScroll(),i.updateLayout(),this.resolveConstraints(),e$(t=>{if(!eQ(t,e,null))return;let i=this.getAxisMotionValue(t),{min:n,max:a}=this.constraints[t];i.set((0,ek.C)(n,a,r[t]))})}addListeners(){if(!this.visualElement.current)return;eZ.set(this.visualElement,this);let e=this.visualElement.current,t=X(e,"pointerdown",e=>{let{drag:t,dragListener:i=!0}=this.getProps();t&&i&&this.start(e)}),i=()=>{let{dragConstraints:e}=this.getProps();(0,d.I)(e)&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,n=r.addEventListener("measure",i);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),i();let a=$(window,"resize",()=>this.scalePositionWithinConstraints()),s=r.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t})=>{this.isDragging&&t&&(e$(t=>{let i=this.getAxisMotionValue(t);i&&(this.originPoint[t]+=e[t].translate,i.set(i.get()+e[t].translate))}),this.visualElement.render())});return()=>{a(),t(),n(),s&&s()}}getProps(){let e=this.visualElement.getProps(),{drag:t=!1,dragDirectionLock:i=!1,dragPropagation:r=!1,dragConstraints:n=!1,dragElastic:a=.35,dragMomentum:s=!0}=e;return{...e,drag:t,dragDirectionLock:i,dragPropagation:r,dragConstraints:n,dragElastic:a,dragMomentum:s}}}function eQ(e,t,i){return(!0===t||t===e)&&(null===i||i===e)}let e0=e=>(t,i)=>{e&&en.Wi.update(()=>e(t,i))},e1={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function e2(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}let e3={correct:(e,t)=>{if(!t.target)return e;if("string"==typeof e){if(!eK.px.test(e))return e;e=parseFloat(e)}let i=e2(e,t.target.x),r=e2(e,t.target.y);return`${i}% ${r}%`}};var e5=i(34989),e4=i(23265);class e6 extends a.Component{componentDidMount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:i,layoutId:r}=this.props,{projection:n}=e;(0,e4.B)(e7),n&&(t.group&&t.group.add(n),i&&i.register&&r&&i.register(n),n.root.didUpdate(),n.addEventListener("animationComplete",()=>{this.safeToRemove()}),n.setOptions({...n.options,onExitComplete:()=>this.safeToRemove()})),e1.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){let{layoutDependency:t,visualElement:i,drag:r,isPresent:n}=this.props,a=i.projection;return a&&(a.isPresent=n,r||e.layoutDependency!==t||void 0===t?a.willUpdate():this.safeToRemove(),e.isPresent===n||(n?a.promote():a.relegate()||en.Wi.postRender(()=>{let e=a.getStack();e&&e.members.length||this.safeToRemove()}))),null}componentDidUpdate(){let{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){let{visualElement:e,layoutGroup:t,switchLayoutGroup:i}=this.props,{projection:r}=e;r&&(r.scheduleCheckAfterUnmount(),t&&t.group&&t.group.remove(r),i&&i.deregister&&i.deregister(r))}safeToRemove(){let{safeToRemove:e}=this.props;e&&e()}render(){return null}}function e8(e){let[t,i]=function(){let e=(0,a.useContext)(l.O);if(null===e)return[!0,null];let{isPresent:t,onExitComplete:i,register:r}=e,n=(0,a.useId)();return(0,a.useEffect)(()=>r(n),[]),!t&&i?[!1,()=>i&&i(n)]:[!0]}(),r=(0,a.useContext)(v.p);return a.createElement(e6,{...e,layoutGroup:r,switchLayoutGroup:(0,a.useContext)(y),isPresent:t,safeToRemove:i})}let e7={borderRadius:{...e3,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:e3,borderTopRightRadius:e3,borderBottomLeftRadius:e3,borderBottomRightRadius:e3,boxShadow:{correct:(e,{treeScale:t,projectionDelta:i})=>{let r=e5.P.parse(e);if(r.length>5)return e;let n=e5.P.createTransformer(e),a="number"!=typeof r[0]?1:0,s=i.x.scale*t.x,o=i.y.scale*t.y;r[0+a]/=s,r[1+a]/=o;let l=(0,ek.C)(s,o,.5);return"number"==typeof r[2+a]&&(r[2+a]/=l),"number"==typeof r[3+a]&&(r[3+a]/=l),n(r)}}};var e9=i(60871),te=i(11438);let tt=["TopLeft","TopRight","BottomLeft","BottomRight"],ti=tt.length,tr=e=>"string"==typeof e?parseFloat(e):e,tn=e=>"number"==typeof e||eK.px.test(e);function ta(e,t){return void 0!==e[t]?e[t]:e.borderRadius}let ts=tl(0,.5,te.Bn),to=tl(.5,.95,eo.Z);function tl(e,t,i){return r=>r<e?0:r>t?1:i((0,eL.Y)(e,t,r))}function tu(e,t){e.min=t.min,e.max=t.max}function tc(e,t){tu(e.x,t.x),tu(e.y,t.y)}var td=i(87973);function th(e,t,i,r,n){return e-=t,e=(0,td.q2)(e,1/i,r),void 0!==n&&(e=(0,td.q2)(e,1/n,r)),e}function tf(e,t,[i,r,n],a,s){!function(e,t=0,i=1,r=.5,n,a=e,s=e){if(eK.aQ.test(t)){t=parseFloat(t);let e=(0,ek.C)(s.min,s.max,t/100);t=e-s.min}if("number"!=typeof t)return;let o=(0,ek.C)(a.min,a.max,r);e===a&&(o-=t),e.min=th(e.min,t,i,o,n),e.max=th(e.max,t,i,o,n)}(e,t[i],t[r],t[n],t.scale,a,s)}let tp=["x","scaleX","originX"],tm=["y","scaleY","originY"];function tg(e,t,i,r){tf(e.x,t,tp,i?i.x:void 0,r?r.x:void 0),tf(e.y,t,tm,i?i.y:void 0,r?r.y:void 0)}var tv=i(55237);function ty(e){return 0===e.translate&&1===e.scale}function tb(e){return ty(e.x)&&ty(e.y)}function t_(e,t){return e.x.min===t.x.min&&e.x.max===t.x.max&&e.y.min===t.y.min&&e.y.max===t.y.max}function tE(e){return eD(e.x)/eD(e.y)}var tS=i(21017);class tx{constructor(){this.members=[]}add(e){(0,tS.y4)(this.members,e),e.scheduleRender()}remove(e){if((0,tS.cl)(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){let e=this.members[this.members.length-1];e&&this.promote(e)}}relegate(e){let t;let i=this.members.findIndex(t=>e===t);if(0===i)return!1;for(let e=i;e>=0;e--){let i=this.members[e];if(!1!==i.isPresent){t=i;break}}return!!t&&(this.promote(t),!0)}promote(e,t){let i=this.lead;if(e!==i&&(this.prevLead=i,this.lead=e,e.show(),i)){i.instance&&i.scheduleRender(),e.scheduleRender(),e.resumeFrom=i,t&&(e.resumeFrom.preserveOpacity=!0),i.snapshot&&(e.snapshot=i.snapshot,e.snapshot.latestValues=i.animationValues||i.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);let{crossfade:r}=e.options;!1===r&&i.hide()}}exitAnimationComplete(){this.members.forEach(e=>{let{options:t,resumingFrom:i}=e;t.onExitComplete&&t.onExitComplete(),i&&i.options.onExitComplete&&i.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function tT(e,t,i){let r="",n=e.x.translate/t.x,a=e.y.translate/t.y;if((n||a)&&(r=`translate3d(${n}px, ${a}px, 0) `),(1!==t.x||1!==t.y)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),i){let{rotate:e,rotateX:t,rotateY:n}=i;e&&(r+=`rotate(${e}deg) `),t&&(r+=`rotateX(${t}deg) `),n&&(r+=`rotateY(${n}deg) `)}let s=e.x.scale*t.x,o=e.y.scale*t.y;return(1!==s||1!==o)&&(r+=`scale(${s}, ${o})`),r||"none"}var tw=i(40178);let tA=(e,t)=>e.depth-t.depth;class tM{constructor(){this.children=[],this.isDirty=!1}add(e){(0,tS.y4)(this.children,e),this.isDirty=!0}remove(e){(0,tS.cl)(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(tA),this.isDirty=!1,this.children.forEach(e)}}var tR=i(68327),tC=i(10532);let tI=["","X","Y","Z"],tL=0,tk={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function tD({attachResizeListener:e,defaultParent:t,measureScroll:i,checkIsScrollRoot:n,resetTransform:a}){return class{constructor(e={},i=null==t?void 0:t()){this.id=tL++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{tk.totalNodes=tk.resolvedTargetDeltas=tk.recalculatedProjection=0,this.nodes.forEach(tN),this.nodes.forEach(tH),this.nodes.forEach(tG),this.nodes.forEach(tU),window.MotionDebug&&window.MotionDebug.record(tk)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=e,this.root=i?i.root||i:this,this.path=i?[...i.path,i]:[],this.parent=i,this.depth=i?i.depth+1:0;for(let e=0;e<this.path.length;e++)this.path[e].shouldResetTransform=!0;this.root===this&&(this.nodes=new tM)}addEventListener(e,t){return this.eventHandlers.has(e)||this.eventHandlers.set(e,new e9.L),this.eventHandlers.get(e).add(t)}notifyListeners(e,...t){let i=this.eventHandlers.get(e);i&&i.notify(...t)}hasListeners(e){return this.eventHandlers.has(e)}mount(t,i=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=(0,tR.v)(t),this.instance=t;let{layoutId:r,layout:n,visualElement:a}=this.options;if(a&&!a.current&&a.mount(t),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),i&&(n||r)&&(this.isLayoutDirty=!0),e){let i;let r=()=>this.root.updateBlockedByResize=!1;e(t,()=>{this.root.updateBlockedByResize=!0,i&&i(),i=function(e,t){let i=performance.now(),r=({timestamp:n})=>{let a=n-i;a>=t&&((0,en.Pn)(r),e(a-t))};return en.Wi.read(r,!0),()=>(0,en.Pn)(r)}(r,250),e1.hasAnimatedSinceResize&&(e1.hasAnimatedSinceResize=!1,this.nodes.forEach(tj))})}r&&this.root.registerSharedNode(r,this),!1!==this.options.animate&&a&&(r||n)&&this.addEventListener("didUpdate",({delta:e,hasLayoutChanged:t,hasRelativeTargetChanged:i,layout:r})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}let n=this.options.transition||a.getDefaultTransition()||tX,{onLayoutAnimationStart:s,onLayoutAnimationComplete:o}=a.getProps(),l=!this.targetLayout||!t_(this.targetLayout,r)||i,u=!t&&i;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||u||t&&(l||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(e,u);let t={...(0,tv.e)(n,"layout"),onPlay:s,onComplete:o};(a.shouldReduceMotion||this.options.layoutRoot)&&(t.delay=0,t.type=!1),this.startAnimation(t)}else t||tj(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=r})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);let e=this.getStack();e&&e.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,(0,en.Pn)(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){!this.isUpdateBlocked()&&(this.isUpdating=!0,this.nodes&&this.nodes.forEach(tW),this.animationId++)}getTransformTemplate(){let{visualElement:e}=this.options;return e&&e.getProps().transformTemplate}willUpdate(e=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(this.root.isUpdating||this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let e=0;e<this.path.length;e++){let t=this.path[e];t.shouldResetTransform=!0,t.updateScroll("snapshot"),t.options.layoutRoot&&t.willUpdate(!1)}let{layoutId:t,layout:i}=this.options;if(void 0===t&&!i)return;let r=this.getTransformTemplate();this.prevTransformTemplateValue=r?r(this.latestValues,""):void 0,this.updateSnapshot(),e&&this.notifyListeners("willUpdate")}update(){this.updateScheduled=!1;let e=this.isUpdateBlocked();if(e){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(tB);return}this.isUpdating||this.nodes.forEach(tV),this.isUpdating=!1,this.nodes.forEach(tz),this.nodes.forEach(tP),this.nodes.forEach(tO),this.clearAllSnapshots();let t=performance.now();en.frameData.delta=(0,eV.u)(0,1e3/60,t-en.frameData.timestamp),en.frameData.timestamp=t,en.frameData.isProcessing=!0,en.S6.update.process(en.frameData),en.S6.preRender.process(en.frameData),en.S6.render.process(en.frameData),en.frameData.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(tF),this.sharedNodes.forEach(t$)}scheduleUpdateProjection(){en.Wi.preRender(this.updateProjection,!1,!0)}scheduleCheckAfterUnmount(){en.Wi.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){!this.snapshot&&this.instance&&(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let e=0;e<this.path.length;e++){let t=this.path[e];t.updateScroll()}let e=this.layout;this.layout=this.measure(!1),this.layoutCorrected=(0,eW.dO)(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);let{visualElement:t}=this.options;t&&t.notify("LayoutMeasure",this.layout.layoutBox,e?e.layoutBox:void 0)}updateScroll(e="measure"){let t=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===e&&(t=!1),t&&(this.scroll={animationId:this.root.animationId,phase:e,isRoot:n(this.instance),offset:i(this.instance)})}resetTransform(){if(!a)return;let e=this.isLayoutDirty||this.shouldResetTransform,t=this.projectionDelta&&!tb(this.projectionDelta),i=this.getTransformTemplate(),r=i?i(this.latestValues,""):void 0,n=r!==this.prevTransformTemplateValue;e&&(t||(0,tw.ud)(this.latestValues)||n)&&(a(this.instance,r),this.shouldResetTransform=!1,this.scheduleRender())}measure(e=!0){var t;let i=this.measurePageBox(),n=this.removeElementScroll(i);return e&&(n=this.removeTransform(n)),t=n,r||(r=tZ()?Math.round:e=>Math.round(2*e)/2),tJ(t.x),tJ(t.y),{animationId:this.root.animationId,measuredBox:i,layoutBox:n,latestValues:{},source:this.id}}measurePageBox(){let{visualElement:e}=this.options;if(!e)return(0,eW.dO)();let t=e.measureViewportBox(),{scroll:i}=this.root;return i&&((0,td.am)(t.x,i.offset.x),(0,td.am)(t.y,i.offset.y)),t}removeElementScroll(e){let t=(0,eW.dO)();tc(t,e);for(let i=0;i<this.path.length;i++){let r=this.path[i],{scroll:n,options:a}=r;if(r!==this.root&&n&&a.layoutScroll){if(n.isRoot){tc(t,e);let{scroll:i}=this.root;i&&((0,td.am)(t.x,-i.offset.x),(0,td.am)(t.y,-i.offset.y))}(0,td.am)(t.x,n.offset.x),(0,td.am)(t.y,n.offset.y)}}return t}applyTransform(e,t=!1){let i=(0,eW.dO)();tc(i,e);for(let e=0;e<this.path.length;e++){let r=this.path[e];!t&&r.options.layoutScroll&&r.scroll&&r!==r.root&&(0,td.D2)(i,{x:-r.scroll.offset.x,y:-r.scroll.offset.y}),(0,tw.ud)(r.latestValues)&&(0,td.D2)(i,r.latestValues)}return(0,tw.ud)(this.latestValues)&&(0,td.D2)(i,this.latestValues),i}removeTransform(e){let t=(0,eW.dO)();tc(t,e);for(let e=0;e<this.path.length;e++){let i=this.path[e];if(!i.instance||!(0,tw.ud)(i.latestValues))continue;(0,tw.Lj)(i.latestValues)&&i.updateSnapshot();let r=(0,eW.dO)(),n=i.measurePageBox();tc(r,n),tg(t,i.latestValues,i.snapshot?i.snapshot.layoutBox:void 0,r)}return(0,tw.ud)(this.latestValues)&&tg(t,this.latestValues),t}setTargetDelta(e){this.targetDelta=e,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(e){this.options={...this.options,...e,crossfade:void 0===e.crossfade||e.crossfade}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==en.frameData.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(e=!1){var t,i,r,n;let a=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=a.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=a.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=a.isSharedProjectionDirty);let s=!!this.resumingFrom||this!==a,o=!(e||s&&this.isSharedProjectionDirty||this.isProjectionDirty||(null===(t=this.parent)||void 0===t?void 0:t.isProjectionDirty)||this.attemptToResolveRelativeTarget);if(o)return;let{layout:l,layoutId:u}=this.options;if(this.layout&&(l||u)){if(this.resolvedRelativeTargetAt=en.frameData.timestamp,!this.targetDelta&&!this.relativeTarget){let e=this.getClosestProjectingParent();e&&e.layout&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=(0,eW.dO)(),this.relativeTargetOrigin=(0,eW.dO)(),eB(this.relativeTargetOrigin,this.layout.layoutBox,e.layout.layoutBox),tc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(this.relativeTarget||this.targetDelta){if((this.target||(this.target=(0,eW.dO)(),this.targetWithTransforms=(0,eW.dO)()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target)?(this.forceRelativeParentToResolveTarget(),i=this.target,r=this.relativeTarget,n=this.relativeParent.target,eU(i.x,r.x,n.x),eU(i.y,r.y,n.y)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):tc(this.target,this.layout.layoutBox),(0,td.o2)(this.target,this.targetDelta)):tc(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;let e=this.getClosestProjectingParent();e&&!!e.resumingFrom==!!this.resumingFrom&&!e.options.layoutScroll&&e.target&&1!==this.animationProgress?(this.relativeParent=e,this.forceRelativeParentToResolveTarget(),this.relativeTarget=(0,eW.dO)(),this.relativeTargetOrigin=(0,eW.dO)(),eB(this.relativeTargetOrigin,this.target,e.target),tc(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}tk.resolvedTargetDeltas++}}}getClosestProjectingParent(){return!this.parent||(0,tw.Lj)(this.parent.latestValues)||(0,tw.D_)(this.parent.latestValues)?void 0:this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var e;let t=this.getLead(),i=!!this.resumingFrom||this!==t,r=!0;if((this.isProjectionDirty||(null===(e=this.parent)||void 0===e?void 0:e.isProjectionDirty))&&(r=!1),i&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(r=!1),this.resolvedRelativeTargetAt===en.frameData.timestamp&&(r=!1),r)return;let{layout:n,layoutId:a}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(n||a))return;tc(this.layoutCorrected,this.layout.layoutBox);let s=this.treeScale.x,o=this.treeScale.y;(0,td.YY)(this.layoutCorrected,this.treeScale,this.path,i),t.layout&&!t.target&&(1!==this.treeScale.x||1!==this.treeScale.y)&&(t.target=t.layout.layoutBox);let{target:l}=t;if(!l){this.projectionTransform&&(this.projectionDelta=(0,eW.wc)(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=(0,eW.wc)(),this.projectionDeltaWithTransform=(0,eW.wc)());let u=this.projectionTransform;eN(this.projectionDelta,this.layoutCorrected,l,this.latestValues),this.projectionTransform=tT(this.projectionDelta,this.treeScale),(this.projectionTransform!==u||this.treeScale.x!==s||this.treeScale.y!==o)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",l)),tk.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(e=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),e){let e=this.getStack();e&&e.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(e,t=!1){let i;let r=this.snapshot,n=r?r.latestValues:{},a={...this.latestValues},s=(0,eW.wc)();this.relativeParent&&this.relativeParent.options.layoutRoot||(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!t;let o=(0,eW.dO)(),l=r?r.source:void 0,u=this.layout?this.layout.source:void 0,c=l!==u,d=this.getStack(),h=!d||d.members.length<=1,f=!!(c&&!h&&!0===this.options.crossfade&&!this.path.some(tK));this.animationProgress=0,this.mixTargetDelta=t=>{var r,l;let u=t/1e3;tq(s.x,e.x,u),tq(s.y,e.y,u),this.setTargetDelta(s),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(eB(o,this.layout.layoutBox,this.relativeParent.layout.layoutBox),r=this.relativeTarget,l=this.relativeTargetOrigin,tY(r.x,l.x,o.x,u),tY(r.y,l.y,o.y,u),i&&t_(this.relativeTarget,i)&&(this.isProjectionDirty=!1),i||(i=(0,eW.dO)()),tc(i,this.relativeTarget)),c&&(this.animationValues=a,function(e,t,i,r,n,a){n?(e.opacity=(0,ek.C)(0,void 0!==i.opacity?i.opacity:1,ts(r)),e.opacityExit=(0,ek.C)(void 0!==t.opacity?t.opacity:1,0,to(r))):a&&(e.opacity=(0,ek.C)(void 0!==t.opacity?t.opacity:1,void 0!==i.opacity?i.opacity:1,r));for(let n=0;n<ti;n++){let a=`border${tt[n]}Radius`,s=ta(t,a),o=ta(i,a);if(void 0===s&&void 0===o)continue;s||(s=0),o||(o=0);let l=0===s||0===o||tn(s)===tn(o);l?(e[a]=Math.max((0,ek.C)(tr(s),tr(o),r),0),(eK.aQ.test(o)||eK.aQ.test(s))&&(e[a]+="%")):e[a]=o}(t.rotate||i.rotate)&&(e.rotate=(0,ek.C)(t.rotate||0,i.rotate||0,r))}(a,n,this.latestValues,u,f,h)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=u},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(e){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&((0,en.Pn)(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=en.Wi.update(()=>{e1.hasAnimatedSinceResize=!0,this.currentAnimation=(0,tC.D)(0,1e3,{...e,onUpdate:t=>{this.mixTargetDelta(t),e.onUpdate&&e.onUpdate(t)},onComplete:()=>{e.onComplete&&e.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);let e=this.getStack();e&&e.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(1e3),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){let e=this.getLead(),{targetWithTransforms:t,target:i,layout:r,latestValues:n}=e;if(t&&i&&r){if(this!==e&&this.layout&&r&&tQ(this.options.animationType,this.layout.layoutBox,r.layoutBox)){i=this.target||(0,eW.dO)();let t=eD(this.layout.layoutBox.x);i.x.min=e.target.x.min,i.x.max=i.x.min+t;let r=eD(this.layout.layoutBox.y);i.y.min=e.target.y.min,i.y.max=i.y.min+r}tc(t,i),(0,td.D2)(t,n),eN(this.projectionDeltaWithTransform,this.layoutCorrected,t,n)}}registerSharedNode(e,t){this.sharedNodes.has(e)||this.sharedNodes.set(e,new tx);let i=this.sharedNodes.get(e);i.add(t);let r=t.options.initialPromotionConfig;t.promote({transition:r?r.transition:void 0,preserveFollowOpacity:r&&r.shouldPreserveFollowOpacity?r.shouldPreserveFollowOpacity(t):void 0})}isLead(){let e=this.getStack();return!e||e.lead===this}getLead(){var e;let{layoutId:t}=this.options;return t&&(null===(e=this.getStack())||void 0===e?void 0:e.lead)||this}getPrevLead(){var e;let{layoutId:t}=this.options;return t?null===(e=this.getStack())||void 0===e?void 0:e.prevLead:void 0}getStack(){let{layoutId:e}=this.options;if(e)return this.root.sharedNodes.get(e)}promote({needsReset:e,transition:t,preserveFollowOpacity:i}={}){let r=this.getStack();r&&r.promote(this,i),e&&(this.projectionDelta=void 0,this.needsReset=!0),t&&this.setOptions({transition:t})}relegate(){let e=this.getStack();return!!e&&e.relegate(this)}resetRotation(){let{visualElement:e}=this.options;if(!e)return;let t=!1,{latestValues:i}=e;if((i.rotate||i.rotateX||i.rotateY||i.rotateZ)&&(t=!0),!t)return;let r={};for(let t=0;t<tI.length;t++){let n="rotate"+tI[t];i[n]&&(r[n]=i[n],e.setStaticValue(n,0))}for(let t in e.render(),r)e.setStaticValue(t,r[t]);e.scheduleRender()}getProjectionStyles(e={}){var t,i;let r={};if(!this.instance||this.isSVG)return r;if(!this.isVisible)return{visibility:"hidden"};r.visibility="";let n=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,r.opacity="",r.pointerEvents=z(e.pointerEvents)||"",r.transform=n?n(this.latestValues,""):"none",r;let a=this.getLead();if(!this.projectionDelta||!this.layout||!a.target){let t={};return this.options.layoutId&&(t.opacity=void 0!==this.latestValues.opacity?this.latestValues.opacity:1,t.pointerEvents=z(e.pointerEvents)||""),this.hasProjected&&!(0,tw.ud)(this.latestValues)&&(t.transform=n?n({},""):"none",this.hasProjected=!1),t}let s=a.animationValues||a.latestValues;this.applyTransformsToTarget(),r.transform=tT(this.projectionDeltaWithTransform,this.treeScale,s),n&&(r.transform=n(s,r.transform));let{x:o,y:l}=this.projectionDelta;for(let e in r.transformOrigin=`${100*o.origin}% ${100*l.origin}% 0`,a.animationValues?r.opacity=a===this?null!==(i=null!==(t=s.opacity)&&void 0!==t?t:this.latestValues.opacity)&&void 0!==i?i:1:this.preserveOpacity?this.latestValues.opacity:s.opacityExit:r.opacity=a===this?void 0!==s.opacity?s.opacity:"":void 0!==s.opacityExit?s.opacityExit:0,e4.P){if(void 0===s[e])continue;let{correct:t,applyTo:i}=e4.P[e],n="none"===r.transform?s[e]:t(s[e],a);if(i){let e=i.length;for(let t=0;t<e;t++)r[i[t]]=n}else r[e]=n}return this.options.layoutId&&(r.pointerEvents=a===this?z(e.pointerEvents)||"":"none"),r}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(e=>{var t;return null===(t=e.currentAnimation)||void 0===t?void 0:t.stop()}),this.root.nodes.forEach(tB),this.root.sharedNodes.clear()}}}function tP(e){e.updateLayout()}function tO(e){var t;let i=(null===(t=e.resumeFrom)||void 0===t?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&i&&e.hasListeners("didUpdate")){let{layoutBox:t,measuredBox:r}=e.layout,{animationType:n}=e.options,a=i.source!==e.layout.source;"size"===n?e$(e=>{let r=a?i.measuredBox[e]:i.layoutBox[e],n=eD(r);r.min=t[e].min,r.max=r.min+n}):tQ(n,i.layoutBox,t)&&e$(r=>{let n=a?i.measuredBox[r]:i.layoutBox[r],s=eD(t[r]);n.max=n.min+s,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[r].max=e.relativeTarget[r].min+s)});let s=(0,eW.wc)();eN(s,t,i.layoutBox);let o=(0,eW.wc)();a?eN(o,e.applyTransform(r,!0),i.measuredBox):eN(o,t,i.layoutBox);let l=!tb(s),u=!1;if(!e.resumeFrom){let r=e.getClosestProjectingParent();if(r&&!r.resumeFrom){let{snapshot:n,layout:a}=r;if(n&&a){let s=(0,eW.dO)();eB(s,i.layoutBox,n.layoutBox);let o=(0,eW.dO)();eB(o,t,a.layoutBox),t_(s,o)||(u=!0),r.options.layoutRoot&&(e.relativeTarget=o,e.relativeTargetOrigin=s,e.relativeParent=r)}}}e.notifyListeners("didUpdate",{layout:t,snapshot:i,delta:o,layoutDelta:s,hasLayoutChanged:l,hasRelativeTargetChanged:u})}else if(e.isLead()){let{onExitComplete:t}=e.options;t&&t()}e.options.transition=void 0}function tN(e){tk.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function tU(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function tF(e){e.clearSnapshot()}function tB(e){e.clearMeasurements()}function tV(e){e.isLayoutDirty=!1}function tz(e){let{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function tj(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function tH(e){e.resolveTargetDelta()}function tG(e){e.calcProjection()}function tW(e){e.resetRotation()}function t$(e){e.removeLeadSnapshot()}function tq(e,t,i){e.translate=(0,ek.C)(t.translate,0,i),e.scale=(0,ek.C)(t.scale,1,i),e.origin=t.origin,e.originPoint=t.originPoint}function tY(e,t,i,r){e.min=(0,ek.C)(t.min,i.min,r),e.max=(0,ek.C)(t.max,i.max,r)}function tK(e){return e.animationValues&&void 0!==e.animationValues.opacityExit}let tX={duration:.45,ease:[.4,0,.1,1]},tZ=()=>navigator.userAgent.toLowerCase().includes("applewebkit/");function tJ(e){e.min=r(e.min),e.max=r(e.max)}function tQ(e,t,i){return"position"===e||"preserve-aspect"===e&&!eP(tE(t),tE(i),.2)}let t0=tD({attachResizeListener:(e,t)=>$(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),t1={current:void 0},t2=tD({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!t1.current){let e=new t0({});e.mount(window),e.setOptions({layoutScroll:!0}),t1.current=e}return t1.current},resetTransform:(e,t)=>{e.style.transform=void 0!==t?t:"none"},checkIsScrollRoot:e=>"fixed"===window.getComputedStyle(e).position});var t3=i(58651),t5=i(99537);let t4=(e,t)=>E(e)?new t5.e(t,{enableHardwareAcceleration:!1}):new t3.W(t,{enableHardwareAcceleration:!0}),t6={animation:{Feature:class extends er{constructor(e){super(e),e.animationState||(e.animationState=function(e){let t=t=>Promise.all(t.map(({animation:t,options:i})=>(0,ey.d)(e,t,i))),i={animate:eE(!0),whileInView:eE(),whileHover:eE(),whileTap:eE(),whileDrag:eE(),whileFocus:eE(),exit:eE()},r=!0,n=(t,i)=>{let r=(0,eg.x)(e,i);if(r){let{transition:e,transitionEnd:i,...n}=r;t={...t,...n,...i}}return t};function a(a,s){let o=e.getProps(),l=e.getVariantContext(!0)||{},u=[],c=new Set,d={},f=1/0;for(let t=0;t<e_;t++){var p;let m=eb[t],g=i[m],v=void 0!==o[m]?o[m]:l[m],y=(0,h.$)(v),b=m===s?g.isActive:null;!1===b&&(f=t);let _=v===l[m]&&v!==o[m]&&y;if(_&&r&&e.manuallyAnimateOnMount&&(_=!1),g.protectedKeys={...d},!g.isActive&&null===b||!v&&!g.prevProp||(0,U.H)(v)||"boolean"==typeof v)continue;let E=(p=g.prevProp,"string"==typeof v?v!==p:!!Array.isArray(v)&&!em(v,p)),S=E||m===s&&g.isActive&&!_&&y||t>f&&y,x=Array.isArray(v)?v:[v],T=x.reduce(n,{});!1===b&&(T={});let{prevResolvedValues:w={}}=g,A={...w,...T},M=e=>{S=!0,c.delete(e),g.needsAnimating[e]=!0};for(let e in A){let t=T[e],i=w[e];d.hasOwnProperty(e)||(t!==i?(0,ep.C)(t)&&(0,ep.C)(i)?!em(t,i)||E?M(e):g.protectedKeys[e]=!0:void 0!==t?M(e):c.add(e):void 0!==t&&c.has(e)?M(e):g.protectedKeys[e]=!0)}g.prevProp=v,g.prevResolvedValues=T,g.isActive&&(d={...d,...T}),r&&e.blockInitialAnimation&&(S=!1),S&&!_&&u.push(...x.map(e=>({animation:e,options:{type:m,...a}})))}if(c.size){let t={};c.forEach(i=>{let r=e.getBaseTarget(i);void 0!==r&&(t[i]=r)}),u.push({animation:t})}let m=!!u.length;return r&&!1===o.initial&&!e.manuallyAnimateOnMount&&(m=!1),r=!1,m?t(u):Promise.resolve()}return{animateChanges:a,setActive:function(t,r,n){var s;if(i[t].isActive===r)return Promise.resolve();null===(s=e.variantChildren)||void 0===s||s.forEach(e=>{var i;return null===(i=e.animationState)||void 0===i?void 0:i.setActive(t,r)}),i[t].isActive=r;let o=a(n,t);for(let e in i)i[e].protectedKeys={};return o},setAnimateFunction:function(i){t=i(e)},getState:()=>i}}(e))}updateAnimationControlsSubscription(){let{animate:e}=this.node.getProps();this.unmount(),(0,U.H)(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){let{animate:e}=this.node.getProps(),{animate:t}=this.node.prevProps||{};e!==t&&this.updateAnimationControlsSubscription()}unmount(){}}},exit:{Feature:class extends er{constructor(){super(...arguments),this.id=eS++}update(){if(!this.node.presenceContext)return;let{isPresent:e,onExitComplete:t,custom:i}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===r)return;let n=this.node.animationState.setActive("exit",!e,{custom:null!=i?i:this.node.getProps().custom});t&&!e&&n.then(()=>t(this.id))}mount(){let{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}},inView:{Feature:class extends er{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();let{viewport:e={}}=this.node.getProps(),{root:t,margin:i,amount:r="some",once:n}=e,a={root:t?t.current:void 0,rootMargin:i,threshold:"number"==typeof r?r:ef[r]};return function(e,t,i){let r=function({root:e,...t}){let i=e||document;ec.has(i)||ec.set(i,{});let r=ec.get(i),n=JSON.stringify(t);return r[n]||(r[n]=new IntersectionObserver(eh,{root:e,...t})),r[n]}(t);return eu.set(e,i),r.observe(e),()=>{eu.delete(e),r.unobserve(e)}}(this.node.current,a,e=>{let{isIntersecting:t}=e;if(this.isInView===t||(this.isInView=t,n&&!t&&this.hasEnteredView))return;t&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",t);let{onViewportEnter:i,onViewportLeave:r}=this.node.getProps(),a=t?i:r;a&&a(e)})}mount(){this.startObserver()}update(){if("undefined"==typeof IntersectionObserver)return;let{props:e,prevProps:t}=this.node,i=["amount","margin","root"].some(function({viewport:e={}},{viewport:t={}}={}){return i=>e[i]!==t[i]}(e,t));i&&this.startObserver()}unmount(){}}},tap:{Feature:class extends er{constructor(){super(...arguments),this.removeStartListeners=eo.Z,this.removeEndListeners=eo.Z,this.removeAccessibleListeners=eo.Z,this.startPointerPress=(e,t)=>{if(this.removeEndListeners(),this.isPressing)return;let i=this.node.getProps(),r=X(window,"pointerup",(e,t)=>{if(!this.checkPressEnd())return;let{onTap:i,onTapCancel:r}=this.node.getProps();en.Wi.update(()=>{es(this.node.current,e.target)?i&&i(e,t):r&&r(e,t)})},{passive:!(i.onTap||i.onPointerUp)}),n=X(window,"pointercancel",(e,t)=>this.cancelPress(e,t),{passive:!(i.onTapCancel||i.onPointerCancel)});this.removeEndListeners=(0,Z.z)(r,n),this.startPress(e,t)},this.startAccessiblePress=()=>{let e=$(this.node.current,"keydown",e=>{"Enter"!==e.key||this.isPressing||(this.removeEndListeners(),this.removeEndListeners=$(this.node.current,"keyup",e=>{"Enter"===e.key&&this.checkPressEnd()&&el("up",(e,t)=>{let{onTap:i}=this.node.getProps();i&&en.Wi.update(()=>i(e,t))})}),el("down",(e,t)=>{this.startPress(e,t)}))}),t=$(this.node.current,"blur",()=>{this.isPressing&&el("cancel",(e,t)=>this.cancelPress(e,t))});this.removeAccessibleListeners=(0,Z.z)(e,t)}}startPress(e,t){this.isPressing=!0;let{onTapStart:i,whileTap:r}=this.node.getProps();r&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),i&&en.Wi.update(()=>i(e,t))}checkPressEnd(){this.removeEndListeners(),this.isPressing=!1;let e=this.node.getProps();return e.whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!ei()}cancelPress(e,t){if(!this.checkPressEnd())return;let{onTapCancel:i}=this.node.getProps();i&&en.Wi.update(()=>i(e,t))}mount(){let e=this.node.getProps(),t=X(this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),i=$(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=(0,Z.z)(t,i)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}},focus:{Feature:class extends er{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch(t){e=!0}e&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){this.isActive&&this.node.animationState&&(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=(0,Z.z)($(this.node.current,"focus",()=>this.onFocus()),$(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}},hover:{Feature:class extends er{mount(){this.unmount=(0,Z.z)(ea(this.node,!0),ea(this.node,!1))}unmount(){}}},pan:{Feature:class extends er{constructor(){super(...arguments),this.removePointerDownListener=eo.Z}onPointerDown(e){this.session=new eA(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint()})}createPanHandlers(){let{onPanSessionStart:e,onPanStart:t,onPan:i,onPanEnd:r}=this.node.getProps();return{onSessionStart:e0(e),onStart:e0(t),onMove:i,onEnd:(e,t)=>{delete this.session,r&&en.Wi.update(()=>r(e,t))}}}mount(){this.removePointerDownListener=X(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}},drag:{Feature:class extends er{constructor(e){super(e),this.removeGroupControls=eo.Z,this.removeListeners=eo.Z,this.controls=new eJ(e)}mount(){let{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||eo.Z}unmount(){this.removeGroupControls(),this.removeListeners()}},ProjectionNode:t2,MeasureLayout:e8},layout:{ProjectionNode:t2,MeasureLayout:e8}},t8=function(e){function t(t,i={}){return function({preloadedFeatures:e,createVisualElement:t,useRender:i,useVisualState:r,Component:n}){e&&function(e){for(let t in e)m.A[t]={...m.A[t],...e[t]}}(e);let _=(0,a.forwardRef)(function(m,b){var _;let E;let S={...(0,a.useContext)(s),...m,layoutId:function({layoutId:e}){let t=(0,a.useContext)(v.p).id;return t&&void 0!==e?t+"-"+e:e}(m)},{isStatic:x}=S,T=function(e){let{initial:t,animate:i}=function(e,t){if((0,f.G)(e)){let{initial:t,animate:i}=e;return{initial:!1===t||(0,h.$)(t)?t:void 0,animate:(0,h.$)(i)?i:void 0}}return!1!==e.inherit?t:{}}(e,(0,a.useContext)(o));return(0,a.useMemo)(()=>({initial:t,animate:i}),[p(t),p(i)])}(m),w=r(m,x);if(!x&&g.j){T.visualElement=function(e,t,i,r){let{visualElement:n}=(0,a.useContext)(o),d=(0,a.useContext)(c),h=(0,a.useContext)(l.O),f=(0,a.useContext)(s).reducedMotion,p=(0,a.useRef)();r=r||d.renderer,!p.current&&r&&(p.current=r(e,{visualState:t,parent:n,props:i,presenceContext:h,blockInitialAnimation:!!h&&!1===h.initial,reducedMotionConfig:f}));let m=p.current;(0,a.useInsertionEffect)(()=>{m&&m.update(i,h)}),(0,u.L)(()=>{m&&m.render()}),(0,a.useEffect)(()=>{m&&m.updateFeatures()});let g=window.HandoffAppearAnimations?u.L:a.useEffect;return g(()=>{m&&m.animationState&&m.animationState.animateChanges()}),m}(n,w,S,t);let i=(0,a.useContext)(y),r=(0,a.useContext)(c).strict;T.visualElement&&(E=T.visualElement.loadFeatures(S,r,e,i))}return a.createElement(o.Provider,{value:T},E&&T.visualElement?a.createElement(E,{visualElement:T.visualElement,...S}):null,i(n,m,(_=T.visualElement,(0,a.useCallback)(e=>{e&&w.mount&&w.mount(e),_&&(e?_.mount(e):_.unmount()),b&&("function"==typeof b?b(e):(0,d.I)(b)&&(b.current=e))},[_])),w,x,T.visualElement))});return _[b]=n,_}(e(t,i))}if("undefined"==typeof Proxy)return t;let i=new Map;return new Proxy(t,{get:(e,r)=>(i.has(r)||i.set(r,t(r)),i.get(r))})}((e,t)=>(function(e,{forwardMotionProps:t=!1},i,r){let n=E(e)?H:W;return{...n,preloadedFeatures:i,useRender:function(e=!1){return(t,i,r,{latestValues:n},s)=>{let o=E(t)?P:M,l=o(i,n,s,t),u=function(e,t,i){let r={};for(let n in e)("values"!==n||"object"!=typeof e.values)&&(I(n)||!0===i&&C(n)||!t&&!C(n)||e.draggable&&n.startsWith("onDrag"))&&(r[n]=e[n]);return r}(i,"string"==typeof t,e),c={...u,...l,ref:r},{children:d}=i,h=(0,a.useMemo)(()=>(0,x.i)(d)?d.get():d,[d]);return(0,a.createElement)(t,{...c,children:h})}}(t),createVisualElement:r,Component:e}})(e,t,t6,t4))},61816:function(e,t,i){"use strict";i.d(t,{D:function(){return r}});let r=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},43175:function(e,t,i){"use strict";i.d(t,{Xp:function(){return s},f9:function(){return n},tm:function(){return a}});let r=e=>t=>"string"==typeof t&&t.startsWith(e),n=r("--"),a=r("var(--"),s=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g},68327:function(e,t,i){"use strict";function r(e){return e instanceof SVGElement&&"svg"!==e.tagName}i.d(t,{v:function(){return r}})},82188:function(e,t,i){"use strict";i.d(t,{I:function(){return n}});var r=i(42281);function n(e,t,i){var n;if("string"==typeof e){let a=document;t&&((0,r.k)(!!t.current,"Scope provided, but no element detected."),a=t.current),i?(null!==(n=i[e])&&void 0!==n||(i[e]=a.querySelectorAll(e)),e=i[e]):e=a.querySelectorAll(e)}else e instanceof Element&&(e=[e]);return Array.from(e||[])}},27479:function(e,t,i){"use strict";i.d(t,{T:function(){return s}});var r=i(34989),n=i(87482),a=i(28253);function s(e,t){let i=(0,a.A)(e);return i!==n.h&&(i=r.P),i.getAnimatableNone?i.getAnimatableNone(t):void 0}},28253:function(e,t,i){"use strict";i.d(t,{A:function(){return o}});var r=i(9161),n=i(87482),a=i(31340);let s={...a.j,color:r.$,backgroundColor:r.$,outlineColor:r.$,fill:r.$,stroke:r.$,borderColor:r.$,borderTopColor:r.$,borderRightColor:r.$,borderBottomColor:r.$,borderLeftColor:r.$,filter:n.h,WebkitFilter:n.h},o=e=>s[e]},1930:function(e,t,i){"use strict";i.d(t,{$:function(){return s},C:function(){return o}});var r=i(20265),n=i(37030),a=i(85824);let s=[r.Rx,n.px,n.aQ,n.RW,n.vw,n.vh,{test:e=>"auto"===e,parse:e=>e}],o=e=>s.find((0,a.l)(e))},31340:function(e,t,i){"use strict";i.d(t,{j:function(){return s}});var r=i(20265),n=i(37030);let a={...r.Rx,transform:Math.round},s={borderWidth:n.px,borderTopWidth:n.px,borderRightWidth:n.px,borderBottomWidth:n.px,borderLeftWidth:n.px,borderRadius:n.px,radius:n.px,borderTopLeftRadius:n.px,borderTopRightRadius:n.px,borderBottomRightRadius:n.px,borderBottomLeftRadius:n.px,width:n.px,maxWidth:n.px,height:n.px,maxHeight:n.px,size:n.px,top:n.px,right:n.px,bottom:n.px,left:n.px,padding:n.px,paddingTop:n.px,paddingRight:n.px,paddingBottom:n.px,paddingLeft:n.px,margin:n.px,marginTop:n.px,marginRight:n.px,marginBottom:n.px,marginLeft:n.px,rotate:n.RW,rotateX:n.RW,rotateY:n.RW,rotateZ:n.RW,scale:r.bA,scaleX:r.bA,scaleY:r.bA,scaleZ:r.bA,skew:n.RW,skewX:n.RW,skewY:n.RW,distance:n.px,translateX:n.px,translateY:n.px,translateZ:n.px,x:n.px,y:n.px,z:n.px,perspective:n.px,transformPerspective:n.px,opacity:r.Fq,originX:n.$C,originY:n.$C,originZ:n.px,zIndex:a,fillOpacity:r.Fq,strokeOpacity:r.Fq,numOctaves:a}},85824:function(e,t,i){"use strict";i.d(t,{l:function(){return r}});let r=e=>t=>t.test(e)},58651:function(e,t,i){"use strict";i.d(t,{W:function(){return h}});var r=i(63475),n=i(43175),a=i(51426),s=i(3993),o=i(17399),l=i(28253),u=i(68594),c=i(32926),d=i(35978);class h extends c.J{readValueFromInstance(e,t){if(a.G.has(t)){let e=(0,l.A)(t);return e&&e.default||0}{let i=window.getComputedStyle(e),r=((0,n.f9)(t)?i.getPropertyValue(t):i[t])||0;return"string"==typeof r?r.trim():r}}measureInstanceViewportBox(e,{transformPagePoint:t}){return(0,u.J)(e,t)}build(e,t,i,n){(0,r.r)(e,t,i,n.transformTemplate)}scrapeMotionValuesFromProps(e,t){return(0,s.U)(e,t)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);let{children:e}=this.props;(0,d.i)(e)&&(this.childSubscription=e.on("change",e=>{this.current&&(this.current.textContent=`${e}`)}))}renderInstance(e,t,i,r){(0,o.N)(e,t,i,r)}}},63475:function(e,t,i){"use strict";i.d(t,{r:function(){return u}});var r=i(51426);let n={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},a=r._.length;var s=i(43175);let o=(e,t)=>t&&"number"==typeof e?t.transform(e):e;var l=i(31340);function u(e,t,i,u){let{style:c,vars:d,transform:h,transformOrigin:f}=e,p=!1,m=!1,g=!0;for(let e in t){let i=t[e];if((0,s.f9)(e)){d[e]=i;continue}let n=l.j[e],a=o(i,n);if(r.G.has(e)){if(p=!0,h[e]=a,!g)continue;i!==(n.default||0)&&(g=!1)}else e.startsWith("origin")?(m=!0,f[e]=a):c[e]=a}if(!t.transform&&(p||u?c.transform=function(e,{enableHardwareAcceleration:t=!0,allowTransformNone:i=!0},s,o){let l="";for(let t=0;t<a;t++){let i=r._[t];if(void 0!==e[i]){let t=n[i]||i;l+=`${t}(${e[i]}) `}}return t&&!e.z&&(l+="translateZ(0)"),l=l.trim(),o?l=o(e,s?"":l):i&&s&&(l="none"),l}(e.transform,i,g,u):c.transform&&(c.transform="none")),m){let{originX:e="50%",originY:t="50%",originZ:i=0}=f;c.transformOrigin=`${e} ${t} ${i}`}}},17399:function(e,t,i){"use strict";function r(e,{style:t,vars:i},r,n){for(let a in Object.assign(e.style,t,n&&n.getProjectionStyles(r)),i)e.style.setProperty(a,i[a])}i.d(t,{N:function(){return r}})},3993:function(e,t,i){"use strict";i.d(t,{U:function(){return a}});var r=i(6857),n=i(35978);function a(e,t){let{style:i}=e,a={};for(let s in i)((0,n.i)(i[s])||t.style&&(0,n.i)(t.style[s])||(0,r.j)(s,e))&&(a[s]=i[s]);return a}},51426:function(e,t,i){"use strict";i.d(t,{G:function(){return n},_:function(){return r}});let r=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],n=new Set(r)},82617:function(e,t,i){"use strict";i.d(t,{R:function(){return r}});let r=new WeakMap},99537:function(e,t,i){"use strict";i.d(t,{e:function(){return f}});var r=i(17162),n=i(32926),a=i(36155),s=i(61816),o=i(82984),l=i(51426),u=i(67256),c=i(28253),d=i(96510),h=i(70135);class f extends n.J{constructor(){super(...arguments),this.isSVGTag=!1}getBaseTargetFromProps(e,t){return e[t]}readValueFromInstance(e,t){if(l.G.has(t)){let e=(0,c.A)(t);return e&&e.default||0}return t=o.s.has(t)?t:(0,s.D)(t),e.getAttribute(t)}measureInstanceViewportBox(){return(0,d.dO)()}scrapeMotionValuesFromProps(e,t){return(0,r.U)(e,t)}build(e,t,i,r){(0,a.i)(e,t,i,this.isSVGTag,r.transformTemplate)}renderInstance(e,t,i,r){(0,u.K)(e,t,i,r)}mount(e){this.isSVGTag=(0,h.a)(e.tagName),super.mount(e)}}},36155:function(e,t,i){"use strict";i.d(t,{i:function(){return l}});var r=i(63475),n=i(37030);function a(e,t,i){return"string"==typeof e?e:n.px.transform(t+i*e)}let s={offset:"stroke-dashoffset",array:"stroke-dasharray"},o={offset:"strokeDashoffset",array:"strokeDasharray"};function l(e,{attrX:t,attrY:i,attrScale:l,originX:u,originY:c,pathLength:d,pathSpacing:h=1,pathOffset:f=0,...p},m,g,v){if((0,r.r)(e,p,m,v),g){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};let{attrs:y,style:b,dimensions:_}=e;y.transform&&(_&&(b.transform=y.transform),delete y.transform),_&&(void 0!==u||void 0!==c||b.transform)&&(b.transformOrigin=function(e,t,i){let r=a(t,e.x,e.width),n=a(i,e.y,e.height);return`${r} ${n}`}(_,void 0!==u?u:.5,void 0!==c?c:.5)),void 0!==t&&(y.x=t),void 0!==i&&(y.y=i),void 0!==l&&(y.scale=l),void 0!==d&&function(e,t,i=1,r=0,a=!0){e.pathLength=1;let l=a?s:o;e[l.offset]=n.px.transform(-r);let u=n.px.transform(t),c=n.px.transform(i);e[l.array]=`${u} ${c}`}(y,d,h,f,!1)}},82984:function(e,t,i){"use strict";i.d(t,{s:function(){return r}});let r=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"])},70135:function(e,t,i){"use strict";i.d(t,{a:function(){return r}});let r=e=>"string"==typeof e&&"svg"===e.toLowerCase()},67256:function(e,t,i){"use strict";i.d(t,{K:function(){return s}});var r=i(61816),n=i(17399),a=i(82984);function s(e,t,i,s){for(let i in(0,n.N)(e,t,void 0,s),t.attrs)e.setAttribute(a.s.has(i)?i:(0,r.D)(i),t.attrs[i])}},17162:function(e,t,i){"use strict";i.d(t,{U:function(){return s}});var r=i(35978),n=i(3993),a=i(51426);function s(e,t){let i=(0,n.U)(e,t);for(let n in e)if((0,r.i)(e[n])||(0,r.i)(t[n])){let t=-1!==a._.indexOf(n)?"attr"+n.charAt(0).toUpperCase()+n.substring(1):n;i[t]=e[n]}return i}},36048:function(e,t,i){"use strict";i.d(t,{G:function(){return s},M:function(){return o}});var r=i(74626),n=i(94385),a=i(42789);function s(e){return(0,r.H)(e.animate)||a.V.some(t=>(0,n.$)(e[t]))}function o(e){return!!(s(e)||e.variants)}},94385:function(e,t,i){"use strict";function r(e){return"string"==typeof e||Array.isArray(e)}i.d(t,{$:function(){return r}})},77643:function(e,t,i){"use strict";i.d(t,{x:function(){return n}});var r=i(27727);function n(e,t,i){let n=e.getProps();return(0,r.o)(n,t,void 0!==i?i:n.custom,function(e){let t={};return e.values.forEach((e,i)=>t[i]=e.get()),t}(e),function(e){let t={};return e.values.forEach((e,i)=>t[i]=e.getVelocity()),t}(e))}},27727:function(e,t,i){"use strict";function r(e,t,i,r={},n={}){return"function"==typeof t&&(t=t(void 0!==i?i:e.custom,r,n)),"string"==typeof t&&(t=e.variants&&e.variants[t]),"function"==typeof t&&(t=t(void 0!==i?i:e.custom,r,n)),t}i.d(t,{o:function(){return r}})},11444:function(e,t,i){"use strict";i.d(t,{GJ:function(){return y},P$:function(){return b},CD:function(){return m},gg:function(){return v}});let r=e=>/^\-?\d*\.?\d+$/.test(e);var n=i(65483),a=i(86289),s=i(9955),o=i(34989),l=i(27479),u=i(9161),c=i(1930),d=i(85824);let h=[...c.$,u.$,o.P],f=e=>h.find((0,d.l)(e));var p=i(77643);function m(e,t){let i=(0,p.x)(e,t),{transitionEnd:r={},transition:n={},...o}=i?e.makeTargetAnimatable(i,!1):{};for(let t in o={...o,...r}){let i=(0,a.Y)(o[t]);e.hasValue(t)?e.getValue(t).set(i):e.addValue(t,(0,s.B)(i))}}function g(e,t){let i=[...t].reverse();i.forEach(i=>{let r=e.getVariant(i);r&&m(e,r),e.variantChildren&&e.variantChildren.forEach(e=>{g(e,t)})})}function v(e,t){return Array.isArray(t)?g(e,t):"string"==typeof t?g(e,[t]):void m(e,t)}function y(e,t,i){var a,u;let c=Object.keys(t).filter(t=>!e.hasValue(t)),d=c.length;if(d)for(let h=0;h<d;h++){let d=c[h],p=t[d],m=null;Array.isArray(p)&&(m=p[0]),null===m&&(m=null!==(u=null!==(a=i[d])&&void 0!==a?a:e.readValue(d))&&void 0!==u?u:t[d]),null!=m&&("string"==typeof m&&(r(m)||(0,n.W)(m))?m=parseFloat(m):!f(m)&&o.P.test(p)&&(m=(0,l.T)(d,p)),e.addValue(d,(0,s.B)(m,{owner:e})),void 0===i[d]&&(i[d]=m),null!==m&&e.setBaseTarget(d,m))}}function b(e,t,i){let r={};for(let n in e){let e=function(e,t){if(!t)return;let i=t[e]||t.default||t;return i.from}(n,t);if(void 0!==e)r[n]=e;else{let e=i.getValue(n);e&&(r[n]=e.get())}}return r}},42789:function(e,t,i){"use strict";i.d(t,{V:function(){return n},e:function(){return r}});let r=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],n=["initial",...r]},21017:function(e,t,i){"use strict";function r(e,t){-1===e.indexOf(t)&&e.push(t)}function n(e,t){let i=e.indexOf(t);i>-1&&e.splice(i,1)}i.d(t,{cl:function(){return n},y4:function(){return r}})},83883:function(e,t,i){"use strict";i.d(t,{u:function(){return r}});let r=(e,t,i)=>Math.min(Math.max(i,e),t)},42281:function(e,t,i){"use strict";i.d(t,{K:function(){return n},k:function(){return a}});var r=i(63613);let n=r.Z,a=r.Z},50783:function(e,t,i){"use strict";i.d(t,{j:function(){return r}});let r="undefined"!=typeof document},29793:function(e,t,i){"use strict";function r(e){return"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"current")}i.d(t,{I:function(){return r}})},65483:function(e,t,i){"use strict";i.d(t,{W:function(){return r}});let r=e=>/^0[^.\s]+$/.test(e)},71605:function(e,t,i){"use strict";i.d(t,{C:function(){return r}});let r=(e,t,i)=>-i*e+i*t+e},63613:function(e,t,i){"use strict";i.d(t,{Z:function(){return r}});let r=e=>e},28852:function(e,t,i){"use strict";i.d(t,{Y:function(){return n}});var r=i(41175);function n(e){let t=[0];return(0,r.c)(t,e.length-1),t}},41175:function(e,t,i){"use strict";i.d(t,{c:function(){return a}});var r=i(71605),n=i(45974);function a(e,t){let i=e[e.length-1];for(let a=1;a<=t;a++){let s=(0,n.Y)(0,t,a);e.push((0,r.C)(i,1,s))}}},56893:function(e,t,i){"use strict";i.d(t,{z:function(){return n}});let r=(e,t)=>i=>t(e(i)),n=(...e)=>e.reduce(r)},45974:function(e,t,i){"use strict";i.d(t,{Y:function(){return r}});let r=(e,t,i)=>{let r=t-e;return 0===r?1:(i-e)/r}},86289:function(e,t,i){"use strict";i.d(t,{Y:function(){return a},p:function(){return n}});var r=i(6619);let n=e=>!!(e&&"object"==typeof e&&e.mix&&e.toValue),a=e=>(0,r.C)(e)?e[e.length-1]||0:e},60871:function(e,t,i){"use strict";i.d(t,{L:function(){return n}});var r=i(21017);class n{constructor(){this.subscriptions=[]}add(e){return(0,r.y4)(this.subscriptions,e),()=>(0,r.cl)(this.subscriptions,e)}notify(e,t,i){let r=this.subscriptions.length;if(r){if(1===r)this.subscriptions[0](e,t,i);else for(let n=0;n<r;n++){let r=this.subscriptions[n];r&&r(e,t,i)}}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}},13537:function(e,t,i){"use strict";i.d(t,{X:function(){return n},w:function(){return r}});let r=e=>1e3*e,n=e=>e/1e3},23090:function(e,t,i){"use strict";i.d(t,{h:function(){return n}});var r=i(50959);function n(e){let t=(0,r.useRef)(null);return null===t.current&&(t.current=e()),t.current}},60644:function(e,t,i){"use strict";i.d(t,{Y:function(){return s}});var r=i(50959),n=i(82188);let a={any:0,all:1};function s(e,{root:t,margin:i,amount:s,once:o=!1}={}){let[l,u]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{if(!e.current||o&&l)return;let r={root:t&&t.current||void 0,margin:i,amount:"some"===s?"any":s};return function(e,t,{root:i,margin:r,amount:s="any"}={}){let o=(0,n.I)(e),l=new WeakMap,u=new IntersectionObserver(e=>{e.forEach(e=>{let i=l.get(e.target);if(!!i!==e.isIntersecting){if(e.isIntersecting){let i=t(e);"function"==typeof i?l.set(e.target,i):u.unobserve(e.target)}else i&&(i(e),l.delete(e.target))}})},{root:i,rootMargin:r,threshold:"number"==typeof s?s:a[s]});return o.forEach(e=>u.observe(e)),()=>u.disconnect()}(e.current,()=>(u(!0),o?void 0:()=>u(!1)),r)},[t,e,i,o]),l}},59089:function(e,t,i){"use strict";i.d(t,{L:function(){return a}});var r=i(50959),n=i(50783);let a=n.j?r.useLayoutEffect:r.useEffect},37968:function(e,t,i){"use strict";function r(e,t){return t?e*(1e3/t):0}i.d(t,{R:function(){return r}})},9955:function(e,t,i){"use strict";i.d(t,{B:function(){return l}});var r=i(60871),n=i(37968),a=i(4801);let s=e=>!isNaN(parseFloat(e));class o{constructor(e,t={}){this.version="10.13.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(e,t=!0)=>{this.prev=this.current,this.current=e;let{delta:i,timestamp:r}=a.frameData;this.lastUpdated!==r&&(this.timeDelta=i,this.lastUpdated=r,a.Wi.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),t&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>a.Wi.postRender(this.velocityCheck),this.velocityCheck=({timestamp:e})=>{e!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=s(this.current),this.owner=t.owner}onChange(e){return this.on("change",e)}on(e,t){this.events[e]||(this.events[e]=new r.L);let i=this.events[e].add(t);return"change"===e?()=>{i(),a.Wi.read(()=>{this.events.change.getSize()||this.stop()})}:i}clearListeners(){for(let e in this.events)this.events[e].clear()}attach(e,t){this.passiveEffect=e,this.stopPassiveEffect=t}set(e,t=!0){t&&this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e,t)}setWithVelocity(e,t,i){this.set(t),this.prev=e,this.timeDelta=i}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?(0,n.R)(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(t=>{this.hasAnimated=!0,this.animation=e(t),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function l(e,t){return new o(e,t)}},36775:function(e,t,i){"use strict";i.d(t,{$:function(){return a}});var r=i(75937),n=i(52505);let a={test:(0,n.i)("#"),parse:function(e){let t="",i="",r="",n="";return e.length>5?(t=e.substring(1,3),i=e.substring(3,5),r=e.substring(5,7),n=e.substring(7,9)):(t=e.substring(1,2),i=e.substring(2,3),r=e.substring(3,4),n=e.substring(4,5),t+=t,i+=i,r+=r,n+=n),{red:parseInt(t,16),green:parseInt(i,16),blue:parseInt(r,16),alpha:n?parseInt(n,16)/255:1}},transform:r.m.transform}},44624:function(e,t,i){"use strict";i.d(t,{J:function(){return o}});var r=i(20265),n=i(37030),a=i(24952),s=i(52505);let o={test:(0,s.i)("hsl","hue"),parse:(0,s.d)("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:i,alpha:s=1})=>"hsla("+Math.round(e)+", "+n.aQ.transform((0,a.Nw)(t))+", "+n.aQ.transform((0,a.Nw)(i))+", "+(0,a.Nw)(r.Fq.transform(s))+")"}},9161:function(e,t,i){"use strict";i.d(t,{$:function(){return o}});var r=i(24952),n=i(36775),a=i(44624),s=i(75937);let o={test:e=>s.m.test(e)||n.$.test(e)||a.J.test(e),parse:e=>s.m.test(e)?s.m.parse(e):a.J.test(e)?a.J.parse(e):n.$.parse(e),transform:e=>(0,r.HD)(e)?e:e.hasOwnProperty("red")?s.m.transform(e):a.J.transform(e)}},75937:function(e,t,i){"use strict";i.d(t,{m:function(){return u}});var r=i(83883),n=i(20265),a=i(24952),s=i(52505);let o=e=>(0,r.u)(0,255,e),l={...n.Rx,transform:e=>Math.round(o(e))},u={test:(0,s.i)("rgb","red"),parse:(0,s.d)("red","green","blue"),transform:({red:e,green:t,blue:i,alpha:r=1})=>"rgba("+l.transform(e)+", "+l.transform(t)+", "+l.transform(i)+", "+(0,a.Nw)(n.Fq.transform(r))+")"}},52505:function(e,t,i){"use strict";i.d(t,{d:function(){return a},i:function(){return n}});var r=i(24952);let n=(e,t)=>i=>!!((0,r.HD)(i)&&r.mj.test(i)&&i.startsWith(e)||t&&Object.prototype.hasOwnProperty.call(i,t)),a=(e,t,i)=>n=>{if(!(0,r.HD)(n))return n;let[a,s,o,l]=n.match(r.KP);return{[e]:parseFloat(a),[t]:parseFloat(s),[i]:parseFloat(o),alpha:void 0!==l?parseFloat(l):1}}},87482:function(e,t,i){"use strict";i.d(t,{h:function(){return l}});var r=i(34989),n=i(24952);let a=new Set(["brightness","contrast","saturate","opacity"]);function s(e){let[t,i]=e.slice(0,-1).split("(");if("drop-shadow"===t)return e;let[r]=i.match(n.KP)||[];if(!r)return e;let s=i.replace(r,""),o=a.has(t)?1:0;return r!==i&&(o*=100),t+"("+o+s+")"}let o=/([a-z-]*)\(.*?\)/g,l={...r.P,getAnimatableNone:e=>{let t=e.match(o);return t?t.map(s).join(" "):e}}},34989:function(e,t,i){"use strict";i.d(t,{P:function(){return g},V:function(){return h}});var r=i(43175),n=i(63613),a=i(9161),s=i(20265),o=i(24952);let l={regex:r.Xp,countKey:"Vars",token:"${v}",parse:n.Z},u={regex:o.dA,countKey:"Colors",token:"${c}",parse:a.$.parse},c={regex:o.KP,countKey:"Numbers",token:"${n}",parse:s.Rx.parse};function d(e,{regex:t,countKey:i,token:r,parse:n}){let a=e.tokenised.match(t);a&&(e["num"+i]=a.length,e.tokenised=e.tokenised.replace(t,r),e.values.push(...a.map(n)))}function h(e){let t=e.toString(),i={value:t,tokenised:t,values:[],numVars:0,numColors:0,numNumbers:0};return i.value.includes("var(--")&&d(i,l),d(i,u),d(i,c),i}function f(e){return h(e).values}function p(e){let{values:t,numColors:i,numVars:r,tokenised:n}=h(e),s=t.length;return e=>{let t=n;for(let n=0;n<s;n++)t=n<r?t.replace(l.token,e[n]):n<r+i?t.replace(u.token,a.$.transform(e[n])):t.replace(c.token,(0,o.Nw)(e[n]));return t}}let m=e=>"number"==typeof e?0:e,g={test:function(e){var t,i;return isNaN(e)&&(0,o.HD)(e)&&((null===(t=e.match(o.KP))||void 0===t?void 0:t.length)||0)+((null===(i=e.match(o.dA))||void 0===i?void 0:i.length)||0)>0},parse:f,createTransformer:p,getAnimatableNone:function(e){let t=f(e),i=p(e);return i(t.map(m))}}},20265:function(e,t,i){"use strict";i.d(t,{Fq:function(){return a},Rx:function(){return n},bA:function(){return s}});var r=i(83883);let n={test:e=>"number"==typeof e,parse:parseFloat,transform:e=>e},a={...n,transform:e=>(0,r.u)(0,1,e)},s={...n,default:1}},37030:function(e,t,i){"use strict";i.d(t,{$C:function(){return c},RW:function(){return a},aQ:function(){return s},px:function(){return o},vh:function(){return l},vw:function(){return u}});var r=i(24952);let n=e=>({test:t=>(0,r.HD)(t)&&t.endsWith(e)&&1===t.split(" ").length,parse:parseFloat,transform:t=>`${t}${e}`}),a=n("deg"),s=n("%"),o=n("px"),l=n("vh"),u=n("vw"),c={...s,parse:e=>s.parse(e)/100,transform:e=>s.transform(100*e)}},24952:function(e,t,i){"use strict";i.d(t,{HD:function(){return o},KP:function(){return n},Nw:function(){return r},dA:function(){return a},mj:function(){return s}});let r=e=>Math.round(1e5*e)/1e5,n=/(-)?([\d]*\.?[\d])+/g,a=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,s=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function o(e){return"string"==typeof e}},58222:function(e,t,i){"use strict";i.d(t,{L:function(){return n}});var r=i(35978);function n(e){return!!((0,r.i)(e)&&e.add)}},35978:function(e,t,i){"use strict";i.d(t,{i:function(){return r}});let r=e=>!!(e&&e.getVelocity)},43398:function(e,t,i){"use strict";let r,n,a;i.d(t,{Z:function(){return rj}});var s,o,l,u,c,d,h,f,p,m={exports:{}};s=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,o=/^(?=([^\/?#]*))\1([^]*)$/,l=/(?:\/|^)\.(?=\/)/g,u=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,c={buildAbsoluteURL:function(e,t,i){if(i=i||{},e=e.trim(),!(t=t.trim())){if(!i.alwaysNormalize)return e;var r=c.parseURL(e);if(!r)throw Error("Error trying to parse base URL.");return r.path=c.normalizePath(r.path),c.buildURLFromParts(r)}var n=c.parseURL(t);if(!n)throw Error("Error trying to parse relative URL.");if(n.scheme)return i.alwaysNormalize?(n.path=c.normalizePath(n.path),c.buildURLFromParts(n)):t;var a=c.parseURL(e);if(!a)throw Error("Error trying to parse base URL.");if(!a.netLoc&&a.path&&"/"!==a.path[0]){var s=o.exec(a.path);a.netLoc=s[1],a.path=s[2]}a.netLoc&&!a.path&&(a.path="/");var l={scheme:a.scheme,netLoc:n.netLoc,path:null,params:n.params,query:n.query,fragment:n.fragment};if(!n.netLoc&&(l.netLoc=a.netLoc,"/"!==n.path[0])){if(n.path){var u=a.path,d=u.substring(0,u.lastIndexOf("/")+1)+n.path;l.path=c.normalizePath(d)}else l.path=a.path,n.params||(l.params=a.params,n.query||(l.query=a.query))}return null===l.path&&(l.path=i.alwaysNormalize?c.normalizePath(n.path):n.path),c.buildURLFromParts(l)},parseURL:function(e){var t=s.exec(e);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(e){for(e=e.split("").reverse().join("").replace(l,"");e.length!==(e=e.replace(u,"")).length;);return e.split("").reverse().join("")},buildURLFromParts:function(e){return e.scheme+e.netLoc+e.path+e.params+e.query+e.fragment}},m.exports=c;var g=m.exports;function v(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function y(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?v(Object(i),!0).forEach(function(t){var r,n;r=t,n=i[t],(r=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(r))in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):v(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function b(){return(b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])}return e}).apply(this,arguments)}let _=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},E=((d={}).MEDIA_ATTACHING="hlsMediaAttaching",d.MEDIA_ATTACHED="hlsMediaAttached",d.MEDIA_DETACHING="hlsMediaDetaching",d.MEDIA_DETACHED="hlsMediaDetached",d.BUFFER_RESET="hlsBufferReset",d.BUFFER_CODECS="hlsBufferCodecs",d.BUFFER_CREATED="hlsBufferCreated",d.BUFFER_APPENDING="hlsBufferAppending",d.BUFFER_APPENDED="hlsBufferAppended",d.BUFFER_EOS="hlsBufferEos",d.BUFFER_FLUSHING="hlsBufferFlushing",d.BUFFER_FLUSHED="hlsBufferFlushed",d.MANIFEST_LOADING="hlsManifestLoading",d.MANIFEST_LOADED="hlsManifestLoaded",d.MANIFEST_PARSED="hlsManifestParsed",d.LEVEL_SWITCHING="hlsLevelSwitching",d.LEVEL_SWITCHED="hlsLevelSwitched",d.LEVEL_LOADING="hlsLevelLoading",d.LEVEL_LOADED="hlsLevelLoaded",d.LEVEL_UPDATED="hlsLevelUpdated",d.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",d.LEVELS_UPDATED="hlsLevelsUpdated",d.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",d.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",d.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",d.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",d.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",d.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",d.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",d.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",d.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",d.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",d.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",d.CUES_PARSED="hlsCuesParsed",d.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",d.INIT_PTS_FOUND="hlsInitPtsFound",d.FRAG_LOADING="hlsFragLoading",d.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",d.FRAG_LOADED="hlsFragLoaded",d.FRAG_DECRYPTED="hlsFragDecrypted",d.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",d.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",d.FRAG_PARSING_METADATA="hlsFragParsingMetadata",d.FRAG_PARSED="hlsFragParsed",d.FRAG_BUFFERED="hlsFragBuffered",d.FRAG_CHANGED="hlsFragChanged",d.FPS_DROP="hlsFpsDrop",d.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",d.ERROR="hlsError",d.DESTROYING="hlsDestroying",d.KEY_LOADING="hlsKeyLoading",d.KEY_LOADED="hlsKeyLoaded",d.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",d.BACK_BUFFER_REACHED="hlsBackBufferReached",d),S=((h={}).NETWORK_ERROR="networkError",h.MEDIA_ERROR="mediaError",h.KEY_SYSTEM_ERROR="keySystemError",h.MUX_ERROR="muxError",h.OTHER_ERROR="otherError",h),x=((f={}).KEY_SYSTEM_NO_KEYS="keySystemNoKeys",f.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",f.KEY_SYSTEM_NO_SESSION="keySystemNoSession",f.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",f.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",f.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",f.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",f.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",f.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",f.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",f.MANIFEST_LOAD_ERROR="manifestLoadError",f.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",f.MANIFEST_PARSING_ERROR="manifestParsingError",f.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",f.LEVEL_EMPTY_ERROR="levelEmptyError",f.LEVEL_LOAD_ERROR="levelLoadError",f.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",f.LEVEL_PARSING_ERROR="levelParsingError",f.LEVEL_SWITCH_ERROR="levelSwitchError",f.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",f.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",f.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",f.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",f.FRAG_LOAD_ERROR="fragLoadError",f.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",f.FRAG_DECRYPT_ERROR="fragDecryptError",f.FRAG_PARSING_ERROR="fragParsingError",f.FRAG_GAP="fragGap",f.REMUX_ALLOC_ERROR="remuxAllocError",f.KEY_LOAD_ERROR="keyLoadError",f.KEY_LOAD_TIMEOUT="keyLoadTimeOut",f.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",f.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",f.BUFFER_APPEND_ERROR="bufferAppendError",f.BUFFER_APPENDING_ERROR="bufferAppendingError",f.BUFFER_STALLED_ERROR="bufferStalledError",f.BUFFER_FULL_ERROR="bufferFullError",f.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",f.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",f.INTERNAL_EXCEPTION="internalException",f.INTERNAL_ABORTED="aborted",f.UNKNOWN="unknown",f),T=function(){},w={trace:T,debug:T,log:T,warn:T,info:T,error:T},A=w,M=A,R=/^(\d+)x(\d+)$/,C=/(.+?)=(".*?"|.*?)(?:,|$)/g;class I{constructor(e){for(let t in"string"==typeof e&&(e=I.parseAttrList(e)),e)e.hasOwnProperty(t)&&("X-"===t.substring(0,2)&&(this.clientAttrs=this.clientAttrs||[],this.clientAttrs.push(t)),this[t]=e[t])}decimalInteger(e){let t=parseInt(this[e],10);return t>Number.MAX_SAFE_INTEGER?1/0:t}hexadecimalInteger(e){if(!this[e])return null;{let t=(this[e]||"0x").slice(2);t=(1&t.length?"0":"")+t;let i=new Uint8Array(t.length/2);for(let e=0;e<t.length/2;e++)i[e]=parseInt(t.slice(2*e,2*e+2),16);return i}}hexadecimalIntegerAsNumber(e){let t=parseInt(this[e],16);return t>Number.MAX_SAFE_INTEGER?1/0:t}decimalFloatingPoint(e){return parseFloat(this[e])}optionalFloat(e,t){let i=this[e];return i?parseFloat(i):t}enumeratedString(e){return this[e]}bool(e){return"YES"===this[e]}decimalResolution(e){let t=R.exec(this[e]);if(null!==t)return{width:parseInt(t[1],10),height:parseInt(t[2],10)}}static parseAttrList(e){let t;let i={};for(C.lastIndex=0;null!==(t=C.exec(e));){let e=t[2];0===e.indexOf('"')&&e.lastIndexOf('"')===e.length-1&&(e=e.slice(1,-1));let r=t[1].trim();i[r]=e}return i}}class L{constructor(e,t){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,t){let i=t.attr;for(let t in i)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t]!==i[t]){M.warn(`DATERANGE tag attribute: "${t}" does not match for tags with ID: "${e.ID}"`),this._badValueForSameId=t;break}e=b(new I({}),i,e)}if(this.attr=e,this._startDate=new Date(e["START-DATE"]),"END-DATE"in this.attr){let e=new Date(this.attr["END-DATE"]);_(e.getTime())&&(this._endDate=e)}}get id(){return this.attr.ID}get class(){return this.attr.CLASS}get startDate(){return this._startDate}get endDate(){if(this._endDate)return this._endDate;let e=this.duration;return null!==e?new Date(this._startDate.getTime()+1e3*e):null}get duration(){if("DURATION"in this.attr){let e=this.attr.decimalFloatingPoint("DURATION");if(_(e))return e}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}get plannedDuration(){return"PLANNED-DURATION"in this.attr?this.attr.decimalFloatingPoint("PLANNED-DURATION"):null}get endOnNext(){return this.attr.bool("END-ON-NEXT")}get isValid(){return!!this.id&&!this._badValueForSameId&&_(this.startDate.getTime())&&(null===this.duration||this.duration>=0)&&(!this.endOnNext||!!this.class)}}class k{constructor(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}}var D={AUDIO:"audio",VIDEO:"video",AUDIOVIDEO:"audiovideo"};class P{constructor(e){this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams={[D.AUDIO]:null,[D.VIDEO]:null,[D.AUDIOVIDEO]:null},this.baseurl=e}setByteRange(e,t){let i=e.split("@",2),r=[];1===i.length?r[0]=t?t.byteRangeEndOffset:0:r[0]=parseInt(i[1]),r[1]=parseInt(i[0])+r[0],this._byteRange=r}get byteRange(){return this._byteRange?this._byteRange:[]}get byteRangeStartOffset(){return this.byteRange[0]}get byteRangeEndOffset(){return this.byteRange[1]}get url(){return!this._url&&this.baseurl&&this.relurl&&(this._url=g.buildAbsoluteURL(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""}set url(e){this._url=e}}class O extends P{constructor(e,t){super(t),this._decryptdata=null,this.rawProgramDateTime=null,this.programDateTime=null,this.tagList=[],this.duration=0,this.sn=0,this.levelkeys=void 0,this.type=void 0,this.loader=null,this.keyLoader=null,this.level=-1,this.cc=0,this.startPTS=void 0,this.endPTS=void 0,this.startDTS=void 0,this.endDTS=void 0,this.start=0,this.deltaPTS=void 0,this.maxStartPTS=void 0,this.minEndPTS=void 0,this.stats=new k,this.urlId=0,this.data=void 0,this.bitrateTest=!1,this.title=null,this.initSegment=null,this.endList=void 0,this.gap=void 0,this.type=e}get decryptdata(){let{levelkeys:e}=this;if(!e&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){let e=this.levelkeys.identity;if(e)this._decryptdata=e.getDecryptData(this.sn);else{let e=Object.keys(this.levelkeys);if(1===e.length)return this._decryptdata=this.levelkeys[e[0]].getDecryptData(this.sn)}}return this._decryptdata}get end(){return this.start+this.duration}get endProgramDateTime(){if(null===this.programDateTime||!_(this.programDateTime))return null;let e=_(this.duration)?this.duration:0;return this.programDateTime+1e3*e}get encrypted(){var e;if(null!=(e=this._decryptdata)&&e.encrypted)return!0;if(this.levelkeys){let e=Object.keys(this.levelkeys),t=e.length;if(t>1||1===t&&this.levelkeys[e[0]].encrypted)return!0}return!1}setKeyFormat(e){if(this.levelkeys){let t=this.levelkeys[e];t&&!this._decryptdata&&(this._decryptdata=t.getDecryptData(this.sn))}}abortRequests(){var e,t;null==(e=this.loader)||e.abort(),null==(t=this.keyLoader)||t.abort()}setElementaryStreamInfo(e,t,i,r,n,a=!1){let{elementaryStreams:s}=this,o=s[e];if(!o){s[e]={startPTS:t,endPTS:i,startDTS:r,endDTS:n,partial:a};return}o.startPTS=Math.min(o.startPTS,t),o.endPTS=Math.max(o.endPTS,i),o.startDTS=Math.min(o.startDTS,r),o.endDTS=Math.max(o.endDTS,n)}clearElementaryStreamInfo(){let{elementaryStreams:e}=this;e[D.AUDIO]=null,e[D.VIDEO]=null,e[D.AUDIOVIDEO]=null}}class N extends P{constructor(e,t,i,r,n){super(i),this.fragOffset=0,this.duration=0,this.gap=!1,this.independent=!1,this.relurl=void 0,this.fragment=void 0,this.index=void 0,this.stats=new k,this.duration=e.decimalFloatingPoint("DURATION"),this.gap=e.bool("GAP"),this.independent=e.bool("INDEPENDENT"),this.relurl=e.enumeratedString("URI"),this.fragment=t,this.index=r;let a=e.enumeratedString("BYTERANGE");a&&this.setByteRange(a,n),n&&(this.fragOffset=n.fragOffset+n.duration)}get start(){return this.fragment.start+this.fragOffset}get end(){return this.start+this.duration}get loaded(){let{elementaryStreams:e}=this;return!!(e.audio||e.video||e.audiovideo)}}class U{constructor(e){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.playlistParsingError=null,this.variableList=null,this.hasVariableRefs=!1,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=e}reloaded(e){if(!e){this.advanced=!0,this.updated=!0;return}let t=this.lastPartSn-e.lastPartSn,i=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!i||!!t||!this.live,this.advanced=this.endSN>e.endSN||t>0||0===t&&i>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.availabilityDelay=e.availabilityDelay}get hasProgramDateTime(){return!!this.fragments.length&&_(this.fragments[this.fragments.length-1].programDateTime)}get levelTargetDuration(){return this.averagetargetduration||this.targetduration||10}get drift(){let e=this.driftEndTime-this.driftStartTime;if(e>0){let t=this.driftEnd-this.driftStart;return 1e3*t/e}return 1}get edge(){return this.partEnd||this.fragmentEnd}get partEnd(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].end:this.fragmentEnd}get fragmentEnd(){var e;return null!=(e=this.fragments)&&e.length?this.fragments[this.fragments.length-1].end:0}get age(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}get lastPartIndex(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].index:-1}get lastPartSn(){var e;return null!=(e=this.partList)&&e.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}function F(e){return Uint8Array.from(atob(e),e=>e.charCodeAt(0))}function B(e){return Uint8Array.from(unescape(encodeURIComponent(e)),e=>e.charCodeAt(0))}var V={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.fps",PLAYREADY:"com.microsoft.playready",WIDEVINE:"com.widevine.alpha"},z={CLEARKEY:"org.w3.clearkey",FAIRPLAY:"com.apple.streamingkeydelivery",PLAYREADY:"com.microsoft.playready",WIDEVINE:"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"};function j(e){switch(e){case z.FAIRPLAY:return V.FAIRPLAY;case z.PLAYREADY:return V.PLAYREADY;case z.WIDEVINE:return V.WIDEVINE;case z.CLEARKEY:return V.CLEARKEY}}var H={WIDEVINE:"edef8ba979d64acea3c827dcd51d21ed"};function G(e){switch(e){case V.FAIRPLAY:return z.FAIRPLAY;case V.PLAYREADY:return z.PLAYREADY;case V.WIDEVINE:return z.WIDEVINE;case V.CLEARKEY:return z.CLEARKEY}}function W(e){let{drmSystems:t,widevineLicenseUrl:i}=e,r=t?[V.FAIRPLAY,V.WIDEVINE,V.PLAYREADY,V.CLEARKEY].filter(e=>!!t[e]):[];return!r[V.WIDEVINE]&&i&&r.push(V.WIDEVINE),r}let $="undefined"!=typeof self&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null;function q(e,t,i){return Uint8Array.prototype.slice?e.slice(t,i):new Uint8Array(Array.prototype.slice.call(e,t,i))}let Y=(e,t)=>t+10<=e.length&&73===e[t]&&68===e[t+1]&&51===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,K=(e,t)=>t+10<=e.length&&51===e[t]&&68===e[t+1]&&73===e[t+2]&&e[t+3]<255&&e[t+4]<255&&e[t+6]<128&&e[t+7]<128&&e[t+8]<128&&e[t+9]<128,X=(e,t)=>{let i=t,r=0;for(;Y(e,t);){r+=10;let i=Z(e,t+6);r+=i,K(e,t+10)&&(r+=10),t+=r}if(r>0)return e.subarray(i,i+r)},Z=(e,t)=>(127&e[t])<<21|(127&e[t+1])<<14|(127&e[t+2])<<7|127&e[t+3],J=(e,t)=>Y(e,t)&&Z(e,t+6)+10<=e.length-t,Q=e=>{let t=ei(e);for(let e=0;e<t.length;e++){let i=t[e];if(ee(i))return eo(i)}},ee=e=>e&&"PRIV"===e.key&&"com.apple.streaming.transportStreamTimestamp"===e.info,et=e=>{let t=String.fromCharCode(e[0],e[1],e[2],e[3]),i=Z(e,4);return{type:t,size:i,data:e.subarray(10,10+i)}},ei=e=>{let t=0,i=[];for(;Y(e,t);){let r=Z(e,t+6);t+=10;let n=t+r;for(;t+8<n;){let r=et(e.subarray(t)),n=er(r);n&&i.push(n),t+=r.size+10}K(e,t)&&(t+=10)}return i},er=e=>"PRIV"===e.type?en(e):"W"===e.type[0]?es(e):ea(e),en=e=>{if(e.size<2)return;let t=el(e.data,!0),i=new Uint8Array(e.data.subarray(t.length+1));return{key:e.type,info:t,data:i.buffer}},ea=e=>{if(e.size<2)return;if("TXXX"===e.type){let t=1,i=el(e.data.subarray(t),!0);t+=i.length+1;let r=el(e.data.subarray(t));return{key:e.type,info:i,data:r}}let t=el(e.data.subarray(1));return{key:e.type,data:t}},es=e=>{if("WXXX"===e.type){if(e.size<2)return;let t=1,i=el(e.data.subarray(t),!0);t+=i.length+1;let r=el(e.data.subarray(t));return{key:e.type,info:i,data:r}}let t=el(e.data);return{key:e.type,data:t}},eo=e=>{if(8===e.data.byteLength){let t=new Uint8Array(e.data),i=1&t[3],r=(t[4]<<23)+(t[5]<<15)+(t[6]<<7)+t[7];return r/=45,i&&(r+=47721858.84),Math.round(r)}},el=(e,t=!1)=>{let i,n;let a=(r||void 0===self.TextDecoder||(r=new self.TextDecoder("utf-8")),r);if(a){let i=a.decode(e);if(t){let e=i.indexOf("\x00");return -1!==e?i.substring(0,e):i}return i.replace(/\0/g,"")}let s=e.length,o="",l=0;for(;l<s&&(0!==(i=e[l++])||!t);)if(0!==i&&3!==i)switch(i>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o+=String.fromCharCode(i);break;case 12:case 13:o+=String.fromCharCode((31&i)<<6|63&e[l++]);break;case 14:o+=String.fromCharCode((15&i)<<12|(63&e[l++])<<6|(63&e[l++])<<0)}return o},eu={hexDump:function(e){let t="";for(let i=0;i<e.length;i++){let r=e[i].toString(16);r.length<2&&(r="0"+r),t+=r}return t}},ec=[].push,ed={video:1,audio:2,id3:3,text:4};function eh(e){return String.fromCharCode.apply(null,e)}function ef(e,t){let i=e[t]<<8|e[t+1];return i<0?65536+i:i}function ep(e,t){let i=em(e,t);return i<0?4294967296+i:i}function em(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}function eg(e,t,i){e[t]=i>>24,e[t+1]=i>>16&255,e[t+2]=i>>8&255,e[t+3]=255&i}function ev(e,t){let i=[];if(!t.length)return i;let r=e.byteLength;for(let n=0;n<r;){let a=ep(e,n),s=eh(e.subarray(n+4,n+8)),o=a>1?n+a:r;if(s===t[0]){if(1===t.length)i.push(e.subarray(n+8,o));else{let r=ev(e.subarray(n+8,o),t.slice(1));r.length&&ec.apply(i,r)}}n=o}return i}function ey(e){let t=[],i=ev(e,["moov","trak"]);for(let e=0;e<i.length;e++){let r=i[e],n=ev(r,["tkhd"])[0];if(n){let e=n[0],i=0===e?12:20,a=ep(n,i),s=ev(r,["mdia","mdhd"])[0];if(s){i=0===(e=s[0])?12:20;let n=ep(s,i),o=ev(r,["mdia","hdlr"])[0];if(o){let e=eh(o.subarray(8,12)),i={soun:D.AUDIO,vide:D.VIDEO}[e];if(i){let e;let s=ev(r,["mdia","minf","stbl","stsd"])[0];s&&(e=eh(s.subarray(12,16))),t[a]={timescale:n,type:i},t[i]={timescale:n,id:a,codec:e}}}}}}let r=ev(e,["moov","mvex","trex"]);return r.forEach(e=>{let i=ep(e,4),r=t[i];r&&(r.default={duration:ep(e,12),flags:ep(e,20)})}),t}function eb(e){let t=ev(e,["schm"])[0];if(t){let i=eh(t.subarray(4,8));if("cbcs"===i||"cenc"===i)return ev(e,["schi","tenc"])[0]}return M.error("[eme] missing 'schm' box"),null}function e_(e,t){let i=new Uint8Array(e.length+t.length);return i.set(e),i.set(t,e.length),i}function eE(e,t){let i=[],r=t.samples,n=t.timescale,a=t.id,s=!1,o=ev(r,["moof"]);return o.map(o=>{let l=o.byteOffset-8,u=ev(o,["traf"]);u.map(o=>{let u=ev(o,["tfdt"]).map(e=>{let t=e[0],i=ep(e,4);return 1===t&&(i*=4294967296,i+=ep(e,8)),i/n})[0];return void 0!==u&&(e=u),ev(o,["tfhd"]).map(u=>{let c=ep(u,4),d=16777215&ep(u,0),h=0,f=0,p=8;c===a&&((1&d)!=0&&(p+=8),(2&d)!=0&&(p+=4),(8&d)!=0&&(h=ep(u,p),p+=4),(16&d)!=0&&(f=ep(u,p),p+=4),(32&d)!=0&&(p+=4),"video"===t.type&&(s=function(e){if(!e)return!1;let t=e.indexOf("."),i=t<0?e:e.substring(0,t);return"hvc1"===i||"hev1"===i||"dvh1"===i||"dvhe"===i}(t.codec)),ev(o,["trun"]).map(a=>{let o=a[0],u=16777215&ep(a,0),c=0,d=(256&u)!=0,p=0,m=(512&u)!=0,g=0,v=(1024&u)!=0,y=(2048&u)!=0,b=0,_=ep(a,4),E=8;(1&u)!=0&&(c=ep(a,E),E+=4),(4&u)!=0&&(E+=4);let S=c+l;for(let l=0;l<_;l++){if(d?(p=ep(a,E),E+=4):p=h,m?(g=ep(a,E),E+=4):g=f,v&&(E+=4),y&&(b=0===o?ep(a,E):em(a,E),E+=4),t.type===D.VIDEO){let t=0;for(;t<g;){let a=ep(r,S);if(function(e,t){if(!e)return 6==(31&t);{let e=t>>1&63;return 39===e||40===e}}(s,r[S+=4])){let t=r.subarray(S,S+a);eS(t,s?2:1,e+b/n,i)}S+=a,t+=a+4}}e+=p/n}}))})})}),i}function eS(e,t,i,r){let n;let a=ex(e);n=0+t;let s=0,o=0,l=!1,u=0;for(;n<a.length;){s=0;do{if(n>=a.length)break;s+=u=a[n++]}while(255===u);o=0;do{if(n>=a.length)break;o+=u=a[n++]}while(255===u);let e=a.length-n;if(!l&&4===s&&n<a.length){l=!0;let e=a[n++];if(181===e){let e=ef(a,n);if(n+=2,49===e){let e=ep(a,n);if(n+=4,1195456820===e){let e=a[n++];if(3===e){let t=a[n++],o=31&t,l=64&t,u=l?2+3*o:0,c=new Uint8Array(u);if(l){c[0]=t;for(let e=1;e<u;e++)c[e]=a[n++]}r.push({type:e,payloadType:s,pts:i,bytes:c})}}}}}else if(5===s&&o<e){if(l=!0,o>16){let e=[];for(let t=0;t<16;t++){let i=a[n++].toString(16);e.push(1==i.length?"0"+i:i),(3===t||5===t||7===t||9===t)&&e.push("-")}let t=o-16,l=new Uint8Array(t);for(let e=0;e<t;e++)l[e]=a[n++];r.push({payloadType:s,pts:i,uuid:e.join(""),userData:el(l),userDataBytes:l})}}else if(o<e)n+=o;else if(o>e)break}}function ex(e){let t=e.byteLength,i=[],r=1;for(;r<t-2;)0===e[r]&&0===e[r+1]&&3===e[r+2]?(i.push(r+2),r+=2):r++;if(0===i.length)return e;let n=t-i.length,a=new Uint8Array(n),s=0;for(r=0;r<n;s++,r++)s===i[0]&&(s++,i.shift()),a[r]=e[s];return a}let eT={};class ew{static clearKeyUriToKeyIdMap(){eT={}}constructor(e,t,i,r=[1],n=null){this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=e,this.uri=t,this.keyFormat=i,this.keyFormatVersions=r,this.iv=n,this.encrypted=!!e&&"NONE"!==e,this.isCommonEncryption=this.encrypted&&"AES-128"!==e}isSupported(){if(this.method){if("AES-128"===this.method||"NONE"===this.method)return!0;if("identity"===this.keyFormat)return"SAMPLE-AES"===this.method;switch(this.keyFormat){case z.FAIRPLAY:case z.WIDEVINE:case z.PLAYREADY:case z.CLEARKEY:return -1!==["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)}}return!1}getDecryptData(e){if(!this.encrypted||!this.uri)return null;if("AES-128"===this.method&&this.uri&&!this.iv){"number"!=typeof e&&("AES-128"!==this.method||this.iv||M.warn(`missing IV for initialization segment with method="${this.method}" - compliance issue`),e=0);let t=function(e){let t=new Uint8Array(16);for(let i=12;i<16;i++)t[i]=e>>8*(15-i)&255;return t}(e),i=new ew(this.method,this.uri,"identity",this.keyFormatVersions,t);return i}let t=function(e){let t=e.split(":"),i=null;if("data"===t[0]&&2===t.length){let e=t[1].split(";"),r=e[e.length-1].split(",");if(2===r.length){let t="base64"===r[0],n=r[1];t?(e.splice(-1,1),i=F(n)):i=function(e){let t=B(e).subarray(0,16),i=new Uint8Array(16);return i.set(t,16-t.length),i}(n)}}return i}(this.uri);if(t)switch(this.keyFormat){case z.WIDEVINE:this.pssh=t,t.length>=22&&(this.keyId=t.subarray(t.length-22,t.length-6));break;case z.PLAYREADY:{let e=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=function(e,t,i){let r,n,a;if(16!==e.byteLength)throw RangeError("Invalid system id");if(t){r=1,n=new Uint8Array(16*t.length);for(let e=0;e<t.length;e++){let i=t[e];if(16!==i.byteLength)throw RangeError("Invalid key");n.set(i,16*e)}}else r=0,n=new Uint8Array;r>0?(a=new Uint8Array(4),t.length>0&&new DataView(a.buffer).setUint32(0,t.length,!1)):a=new Uint8Array;let s=new Uint8Array(4);return i&&i.byteLength>0&&new DataView(s.buffer).setUint32(0,i.byteLength,!1),function(e,...t){let i=t.length,r=8,n=i;for(;n--;)r+=t[n].byteLength;let a=new Uint8Array(r);for(a[0]=r>>24&255,a[1]=r>>16&255,a[2]=r>>8&255,a[3]=255&r,a.set(e,4),n=0,r=8;n<i;n++)a.set(t[n],r),r+=t[n].byteLength;return a}([112,115,115,104],new Uint8Array([r,0,0,0]),e,a,n,s,i||new Uint8Array)}(e,null,t);let i=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2),r=String.fromCharCode.apply(null,Array.from(i)),n=r.substring(r.indexOf("<"),r.length),a=new DOMParser,s=a.parseFromString(n,"text/xml"),o=s.getElementsByTagName("KID")[0];if(o){let e=o.childNodes[0]?o.childNodes[0].nodeValue:o.getAttribute("VALUE");if(e){let t=F(e).subarray(0,16);!function(e){let t=function(e,t,i){let r=e[t];e[t]=e[i],e[i]=r};t(e,0,3),t(e,1,2),t(e,4,5),t(e,6,7)}(t),this.keyId=t}}break}default:{let e=t.subarray(0,16);if(16!==e.length){let t=new Uint8Array(16);t.set(e,16-e.length),e=t}this.keyId=e}}if(!this.keyId||16!==this.keyId.byteLength){let e=eT[this.uri];if(!e){let t=Object.keys(eT).length%Number.MAX_SAFE_INTEGER;e=new Uint8Array(16);let i=new DataView(e.buffer,12,4);i.setUint32(0,t),eT[this.uri]=e}this.keyId=e}return this}}let eA=/\{\$([a-zA-Z0-9-_]+)\}/g;function eM(e,t,i){if(null!==e.variableList||e.hasVariableRefs)for(let r=i.length;r--;){let n=i[r],a=t[n];a&&(t[n]=eR(e,a))}}function eR(e,t){if(null!==e.variableList||e.hasVariableRefs){let i=e.variableList;return t.replace(eA,t=>{let r=t.substring(2,t.length-1),n=null==i?void 0:i[r];return void 0===n?(e.playlistParsingError||(e.playlistParsingError=Error(`Missing preceding EXT-X-DEFINE tag for Variable Reference: "${r}"`)),t):n})}return t}function eC(e,t,i){let r,n,a=e.variableList;if(a||(e.variableList=a={}),"QUERYPARAM"in t){r=t.QUERYPARAM;try{let e=new self.URL(i).searchParams;if(e.has(r))n=e.get(r);else throw Error(`"${r}" does not match any query parameter in URI: "${i}"`)}catch(t){e.playlistParsingError||(e.playlistParsingError=Error(`EXT-X-DEFINE QUERYPARAM: ${t.message}`))}}else r=t.NAME,n=t.VALUE;r in a?e.playlistParsingError||(e.playlistParsingError=Error(`EXT-X-DEFINE duplicate Variable Name declarations: "${r}"`)):a[r]=n||""}function eI(){if("undefined"!=typeof self)return self.MediaSource||self.WebKitMediaSource}let eL={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}},ek=eI();function eD(e,t){var i;return null!=(i=null==ek?void 0:ek.isTypeSupported(`${t||"video"}/mp4;codecs="${e}"`))&&i}let eP=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-(SESSION-DATA|SESSION-KEY|DEFINE|CONTENT-STEERING|START):([^\r\n]*)[\r\n]+/g,eO=/#EXT-X-MEDIA:(.*)/g,eN=/^#EXT(?:INF|-X-TARGETDURATION):/m,eU=RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),eF=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|DEFINE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|"));class eB{static findGroup(e,t){for(let i=0;i<e.length;i++){let r=e[i];if(r.id===t)return r}}static convertAVC1ToAVCOTI(e){let t=e.split(".");return t.length>2?t.shift()+"."+(parseInt(t.shift()).toString(16)+("000"+parseInt(t.shift()).toString(16)).slice(-4)):e}static resolve(e,t){return g.buildAbsoluteURL(t,e,{alwaysNormalize:!0})}static isMediaPlaylist(e){return eN.test(e)}static parseMasterPlaylist(e,t){var i;let r;let n=eA.test(e),a={contentSteering:null,levels:[],playlistParsingError:null,sessionData:null,sessionKeys:null,startTimeOffset:null,variableList:null,hasVariableRefs:n},s=[];for(eP.lastIndex=0;null!=(r=eP.exec(e));)if(r[1]){let e=new I(r[1]);eM(a,e,["CODECS","SUPPLEMENTAL-CODECS","ALLOWED-CPC","PATHWAY-ID","STABLE-VARIANT-ID","AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS","NAME"]);let n=eR(a,r[2]),o={attrs:e,bitrate:e.decimalInteger("AVERAGE-BANDWIDTH")||e.decimalInteger("BANDWIDTH"),name:e.NAME,url:eB.resolve(n,t)},l=e.decimalResolution("RESOLUTION");l&&(o.width=l.width,o.height=l.height),function(e,t){["video","audio","text"].forEach(i=>{let r=e.filter(e=>(function(e,t){let i=eL[t];return!!i&&!0===i[e.slice(0,4)]})(e,i));if(r.length){let n=r.filter(e=>0===e.lastIndexOf("avc1",0)||0===e.lastIndexOf("mp4a",0));t[`${i}Codec`]=n.length>0?n[0]:r[0],e=e.filter(e=>-1===r.indexOf(e))}}),t.unknownCodecs=e}((e.CODECS||"").split(/[ ,]+/).filter(e=>e),o),o.videoCodec&&-1!==o.videoCodec.indexOf("avc1")&&(o.videoCodec=eB.convertAVC1ToAVCOTI(o.videoCodec)),null!=(i=o.unknownCodecs)&&i.length||s.push(o),a.levels.push(o)}else if(r[3]){let e=r[3],i=r[4];switch(e){case"SESSION-DATA":{let e=new I(i);eM(a,e,["DATA-ID","LANGUAGE","VALUE","URI"]);let t=e["DATA-ID"];t&&(null===a.sessionData&&(a.sessionData={}),a.sessionData[t]=e);break}case"SESSION-KEY":{let e=eV(i,t,a);e.encrypted&&e.isSupported()?(null===a.sessionKeys&&(a.sessionKeys=[]),a.sessionKeys.push(e)):M.warn(`[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "${i}"`);break}case"DEFINE":{let e=new I(i);eM(a,e,["NAME","VALUE","QUERYPARAM"]),eC(a,e,t)}break;case"CONTENT-STEERING":{let e=new I(i);eM(a,e,["SERVER-URI","PATHWAY-ID"]),a.contentSteering={uri:eB.resolve(e["SERVER-URI"],t),pathwayId:e["PATHWAY-ID"]||"."};break}case"START":a.startTimeOffset=ez(i)}}let o=s.length>0&&s.length<a.levels.length;return a.levels=o?s:a.levels,0===a.levels.length&&(a.playlistParsingError=Error("no levels found in manifest")),a}static parseMasterPlaylistMedia(e,t,i){let r;let n={},a=i.levels,s={AUDIO:a.map(e=>({id:e.attrs.AUDIO,audioCodec:e.audioCodec})),SUBTITLES:a.map(e=>({id:e.attrs.SUBTITLES,textCodec:e.textCodec})),"CLOSED-CAPTIONS":[]},o=0;for(eO.lastIndex=0;null!==(r=eO.exec(e));){let e=new I(r[1]),a=e.TYPE;if(a){let r=s[a],l=n[a]||[];n[a]=l,eM(i,e,["URI","GROUP-ID","LANGUAGE","ASSOC-LANGUAGE","STABLE-RENDITION-ID","NAME","INSTREAM-ID","CHARACTERISTICS","CHANNELS"]);let u={attrs:e,bitrate:0,id:o++,groupId:e["GROUP-ID"]||"",instreamId:e["INSTREAM-ID"],name:e.NAME||e.LANGUAGE||"",type:a,default:e.bool("DEFAULT"),autoselect:e.bool("AUTOSELECT"),forced:e.bool("FORCED"),lang:e.LANGUAGE,url:e.URI?eB.resolve(e.URI,t):""};if(null!=r&&r.length){let e=eB.findGroup(r,u.groupId)||r[0];ej(u,e,"audioCodec"),ej(u,e,"textCodec")}l.push(u)}}return n}static parseLevelPlaylist(e,t,i,r,n,a){let s,o,l;let u=new U(t),c=u.fragments,d=null,h=0,f=0,p=0,m=0,g=null,v=new O(r,t),y=-1,E=!1;for(eU.lastIndex=0,u.m3u8=e,u.hasVariableRefs=eA.test(e);null!==(s=eU.exec(e));){E&&(E=!1,(v=new O(r,t)).start=p,v.sn=h,v.cc=m,v.level=i,d&&(v.initSegment=d,v.rawProgramDateTime=d.rawProgramDateTime,d.rawProgramDateTime=null));let e=s[1];if(e){v.duration=parseFloat(e);let t=(" "+s[2]).slice(1);v.title=t||null,v.tagList.push(t?["INF",e,t]:["INF",e])}else if(s[3]){if(_(v.duration)){v.start=p,l&&eW(v,l,u),v.sn=h,v.level=i,v.cc=m,v.urlId=n,c.push(v);let e=(" "+s[3]).slice(1);v.relurl=eR(u,e),eH(v,g),g=v,p+=v.duration,h++,f=0,E=!0}}else if(s[4]){let e=(" "+s[4]).slice(1);g?v.setByteRange(e,g):v.setByteRange(e)}else if(s[5])v.rawProgramDateTime=(" "+s[5]).slice(1),v.tagList.push(["PROGRAM-DATE-TIME",v.rawProgramDateTime]),-1===y&&(y=c.length);else{if(!(s=s[0].match(eF))){M.warn("No matches on slow regex match for level playlist!");continue}for(o=1;o<s.length&&void 0===s[o];o++);let e=(" "+s[o]).slice(1),n=(" "+s[o+1]).slice(1),p=s[o+2]?(" "+s[o+2]).slice(1):"";switch(e){case"PLAYLIST-TYPE":u.type=n.toUpperCase();break;case"MEDIA-SEQUENCE":h=u.startSN=parseInt(n);break;case"SKIP":{let e=new I(n);eM(u,e,["RECENTLY-REMOVED-DATERANGES"]);let t=e.decimalInteger("SKIPPED-SEGMENTS");if(_(t)){u.skippedSegments=t;for(let e=t;e--;)c.unshift(null);h+=t}let i=e.enumeratedString("RECENTLY-REMOVED-DATERANGES");i&&(u.recentlyRemovedDateranges=i.split("	"));break}case"TARGETDURATION":u.targetduration=Math.max(parseInt(n),1);break;case"VERSION":u.version=parseInt(n);break;case"EXTM3U":break;case"ENDLIST":u.live=!1;break;case"#":(n||p)&&v.tagList.push(p?[n,p]:[n]);break;case"DISCONTINUITY":m++,v.tagList.push(["DIS"]);break;case"GAP":v.gap=!0,v.tagList.push([e]);break;case"BITRATE":v.tagList.push([e,n]);break;case"DATERANGE":{let e=new I(n);eM(u,e,["ID","CLASS","START-DATE","END-DATE","SCTE35-CMD","SCTE35-OUT","SCTE35-IN"]),eM(u,e,e.clientAttrs);let t=new L(e,u.dateRanges[e.ID]);t.isValid||u.skippedSegments?u.dateRanges[t.id]=t:M.warn(`Ignoring invalid DATERANGE tag: "${n}"`),v.tagList.push(["EXT-X-DATERANGE",n]);break}case"DEFINE":{let e=new I(n);eM(u,e,["NAME","VALUE","IMPORT","QUERYPARAM"]),"IMPORT"in e?function(e,t,i){let r=t.IMPORT;if(i&&r in i){let t=e.variableList;t||(e.variableList=t={}),t[r]=i[r]}else e.playlistParsingError||(e.playlistParsingError=Error(`EXT-X-DEFINE IMPORT attribute not found in Multivariant Playlist: "${r}"`))}(u,e,a):eC(u,e,t)}break;case"DISCONTINUITY-SEQUENCE":m=parseInt(n);break;case"KEY":{let e=eV(n,t,u);if(e.isSupported()){if("NONE"===e.method){l=void 0;break}l||(l={}),l[e.keyFormat]&&(l=b({},l)),l[e.keyFormat]=e}else M.warn(`[Keys] Ignoring invalid EXT-X-KEY tag: "${n}"`);break}case"START":u.startTimeOffset=ez(n);break;case"MAP":{let e=new I(n);if(eM(u,e,["BYTERANGE","URI"]),v.duration){let n=new O(r,t);eG(n,e,i,l),d=n,v.initSegment=d,d.rawProgramDateTime&&!v.rawProgramDateTime&&(v.rawProgramDateTime=d.rawProgramDateTime)}else eG(v,e,i,l),d=v,E=!0;break}case"SERVER-CONTROL":{let e=new I(n);u.canBlockReload=e.bool("CAN-BLOCK-RELOAD"),u.canSkipUntil=e.optionalFloat("CAN-SKIP-UNTIL",0),u.canSkipDateRanges=u.canSkipUntil>0&&e.bool("CAN-SKIP-DATERANGES"),u.partHoldBack=e.optionalFloat("PART-HOLD-BACK",0),u.holdBack=e.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{let e=new I(n);u.partTarget=e.decimalFloatingPoint("PART-TARGET");break}case"PART":{let e=u.partList;e||(e=u.partList=[]);let i=f>0?e[e.length-1]:void 0,r=f++,a=new I(n);eM(u,a,["BYTERANGE","URI"]);let s=new N(a,v,t,r,i);e.push(s),v.duration+=s.duration;break}case"PRELOAD-HINT":{let e=new I(n);eM(u,e,["URI"]),u.preloadHint=e;break}case"RENDITION-REPORT":{let e=new I(n);eM(u,e,["URI"]),u.renditionReports=u.renditionReports||[],u.renditionReports.push(e);break}default:M.warn(`line parsed but not handled: ${s}`)}}}g&&!g.relurl?(c.pop(),p-=g.duration,u.partList&&(u.fragmentHint=g)):u.partList&&(eH(v,g),v.cc=m,u.fragmentHint=v,l&&eW(v,l,u));let S=c.length,x=c[0],T=c[S-1];if((p+=u.skippedSegments*u.targetduration)>0&&S&&T){u.averagetargetduration=p/S;let e=T.sn;u.endSN="initSegment"!==e?e:0,u.live||(T.endList=!0),x&&(u.startCC=x.cc)}else u.endSN=0,u.startCC=0;return u.fragmentHint&&(p+=u.fragmentHint.duration),u.totalduration=p,u.endCC=m,y>0&&function(e,t){let i=e[t];for(let r=t;r--;){let t=e[r];if(!t)return;t.programDateTime=i.programDateTime-1e3*t.duration,i=t}}(c,y),u}}function eV(e,t,i){var r,n;let a=new I(e);eM(i,a,["KEYFORMAT","KEYFORMATVERSIONS","URI","IV","URI"]);let s=null!=(r=a.METHOD)?r:"",o=a.URI,l=a.hexadecimalInteger("IV"),u=a.KEYFORMATVERSIONS,c=null!=(n=a.KEYFORMAT)?n:"identity";o&&a.IV&&!l&&M.error(`Invalid IV: ${a.IV}`);let d=o?eB.resolve(o,t):"",h=(u||"1").split("/").map(Number).filter(Number.isFinite);return new ew(s,d,c,h,l)}function ez(e){let t=new I(e),i=t.decimalFloatingPoint("TIME-OFFSET");return _(i)?i:null}function ej(e,t,i){let r=t[i];r&&(e[i]=r)}function eH(e,t){e.rawProgramDateTime?e.programDateTime=Date.parse(e.rawProgramDateTime):null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),_(e.programDateTime)||(e.programDateTime=null,e.rawProgramDateTime=null)}function eG(e,t,i,r){e.relurl=t.URI,t.BYTERANGE&&e.setByteRange(t.BYTERANGE),e.level=i,e.sn="initSegment",r&&(e.levelkeys=r),e.initSegment=null}function eW(e,t,i){e.levelkeys=t;let{encryptedFragments:r}=i;(!r.length||r[r.length-1].levelkeys!==t)&&Object.keys(t).some(e=>t[e].isCommonEncryption)&&r.push(e)}var e$={MANIFEST:"manifest",LEVEL:"level",AUDIO_TRACK:"audioTrack",SUBTITLE_TRACK:"subtitleTrack"},eq={MAIN:"main",AUDIO:"audio",SUBTITLE:"subtitle"};function eY(e){let{type:t}=e;switch(t){case e$.AUDIO_TRACK:return eq.AUDIO;case e$.SUBTITLE_TRACK:return eq.SUBTITLE;default:return eq.MAIN}}function eK(e,t){let i=e.url;return(void 0===i||0===i.indexOf("data:"))&&(i=t.url),i}class eX{constructor(e){this.hls=void 0,this.loaders=Object.create(null),this.variableList=null,this.hls=e,this.registerListeners()}startLoad(e){}stopLoad(){this.destroyInternalLoaders()}registerListeners(){let{hls:e}=this;e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.LEVEL_LOADING,this.onLevelLoading,this),e.on(E.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.on(E.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}unregisterListeners(){let{hls:e}=this;e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.LEVEL_LOADING,this.onLevelLoading,this),e.off(E.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),e.off(E.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)}createInternalLoader(e){let t=this.hls.config,i=t.pLoader,r=t.loader,n=new(i||r)(t);return this.loaders[e.type]=n,n}getInternalLoader(e){return this.loaders[e.type]}resetInternalLoader(e){this.loaders[e]&&delete this.loaders[e]}destroyInternalLoaders(){for(let e in this.loaders){let t=this.loaders[e];t&&t.destroy(),this.resetInternalLoader(e)}}destroy(){this.variableList=null,this.unregisterListeners(),this.destroyInternalLoaders()}onManifestLoading(e,t){let{url:i}=t;this.variableList=null,this.load({id:null,level:0,responseType:"text",type:e$.MANIFEST,url:i,deliveryDirectives:null})}onLevelLoading(e,t){let{id:i,level:r,url:n,deliveryDirectives:a}=t;this.load({id:i,level:r,responseType:"text",type:e$.LEVEL,url:n,deliveryDirectives:a})}onAudioTrackLoading(e,t){let{id:i,groupId:r,url:n,deliveryDirectives:a}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:e$.AUDIO_TRACK,url:n,deliveryDirectives:a})}onSubtitleTrackLoading(e,t){let{id:i,groupId:r,url:n,deliveryDirectives:a}=t;this.load({id:i,groupId:r,level:null,responseType:"text",type:e$.SUBTITLE_TRACK,url:n,deliveryDirectives:a})}load(e){var t;let i;let r=this.hls.config,n=this.getInternalLoader(e);if(n){let t=n.context;if(t&&t.url===e.url){M.trace("[playlist-loader]: playlist request ongoing");return}M.log(`[playlist-loader]: aborting previous loader for type: ${e.type}`),n.abort()}if(i=e.type===e$.MANIFEST?r.manifestLoadPolicy.default:b({},r.playlistLoadPolicy.default,{timeoutRetry:null,errorRetry:null}),n=this.createInternalLoader(e),null!=(t=e.deliveryDirectives)&&t.part){let t;if(e.type===e$.LEVEL&&null!==e.level?t=this.hls.levels[e.level].details:e.type===e$.AUDIO_TRACK&&null!==e.id?t=this.hls.audioTracks[e.id].details:e.type===e$.SUBTITLE_TRACK&&null!==e.id&&(t=this.hls.subtitleTracks[e.id].details),t){let e=t.partTarget,r=t.targetduration;if(e&&r){let t=1e3*Math.max(3*e,.8*r);i=b({},i,{maxTimeToFirstByteMs:Math.min(t,i.maxTimeToFirstByteMs),maxLoadTimeMs:Math.min(t,i.maxTimeToFirstByteMs)})}}}let a=i.errorRetry||i.timeoutRetry||{},s={loadPolicy:i,timeout:i.maxLoadTimeMs,maxRetry:a.maxNumRetry||0,retryDelay:a.retryDelayMs||0,maxRetryDelay:a.maxRetryDelayMs||0};n.load(e,s,{onSuccess:(e,t,i,r)=>{let n=this.getInternalLoader(i);this.resetInternalLoader(i.type);let a=e.data;if(0!==a.indexOf("#EXTM3U")){this.handleManifestParsingError(e,i,Error("no EXTM3U delimiter"),r||null,t);return}t.parsing.start=performance.now(),eB.isMediaPlaylist(a)?this.handleTrackOrLevelPlaylist(e,t,i,r||null,n):this.handleMasterPlaylist(e,t,i,r)},onError:(e,t,i,r)=>{this.handleNetworkError(t,i,!1,e,r)},onTimeout:(e,t,i)=>{this.handleNetworkError(t,i,!0,void 0,e)}})}handleMasterPlaylist(e,t,i,r){let n=this.hls,a=e.data,s=eK(e,i),o=eB.parseMasterPlaylist(a,s);if(o.playlistParsingError){this.handleManifestParsingError(e,i,o.playlistParsingError,r,t);return}let{contentSteering:l,levels:u,sessionData:c,sessionKeys:d,startTimeOffset:h,variableList:f}=o;this.variableList=f;let{AUDIO:p=[],SUBTITLES:m,"CLOSED-CAPTIONS":g}=eB.parseMasterPlaylistMedia(a,s,o);if(p.length){let e=p.some(e=>!e.url);e||!u[0].audioCodec||u[0].attrs.AUDIO||(M.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),p.unshift({type:"main",name:"main",groupId:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new I({}),bitrate:0,url:""}))}n.trigger(E.MANIFEST_LOADED,{levels:u,audioTracks:p,subtitles:m,captions:g,contentSteering:l,url:s,stats:t,networkDetails:r,sessionData:c,sessionKeys:d,startTimeOffset:h,variableList:f})}handleTrackOrLevelPlaylist(e,t,i,r,n){let a=this.hls,{id:s,level:o,type:l}=i,u=eK(e,i),c=_(s)?s:0,d=_(o)?o:c,h=eY(i),f=eB.parseLevelPlaylist(e.data,u,d,h,c,this.variableList);if(l===e$.MANIFEST){let e={attrs:new I({}),bitrate:0,details:f,name:"",url:u};a.trigger(E.MANIFEST_LOADED,{levels:[e],audioTracks:[],url:u,stats:t,networkDetails:r,sessionData:null,sessionKeys:null,contentSteering:null,startTimeOffset:null,variableList:null})}t.parsing.end=performance.now(),i.levelDetails=f,this.handlePlaylistLoaded(f,e,t,i,r,n)}handleManifestParsingError(e,t,i,r,n){this.hls.trigger(E.ERROR,{type:S.NETWORK_ERROR,details:x.MANIFEST_PARSING_ERROR,fatal:t.type===e$.MANIFEST,url:e.url,err:i,error:i,reason:i.message,response:e,context:t,networkDetails:r,stats:n})}handleNetworkError(e,t,i=!1,r,n){let a=`A network ${i?"timeout":"error"+(r?" (status "+r.code+")":"")} occurred while loading ${e.type}`;e.type===e$.LEVEL?a+=`: ${e.level} id: ${e.id}`:(e.type===e$.AUDIO_TRACK||e.type===e$.SUBTITLE_TRACK)&&(a+=` id: ${e.id} group-id: "${e.groupId}"`);let s=Error(a);M.warn(`[playlist-loader]: ${a}`);let o=x.UNKNOWN,l=!1,u=this.getInternalLoader(e);switch(e.type){case e$.MANIFEST:o=i?x.MANIFEST_LOAD_TIMEOUT:x.MANIFEST_LOAD_ERROR,l=!0;break;case e$.LEVEL:o=i?x.LEVEL_LOAD_TIMEOUT:x.LEVEL_LOAD_ERROR,l=!1;break;case e$.AUDIO_TRACK:o=i?x.AUDIO_TRACK_LOAD_TIMEOUT:x.AUDIO_TRACK_LOAD_ERROR,l=!1;break;case e$.SUBTITLE_TRACK:o=i?x.SUBTITLE_TRACK_LOAD_TIMEOUT:x.SUBTITLE_LOAD_ERROR,l=!1}u&&this.resetInternalLoader(e.type);let c={type:S.NETWORK_ERROR,details:o,fatal:l,url:e.url,loader:u,context:e,error:s,networkDetails:t,stats:n};if(r){let i=(null==t?void 0:t.url)||e.url;c.response=y({url:i,data:void 0},r)}this.hls.trigger(E.ERROR,c)}handlePlaylistLoaded(e,t,i,r,n,a){let s=this.hls,{type:o,level:l,id:u,groupId:c,deliveryDirectives:d}=r,h=eK(t,r),f=eY(r),p="number"==typeof r.level&&f===eq.MAIN?l:void 0;if(!e.fragments.length){let e=Error("No Segments found in Playlist");s.trigger(E.ERROR,{type:S.NETWORK_ERROR,details:x.LEVEL_EMPTY_ERROR,fatal:!1,url:h,error:e,reason:e.message,response:t,context:r,level:p,parent:f,networkDetails:n,stats:i});return}e.targetduration||(e.playlistParsingError=Error("Missing Target Duration"));let m=e.playlistParsingError;if(m){s.trigger(E.ERROR,{type:S.NETWORK_ERROR,details:x.LEVEL_PARSING_ERROR,fatal:!1,url:h,error:m,reason:m.message,response:t,context:r,level:p,parent:f,networkDetails:n,stats:i});return}switch(e.live&&a&&(a.getCacheAge&&(e.ageHeader=a.getCacheAge()||0),(!a.getCacheAge||isNaN(e.ageHeader))&&(e.ageHeader=0)),o){case e$.MANIFEST:case e$.LEVEL:s.trigger(E.LEVEL_LOADED,{details:e,level:p||0,id:u||0,stats:i,networkDetails:n,deliveryDirectives:d});break;case e$.AUDIO_TRACK:s.trigger(E.AUDIO_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:i,networkDetails:n,deliveryDirectives:d});break;case e$.SUBTITLE_TRACK:s.trigger(E.SUBTITLE_TRACK_LOADED,{details:e,id:u||0,groupId:c||"",stats:i,networkDetails:n,deliveryDirectives:d})}}}function eZ(e,t){let i;try{i=new Event("addtrack")}catch(e){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=e,t.dispatchEvent(i)}function eJ(e,t){let i=e.mode;if("disabled"===i&&(e.mode="hidden"),e.cues&&!e.cues.getCueById(t.id))try{if(e.addCue(t),!e.cues.getCueById(t.id))throw Error(`addCue is failed for: ${t}`)}catch(i){M.debug(`[texttrack-utils]: ${i}`);try{let i=new self.TextTrackCue(t.startTime,t.endTime,t.text);i.id=t.id,e.addCue(i)}catch(e){M.debug(`[texttrack-utils]: Legacy TextTrackCue fallback failed: ${e}`)}}"disabled"===i&&(e.mode=i)}function eQ(e){let t=e.mode;if("disabled"===t&&(e.mode="hidden"),e.cues)for(let t=e.cues.length;t--;)e.removeCue(e.cues[t]);"disabled"===t&&(e.mode=t)}function e0(e,t,i,r){let n=e.mode;if("disabled"===n&&(e.mode="hidden"),e.cues&&e.cues.length>0){let n=function(e,t,i){let r=[],n=function(e,t){if(t<e[0].startTime)return 0;let i=e.length-1;if(t>e[i].endTime)return -1;let r=0,n=i;for(;r<=n;){let a=Math.floor((n+r)/2);if(t<e[a].startTime)n=a-1;else{if(!(t>e[a].startTime)||!(r<i))return a;r=a+1}}return e[r].startTime-t<t-e[n].startTime?r:n}(e,t);if(n>-1)for(let a=n,s=e.length;a<s;a++){let n=e[a];if(n.startTime>=t&&n.endTime<=i)r.push(n);else if(n.startTime>i)break}return r}(e.cues,t,i);for(let t=0;t<n.length;t++)(!r||r(n[t]))&&e.removeCue(n[t])}"disabled"===n&&(e.mode=n)}var e1={audioId3:"org.id3",dateRange:"com.apple.quicktime.HLS",emsg:"https://aomedia.org/emsg/ID3"};function e2(){if("undefined"!=typeof self)return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}let e3=(()=>{let e=e2();try{new e(0,Number.POSITIVE_INFINITY,"")}catch(e){return Number.MAX_VALUE}return Number.POSITIVE_INFINITY})();function e5(e,t){return e.getTime()/1e3-t}class e4{constructor(e){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=e,this._registerListeners()}destroy(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null}_registerListeners(){let{hls:e}=this;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.on(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(E.LEVEL_UPDATED,this.onLevelUpdated,this)}_unregisterListeners(){let{hls:e}=this;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),e.off(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(E.LEVEL_UPDATED,this.onLevelUpdated,this)}onMediaAttached(e,t){this.media=t.media}onMediaDetaching(){this.id3Track&&(eQ(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})}onManifestLoading(){this.dateRangeCuesAppended={}}createTrack(e){let t=this.getID3Track(e.textTracks);return t.mode="hidden",t}getID3Track(e){if(this.media){for(let t=0;t<e.length;t++){let i=e[t];if("metadata"===i.kind&&"id3"===i.label)return eZ(i,this.media),i}return this.media.addTextTrack("metadata","id3")}}onFragParsingMetadata(e,t){if(!this.media)return;let{hls:{config:{enableEmsgMetadataCues:i,enableID3MetadataCues:r}}}=this;if(!i&&!r)return;let{samples:n}=t;this.id3Track||(this.id3Track=this.createTrack(this.media));let a=e2();for(let e=0;e<n.length;e++){let t=n[e].type;if(t===e1.emsg&&!i||!r)continue;let s=ei(n[e].data);if(s){let i=n[e].pts,r=i+n[e].duration;r>e3&&(r=e3);let o=r-i;o<=0&&(r=i+.25);for(let e=0;e<s.length;e++){let n=s[e];if(!ee(n)){this.updateId3CueEnds(i,t);let e=new a(i,r,"");e.value=n,t&&(e.type=t),this.id3Track.addCue(e)}}}}}updateId3CueEnds(e,t){var i;let r=null==(i=this.id3Track)?void 0:i.cues;if(r)for(let i=r.length;i--;){let n=r[i];n.type===t&&n.startTime<e&&n.endTime===e3&&(n.endTime=e)}}onBufferFlushing(e,{startOffset:t,endOffset:i,type:r}){let{id3Track:n,hls:a}=this;if(!a)return;let{config:{enableEmsgMetadataCues:s,enableID3MetadataCues:o}}=a;n&&(s||o)&&e0(n,t,i,"audio"===r?e=>e.type===e1.audioId3&&o:"video"===r?e=>e.type===e1.emsg&&s:e=>e.type===e1.audioId3&&o||e.type===e1.emsg&&s)}onLevelUpdated(e,{details:t}){if(!this.media||!t.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)return;let{dateRangeCuesAppended:i,id3Track:r}=this,{dateRanges:n}=t,a=Object.keys(n);if(r){let e=Object.keys(i).filter(e=>!a.includes(e));for(let t=e.length;t--;){let n=e[t];Object.keys(i[n].cues).forEach(e=>{r.removeCue(i[n].cues[e])}),delete i[n]}}let s=t.fragments[t.fragments.length-1];if(0===a.length||!_(null==s?void 0:s.programDateTime))return;this.id3Track||(this.id3Track=this.createTrack(this.media));let o=s.programDateTime/1e3-s.start,l=e2();for(let e=0;e<a.length;e++){let t=a[e],r=n[t],s=i[t],c=(null==s?void 0:s.cues)||{},d=(null==s?void 0:s.durationKnown)||!1,h=e5(r.startDate,o),f=e3,p=r.endDate;if(p)f=e5(p,o),d=!0;else if(r.endOnNext&&!d){let e=a.reduce((e,t)=>{let i=n[t];return i.class===r.class&&i.id!==t&&i.startDate>r.startDate&&e.push(i),e},[]).sort((e,t)=>e.startDate.getTime()-t.startDate.getTime())[0];e&&(f=e5(e.startDate,o),d=!0)}let m=Object.keys(r.attr);for(let e=0;e<m.length;e++){var u;let i=m[e];if(!("ID"!==i&&"CLASS"!==i&&"START-DATE"!==i&&"DURATION"!==i&&"END-DATE"!==i&&"END-ON-NEXT"!==i))continue;let n=c[i];if(n)d&&!s.durationKnown&&(n.endTime=f);else{let e=r.attr[i];n=new l(h,f,""),("SCTE35-OUT"===i||"SCTE35-IN"===i)&&(u=e,e=Uint8Array.from(u.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),n.value={key:i,data:e},n.type=e1.dateRange,n.id=t,this.id3Track.addCue(n),c[i]=n}}i[t]={cues:c,dateRange:r,durationKnown:d}}}}class e6{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=()=>this.timeupdate(),this.hls=e,this.config=e.config,this.registerListeners()}get latency(){return this._latency||0}get maxLatency(){let{config:e,levelDetails:t}=this;return void 0!==e.liveMaxLatencyDuration?e.liveMaxLatencyDuration:t?e.liveMaxLatencyDurationCount*t.targetduration:0}get targetLatency(){let{levelDetails:e}=this;if(null===e)return null;let{holdBack:t,partHoldBack:i,targetduration:r}=e,{liveSyncDuration:n,liveSyncDurationCount:a,lowLatencyMode:s}=this.config,o=this.hls.userConfig,l=s&&i||t;return(o.liveSyncDuration||o.liveSyncDurationCount||0===l)&&(l=void 0!==n?n:a*r),l+Math.min(1*this.stallCount,r)}get liveSyncPosition(){let e=this.estimateLiveEdge(),t=this.targetLatency,i=this.levelDetails;if(null===e||null===t||null===i)return null;let r=i.edge,n=e-t-this.edgeStalled,a=r-i.totalduration,s=r-(this.config.lowLatencyMode&&i.partTarget||i.targetduration);return Math.min(Math.max(a,n),s)}get drift(){let{levelDetails:e}=this;return null===e?1:e.drift}get edgeStalled(){let{levelDetails:e}=this;if(null===e)return 0;let t=3*(this.config.lowLatencyMode&&e.partTarget||e.targetduration);return Math.max(e.age-t,0)}get forwardBufferLength(){let{media:e,levelDetails:t}=this;if(!e||!t)return 0;let i=e.buffered.length;return(i?e.buffered.end(i-1):t.edge)-this.currentTime}destroy(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null}registerListeners(){this.hls.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(E.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(E.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(E.ERROR,this.onError,this)}unregisterListeners(){this.hls.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.off(E.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(E.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.off(E.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)}onMediaDetaching(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)}onManifestLoading(){this.levelDetails=null,this._latency=null,this.stallCount=0}onLevelUpdated(e,{details:t}){this.levelDetails=t,t.advanced&&this.timeupdate(),!t.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)}onError(e,t){var i;t.details===x.BUFFER_STALLED_ERROR&&(this.stallCount++,null!=(i=this.levelDetails)&&i.live&&M.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))}timeupdate(){let{media:e,levelDetails:t}=this;if(!e||!t)return;this.currentTime=e.currentTime;let i=this.computeLatency();if(null===i)return;this._latency=i;let{lowLatencyMode:r,maxLiveSyncPlaybackRate:n}=this.config;if(!r||1===n)return;let a=this.targetLatency;if(null===a)return;let s=i-a,o=Math.min(this.maxLatency,a+t.targetduration);if(t.live&&s<o&&s>.05&&this.forwardBufferLength>1){let t=Math.round(2/(1+Math.exp(-.75*s-this.edgeStalled))*20)/20;e.playbackRate=Math.min(Math.min(2,Math.max(1,n)),Math.max(1,t))}else 1!==e.playbackRate&&0!==e.playbackRate&&(e.playbackRate=1)}estimateLiveEdge(){let{levelDetails:e}=this;return null===e?null:e.edge+e.age}computeLatency(){let e=this.estimateLiveEdge();return null===e?null:e-this.currentTime}}let e8=["NONE","TYPE-0","TYPE-1",null];var e7={No:"",Yes:"YES",v2:"v2"};class e9{constructor(e,t,i){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=e,this.part=t,this.skip=i}addDirectives(e){let t=new self.URL(e);return void 0!==this.msn&&t.searchParams.set("_HLS_msn",this.msn.toString()),void 0!==this.part&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href}}class te{constructor(e){this._attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[e.url],this._attrs=[e.attrs],this.bitrate=e.bitrate,e.details&&(this.details=e.details),this.id=e.id||0,this.name=e.name,this.width=e.width||0,this.height=e.height||0,this.audioCodec=e.audioCodec,this.videoCodec=e.videoCodec,this.unknownCodecs=e.unknownCodecs,this.codecSet=[e.videoCodec,e.audioCodec].filter(e=>e).join(",").replace(/\.[^.,]+/g,"")}get maxBitrate(){return Math.max(this.realBitrate,this.bitrate)}get attrs(){return this._attrs[this._urlId]}get pathwayId(){return this.attrs["PATHWAY-ID"]||"."}get uri(){return this.url[this._urlId]||""}get urlId(){return this._urlId}set urlId(e){let t=e%this.url.length;this._urlId!==t&&(this.fragmentError=0,this.loadError=0,this.details=void 0,this._urlId=t)}get audioGroupId(){var e;return null==(e=this.audioGroupIds)?void 0:e[this.urlId]}get textGroupId(){var e;return null==(e=this.textGroupIds)?void 0:e[this.urlId]}addFallback(e){this.url.push(e.url),this._attrs.push(e.attrs)}}function tt(e,t){let i=t.startPTS;if(_(i)){let r,n=0;t.sn>e.sn?(n=i-e.start,r=e):(n=e.start-i,r=t),r.duration!==n&&(r.duration=n)}else if(t.sn>e.sn){let i=e.cc===t.cc;i&&e.minEndPTS?t.start=e.start+(e.minEndPTS-e.start):t.start=e.start+e.duration}else t.start=Math.max(e.start-t.duration,0)}function ti(e,t,i,r,n,a){let s;let o=r-i;o<=0&&(M.warn("Fragment should have a positive duration",t),r=i+t.duration,a=n+t.duration);let l=i,u=r,c=t.startPTS,d=t.endPTS;if(_(c)){let e=Math.abs(c-i);_(t.deltaPTS)?t.deltaPTS=Math.max(e,t.deltaPTS):t.deltaPTS=e,l=Math.max(i,c),i=Math.min(i,c),n=Math.min(n,t.startDTS),u=Math.min(r,d),r=Math.max(r,d),a=Math.max(a,t.endDTS)}let h=i-t.start;0!==t.start&&(t.start=i),t.duration=r-t.start,t.startPTS=i,t.maxStartPTS=l,t.startDTS=n,t.endPTS=r,t.minEndPTS=u,t.endDTS=a;let f=t.sn;if(!e||f<e.startSN||f>e.endSN)return 0;let p=f-e.startSN,m=e.fragments;for(m[p]=t,s=p;s>0;s--)tt(m[s],m[s-1]);for(s=p;s<m.length-1;s++)tt(m[s],m[s+1]);return e.fragmentHint&&tt(m[m.length-1],e.fragmentHint),e.PTSKnown=e.alignedSliding=!0,h}function tr(e,t){let i=t.startSN+t.skippedSegments-e.startSN,r=e.fragments;i<0||i>=r.length||tn(t,r[i].start)}function tn(e,t){if(t){let i=e.fragments;for(let r=e.skippedSegments;r<i.length;r++)i[r].start+=t;e.fragmentHint&&(e.fragmentHint.start+=t)}}function ta(e,t,i){var r;return null!=e&&e.details?ts(null==(r=e.details)?void 0:r.partList,t,i):null}function ts(e,t,i){if(e)for(let r=e.length;r--;){let n=e[r];if(n.index===i&&n.fragment.sn===t)return n}return null}function to(e){switch(e.details){case x.FRAG_LOAD_TIMEOUT:case x.KEY_LOAD_TIMEOUT:case x.LEVEL_LOAD_TIMEOUT:case x.MANIFEST_LOAD_TIMEOUT:return!0}return!1}function tl(e,t){let i=to(t);return e.default[`${i?"timeout":"error"}Retry`]}function tu(e,t){let i="linear"===e.backoff?1:Math.pow(2,t);return Math.min(i*e.retryDelayMs,e.maxRetryDelayMs)}function tc(e){return y(y({},e),{errorRetry:null,timeoutRetry:null})}function td(e,t,i,r){return!!e&&t<e.maxNumRetry&&(0===r&&!1===navigator.onLine||!!r&&(r<400||r>499)||!!i)}let th={search:function(e,t){let i=0,r=e.length-1,n=null,a=null;for(;i<=r;){a=e[n=(i+r)/2|0];let s=t(a);if(s>0)i=n+1;else{if(!(s<0))return a;r=n-1}}return null}};function tf(e,t,i=0,r=0){let n=null;if(e?n=t[e.sn-t[0].sn+1]||null:0===i&&0===t[0].start&&(n=t[0]),n&&0===tp(i,r,n))return n;let a=th.search(t,tp.bind(null,i,r));return a&&(a!==e||!n)?a:n}function tp(e=0,t=0,i){if(i.start<=e&&i.start+i.duration>e)return 0;let r=Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0));return i.start+i.duration-r<=e?1:i.start-r>e&&i.start?-1:0}var tm={DoNothing:0,SendAlternateToPenaltyBox:2,RetryRequest:5},tg={None:0,MoveAllAlternatesMatchingHost:1,MoveAllAlternatesMatchingHDCP:2};class tv{constructor(e,t){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.log=void 0,this.warn=void 0,this.log=M.log.bind(M,`${t}:`),this.warn=M.warn.bind(M,`${t}:`),this.hls=e}destroy(){this.clearTimer(),this.hls=this.log=this.warn=null}clearTimer(){clearTimeout(this.timer),this.timer=-1}startLoad(){this.canLoad=!0,this.requestScheduled=-1,this.loadPlaylist()}stopLoad(){this.canLoad=!1,this.clearTimer()}switchParams(e,t){let i=null==t?void 0:t.renditionReports;if(i){let r=-1;for(let n=0;n<i.length;n++){let a;let s=i[n];try{a=new self.URL(s.URI,t.url).href}catch(e){M.warn(`Could not construct new URL for Rendition Report: ${e}`),a=s.URI||""}if(a===e){r=n;break}a===e.substring(0,a.length)&&(r=n)}if(-1!==r){let e=i[r],n=parseInt(e["LAST-MSN"])||(null==t?void 0:t.lastPartSn),a=parseInt(e["LAST-PART"])||(null==t?void 0:t.lastPartIndex);if(this.hls.config.lowLatencyMode){let e=Math.min(t.age-t.partTarget,t.targetduration);a>=0&&e>t.partTarget&&(a+=1)}return new e9(n,a>=0?a:void 0,e7.No)}}}loadPlaylist(e){-1===this.requestScheduled&&(this.requestScheduled=self.performance.now())}shouldLoadPlaylist(e){return this.canLoad&&!!e&&!!e.url&&(!e.details||e.details.live)}shouldReloadPlaylist(e){return -1===this.timer&&-1===this.requestScheduled&&this.shouldLoadPlaylist(e)}playlistLoaded(e,t,i){let{details:r,stats:n}=t,a=self.performance.now(),s=n.loading.first?Math.max(0,a-n.loading.first):0;if(r.advancedDateTime=Date.now()-s,r.live||null!=i&&i.live){let s,o,l;if(r.reloaded(i),i&&this.log(`live playlist ${e} ${r.advanced?"REFRESHED "+r.lastPartSn+"-"+r.lastPartIndex:r.updated?"UPDATED":"MISSED"}`),i&&r.fragments.length>0&&function(e,t){let i,r=null,n=e.fragments;for(let e=n.length-1;e>=0;e--){let t=n[e].initSegment;if(t){r=t;break}}e.fragmentHint&&delete e.fragmentHint.endPTS;let a=0;if(function(e,t,i){let r=t.skippedSegments,n=Math.max(e.startSN,t.startSN)-t.startSN,a=(e.fragmentHint?1:0)+(r?t.endSN:Math.min(e.endSN,t.endSN))-t.startSN,s=t.startSN-e.startSN,o=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments,l=e.fragmentHint?e.fragments.concat(e.fragmentHint):e.fragments;for(let e=n;e<=a;e++){let n=l[s+e],a=o[e];r&&!a&&e<r&&(a=t.fragments[e]=n),n&&a&&i(n,a)}}(e,t,(e,n)=>{e.relurl&&(a=e.cc-n.cc),_(e.startPTS)&&_(e.endPTS)&&(n.start=n.startPTS=e.startPTS,n.startDTS=e.startDTS,n.maxStartPTS=e.maxStartPTS,n.endPTS=e.endPTS,n.endDTS=e.endDTS,n.minEndPTS=e.minEndPTS,n.duration=e.endPTS-e.startPTS,n.duration&&(i=n),t.PTSKnown=t.alignedSliding=!0),n.elementaryStreams=e.elementaryStreams,n.loader=e.loader,n.stats=e.stats,n.urlId=e.urlId,e.initSegment&&(n.initSegment=e.initSegment,r=e.initSegment)}),r){let e=t.fragmentHint?t.fragments.concat(t.fragmentHint):t.fragments;e.forEach(e=>{var t;e.initSegment&&e.initSegment.relurl!==(null==(t=r)?void 0:t.relurl)||(e.initSegment=r)})}if(t.skippedSegments){if(t.deltaUpdateFailed=t.fragments.some(e=>!e),t.deltaUpdateFailed){M.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(let e=t.skippedSegments;e--;)t.fragments.shift();t.startSN=t.fragments[0].sn,t.startCC=t.fragments[0].cc}else t.canSkipDateRanges&&(t.dateRanges=function(e,t,i){let r=b({},e);return i&&i.forEach(e=>{delete r[e]}),Object.keys(t).forEach(e=>{let i=new L(t[e].attr,r[e]);i.isValid?r[e]=i:M.warn(`Ignoring invalid Playlist Delta Update DATERANGE tag: "${JSON.stringify(t[e].attr)}"`)}),r}(e.dateRanges,t.dateRanges,t.recentlyRemovedDateranges))}let s=t.fragments;if(a){M.warn("discontinuity sliding from playlist, take drift into account");for(let e=0;e<s.length;e++)s[e].cc+=a}t.skippedSegments&&(t.startCC=t.fragments[0].cc),function(e,t,i){if(e&&t){let r=0;for(let n=0,a=e.length;n<=a;n++){let a=e[n],s=t[n+r];a&&s&&a.index===s.index&&a.fragment.sn===s.fragment.sn?i(a,s):r--}}}(e.partList,t.partList,(e,t)=>{t.elementaryStreams=e.elementaryStreams,t.stats=e.stats}),i?ti(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS):tr(e,t),s.length&&(t.totalduration=t.edge-s[0].start),t.driftStartTime=e.driftStartTime,t.driftStart=e.driftStart;let o=t.advancedDateTime;if(t.advanced&&o){let e=t.edge;t.driftStart||(t.driftStartTime=o,t.driftStart=e),t.driftEndTime=o,t.driftEnd=e}else t.driftEndTime=e.driftEndTime,t.driftEnd=e.driftEnd,t.advancedDateTime=e.advancedDateTime}(i,r),!this.canLoad||!r.live)return;if(r.canBlockReload&&r.endSN&&r.advanced){let e=this.hls.config.lowLatencyMode,n=r.lastPartSn,a=r.endSN,u=r.lastPartIndex,c=n===a;-1!==u?(o=c?a+1:n,l=c?e?0:u:u+1):o=a+1;let d=r.age,h=d+r.ageHeader,f=Math.min(h-r.partTarget,1.5*r.targetduration);if(f>0){if(i&&f>i.tuneInGoal)this.warn(`CDN Tune-in goal increased from: ${i.tuneInGoal} to: ${f} with playlist age: ${r.age}`),f=0;else{let e=Math.floor(f/r.targetduration);if(o+=e,void 0!==l){let e=Math.round(f%r.targetduration/r.partTarget);l+=e}this.log(`CDN Tune-in age: ${r.ageHeader}s last advanced ${d.toFixed(2)}s goal: ${f} skip sn ${e} to part ${l}`)}r.tuneInGoal=f}if(s=this.getDeliveryDirectives(r,t.deliveryDirectives,o,l),e||!c){this.loadPlaylist(s);return}}else(r.canBlockReload||r.canSkipUntil)&&(s=this.getDeliveryDirectives(r,t.deliveryDirectives,o,l));let u=this.hls.mainForwardBufferInfo,c=u?u.end-u.len:0,d=(r.edge-c)*1e3,h=function(e,t=1/0){let i=1e3*e.targetduration;if(e.updated){let r=e.fragments;if(r.length&&4*i>t){let e=1e3*r[r.length-1].duration;e<i&&(i=e)}}else i/=2;return Math.round(i)}(r,d);r.updated&&a>this.requestScheduled+h&&(this.requestScheduled=n.loading.start),void 0!==o&&r.canBlockReload?this.requestScheduled=n.loading.first+h-(1e3*r.partTarget||1e3):-1===this.requestScheduled||this.requestScheduled+h<a?this.requestScheduled=a:this.requestScheduled-a<=0&&(this.requestScheduled+=h);let f=this.requestScheduled-a;f=Math.max(0,f),this.log(`reload live playlist ${e} in ${Math.round(f)} ms`),this.timer=self.setTimeout(()=>this.loadPlaylist(s),f)}else this.clearTimer()}getDeliveryDirectives(e,t,i,r){let n=function(e,t){let{canSkipUntil:i,canSkipDateRanges:r,endSN:n}=e;return i&&(void 0!==t?t-n:0)<i?r?e7.v2:e7.Yes:e7.No}(e,i);return null!=t&&t.skip&&e.deltaUpdateFailed&&(i=t.msn,r=t.part,n=e7.No),new e9(i,r,n)}checkRetry(e){let t=e.details,i=to(e),r=e.errorAction,{action:n,retryCount:a=0,retryConfig:s}=r||{},o=!!r&&!!s&&(n===tm.RetryRequest||!r.resolved&&n===tm.SendAlternateToPenaltyBox);if(o){var l;if(this.requestScheduled=-1,a>=s.maxNumRetry)return!1;if(i&&null!=(l=e.context)&&l.deliveryDirectives)this.warn(`Retrying playlist loading ${a+1}/${s.maxNumRetry} after "${t}" without delivery-directives`),this.loadPlaylist();else{let e=tu(s,a);this.timer=self.setTimeout(()=>this.loadPlaylist(),e),this.warn(`Retrying playlist loading ${a+1}/${s.maxNumRetry} after "${t}" in ${e}ms`)}e.levelRetry=!0,r.resolved=!0}return o}}class ty extends tv{constructor(e,t){super(e,"[level-controller]"),this._levels=[],this._firstLevel=-1,this._startLevel=void 0,this.currentLevel=null,this.currentLevelIndex=-1,this.manualLevelIndex=-1,this.steering=void 0,this.onParsedComplete=void 0,this.steering=t,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(E.LEVEL_LOADED,this.onLevelLoaded,this),e.on(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(E.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(E.FRAG_LOADED,this.onFragLoaded,this),e.on(E.ERROR,this.onError,this)}_unregisterListeners(){let{hls:e}=this;e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(E.LEVEL_LOADED,this.onLevelLoaded,this),e.off(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(E.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(E.FRAG_LOADED,this.onFragLoaded,this),e.off(E.ERROR,this.onError,this)}destroy(){this._unregisterListeners(),this.steering=null,this.resetLevels(),super.destroy()}startLoad(){let e=this._levels;e.forEach(e=>{e.loadError=0,e.fragmentError=0}),super.startLoad()}resetLevels(){this._startLevel=void 0,this.manualLevelIndex=-1,this.currentLevelIndex=-1,this.currentLevel=null,this._levels=[]}onManifestLoading(e,t){this.resetLevels()}onManifestLoaded(e,t){let i;let r=[],a={};t.levels.forEach(e=>{var t;let s=e.attrs;(null==(t=e.audioCodec)?void 0:t.indexOf("mp4a.40.34"))!==-1&&(n||(n=/chrome|firefox/i.test(navigator.userAgent)),n&&(e.audioCodec=void 0));let{AUDIO:o,CODECS:l,"FRAME-RATE":u,"PATHWAY-ID":c,RESOLUTION:d,SUBTITLES:h}=s,f=`${c||"."}-`,p=`${f}${e.bitrate}-${d}-${u}-${l}`;(i=a[p])?i.addFallback(e):(i=new te(e),a[p]=i,r.push(i)),tb(i,"audio",o),tb(i,"text",h)}),this.filterAndSortMediaOptions(r,t)}filterAndSortMediaOptions(e,t){let i=[],r=[],n=!1,a=!1,s=!1,o=e.filter(({audioCodec:e,videoCodec:t,width:i,height:r,unknownCodecs:o})=>(n||(n=!!(i&&r)),a||(a=!!t),s||(s=!!e),!(null!=o&&o.length)&&(!e||eD(e,"audio"))&&(!t||eD(t,"video"))));if((n||a)&&s&&(o=o.filter(({videoCodec:e,width:t,height:i})=>!!e||!!(t&&i))),0===o.length){Promise.resolve().then(()=>{if(this.hls){let e=Error("no level with compatible codecs found in manifest");this.hls.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:t.url,error:e,reason:e.message})}});return}t.audioTracks&&t_(i=t.audioTracks.filter(e=>!e.audioCodec||eD(e.audioCodec,"audio"))),t.subtitles&&t_(r=t.subtitles);let l=o.slice(0);o.sort((e,t)=>e.attrs["HDCP-LEVEL"]!==t.attrs["HDCP-LEVEL"]?(e.attrs["HDCP-LEVEL"]||"")>(t.attrs["HDCP-LEVEL"]||"")?1:-1:e.bitrate!==t.bitrate?e.bitrate-t.bitrate:e.attrs["FRAME-RATE"]!==t.attrs["FRAME-RATE"]?e.attrs.decimalFloatingPoint("FRAME-RATE")-t.attrs.decimalFloatingPoint("FRAME-RATE"):e.attrs.SCORE!==t.attrs.SCORE?e.attrs.decimalFloatingPoint("SCORE")-t.attrs.decimalFloatingPoint("SCORE"):n&&e.height!==t.height?e.height-t.height:0);let u=l[0];if(this.steering&&(o=this.steering.filterParsedLevels(o)).length!==l.length){for(let e=0;e<l.length;e++)if(l[e].pathwayId===o[0].pathwayId){u=l[e];break}}this._levels=o;for(let e=0;e<o.length;e++)if(o[e]===u){this._firstLevel=e,this.log(`manifest loaded, ${o.length} level(s) found, first bitrate: ${u.bitrate}`);break}let c=s&&!a,d={levels:o,audioTracks:i,subtitleTracks:r,sessionData:t.sessionData,sessionKeys:t.sessionKeys,firstLevel:this._firstLevel,stats:t.stats,audio:s,video:a,altAudio:!c&&i.some(e=>!!e.url)};this.hls.trigger(E.MANIFEST_PARSED,d),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}get levels(){return 0===this._levels.length?null:this._levels}get level(){return this.currentLevelIndex}set level(e){let t=this._levels;if(0===t.length)return;if(e<0||e>=t.length){let i=Error("invalid level idx"),r=e<0;if(this.hls.trigger(E.ERROR,{type:S.OTHER_ERROR,details:x.LEVEL_SWITCH_ERROR,level:e,fatal:r,error:i,reason:i.message}),r)return;e=Math.min(e,t.length-1)}let i=this.currentLevelIndex,r=this.currentLevel,n=r?r.attrs["PATHWAY-ID"]:void 0,a=t[e],s=a.attrs["PATHWAY-ID"];if(this.currentLevelIndex=e,this.currentLevel=a,i===e&&a.details&&r&&n===s)return;this.log(`Switching to level ${e}${s?" with Pathway "+s:""} from level ${i}${n?" with Pathway "+n:""}`);let o=b({},a,{level:e,maxBitrate:a.maxBitrate,attrs:a.attrs,uri:a.uri,urlId:a.urlId});delete o._attrs,delete o._urlId,this.hls.trigger(E.LEVEL_SWITCHING,o);let l=a.details;if(!l||l.live){let e=this.switchParams(a.uri,null==r?void 0:r.details);this.loadPlaylist(e)}}get manualLevel(){return this.manualLevelIndex}set manualLevel(e){this.manualLevelIndex=e,void 0===this._startLevel&&(this._startLevel=e),-1!==e&&(this.level=e)}get firstLevel(){return this._firstLevel}set firstLevel(e){this._firstLevel=e}get startLevel(){if(void 0!==this._startLevel)return this._startLevel;{let e=this.hls.config.startLevel;return void 0!==e?e:this._firstLevel}}set startLevel(e){this._startLevel=e}onError(e,t){!t.fatal&&t.context&&t.context.type===e$.LEVEL&&t.context.level===this.level&&this.checkRetry(t)}onFragLoaded(e,{frag:t}){if(void 0!==t&&t.type===eq.MAIN){let e=this._levels[t.level];void 0!==e&&(e.loadError=0)}}onLevelLoaded(e,t){var i,r;let{level:n,details:a}=t,s=this._levels[n];if(!s){this.warn(`Invalid level index ${n}`),null!=(r=t.deliveryDirectives)&&r.skip&&(a.deltaUpdateFailed=!0);return}n===this.currentLevelIndex?(0===s.fragmentError&&(s.loadError=0),this.playlistLoaded(n,t,s.details)):null!=(i=t.deliveryDirectives)&&i.skip&&(a.deltaUpdateFailed=!0)}onAudioTrackSwitched(e,t){let i=this.currentLevel;if(!i)return;let r=this.hls.audioTracks[t.id].groupId;if(i.audioGroupIds&&i.audioGroupId!==r){let e=-1;for(let t=0;t<i.audioGroupIds.length;t++)if(i.audioGroupIds[t]===r){e=t;break}-1!==e&&e!==i.urlId&&(i.urlId=e,this.canLoad&&this.startLoad())}}loadPlaylist(e){super.loadPlaylist();let t=this.currentLevelIndex,i=this.currentLevel;if(i&&this.shouldLoadPlaylist(i)){let r=i.urlId,n=i.uri;if(e)try{n=e.addDirectives(n)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}let a=i.attrs["PATHWAY-ID"];this.log(`Loading level index ${t}${(null==e?void 0:e.msn)!==void 0?" at sn "+e.msn+" part "+e.part:""} with${a?" Pathway "+a:""} URI ${r+1}/${i.url.length} ${n}`),this.clearTimer(),this.hls.trigger(E.LEVEL_LOADING,{url:n,level:t,id:r,deliveryDirectives:e||null})}}get nextLoadLevel(){return -1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel}set nextLoadLevel(e){this.level=e,-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=e)}removeLevel(e,t){let i=(e,i)=>i!==t,r=this._levels.filter((r,n)=>n!==e||(r.url.length>1&&void 0!==t?(r.url=r.url.filter(i),r.audioGroupIds&&(r.audioGroupIds=r.audioGroupIds.filter(i)),r.textGroupIds&&(r.textGroupIds=r.textGroupIds.filter(i)),r.urlId=0,!0):(this.steering&&this.steering.removeLevel(r),!1)));this.hls.trigger(E.LEVELS_UPDATED,{levels:r})}onLevelsUpdated(e,{levels:t}){t.forEach((e,t)=>{let{details:i}=e;null!=i&&i.fragments&&i.fragments.forEach(e=>{e.level=t})}),this._levels=t}}function tb(e,t,i){i&&("audio"===t?(e.audioGroupIds||(e.audioGroupIds=[]),e.audioGroupIds[e.url.length-1]=i):"text"===t&&(e.textGroupIds||(e.textGroupIds=[]),e.textGroupIds[e.url.length-1]=i))}function t_(e){let t={};e.forEach(e=>{let i=e.groupId||"";e.id=t[i]=t[i]||0,t[i]++})}var tE={NOT_LOADED:"NOT_LOADED",APPENDING:"APPENDING",PARTIAL:"PARTIAL",OK:"OK"};class tS{constructor(e){this.activePartLists=Object.create(null),this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hasGaps=!1,this.hls=e,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(E.BUFFER_APPENDED,this.onBufferAppended,this),e.on(E.FRAG_BUFFERED,this.onFragBuffered,this),e.on(E.FRAG_LOADED,this.onFragLoaded,this)}_unregisterListeners(){let{hls:e}=this;e.off(E.BUFFER_APPENDED,this.onBufferAppended,this),e.off(E.FRAG_BUFFERED,this.onFragBuffered,this),e.off(E.FRAG_LOADED,this.onFragLoaded,this)}destroy(){this._unregisterListeners(),this.fragments=this.activePartLists=this.endListFragments=this.timeRanges=null}getAppendedFrag(e,t){let i=this.activePartLists[t];if(i)for(let t=i.length;t--;){let r=i[t];if(!r)break;let n=r.end;if(r.start<=e&&null!==n&&e<=n)return r}return this.getBufferedFrag(e,t)}getBufferedFrag(e,t){let{fragments:i}=this,r=Object.keys(i);for(let n=r.length;n--;){let a=i[r[n]];if((null==a?void 0:a.body.type)===t&&a.buffered){let t=a.body;if(t.start<=e&&e<=t.end)return t}}return null}detectEvictedFragments(e,t,i,r){this.timeRanges&&(this.timeRanges[e]=t);let n=(null==r?void 0:r.fragment.sn)||-1;Object.keys(this.fragments).forEach(r=>{let a=this.fragments[r];if(!a||n>=a.body.sn)return;if(!a.buffered&&!a.loaded){a.body.type===i&&this.removeFragment(a.body);return}let s=a.range[e];s&&s.time.some(e=>{let i=!this.isTimeBuffered(e.startPTS,e.endPTS,t);return i&&this.removeFragment(a.body),i})})}detectPartialFragments(e){let t=this.timeRanges,{frag:i,part:r}=e;if(!t||"initSegment"===i.sn)return;let n=tT(i),a=this.fragments[n];if(!a||a.buffered&&i.gap)return;let s=!i.relurl;if(Object.keys(t).forEach(e=>{let n=i.elementaryStreams[e];if(!n)return;let o=t[e],l=s||!0===n.partial;a.range[e]=this.getBufferedTimes(i,r,l,o)}),a.loaded=null,Object.keys(a.range).length){a.buffered=!0;let e=a.body.endList=i.endList||a.body.endList;e&&(this.endListFragments[a.body.type]=a),tx(a)||this.removeParts(i.sn-1,i.type)}else this.removeFragment(a.body)}removeParts(e,t){let i=this.activePartLists[t];i&&(this.activePartLists[t]=i.filter(t=>t.fragment.sn>=e))}fragBuffered(e,t){let i=tT(e),r=this.fragments[i];!r&&t&&(r=this.fragments[i]={body:e,appendedPTS:null,loaded:null,buffered:!1,range:Object.create(null)},e.gap&&(this.hasGaps=!0)),r&&(r.loaded=null,r.buffered=!0)}getBufferedTimes(e,t,i,r){let n={time:[],partial:i},a=e.start,s=e.end,o=e.minEndPTS||s,l=e.maxStartPTS||a;for(let e=0;e<r.length;e++){let t=r.start(e)-this.bufferPadding,i=r.end(e)+this.bufferPadding;if(l>=t&&o<=i){n.time.push({startPTS:Math.max(a,r.start(e)),endPTS:Math.min(s,r.end(e))});break}if(a<i&&s>t)n.partial=!0,n.time.push({startPTS:Math.max(a,r.start(e)),endPTS:Math.min(s,r.end(e))});else if(s<=t)break}return n}getPartialFragment(e){let t,i,r,n=null,a=0,{bufferPadding:s,fragments:o}=this;return Object.keys(o).forEach(l=>{let u=o[l];u&&tx(u)&&(i=u.body.start-s,r=u.body.end+s,e>=i&&e<=r&&a<=(t=Math.min(e-i,r-e))&&(n=u.body,a=t))}),n}isEndListAppended(e){let t=this.endListFragments[e];return void 0!==t&&(t.buffered||tx(t))}getState(e){let t=tT(e),i=this.fragments[t];return i?i.buffered?tx(i)?tE.PARTIAL:tE.OK:tE.APPENDING:tE.NOT_LOADED}isTimeBuffered(e,t,i){let r,n;for(let a=0;a<i.length;a++){if(r=i.start(a)-this.bufferPadding,n=i.end(a)+this.bufferPadding,e>=r&&t<=n)return!0;if(t<=r)break}return!1}onFragLoaded(e,t){let{frag:i,part:r}=t;if("initSegment"===i.sn||i.bitrateTest)return;let n=tT(i);this.fragments[n]={body:i,appendedPTS:null,loaded:r?null:t,buffered:!1,range:Object.create(null)}}onBufferAppended(e,t){let{frag:i,part:r,timeRanges:n}=t;if("initSegment"===i.sn)return;let a=i.type;if(r){let e=this.activePartLists[a];e||(this.activePartLists[a]=e=[]),e.push(r)}this.timeRanges=n,Object.keys(n).forEach(e=>{let t=n[e];this.detectEvictedFragments(e,t,a,r)})}onFragBuffered(e,t){this.detectPartialFragments(t)}hasFragment(e){let t=tT(e);return!!this.fragments[t]}hasParts(e){var t;return!!(null!=(t=this.activePartLists[e])&&t.length)}removeFragmentsInRange(e,t,i,r,n){(!r||this.hasGaps)&&Object.keys(this.fragments).forEach(a=>{let s=this.fragments[a];if(!s)return;let o=s.body;o.type===i&&(!r||o.gap)&&o.start<t&&o.end>e&&(s.buffered||n)&&this.removeFragment(o)})}removeFragment(e){let t=tT(e);e.stats.loaded=0,e.clearElementaryStreamInfo();let i=this.activePartLists[e.type];if(i){let t=e.sn;this.activePartLists[e.type]=i.filter(e=>e.fragment.sn!==t)}delete this.fragments[t],e.endList&&delete this.endListFragments[e.type]}removeAllFragments(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activePartLists=Object.create(null),this.hasGaps=!1}}function tx(e){var t,i,r;return e.buffered&&(e.body.gap||(null==(t=e.range.video)?void 0:t.partial)||(null==(i=e.range.audio)?void 0:i.partial)||(null==(r=e.range.audiovideo)?void 0:r.partial))}function tT(e){return`${e.type}_${e.level}_${e.urlId}_${e.sn}`}class tw{constructor(e){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=e}destroy(){this.loader&&(this.loader.destroy(),this.loader=null)}abort(){this.loader&&this.loader.abort()}load(e,t){let i=e.url;if(!i)return Promise.reject(new tR({type:S.NETWORK_ERROR,details:x.FRAG_LOAD_ERROR,fatal:!1,frag:e,error:Error(`Fragment does not have a ${i?"part list":"url"}`),networkDetails:null}));this.abort();let r=this.config,n=r.fLoader,a=r.loader;return new Promise((s,o)=>{if(this.loader&&this.loader.destroy(),e.gap){if(e.tagList.some(e=>"GAP"===e[0])){o(tM(e));return}e.gap=!1}let l=this.loader=e.loader=n?new n(r):new a(r),u=tA(e),c=tc(r.fragLoadPolicy.default),d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:"initSegment"===e.sn?1/0:131072};e.stats=l.stats,l.load(u,d,{onSuccess:(t,i,r,n)=>{this.resetLoader(e,l);let a=t.data;r.resetIV&&e.decryptdata&&(e.decryptdata.iv=new Uint8Array(a.slice(0,16)),a=a.slice(16)),s({frag:e,part:null,payload:a,networkDetails:n})},onError:(t,r,n,a)=>{this.resetLoader(e,l),o(new tR({type:S.NETWORK_ERROR,details:x.FRAG_LOAD_ERROR,fatal:!1,frag:e,response:y({url:i,data:void 0},t),error:Error(`HTTP Error ${t.code} ${t.text}`),networkDetails:n,stats:a}))},onAbort:(t,i,r)=>{this.resetLoader(e,l),o(new tR({type:S.NETWORK_ERROR,details:x.INTERNAL_ABORTED,fatal:!1,frag:e,error:Error("Aborted"),networkDetails:r,stats:t}))},onTimeout:(t,i,r)=>{this.resetLoader(e,l),o(new tR({type:S.NETWORK_ERROR,details:x.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,error:Error(`Timeout after ${d.timeout}ms`),networkDetails:r,stats:t}))},onProgress:(i,r,n,a)=>{t&&t({frag:e,part:null,payload:n,networkDetails:a})}})})}loadPart(e,t,i){this.abort();let r=this.config,n=r.fLoader,a=r.loader;return new Promise((s,o)=>{if(this.loader&&this.loader.destroy(),e.gap||t.gap){o(tM(e,t));return}let l=this.loader=e.loader=n?new n(r):new a(r),u=tA(e,t),c=tc(r.fragLoadPolicy.default),d={loadPolicy:c,timeout:c.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0,highWaterMark:131072};t.stats=l.stats,l.load(u,d,{onSuccess:(r,n,a,o)=>{this.resetLoader(e,l),this.updateStatsFromPart(e,t);let u={frag:e,part:t,payload:r.data,networkDetails:o};i(u),s(u)},onError:(i,r,n,a)=>{this.resetLoader(e,l),o(new tR({type:S.NETWORK_ERROR,details:x.FRAG_LOAD_ERROR,fatal:!1,frag:e,part:t,response:y({url:u.url,data:void 0},i),error:Error(`HTTP Error ${i.code} ${i.text}`),networkDetails:n,stats:a}))},onAbort:(i,r,n)=>{e.stats.aborted=t.stats.aborted,this.resetLoader(e,l),o(new tR({type:S.NETWORK_ERROR,details:x.INTERNAL_ABORTED,fatal:!1,frag:e,part:t,error:Error("Aborted"),networkDetails:n,stats:i}))},onTimeout:(i,r,n)=>{this.resetLoader(e,l),o(new tR({type:S.NETWORK_ERROR,details:x.FRAG_LOAD_TIMEOUT,fatal:!1,frag:e,part:t,error:Error(`Timeout after ${d.timeout}ms`),networkDetails:n,stats:i}))}})})}updateStatsFromPart(e,t){let i=e.stats,r=t.stats,n=r.total;if(i.loaded+=r.loaded,n){let r=Math.round(e.duration/t.duration),a=Math.min(Math.round(i.loaded/n),r),s=(r-a)*Math.round(i.loaded/a);i.total=i.loaded+s}else i.total=Math.max(i.loaded,i.total);let a=i.loading,s=r.loading;a.start?a.first+=s.first-s.start:(a.start=s.start,a.first=s.first),a.end=s.end}resetLoader(e,t){e.loader=null,this.loader===t&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),t.destroy()}}function tA(e,t=null){let i=t||e,r={frag:e,part:t,responseType:"arraybuffer",url:i.url,headers:{},rangeStart:0,rangeEnd:0},n=i.byteRangeStartOffset,a=i.byteRangeEndOffset;if(_(n)&&_(a)){var s;let t=n,i=a;if("initSegment"===e.sn&&(null==(s=e.decryptdata)?void 0:s.method)==="AES-128"){let e=a-n;e%16&&(i=a+(16-e%16)),0!==n&&(r.resetIV=!0,t=n-16)}r.rangeStart=t,r.rangeEnd=i}return r}function tM(e,t){let i=Error(`GAP ${e.gap?"tag":"attribute"} found`),r={type:S.MEDIA_ERROR,details:x.FRAG_GAP,fatal:!1,frag:e,error:i,networkDetails:null};return t&&(r.part=t),(t||e).stats.aborted=!0,new tR(r)}class tR extends Error{constructor(e){super(e.error.message),this.data=void 0,this.data=e}}class tC{constructor(e){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=e}abort(e){for(let t in this.keyUriToKeyInfo){let i=this.keyUriToKeyInfo[t].loader;if(i){if(e&&e!==i.context.frag.type)return;i.abort()}}}detach(){for(let e in this.keyUriToKeyInfo){let t=this.keyUriToKeyInfo[e];(t.mediaKeySessionContext||t.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[e]}}destroy(){for(let e in this.detach(),this.keyUriToKeyInfo){let t=this.keyUriToKeyInfo[e].loader;t&&t.destroy()}this.keyUriToKeyInfo={}}createKeyLoadError(e,t=x.KEY_LOAD_ERROR,i,r,n){return new tR({type:S.NETWORK_ERROR,details:t,fatal:!1,frag:e,response:n,error:i,networkDetails:r})}loadClear(e,t){if(this.emeController&&this.config.emeEnabled){let{sn:i,cc:r}=e;for(let e=0;e<t.length;e++){let n=t[e];if(r<=n.cc&&("initSegment"===i||"initSegment"===n.sn||i<n.sn)){this.emeController.selectKeySystemFormat(n).then(e=>{n.setKeyFormat(e)});break}}}}load(e){return!e.decryptdata&&e.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(e).then(t=>this.loadInternal(e,t)):this.loadInternal(e)}loadInternal(e,t){var i,r,n;t&&e.setKeyFormat(t);let a=e.decryptdata;if(!a){let i=Error(t?`Expected frag.decryptdata to be defined after setting format ${t}`:"Missing decryption data on fragment in onKeyLoading");return Promise.reject(this.createKeyLoadError(e,x.KEY_LOAD_ERROR,i))}let s=a.uri;if(!s)return Promise.reject(this.createKeyLoadError(e,x.KEY_LOAD_ERROR,Error(`Invalid key URI: "${s}"`)));let o=this.keyUriToKeyInfo[s];if(null!=(i=o)&&i.decryptdata.key)return a.key=o.decryptdata.key,Promise.resolve({frag:e,keyInfo:o});if(null!=(r=o)&&r.keyLoadPromise)switch(null==(n=o.mediaKeySessionContext)?void 0:n.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return o.keyLoadPromise.then(t=>(a.key=t.keyInfo.decryptdata.key,{frag:e,keyInfo:o}))}switch(o=this.keyUriToKeyInfo[s]={decryptdata:a,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},a.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":if("identity"===a.keyFormat)return this.loadKeyHTTP(o,e);return this.loadKeyEME(o,e);case"AES-128":return this.loadKeyHTTP(o,e);default:return Promise.reject(this.createKeyLoadError(e,x.KEY_LOAD_ERROR,Error(`Key supplied with unsupported METHOD: "${a.method}"`)))}}loadKeyEME(e,t){let i={frag:t,keyInfo:e};if(this.emeController&&this.config.emeEnabled){let t=this.emeController.loadKey(i);if(t)return(e.keyLoadPromise=t.then(t=>(e.mediaKeySessionContext=t,i))).catch(t=>{throw e.keyLoadPromise=null,t})}return Promise.resolve(i)}loadKeyHTTP(e,t){let i=this.config,r=i.loader,n=new r(i);return t.keyLoader=e.loader=n,e.keyLoadPromise=new Promise((r,a)=>{let s={keyInfo:e,frag:t,responseType:"arraybuffer",url:e.decryptdata.uri},o=i.keyLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0};n.load(s,l,{onSuccess:(e,t,i,n)=>{let{frag:s,keyInfo:o,url:l}=i;if(!s.decryptdata||o!==this.keyUriToKeyInfo[l])return a(this.createKeyLoadError(s,x.KEY_LOAD_ERROR,Error("after key load, decryptdata unset or changed"),n));o.decryptdata.key=s.decryptdata.key=new Uint8Array(e.data),s.keyLoader=null,o.loader=null,r({frag:s,keyInfo:o})},onError:(e,i,r,n)=>{this.resetLoader(i),a(this.createKeyLoadError(t,x.KEY_LOAD_ERROR,Error(`HTTP Error ${e.code} loading key ${e.text}`),r,y({url:s.url,data:void 0},e)))},onTimeout:(e,i,r)=>{this.resetLoader(i),a(this.createKeyLoadError(t,x.KEY_LOAD_TIMEOUT,Error("key loading timed out"),r))},onAbort:(e,i,r)=>{this.resetLoader(i),a(this.createKeyLoadError(t,x.INTERNAL_ABORTED,Error("key loading aborted"),r))}})})}resetLoader(e){let{frag:t,keyInfo:i,url:r}=e,n=i.loader;t.keyLoader===n&&(t.keyLoader=null,i.loader=null),delete this.keyUriToKeyInfo[r],n&&n.destroy()}}class tI{constructor(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}destroy(){this.onHandlerDestroying(),this.onHandlerDestroyed()}onHandlerDestroying(){this.clearNextTick(),this.clearInterval()}onHandlerDestroyed(){}hasInterval(){return!!this._tickInterval}hasNextTick(){return!!this._tickTimer}setInterval(e){return!this._tickInterval&&(this._tickCallCount=0,this._tickInterval=self.setInterval(this._boundTick,e),!0)}clearInterval(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)}clearNextTick(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)}tick(){this._tickCallCount++,1===this._tickCallCount&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)}tickImmediate(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)}doTick(){}}let tL={length:0,start:()=>0,end:()=>0};class tk{static isBuffered(e,t){try{if(e){let i=tk.getBuffered(e);for(let e=0;e<i.length;e++)if(t>=i.start(e)&&t<=i.end(e))return!0}}catch(e){}return!1}static bufferInfo(e,t,i){try{if(e){let r;let n=tk.getBuffered(e),a=[];for(r=0;r<n.length;r++)a.push({start:n.start(r),end:n.end(r)});return this.bufferedInfo(a,t,i)}}catch(e){}return{len:0,start:t,end:t,nextStart:void 0}}static bufferedInfo(e,t,i){let r;t=Math.max(0,t),e.sort(function(e,t){let i=e.start-t.start;return i||t.end-e.end});let n=[];if(i)for(let t=0;t<e.length;t++){let r=n.length;if(r){let a=n[r-1].end;e[t].start-a<i?e[t].end>a&&(n[r-1].end=e[t].end):n.push(e[t])}else n.push(e[t])}else n=e;let a=0,s=t,o=t;for(let e=0;e<n.length;e++){let l=n[e].start,u=n[e].end;if(t+i>=l&&t<u)s=l,a=(o=u)-t;else if(t+i<l){r=l;break}}return{len:a,start:s||0,end:o||0,nextStart:r}}static getBuffered(e){try{return e.buffered}catch(e){return M.log("failed to get media.buffered",e),tL}}}class tD{constructor(e,t,i,r=0,n=-1,a=!1){this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=tP(),this.buffering={audio:tP(),video:tP(),audiovideo:tP()},this.level=e,this.sn=t,this.id=i,this.size=r,this.part=n,this.partial=a}}function tP(){return{start:0,executeStart:0,executeEnd:0,end:0}}function tO(e,t){let i=null;for(let r=0,n=e.length;r<n;r++){let n=e[r];if(n&&n.cc===t){i=n;break}}return i}function tN(e,t){if(e){let i=e.start+t;e.start=e.startPTS=i,e.endPTS=i+e.duration}}function tU(e,t){let i=t.fragments;for(let t=0,r=i.length;t<r;t++)tN(i[t],e);t.fragmentHint&&tN(t.fragmentHint,e),t.alignedSliding=!0}function tF(e,t){if(!e.hasProgramDateTime||!t.hasProgramDateTime)return;let i=e.fragments,r=t.fragments;if(!i.length||!r.length)return;let n=Math.round(r.length/2)-1,a=r[n],s=tO(i,a.cc)||i[Math.round(i.length/2)-1],o=a.programDateTime,l=s.programDateTime;if(null===o||null===l)return;let u=(l-o)/1e3-(s.start-a.start);tU(u,e)}class tB{constructor(e,t){this.subtle=void 0,this.aesIV=void 0,this.subtle=e,this.aesIV=t}decrypt(e,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,e)}}class tV{constructor(e,t){this.subtle=void 0,this.key=void 0,this.subtle=e,this.key=t}expandKey(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])}}class tz{constructor(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}uint8ArrayToUint32Array_(e){let t=new DataView(e),i=new Uint32Array(4);for(let e=0;e<4;e++)i[e]=t.getUint32(4*e);return i}initTable(){let e=this.sBox,t=this.invSBox,i=this.subMix,r=i[0],n=i[1],a=i[2],s=i[3],o=this.invSubMix,l=o[0],u=o[1],c=o[2],d=o[3],h=new Uint32Array(256),f=0,p=0,m=0;for(m=0;m<256;m++)m<128?h[m]=m<<1:h[m]=m<<1^283;for(m=0;m<256;m++){let i=p^p<<1^p<<2^p<<3^p<<4;i=i>>>8^255&i^99,e[f]=i,t[i]=f;let o=h[f],m=h[o],g=h[m],v=257*h[i]^16843008*i;r[f]=v<<24|v>>>8,n[f]=v<<16|v>>>16,a[f]=v<<8|v>>>24,s[f]=v,v=16843009*g^65537*m^257*o^16843008*f,l[i]=v<<24|v>>>8,u[i]=v<<16|v>>>16,c[i]=v<<8|v>>>24,d[i]=v,f?(f=o^h[h[h[g^o]]],p^=h[h[p]]):f=p=1}}expandKey(e){let t,i,r,n;let a=this.uint8ArrayToUint32Array_(e),s=!0,o=0;for(;o<a.length&&s;)s=a[o]===this.key[o],o++;if(s)return;this.key=a;let l=this.keySize=a.length;if(4!==l&&6!==l&&8!==l)throw Error("Invalid aes key size="+l);let u=this.ksRows=(l+6+1)*4,c=this.keySchedule=new Uint32Array(u),d=this.invKeySchedule=new Uint32Array(u),h=this.sBox,f=this.rcon,p=this.invSubMix,m=p[0],g=p[1],v=p[2],y=p[3];for(t=0;t<u;t++){if(t<l){r=c[t]=a[t];continue}n=r,t%l==0?n=(h[(n=n<<8|n>>>24)>>>24]<<24|h[n>>>16&255]<<16|h[n>>>8&255]<<8|h[255&n])^f[t/l|0]<<24:l>6&&t%l==4&&(n=h[n>>>24]<<24|h[n>>>16&255]<<16|h[n>>>8&255]<<8|h[255&n]),c[t]=r=(c[t-l]^n)>>>0}for(i=0;i<u;i++)t=u-i,n=3&i?c[t]:c[t-4],i<4||t<=4?d[i]=n:d[i]=m[h[n>>>24]]^g[h[n>>>16&255]]^v[h[n>>>8&255]]^y[h[255&n]],d[i]=d[i]>>>0}networkToHostOrderSwap(e){return e<<24|(65280&e)<<8|(16711680&e)>>8|e>>>24}decrypt(e,t,i){let r,n,a,s,o,l,u,c,d,h,f,p,m,g;let v=this.keySize+6,y=this.invKeySchedule,b=this.invSBox,_=this.invSubMix,E=_[0],S=_[1],x=_[2],T=_[3],w=this.uint8ArrayToUint32Array_(i),A=w[0],M=w[1],R=w[2],C=w[3],I=new Int32Array(e),L=new Int32Array(I.length),k=this.networkToHostOrderSwap;for(;t<I.length;){for(g=1,d=k(I[t]),h=k(I[t+1]),f=k(I[t+2]),p=k(I[t+3]),o=d^y[0],l=p^y[1],u=f^y[2],c=h^y[3],m=4;g<v;g++)r=E[o>>>24]^S[l>>16&255]^x[u>>8&255]^T[255&c]^y[m],n=E[l>>>24]^S[u>>16&255]^x[c>>8&255]^T[255&o]^y[m+1],a=E[u>>>24]^S[c>>16&255]^x[o>>8&255]^T[255&l]^y[m+2],s=E[c>>>24]^S[o>>16&255]^x[l>>8&255]^T[255&u]^y[m+3],o=r,l=n,u=a,c=s,m+=4;r=b[o>>>24]<<24^b[l>>16&255]<<16^b[u>>8&255]<<8^b[255&c]^y[m],n=b[l>>>24]<<24^b[u>>16&255]<<16^b[c>>8&255]<<8^b[255&o]^y[m+1],a=b[u>>>24]<<24^b[c>>16&255]<<16^b[o>>8&255]<<8^b[255&l]^y[m+2],s=b[c>>>24]<<24^b[o>>16&255]<<16^b[l>>8&255]<<8^b[255&u]^y[m+3],L[t]=k(r^A),L[t+1]=k(s^M),L[t+2]=k(a^R),L[t+3]=k(n^C),A=d,M=h,R=f,C=p,t+=4}return L.buffer}}class tj{constructor(e,{removePKCS7Padding:t=!0}={}){if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=e.enableSoftwareAES,this.removePKCS7Padding=t,t)try{let e=self.crypto;e&&(this.subtle=e.subtle||e.webkitSubtle)}catch(e){}null===this.subtle&&(this.useSoftware=!0)}destroy(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null}isSync(){return this.useSoftware}flush(){let{currentResult:e,remainderData:t}=this;if(!e||t)return this.reset(),null;let i=new Uint8Array(e);return(this.reset(),this.removePKCS7Padding)?function(e){let t=e.byteLength,i=t&&new DataView(e.buffer).getUint8(t-1);return i?q(e,0,t-i):e}(i):i}reset(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)}decrypt(e,t,i){return this.useSoftware?new Promise((r,n)=>{this.softwareDecrypt(new Uint8Array(e),t,i);let a=this.flush();a?r(a.buffer):n(Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(e),t,i)}softwareDecrypt(e,t,i){let{currentIV:r,currentResult:n,remainderData:a}=this;this.logOnce("JS AES decrypt"),a&&(e=e_(a,e),this.remainderData=null);let s=this.getValidChunk(e);if(!s.length)return null;r&&(i=r);let o=this.softwareDecrypter;return(o||(o=this.softwareDecrypter=new tz),o.expandKey(t),this.currentResult=o.decrypt(s.buffer,0,i),this.currentIV=q(s,-16).buffer,n)?n:null}webCryptoDecrypt(e,t,i){let r=this.subtle;return this.key===t&&this.fastAesKey||(this.key=t,this.fastAesKey=new tV(r,t)),this.fastAesKey.expandKey().then(t=>{if(!r)return Promise.reject(Error("web crypto not initialized"));this.logOnce("WebCrypto AES decrypt");let n=new tB(r,new Uint8Array(i));return n.decrypt(e.buffer,t)}).catch(r=>(M.warn(`[decrypter]: WebCrypto Error, disable WebCrypto API, ${r.name}: ${r.message}`),this.onWebCryptoError(e,t,i)))}onWebCryptoError(e,t,i){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(e,t,i);let r=this.flush();if(r)return r.buffer;throw Error("WebCrypto and softwareDecrypt: failed to decrypt data")}getValidChunk(e){let t=e,i=e.length-e.length%16;return i!==e.length&&(t=q(e,0,i),this.remainderData=q(e,i)),t}logOnce(e){this.logEnabled&&(M.log(`[decrypter]: ${e}`),this.logEnabled=!1)}}let tH={toString:function(e){let t="",i=e.length;for(let r=0;r<i;r++)t+=`[${e.start(r).toFixed(3)}-${e.end(r).toFixed(3)}]`;return t}},tG={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"};class tW extends tI{constructor(e,t,i,r,n){super(),this.hls=void 0,this.fragPrevious=null,this.fragCurrent=null,this.fragmentTracker=void 0,this.transmuxer=null,this._state=tG.STOPPED,this.playlistType=void 0,this.media=null,this.mediaBuffer=null,this.config=void 0,this.bitrateTest=!1,this.lastCurrentTime=0,this.nextLoadPosition=0,this.startPosition=0,this.startTimeOffset=null,this.loadedmetadata=!1,this.retryDate=0,this.levels=null,this.fragmentLoader=void 0,this.keyLoader=void 0,this.levelLastLoaded=null,this.startFragRequested=!1,this.decrypter=void 0,this.initPTS=[],this.onvseeking=null,this.onvended=null,this.logPrefix="",this.log=void 0,this.warn=void 0,this.playlistType=n,this.logPrefix=r,this.log=M.log.bind(M,`${r}:`),this.warn=M.warn.bind(M,`${r}:`),this.hls=e,this.fragmentLoader=new tw(e.config),this.keyLoader=i,this.fragmentTracker=t,this.config=e.config,this.decrypter=new tj(e.config),e.on(E.MANIFEST_LOADED,this.onManifestLoaded,this)}doTick(){this.onTickEnd()}onTickEnd(){}startLoad(e){}stopLoad(){this.fragmentLoader.abort(),this.keyLoader.abort(this.playlistType);let e=this.fragCurrent;null!=e&&e.loader&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=tG.STOPPED}_streamEnded(e,t){if(t.live||e.nextStart||!e.end||!this.media)return!1;let i=t.partList;if(null!=i&&i.length){let e=i[i.length-1],t=tk.isBuffered(this.media,e.start+e.duration/2);return t}let r=t.fragments[t.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(r)}getLevelDetails(){if(this.levels&&null!==this.levelLastLoaded){var e;return null==(e=this.levels[this.levelLastLoaded])?void 0:e.details}}onMediaAttached(e,t){let i=this.media=this.mediaBuffer=t.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),i.addEventListener("seeking",this.onvseeking),i.addEventListener("ended",this.onvended);let r=this.config;this.levels&&r.autoStartLoad&&this.state===tG.STOPPED&&this.startLoad(r.startPosition)}onMediaDetaching(){let e=this.media;null!=e&&e.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),e&&this.onvseeking&&this.onvended&&(e.removeEventListener("seeking",this.onvseeking),e.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()}onMediaSeeking(){let{config:e,fragCurrent:t,media:i,mediaBuffer:r,state:n}=this,a=i?i.currentTime:0,s=tk.bufferInfo(r||i,a,e.maxBufferHole);if(this.log(`media seeking to ${_(a)?a.toFixed(3):a}, state: ${n}`),this.state===tG.ENDED)this.resetLoadingState();else if(t){let i=e.maxFragLookUpTolerance,r=t.start-i,n=t.start+t.duration+i;if(!s.len||n<s.start||r>s.end){let e=a>n;(a<r||e)&&(e&&t.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),t.abortRequests(),this.resetLoadingState()),this.fragPrevious=null)}}i&&(this.fragmentTracker.removeFragmentsInRange(a,1/0,this.playlistType,!0),this.lastCurrentTime=a),this.loadedmetadata||s.len||(this.nextLoadPosition=this.startPosition=a),this.tickImmediate()}onMediaEnded(){this.startPosition=this.lastCurrentTime=0}onManifestLoaded(e,t){this.startTimeOffset=t.startTimeOffset,this.initPTS=[]}onHandlerDestroying(){this.stopLoad(),super.onHandlerDestroying()}onHandlerDestroyed(){this.state=tG.STOPPED,this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,super.onHandlerDestroyed()}loadFragment(e,t,i){this._loadFragForPlayback(e,t,i)}_loadFragForPlayback(e,t,i){this._doFragLoad(e,t,i,t=>{if(this.fragContextChanged(e)){this.warn(`Fragment ${e.sn}${t.part?" p: "+t.part.index:""} of level ${e.level} was dropped during download.`),this.fragmentTracker.removeFragment(e);return}e.stats.chunkCount++,this._handleFragmentLoadProgress(t)}).then(t=>{if(!t)return;let i=this.state;if(this.fragContextChanged(e)){i!==tG.FRAG_LOADING&&(this.fragCurrent||i!==tG.PARSING)||(this.fragmentTracker.removeFragment(e),this.state=tG.IDLE);return}"payload"in t&&(this.log(`Loaded fragment ${e.sn} of level ${e.level}`),this.hls.trigger(E.FRAG_LOADED,t)),this._handleFragmentLoadComplete(t)}).catch(t=>{this.state!==tG.STOPPED&&this.state!==tG.ERROR&&(this.warn(t),this.resetFragmentLoading(e))})}clearTrackerIfNeeded(e){var t;let{fragmentTracker:i}=this,r=i.getState(e);if(r===tE.APPENDING){let t=e.type,r=this.getFwdBufferInfo(this.mediaBuffer,t),n=Math.max(e.duration,r?r.len:this.config.maxBufferLength);this.reduceMaxBufferLength(n)&&i.removeFragment(e)}else(null==(t=this.mediaBuffer)?void 0:t.buffered.length)===0?i.removeAllFragments():i.hasParts(e.type)&&(i.detectPartialFragments({frag:e,part:null,stats:e.stats,id:e.type}),i.getState(e)===tE.PARTIAL&&i.removeFragment(e))}checkLiveUpdate(e){if(e.updated&&!e.live){let t=e.fragments[e.fragments.length-1];this.fragmentTracker.detectPartialFragments({frag:t,part:null,stats:t.stats,id:t.type})}e.fragments[0]||(e.deltaUpdateFailed=!0)}flushMainBuffer(e,t,i=null){e-t&&this.hls.trigger(E.BUFFER_FLUSHING,{startOffset:e,endOffset:t,type:i})}_loadInitSegment(e,t){this._doFragLoad(e,t).then(t=>{if(!t||this.fragContextChanged(e)||!this.levels)throw Error("init load aborted");return t}).then(t=>{let{hls:i}=this,{payload:r}=t,n=e.decryptdata;if(r&&r.byteLength>0&&n&&n.key&&n.iv&&"AES-128"===n.method){let a=self.performance.now();return this.decrypter.decrypt(new Uint8Array(r),n.key.buffer,n.iv.buffer).catch(t=>{throw i.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.FRAG_DECRYPT_ERROR,fatal:!1,error:t,reason:t.message,frag:e}),t}).then(r=>{let n=self.performance.now();return i.trigger(E.FRAG_DECRYPTED,{frag:e,payload:r,stats:{tstart:a,tdecrypt:n}}),t.payload=r,t})}return t}).then(i=>{let{fragCurrent:r,hls:n,levels:a}=this;if(!a)throw Error("init load aborted, missing levels");let s=e.stats;this.state=tG.IDLE,t.fragmentError=0,e.data=new Uint8Array(i.payload),s.parsing.start=s.buffering.start=self.performance.now(),s.parsing.end=s.buffering.end=self.performance.now(),i.frag===r&&n.trigger(E.FRAG_BUFFERED,{stats:s,frag:r,part:null,id:e.type}),this.tick()}).catch(t=>{this.state!==tG.STOPPED&&this.state!==tG.ERROR&&(this.warn(t),this.resetFragmentLoading(e))})}fragContextChanged(e){let{fragCurrent:t}=this;return!e||!t||e.level!==t.level||e.sn!==t.sn||e.urlId!==t.urlId}fragBufferedComplete(e,t){var i,r,n,a;let s=this.mediaBuffer?this.mediaBuffer:this.media;this.log(`Buffered ${e.type} sn: ${e.sn}${t?" part: "+t.index:""} of ${this.playlistType===eq.MAIN?"level":"track"} ${e.level} (frag:[${(null!=(i=e.startPTS)?i:NaN).toFixed(3)}-${(null!=(r=e.endPTS)?r:NaN).toFixed(3)}] > buffer:${s?tH.toString(tk.getBuffered(s)):"(detached)"})`),this.state=tG.IDLE,s&&(!this.loadedmetadata&&e.type==eq.MAIN&&s.buffered.length&&(null==(n=this.fragCurrent)?void 0:n.sn)===(null==(a=this.fragPrevious)?void 0:a.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())}seekToStartPos(){}_handleFragmentLoadComplete(e){let{transmuxer:t}=this;if(!t)return;let{frag:i,part:r,partsLoaded:n}=e,a=!n||0===n.length||n.some(e=>!e),s=new tD(i.level,i.sn,i.stats.chunkCount+1,0,r?r.index:-1,!a);t.flush(s)}_handleFragmentLoadProgress(e){}_doFragLoad(e,t,i=null,r){var n;let a;let s=null==t?void 0:t.details;if(!this.levels||!s)throw Error(`frag load aborted, missing level${s?"":" detail"}s`);let o=null;if(e.encrypted&&!(null!=(n=e.decryptdata)&&n.key)?(this.log(`Loading key for ${e.sn} of [${s.startSN}-${s.endSN}], ${"[stream-controller]"===this.logPrefix?"level":"track"} ${e.level}`),this.state=tG.KEY_LOADING,this.fragCurrent=e,o=this.keyLoader.load(e).then(e=>{if(!this.fragContextChanged(e.frag))return this.hls.trigger(E.KEY_LOADED,e),this.state===tG.KEY_LOADING&&(this.state=tG.IDLE),e}),this.hls.trigger(E.KEY_LOADING,{frag:e}),null===this.fragCurrent&&(o=Promise.reject(Error("frag load aborted, context changed in KEY_LOADING")))):!e.encrypted&&s.encryptedFragments.length&&this.keyLoader.loadClear(e,s.encryptedFragments),i=Math.max(e.start,i||0),this.config.lowLatencyMode&&"initSegment"!==e.sn){let n=s.partList;if(n&&r){i>e.end&&s.fragmentHint&&(e=s.fragmentHint);let a=this.getNextPart(n,e,i);if(a>-1){let l;let u=n[a];return(this.log(`Loading part sn: ${e.sn} p: ${u.index} cc: ${e.cc} of playlist [${s.startSN}-${s.endSN}] parts [0-${a}-${n.length-1}] ${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),this.nextLoadPosition=u.start+u.duration,this.state=tG.FRAG_LOADING,l=o?o.then(i=>!i||this.fragContextChanged(i.frag)?null:this.doFragPartsLoad(e,u,t,r)).catch(e=>this.handleFragLoadError(e)):this.doFragPartsLoad(e,u,t,r).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(E.FRAG_LOADING,{frag:e,part:u,targetBufferTime:i}),null===this.fragCurrent)?Promise.reject(Error("frag load aborted, context changed in FRAG_LOADING parts")):l}if(!e.url||this.loadedEndOfParts(n,i))return Promise.resolve(null)}}this.log(`Loading fragment ${e.sn} cc: ${e.cc} ${s?"of ["+s.startSN+"-"+s.endSN+"] ":""}${"[stream-controller]"===this.logPrefix?"level":"track"}: ${e.level}, target: ${parseFloat(i.toFixed(3))}`),_(e.sn)&&!this.bitrateTest&&(this.nextLoadPosition=e.start+e.duration),this.state=tG.FRAG_LOADING;let l=this.config.progressive;return(a=l&&o?o.then(t=>!t||this.fragContextChanged(null==t?void 0:t.frag)?null:this.fragmentLoader.load(e,r)).catch(e=>this.handleFragLoadError(e)):Promise.all([this.fragmentLoader.load(e,l?r:void 0),o]).then(([e])=>(!l&&e&&r&&r(e),e)).catch(e=>this.handleFragLoadError(e)),this.hls.trigger(E.FRAG_LOADING,{frag:e,targetBufferTime:i}),null===this.fragCurrent)?Promise.reject(Error("frag load aborted, context changed in FRAG_LOADING")):a}doFragPartsLoad(e,t,i,r){return new Promise((n,a)=>{var s;let o=[],l=null==(s=i.details)?void 0:s.partList,u=t=>{this.fragmentLoader.loadPart(e,t,r).then(r=>{o[t.index]=r;let a=r.part;this.hls.trigger(E.FRAG_LOADED,r);let s=ta(i,e.sn,t.index+1)||ts(l,e.sn,t.index+1);if(!s)return n({frag:e,part:a,partsLoaded:o});u(s)}).catch(a)};u(t)})}handleFragLoadError(e){if("data"in e){let t=e.data;e.data&&t.details===x.INTERNAL_ABORTED?this.handleFragLoadAborted(t.frag,t.part):this.hls.trigger(E.ERROR,t)}else this.hls.trigger(E.ERROR,{type:S.OTHER_ERROR,details:x.INTERNAL_EXCEPTION,err:e,error:e,fatal:!0});return null}_handleTransmuxerFlush(e){let t=this.getCurrentContext(e);if(!t||this.state!==tG.PARSING){this.fragCurrent||this.state===tG.STOPPED||this.state===tG.ERROR||(this.state=tG.IDLE);return}let{frag:i,part:r,level:n}=t,a=self.performance.now();i.stats.parsing.end=a,r&&(r.stats.parsing.end=a),this.updateLevelTiming(i,r,n,e.partial)}getCurrentContext(e){let{levels:t,fragCurrent:i}=this,{level:r,sn:n,part:a}=e;if(!(null!=t&&t[r]))return this.warn(`Levels object was unset while buffering fragment ${n} of level ${r}. The current chunk will not be buffered.`),null;let s=t[r],o=a>-1?ta(s,n,a):null,l=o?o.fragment:function(e,t,i){if(!(null!=e&&e.details))return null;let r=e.details,n=r.fragments[t-r.startSN];return n||(n=r.fragmentHint)&&n.sn===t?n:t<r.startSN&&i&&i.sn===t?i:null}(s,n,i);return l?(i&&i!==l&&(l.stats=i.stats),{frag:l,part:o,level:s}):null}bufferFragmentData(e,t,i,r,n){var a;if(!e||this.state!==tG.PARSING)return;let{data1:s,data2:o}=e,l=s;if(s&&o&&(l=e_(s,o)),!(null!=(a=l)&&a.length))return;let u={type:e.type,frag:t,part:i,chunkMeta:r,parent:t.type,data:l};if(this.hls.trigger(E.BUFFER_APPENDING,u),e.dropped&&e.independent&&!i){if(n)return;this.flushBufferGap(t)}}flushBufferGap(e){let t=this.media;if(!t)return;if(!tk.isBuffered(t,t.currentTime)){this.flushMainBuffer(0,e.start);return}let i=t.currentTime,r=tk.bufferInfo(t,i,0),n=e.duration,a=Math.min(2*this.config.maxFragLookUpTolerance,.25*n),s=Math.max(Math.min(e.start-a,r.end-a),i+a);e.start-s>a&&this.flushMainBuffer(s,e.start)}getFwdBufferInfo(e,t){let i=this.getLoadPosition();return _(i)?this.getFwdBufferInfoAtPos(e,i,t):null}getFwdBufferInfoAtPos(e,t,i){let{config:{maxBufferHole:r}}=this,n=tk.bufferInfo(e,t,r);if(0===n.len&&void 0!==n.nextStart){let a=this.fragmentTracker.getBufferedFrag(t,i);if(a&&n.nextStart<a.end)return tk.bufferInfo(e,t,Math.max(n.nextStart,r))}return n}getMaxBufferLength(e){let{config:t}=this;return Math.min(e?Math.max(8*t.maxBufferSize/e,t.maxBufferLength):t.maxBufferLength,t.maxMaxBufferLength)}reduceMaxBufferLength(e){let t=this.config,i=e||t.maxBufferLength;return t.maxMaxBufferLength>=i&&(t.maxMaxBufferLength/=2,this.warn(`Reduce max buffer length to ${t.maxMaxBufferLength}s`),!0)}getAppendedFrag(e,t=eq.MAIN){let i=this.fragmentTracker.getAppendedFrag(e,eq.MAIN);return i&&"fragment"in i?i.fragment:i}getNextFragment(e,t){let i;let r=t.fragments,n=r.length;if(!n)return null;let{config:a}=this,s=r[0].start;if(t.live){let s=a.initialLiveManifestSize;if(n<s)return this.warn(`Not enough fragments to start playback (have: ${n}, need: ${s})`),null;t.PTSKnown||this.startFragRequested||-1!==this.startPosition||(i=this.getInitialLiveFragment(t,r),this.startPosition=i?this.hls.liveSyncPosition||i.start:e)}else e<=s&&(i=r[0]);if(!i){let r=a.lowLatencyMode?t.partEnd:t.fragmentEnd;i=this.getFragmentAtPosition(e,r,t)}return this.mapToInitFragWhenRequired(i)}isLoopLoading(e,t){let i=this.fragmentTracker.getState(e);return(i===tE.OK||i===tE.PARTIAL&&!!e.gap)&&this.nextLoadPosition>t}getNextFragmentLoopLoading(e,t,i,r,n){let a=e.gap,s=this.getNextFragment(this.nextLoadPosition,t);if(null===s)return s;if(e=s,a&&e&&!e.gap&&i.nextStart){let t=this.getFwdBufferInfoAtPos(this.mediaBuffer?this.mediaBuffer:this.media,i.nextStart,r);if(null!==t&&i.len+t.len>=n)return this.log(`buffer full after gaps in "${r}" playlist starting at sn: ${e.sn}`),null}return e}mapToInitFragWhenRequired(e){return null==e||!e.initSegment||null!=e&&e.initSegment.data||this.bitrateTest?e:e.initSegment}getNextPart(e,t,i){let r=-1,n=!1,a=!0;for(let s=0,o=e.length;s<o;s++){let o=e[s];if(a=a&&!o.independent,r>-1&&i<o.start)break;let l=o.loaded;l?r=-1:(n||o.independent||a)&&o.fragment===t&&(r=s),n=l}return r}loadedEndOfParts(e,t){let i=e[e.length-1];return i&&t>i.start&&i.loaded}getInitialLiveFragment(e,t){let i=this.fragPrevious,r=null;if(i){if(e.hasProgramDateTime&&(this.log(`Live playlist, switching playlist, load frag with same PDT: ${i.programDateTime}`),r=function(e,t,i){if(null===t||!Array.isArray(e)||!e.length||!_(t))return null;let r=e[0].programDateTime;if(t<(r||0))return null;let n=e[e.length-1].endProgramDateTime;if(t>=(n||0))return null;i=i||0;for(let r=0;r<e.length;++r){let n=e[r];if(function(e,t,i){let r=1e3*Math.min(t,i.duration+(i.deltaPTS?i.deltaPTS:0)),n=i.endProgramDateTime||0;return n-r>e}(t,i,n))return n}return null}(t,i.endProgramDateTime,this.config.maxFragLookUpTolerance)),!r){let a=i.sn+1;if(a>=e.startSN&&a<=e.endSN){let n=t[a-e.startSN];i.cc===n.cc&&(r=n,this.log(`Live playlist, switching playlist, load frag with next SN: ${r.sn}`))}if(!r){var n;n=i.cc,(r=th.search(t,e=>e.cc<n?1:e.cc>n?-1:0))&&this.log(`Live playlist, switching playlist, load frag with same CC: ${r.sn}`)}}}else{let t=this.hls.liveSyncPosition;null!==t&&(r=this.getFragmentAtPosition(t,this.bitrateTest?e.fragmentEnd:e.edge,e))}return r}getFragmentAtPosition(e,t,i){let r;let{config:n}=this,{fragPrevious:a}=this,{fragments:s,endSN:o}=i,{fragmentHint:l}=i,u=n.maxFragLookUpTolerance,c=i.partList,d=!!(n.lowLatencyMode&&null!=c&&c.length&&l);if(d&&l&&!this.bitrateTest&&(s=s.concat(l),o=l.sn),e<t){let i=e>t-u?0:u;r=tf(a,s,e,i)}else r=s[s.length-1];if(r){let e=r.sn-i.startSN,t=this.fragmentTracker.getState(r);if((t===tE.OK||t===tE.PARTIAL&&r.gap)&&(a=r),a&&r.sn===a.sn&&(!d||c[0].fragment.sn>r.sn)){let t=a&&r.level===a.level;if(t){let t=s[e+1];r=r.sn<o&&this.fragmentTracker.getState(t)!==tE.OK?t:null}}}return r}synchronizeToLiveEdge(e){let{config:t,media:i}=this;if(!i)return;let r=this.hls.liveSyncPosition,n=i.currentTime,a=e.fragments[0].start,s=e.edge,o=n>=a-t.maxFragLookUpTolerance&&n<=s;if(null!==r&&i.duration>r&&(n<r||!o)){let a=void 0!==t.liveMaxLatencyDuration?t.liveMaxLatencyDuration:t.liveMaxLatencyDurationCount*e.targetduration;(!o&&i.readyState<4||n<s-a)&&(this.loadedmetadata||(this.nextLoadPosition=r),i.readyState&&(this.warn(`Playback: ${n.toFixed(3)} is located too far from the end of live sliding playlist: ${s}, reset currentTime to : ${r.toFixed(3)}`),i.currentTime=r))}}alignPlaylists(e,t){let{levels:i,levelLastLoaded:r,fragPrevious:n}=this,a=null!==r?i[r]:null,s=e.fragments.length;if(!s)return this.warn("No fragments in live playlist"),0;let o=e.fragments[0].start,l=!t,u=e.alignedSliding&&_(o);if(l||!u&&!o){a&&(function(e,t,i){if(i.details&&(t.endCC>t.startCC||e&&e.cc<t.startCC)){let e=function(e,t,i=0){let r=e.fragments,n=t.fragments;if(!n.length||!r.length){M.log("No fragments to align");return}let a=tO(r,n[0].cc);if(!a||a&&!a.startPTS){M.log("No frag in previous level to align on");return}return a}(i.details,t);e&&_(e.start)&&(M.log(`Adjusting PTS using last level due to CC increase within current level ${t.url}`),tU(e.start,t))}}(n,e,a),!e.alignedSliding&&a.details&&function(e,t){if(!t.fragments.length||!e.hasProgramDateTime||!t.hasProgramDateTime)return;let i=t.fragments[0].programDateTime,r=e.fragments[0].programDateTime,n=(r-i)/1e3+t.fragments[0].start;n&&_(n)&&(M.log(`Adjusting PTS using programDateTime delta ${r-i}ms, sliding:${n.toFixed(3)} ${e.url} `),tU(n,e))}(e,a.details),e.alignedSliding||!a.details||e.skippedSegments||tr(a.details,e));let i=e.fragments[0].start;return this.log(`Live playlist sliding: ${i.toFixed(2)} start-sn: ${t?t.startSN:"na"}->${e.startSN} prev-sn: ${n?n.sn:"na"} fragments: ${s}`),i}return o}waitForCdnTuneIn(e){return e.live&&e.canBlockReload&&e.partTarget&&e.tuneInGoal>Math.max(e.partHoldBack,3*e.partTarget)}setStartPosition(e,t){let i=this.startPosition;if(i<t&&(i=-1),-1===i||-1===this.lastCurrentTime){let r=null!==this.startTimeOffset,n=r?this.startTimeOffset:e.startTimeOffset;null!==n&&_(n)?(i=t+n,n<0&&(i+=e.totalduration),i=Math.min(Math.max(t,i),t+e.totalduration),this.log(`Start time offset ${n} found in ${r?"multivariant":"media"} playlist, adjust startPosition to ${i}`),this.startPosition=i):e.live?i=this.hls.liveSyncPosition||t:this.startPosition=i=0,this.lastCurrentTime=i}this.nextLoadPosition=i}getLoadPosition(){let{media:e}=this,t=0;return this.loadedmetadata&&e?t=e.currentTime:this.nextLoadPosition&&(t=this.nextLoadPosition),t}handleFragLoadAborted(e,t){this.transmuxer&&"initSegment"!==e.sn&&e.stats.aborted&&(this.warn(`Fragment ${e.sn}${t?" part "+t.index:""} of level ${e.level} was aborted`),this.resetFragmentLoading(e))}resetFragmentLoading(e){this.fragCurrent&&(this.fragContextChanged(e)||this.state===tG.FRAG_LOADING_WAITING_RETRY)||(this.state=tG.IDLE)}onFragmentOrKeyLoadError(e,t){var i,r;if(t.chunkMeta&&!t.frag){let e=this.getCurrentContext(t.chunkMeta);e&&(t.frag=e.frag)}let n=t.frag;if(!n||n.type!==e||!this.levels)return;if(this.fragContextChanged(n)){this.warn(`Frag load error must match current frag to retry ${n.url} > ${null==(i=this.fragCurrent)?void 0:i.url}`);return}let a=t.details===x.FRAG_GAP;a&&this.fragmentTracker.fragBuffered(n,!0);let s=t.errorAction,{action:o,retryCount:l=0,retryConfig:u}=s||{};if(s&&o===tm.RetryRequest&&u){this.resetStartWhenNotLoaded(null!=(r=this.levelLastLoaded)?r:n.level);let i=tu(u,l);this.warn(`Fragment ${n.sn} of ${e} ${n.level} errored with ${t.details}, retrying loading ${l+1}/${u.maxNumRetry} in ${i}ms`),s.resolved=!0,this.retryDate=self.performance.now()+i,this.state=tG.FRAG_LOADING_WAITING_RETRY}else u&&s?(this.resetFragmentErrors(e),l<u.maxNumRetry?a||(s.resolved=!0):M.warn(`${t.details} reached or exceeded max retry (${l})`)):(null==s?void 0:s.action)===tm.SendAlternateToPenaltyBox?this.state=tG.WAITING_LEVEL:this.state=tG.ERROR;this.tickImmediate()}reduceLengthAndFlushBuffer(e){if(this.state===tG.PARSING||this.state===tG.PARSED){let t=e.parent,i=this.getFwdBufferInfo(this.mediaBuffer,t),r=i&&i.len>.5;r&&this.reduceMaxBufferLength(i.len);let n=!r;return n&&this.warn(`Buffer full error while media.currentTime is not buffered, flush ${t} buffer`),e.frag&&(this.fragmentTracker.removeFragment(e.frag),this.nextLoadPosition=e.frag.start),this.resetLoadingState(),n}return!1}resetFragmentErrors(e){e===eq.AUDIO&&(this.fragCurrent=null),this.loadedmetadata||(this.startFragRequested=!1),this.state!==tG.STOPPED&&(this.state=tG.IDLE)}afterBufferFlushed(e,t,i){if(!e)return;let r=tk.getBuffered(e);this.fragmentTracker.detectEvictedFragments(t,r,i),this.state===tG.ENDED&&this.resetLoadingState()}resetLoadingState(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=tG.IDLE}resetStartWhenNotLoaded(e){if(!this.loadedmetadata){this.startFragRequested=!1;let t=this.levels?this.levels[e].details:null;null!=t&&t.live?(this.startPosition=-1,this.setStartPosition(t,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}}resetWhenMissingContext(e){var t;this.warn(`The loading context changed while buffering fragment ${e.sn} of level ${e.level}. This chunk will not be buffered.`),this.removeUnbufferedFrags(),this.resetStartWhenNotLoaded(null!=(t=this.levelLastLoaded)?t:e.level),this.resetLoadingState()}removeUnbufferedFrags(e=0){this.fragmentTracker.removeFragmentsInRange(e,1/0,this.playlistType,!1,!0)}updateLevelTiming(e,t,i,r){var n;let a=i.details;if(!a){this.warn("level.details undefined");return}let s=Object.keys(e.elementaryStreams).reduce((t,n)=>{let s=e.elementaryStreams[n];if(s){let o=s.endPTS-s.startPTS;if(o<=0)return this.warn(`Could not parse fragment ${e.sn} ${n} duration reliably (${o})`),t||!1;let l=r?0:ti(a,e,s.startPTS,s.endPTS,s.startDTS,s.endDTS);return this.hls.trigger(E.LEVEL_PTS_UPDATED,{details:a,level:i,drift:l,type:n,frag:e,start:s.startPTS,end:s.endPTS}),!0}return t},!1);if(s)i.fragmentError=0;else if((null==(n=this.transmuxer)?void 0:n.error)===null){let t=Error(`Found no media in fragment ${e.sn} of level ${e.level} resetting transmuxer to fallback to playlist timing`);if(0===i.fragmentError&&(i.fragmentError++,e.gap=!0,this.fragmentTracker.removeFragment(e),this.fragmentTracker.fragBuffered(e,!0)),this.warn(t.message),this.hls.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.FRAG_PARSING_ERROR,fatal:!1,error:t,frag:e,reason:`Found no media in msn ${e.sn} of level "${i.url}"`}),!this.hls)return;this.resetTransmuxer()}this.state=tG.PARSED,this.hls.trigger(E.FRAG_PARSED,{frag:e,part:t})}resetTransmuxer(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)}recoverWorkerError(e){if("demuxerWorker"===e.event){var t,i,r;this.fragmentTracker.removeAllFragments(),this.resetTransmuxer(),this.resetStartWhenNotLoaded(null!=(t=null!=(i=this.levelLastLoaded)?i:null==(r=this.fragCurrent)?void 0:r.level)?t:0),this.resetLoadingState()}}set state(e){let t=this._state;t!==e&&(this._state=e,this.log(`${t}->${e}`))}get state(){return this._state}}function t$(){return self.SourceBuffer||self.WebKitSourceBuffer}function tq(e="",t=9e4){return{type:e,id:-1,pid:-1,inputTimeScale:t,sequenceNumber:-1,samples:[],dropped:0}}class tY{constructor(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}resetInitSegment(e,t,i,r){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}}resetTimeStamp(e){this.initPTS=e,this.resetContiguity()}resetContiguity(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0}canParse(e,t){return!1}appendFrame(e,t,i){}demux(e,t){let i;this.cachedData&&(e=e_(this.cachedData,e),this.cachedData=null);let r=X(e,0),n=r?r.length:0,a=this._audioTrack,s=this._id3Track,o=r?Q(r):void 0,l=e.length;for((null===this.basePTS||0===this.frameIndex&&_(o))&&(this.basePTS=tK(o,t,this.initPTS),this.lastPTS=this.basePTS),null===this.lastPTS&&(this.lastPTS=this.basePTS),r&&r.length>0&&s.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:e1.audioId3,duration:Number.POSITIVE_INFINITY});n<l;){if(this.canParse(e,n)){let t=this.appendFrame(a,e,n);t?(this.frameIndex++,this.lastPTS=t.sample.pts,n+=t.length,i=n):n=l}else J(e,n)?(r=X(e,n),s.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:r,type:e1.audioId3,duration:Number.POSITIVE_INFINITY}),n+=r.length,i=n):n++;if(n===l&&i!==l){let t=q(e,i);this.cachedData?this.cachedData=e_(this.cachedData,t):this.cachedData=t}}return{audioTrack:a,videoTrack:tq(),id3Track:s,textTrack:tq()}}demuxSampleAes(e,t,i){return Promise.reject(Error(`[${this}] This demuxer does not support Sample-AES decryption`))}flush(e){let t=this.cachedData;return t&&(this.cachedData=null,this.demux(t,0)),{audioTrack:this._audioTrack,videoTrack:tq(),id3Track:this._id3Track,textTrack:tq()}}destroy(){}}let tK=(e,t,i)=>{if(_(e))return 90*e;let r=i?9e4*i.baseTime/i.timescale:0;return 9e4*t+r};function tX(e,t){return 255===e[t]&&(246&e[t+1])==240}function tZ(e,t){return 1&e[t+1]?7:9}function tJ(e,t){return(3&e[t+3])<<11|e[t+4]<<3|(224&e[t+5])>>>5}function tQ(e,t){return t+1<e.length&&tX(e,t)}function t0(e,t,i,r,n){if(!e.samplerate){let a=function(e,t,i,r){let n,a,s,o;let l=navigator.userAgent.toLowerCase(),u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];n=((192&t[i+2])>>>6)+1;let c=(60&t[i+2])>>>2;if(c>u.length-1){e.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.FRAG_PARSING_ERROR,fatal:!0,reason:`invalid ADTS sampling index:${c}`});return}return s=(1&t[i+2])<<2|(192&t[i+3])>>>6,M.log(`manifest codec:${r}, ADTS type:${n}, samplingIndex:${c}`),/firefox/i.test(l)?c>=6?(n=5,o=[,,,,],a=c-3):(n=2,o=[,,],a=c):-1!==l.indexOf("android")?(n=2,o=[,,],a=c):(n=5,o=[,,,,],r&&(-1!==r.indexOf("mp4a.40.29")||-1!==r.indexOf("mp4a.40.5"))||!r&&c>=6?a=c-3:((r&&-1!==r.indexOf("mp4a.40.2")&&(c>=6&&1===s||/vivaldi/i.test(l))||!r&&1===s)&&(n=2,o=[,,]),a=c)),o[0]=n<<3,o[0]|=(14&c)>>1,o[1]|=(1&c)<<7,o[1]|=s<<3,5===n&&(o[1]|=(14&a)>>1,o[2]=(1&a)<<7,o[2]|=8,o[3]=0),{config:o,samplerate:u[c],channelCount:s,codec:"mp4a.40."+n,manifestCodec:r}}(t,i,r,n);a&&(e.config=a.config,e.samplerate=a.samplerate,e.channelCount=a.channelCount,e.codec=a.codec,e.manifestCodec=a.manifestCodec,M.log(`parsed codec:${e.codec}, rate:${a.samplerate}, channels:${a.channelCount}`))}}function t1(e,t,i,r,n){let a;let s=9216e4/e.samplerate,o=r+n*s,l=function(e,t){let i=tZ(e,t);if(t+i<=e.length){let r=tJ(e,t)-i;if(r>0)return{headerLength:i,frameLength:r}}}(t,i);if(l){let{frameLength:r,headerLength:n}=l,s=n+r,u=Math.max(0,i+s-t.length);u?(a=new Uint8Array(s-n)).set(t.subarray(i+n,t.length),0):a=t.subarray(i+n,i+s);let c={unit:a,pts:o};return u||e.samples.push(c),{sample:c,length:s,missing:u}}let u=t.length-i;(a=new Uint8Array(u)).set(t.subarray(i,t.length),0);let c={unit:a,pts:o};return{sample:c,length:u,missing:-1}}let t2=/\/emsg[-/]ID3/i,t3=null,t5=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],t4=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],t6=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],t8=[0,1,1,4];function t7(e,t,i,r,n){if(i+24>t.length)return;let a=t9(t,i);if(a&&i+a.frameLength<=t.length){let s=9e4*a.samplesPerFrame/a.sampleRate,o=r+n*s,l={unit:t.subarray(i,i+a.frameLength),pts:o,dts:o};return e.config=[],e.channelCount=a.channelCount,e.samplerate=a.sampleRate,e.samples.push(l),{sample:l,length:a.frameLength,missing:0}}}function t9(e,t){let i=e[t+1]>>3&3,r=e[t+1]>>1&3,n=e[t+2]>>4&15,a=e[t+2]>>2&3;if(1!==i&&0!==n&&15!==n&&3!==a){let s=e[t+2]>>1&1,o=e[t+3]>>6,l=1e3*t5[14*(3===i?3-r:3===r?3:4)+n-1],u=t4[3*(3===i?0:2===i?1:2)+a],c=t6[i][r],d=t8[r];if(null===t3){let e=navigator.userAgent||"",t=e.match(/Chrome\/(\d+)/i);t3=t?parseInt(t[1]):0}let h=!!t3&&t3<=87;return h&&2===r&&l>=224e3&&0===o&&(e[t+3]=128|e[t+3]),{sampleRate:u,channelCount:3===o?1:2,frameLength:Math.floor(c*l/u+s)*d,samplesPerFrame:8*c*d}}}function ie(e,t){return 255===e[t]&&(224&e[t+1])==224&&(6&e[t+1])!=0}function it(e,t){return t+1<e.length&&ie(e,t)}class ii{constructor(e){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=e,this.bytesAvailable=e.byteLength,this.word=0,this.bitsAvailable=0}loadWord(){let e=this.data,t=this.bytesAvailable,i=e.byteLength-t,r=new Uint8Array(4),n=Math.min(4,t);if(0===n)throw Error("no bytes available");r.set(e.subarray(i,i+n)),this.word=new DataView(r.buffer).getUint32(0),this.bitsAvailable=8*n,this.bytesAvailable-=n}skipBits(e){let t;e=Math.min(e,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>e||(e-=this.bitsAvailable,t=e>>3,e-=t<<3,this.bytesAvailable-=t,this.loadWord()),this.word<<=e,this.bitsAvailable-=e}readBits(e){let t=Math.min(this.bitsAvailable,e),i=this.word>>>32-t;if(e>32&&M.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,this.bitsAvailable>0)this.word<<=t;else if(this.bytesAvailable>0)this.loadWord();else throw Error("no bits available");return(t=e-t)>0&&this.bitsAvailable?i<<t|this.readBits(t):i}skipLZ(){let e;for(e=0;e<this.bitsAvailable;++e)if((this.word&2147483648>>>e)!=0)return this.word<<=e,this.bitsAvailable-=e,e;return this.loadWord(),e+this.skipLZ()}skipUEG(){this.skipBits(1+this.skipLZ())}skipEG(){this.skipBits(1+this.skipLZ())}readUEG(){let e=this.skipLZ();return this.readBits(e+1)-1}readEG(){let e=this.readUEG();return 1&e?1+e>>>1:-1*(e>>>1)}readBoolean(){return 1===this.readBits(1)}readUByte(){return this.readBits(8)}readUShort(){return this.readBits(16)}readUInt(){return this.readBits(32)}skipScalingList(e){let t=8,i=8;for(let r=0;r<e;r++)0!==i&&(i=(t+this.readEG()+256)%256),t=0===i?t:i}readSPS(){let e,t,i,r=0,n=0,a=0,s=0,o=this.readUByte.bind(this),l=this.readBits.bind(this),u=this.readUEG.bind(this),c=this.readBoolean.bind(this),d=this.skipBits.bind(this),h=this.skipEG.bind(this),f=this.skipUEG.bind(this),p=this.skipScalingList.bind(this);o();let m=o();if(l(5),d(3),o(),f(),100===m||110===m||122===m||244===m||44===m||83===m||86===m||118===m||128===m){let e=u();if(3===e&&d(1),f(),f(),d(1),c())for(i=0,t=3!==e?8:12;i<t;i++)c()&&p(i<6?16:64)}f();let g=u();if(0===g)u();else if(1===g)for(d(1),h(),h(),e=u(),i=0;i<e;i++)h();f(),d(1);let v=u(),y=u(),b=l(1);0===b&&d(1),d(1),c()&&(r=u(),n=u(),a=u(),s=u());let _=[1,1];if(c()&&c()){let e=o();switch(e){case 1:_=[1,1];break;case 2:_=[12,11];break;case 3:_=[10,11];break;case 4:_=[16,11];break;case 5:_=[40,33];break;case 6:_=[24,11];break;case 7:_=[20,11];break;case 8:_=[32,11];break;case 9:_=[80,33];break;case 10:_=[18,11];break;case 11:_=[15,11];break;case 12:_=[64,33];break;case 13:_=[160,99];break;case 14:_=[4,3];break;case 15:_=[3,2];break;case 16:_=[2,1];break;case 255:_=[o()<<8|o(),o()<<8|o()]}}return{width:Math.ceil((v+1)*16-2*r-2*n),height:(2-b)*(y+1)*16-(b?2:4)*(a+s),pixelRatio:_}}readSliceType(){return this.readUByte(),this.readUEG(),this.readUEG()}}class ir{constructor(e,t,i){this.keyData=void 0,this.decrypter=void 0,this.keyData=i,this.decrypter=new tj(t,{removePKCS7Padding:!1})}decryptBuffer(e){return this.decrypter.decrypt(e,this.keyData.key.buffer,this.keyData.iv.buffer)}decryptAacSample(e,t,i){let r=e[t].unit;if(r.length<=16)return;let n=r.subarray(16,r.length-r.length%16),a=n.buffer.slice(n.byteOffset,n.byteOffset+n.length);this.decryptBuffer(a).then(n=>{let a=new Uint8Array(n);r.set(a,16),this.decrypter.isSync()||this.decryptAacSamples(e,t+1,i)})}decryptAacSamples(e,t,i){for(;;t++){if(t>=e.length){i();return}if(!(e[t].unit.length<32)&&(this.decryptAacSample(e,t,i),!this.decrypter.isSync()))return}}getAvcEncryptedData(e){let t=16*Math.floor((e.length-48)/160)+16,i=new Int8Array(t),r=0;for(let t=32;t<e.length-16;t+=160,r+=16)i.set(e.subarray(t,t+16),r);return i}getAvcDecryptedUnit(e,t){let i=new Uint8Array(t),r=0;for(let t=32;t<e.length-16;t+=160,r+=16)e.set(i.subarray(r,r+16),t);return e}decryptAvcSample(e,t,i,r,n){let a=ex(n.data),s=this.getAvcEncryptedData(a);this.decryptBuffer(s.buffer).then(s=>{n.data=this.getAvcDecryptedUnit(a,s),this.decrypter.isSync()||this.decryptAvcSamples(e,t,i+1,r)})}decryptAvcSamples(e,t,i,r){if(e instanceof Uint8Array)throw Error("Cannot decrypt samples of type Uint8Array");for(;;t++,i=0){if(t>=e.length){r();return}let n=e[t].units;for(;!(i>=n.length);i++){let a=n[i];if(!(a.data.length<=48)&&(1===a.type||5===a.type)&&(this.decryptAvcSample(e,t,i,r,a),!this.decrypter.isSync()))return}}}}class ia{constructor(e,t,i){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=e,this.config=t,this.typeSupported=i}static probe(e){let t=ia.syncOffset(e);return t>0&&M.warn(`MPEG2-TS detected but first sync word found @ offset ${t}`),-1!==t}static syncOffset(e){let t=e.length,i=Math.min(940,e.length-188)+1,r=0;for(;r<i;){let n=!1,a=-1,s=0;for(let o=r;o<t;o+=188)if(71===e[o]){if(s++,-1===a&&0!==(a=o)&&(i=Math.min(a+18612,e.length-188)+1),n||(n=0===io(e,o)),n&&s>1&&(0===a&&s>2||o+188>i))return a}else if(s)return -1;else break;r++}return -1}static createTrack(e,t){return{container:"video"===e||"audio"===e?"video/mp2t":void 0,type:e,id:ed[e],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:"audio"===e?t:void 0}}resetInitSegment(e,t,i,r){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=ia.createTrack("video"),this._audioTrack=ia.createTrack("audio",r),this._id3Track=ia.createTrack("id3"),this._txtTrack=ia.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=t,this.videoCodec=i,this._duration=r}resetTimeStamp(){}resetContiguity(){let{_audioTrack:e,_avcTrack:t,_id3Track:i}=this;e&&(e.pesData=null),t&&(t.pesData=null),i&&(i.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null}demux(e,t,i=!1,r=!1){let n;i||(this.sampleAes=null);let a=this._avcTrack,s=this._audioTrack,o=this._id3Track,l=this._txtTrack,u=a.pid,c=a.pesData,d=s.pid,h=o.pid,f=s.pesData,p=o.pesData,m=null,g=this.pmtParsed,v=this._pmtId,y=e.length;if(this.remainderData&&(y=(e=e_(this.remainderData,e)).length,this.remainderData=null),y<188&&!r)return this.remainderData=e,{audioTrack:s,videoTrack:a,id3Track:o,textTrack:l};let b=Math.max(0,ia.syncOffset(e));(y-=(y-b)%188)<e.byteLength&&!r&&(this.remainderData=new Uint8Array(e.buffer,y,e.buffer.byteLength-y));let _=0;for(let t=b;t<y;t+=188)if(71===e[t]){let r;let y=!!(64&e[t+1]),_=io(e,t),E=(48&e[t+3])>>4;if(E>1){if((r=t+5+e[t+4])===t+188)continue}else r=t+4;switch(_){case u:y&&(c&&(n=il(c))&&this.parseAVCPES(a,l,n,!1),c={data:[],size:0}),c&&(c.data.push(e.subarray(r,t+188)),c.size+=t+188-r);break;case d:if(y){if(f&&(n=il(f)))switch(s.segmentCodec){case"aac":this.parseAACPES(s,n);break;case"mp3":this.parseMPEGPES(s,n)}f={data:[],size:0}}f&&(f.data.push(e.subarray(r,t+188)),f.size+=t+188-r);break;case h:y&&(p&&(n=il(p))&&this.parseID3PES(o,n),p={data:[],size:0}),p&&(p.data.push(e.subarray(r,t+188)),p.size+=t+188-r);break;case 0:var T,w;y&&(r+=e[r]+1),v=this._pmtId=(31&(T=e)[(w=r)+10])<<8|T[w+11];break;case v:{y&&(r+=e[r]+1);let n=function(e,t,i,r){let n={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},a=(15&e[t+1])<<8|e[t+2],s=t+3+a-4,o=(15&e[t+10])<<8|e[t+11];for(t+=12+o;t<s;){let a=io(e,t);switch(e[t]){case 207:if(!r){M.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:-1===n.audio&&(n.audio=a);break;case 21:-1===n.id3&&(n.id3=a);break;case 219:if(!r){M.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:-1===n.avc&&(n.avc=a);break;case 3:case 4:!0!==i.mpeg&&!0!==i.mp3?M.log("MPEG audio found, not supported in this browser"):-1===n.audio&&(n.audio=a,n.segmentCodec="mp3");break;case 36:M.warn("Unsupported HEVC stream type found")}t+=((15&e[t+3])<<8|e[t+4])+5}return n}(e,r,this.typeSupported,i);(u=n.avc)>0&&(a.pid=u),(d=n.audio)>0&&(s.pid=d,s.segmentCodec=n.segmentCodec),(h=n.id3)>0&&(o.pid=h),null===m||g||(M.warn(`MPEG-TS PMT found at ${t} after unknown PID '${m}'. Backtracking to sync byte @${b} to parse all TS packets.`),m=null,t=b-188),g=this.pmtParsed=!0;break}case 17:case 8191:break;default:m=_}}else _++;if(_>0){let e=Error(`Found ${_} TS packet/s that do not start with 0x47`);this.observer.emit(E.ERROR,E.ERROR,{type:S.MEDIA_ERROR,details:x.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message})}a.pesData=c,s.pesData=f,o.pesData=p;let A={audioTrack:s,videoTrack:a,id3Track:o,textTrack:l};return r&&this.extractRemainingSamples(A),A}flush(){let e;let{remainderData:t}=this;return(this.remainderData=null,e=t?this.demux(t,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(e),this.sampleAes)?this.decrypt(e,this.sampleAes):e}extractRemainingSamples(e){let t;let{audioTrack:i,videoTrack:r,id3Track:n,textTrack:a}=e,s=r.pesData,o=i.pesData,l=n.pesData;if(s&&(t=il(s))?(this.parseAVCPES(r,a,t,!0),r.pesData=null):r.pesData=s,o&&(t=il(o))){switch(i.segmentCodec){case"aac":this.parseAACPES(i,t);break;case"mp3":this.parseMPEGPES(i,t)}i.pesData=null}else null!=o&&o.size&&M.log("last AAC PES packet truncated,might overlap between fragments"),i.pesData=o;l&&(t=il(l))?(this.parseID3PES(n,t),n.pesData=null):n.pesData=l}demuxSampleAes(e,t,i){let r=this.demux(e,i,!0,!this.config.progressive),n=this.sampleAes=new ir(this.observer,this.config,t);return this.decrypt(r,n)}decrypt(e,t){return new Promise(i=>{let{audioTrack:r,videoTrack:n}=e;r.samples&&"aac"===r.segmentCodec?t.decryptAacSamples(r.samples,0,()=>{n.samples?t.decryptAvcSamples(n.samples,0,0,()=>{i(e)}):i(e)}):n.samples&&t.decryptAvcSamples(n.samples,0,0,()=>{i(e)})})}destroy(){this._duration=0}parseAVCPES(e,t,i,r){let n;let a=this.parseAVCNALu(e,i.data),s=this.avcSample,o=!1;i.data=null,s&&a.length&&!e.audFound&&(iu(s,e),s=this.avcSample=is(!1,i.pts,i.dts,"")),a.forEach(r=>{var a,l;switch(r.type){case 1:{let t=!1;n=!0;let a=r.data;if(o&&a.length>4){let e=new ii(a).readSliceType();(2===e||4===e||7===e||9===e)&&(t=!0)}t&&null!=(l=s)&&l.frame&&!s.key&&(iu(s,e),s=this.avcSample=null),s||(s=this.avcSample=is(!0,i.pts,i.dts,"")),s.frame=!0,s.key=t;break}case 5:n=!0,null!=(a=s)&&a.frame&&!s.key&&(iu(s,e),s=this.avcSample=null),s||(s=this.avcSample=is(!0,i.pts,i.dts,"")),s.key=!0,s.frame=!0;break;case 6:n=!0,eS(r.data,1,i.pts,t.samples);break;case 7:if(n=!0,o=!0,!e.sps){let t=r.data,i=new ii(t),n=i.readSPS();e.width=n.width,e.height=n.height,e.pixelRatio=n.pixelRatio,e.sps=[t],e.duration=this._duration;let a=t.subarray(1,4),s="avc1.";for(let e=0;e<3;e++){let t=a[e].toString(16);t.length<2&&(t="0"+t),s+=t}e.codec=s}break;case 8:n=!0,e.pps||(e.pps=[r.data]);break;case 9:n=!1,e.audFound=!0,s&&iu(s,e),s=this.avcSample=is(!1,i.pts,i.dts,"");break;case 12:n=!0;break;default:n=!1,s&&(s.debug+="unknown NAL "+r.type+" ")}if(s&&n){let e=s.units;e.push(r)}}),r&&s&&(iu(s,e),this.avcSample=null)}getLastNalUnit(e){var t;let i;let r=this.avcSample;if(r&&0!==r.units.length||(r=e[e.length-1]),null!=(t=r)&&t.units){let e=r.units;i=e[e.length-1]}return i}parseAVCNALu(e,t){let i,r,n;let a=t.byteLength,s=e.naluState||0,o=s,l=[],u=0,c=-1,d=0;for(-1===s&&(c=0,d=31&t[0],s=0,u=1);u<a;){if(i=t[u++],!s){s=i?0:1;continue}if(1===s){s=i?0:2;continue}if(i){if(1===i){if(c>=0){let e={data:t.subarray(c,u-s-1),type:d};l.push(e)}else{let i=this.getLastNalUnit(e.samples);if(i&&(o&&u<=4-o&&i.state&&(i.data=i.data.subarray(0,i.data.byteLength-o)),(r=u-s-1)>0)){let e=new Uint8Array(i.data.byteLength+r);e.set(i.data,0),e.set(t.subarray(0,r),i.data.byteLength),i.data=e,i.state=0}}u<a?(n=31&t[u],c=u,d=n,s=0):s=-1}else s=0}else s=3}if(c>=0&&s>=0){let e={data:t.subarray(c,a),type:d,state:s};l.push(e)}if(0===l.length){let i=this.getLastNalUnit(e.samples);if(i){let e=new Uint8Array(i.data.byteLength+t.byteLength);e.set(i.data,0),e.set(t,i.data.byteLength),i.data=e}}return e.naluState=s,l}parseAACPES(e,t){let i,r,n,a,s=0,o=this.aacOverFlow,l=t.data;if(o){this.aacOverFlow=null;let t=o.missing,i=o.sample.unit.byteLength;if(-1===t){let e=new Uint8Array(i+l.byteLength);e.set(o.sample.unit,0),e.set(l,i),l=e}else{let r=i-t;o.sample.unit.set(l.subarray(0,t),r),e.samples.push(o.sample),s=o.missing}}for(i=s,r=l.length;i<r-1&&!tQ(l,i);i++);if(i!==s){let e;let t=i<r-1;e=t?`AAC PES did not start with ADTS header,offset:${i}`:"No ADTS header found in AAC PES";let n=Error(e);if(M.warn(`parsing error: ${e}`),this.observer.emit(E.ERROR,E.ERROR,{type:S.MEDIA_ERROR,details:x.FRAG_PARSING_ERROR,fatal:!1,levelRetry:t,error:n,reason:e}),!t)return}if(t0(e,this.observer,l,i,this.audioCodec),void 0!==t.pts)n=t.pts;else if(o){let t=9216e4/e.samplerate;n=o.sample.pts+t}else{M.warn("[tsdemuxer]: AAC PES unknown PTS");return}let u=0;for(;i<r;){if(a=t1(e,l,i,n,u),i+=a.length,a.missing){this.aacOverFlow=a;break}for(u++;i<r-1&&!tQ(l,i);i++);}}parseMPEGPES(e,t){let i=t.data,r=i.length,n=0,a=0,s=t.pts;if(void 0===s){M.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;a<r;)if(it(i,a)){let t=t7(e,i,a,s,n);if(t)a+=t.length,n++;else break}else a++}parseID3PES(e,t){if(void 0===t.pts){M.warn("[tsdemuxer]: ID3 PES unknown PTS");return}let i=b({},t,{type:this._avcTrack?e1.emsg:e1.audioId3,duration:Number.POSITIVE_INFINITY});e.samples.push(i)}}function is(e,t,i,r){return{key:e,frame:!1,pts:t,dts:i,units:[],debug:r,length:0}}function io(e,t){return((31&e[t+1])<<8)+e[t+2]}function il(e){let t,i,r,n,a,s=0,o=e.data;if(!e||0===e.size)return null;for(;o[0].length<19&&o.length>1;){let e=new Uint8Array(o[0].length+o[1].length);e.set(o[0]),e.set(o[1],o[0].length),o[0]=e,o.splice(1,1)}t=o[0];let l=(t[0]<<16)+(t[1]<<8)+t[2];if(1===l){if((i=(t[4]<<8)+t[5])&&i>e.size-6)return null;let l=t[7];192&l&&(n=(14&t[9])*536870912+(255&t[10])*4194304+(254&t[11])*16384+(255&t[12])*128+(254&t[13])/2,64&l?n-(a=(14&t[14])*536870912+(255&t[15])*4194304+(254&t[16])*16384+(255&t[17])*128+(254&t[18])/2)>54e5&&(M.warn(`${Math.round((n-a)/9e4)}s delta between PTS and DTS, align them`),n=a):a=n);let u=(r=t[8])+9;if(e.size<=u)return null;e.size-=u;let c=new Uint8Array(e.size);for(let e=0,i=o.length;e<i;e++){let i=(t=o[e]).byteLength;if(u){if(u>i){u-=i;continue}t=t.subarray(u),i-=u,u=0}c.set(t,s),s+=i}return i&&(i-=r+3),{data:c,pts:n,dts:a,len:i}}return null}function iu(e,t){if(e.units.length&&e.frame){if(void 0===e.pts){let i=t.samples,r=i.length;if(r){let t=i[r-1];e.pts=t.pts,e.dts=t.dts}else{t.dropped++;return}}t.samples.push(e)}e.debug.length&&M.log(e.pts+"/"+e.dts+":"+e.debug)}class ic{static getSilentFrame(e,t){if("mp4a.40.2"===e){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);else if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);else if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t||3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}}}class id{static init(){let e;for(e in id.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},id.types)id.types.hasOwnProperty(e)&&(id.types[e]=[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3)]);let t=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);id.HDLR_TYPES={video:t,audio:i};let r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),n=new Uint8Array([0,0,0,0,0,0,0,0]);id.STTS=id.STSC=id.STCO=n,id.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),id.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),id.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),id.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);let a=new Uint8Array([105,115,111,109]),s=new Uint8Array([97,118,99,49]),o=new Uint8Array([0,0,0,1]);id.FTYP=id.box(id.types.ftyp,a,o,a,s),id.DINF=id.box(id.types.dinf,id.box(id.types.dref,r))}static box(e,...t){let i=8,r=t.length,n=r;for(;r--;)i+=t[r].byteLength;let a=new Uint8Array(i);for(a[0]=i>>24&255,a[1]=i>>16&255,a[2]=i>>8&255,a[3]=255&i,a.set(e,4),r=0,i=8;r<n;r++)a.set(t[r],i),i+=t[r].byteLength;return a}static hdlr(e){return id.box(id.types.hdlr,id.HDLR_TYPES[e])}static mdat(e){return id.box(id.types.mdat,e)}static mdhd(e,t){t*=e;let i=Math.floor(t/4294967296),r=Math.floor(t%4294967296);return id.box(id.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,r>>24,r>>16&255,r>>8&255,255&r,85,196,0,0]))}static mdia(e){return id.box(id.types.mdia,id.mdhd(e.timescale,e.duration),id.hdlr(e.type),id.minf(e))}static mfhd(e){return id.box(id.types.mfhd,new Uint8Array([0,0,0,0,e>>24,e>>16&255,e>>8&255,255&e]))}static minf(e){return"audio"===e.type?id.box(id.types.minf,id.box(id.types.smhd,id.SMHD),id.DINF,id.stbl(e)):id.box(id.types.minf,id.box(id.types.vmhd,id.VMHD),id.DINF,id.stbl(e))}static moof(e,t,i){return id.box(id.types.moof,id.mfhd(e),id.traf(i,t))}static moov(e){let t=e.length,i=[];for(;t--;)i[t]=id.trak(e[t]);return id.box.apply(null,[id.types.moov,id.mvhd(e[0].timescale,e[0].duration)].concat(i).concat(id.mvex(e)))}static mvex(e){let t=e.length,i=[];for(;t--;)i[t]=id.trex(e[t]);return id.box.apply(null,[id.types.mvex,...i])}static mvhd(e,t){t*=e;let i=Math.floor(t/4294967296),r=Math.floor(t%4294967296),n=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,e>>24&255,e>>16&255,e>>8&255,255&e,i>>24,i>>16&255,i>>8&255,255&i,r>>24,r>>16&255,r>>8&255,255&r,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return id.box(id.types.mvhd,n)}static sdtp(e){let t,i;let r=e.samples||[],n=new Uint8Array(4+r.length);for(t=0;t<r.length;t++)i=r[t].flags,n[t+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return id.box(id.types.sdtp,n)}static stbl(e){return id.box(id.types.stbl,id.stsd(e),id.box(id.types.stts,id.STTS),id.box(id.types.stsc,id.STSC),id.box(id.types.stsz,id.STSZ),id.box(id.types.stco,id.STCO))}static avc1(e){let t,i,r,n=[],a=[];for(t=0;t<e.sps.length;t++)r=(i=e.sps[t]).byteLength,n.push(r>>>8&255),n.push(255&r),n=n.concat(Array.prototype.slice.call(i));for(t=0;t<e.pps.length;t++)r=(i=e.pps[t]).byteLength,a.push(r>>>8&255),a.push(255&r),a=a.concat(Array.prototype.slice.call(i));let s=id.box(id.types.avcC,new Uint8Array([1,n[3],n[4],n[5],255,224|e.sps.length].concat(n).concat([e.pps.length]).concat(a))),o=e.width,l=e.height,u=e.pixelRatio[0],c=e.pixelRatio[1];return id.box(id.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,o>>8&255,255&o,l>>8&255,255&l,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),s,id.box(id.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),id.box(id.types.pasp,new Uint8Array([u>>24,u>>16&255,u>>8&255,255&u,c>>24,c>>16&255,c>>8&255,255&c])))}static esds(e){let t=e.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(e.config).concat([6,1,2]))}static mp4a(e){let t=e.samplerate;return id.box(id.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]),id.box(id.types.esds,id.esds(e)))}static mp3(e){let t=e.samplerate;return id.box(id.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,e.channelCount,0,16,0,0,0,0,t>>8&255,255&t,0,0]))}static stsd(e){return"audio"!==e.type?id.box(id.types.stsd,id.STSD,id.avc1(e)):"mp3"===e.segmentCodec&&"mp3"===e.codec?id.box(id.types.stsd,id.STSD,id.mp3(e)):id.box(id.types.stsd,id.STSD,id.mp4a(e))}static tkhd(e){let t=e.id,i=e.duration*e.timescale,r=e.width,n=e.height,a=Math.floor(i/4294967296),s=Math.floor(i%4294967296);return id.box(id.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,0,0,0,0,a>>24,a>>16&255,a>>8&255,255&a,s>>24,s>>16&255,s>>8&255,255&s,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,r>>8&255,255&r,0,0,n>>8&255,255&n,0,0]))}static traf(e,t){let i=id.sdtp(e),r=e.id,n=Math.floor(t/4294967296),a=Math.floor(t%4294967296);return id.box(id.types.traf,id.box(id.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),id.box(id.types.tfdt,new Uint8Array([1,0,0,0,n>>24,n>>16&255,n>>8&255,255&n,a>>24,a>>16&255,a>>8&255,255&a])),id.trun(e,i.length+16+20+8+16+8+8),i)}static trak(e){return e.duration=e.duration||4294967295,id.box(id.types.trak,id.tkhd(e),id.mdia(e))}static trex(e){let t=e.id;return id.box(id.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))}static trun(e,t){let i,r,n,a,s,o;let l=e.samples||[],u=l.length,c=12+16*u,d=new Uint8Array(c);for(t+=8+c,d.set(["video"===e.type?1:0,0,15,1,u>>>24&255,u>>>16&255,u>>>8&255,255&u,t>>>24&255,t>>>16&255,t>>>8&255,255&t],0),i=0;i<u;i++)n=(r=l[i]).duration,a=r.size,s=r.flags,o=r.cts,d.set([n>>>24&255,n>>>16&255,n>>>8&255,255&n,a>>>24&255,a>>>16&255,a>>>8&255,255&a,s.isLeading<<2|s.dependsOn,s.isDependedOn<<6|s.hasRedundancy<<4|s.paddingValue<<1|s.isNonSync,61440&s.degradPrio,15&s.degradPrio,o>>>24&255,o>>>16&255,o>>>8&255,255&o],12+16*i);return id.box(id.types.trun,d)}static initSegment(e){id.types||id.init();let t=id.moov(e),i=new Uint8Array(id.FTYP.byteLength+t.byteLength);return i.set(id.FTYP),i.set(t,id.FTYP.byteLength),i}}function ih(e,t,i=1,r=!1){let n=e*t*i;return r?Math.round(n):n}function ip(e,t=!1){return ih(e,1e3,11111111111111112e-21,t)}id.types=void 0,id.HDLR_TYPES=void 0,id.STTS=void 0,id.STSC=void 0,id.STCO=void 0,id.STSZ=void 0,id.VMHD=void 0,id.SMHD=void 0,id.STSD=void 0,id.FTYP=void 0,id.DINF=void 0;let im=null,ig=null;class iv{constructor(e,t,i,r=""){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=null,this._initDTS=null,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=e,this.config=t,this.typeSupported=i,this.ISGenerated=!1,null===im){let e=navigator.userAgent||"",t=e.match(/Chrome\/(\d+)/i);im=t?parseInt(t[1]):0}if(null===ig){let e=navigator.userAgent.match(/Safari\/(\d+)/i);ig=e?parseInt(e[1]):0}}destroy(){}resetTimeStamp(e){M.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=e}resetNextTimestamp(){M.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1}resetInitSegment(){M.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1}getVideoStartPts(e){let t=!1,i=e.reduce((e,i)=>{let r=i.pts-e;return r<-4294967296?(t=!0,iy(e,i.pts)):r>0?e:i.pts},e[0].pts);return t&&M.debug("PTS rollover detected"),i}remux(e,t,i,r,n,a,s,o){let l,u,c,d,h,f;let p=n,m=n,g=e.pid>-1,v=t.pid>-1,y=t.samples.length,b=e.samples.length>0,_=s&&y>0||y>1,E=(!g||b)&&(!v||_)||this.ISGenerated||s;if(E){let i;this.ISGenerated||(c=this.generateIS(e,t,n,a));let r=this.isVideoContiguous,s=-1;if(_&&(s=function(e){for(let t=0;t<e.length;t++)if(e[t].key)return t;return -1}(t.samples),!r&&this.config.forceKeyFrameOnDiscontinuity)){if(f=!0,s>0){M.warn(`[mp4-remuxer]: Dropped ${s} out of ${y} video samples due to a missing keyframe`);let e=this.getVideoStartPts(t.samples);t.samples=t.samples.slice(s),t.dropped+=s,m+=(t.samples[0].pts-e)/t.inputTimeScale,i=m}else -1===s&&(M.warn(`[mp4-remuxer]: No keyframe found out of ${y} video samples`),f=!1)}if(this.ISGenerated){if(b&&_){let i=this.getVideoStartPts(t.samples),r=iy(e.samples[0].pts,i)-i,n=r/t.inputTimeScale;p+=Math.max(0,n),m+=Math.max(0,-n)}if(b){if(e.samplerate||(M.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),c=this.generateIS(e,t,n,a)),u=this.remuxAudio(e,p,this.isAudioContiguous,a,v||_||o===eq.AUDIO?m:void 0),_){let i=u?u.endPTS-u.startPTS:0;t.inputTimeScale||(M.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),c=this.generateIS(e,t,n,a)),l=this.remuxVideo(t,m,r,i)}}else _&&(l=this.remuxVideo(t,m,r,0));l&&(l.firstKeyFrame=s,l.independent=-1!==s,l.firstKeyFramePTS=i)}}return this.ISGenerated&&this._initPTS&&this._initDTS&&(i.samples.length&&(h=ib(i,n,this._initPTS,this._initDTS)),r.samples.length&&(d=i_(r,n,this._initPTS))),{audio:u,video:l,initSegment:c,independent:f,text:d,id3:h}}generateIS(e,t,i,r){let n,a,s;let o=e.samples,l=t.samples,u=this.typeSupported,c={},d=this._initPTS,h=!d||r,f="audio/mp4";if(h&&(n=a=1/0),e.config&&o.length&&(e.timescale=e.samplerate,"mp3"===e.segmentCodec&&(u.mpeg?(f="audio/mpeg",e.codec=""):u.mp3&&(e.codec="mp3")),c.audio={id:"audio",container:f,codec:e.codec,initSegment:"mp3"===e.segmentCodec&&u.mpeg?new Uint8Array(0):id.initSegment([e]),metadata:{channelCount:e.channelCount}},h&&(s=e.inputTimeScale,d&&s===d.timescale?h=!1:n=a=o[0].pts-Math.round(s*i))),t.sps&&t.pps&&l.length&&(t.timescale=t.inputTimeScale,c.video={id:"main",container:"video/mp4",codec:t.codec,initSegment:id.initSegment([t]),metadata:{width:t.width,height:t.height}},h)){if(s=t.inputTimeScale,d&&s===d.timescale)h=!1;else{let e=this.getVideoStartPts(l),t=Math.round(s*i);a=Math.min(a,iy(l[0].dts,e)-t),n=Math.min(n,e-t)}}if(Object.keys(c).length)return this.ISGenerated=!0,h?(this._initPTS={baseTime:n,timescale:s},this._initDTS={baseTime:a,timescale:s}):n=s=void 0,{tracks:c,initPTS:n,timescale:s}}remuxVideo(e,t,i,r){let n,a,s;let o=e.inputTimeScale,l=e.samples,u=[],c=l.length,d=this._initPTS,h=this.nextAvcDts,f=8,p=this.videoSampleDuration,m=Number.POSITIVE_INFINITY,g=Number.NEGATIVE_INFINITY,v=!1;if(!i||null===h){let e=l[0].pts-iy(l[0].dts,l[0].pts);h=t*o-e}let y=d.baseTime*o/d.timescale;for(let e=0;e<c;e++){let t=l[e];t.pts=iy(t.pts-y,h),t.dts=iy(t.dts-y,h),t.dts<l[e>0?e-1:e].dts&&(v=!0)}v&&l.sort(function(e,t){let i=e.dts-t.dts,r=e.pts-t.pts;return i||r}),n=l[0].dts,a=l[l.length-1].dts;let _=a-n,T=_?Math.round(_/(c-1)):p||e.inputTimeScale/30;if(i){let e=n-h,t=e>T,i=e<-1;if((t||i)&&(t?M.warn(`AVC: ${ip(e,!0)} ms (${e}dts) hole between fragments detected, filling it`):M.warn(`AVC: ${ip(-e,!0)} ms (${e}dts) overlapping between fragments detected`),!i||h>=l[0].pts)){n=h;let t=l[0].pts-e;l[0].dts=n,l[0].pts=t,M.log(`Video: First PTS/DTS adjusted: ${ip(t,!0)}/${ip(n,!0)}, delta: ${ip(e,!0)} ms`)}}n=Math.max(0,n);let w=0,A=0;for(let e=0;e<c;e++){let t=l[e],i=t.units,r=i.length,a=0;for(let e=0;e<r;e++)a+=i[e].data.length;A+=a,w+=r,t.length=a,t.dts=Math.max(t.dts,n),m=Math.min(t.pts,m),g=Math.max(t.pts,g)}a=l[c-1].dts;let R=A+4*w+8;try{s=new Uint8Array(R)}catch(e){this.observer.emit(E.ERROR,E.ERROR,{type:S.MUX_ERROR,details:x.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:R,reason:`fail allocating video mdat ${R}`});return}let C=new DataView(s.buffer);C.setUint32(0,R),s.set(id.types.mdat,4);let I=!1,L=Number.POSITIVE_INFINITY,k=Number.POSITIVE_INFINITY,D=Number.NEGATIVE_INFINITY,P=Number.NEGATIVE_INFINITY;for(let e=0;e<c;e++){let t;let i=l[e],n=i.units,a=0;for(let e=0,t=n.length;e<t;e++){let t=n[e],i=t.data,r=t.data.byteLength;C.setUint32(f,r),f+=4,s.set(i,f),f+=r,a+=4+r}if(e<c-1)p=l[e+1].dts-i.dts,t=l[e+1].pts-i.pts;else{let n=this.config,a=e>0?i.dts-l[e-1].dts:T;if(t=e>0?i.pts-l[e-1].pts:T,n.stretchShortVideoTrack&&null!==this.nextAudioPts){let e=Math.floor(n.maxBufferHole*o),t=(r?m+r*o:this.nextAudioPts)-i.pts;t>e?((p=t-a)<0?p=a:I=!0,M.log(`[mp4-remuxer]: It is approximately ${t/90} ms to the next segment; using duration ${p/90} ms for the last video frame.`)):p=a}else p=a}let d=Math.round(i.pts-i.dts);L=Math.min(L,p),D=Math.max(D,p),k=Math.min(k,t),P=Math.max(P,t),u.push(new iE(i.key,p,a,d))}if(u.length){if(im){if(im<70){let e=u[0].flags;e.dependsOn=2,e.isNonSync=0}}else if(ig&&P-k<D-L&&T/D<.025&&0===u[0].cts){M.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");let e=n;for(let t=0,i=u.length;t<i;t++){let r=e+u[t].duration,n=e+u[t].cts;if(t<i-1){let e=r+u[t+1].cts;u[t].duration=e-n}else u[t].duration=t?u[t-1].duration:T;u[t].cts=0,e=r}}}p=I||!p?T:p,this.nextAvcDts=h=a+p,this.videoSampleDuration=p,this.isVideoContiguous=!0;let O=id.moof(e.sequenceNumber++,n,b({},e,{samples:u})),N={data1:O,data2:s,startPTS:m/o,endPTS:(g+p)/o,startDTS:n/o,endDTS:h/o,type:"video",hasAudio:!1,hasVideo:!0,nb:u.length,dropped:e.dropped};return e.samples=[],e.dropped=0,N}remuxAudio(e,t,i,r,n){let a;let s=e.inputTimeScale,o=e.samplerate?e.samplerate:s,l=s/o,u="aac"===e.segmentCodec?1024:1152,c=u*l,d=this._initPTS,h="mp3"===e.segmentCodec&&this.typeSupported.mpeg,f=[],p=void 0!==n,m=e.samples,g=h?0:8,v=this.nextAudioPts||-1,y=t*s,_=d.baseTime*s/d.timescale;if(this.isAudioContiguous=i=i||m.length&&v>0&&(r&&9e3>Math.abs(y-v)||Math.abs(iy(m[0].pts-_,y)-v)<20*c),m.forEach(function(e){e.pts=iy(e.pts-_,y)}),!i||v<0){if(!(m=m.filter(e=>e.pts>=0)).length)return;v=0===n?0:r&&!p?Math.max(0,y):m[0].pts}if("aac"===e.segmentCodec){let t=this.config.maxAudioFramesDrift;for(let i=0,r=v;i<m.length;i++){let n=m[i],a=n.pts,o=a-r,l=Math.abs(1e3*o/s);if(o<=-t*c&&p)0===i&&(M.warn(`Audio frame @ ${(a/s).toFixed(3)}s overlaps nextAudioPts by ${Math.round(1e3*o/s)} ms.`),this.nextAudioPts=v=r=a);else if(o>=t*c&&l<1e4&&p){let t=Math.round(o/c);(r=a-t*c)<0&&(t--,r+=c),0===i&&(this.nextAudioPts=v=r),M.warn(`[mp4-remuxer]: Injecting ${t} audio frame @ ${(r/s).toFixed(3)}s due to ${Math.round(1e3*o/s)} ms gap.`);for(let a=0;a<t;a++){let t=Math.max(r,0),a=ic.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);a||(M.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),a=n.unit.subarray()),m.splice(i,0,{unit:a,pts:t}),r+=c,i++}}n.pts=r,r+=c}}let T=null,w=null,A=0,R=m.length;for(;R--;)A+=m[R].unit.byteLength;for(let t=0,r=m.length;t<r;t++){let r=m[t],n=r.unit,s=r.pts;if(null!==w){let e=f[t-1];e.duration=Math.round((s-w)/l)}else{if(i&&"aac"===e.segmentCodec&&(s=v),T=s,!(A>0))return;A+=g;try{a=new Uint8Array(A)}catch(e){this.observer.emit(E.ERROR,E.ERROR,{type:S.MUX_ERROR,details:x.REMUX_ALLOC_ERROR,fatal:!1,error:e,bytes:A,reason:`fail allocating audio mdat ${A}`});return}if(!h){let e=new DataView(a.buffer);e.setUint32(0,A),a.set(id.types.mdat,4)}}a.set(n,g);let o=n.byteLength;g+=o,f.push(new iE(!0,u,o,0)),w=s}let C=f.length;if(!C)return;let I=f[f.length-1];this.nextAudioPts=v=w+l*I.duration;let L=h?new Uint8Array(0):id.moof(e.sequenceNumber++,T/l,b({},e,{samples:f}));e.samples=[];let k=T/s,D=v/s,P={data1:L,data2:a,startPTS:k,endPTS:D,startDTS:k,endDTS:D,type:"audio",hasAudio:!0,hasVideo:!1,nb:C};return this.isAudioContiguous=!0,P}remuxEmptyAudio(e,t,i,r){let n=e.inputTimeScale,a=e.samplerate?e.samplerate:n,s=this.nextAudioPts,o=this._initDTS,l=9e4*o.baseTime/o.timescale,u=(null!==s?s:r.startDTS*n)+l,c=r.endDTS*n+l,d=n/a*1024,h=Math.ceil((c-u)/d),f=ic.getSilentFrame(e.manifestCodec||e.codec,e.channelCount);if(M.warn("[mp4-remuxer]: remux empty Audio"),!f){M.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}let p=[];for(let e=0;e<h;e++){let t=u+e*d;p.push({unit:f,pts:t,dts:t})}return e.samples=p,this.remuxAudio(e,t,i,!1)}}function iy(e,t){let i;if(null===t)return e;for(i=t<e?-8589934592:8589934592;Math.abs(e-t)>4294967296;)e+=i;return e}function ib(e,t,i,r){let n=e.samples.length;if(!n)return;let a=e.inputTimeScale;for(let s=0;s<n;s++){let n=e.samples[s];n.pts=iy(n.pts-i.baseTime*a/i.timescale,t*a)/a,n.dts=iy(n.dts-r.baseTime*a/r.timescale,t*a)/a}let s=e.samples;return e.samples=[],{samples:s}}function i_(e,t,i){let r=e.samples.length;if(!r)return;let n=e.inputTimeScale;for(let a=0;a<r;a++){let r=e.samples[a];r.pts=iy(r.pts-i.baseTime*n/i.timescale,t*n)/n}e.samples.sort((e,t)=>e.pts-t.pts);let a=e.samples;return e.samples=[],{samples:a}}class iE{constructor(e,t,i,r){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=t,this.size=i,this.cts=r,this.flags=new iS(e)}}class iS{constructor(e){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=e?2:1,this.isNonSync=e?0:1}}function ix(e,t){let i=null==e?void 0:e.codec;return i&&i.length>4?i:"hvc1"===i||"hev1"===i?"hvc1.1.6.L120.90":"av01"===i?"av01.0.04M.08":"avc1"===i||t===D.VIDEO?"avc1.42e01e":"mp4a.40.5"}try{a=self.performance.now.bind(self.performance)}catch(e){M.debug("Unable to use Performance API on this environment"),a="undefined"!=typeof self&&self.Date.now}let iT=[{demux:class{constructor(e,t){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=t}resetTimeStamp(){}resetInitSegment(e,t,i,r){let n=this.videoTrack=tq("video",1),a=this.audioTrack=tq("audio",1),s=this.txtTrack=tq("text",1);if(this.id3Track=tq("id3",1),this.timeOffset=0,!(null!=e&&e.byteLength))return;let o=ey(e);if(o.video){let{id:e,timescale:t,codec:i}=o.video;n.id=e,n.timescale=s.timescale=t,n.codec=i}if(o.audio){let{id:e,timescale:t,codec:i}=o.audio;a.id=e,a.timescale=t,a.codec=i}s.id=4,n.sampleDuration=0,n.duration=a.duration=r}resetContiguity(){this.remainderData=null}static probe(e){return ev(e=e.length>16384?e.subarray(0,16384):e,["moof"]).length>0}demux(e,t){this.timeOffset=t;let i=e,r=this.videoTrack,n=this.txtTrack;if(this.config.progressive){this.remainderData&&(i=e_(this.remainderData,e));let t=function(e){let t={valid:null,remainder:null},i=ev(e,["moof"]);if(!i)return t;if(i.length<2)return t.remainder=e,t;let r=i[i.length-1];return t.valid=q(e,0,r.byteOffset-8),t.remainder=q(e,r.byteOffset-8),t}(i);this.remainderData=t.remainder,r.samples=t.valid||new Uint8Array}else r.samples=i;let a=this.extractID3Track(r,t);return n.samples=eE(t,r),{videoTrack:r,audioTrack:this.audioTrack,id3Track:a,textTrack:this.txtTrack}}flush(){let e=this.timeOffset,t=this.videoTrack,i=this.txtTrack;t.samples=this.remainderData||new Uint8Array,this.remainderData=null;let r=this.extractID3Track(t,this.timeOffset);return i.samples=eE(e,t),{videoTrack:t,audioTrack:tq(),id3Track:r,textTrack:tq()}}extractID3Track(e,t){let i=this.id3Track;if(e.samples.length){let r=ev(e.samples,["emsg"]);r&&r.forEach(e=>{let r=function(e){let t=e[0],i="",r="",n=0,a=0,s=0,o=0,l=0,u=0;if(0===t){for(;"\x00"!==eh(e.subarray(u,u+1));)i+=eh(e.subarray(u,u+1)),u+=1;for(i+=eh(e.subarray(u,u+1)),u+=1;"\x00"!==eh(e.subarray(u,u+1));)r+=eh(e.subarray(u,u+1)),u+=1;r+=eh(e.subarray(u,u+1)),u+=1,n=ep(e,12),a=ep(e,16),o=ep(e,20),l=ep(e,24),u=28}else if(1===t){u+=4,n=ep(e,u),u+=4;let t=ep(e,u);u+=4;let a=ep(e,u);for(u+=4,Number.isSafeInteger(s=4294967296*t+a)||(s=Number.MAX_SAFE_INTEGER,M.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),o=ep(e,u),u+=4,l=ep(e,u),u+=4;"\x00"!==eh(e.subarray(u,u+1));)i+=eh(e.subarray(u,u+1)),u+=1;for(i+=eh(e.subarray(u,u+1)),u+=1;"\x00"!==eh(e.subarray(u,u+1));)r+=eh(e.subarray(u,u+1)),u+=1;r+=eh(e.subarray(u,u+1)),u+=1}let c=e.subarray(u,e.byteLength);return{schemeIdUri:i,value:r,timeScale:n,presentationTime:s,presentationTimeDelta:a,eventDuration:o,id:l,payload:c}}(e);if(t2.test(r.schemeIdUri)){let e=_(r.presentationTime)?r.presentationTime/r.timeScale:t+r.presentationTimeDelta/r.timeScale,n=4294967295===r.eventDuration?Number.POSITIVE_INFINITY:r.eventDuration/r.timeScale;n<=.001&&(n=Number.POSITIVE_INFINITY);let a=r.payload;i.samples.push({data:a,len:a.byteLength,dts:e,pts:e,type:e1.emsg,duration:n})}})}return i}demuxSampleAes(e,t,i){return Promise.reject(Error("The MP4 demuxer does not support SAMPLE-AES decryption"))}destroy(){}},remux:class{constructor(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=null,this.initTracks=void 0,this.lastEndTime=null}destroy(){}resetTimeStamp(e){this.initPTS=e,this.lastEndTime=null}resetNextTimestamp(){this.lastEndTime=null}resetInitSegment(e,t,i,r){this.audioCodec=t,this.videoCodec=i,this.generateInitSegment(function(e,t){if(!e||!t)return e;let i=t.keyId;if(i&&t.isCommonEncryption){let t=ev(e,["moov","trak"]);t.forEach(e=>{let t=ev(e,["mdia","minf","stbl","stsd"])[0],r=t.subarray(8),n=ev(r,["enca"]),a=n.length>0;a||(n=ev(r,["encv"])),n.forEach(e=>{let t=a?e.subarray(28):e.subarray(78),r=ev(t,["sinf"]);r.forEach(e=>{let t=eb(e);if(t){let e=t.subarray(8,24);e.some(e=>0!==e)||(M.log(`[eme] Patching keyId in 'enc${a?"a":"v"}>sinf>>tenc' box: ${eu.hexDump(e)} -> ${eu.hexDump(i)}`),t.set(i,8))}})})})}return e}(e,r)),this.emitInitSegment=!0}generateInitSegment(e){let{audioCodec:t,videoCodec:i}=this;if(!(null!=e&&e.byteLength)){this.initTracks=void 0,this.initData=void 0;return}let r=this.initData=ey(e);t||(t=ix(r.audio,D.AUDIO)),i||(i=ix(r.video,D.VIDEO));let n={};r.audio&&r.video?n.audiovideo={container:"video/mp4",codec:t+","+i,initSegment:e,id:"main"}:r.audio?n.audio={container:"audio/mp4",codec:t,initSegment:e,id:"audio"}:r.video?n.video={container:"video/mp4",codec:i,initSegment:e,id:"main"}:M.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=n}remux(e,t,i,r,n,a){var s,o,l;let{initPTS:u,lastEndTime:c}=this,d={audio:void 0,video:void 0,text:r,id3:i,initSegment:void 0};_(c)||(c=this.lastEndTime=n||0);let h=t.samples;if(!(null!=h&&h.length))return d;let f={initPTS:void 0,timescale:1},p=this.initData;if(null!=(s=p)&&s.length||(this.generateInitSegment(h),p=this.initData),!(null!=(o=p)&&o.length))return M.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),d;this.emitInitSegment&&(f.tracks=this.initTracks,this.emitInitSegment=!1);let m=function(e,t){let i=0,r=0,n=0,a=ev(e,["moof","traf"]);for(let e=0;e<a.length;e++){let s=a[e],o=ev(s,["tfhd"])[0],l=ep(o,4),u=t[l];if(!u)continue;let c=u.default,d=ep(o,0)|(null==c?void 0:c.flags),h=null==c?void 0:c.duration;8&d&&(h=2&d?ep(o,12):ep(o,8));let f=u.timescale||9e4,p=ev(s,["trun"]);for(let e=0;e<p.length;e++){if(!(i=function(e){let t=ep(e,0),i=8;1&t&&(i+=4),4&t&&(i+=4);let r=0,n=ep(e,4);for(let a=0;a<n;a++){if(256&t){let t=ep(e,i);r+=t,i+=4}512&t&&(i+=4),1024&t&&(i+=4),2048&t&&(i+=4)}return r}(p[e]))&&h){let t=ep(p[e],4);i=h*t}u.type===D.VIDEO?r+=i/f:u.type===D.AUDIO&&(n+=i/f)}}if(0===r&&0===n){let t=0,i=ev(e,["sidx"]);for(let e=0;e<i.length;e++){let r=function(e){let t=[],i=e[0],r=8,n=ep(e,r);r+=4,0===i?r+=8:r+=16,r+=2;let a=e.length+0,s=ef(e,r);r+=2;for(let i=0;i<s;i++){let i=r,s=ep(e,i);i+=4;let o=2147483647&s,l=(2147483648&s)>>>31;if(1===l)return M.warn("SIDX has hierarchical references (not supported)"),null;let u=ep(e,i);i+=4,t.push({referenceSize:o,subsegmentDuration:u,info:{duration:u/n,start:a,end:a+o-1}}),a+=o,i+=4,r=i}return{earliestPresentationTime:0,timescale:n,version:i,referencesCount:s,references:t}}(i[e]);null!=r&&r.references&&(t+=r.references.reduce((e,t)=>e+t.info.duration||0,0))}return t}return r||n}(h,p),g=(l=p,ev(h,["moof","traf"]).reduce((e,t)=>{let i=ev(t,["tfdt"])[0],r=i[0],n=ev(t,["tfhd"]).reduce((e,t)=>{let n=ep(t,4),a=l[n];if(a){let t=ep(i,4);if(1===r){if(4294967295===t)return M.warn("[mp4-demuxer]: Ignoring assumed invalid signed 64-bit track fragment decode time"),e;t*=4294967296,t+=ep(i,8)}let n=a.timescale||9e4,s=t/n;if(isFinite(s)&&(null===e||s<e))return s}return e},null);return null!==n&&isFinite(n)&&(null===e||n<e)?n:e},null)),v=null===g?n:g;((function(e,t,i,r){if(null===e)return!0;let n=t-e.baseTime/e.timescale;return Math.abs(n-i)>Math.max(r,1)})(u,v,n,m)||f.timescale!==u.timescale&&a)&&(f.initPTS=v-n,u&&1===u.timescale&&M.warn(`Adjusting initPTS by ${f.initPTS-u.baseTime}`),this.initPTS=u={baseTime:f.initPTS,timescale:1});let y=e?v-u.baseTime/u.timescale:c,b=y+m;!function(e,t,i){ev(t,["moof","traf"]).forEach(t=>{ev(t,["tfhd"]).forEach(r=>{let n=ep(r,4),a=e[n];if(!a)return;let s=a.timescale||9e4;ev(t,["tfdt"]).forEach(e=>{let t=e[0],r=ep(e,4);if(0===t)r-=i*s,r=Math.max(r,0),eg(e,4,r);else{r*=4294967296,r+=ep(e,8),r-=i*s,r=Math.max(r,0);let t=Math.floor(r/4294967296),n=Math.floor(r%4294967296);eg(e,4,t),eg(e,8,n)}})})})}(p,h,u.baseTime/u.timescale),m>0?this.lastEndTime=b:(M.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());let E=!!p.audio,S=!!p.video,x="";E&&(x+="audio"),S&&(x+="video");let T={data1:h,startPTS:y,startDTS:y,endPTS:b,endDTS:b,type:x,hasAudio:E,hasVideo:S,nb:1,dropped:0};return d.audio="audio"===T.type?T:void 0,d.video="audio"!==T.type?T:void 0,d.initSegment=f,d.id3=ib(i,n,u,u),r.samples.length&&(d.text=i_(r,n,u)),d}}},{demux:ia,remux:iv},{demux:class extends tY{constructor(e,t){super(),this.observer=void 0,this.config=void 0,this.observer=e,this.config=t}resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=X(e,0)||[],i=t.length;for(let t=e.length;i<t;i++)if(function(e,t){if(tQ(e,t)){let i=tZ(e,t);if(t+i>=e.length)return!1;let r=tJ(e,t);if(r<=i)return!1;let n=t+r;return n===e.length||tQ(e,n)}return!1}(e,i))return M.log("ADTS sync word found !"),!0;return!1}canParse(e,t){return t+5<e.length&&tX(e,t)&&tJ(e,t)<=e.length-t}appendFrame(e,t,i){t0(e,this.observer,t,i,e.manifestCodec);let r=t1(e,t,i,this.basePTS,this.frameIndex);if(r&&0===r.missing)return r}},remux:iv},{demux:class extends tY{resetInitSegment(e,t,i,r){super.resetInitSegment(e,t,i,r),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:t,duration:r,inputTimeScale:9e4,dropped:0}}static probe(e){if(!e)return!1;let t=X(e,0)||[],i=t.length;for(let t=e.length;i<t;i++)if(function(e,t){if(t+1<e.length&&ie(e,t)){let i=t9(e,t),r=4;null!=i&&i.frameLength&&(r=i.frameLength);let n=t+r;return n===e.length||it(e,n)}return!1}(e,i))return M.log("MPEG Audio sync word found !"),!0;return!1}canParse(e,t){return ie(e,t)&&4<=e.length-t}appendFrame(e,t,i){if(null!==this.basePTS)return t7(e,t,i,this.basePTS,this.frameIndex)}},remux:iv}];class iw{constructor(e,t,i,r,n){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=e,this.typeSupported=t,this.config=i,this.vendor=r,this.id=n}configure(e){this.transmuxConfig=e,this.decrypter&&this.decrypter.reset()}push(e,t,i,r){let n;let s=i.transmuxing;s.executeStart=a();let o=new Uint8Array(e),{currentTransmuxState:l,transmuxConfig:u}=this;r&&(this.currentTransmuxState=r);let{contiguous:c,discontinuity:d,trackSwitch:h,accurateTimeOffset:f,timeOffset:p,initSegmentChange:m}=r||l,{audioCodec:g,videoCodec:v,defaultInitPts:y,duration:b,initSegmentData:_}=u,T=(n=null,o.byteLength>0&&null!=t&&null!=t.key&&null!==t.iv&&null!=t.method&&(n=t),n);if(T&&"AES-128"===T.method){let e=this.getDecrypter();if(!e.isSync())return this.decryptionPromise=e.webCryptoDecrypt(o,T.key.buffer,T.iv.buffer).then(e=>{let t=this.push(e,null,i);return this.decryptionPromise=null,t}),this.decryptionPromise;{let t=e.softwareDecrypt(o,T.key.buffer,T.iv.buffer),r=i.part>-1;if(r&&(t=e.flush()),!t)return s.executeEnd=a(),iA(i);o=new Uint8Array(t)}}let w=this.needsProbing(d,h);if(w){let e=this.configureTransmuxer(o);if(e)return M.warn(`[transmuxer] ${e.message}`),this.observer.emit(E.ERROR,E.ERROR,{type:S.MEDIA_ERROR,details:x.FRAG_PARSING_ERROR,fatal:!1,error:e,reason:e.message}),s.executeEnd=a(),iA(i)}(d||h||m||w)&&this.resetInitSegment(_,g,v,b,t),(d||m||w)&&this.resetInitialTimestamp(y),c||this.resetContiguity();let A=this.transmux(o,T,p,f,i),R=this.currentTransmuxState;return R.contiguous=!0,R.discontinuity=!1,R.trackSwitch=!1,s.executeEnd=a(),A}flush(e){let t=e.transmuxing;t.executeStart=a();let{decrypter:i,currentTransmuxState:r,decryptionPromise:n}=this;if(n)return n.then(()=>this.flush(e));let s=[],{timeOffset:o}=r;if(i){let t=i.flush();t&&s.push(this.push(t,null,e))}let{demuxer:l,remuxer:u}=this;if(!l||!u)return t.executeEnd=a(),[iA(e)];let c=l.flush(o);return iM(c)?c.then(t=>(this.flushRemux(s,t,e),s)):(this.flushRemux(s,c,e),s)}flushRemux(e,t,i){let{audioTrack:r,videoTrack:n,id3Track:s,textTrack:o}=t,{accurateTimeOffset:l,timeOffset:u}=this.currentTransmuxState;M.log(`[transmuxer.ts]: Flushed fragment ${i.sn}${i.part>-1?" p: "+i.part:""} of level ${i.level}`);let c=this.remuxer.remux(r,n,s,o,u,l,!0,this.id);e.push({remuxResult:c,chunkMeta:i}),i.transmuxing.executeEnd=a()}resetInitialTimestamp(e){let{demuxer:t,remuxer:i}=this;t&&i&&(t.resetTimeStamp(e),i.resetTimeStamp(e))}resetContiguity(){let{demuxer:e,remuxer:t}=this;e&&t&&(e.resetContiguity(),t.resetNextTimestamp())}resetInitSegment(e,t,i,r,n){let{demuxer:a,remuxer:s}=this;a&&s&&(a.resetInitSegment(e,t,i,r),s.resetInitSegment(e,t,i,n))}destroy(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)}transmux(e,t,i,r,n){return t&&"SAMPLE-AES"===t.method?this.transmuxSampleAes(e,t,i,r,n):this.transmuxUnencrypted(e,i,r,n)}transmuxUnencrypted(e,t,i,r){let{audioTrack:n,videoTrack:a,id3Track:s,textTrack:o}=this.demuxer.demux(e,t,!1,!this.config.progressive),l=this.remuxer.remux(n,a,s,o,t,i,!1,this.id);return{remuxResult:l,chunkMeta:r}}transmuxSampleAes(e,t,i,r,n){return this.demuxer.demuxSampleAes(e,t,i).then(e=>{let t=this.remuxer.remux(e.audioTrack,e.videoTrack,e.id3Track,e.textTrack,i,r,!1,this.id);return{remuxResult:t,chunkMeta:n}})}configureTransmuxer(e){let t;let{config:i,observer:r,typeSupported:n,vendor:a}=this;for(let i=0,r=iT.length;i<r;i++)if(iT[i].demux.probe(e)){t=iT[i];break}if(!t)return Error("Failed to find demuxer by probing fragment data");let s=this.demuxer,o=this.remuxer,l=t.remux,u=t.demux;o&&o instanceof l||(this.remuxer=new l(r,i,n,a)),s&&s instanceof u||(this.demuxer=new u(r,i,n),this.probe=u.probe)}needsProbing(e,t){return!this.demuxer||!this.remuxer||e||t}getDecrypter(){let e=this.decrypter;return e||(e=this.decrypter=new tj(this.config)),e}}let iA=e=>({remuxResult:{},chunkMeta:e});function iM(e){return"then"in e&&e.then instanceof Function}class iR{constructor(e,t,i,r,n){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=e,this.videoCodec=t,this.initSegmentData=i,this.duration=r,this.defaultInitPts=n||null}}class iC{constructor(e,t,i,r,n,a){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=e,this.contiguous=t,this.accurateTimeOffset=i,this.trackSwitch=r,this.timeOffset=n,this.initSegmentChange=a}}var iI={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,i="~";function r(){}function n(e,t,i){this.fn=e,this.context=t,this.once=i||!1}function a(e,t,r,a,s){if("function"!=typeof r)throw TypeError("The listener must be a function");var o=new n(r,a||e,s),l=i?i+t:t;return e._events[l]?e._events[l].fn?e._events[l]=[e._events[l],o]:e._events[l].push(o):(e._events[l]=o,e._eventsCount++),e}function s(e,t){0==--e._eventsCount?e._events=new r:delete e._events[t]}function o(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(i=!1)),o.prototype.eventNames=function(){var e,r,n=[];if(0===this._eventsCount)return n;for(r in e=this._events)t.call(e,r)&&n.push(i?r.slice(1):r);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},o.prototype.listeners=function(e){var t=i?i+e:e,r=this._events[t];if(!r)return[];if(r.fn)return[r.fn];for(var n=0,a=r.length,s=Array(a);n<a;n++)s[n]=r[n].fn;return s},o.prototype.listenerCount=function(e){var t=i?i+e:e,r=this._events[t];return r?r.fn?1:r.length:0},o.prototype.emit=function(e,t,r,n,a,s){var o=i?i+e:e;if(!this._events[o])return!1;var l,u,c=this._events[o],d=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),d){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,r),!0;case 4:return c.fn.call(c.context,t,r,n),!0;case 5:return c.fn.call(c.context,t,r,n,a),!0;case 6:return c.fn.call(c.context,t,r,n,a,s),!0}for(u=1,l=Array(d-1);u<d;u++)l[u-1]=arguments[u];c.fn.apply(c.context,l)}else{var h,f=c.length;for(u=0;u<f;u++)switch(c[u].once&&this.removeListener(e,c[u].fn,void 0,!0),d){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,t);break;case 3:c[u].fn.call(c[u].context,t,r);break;case 4:c[u].fn.call(c[u].context,t,r,n);break;default:if(!l)for(h=1,l=Array(d-1);h<d;h++)l[h-1]=arguments[h];c[u].fn.apply(c[u].context,l)}}return!0},o.prototype.on=function(e,t,i){return a(this,e,t,i,!1)},o.prototype.once=function(e,t,i){return a(this,e,t,i,!0)},o.prototype.removeListener=function(e,t,r,n){var a=i?i+e:e;if(!this._events[a])return this;if(!t)return s(this,a),this;var o=this._events[a];if(o.fn)o.fn!==t||n&&!o.once||r&&o.context!==r||s(this,a);else{for(var l=0,u=[],c=o.length;l<c;l++)(o[l].fn!==t||n&&!o[l].once||r&&o[l].context!==r)&&u.push(o[l]);u.length?this._events[a]=1===u.length?u[0]:u:s(this,a)}return this},o.prototype.removeAllListeners=function(e){var t;return e?(t=i?i+e:e,this._events[t]&&s(this,t)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=i,o.EventEmitter=o,e.exports=o}(iI);var iL=(p=iI.exports)&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p;let ik=eI()||{isTypeSupported:()=>!1};class iD{constructor(e,t,i,r){this.error=null,this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.workerContext=null,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;let n=e.config;this.hls=e,this.id=t,this.useWorker=!!n.enableWorker,this.onTransmuxComplete=i,this.onFlush=r;let a=(e,t)=>{(t=t||{}).frag=this.frag,t.id=this.id,e===E.ERROR&&(this.error=t.error),this.hls.trigger(e,t)};this.observer=new iL,this.observer.on(E.FRAG_DECRYPTED,a),this.observer.on(E.ERROR,a);let s={mp4:ik.isTypeSupported("video/mp4"),mpeg:ik.isTypeSupported("audio/mpeg"),mp3:ik.isTypeSupported('audio/mp4; codecs="mp3"')},o=navigator.vendor;if(this.useWorker&&"undefined"!=typeof Worker){let e=n.workerPath||"function"==typeof __HLS_WORKER_BUNDLE__;if(e){try{n.workerPath?(M.log(`loading Web Worker ${n.workerPath} for "${t}"`),this.workerContext=function(e){let t=new self.URL(e,self.location.href).href,i=new self.Worker(t);return{worker:i,scriptURL:t}}(n.workerPath)):(M.log(`injecting Web Worker for "${t}"`),this.workerContext=function(){let e=new self.Blob([`var exports={};var module={exports:exports};function define(f){f()};define.amd=true;(${__HLS_WORKER_BUNDLE__.toString()})(true);`],{type:"text/javascript"}),t=self.URL.createObjectURL(e),i=new self.Worker(t);return{worker:i,objectURL:t}}()),this.onwmsg=e=>this.onWorkerMessage(e);let{worker:e}=this.workerContext;e.addEventListener("message",this.onwmsg),e.onerror=e=>{let i=Error(`${e.message}  (${e.filename}:${e.lineno})`);n.enableWorker=!1,M.warn(`Error in "${t}" Web Worker, fallback to inline`),this.hls.trigger(E.ERROR,{type:S.OTHER_ERROR,details:x.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:i})},e.postMessage({cmd:"init",typeSupported:s,vendor:o,id:t,config:JSON.stringify(n)})}catch(e){M.warn(`Error setting up "${t}" Web Worker, fallback to inline`,e),this.resetWorker(),this.error=null,this.transmuxer=new iw(this.observer,s,n,o,t)}return}}this.transmuxer=new iw(this.observer,s,n,o,t)}resetWorker(){if(this.workerContext){let{worker:e,objectURL:t}=this.workerContext;t&&self.URL.revokeObjectURL(t),e.removeEventListener("message",this.onwmsg),e.onerror=null,e.terminate(),this.workerContext=null}}destroy(){if(this.workerContext)this.resetWorker(),this.onwmsg=void 0;else{let e=this.transmuxer;e&&(e.destroy(),this.transmuxer=null)}let e=this.observer;e&&e.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null}push(e,t,i,r,n,a,s,o,l,u){var c,d;l.transmuxing.start=self.performance.now();let{transmuxer:h}=this,f=a?a.start:n.start,p=n.decryptdata,m=this.frag,g=!(m&&n.cc===m.cc),v=!(m&&l.level===m.level),y=m?l.sn-m.sn:-1,b=this.part?l.part-this.part.index:-1,_=0===y&&l.id>1&&l.id===(null==m?void 0:m.stats.chunkCount),E=!v&&(1===y||0===y&&(1===b||_&&b<=0)),S=self.performance.now();(v||y||0===n.stats.parsing.start)&&(n.stats.parsing.start=S),a&&(b||!E)&&(a.stats.parsing.start=S);let x=!(m&&(null==(c=n.initSegment)?void 0:c.url)===(null==(d=m.initSegment)?void 0:d.url)),T=new iC(g,E,o,v,f,x);if(!E||g||x){M.log(`[transmuxer-interface, ${n.type}]: Starting new transmux session for sn: ${l.sn} p: ${l.part} level: ${l.level} id: ${l.id}
        discontinuity: ${g}
        trackSwitch: ${v}
        contiguous: ${E}
        accurateTimeOffset: ${o}
        timeOffset: ${f}
        initSegmentChange: ${x}`);let e=new iR(i,r,t,s,u);this.configureTransmuxer(e)}if(this.frag=n,this.part=a,this.workerContext)this.workerContext.worker.postMessage({cmd:"demux",data:e,decryptdata:p,chunkMeta:l,state:T},e instanceof ArrayBuffer?[e]:[]);else if(h){let t=h.push(e,p,l,T);iM(t)?(h.async=!0,t.then(e=>{this.handleTransmuxComplete(e)}).catch(e=>{this.transmuxerError(e,l,"transmuxer-interface push error")})):(h.async=!1,this.handleTransmuxComplete(t))}}flush(e){e.transmuxing.start=self.performance.now();let{transmuxer:t}=this;if(this.workerContext)this.workerContext.worker.postMessage({cmd:"flush",chunkMeta:e});else if(t){let i=t.flush(e),r=iM(i);r||t.async?(iM(i)||(i=Promise.resolve(i)),i.then(t=>{this.handleFlushResult(t,e)}).catch(t=>{this.transmuxerError(t,e,"transmuxer-interface flush error")})):this.handleFlushResult(i,e)}}transmuxerError(e,t,i){this.hls&&(this.error=e,this.hls.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.FRAG_PARSING_ERROR,chunkMeta:t,fatal:!1,error:e,err:e,reason:i}))}handleFlushResult(e,t){e.forEach(e=>{this.handleTransmuxComplete(e)}),this.onFlush(t)}onWorkerMessage(e){let t=e.data,i=this.hls;switch(t.event){case"init":{var r;let e=null==(r=this.workerContext)?void 0:r.objectURL;e&&self.URL.revokeObjectURL(e);break}case"transmuxComplete":this.handleTransmuxComplete(t.data);break;case"flush":this.onFlush(t.data);break;case"workerLog":M[t.data.logType]&&M[t.data.logType](t.data.message);break;default:t.data=t.data||{},t.data.frag=this.frag,t.data.id=this.id,i.trigger(t.event,t.data)}}configureTransmuxer(e){let{transmuxer:t}=this;this.workerContext?this.workerContext.worker.postMessage({cmd:"configure",config:e}):t&&t.configure(e)}handleTransmuxComplete(e){e.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(e)}}class iP{constructor(e,t,i,r){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=e,this.media=t,this.fragmentTracker=i,this.hls=r}destroy(){this.media=null,this.hls=this.fragmentTracker=null}poll(e,t){let{config:i,media:r,stalled:n}=this;if(null===r)return;let{currentTime:a,seeking:s}=r,o=this.seeking&&!s,l=!this.seeking&&s;if(this.seeking=s,a!==e){if(this.moved=!0,null!==n){if(this.stallReported){let e=self.performance.now()-n;M.warn(`playback not stuck anymore @${a}, after ${Math.round(e)}ms`),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if(l||o){this.stalled=null;return}if(r.paused&&!s||r.ended||0===r.playbackRate||!tk.getBuffered(r).length)return;let u=tk.bufferInfo(r,a,0),c=u.len>0,d=u.nextStart||0;if(!c&&!d)return;if(s){let e=u.len>2,i=!d||t&&t.start<=a||d-a>2&&!this.fragmentTracker.getPartialFragment(a);if(e||i)return;this.moved=!1}if(!this.moved&&null!==this.stalled){var h;let e=Math.max(d,u.start||0)-a,t=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,i=null==t?void 0:null==(h=t.details)?void 0:h.live,r=i?2*t.details.targetduration:2,n=this.fragmentTracker.getPartialFragment(a);if(e>0&&(e<=r||n)){this._trySkipBufferHole(n);return}}let f=self.performance.now();if(null===n){this.stalled=f;return}let p=f-n;if(!s&&p>=250&&(this._reportStall(u),!this.media))return;let m=tk.bufferInfo(r,a,i.maxBufferHole);this._tryFixBufferStall(m,p)}_tryFixBufferStall(e,t){let{config:i,fragmentTracker:r,media:n}=this;if(null===n)return;let a=n.currentTime,s=r.getPartialFragment(a);if(s){let e=this._trySkipBufferHole(s);if(e||!this.media)return}(e.len>i.maxBufferHole||e.nextStart&&e.nextStart-a<i.maxBufferHole)&&t>1e3*i.highBufferWatchdogPeriod&&(M.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}_reportStall(e){let{hls:t,media:i,stallReported:r}=this;if(!r&&i){this.stallReported=!0;let r=Error(`Playback stalling at @${i.currentTime} due to low buffer (${JSON.stringify(e)})`);M.warn(r.message),t.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.BUFFER_STALLED_ERROR,fatal:!1,error:r,buffer:e.len})}}_trySkipBufferHole(e){let{config:t,hls:i,media:r}=this;if(null===r)return 0;let n=r.currentTime,a=tk.bufferInfo(r,n,0),s=n<a.start?a.start:a.nextStart;if(s){let o=a.len<=t.maxBufferHole,l=a.len>0&&a.len<1&&r.readyState<3,u=s-n;if(u>0&&(o||l)){if(u>t.maxBufferHole){let{fragmentTracker:t}=this,i=!1;if(0===n){let e=t.getAppendedFrag(0,eq.MAIN);e&&s<e.end&&(i=!0)}if(!i){let i=e||t.getAppendedFrag(n,eq.MAIN);if(i){let e=!1,r=i.end;for(;r<s;){let i=t.getPartialFragment(r);if(i)r+=i.duration;else{e=!0;break}}if(e)return 0}}}let a=Math.max(s+.05,n+.1);if(M.warn(`skipping hole, adjusting currentTime from ${n} to ${a}`),this.moved=!0,this.stalled=null,r.currentTime=a,e&&!e.gap){let t=Error(`fragment loaded with buffer holes, seeking from ${n} to ${a}`);i.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.BUFFER_SEEK_OVER_HOLE,fatal:!1,error:t,reason:t.message,frag:e})}return a}}return 0}_tryNudgeBuffer(){let{config:e,hls:t,media:i,nudgeRetry:r}=this;if(null===i)return;let n=i.currentTime;if(this.nudgeRetry++,r<e.nudgeMaxRetry){let a=n+(r+1)*e.nudgeOffset,s=Error(`Nudging 'currentTime' from ${n} to ${a}`);M.warn(s.message),i.currentTime=a,t.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.BUFFER_NUDGE_ON_STALL,error:s,fatal:!1})}else{let i=Error(`Playhead still not moving while enough data buffered @${n} after ${e.nudgeMaxRetry} nudges`);M.error(i.message),t.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.BUFFER_STALLED_ERROR,error:i,fatal:!0})}}}class iO extends tW{constructor(e,t,i){super(e,t,i,"[stream-controller]",eq.MAIN),this.audioCodecSwap=!1,this.gapController=null,this.level=-1,this._forceStartLoad=!1,this.altAudio=!1,this.audioOnly=!1,this.fragPlaying=null,this.onvplaying=null,this.onvseeked=null,this.fragLastKbps=0,this.couldBacktrack=!1,this.backtrackFragment=null,this.audioCodecSwitch=!1,this.videoBuffer=null,this._registerListeners()}_registerListeners(){let{hls:e}=this;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.LEVEL_LOADING,this.onLevelLoading,this),e.on(E.LEVEL_LOADED,this.onLevelLoaded,this),e.on(E.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.on(E.ERROR,this.onError,this),e.on(E.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(E.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.on(E.BUFFER_CREATED,this.onBufferCreated,this),e.on(E.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.on(E.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.LEVEL_LOADED,this.onLevelLoaded,this),e.off(E.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),e.off(E.ERROR,this.onError,this),e.off(E.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(E.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),e.off(E.BUFFER_CREATED,this.onBufferCreated,this),e.off(E.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(E.LEVELS_UPDATED,this.onLevelsUpdated,this),e.off(E.FRAG_BUFFERED,this.onFragBuffered,this)}onHandlerDestroying(){this._unregisterListeners(),this.onMediaDetaching()}startLoad(e){if(this.levels){let{lastCurrentTime:t,hls:i}=this;if(this.stopLoad(),this.setInterval(100),this.level=-1,!this.startFragRequested){let e=i.startLevel;-1===e&&(i.config.testBandwidth&&this.levels.length>1?(e=0,this.bitrateTest=!0):e=i.nextAutoLevel),this.level=i.nextLoadLevel=e,this.loadedmetadata=!1}t>0&&-1===e&&(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t),this.state=tG.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}else this._forceStartLoad=!0,this.state=tG.STOPPED}stopLoad(){this._forceStartLoad=!1,super.stopLoad()}doTick(){var e,t;switch(this.state){case tG.WAITING_LEVEL:{let{levels:t,level:i}=this,r=null==t?void 0:null==(e=t[i])?void 0:e.details;if(r&&(!r.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(r))break;this.state=tG.IDLE}else this.hls.nextLoadLevel!==this.level&&(this.state=tG.IDLE);break}case tG.FRAG_LOADING_WAITING_RETRY:{let e=self.performance.now(),i=this.retryDate;(!i||e>=i||null!=(t=this.media)&&t.seeking)&&(this.resetStartWhenNotLoaded(this.level),this.state=tG.IDLE)}}this.state===tG.IDLE&&this.doTickIdle(),this.onTickEnd()}onTickEnd(){super.onTickEnd(),this.checkBuffer(),this.checkFragmentChanged()}doTickIdle(){let{hls:e,levelLastLoaded:t,levels:i,media:r}=this,{config:n,nextLoadLevel:a}=e;if(null===t||!r&&(this.startFragRequested||!n.startFragPrefetch)||this.altAudio&&this.audioOnly||!(null!=i&&i[a]))return;let s=i[a],o=this.getMainFwdBufferInfo();if(null===o)return;let l=this.getLevelDetails();if(l&&this._streamEnded(o,l)){let e={};this.altAudio&&(e.type="video"),this.hls.trigger(E.BUFFER_EOS,e),this.state=tG.ENDED;return}e.loadLevel!==a&&-1===e.manualLevel&&this.log(`Adapting to level ${a} from level ${this.level}`),this.level=e.nextLoadLevel=a;let u=s.details;if(!u||this.state===tG.WAITING_LEVEL||u.live&&this.levelLastLoaded!==a){this.level=a,this.state=tG.WAITING_LEVEL;return}let c=o.len,d=this.getMaxBufferLength(s.maxBitrate);if(c>=d)return;this.backtrackFragment&&this.backtrackFragment.start>o.end&&(this.backtrackFragment=null);let h=this.backtrackFragment?this.backtrackFragment.start:o.end,f=this.getNextFragment(h,u);if(this.couldBacktrack&&!this.fragPrevious&&f&&"initSegment"!==f.sn&&this.fragmentTracker.getState(f)!==tE.OK){var p;let e=(null!=(p=this.backtrackFragment)?p:f).sn,t=e-u.startSN,i=u.fragments[t-1];i&&f.cc===i.cc&&(f=i,this.fragmentTracker.removeFragment(i))}else this.backtrackFragment&&o.len&&(this.backtrackFragment=null);if(f&&this.isLoopLoading(f,h)){let e=f.gap;if(!e){let e=this.audioOnly&&!this.altAudio?D.AUDIO:D.VIDEO,t=(e===D.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;t&&this.afterBufferFlushed(t,e,eq.MAIN)}f=this.getNextFragmentLoopLoading(f,u,o,eq.MAIN,d)}f&&(!f.initSegment||f.initSegment.data||this.bitrateTest||(f=f.initSegment),this.loadFragment(f,s,h))}loadFragment(e,t,i){let r=this.fragmentTracker.getState(e);this.fragCurrent=e,r===tE.NOT_LOADED||r===tE.PARTIAL?"initSegment"===e.sn?this._loadInitSegment(e,t):this.bitrateTest?(this.log(`Fragment ${e.sn} of level ${e.level} is being downloaded to test bitrate and will not be buffered`),this._loadBitrateTestFrag(e,t)):(this.startFragRequested=!0,super.loadFragment(e,t,i)):this.clearTrackerIfNeeded(e)}getBufferedFrag(e){return this.fragmentTracker.getBufferedFrag(e,eq.MAIN)}followingBufferedFrag(e){return e?this.getBufferedFrag(e.end+.5):null}immediateLevelSwitch(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)}nextLevelSwitch(){let{levels:e,media:t}=this;if(null!=t&&t.readyState){let i;let r=this.getAppendedFrag(t.currentTime);r&&r.start>1&&this.flushMainBuffer(0,r.start-1);let n=this.getLevelDetails();if(null!=n&&n.live){let e=this.getMainFwdBufferInfo();if(!e||e.len<2*n.targetduration)return}if(!t.paused&&e){let t=this.hls.nextLoadLevel,r=e[t],n=this.fragLastKbps;i=n&&this.fragCurrent?this.fragCurrent.duration*r.maxBitrate/(1e3*n)+1:0}else i=0;let a=this.getBufferedFrag(t.currentTime+i);if(a){let e=this.followingBufferedFrag(a);if(e){this.abortCurrentFrag();let t=e.maxStartPTS?e.maxStartPTS:e.start,i=e.duration,r=Math.max(a.end,t+Math.min(Math.max(i-this.config.maxFragLookUpTolerance,.5*i),.75*i));this.flushMainBuffer(r,Number.POSITIVE_INFINITY)}}}}abortCurrentFrag(){let e=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,e&&(e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.state){case tG.KEY_LOADING:case tG.FRAG_LOADING:case tG.FRAG_LOADING_WAITING_RETRY:case tG.PARSING:case tG.PARSED:this.state=tG.IDLE}this.nextLoadPosition=this.getLoadPosition()}flushMainBuffer(e,t){super.flushMainBuffer(e,t,this.altAudio?"video":null)}onMediaAttached(e,t){super.onMediaAttached(e,t);let i=t.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),i.addEventListener("playing",this.onvplaying),i.addEventListener("seeked",this.onvseeked),this.gapController=new iP(this.config,i,this.fragmentTracker,this.hls)}onMediaDetaching(){let{media:e}=this;e&&this.onvplaying&&this.onvseeked&&(e.removeEventListener("playing",this.onvplaying),e.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),super.onMediaDetaching()}onMediaPlaying(){this.tick()}onMediaSeeked(){let e=this.media,t=e?e.currentTime:null;_(t)&&this.log(`Media seeked to ${t.toFixed(3)}`);let i=this.getMainFwdBufferInfo();if(null===i||0===i.len){this.warn(`Main forward buffer length on "seeked" event ${i?i.len:"empty"})`);return}this.tick()}onManifestLoading(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(E.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.levels=this.fragPlaying=this.backtrackFragment=null,this.altAudio=this.audioOnly=!1}onManifestParsed(e,t){let i,r=!1,n=!1;t.levels.forEach(e=>{(i=e.audioCodec)&&(-1!==i.indexOf("mp4a.40.2")&&(r=!0),-1!==i.indexOf("mp4a.40.5")&&(n=!0))}),this.audioCodecSwitch=r&&n&&!function(){var e;let t=t$();return"function"==typeof(null==t?void 0:null==(e=t.prototype)?void 0:e.changeType)}(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=t.levels,this.startFragRequested=!1}onLevelLoading(e,t){let{levels:i}=this;if(!i||this.state!==tG.IDLE)return;let r=i[t.level];(!r.details||r.details.live&&this.levelLastLoaded!==t.level||this.waitForCdnTuneIn(r.details))&&(this.state=tG.WAITING_LEVEL)}onLevelLoaded(e,t){var i;let{levels:r}=this,n=t.level,a=t.details,s=a.totalduration;if(!r){this.warn(`Levels were reset while loading level ${n}`);return}this.log(`Level ${n} loaded [${a.startSN},${a.endSN}]${a.lastPartSn?`[part-${a.lastPartSn}-${a.lastPartIndex}]`:""}, cc [${a.startCC}, ${a.endCC}] duration:${s}`);let o=r[n],l=this.fragCurrent;l&&(this.state===tG.FRAG_LOADING||this.state===tG.FRAG_LOADING_WAITING_RETRY)&&(l.level!==t.level||l.urlId!==o.urlId)&&l.loader&&this.abortCurrentFrag();let u=0;if(a.live||null!=(i=o.details)&&i.live){if(this.checkLiveUpdate(a),a.deltaUpdateFailed)return;u=this.alignPlaylists(a,o.details)}if(o.details=a,this.levelLastLoaded=n,this.hls.trigger(E.LEVEL_UPDATED,{details:a,level:n}),this.state===tG.WAITING_LEVEL){if(this.waitForCdnTuneIn(a))return;this.state=tG.IDLE}this.startFragRequested?a.live&&this.synchronizeToLiveEdge(a):this.setStartPosition(a,u),this.tick()}_handleFragmentLoadProgress(e){var t;let{frag:i,part:r,payload:n}=e,{levels:a}=this;if(!a){this.warn(`Levels were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}let s=a[i.level],o=s.details;if(!o){this.warn(`Dropping fragment ${i.sn} of level ${i.level} after level details were reset`),this.fragmentTracker.removeFragment(i);return}let l=s.videoCodec,u=o.PTSKnown||!o.live,c=null==(t=i.initSegment)?void 0:t.data,d=this._getAudioCodec(s),h=this.transmuxer=this.transmuxer||new iD(this.hls,eq.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),f=r?r.index:-1,p=-1!==f,m=new tD(i.level,i.sn,i.stats.chunkCount,n.byteLength,f,p),g=this.initPTS[i.cc];h.push(n,c,d,l,i,r,o.totalduration,u,m,g)}onAudioTrackSwitching(e,t){let i=this.altAudio,r=!!t.url;if(!r){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;let e=this.fragCurrent;e&&(this.log("Switching to main audio track, cancel main fragment load"),e.abortRequests(),this.fragmentTracker.removeFragment(e)),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();let e=this.hls;i&&(e.trigger(E.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:null}),this.fragmentTracker.removeAllFragments()),e.trigger(E.AUDIO_TRACK_SWITCHED,t)}}onAudioTrackSwitched(e,t){let i=t.id,r=!!this.hls.audioTracks[i].url;if(r){let e=this.videoBuffer;e&&this.mediaBuffer!==e&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=e)}this.altAudio=r,this.tick()}onBufferCreated(e,t){let i,r;let n=t.tracks,a=!1;for(let e in n){let t=n[e];if("main"===t.id){if(r=e,i=t,"video"===e){let t=n[e];t&&(this.videoBuffer=t.buffer)}}else a=!0}a&&i?(this.log(`Alternate track found, use ${r}.buffered to schedule main fragment loading`),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media}onFragBuffered(e,t){let{frag:i,part:r}=t;if(i&&i.type!==eq.MAIN)return;if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}`),this.state===tG.PARSED&&(this.state=tG.IDLE);return}let n=r?r.stats:i.stats;this.fragLastKbps=Math.round(8*n.total/(n.buffering.end-n.loading.first)),"initSegment"!==i.sn&&(this.fragPrevious=i),this.fragBufferedComplete(i,r)}onError(e,t){var i;if(t.fatal){this.state=tG.ERROR;return}switch(t.details){case x.FRAG_GAP:case x.FRAG_PARSING_ERROR:case x.FRAG_DECRYPT_ERROR:case x.FRAG_LOAD_ERROR:case x.FRAG_LOAD_TIMEOUT:case x.KEY_LOAD_ERROR:case x.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(eq.MAIN,t);break;case x.LEVEL_LOAD_ERROR:case x.LEVEL_LOAD_TIMEOUT:case x.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==tG.WAITING_LEVEL||(null==(i=t.context)?void 0:i.type)!==e$.LEVEL||(this.state=tG.IDLE);break;case x.BUFFER_FULL_ERROR:if(!t.parent||"main"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&this.flushMainBuffer(0,Number.POSITIVE_INFINITY);break;case x.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}checkBuffer(){let{media:e,gapController:t}=this;if(e&&t&&e.readyState){if(this.loadedmetadata||!tk.getBuffered(e).length){let e=this.state!==tG.IDLE?this.fragCurrent:null;t.poll(this.lastCurrentTime,e)}this.lastCurrentTime=e.currentTime}}onFragLoadEmergencyAborted(){this.state=tG.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()}onBufferFlushed(e,{type:t}){if(t!==D.AUDIO||this.audioOnly&&!this.altAudio){let e=(t===D.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(e,t,eq.MAIN)}}onLevelsUpdated(e,t){this.levels=t.levels}swapAudioCodec(){this.audioCodecSwap=!this.audioCodecSwap}seekToStartPos(){let{media:e}=this;if(!e)return;let t=e.currentTime,i=this.startPosition;if(i>=0&&t<i){if(e.seeking){this.log(`could not seek to ${i}, already seeking at ${t}`);return}let r=tk.getBuffered(e),n=r.length?r.start(0):0,a=n-i;a>0&&(a<this.config.maxBufferHole||a<this.config.maxFragLookUpTolerance)&&(this.log(`adjusting start position by ${a} to match buffer start`),i+=a,this.startPosition=i),this.log(`seek to target start position ${i} from current time ${t}`),e.currentTime=i}}_getAudioCodec(e){let t=this.config.defaultAudioCodec||e.audioCodec;return this.audioCodecSwap&&t&&(this.log("Swapping audio codec"),t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),t}_loadBitrateTestFrag(e,t){e.bitrateTest=!0,this._doFragLoad(e,t).then(i=>{let{hls:r}=this;if(!i||this.fragContextChanged(e))return;t.fragmentError=0,this.state=tG.IDLE,this.startFragRequested=!1,this.bitrateTest=!1;let n=e.stats;n.parsing.start=n.parsing.end=n.buffering.start=n.buffering.end=self.performance.now(),r.trigger(E.FRAG_LOADED,i),e.bitrateTest=!1})}_handleTransmuxComplete(e){var t;let i="main",{hls:r}=this,{remuxResult:n,chunkMeta:a}=e,s=this.getCurrentContext(a);if(!s){this.resetWhenMissingContext(a);return}let{frag:o,part:l,level:u}=s,{video:c,text:d,id3:h,initSegment:f}=n,{details:p}=u,m=this.altAudio?void 0:n.audio;if(this.fragContextChanged(o)){this.fragmentTracker.removeFragment(o);return}if(this.state=tG.PARSING,f){if(null!=f&&f.tracks){let e=o.initSegment||o;this._bufferInitSegment(u,f.tracks,e,a),r.trigger(E.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:i,tracks:f.tracks})}let e=f.initPTS,t=f.timescale;_(e)&&(this.initPTS[o.cc]={baseTime:e,timescale:t},r.trigger(E.INIT_PTS_FOUND,{frag:o,id:i,initPTS:e,timescale:t}))}if(c&&p&&"initSegment"!==o.sn){let e=p.fragments[o.sn-1-p.startSN],t=o.sn===p.startSN,i=!e||o.cc>e.cc;if(!1!==n.independent){let{startPTS:e,endPTS:r,startDTS:n,endDTS:s}=c;if(l)l.elementaryStreams[c.type]={startPTS:e,endPTS:r,startDTS:n,endDTS:s};else if(c.firstKeyFrame&&c.independent&&1===a.id&&!i&&(this.couldBacktrack=!0),c.dropped&&c.independent){let n=this.getMainFwdBufferInfo(),a=(n?n.end:this.getLoadPosition())+this.config.maxBufferHole,l=c.firstKeyFramePTS?c.firstKeyFramePTS:e;if(t||!(a<l-this.config.maxBufferHole)||i)i&&(o.gap=!0);else{this.backtrack(o);return}o.setElementaryStreamInfo(c.type,o.start,r,o.start,s,!0)}o.setElementaryStreamInfo(c.type,e,r,n,s),this.backtrackFragment&&(this.backtrackFragment=o),this.bufferFragmentData(c,o,l,a,t||i)}else if(t||i)o.gap=!0;else{this.backtrack(o);return}}if(m){let{startPTS:e,endPTS:t,startDTS:i,endDTS:r}=m;l&&(l.elementaryStreams[D.AUDIO]={startPTS:e,endPTS:t,startDTS:i,endDTS:r}),o.setElementaryStreamInfo(D.AUDIO,e,t,i,r),this.bufferFragmentData(m,o,l,a)}if(p&&null!=h&&null!=(t=h.samples)&&t.length){let e={id:i,frag:o,details:p,samples:h.samples};r.trigger(E.FRAG_PARSING_METADATA,e)}if(p&&d){let e={id:i,frag:o,details:p,samples:d.samples};r.trigger(E.FRAG_PARSING_USERDATA,e)}}_bufferInitSegment(e,t,i,r){if(this.state!==tG.PARSING)return;this.audioOnly=!!t.audio&&!t.video,this.altAudio&&!this.audioOnly&&delete t.audio;let{audio:n,video:a,audiovideo:s}=t;if(n){let t=e.audioCodec,i=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(t&&(t=-1!==t.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),1!==n.metadata.channelCount&&-1===i.indexOf("firefox")&&(t="mp4a.40.5")),-1!==i.indexOf("android")&&"audio/mpeg"!==n.container&&(t="mp4a.40.2",this.log(`Android: force audio codec to ${t}`)),e.audioCodec&&e.audioCodec!==t&&this.log(`Swapping manifest audio codec "${e.audioCodec}" for "${t}"`),n.levelCodec=t,n.id="main",this.log(`Init audio buffer, container:${n.container}, codecs[selected/level/parsed]=[${t||""}/${e.audioCodec||""}/${n.codec}]`)}a&&(a.levelCodec=e.videoCodec,a.id="main",this.log(`Init video buffer, container:${a.container}, codecs[level/parsed]=[${e.videoCodec||""}/${a.codec}]`)),s&&this.log(`Init audiovideo buffer, container:${s.container}, codecs[level/parsed]=[${e.attrs.CODECS||""}/${s.codec}]`),this.hls.trigger(E.BUFFER_CODECS,t),Object.keys(t).forEach(e=>{let n=t[e],a=n.initSegment;null!=a&&a.byteLength&&this.hls.trigger(E.BUFFER_APPENDING,{type:e,data:a,frag:i,part:null,chunkMeta:r,parent:i.type})}),this.tick()}getMainFwdBufferInfo(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,eq.MAIN)}backtrack(e){this.couldBacktrack=!0,this.backtrackFragment=e,this.resetTransmuxer(),this.flushBufferGap(e),this.fragmentTracker.removeFragment(e),this.fragPrevious=null,this.nextLoadPosition=e.start,this.state=tG.IDLE}checkFragmentChanged(){let e=this.media,t=null;if(e&&e.readyState>1&&!1===e.seeking){let i=e.currentTime;if(tk.isBuffered(e,i)?t=this.getAppendedFrag(i):tk.isBuffered(e,i+.1)&&(t=this.getAppendedFrag(i+.1)),t){this.backtrackFragment=null;let e=this.fragPlaying,i=t.level;e&&t.sn===e.sn&&e.level===i&&t.urlId===e.urlId||(this.fragPlaying=t,this.hls.trigger(E.FRAG_CHANGED,{frag:t}),e&&e.level===i||this.hls.trigger(E.LEVEL_SWITCHED,{level:i}))}}}get nextLevel(){let e=this.nextBufferedFrag;return e?e.level:-1}get currentFrag(){let e=this.media;return e?this.fragPlaying||this.getAppendedFrag(e.currentTime):null}get currentProgramDateTime(){let e=this.media;if(e){let t=e.currentTime,i=this.currentFrag;if(i&&_(t)&&_(i.programDateTime)){let e=i.programDateTime+(t-i.start)*1e3;return new Date(e)}}return null}get currentLevel(){let e=this.currentFrag;return e?e.level:-1}get nextBufferedFrag(){let e=this.currentFrag;return e?this.followingBufferedFrag(e):null}get forceStartLoad(){return this._forceStartLoad}}class iN{constructor(e,t=0,i=0){this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=e,this.alpha_=e?Math.exp(Math.log(.5)/e):0,this.estimate_=t,this.totalWeight_=i}sample(e,t){let i=Math.pow(this.alpha_,e);this.estimate_=t*(1-i)+i*this.estimate_,this.totalWeight_+=e}getTotalWeight(){return this.totalWeight_}getEstimate(){if(this.alpha_){let e=1-Math.pow(this.alpha_,this.totalWeight_);if(e)return this.estimate_/e}return this.estimate_}}class iU{constructor(e,t,i,r=100){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultTTFB_=void 0,this.ttfb_=void 0,this.defaultEstimate_=i,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new iN(e),this.fast_=new iN(t),this.defaultTTFB_=r,this.ttfb_=new iN(e)}update(e,t){let{slow_:i,fast_:r,ttfb_:n}=this;i.halfLife!==e&&(this.slow_=new iN(e,i.getEstimate(),i.getTotalWeight())),r.halfLife!==t&&(this.fast_=new iN(t,r.getEstimate(),r.getTotalWeight())),n.halfLife!==e&&(this.ttfb_=new iN(e,n.getEstimate(),n.getTotalWeight()))}sample(e,t){e=Math.max(e,this.minDelayMs_);let i=e/1e3,r=8*t/i;this.fast_.sample(i,r),this.slow_.sample(i,r)}sampleTTFB(e){this.ttfb_.sample(Math.sqrt(2)*Math.exp(-Math.pow(e/1e3,2)/2),Math.max(e,5))}canEstimate(){return this.fast_.getTotalWeight()>=this.minWeight_}getEstimate(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_}getEstimateTTFB(){return this.ttfb_.getTotalWeight()>=this.minWeight_?this.ttfb_.getEstimate():this.defaultTTFB_}destroy(){}}class iF{constructor(){this.chunks=[],this.dataLength=0}push(e){this.chunks.push(e),this.dataLength+=e.length}flush(){let e;let{chunks:t,dataLength:i}=this;return t.length?(e=1===t.length?t[0]:function(e,t){let i=new Uint8Array(t),r=0;for(let t=0;t<e.length;t++){let n=e[t];i.set(n,r),r+=n.length}return i}(t,i),this.reset(),e):new Uint8Array(0)}reset(){this.chunks.length=0,this.dataLength=0}}function iB(e,t){if(e.length!==t.length)return!1;for(let i=0;i<e.length;i++)if(!function(e,t){let i=e["STABLE-RENDITION-ID"];return i?i===t["STABLE-RENDITION-ID"]:!["LANGUAGE","NAME","CHARACTERISTICS","AUTOSELECT","DEFAULT","FORCED"].some(i=>e[i]!==t[i])}(e[i].attrs,t[i].attrs))return!1;return!0}class iV{constructor(e){this.buffered=void 0;let t=(t,i,r)=>{if((i>>>=0)>r-1)throw new DOMException(`Failed to execute '${t}' on 'TimeRanges': The index provided (${i}) is greater than the maximum bound (${r})`);return e[i][t]};this.buffered={get length(){return e.length},end:i=>t("end",i,e.length),start:i=>t("start",i,e.length)}}}function iz(e){let t=[];for(let i=0;i<e.length;i++){let r=e[i];("subtitles"===r.kind||"captions"===r.kind)&&r.label&&t.push(e[i])}return t}class ij{constructor(e){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=e}append(e,t){let i=this.queues[t];i.push(e),1===i.length&&this.buffers[t]&&this.executeNext(t)}insertAbort(e,t){let i=this.queues[t];i.unshift(e),this.executeNext(t)}appendBlocker(e){let t;let i=new Promise(e=>{t=e}),r={execute:t,onStart:()=>{},onComplete:()=>{},onError:()=>{}};return this.append(r,e),i}executeNext(e){let{buffers:t,queues:i}=this,r=t[e],n=i[e];if(n.length){let t=n[0];try{t.execute()}catch(i){M.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),t.onError(i),null!=r&&r.updating||(n.shift(),this.executeNext(e))}}}shiftAndExecuteNext(e){this.queues[e].shift(),this.executeNext(e)}current(e){return this.queues[e][0]}}let iH=eI(),iG=/([ha]vc.)(?:\.[^.,]+)+/,iW={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},i$=function(e){let t=e;return iW.hasOwnProperty(e)&&(t=iW[e]),String.fromCharCode(t)},iq={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},iY={17:2,18:4,21:6,22:8,23:10,19:13,20:15},iK={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},iX={25:2,26:4,29:6,30:8,31:10,27:13,28:15},iZ=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];class iJ{constructor(){this.time=null,this.verboseLevel=0}log(e,t){if(this.verboseLevel>=e){let i="function"==typeof t?t():t;M.log(`${this.time} [${e}] ${i}`)}}}let iQ=function(e){let t=[];for(let i=0;i<e.length;i++)t.push(e[i].toString(16));return t};class i0{constructor(e,t,i,r,n){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=e||"white",this.underline=t||!1,this.italics=i||!1,this.background=r||"black",this.flash=n||!1}reset(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1}setStyles(e){let t=["foreground","underline","italics","background","flash"];for(let i=0;i<t.length;i++){let r=t[i];e.hasOwnProperty(r)&&(this[r]=e[r])}}isDefault(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash}equals(e){return this.foreground===e.foreground&&this.underline===e.underline&&this.italics===e.italics&&this.background===e.background&&this.flash===e.flash}copy(e){this.foreground=e.foreground,this.underline=e.underline,this.italics=e.italics,this.background=e.background,this.flash=e.flash}toString(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}}class i1{constructor(e,t,i,r,n,a){this.uchar=void 0,this.penState=void 0,this.uchar=e||" ",this.penState=new i0(t,i,r,n,a)}reset(){this.uchar=" ",this.penState.reset()}setChar(e,t){this.uchar=e,this.penState.copy(t)}setPenState(e){this.penState.copy(e)}equals(e){return this.uchar===e.uchar&&this.penState.equals(e.penState)}copy(e){this.uchar=e.uchar,this.penState.copy(e.penState)}isEmpty(){return" "===this.uchar&&this.penState.isDefault()}}class i2{constructor(e){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(let e=0;e<100;e++)this.chars.push(new i1);this.logger=e,this.pos=0,this.currPenState=new i0}equals(e){let t=!0;for(let i=0;i<100;i++)if(!this.chars[i].equals(e.chars[i])){t=!1;break}return t}copy(e){for(let t=0;t<100;t++)this.chars[t].copy(e.chars[t])}isEmpty(){let e=!0;for(let t=0;t<100;t++)if(!this.chars[t].isEmpty()){e=!1;break}return e}setCursor(e){this.pos!==e&&(this.pos=e),this.pos<0?(this.logger.log(3,"Negative cursor position "+this.pos),this.pos=0):this.pos>100&&(this.logger.log(3,"Too large cursor position "+this.pos),this.pos=100)}moveCursor(e){let t=this.pos+e;if(e>1)for(let e=this.pos+1;e<t+1;e++)this.chars[e].setPenState(this.currPenState);this.setCursor(t)}backSpace(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)}insertChar(e){e>=144&&this.backSpace();let t=i$(e);if(this.pos>=100){this.logger.log(0,()=>"Cannot insert "+e.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1)}clearFromPos(e){let t;for(t=e;t<100;t++)this.chars[t].reset()}clear(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()}clearToEndOfRow(){this.clearFromPos(this.pos)}getTextString(){let e=[],t=!0;for(let i=0;i<100;i++){let r=this.chars[i].uchar;" "!==r&&(t=!1),e.push(r)}return t?"":e.join("")}setPenStyles(e){this.currPenState.setStyles(e);let t=this.chars[this.pos];t.setPenState(this.currPenState)}}class i3{constructor(e){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(let t=0;t<15;t++)this.rows.push(new i2(e));this.logger=e,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}reset(){for(let e=0;e<15;e++)this.rows[e].clear();this.currRow=14}equals(e){let t=!0;for(let i=0;i<15;i++)if(!this.rows[i].equals(e.rows[i])){t=!1;break}return t}copy(e){for(let t=0;t<15;t++)this.rows[t].copy(e.rows[t])}isEmpty(){let e=!0;for(let t=0;t<15;t++)if(!this.rows[t].isEmpty()){e=!1;break}return e}backSpace(){let e=this.rows[this.currRow];e.backSpace()}clearToEndOfRow(){let e=this.rows[this.currRow];e.clearToEndOfRow()}insertChar(e){let t=this.rows[this.currRow];t.insertChar(e)}setPen(e){let t=this.rows[this.currRow];t.setPenStyles(e)}moveCursor(e){let t=this.rows[this.currRow];t.moveCursor(e)}setCursor(e){this.logger.log(2,"setCursor: "+e);let t=this.rows[this.currRow];t.setCursor(e)}setPAC(e){this.logger.log(2,()=>"pacData = "+JSON.stringify(e));let t=e.row-1;if(this.nrRollUpRows&&t<this.nrRollUpRows-1&&(t=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==t){for(let e=0;e<15;e++)this.rows[e].clear();let e=this.currRow+1-this.nrRollUpRows,i=this.lastOutputScreen;if(i){let r=i.rows[e].cueStartTime,n=this.logger.time;if(r&&null!==n&&r<n)for(let r=0;r<this.nrRollUpRows;r++)this.rows[t-this.nrRollUpRows+r+1].copy(i.rows[e+r])}}this.currRow=t;let i=this.rows[this.currRow];if(null!==e.indent){let t=e.indent;i.setCursor(e.indent),e.color=i.chars[Math.max(t-1,0)].penState.foreground}let r={foreground:e.color,underline:e.underline,italics:e.italics,background:"black",flash:!1};this.setPen(r)}setBkgData(e){this.logger.log(2,()=>"bkgData = "+JSON.stringify(e)),this.backSpace(),this.setPen(e),this.insertChar(32)}setRollUpRows(e){this.nrRollUpRows=e}rollUp(){if(null===this.nrRollUpRows){this.logger.log(3,"roll_up but nrRollUpRows not set yet");return}this.logger.log(1,()=>this.getDisplayText());let e=this.currRow+1-this.nrRollUpRows,t=this.rows.splice(e,1)[0];t.clear(),this.rows.splice(this.currRow,0,t),this.logger.log(2,"Rolling up")}getDisplayText(e){e=e||!1;let t=[],i="",r=-1;for(let i=0;i<15;i++){let n=this.rows[i].getTextString();n&&(r=i+1,e?t.push("Row "+r+": '"+n+"'"):t.push(n.trim()))}return t.length>0&&(i=e?"["+t.join(" | ")+"]":t.join("\n")),i}getTextAndFormat(){return this.rows}}class i5{constructor(e,t,i){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=e,this.outputFilter=t,this.mode=null,this.verbose=0,this.displayedMemory=new i3(i),this.nonDisplayedMemory=new i3(i),this.lastOutputScreen=new i3(i),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=i}reset(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null}getHandler(){return this.outputFilter}setHandler(e){this.outputFilter=e}setPAC(e){this.writeScreen.setPAC(e)}setBkgData(e){this.writeScreen.setBkgData(e)}setMode(e){e!==this.mode&&(this.mode=e,this.logger.log(2,()=>"MODE="+e),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=e)}insertChars(e){for(let t=0;t<e.length;t++)this.writeScreen.insertChar(e[t]);let t=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(2,()=>t+": "+this.writeScreen.getDisplayText(!0)),("MODE_PAINT-ON"===this.mode||"MODE_ROLL-UP"===this.mode)&&(this.logger.log(1,()=>"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())}ccRCL(){this.logger.log(2,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")}ccBS(){this.logger.log(2,"BS - BackSpace"),"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())}ccAOF(){}ccAON(){}ccDER(){this.logger.log(2,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()}ccRU(e){this.logger.log(2,"RU("+e+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(e)}ccFON(){this.logger.log(2,"FON - Flash On"),this.writeScreen.setPen({flash:!0})}ccRDC(){this.logger.log(2,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")}ccTR(){this.logger.log(2,"TR"),this.setMode("MODE_TEXT")}ccRTD(){this.logger.log(2,"RTD"),this.setMode("MODE_TEXT")}ccEDM(){this.logger.log(2,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)}ccCR(){this.logger.log(2,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)}ccENM(){this.logger.log(2,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()}ccEOC(){if(this.logger.log(2,"EOC - End Of Caption"),"MODE_POP-ON"===this.mode){let e=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=e,this.writeScreen=this.nonDisplayedMemory,this.logger.log(1,()=>"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)}ccTO(e){this.logger.log(2,"TO("+e+") - Tab Offset"),this.writeScreen.moveCursor(e)}ccMIDROW(e){let t={flash:!1};t.underline=e%2==1,t.italics=e>=46,t.italics?t.foreground="white":t.foreground=["white","green","blue","cyan","red","yellow","magenta"][Math.floor(e/2)-16],this.logger.log(2,"MIDROW: "+JSON.stringify(t)),this.writeScreen.setPen(t)}outputDataUpdate(e=!1){let t=this.logger.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),e&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))}cueSplitAtTime(e){this.outputFilter&&!this.displayedMemory.isEmpty()&&(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,e,this.displayedMemory),this.cueStartTime=e)}}class i4{constructor(e,t,i){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;let r=new iJ;this.channels=[null,new i5(e,t,r),new i5(e+1,i,r)],this.cmdHistory=i7(),this.logger=r}getHandler(e){return this.channels[e].getHandler()}setHandler(e,t){this.channels[e].setHandler(t)}addData(e,t){let i,r,n;let a=!1;this.logger.time=e;for(let e=0;e<t.length;e+=2)if(r=127&t[e],n=127&t[e+1],0!==r||0!==n){if(this.logger.log(3,"["+iQ([t[e],t[e+1]])+"] -> ("+iQ([r,n])+")"),(i=this.parseCmd(r,n))||(i=this.parseMidrow(r,n)),i||(i=this.parsePAC(r,n)),i||(i=this.parseBackgroundAttributes(r,n)),!i&&(a=this.parseChars(r,n))){let e=this.currentChannel;if(e&&e>0){let t=this.channels[e];t.insertChars(a)}else this.logger.log(2,"No channel found yet. TEXT-MODE?")}i||a||this.logger.log(2,"Couldn't parse cleaned data "+iQ([r,n])+" orig: "+iQ([t[e],t[e+1]]))}}parseCmd(e,t){let{cmdHistory:i}=this,r=(20===e||28===e||21===e||29===e)&&t>=32&&t<=47,n=(23===e||31===e)&&t>=33&&t<=35;if(!(r||n))return!1;if(i8(e,t,i))return i6(null,null,i),this.logger.log(3,"Repeated command ("+iQ([e,t])+") is dropped"),!0;let a=20===e||21===e||23===e?1:2,s=this.channels[a];return 20===e||21===e||28===e||29===e?32===t?s.ccRCL():33===t?s.ccBS():34===t?s.ccAOF():35===t?s.ccAON():36===t?s.ccDER():37===t?s.ccRU(2):38===t?s.ccRU(3):39===t?s.ccRU(4):40===t?s.ccFON():41===t?s.ccRDC():42===t?s.ccTR():43===t?s.ccRTD():44===t?s.ccEDM():45===t?s.ccCR():46===t?s.ccENM():47===t&&s.ccEOC():s.ccTO(t-32),i6(e,t,i),this.currentChannel=a,!0}parseMidrow(e,t){let i=0;if((17===e||25===e)&&t>=32&&t<=47){if((i=17===e?1:2)!==this.currentChannel)return this.logger.log(0,"Mismatch channel in midrow parsing"),!1;let r=this.channels[i];return!!r&&(r.ccMIDROW(t),this.logger.log(3,"MIDROW ("+iQ([e,t])+")"),!0)}return!1}parsePAC(e,t){let i;let r=this.cmdHistory,n=(e>=17&&e<=23||e>=25&&e<=31)&&t>=64&&t<=127,a=(16===e||24===e)&&t>=64&&t<=95;if(!(n||a))return!1;if(i8(e,t,r))return i6(null,null,r),!0;let s=e<=23?1:2;i=t>=64&&t<=95?1===s?iq[e]:iK[e]:1===s?iY[e]:iX[e];let o=this.channels[s];return!!o&&(o.setPAC(this.interpretPAC(i,t)),i6(e,t,r),this.currentChannel=s,!0)}interpretPAC(e,t){let i;let r={color:null,italics:!1,indent:null,underline:!1,row:e};return i=t>95?t-96:t-64,r.underline=(1&i)==1,i<=13?r.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(r.italics=!0,r.color="white"):r.indent=4*Math.floor((i-16)/2),r}parseChars(e,t){let i;let r=null,n=null;if(e>=25?(i=2,n=e-8):(i=1,n=e),n>=17&&n<=19){let e;e=17===n?t+80:18===n?t+112:t+144,this.logger.log(2,"Special char '"+i$(e)+"' in channel "+i),r=[e]}else e>=32&&e<=127&&(r=0===t?[e]:[e,t]);if(r){let i=iQ(r);this.logger.log(3,"Char codes =  "+i.join(",")),i6(e,t,this.cmdHistory)}return r}parseBackgroundAttributes(e,t){let i;let r=(16===e||24===e)&&t>=32&&t<=47,n=(23===e||31===e)&&t>=45&&t<=47;if(!(r||n))return!1;let a={};16===e||24===e?(i=Math.floor((t-32)/2),a.background=iZ[i],t%2==1&&(a.background=a.background+"_semi")):45===t?a.background="transparent":(a.foreground="black",47===t&&(a.underline=!0));let s=e<=23?1:2,o=this.channels[s];return o.setBkgData(a),i6(e,t,this.cmdHistory),!0}reset(){for(let e=0;e<Object.keys(this.channels).length;e++){let t=this.channels[e];t&&t.reset()}this.cmdHistory=i7()}cueSplitAtTime(e){for(let t=0;t<this.channels.length;t++){let i=this.channels[t];i&&i.cueSplitAtTime(e)}}}function i6(e,t,i){i.a=e,i.b=t}function i8(e,t,i){return i.a===e&&i.b===t}function i7(){return{a:null,b:null}}class i9{constructor(e,t){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=e,this.trackName=t}dispatchCue(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)}newCue(e,t,i){(null===this.startTime||this.startTime>e)&&(this.startTime=e),this.endTime=t,this.screen=i,this.timelineController.createCaptionsTrack(this.trackName)}reset(){this.cueRanges=[],this.startTime=null}}var re=function(){if("undefined"!=typeof self&&self.VTTCue)return self.VTTCue;let e=["","lr","rl"],t=["start","middle","end","left","right"];function i(e,t){if("string"!=typeof t||!Array.isArray(e))return!1;let i=t.toLowerCase();return!!~e.indexOf(i)&&i}function r(e,...t){let i=1;for(;i<arguments.length;i++){let t=arguments[i];for(let i in t)e[i]=t[i]}return e}function n(n,a,s){let o={enumerable:!0};this.hasBeenReset=!1;let l="",u=!1,c=n,d=a,h=s,f=null,p="",m=!0,g="auto",v="start",y=50,b="middle",_=50,E="middle";Object.defineProperty(this,"id",r({},o,{get:function(){return l},set:function(e){l=""+e}})),Object.defineProperty(this,"pauseOnExit",r({},o,{get:function(){return u},set:function(e){u=!!e}})),Object.defineProperty(this,"startTime",r({},o,{get:function(){return c},set:function(e){if("number"!=typeof e)throw TypeError("Start time must be set to a number.");c=e,this.hasBeenReset=!0}})),Object.defineProperty(this,"endTime",r({},o,{get:function(){return d},set:function(e){if("number"!=typeof e)throw TypeError("End time must be set to a number.");d=e,this.hasBeenReset=!0}})),Object.defineProperty(this,"text",r({},o,{get:function(){return h},set:function(e){h=""+e,this.hasBeenReset=!0}})),Object.defineProperty(this,"region",r({},o,{get:function(){return f},set:function(e){f=e,this.hasBeenReset=!0}})),Object.defineProperty(this,"vertical",r({},o,{get:function(){return p},set:function(t){let r=i(e,t);if(!1===r)throw SyntaxError("An invalid or illegal string was specified.");p=r,this.hasBeenReset=!0}})),Object.defineProperty(this,"snapToLines",r({},o,{get:function(){return m},set:function(e){m=!!e,this.hasBeenReset=!0}})),Object.defineProperty(this,"line",r({},o,{get:function(){return g},set:function(e){if("number"!=typeof e&&"auto"!==e)throw SyntaxError("An invalid number or illegal string was specified.");g=e,this.hasBeenReset=!0}})),Object.defineProperty(this,"lineAlign",r({},o,{get:function(){return v},set:function(e){let r=i(t,e);if(!r)throw SyntaxError("An invalid or illegal string was specified.");v=r,this.hasBeenReset=!0}})),Object.defineProperty(this,"position",r({},o,{get:function(){return y},set:function(e){if(e<0||e>100)throw Error("Position must be between 0 and 100.");y=e,this.hasBeenReset=!0}})),Object.defineProperty(this,"positionAlign",r({},o,{get:function(){return b},set:function(e){let r=i(t,e);if(!r)throw SyntaxError("An invalid or illegal string was specified.");b=r,this.hasBeenReset=!0}})),Object.defineProperty(this,"size",r({},o,{get:function(){return _},set:function(e){if(e<0||e>100)throw Error("Size must be between 0 and 100.");_=e,this.hasBeenReset=!0}})),Object.defineProperty(this,"align",r({},o,{get:function(){return E},set:function(e){let r=i(t,e);if(!r)throw SyntaxError("An invalid or illegal string was specified.");E=r,this.hasBeenReset=!0}})),this.displayState=void 0}return n.prototype.getCueAsHTML=function(){let e=self.WebVTT;return e.convertCueToDOMTree(self,this.text)},n}();class rt{decode(e,t){if(!e)return"";if("string"!=typeof e)throw Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(e))}}function ri(e){function t(e,t,i,r){return(0|e)*3600+(0|t)*60+(0|i)+parseFloat(r||0)}let i=e.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return i?parseFloat(i[2])>59?t(i[2],i[3],0,i[4]):t(i[1],i[2],i[3],i[4]):null}class rr{constructor(){this.values=Object.create(null)}set(e,t){this.get(e)||""===t||(this.values[e]=t)}get(e,t,i){return i?this.has(e)?this.values[e]:t[i]:this.has(e)?this.values[e]:t}has(e){return e in this.values}alt(e,t,i){for(let r=0;r<i.length;++r)if(t===i[r]){this.set(e,t);break}}integer(e,t){/^-?\d+$/.test(t)&&this.set(e,parseInt(t,10))}percent(e,t){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(t)){let i=parseFloat(t);if(i>=0&&i<=100)return this.set(e,i),!0}return!1}}function rn(e,t,i,r){let n=r?e.split(r):[e];for(let e in n){if("string"!=typeof n[e])continue;let r=n[e].split(i);if(2!==r.length)continue;let a=r[0],s=r[1];t(a,s)}}let ra=new re(0,0,""),rs="middle"===ra.align?"middle":"center";function ro(e){return e.replace(/<br(?: \/)?>/gi,"\n")}class rl{constructor(){this.state="INITIAL",this.buffer="",this.decoder=new rt,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}parse(e){let t=this;function i(){let e=t.buffer,i=0;for(e=ro(e);i<e.length&&"\r"!==e[i]&&"\n"!==e[i];)++i;let r=e.slice(0,i);return"\r"===e[i]&&++i,"\n"===e[i]&&++i,t.buffer=e.slice(i),r}e&&(t.buffer+=t.decoder.decode(e,{stream:!0}));try{let e="";if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;e=i();let r=e.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!(null!=r&&r[0]))throw Error("Malformed WebVTT signature.");t.state="HEADER"}let n=!1;for(;t.buffer&&/\r\n|\n/.test(t.buffer);)switch(n?n=!1:e=i(),t.state){case"HEADER":if(/:/.test(e)){var r;r=e,rn(r,function(e,t){},/:/)}else e||(t.state="ID");continue;case"NOTE":e||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(e)){t.state="NOTE";break}if(!e)continue;if(t.cue=new re(0,0,""),t.state="CUE",-1===e.indexOf("-->")){t.cue.id=e;continue}case"CUE":if(!t.cue){t.state="BADCUE";continue}try{!function(e,t,i){let r=e;function n(){let t=ri(e);if(null===t)throw Error("Malformed timestamp: "+r);return e=e.replace(/^[^\sa-zA-Z-]+/,""),t}function a(){e=e.replace(/^\s+/,"")}if(a(),t.startTime=n(),a(),"-->"!==e.slice(0,3))throw Error("Malformed time stamp (time stamps must be separated by '-->'): "+r);e=e.slice(3),a(),t.endTime=n(),a(),function(e,t){let r=new rr;rn(e,function(e,t){let n;switch(e){case"region":for(let n=i.length-1;n>=0;n--)if(i[n].id===t){r.set(e,i[n].region);break}break;case"vertical":r.alt(e,t,["rl","lr"]);break;case"line":n=t.split(","),r.integer(e,n[0]),r.percent(e,n[0])&&r.set("snapToLines",!1),r.alt(e,n[0],["auto"]),2===n.length&&r.alt("lineAlign",n[1],["start",rs,"end"]);break;case"position":n=t.split(","),r.percent(e,n[0]),2===n.length&&r.alt("positionAlign",n[1],["start",rs,"end","line-left","line-right","auto"]);break;case"size":r.percent(e,t);break;case"align":r.alt(e,t,["start",rs,"end","left","right"])}},/:/,/\s/),t.region=r.get("region",null),t.vertical=r.get("vertical","");let n=r.get("line","auto");"auto"===n&&-1===ra.line&&(n=-1),t.line=n,t.lineAlign=r.get("lineAlign","start"),t.snapToLines=r.get("snapToLines",!0),t.size=r.get("size",100),t.align=r.get("align",rs);let a=r.get("position","auto");"auto"===a&&50===ra.position&&(a="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50),t.position=a}(e,t)}(e,t.cue,t.regionList)}catch(e){t.cue=null,t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":{let i=-1!==e.indexOf("-->");if(!e||i&&(n=!0)){t.oncue&&t.cue&&t.oncue(t.cue),t.cue=null,t.state="ID";continue}if(null===t.cue)continue;t.cue.text&&(t.cue.text+="\n"),t.cue.text+=e}continue;case"BADCUE":e||(t.state="ID")}}catch(e){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue),t.cue=null,t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this}flush(){try{if((this.cue||"HEADER"===this.state)&&(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state||"BADWEBVTT"===this.state)throw Error("Malformed WebVTT signature.")}catch(e){this.onparsingerror&&this.onparsingerror(e)}return this.onflush&&this.onflush(),this}}let ru=/\r\n|\n\r|\n|\r/g,rc=function(e,t,i=0){return e.slice(i,i+t.length)===t},rd=function(e){let t=parseInt(e.slice(-3)),i=parseInt(e.slice(-6,-4)),r=parseInt(e.slice(-9,-7)),n=e.length>9?parseInt(e.substring(0,e.indexOf(":"))):0;if(!_(t)||!_(i)||!_(r)||!_(n))throw Error(`Malformed X-TIMESTAMP-MAP: Local:${e}`);return t+(1e3*i+6e4*r+36e5*n)},rh=function(e){let t=5381,i=e.length;for(;i;)t=33*t^e.charCodeAt(--i);return(t>>>0).toString()};function rf(e,t,i){return rh(e.toString())+rh(t.toString())+rh(i)}let rp=function(e,t,i){let r=e[t],n=e[r.prevCC];if(!n||!n.new&&r.new){e.ccOffset=e.presentationOffset=r.start,r.new=!1;return}for(;null!=(a=n)&&a.new;){var a;e.ccOffset+=r.start-n.start,r.new=!1,n=e[(r=n).prevCC]}e.presentationOffset=i},rm="stpp.ttml.im1t",rg=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,rv=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,ry={left:"start",center:"center",right:"end",start:"start",end:"end"};function rb(e,t,i,r){let n=ev(new Uint8Array(e),["mdat"]);if(0===n.length){r(Error("Could not parse IMSC1 mdat"));return}let a=n.map(e=>el(e)),s=function(e,t,i=1,r=!1){return ih(e,1,1/i,r)}(t.baseTime,0,t.timescale);try{a.forEach(e=>i(function(e,t){let i=new DOMParser,r=i.parseFromString(e,"text/xml"),n=r.getElementsByTagName("tt")[0];if(!n)throw Error("Invalid ttml");let a={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},s=Object.keys(a).reduce((e,t)=>(e[t]=n.getAttribute(`ttp:${t}`)||a[t],e),{}),o="preserve"!==n.getAttribute("xml:space"),l=rE(r_(n,"styling","style")),u=rE(r_(n,"layout","region")),c=r_(n,"body","[begin]");return[].map.call(c,e=>{let i=function e(t,i){return[].slice.call(t.childNodes).reduce((t,r,n)=>{var a;return"br"===r.nodeName&&n?t+"\n":null!=(a=r.childNodes)&&a.length?e(r,i):i?t+r.textContent.trim().replace(/\s+/g," "):t+r.textContent},"")}(e,o);if(!i||!e.hasAttribute("begin"))return null;let r=rT(e.getAttribute("begin"),s),n=rT(e.getAttribute("dur"),s),a=rT(e.getAttribute("end"),s);if(null===r)throw rx(e);if(null===a){if(null===n)throw rx(e);a=r+n}let c=new re(r-t,a-t,i);c.id=rf(c.startTime,c.endTime,c.text);let d=u[e.getAttribute("region")],h=l[e.getAttribute("style")],f=function(e,t,i){let r="http://www.w3.org/ns/ttml#styling",n=null,a=null!=e&&e.hasAttribute("style")?e.getAttribute("style"):null;return a&&i.hasOwnProperty(a)&&(n=i[a]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce((i,a)=>{let s=rS(t,r,a)||rS(e,r,a)||rS(n,r,a);return s&&(i[a]=s),i},{})}(d,h,l),{textAlign:p}=f;if(p){let e=ry[p];e&&(c.lineAlign=e),c.align=p}return b(c,f),c}).filter(e=>null!==e)}(e,s)))}catch(e){r(e)}}function r_(e,t,i){let r=e.getElementsByTagName(t)[0];return r?[].slice.call(r.querySelectorAll(i)):[]}function rE(e){return e.reduce((e,t)=>{let i=t.getAttribute("xml:id");return i&&(e[i]=t),e},{})}function rS(e,t,i){return e&&e.hasAttributeNS(t,i)?e.getAttributeNS(t,i):null}function rx(e){return Error(`Could not parse ttml timestamp ${e}`)}function rT(e,t){if(!e)return null;let i=ri(e);return null===i&&(rg.test(e)?i=function(e,t){let i=rg.exec(e),r=(0|i[4])+(0|i[5])/t.subFrameRate;return(0|i[1])*3600+(0|i[2])*60+(0|i[3])+r/t.frameRate}(e,t):rv.test(e)&&(i=function(e,t){let i=rv.exec(e),r=Number(i[1]),n=i[2];switch(n){case"h":return 3600*r;case"m":return 60*r;case"ms":return 1e3*r;case"f":return r/t.frameRate;case"t":return r/t.tickRate}return r}(e,t))),i}function rw(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}class rA{constructor(e){this.hls=void 0,this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.clientRect=void 0,this.streamController=void 0,this.hls=e,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}setStreamController(e){this.streamController=e}destroy(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null}registerListeners(){let{hls:e}=this;e.on(E.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.on(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.BUFFER_CODECS,this.onBufferCodecs,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this)}unregisterListener(){let{hls:e}=this;e.off(E.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),e.off(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.BUFFER_CODECS,this.onBufferCodecs,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this)}onFpsDropLevelCapping(e,t){let i=this.hls.levels[t.droppedLevel];this.isLevelAllowed(i)&&this.restrictedLevels.push({bitrate:i.bitrate,height:i.height,width:i.width})}onMediaAttaching(e,t){this.media=t.media instanceof HTMLVideoElement?t.media:null,this.clientRect=null}onManifestParsed(e,t){let i=this.hls;this.restrictedLevels=[],this.firstLevel=t.firstLevel,i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onBufferCodecs(e,t){let i=this.hls;i.config.capLevelToPlayerSize&&t.video&&this.startCapping()}onMediaDetaching(){this.stopCapping()}detectPlayerSize(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){let e=this.hls.levels;if(e.length){let t=this.hls;t.autoLevelCapping=this.getMaxLevel(e.length-1),t.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=t.autoLevelCapping}}}getMaxLevel(e){let t=this.hls.levels;if(!t.length)return -1;let i=t.filter((t,i)=>this.isLevelAllowed(t)&&i<=e);return this.clientRect=null,rA.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)}startCapping(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())}stopCapping(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)}getDimensions(){if(this.clientRect)return this.clientRect;let e=this.media,t={width:0,height:0};if(e){let i=e.getBoundingClientRect();t.width=i.width,t.height=i.height,t.width||t.height||(t.width=i.right-i.left||e.width||0,t.height=i.bottom-i.top||e.height||0)}return this.clientRect=t,t}get mediaWidth(){return this.getDimensions().width*this.contentScaleFactor}get mediaHeight(){return this.getDimensions().height*this.contentScaleFactor}get contentScaleFactor(){let e=1;if(!this.hls.config.ignoreDevicePixelRatio)try{e=self.devicePixelRatio}catch(e){}return e}isLevelAllowed(e){let t=this.restrictedLevels;return!t.some(t=>e.bitrate===t.bitrate&&e.width===t.width&&e.height===t.height)}static getMaxLevelByMediaSize(e,t,i){if(!(null!=e&&e.length))return -1;let r=(e,t)=>!t||e.width!==t.width||e.height!==t.height,n=e.length-1;for(let a=0;a<e.length;a+=1){let s=e[a];if((s.width>=t||s.height>=i)&&r(s,e[a+1])){n=a;break}}return n}}let rM="[eme]";class rR{constructor(e){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=rR.CDMCleanupPromise?[rR.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=M.debug.bind(M,rM),this.log=M.log.bind(M,rM),this.warn=M.warn.bind(M,rM),this.error=M.error.bind(M,rM),this.hls=e,this.config=e.config,this.registerListeners()}destroy(){this.unregisterListeners(),this.onMediaDetached();let e=this.config;e.requestMediaKeySystemAccessFunc=null,e.licenseXhrSetup=e.licenseResponseCallback=void 0,e.drmSystems=e.drmSystemOptions={},this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null,this.config=null}registerListeners(){this.hls.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(E.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(E.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(E.MANIFEST_LOADED,this.onManifestLoaded,this)}unregisterListeners(){this.hls.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(E.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(E.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.off(E.MANIFEST_LOADED,this.onManifestLoaded,this)}getLicenseServerUrl(e){let{drmSystems:t,widevineLicenseUrl:i}=this.config,r=t[e];if(r)return r.licenseUrl;if(e===V.WIDEVINE&&i)return i;throw Error(`no license server URL configured for key-system "${e}"`)}getServerCertificateUrl(e){let{drmSystems:t}=this.config,i=t[e];if(i)return i.serverCertificateUrl;this.log(`No Server Certificate in config.drmSystems["${e}"]`)}attemptKeySystemAccess(e){let t=this.hls.levels,i=(e,t,i)=>!!e&&i.indexOf(e)===t,r=t.map(e=>e.audioCodec).filter(i),n=t.map(e=>e.videoCodec).filter(i);return r.length+n.length===0&&n.push("avc1.42e01e"),new Promise((t,i)=>{let a=e=>{let s=e.shift();this.getMediaKeysPromise(s,r,n).then(e=>t({keySystem:s,mediaKeys:e})).catch(t=>{e.length?a(e):t instanceof rC?i(t):i(new rC({type:S.KEY_SYSTEM_ERROR,details:x.KEY_SYSTEM_NO_ACCESS,error:t,fatal:!0},t.message))})};a(e)})}requestMediaKeySystemAccess(e,t){let{requestMediaKeySystemAccessFunc:i}=this.config;if("function"!=typeof i){let e=`Configured requestMediaKeySystemAccess is not a function ${i}`;return null===$&&"http:"===self.location.protocol&&(e=`navigator.requestMediaKeySystemAccess is not available over insecure protocol ${location.protocol}`),Promise.reject(Error(e))}return i(e,t)}getMediaKeysPromise(e,t,i){let r=function(e,t,i,r){let n;switch(e){case V.FAIRPLAY:n=["cenc","sinf"];break;case V.WIDEVINE:case V.PLAYREADY:n=["cenc"];break;case V.CLEARKEY:n=["cenc","keyids"];break;default:throw Error(`Unknown key-system: ${e}`)}return function(e,t,i,r){let n={initDataTypes:e,persistentState:r.persistentState||"not-allowed",distinctiveIdentifier:r.distinctiveIdentifier||"not-allowed",sessionTypes:r.sessionTypes||[r.sessionType||"temporary"],audioCapabilities:t.map(e=>({contentType:`audio/mp4; codecs="${e}"`,robustness:r.audioRobustness||"",encryptionScheme:r.audioEncryptionScheme||null})),videoCapabilities:i.map(e=>({contentType:`video/mp4; codecs="${e}"`,robustness:r.videoRobustness||"",encryptionScheme:r.videoEncryptionScheme||null}))};return[n]}(n,t,i,r)}(e,t,i,this.config.drmSystemOptions),n=this.keySystemAccessPromises[e],a=null==n?void 0:n.keySystemAccess;if(!a){this.log(`Requesting encrypted media "${e}" key-system access with config: ${JSON.stringify(r)}`),a=this.requestMediaKeySystemAccess(e,r);let t=this.keySystemAccessPromises[e]={keySystemAccess:a};return a.catch(t=>{this.log(`Failed to obtain access to key-system "${e}": ${t}`)}),a.then(i=>{this.log(`Access for key-system "${i.keySystem}" obtained`);let r=this.fetchServerCertificate(e);return this.log(`Create media-keys for "${e}"`),t.mediaKeys=i.createMediaKeys().then(t=>(this.log(`Media-keys created for "${e}"`),r.then(i=>i?this.setMediaKeysServerCertificate(t,e,i):t))),t.mediaKeys.catch(t=>{this.error(`Failed to create media-keys for "${e}"}: ${t}`)}),t.mediaKeys})}return a.then(()=>n.mediaKeys)}createMediaKeySessionContext({decryptdata:e,keySystem:t,mediaKeys:i}){this.log(`Creating key-system session "${t}" keyId: ${eu.hexDump(e.keyId||[])}`);let r=i.createSession(),n={decryptdata:e,keySystem:t,mediaKeys:i,mediaKeysSession:r,keyStatus:"status-pending"};return this.mediaKeySessions.push(n),n}renewKeySession(e){let t=e.decryptdata;if(t.pssh){let i=this.createMediaKeySessionContext(e),r=this.getKeyIdString(t);this.keyIdToKeySessionPromise[r]=this.generateRequestWithPreferredKeySession(i,"cenc",t.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(e)}getKeyIdString(e){if(!e)throw Error("Could not read keyId of undefined decryptdata");if(null===e.keyId)throw Error("keyId is null");return eu.hexDump(e.keyId)}updateKeySession(e,t){var i;let r=e.mediaKeysSession;return this.log(`Updating key-session "${r.sessionId}" for keyID ${eu.hexDump((null==(i=e.decryptdata)?void 0:i.keyId)||[])}
      } (data length: ${t?t.byteLength:t})`),r.update(t)}selectKeySystemFormat(e){let t=Object.keys(e.levelkeys||{});return this.keyFormatPromise||(this.log(`Selecting key-system from fragment (sn: ${e.sn} ${e.type}: ${e.level}) key formats ${t.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(t)),this.keyFormatPromise}getKeyFormatPromise(e){return new Promise((t,i)=>{let r=W(this.config),n=e.map(j).filter(e=>!!e&&-1!==r.indexOf(e));return this.getKeySystemSelectionPromise(n).then(({keySystem:e})=>{let r=G(e);r?t(r):i(Error(`Unable to find format for key-system "${e}"`))}).catch(i)})}loadKey(e){let t=e.keyInfo.decryptdata,i=this.getKeyIdString(t),r=`(keyId: ${i} format: "${t.keyFormat}" method: ${t.method} uri: ${t.uri})`;this.log(`Starting session for key ${r}`);let n=this.keyIdToKeySessionPromise[i];return n||(n=this.keyIdToKeySessionPromise[i]=this.getKeySystemForKeyPromise(t).then(({keySystem:i,mediaKeys:n})=>(this.throwIfDestroyed(),this.log(`Handle encrypted media sn: ${e.frag.sn} ${e.frag.type}: ${e.frag.level} using key ${r}`),this.attemptSetMediaKeys(i,n).then(()=>{this.throwIfDestroyed();let e=this.createMediaKeySessionContext({keySystem:i,mediaKeys:n,decryptdata:t});return this.generateRequestWithPreferredKeySession(e,"cenc",t.pssh,"playlist-key")})))).catch(e=>this.handleError(e)),n}throwIfDestroyed(e="Invalid state"){if(!this.hls)throw Error("invalid state")}handleError(e){this.hls&&(this.error(e.message),e instanceof rC?this.hls.trigger(E.ERROR,e.data):this.hls.trigger(E.ERROR,{type:S.KEY_SYSTEM_ERROR,details:x.KEY_SYSTEM_NO_KEYS,error:e,fatal:!0}))}getKeySystemForKeyPromise(e){let t=this.getKeyIdString(e),i=this.keyIdToKeySessionPromise[t];if(!i){let t=j(e.keyFormat),i=t?[t]:W(this.config);return this.attemptKeySystemAccess(i)}return i}getKeySystemSelectionPromise(e){if(e.length||(e=W(this.config)),0===e.length)throw new rC({type:S.KEY_SYSTEM_ERROR,details:x.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},`Missing key-system license configuration options ${JSON.stringify({drmSystems:this.config.drmSystems})}`);return this.attemptKeySystemAccess(e)}_onMediaEncrypted(e){let t,i;let{initDataType:r,initData:n}=e;if(this.debug(`"${e.type}" event: init data type: "${r}"`),null===n)return;if("sinf"===r&&this.config.drmSystems[V.FAIRPLAY]){let e=eh(new Uint8Array(n));try{let r=F(JSON.parse(e).sinf),n=eb(new Uint8Array(r));if(!n)return;t=n.subarray(8,24),i=V.FAIRPLAY}catch(e){this.warn('Failed to parse sinf "encrypted" event message initData');return}}else{let e=function(e){if(!(e instanceof ArrayBuffer)||e.byteLength<32)return null;let t={version:0,systemId:"",kids:null,data:null},i=new DataView(e),r=i.getUint32(0);if(e.byteLength!==r&&r>44)return null;let n=i.getUint32(4);if(1886614376!==n||(t.version=i.getUint32(8)>>>24,t.version>1))return null;t.systemId=eu.hexDump(new Uint8Array(e,12,16));let a=i.getUint32(28);if(0===t.version){if(r-32<a)return null;t.data=new Uint8Array(e,32,a)}else if(1===t.version){t.kids=[];for(let i=0;i<a;i++)t.kids.push(new Uint8Array(e,32+16*i,16))}return t}(n);if(null===e)return;0===e.version&&e.systemId===H.WIDEVINE&&e.data&&(t=e.data.subarray(8,24)),i=function(e){if(e===H.WIDEVINE)return V.WIDEVINE}(e.systemId)}if(!i||!t)return;let a=eu.hexDump(t),{keyIdToKeySessionPromise:s,mediaKeySessions:o}=this,l=s[a];for(let e=0;e<o.length;e++){let i=o[e],u=i.decryptdata;if(u.pssh||!u.keyId)continue;let c=eu.hexDump(u.keyId);if(a===c||-1!==u.uri.replace(/-/g,"").indexOf(a)){l=s[c],delete s[c],u.pssh=new Uint8Array(n),u.keyId=t,l=s[a]=l.then(()=>this.generateRequestWithPreferredKeySession(i,r,n,"encrypted-event-key-match"));break}}l||(l=s[a]=this.getKeySystemSelectionPromise([i]).then(({keySystem:e,mediaKeys:i})=>{var s;this.throwIfDestroyed();let o=new ew("ISO-23001-7",a,null!=(s=G(e))?s:"");return o.pssh=new Uint8Array(n),o.keyId=t,this.attemptSetMediaKeys(e,i).then(()=>{this.throwIfDestroyed();let t=this.createMediaKeySessionContext({decryptdata:o,keySystem:e,mediaKeys:i});return this.generateRequestWithPreferredKeySession(t,r,n,"encrypted-event-no-match")})})),l.catch(e=>this.handleError(e))}_onWaitingForKey(e){this.log(`"${e.type}" event`)}attemptSetMediaKeys(e,t){let i=this.setMediaKeysQueue.slice();this.log(`Setting media-keys for "${e}"`);let r=Promise.all(i).then(()=>{if(!this.media)throw Error("Attempted to set mediaKeys without media element attached");return this.media.setMediaKeys(t)});return this.setMediaKeysQueue.push(r),r.then(()=>{this.log(`Media-keys set for "${e}"`),i.push(r),this.setMediaKeysQueue=this.setMediaKeysQueue.filter(e=>-1===i.indexOf(e))})}generateRequestWithPreferredKeySession(e,t,i,r){var n,a,s;let o=null==(n=this.config.drmSystems)?void 0:null==(a=n[e.keySystem])?void 0:a.generateRequest;if(o)try{let r=o.call(this.hls,t,i,e);if(!r)throw Error("Invalid response from configured generateRequest filter");t=r.initDataType,i=e.decryptdata.pssh=r.initData?new Uint8Array(r.initData):null}catch(e){if(this.warn(e.message),null!=(s=this.hls)&&s.config.debug)throw e}if(null===i)return this.log(`Skipping key-session request for "${r}" (no initData)`),Promise.resolve(e);let l=this.getKeyIdString(e.decryptdata);this.log(`Generating key-session request for "${r}": ${l} (init data type: ${t} length: ${i?i.byteLength:null})`);let u=new iL;e.mediaKeysSession.onmessage=t=>{let i=e.mediaKeysSession;if(!i){u.emit("error",Error("invalid state"));return}let{messageType:r,message:n}=t;this.log(`"${r}" message event for session "${i.sessionId}" message size: ${n.byteLength}`),"license-request"===r||"license-renewal"===r?this.renewLicense(e,n).catch(e=>{this.handleError(e),u.emit("error",e)}):"license-release"===r?e.keySystem===V.FAIRPLAY&&(this.updateKeySession(e,B("acknowledged")),this.removeSession(e)):this.warn(`unhandled media key message type "${r}"`)},e.mediaKeysSession.onkeystatuseschange=t=>{let i=e.mediaKeysSession;if(!i){u.emit("error",Error("invalid state"));return}this.onKeyStatusChange(e);let r=e.keyStatus;u.emit("keyStatus",r),"expired"===r&&(this.warn(`${e.keySystem} expired for key ${l}`),this.renewKeySession(e))};let c=new Promise((e,t)=>{u.on("error",t),u.on("keyStatus",i=>{i.startsWith("usable")?e():"output-restricted"===i?t(new rC({type:S.KEY_SYSTEM_ERROR,details:x.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):"internal-error"===i?t(new rC({type:S.KEY_SYSTEM_ERROR,details:x.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},`key status changed to "${i}"`)):"expired"===i?t(Error("key expired while generating request")):this.warn(`unhandled key status change "${i}"`)})});return e.mediaKeysSession.generateRequest(t,i).then(()=>{var t;this.log(`Request generated for key-session "${null==(t=e.mediaKeysSession)?void 0:t.sessionId}" keyId: ${l}`)}).catch(e=>{throw new rC({type:S.KEY_SYSTEM_ERROR,details:x.KEY_SYSTEM_NO_SESSION,error:e,fatal:!1},`Error generating key-session request: ${e}`)}).then(()=>c).catch(t=>{throw u.removeAllListeners(),this.removeSession(e),t}).then(()=>(u.removeAllListeners(),e))}onKeyStatusChange(e){e.mediaKeysSession.keyStatuses.forEach((t,i)=>{this.log(`key status change "${t}" for keyStatuses keyId: ${eu.hexDump("buffer"in i?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):new Uint8Array(i))} session keyId: ${eu.hexDump(new Uint8Array(e.decryptdata.keyId||[]))} uri: ${e.decryptdata.uri}`),e.keyStatus=t})}fetchServerCertificate(e){let t=this.config,i=t.loader,r=new i(t),n=this.getServerCertificateUrl(e);return n?(this.log(`Fetching serverCertificate for "${e}"`),new Promise((i,a)=>{let s={responseType:"arraybuffer",url:n},o=t.certLoadPolicy.default,l={loadPolicy:o,timeout:o.maxLoadTimeMs,maxRetry:0,retryDelay:0,maxRetryDelay:0};r.load(s,l,{onSuccess:(e,t,r,n)=>{i(e.data)},onError:(t,i,r,o)=>{a(new rC({type:S.KEY_SYSTEM_ERROR,details:x.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:y({url:s.url,data:void 0},t)},`"${e}" certificate request failed (${n}). Status: ${t.code} (${t.text})`))},onTimeout:(t,i,r)=>{a(new rC({type:S.KEY_SYSTEM_ERROR,details:x.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:r,response:{url:s.url,data:void 0}},`"${e}" certificate request timed out (${n})`))},onAbort:(e,t,i)=>{a(Error("aborted"))}})})):Promise.resolve()}setMediaKeysServerCertificate(e,t,i){return new Promise((r,n)=>{e.setServerCertificate(i).then(n=>{this.log(`setServerCertificate ${n?"success":"not supported by CDM"} (${null==i?void 0:i.byteLength}) on "${t}"`),r(e)}).catch(e=>{n(new rC({type:S.KEY_SYSTEM_ERROR,details:x.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:e,fatal:!0},e.message))})})}renewLicense(e,t){return this.requestLicense(e,new Uint8Array(t)).then(t=>this.updateKeySession(e,new Uint8Array(t)).catch(e=>{throw new rC({type:S.KEY_SYSTEM_ERROR,details:x.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:e,fatal:!0},e.message)}))}setupLicenseXHR(e,t,i,r){let n=this.config.licenseXhrSetup;return n?Promise.resolve().then(()=>{if(!i.decryptdata)throw Error("Key removed");return n.call(this.hls,e,t,i,r)}).catch(a=>{if(!i.decryptdata)throw a;return e.open("POST",t,!0),n.call(this.hls,e,t,i,r)}).then(i=>{e.readyState||e.open("POST",t,!0);let n=i||r;return{xhr:e,licenseChallenge:n}}):(e.open("POST",t,!0),Promise.resolve({xhr:e,licenseChallenge:r}))}requestLicense(e,t){let i=this.config.keyLoadPolicy.default;return new Promise((r,n)=>{let a=this.getLicenseServerUrl(e.keySystem);this.log(`Sending license request to URL: ${a}`);let s=new XMLHttpRequest;s.responseType="arraybuffer",s.onreadystatechange=()=>{if(!this.hls||!e.mediaKeysSession)return n(Error("invalid state"));if(4===s.readyState){if(200===s.status){this._requestLicenseFailureCount=0;let t=s.response;this.log(`License received ${t instanceof ArrayBuffer?t.byteLength:t}`);let i=this.config.licenseResponseCallback;if(i)try{t=i.call(this.hls,s,a,e)}catch(e){this.error(e)}r(t)}else{let o=i.errorRetry,l=o?o.maxNumRetry:0;if(this._requestLicenseFailureCount++,this._requestLicenseFailureCount>l||s.status>=400&&s.status<500)n(new rC({type:S.KEY_SYSTEM_ERROR,details:x.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:s,response:{url:a,data:void 0,code:s.status,text:s.statusText}},`License Request XHR failed (${a}). Status: ${s.status} (${s.statusText})`));else{let i=l-this._requestLicenseFailureCount+1;this.warn(`Retrying license request, ${i} attempts left`),this.requestLicense(e,t).then(r,n)}}}},e.licenseXhr&&e.licenseXhr.readyState!==XMLHttpRequest.DONE&&e.licenseXhr.abort(),e.licenseXhr=s,this.setupLicenseXHR(s,a,e,t).then(({xhr:e,licenseChallenge:t})=>{e.send(t)})})}onMediaAttached(e,t){if(!this.config.emeEnabled)return;let i=t.media;this.media=i,i.addEventListener("encrypted",this.onMediaEncrypted),i.addEventListener("waitingforkey",this.onWaitingForKey)}onMediaDetached(){let e=this.media,t=this.mediaKeySessions;e&&(e.removeEventListener("encrypted",this.onMediaEncrypted),e.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},ew.clearKeyUriToKeyIdMap();let i=t.length;rR.CDMCleanupPromise=Promise.all(t.map(e=>this.removeSession(e)).concat(null==e?void 0:e.setMediaKeys(null).catch(t=>{this.log(`Could not clear media keys: ${t}. media.src: ${null==e?void 0:e.src}`)}))).then(()=>{i&&(this.log("finished closing key sessions and clearing media keys"),t.length=0)}).catch(t=>{this.log(`Could not close sessions and clear media keys: ${t}. media.src: ${null==e?void 0:e.src}`)})}onManifestLoading(){this.keyFormatPromise=null}onManifestLoaded(e,{sessionKeys:t}){if(t&&this.config.emeEnabled&&!this.keyFormatPromise){let e=t.reduce((e,t)=>(-1===e.indexOf(t.keyFormat)&&e.push(t.keyFormat),e),[]);this.log(`Selecting key-system from session-keys ${e.join(", ")}`),this.keyFormatPromise=this.getKeyFormatPromise(e)}}removeSession(e){let{mediaKeysSession:t,licenseXhr:i}=e;if(t){this.log(`Remove licenses and keys and close session ${t.sessionId}`),t.onmessage=null,t.onkeystatuseschange=null,i&&i.readyState!==XMLHttpRequest.DONE&&i.abort(),e.mediaKeysSession=e.decryptdata=e.licenseXhr=void 0;let r=this.mediaKeySessions.indexOf(e);return r>-1&&this.mediaKeySessions.splice(r,1),t.remove().catch(e=>{this.log(`Could not remove session: ${e}`)}).then(()=>t.close()).catch(e=>{this.log(`Could not close session: ${e}`)})}}}rR.CDMCleanupPromise=void 0;class rC extends Error{constructor(e,t){super(t),this.data=void 0,e.error||(e.error=Error(t)),this.data=e,e.err=e.error}}var rI={MANIFEST:"m",AUDIO:"a",VIDEO:"v",MUXED:"av",INIT:"i",TIMED_TEXT:"tt"};class rL{constructor(e){this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=()=>{this.initialized&&(this.starved=!0),this.buffering=!0},this.onPlaying=()=>{this.initialized||(this.initialized=!0),this.buffering=!1},this.applyPlaylistData=e=>{try{this.apply(e,{ot:rI.MANIFEST,su:!this.initialized})}catch(e){M.warn("Could not generate manifest CMCD data.",e)}},this.applyFragmentData=e=>{try{let t=e.frag,i=this.hls.levels[t.level],r=this.getObjectType(t),n={d:1e3*t.duration,ot:r};(r===rI.VIDEO||r===rI.AUDIO||r==rI.MUXED)&&(n.br=i.bitrate/1e3,n.tb=this.getTopBandwidth(r)/1e3,n.bl=this.getBufferLength(r)),this.apply(e,n)}catch(e){M.warn("Could not generate segment CMCD data.",e)}},this.hls=e;let t=this.config=e.config,{cmcd:i}=t;null!=i&&(t.pLoader=this.createPlaylistLoader(),t.fLoader=this.createFragmentLoader(),this.sid=i.sessionId||rL.uuid(),this.cid=i.contentId,this.useHeaders=!0===i.useHeaders,this.registerListeners())}registerListeners(){let e=this.hls;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHED,this.onMediaDetached,this),e.on(E.BUFFER_CREATED,this.onBufferCreated,this)}unregisterListeners(){let e=this.hls;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHED,this.onMediaDetached,this),e.off(E.BUFFER_CREATED,this.onBufferCreated,this)}destroy(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null}onMediaAttached(e,t){this.media=t.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)}onMediaDetached(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)}onBufferCreated(e,t){var i,r;this.audioBuffer=null==(i=t.tracks.audio)?void 0:i.buffer,this.videoBuffer=null==(r=t.tracks.video)?void 0:r.buffer}createData(){var e;return{v:1,sf:"h",sid:this.sid,cid:this.cid,pr:null==(e=this.media)?void 0:e.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}}apply(e,t={}){b(t,this.createData());let i=t.ot===rI.INIT||t.ot===rI.VIDEO||t.ot===rI.MUXED;if(this.starved&&i&&(t.bs=!0,t.su=!0,this.starved=!1),null==t.su&&(t.su=this.buffering),this.useHeaders){let i=rL.toHeaders(t);if(!Object.keys(i).length)return;e.headers||(e.headers={}),b(e.headers,i)}else{let i=rL.toQuery(t);if(!i)return;e.url=rL.appendQueryToUri(e.url,i)}}getObjectType(e){let{type:t}=e;return"subtitle"===t?rI.TIMED_TEXT:"initSegment"===e.sn?rI.INIT:"audio"===t?rI.AUDIO:"main"===t?this.hls.audioTracks.length?rI.VIDEO:rI.MUXED:void 0}getTopBandwidth(e){let t,i=0,r=this.hls;if(e===rI.AUDIO)t=r.audioTracks;else{let e=r.maxAutoLevel,i=e>-1?e+1:r.levels.length;t=r.levels.slice(0,i)}for(let e of t)e.bitrate>i&&(i=e.bitrate);return i>0?i:NaN}getBufferLength(e){let t=this.hls.media,i=e===rI.AUDIO?this.audioBuffer:this.videoBuffer;if(!i||!t)return NaN;let r=tk.bufferInfo(i,t.currentTime,this.config.maxBufferHole);return 1e3*r.len}createPlaylistLoader(){let{pLoader:e}=this.config,t=this.applyPlaylistData,i=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new i(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,i,r){t(e),this.loader.load(e,i,r)}}}createFragmentLoader(){let{fLoader:e}=this.config,t=this.applyFragmentData,i=e||this.config.loader;return class{constructor(e){this.loader=void 0,this.loader=new i(e)}get stats(){return this.loader.stats}get context(){return this.loader.context}destroy(){this.loader.destroy()}abort(){this.loader.abort()}load(e,i,r){t(e),this.loader.load(e,i,r)}}}static uuid(){let e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}static serialize(e){let t=[],i=e=>!Number.isNaN(e)&&null!=e&&""!==e&&!1!==e,r=e=>Math.round(e),n=e=>100*r(e/100),a={br:r,d:r,bl:n,dl:n,mtp:n,nor:e=>encodeURIComponent(e),rtp:n,tb:r},s=Object.keys(e||{}).sort();for(let r of s){let n,s=e[r];if(!i(s)||"v"===r&&1===s||"pr"==r&&1===s)continue;let o=a[r];o&&(s=o(s));let l=typeof s;n="ot"===r||"sf"===r||"st"===r?`${r}=${s}`:"boolean"===l?r:"number"===l?`${r}=${s}`:`${r}=${JSON.stringify(s)}`,t.push(n)}return t.join(",")}static toHeaders(e){let t=Object.keys(e),i={},r=["Object","Request","Session","Status"],n=[{},{},{},{}],a={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3};for(let i of t){let t=null!=a[i]?a[i]:1;n[t][i]=e[i]}for(let e=0;e<n.length;e++){let t=rL.serialize(n[e]);t&&(i[`CMCD-${r[e]}`]=t)}return i}static toQuery(e){return`CMCD=${encodeURIComponent(rL.serialize(e))}`}static appendQueryToUri(e,t){if(!t)return e;let i=e.includes("?")?"&":"?";return`${e}${i}${t}`}}function rk(e,t,i,r){e&&Object.keys(t).forEach(n=>{let a=e.filter(e=>e.groupId===n).map(e=>{let a=b({},e);return a.details=void 0,a.attrs=new I(a.attrs),a.url=a.attrs.URI=rD(e.url,e.attrs["STABLE-RENDITION-ID"],"PER-RENDITION-URIS",i),a.groupId=a.attrs["GROUP-ID"]=t[n],a.attrs["PATHWAY-ID"]=r,a});e.push(...a)})}function rD(e,t,i,r){let n;let{HOST:a,PARAMS:s,[i]:o}=r;t&&(n=null==o?void 0:o[t])&&(e=n);let l=new self.URL(e);return a&&!n&&(l.host=a),s&&Object.keys(s).sort().forEach(e=>{e&&l.searchParams.set(e,s[e])}),l.href}let rP=/^age:\s*[\d.]+\s*$/im;class rO{constructor(e){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=e&&e.xhrSetup||null,this.stats=new k,this.retryDelay=0}destroy(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null}abortInternal(){let e=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),e&&(e.onreadystatechange=null,e.onprogress=null,4!==e.readyState&&(this.stats.aborted=!0,e.abort()))}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)}load(e,t,i){if(this.stats.loading.start)throw Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=e,this.config=t,this.callbacks=i,this.loadInternal()}loadInternal(){let{config:e,context:t}=this;if(!e)return;let i=this.loader=new self.XMLHttpRequest,r=this.stats;r.loading.first=0,r.loaded=0,r.aborted=!1;let n=this.xhrSetup;n?Promise.resolve().then(()=>{if(!this.stats.aborted)return n(i,t.url)}).catch(e=>(i.open("GET",t.url,!0),n(i,t.url))).then(()=>{this.stats.aborted||this.openAndSendXhr(i,t,e)}).catch(e=>{this.callbacks.onError({code:i.status,text:e.message},t,i,r)}):this.openAndSendXhr(i,t,e)}openAndSendXhr(e,t,i){e.readyState||e.open("GET",t.url,!0);let r=this.context.headers,{maxTimeToFirstByteMs:n,maxLoadTimeMs:a}=i.loadPolicy;if(r)for(let t in r)e.setRequestHeader(t,r[t]);t.rangeEnd&&e.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1)),e.onreadystatechange=this.readystatechange.bind(this),e.onprogress=this.loadprogress.bind(this),e.responseType=t.responseType,self.clearTimeout(this.requestTimeout),i.timeout=n&&_(n)?n:a,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),i.timeout),e.send()}readystatechange(){let{context:e,loader:t,stats:i}=this;if(!e||!t)return;let r=t.readyState,n=this.config;if(!i.aborted&&r>=2&&(0===i.loading.first&&(i.loading.first=Math.max(self.performance.now(),i.loading.start),n.timeout!==n.loadPolicy.maxLoadTimeMs&&(self.clearTimeout(this.requestTimeout),n.timeout=n.loadPolicy.maxLoadTimeMs,this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),n.loadPolicy.maxLoadTimeMs-(i.loading.first-i.loading.start)))),4===r)){self.clearTimeout(this.requestTimeout),t.onreadystatechange=null,t.onprogress=null;let r=t.status,a="text"!==t.responseType;if(r>=200&&r<300&&(a&&t.response||null!==t.responseText)){i.loading.end=Math.max(self.performance.now(),i.loading.first);let n=a?t.response:t.responseText,s="arraybuffer"===t.responseType?n.byteLength:n.length;if(i.loaded=i.total=s,i.bwEstimate=8e3*i.total/(i.loading.end-i.loading.first),!this.callbacks)return;let o=this.callbacks.onProgress;if(o&&o(i,e,n,t),!this.callbacks)return;let l={url:t.responseURL,data:n,code:r};this.callbacks.onSuccess(l,i,e,t)}else{let a=n.loadPolicy.errorRetry,s=i.retry;td(a,s,!1,r)?this.retry(a):(M.error(`${r} while loading ${e.url}`),this.callbacks.onError({code:r,text:t.statusText},e,t,i))}}}loadtimeout(){var e;let t=null==(e=this.config)?void 0:e.loadPolicy.timeoutRetry,i=this.stats.retry;if(td(t,i,!0))this.retry(t);else{M.warn(`timeout while loading ${this.context.url}`);let e=this.callbacks;e&&(this.abortInternal(),e.onTimeout(this.stats,this.context,this.loader))}}retry(e){let{context:t,stats:i}=this;this.retryDelay=tu(e,i.retry),i.retry++,M.warn(`${status?"HTTP Status "+status:"Timeout"} while loading ${t.url}, retrying ${i.retry}/${e.maxNumRetry} in ${this.retryDelay}ms`),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay)}loadprogress(e){let t=this.stats;t.loaded=e.loaded,e.lengthComputable&&(t.total=e.total)}getCacheAge(){let e=null;if(this.loader&&rP.test(this.loader.getAllResponseHeaders())){let t=this.loader.getResponseHeader("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.loader&&RegExp(`^${e}:\\s*[\\d.]+\\s*$`,"im").test(this.loader.getAllResponseHeaders())?this.loader.getResponseHeader(e):null}}let rN=/(\d+)-(\d+)\/(\d+)/;class rU{constructor(e){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=e.fetchSetup||rF,this.controller=new self.AbortController,this.stats=new k}destroy(){this.loader=this.callbacks=null,this.abortInternal()}abortInternal(){let e=this.response;null!=e&&e.ok||(this.stats.aborted=!0,this.controller.abort())}abort(){var e;this.abortInternal(),null!=(e=this.callbacks)&&e.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)}load(e,t,i){let r=this.stats;if(r.loading.start)throw Error("Loader can only be used once.");r.loading.start=self.performance.now();let n=function(e,t){let i={method:"GET",mode:"cors",credentials:"same-origin",signal:t,headers:new self.Headers(b({},e.headers))};return e.rangeEnd&&i.headers.set("Range","bytes="+e.rangeStart+"-"+String(e.rangeEnd-1)),i}(e,this.controller.signal),a=i.onProgress,s="arraybuffer"===e.responseType,o=s?"byteLength":"length",{maxTimeToFirstByteMs:l,maxLoadTimeMs:u}=t.loadPolicy;this.context=e,this.config=t,this.callbacks=i,this.request=this.fetchSetup(e,n),self.clearTimeout(this.requestTimeout),t.timeout=l&&_(l)?l:u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),i.onTimeout(r,e,this.response)},t.timeout),self.fetch(this.request).then(n=>{this.response=this.loader=n;let o=Math.max(self.performance.now(),r.loading.start);if(self.clearTimeout(this.requestTimeout),t.timeout=u,this.requestTimeout=self.setTimeout(()=>{this.abortInternal(),i.onTimeout(r,e,this.response)},u-(o-r.loading.start)),!n.ok){let{status:e,statusText:t}=n;throw new rB(t||"fetch, bad network response",e,n)}return(r.loading.first=o,r.total=function(e){let t=e.get("Content-Range");if(t){let e=function(e){let t=rN.exec(e);if(t)return parseInt(t[2])-parseInt(t[1])+1}(t);if(_(e))return e}let i=e.get("Content-Length");if(i)return parseInt(i)}(n.headers)||r.total,a&&_(t.highWaterMark))?this.loadProgressively(n,r,e,t.highWaterMark,a):s?n.arrayBuffer():"json"===e.responseType?n.json():n.text()}).then(n=>{let{response:s}=this;self.clearTimeout(this.requestTimeout),r.loading.end=Math.max(self.performance.now(),r.loading.first);let l=n[o];l&&(r.loaded=r.total=l);let u={url:s.url,data:n,code:s.status};a&&!_(t.highWaterMark)&&a(r,e,n,s),i.onSuccess(u,r,e,s)}).catch(t=>{if(self.clearTimeout(this.requestTimeout),r.aborted)return;let n=t&&t.code||0,a=t?t.message:null;i.onError({code:n,text:a},e,t?t.details:null,r)})}getCacheAge(){let e=null;if(this.response){let t=this.response.headers.get("age");e=t?parseFloat(t):null}return e}getResponseHeader(e){return this.response?this.response.headers.get(e):null}loadProgressively(e,t,i,r=0,n){let a=new iF,s=e.body.getReader(),o=()=>s.read().then(s=>{if(s.done)return a.dataLength&&n(t,i,a.flush(),e),Promise.resolve(new ArrayBuffer(0));let l=s.value,u=l.length;return t.loaded+=u,u<r||a.dataLength?(a.push(l),a.dataLength>=r&&n(t,i,a.flush(),e)):n(t,i,l,e),o()}).catch(()=>Promise.reject());return o()}}function rF(e,t){return new self.Request(e.url,t)}class rB extends Error{constructor(e,t,i){super(e),this.code=void 0,this.details=void 0,this.code=t,this.details=i}}let rV=/\s/,rz=y(y({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,workerPath:null,enableSoftwareAES:!0,startLevel:void 0,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:rO,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:class{constructor(e){this.hls=void 0,this.lastLevelLoadSec=0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=-1,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=e;let t=e.config;this.bwEstimator=new iU(t.abrEwmaSlowVoD,t.abrEwmaFastVoD,t.abrEwmaDefaultEstimate),this.registerListeners()}registerListeners(){let{hls:e}=this;e.on(E.FRAG_LOADING,this.onFragLoading,this),e.on(E.FRAG_LOADED,this.onFragLoaded,this),e.on(E.FRAG_BUFFERED,this.onFragBuffered,this),e.on(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(E.LEVEL_LOADED,this.onLevelLoaded,this)}unregisterListeners(){let{hls:e}=this;e.off(E.FRAG_LOADING,this.onFragLoading,this),e.off(E.FRAG_LOADED,this.onFragLoaded,this),e.off(E.FRAG_BUFFERED,this.onFragBuffered,this),e.off(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(E.LEVEL_LOADED,this.onLevelLoaded,this)}destroy(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null}onFragLoading(e,t){var i;let r=t.frag;this.ignoreFragment(r)||(this.fragCurrent=r,this.partCurrent=null!=(i=t.part)?i:null,this.clearTimer(),this.timer=self.setInterval(this.onCheck,100))}onLevelSwitching(e,t){this.clearTimer()}getTimeToLoadFrag(e,t,i,r){let n=r?this.lastLevelLoadSec:0;return e+i/t+n}onLevelLoaded(e,t){let i=this.hls.config,{total:r,bwEstimate:n}=t.stats;_(r)&&_(n)&&(this.lastLevelLoadSec=8*r/n),t.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)}_abandonRulesCheck(){let e;let{fragCurrent:t,partCurrent:i,hls:r}=this,{autoLevelEnabled:n,media:a}=r;if(!t||!a)return;let s=performance.now(),o=i?i.stats:t.stats,l=i?i.duration:t.duration,u=s-o.loading.start;if(o.aborted||o.loaded&&o.loaded===o.total||0===t.level){this.clearTimer(),this._nextAutoLevel=-1;return}if(!n||a.paused||!a.playbackRate||!a.readyState)return;let c=r.mainForwardBufferInfo;if(null===c)return;let d=this.bwEstimator.getEstimateTTFB(),h=Math.abs(a.playbackRate);if(u<=Math.max(d,1e3*(l/(2*h))))return;let f=c.len/h;if(f>=2*l/h)return;let p=o.loading.first?o.loading.first-o.loading.start:-1,m=o.loaded&&p>-1,g=this.bwEstimator.getEstimate(),{levels:v,minAutoLevel:y}=r,b=v[t.level],S=o.total||Math.max(o.loaded,Math.round(l*b.maxBitrate/8)),x=u-p;x<1&&m&&(x=Math.min(u,8*o.loaded/g));let T=m?1e3*o.loaded/x:0,w=T?(S-o.loaded)/T:8*S/g+d/1e3;if(w<=f)return;let A=T?8*T:g,R=Number.POSITIVE_INFINITY;for(e=t.level-1;e>y;e--){let t=v[e].maxBitrate;if((R=this.getTimeToLoadFrag(d/1e3,A,l*t,!v[e].details))<f)break}R>=w||R>10*l||(r.nextLoadLevel=e,m?this.bwEstimator.sample(u-Math.min(d,p),o.loaded):this.bwEstimator.sampleTTFB(u),this.clearTimer(),M.warn(`[abr] Fragment ${t.sn}${i?" part "+i.index:""} of level ${t.level} is loading too slowly;
      Time to underbuffer: ${f.toFixed(3)} s
      Estimated load time for current fragment: ${w.toFixed(3)} s
      Estimated load time for down switch fragment: ${R.toFixed(3)} s
      TTFB estimate: ${p}
      Current BW estimate: ${_(g)?(g/1024).toFixed(3):"Unknown"} Kb/s
      New BW estimate: ${(this.bwEstimator.getEstimate()/1024).toFixed(3)} Kb/s
      Aborting and switching to level ${e}`),t.loader&&(this.fragCurrent=this.partCurrent=null,t.abortRequests()),r.trigger(E.FRAG_LOAD_EMERGENCY_ABORTED,{frag:t,part:i,stats:o}))}onFragLoaded(e,{frag:t,part:i}){let r=i?i.stats:t.stats;if(t.type===eq.MAIN&&this.bwEstimator.sampleTTFB(r.loading.first-r.loading.start),!this.ignoreFragment(t)){if(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){let e=i?i.duration:t.duration,n=this.hls.levels[t.level],a=(n.loaded?n.loaded.bytes:0)+r.loaded,s=(n.loaded?n.loaded.duration:0)+e;n.loaded={bytes:a,duration:s},n.realBitrate=Math.round(8*a/s)}if(t.bitrateTest){let e={stats:r,frag:t,part:i,id:t.type};this.onFragBuffered(E.FRAG_BUFFERED,e),t.bitrateTest=!1}}}onFragBuffered(e,t){let{frag:i,part:r}=t,n=null!=r&&r.stats.loaded?r.stats:i.stats;if(n.aborted||this.ignoreFragment(i))return;let a=n.parsing.end-n.loading.start-Math.min(n.loading.first-n.loading.start,this.bwEstimator.getEstimateTTFB());this.bwEstimator.sample(a,n.loaded),n.bwEstimate=this.bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=a/1e3:this.bitrateTestDelay=0}ignoreFragment(e){return e.type!==eq.MAIN||"initSegment"===e.sn}clearTimer(){self.clearInterval(this.timer)}get nextAutoLevel(){let e=this._nextAutoLevel,t=this.bwEstimator;if(-1!==e&&!t.canEstimate())return e;let i=this.getNextABRAutoLevel();if(-1!==e){let t=this.hls.levels;if(t.length>Math.max(e,i)&&t[e].loadError<=t[i].loadError)return e}return -1!==e&&(i=Math.min(e,i)),i}getNextABRAutoLevel(){let{fragCurrent:e,partCurrent:t,hls:i}=this,{maxAutoLevel:r,config:n,minAutoLevel:a,media:s}=i,o=t?t.duration:e?e.duration:0,l=s&&0!==s.playbackRate?Math.abs(s.playbackRate):1,u=this.bwEstimator?this.bwEstimator.getEstimate():n.abrEwmaDefaultEstimate,c=i.mainForwardBufferInfo,d=(c?c.len:0)/l,h=this.findBestLevel(u,a,r,d,n.abrBandWidthFactor,n.abrBandWidthUpFactor);if(h>=0)return h;M.trace(`[abr] ${d?"rebuffering expected":"buffer is empty"}, finding optimal quality level`);let f=o?Math.min(o,n.maxStarvationDelay):n.maxStarvationDelay,p=n.abrBandWidthFactor,m=n.abrBandWidthUpFactor;if(!d){let e=this.bitrateTestDelay;if(e){let t=o?Math.min(o,n.maxLoadingDelay):n.maxLoadingDelay;f=t-e,M.trace(`[abr] bitrate test took ${Math.round(1e3*e)}ms, set first fragment max fetchDuration to ${Math.round(1e3*f)} ms`),p=m=1}}return Math.max(h=this.findBestLevel(u,a,r,d+f,p,m),0)}findBestLevel(e,t,i,r,n,a){var s;let{fragCurrent:o,partCurrent:l,lastLoadedFragLevel:u}=this,{levels:c}=this.hls,d=c[u],h=!!(null!=d&&null!=(s=d.details)&&s.live),f=null==d?void 0:d.codecSet,p=l?l.duration:o?o.duration:0,m=this.bwEstimator.getEstimateTTFB()/1e3,g=t,v=-1;for(let s=i;s>=t;s--){let t;let i=c[s];if(!i||f&&i.codecSet!==f){i&&(g=Math.min(s,g),v=Math.max(s,v));continue}-1!==v&&M.trace(`[abr] Skipped level(s) ${g}-${v} with CODECS:"${c[v].attrs.CODECS}"; not compatible with "${d.attrs.CODECS}"`);let o=i.details,y=(l?null==o?void 0:o.partTarget:null==o?void 0:o.averagetargetduration)||p;t=s<=u?n*e:a*e;let b=c[s].maxBitrate,E=this.getTimeToLoadFrag(m,t,b*y,void 0===o);if(M.trace(`[abr] level:${s} adjustedbw-bitrate:${Math.round(t-b)} avgDuration:${y.toFixed(1)} maxFetchDuration:${r.toFixed(1)} fetchDuration:${E.toFixed(1)}`),t>b&&(0===E||!_(E)||h&&!this.bitrateTestDelay||E<r))return s}return -1}set nextAutoLevel(e){this._nextAutoLevel=e}},bufferController:class{constructor(e){this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=()=>{let{media:e,mediaSource:t}=this;M.log("[buffer-controller]: Media source opened"),e&&(e.removeEventListener("emptied",this._onMediaEmptied),this.updateMediaElementDuration(),this.hls.trigger(E.MEDIA_ATTACHED,{media:e})),t&&t.removeEventListener("sourceopen",this._onMediaSourceOpen),this.checkPendingTracks()},this._onMediaSourceClose=()=>{M.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=()=>{M.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=()=>{let{media:e,_objectUrl:t}=this;e&&e.src!==t&&M.error(`Media element src was set while attaching MediaSource (${t} > ${e.src})`)},this.hls=e,this._initSourceBuffer(),this.registerListeners()}hasSourceTypes(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0}destroy(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null}registerListeners(){let{hls:e}=this;e.on(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.BUFFER_RESET,this.onBufferReset,this),e.on(E.BUFFER_APPENDING,this.onBufferAppending,this),e.on(E.BUFFER_CODECS,this.onBufferCodecs,this),e.on(E.BUFFER_EOS,this.onBufferEos,this),e.on(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(E.LEVEL_UPDATED,this.onLevelUpdated,this),e.on(E.FRAG_PARSED,this.onFragParsed,this),e.on(E.FRAG_CHANGED,this.onFragChanged,this)}unregisterListeners(){let{hls:e}=this;e.off(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.BUFFER_RESET,this.onBufferReset,this),e.off(E.BUFFER_APPENDING,this.onBufferAppending,this),e.off(E.BUFFER_CODECS,this.onBufferCodecs,this),e.off(E.BUFFER_EOS,this.onBufferEos,this),e.off(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(E.LEVEL_UPDATED,this.onLevelUpdated,this),e.off(E.FRAG_PARSED,this.onFragParsed,this),e.off(E.FRAG_CHANGED,this.onFragChanged,this)}_initSourceBuffer(){this.sourceBuffer={},this.operationQueue=new ij(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null}onManifestLoading(){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=0,this.details=null}onManifestParsed(e,t){let i=2;(!t.audio||t.video)&&t.altAudio||(i=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=i,M.log(`${this.bufferCodecEventsExpected} bufferCodec event(s) expected`)}onMediaAttaching(e,t){let i=this.media=t.media;if(i&&iH){let e=this.mediaSource=new iH;e.addEventListener("sourceopen",this._onMediaSourceOpen),e.addEventListener("sourceended",this._onMediaSourceEnded),e.addEventListener("sourceclose",this._onMediaSourceClose),i.src=self.URL.createObjectURL(e),this._objectUrl=i.src,i.addEventListener("emptied",this._onMediaEmptied)}}onMediaDetaching(){let{media:e,mediaSource:t,_objectUrl:i}=this;if(t){if(M.log("[buffer-controller]: media source detaching"),"open"===t.readyState)try{t.endOfStream()}catch(e){M.warn(`[buffer-controller]: onMediaDetaching: ${e.message} while calling endOfStream`)}this.onBufferReset(),t.removeEventListener("sourceopen",this._onMediaSourceOpen),t.removeEventListener("sourceended",this._onMediaSourceEnded),t.removeEventListener("sourceclose",this._onMediaSourceClose),e&&(e.removeEventListener("emptied",this._onMediaEmptied),i&&self.URL.revokeObjectURL(i),e.src===i?(e.removeAttribute("src"),e.load()):M.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(E.MEDIA_DETACHED,void 0)}onBufferReset(){this.getSourceBufferTypes().forEach(e=>{let t=this.sourceBuffer[e];try{t&&(this.removeBufferListeners(e),this.mediaSource&&this.mediaSource.removeSourceBuffer(t),this.sourceBuffer[e]=void 0)}catch(t){M.warn(`[buffer-controller]: Failed to reset the ${e} buffer`,t)}}),this._initSourceBuffer()}onBufferCodecs(e,t){let i=this.getSourceBufferTypes().length;Object.keys(t).forEach(e=>{if(i){let i=this.tracks[e];if(i&&"function"==typeof i.buffer.changeType){let{id:r,codec:n,levelCodec:a,container:s,metadata:o}=t[e],l=(i.levelCodec||i.codec).replace(iG,"$1"),u=(a||n).replace(iG,"$1");if(l!==u){let t=`${s};codecs=${a||n}`;this.appendChangeType(e,t),M.log(`[buffer-controller]: switching codec ${l} to ${u}`),this.tracks[e]={buffer:i.buffer,codec:n,container:s,levelCodec:a,metadata:o,id:r}}}}else this.pendingTracks[e]=t[e]}),!i&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())}appendChangeType(e,t){let{operationQueue:i}=this;i.append({execute:()=>{let r=this.sourceBuffer[e];r&&(M.log(`[buffer-controller]: changing ${e} sourceBuffer type to ${t}`),r.changeType(t)),i.shiftAndExecuteNext(e)},onStart:()=>{},onComplete:()=>{},onError:t=>{M.warn(`[buffer-controller]: Failed to change ${e} SourceBuffer type`,t)}},e)}onBufferAppending(e,t){let{hls:i,operationQueue:r,tracks:n}=this,{data:a,type:s,frag:o,part:l,chunkMeta:u}=t,c=u.buffering[s],d=self.performance.now();c.start=d;let h=o.stats.buffering,f=l?l.stats.buffering:null;0===h.start&&(h.start=d),f&&0===f.start&&(f.start=d);let p=n.audio,m=!1;"audio"===s&&(null==p?void 0:p.container)==="audio/mpeg"&&(m=!this.lastMpegAudioChunk||1===u.id||this.lastMpegAudioChunk.sn!==u.sn,this.lastMpegAudioChunk=u);let g=o.start;r.append({execute:()=>{if(c.executeStart=self.performance.now(),m){let e=this.sourceBuffer[s];if(e){let t=g-e.timestampOffset;Math.abs(t)>=.1&&(M.log(`[buffer-controller]: Updating audio SourceBuffer timestampOffset to ${g} (delta: ${t}) sn: ${o.sn})`),e.timestampOffset=g)}}this.appendExecutor(a,s)},onStart:()=>{},onComplete:()=>{let e=self.performance.now();c.executeEnd=c.end=e,0===h.first&&(h.first=e),f&&0===f.first&&(f.first=e);let{sourceBuffer:t}=this,i={};for(let e in t)i[e]=tk.getBuffered(t[e]);this.appendError=0,this.hls.trigger(E.BUFFER_APPENDED,{type:s,frag:o,part:l,chunkMeta:u,parent:o.type,timeRanges:i})},onError:e=>{M.error(`[buffer-controller]: Error encountered while trying to append to the ${s} SourceBuffer`,e);let t={type:S.MEDIA_ERROR,parent:o.type,details:x.BUFFER_APPEND_ERROR,frag:o,part:l,chunkMeta:u,error:e,err:e,fatal:!1};e.code===DOMException.QUOTA_EXCEEDED_ERR?t.details=x.BUFFER_FULL_ERROR:(this.appendError++,t.details=x.BUFFER_APPEND_ERROR,this.appendError>i.config.appendErrorMaxRetry&&(M.error(`[buffer-controller]: Failed ${i.config.appendErrorMaxRetry} times to append segment in sourceBuffer`),t.fatal=!0)),i.trigger(E.ERROR,t)}},s)}onBufferFlushing(e,t){let{operationQueue:i}=this,r=e=>({execute:this.removeExecutor.bind(this,e,t.startOffset,t.endOffset),onStart:()=>{},onComplete:()=>{this.hls.trigger(E.BUFFER_FLUSHED,{type:e})},onError:t=>{M.warn(`[buffer-controller]: Failed to remove from ${e} SourceBuffer`,t)}});t.type?i.append(r(t.type),t.type):this.getSourceBufferTypes().forEach(e=>{i.append(r(e),e)})}onFragParsed(e,t){let{frag:i,part:r}=t,n=[],a=r?r.elementaryStreams:i.elementaryStreams;a[D.AUDIOVIDEO]?n.push("audiovideo"):(a[D.AUDIO]&&n.push("audio"),a[D.VIDEO]&&n.push("video")),0===n.length&&M.warn(`Fragments must have at least one ElementaryStreamType set. type: ${i.type} level: ${i.level} sn: ${i.sn}`),this.blockBuffers(()=>{let e=self.performance.now();i.stats.buffering.end=e,r&&(r.stats.buffering.end=e);let t=r?r.stats:i.stats;this.hls.trigger(E.FRAG_BUFFERED,{frag:i,part:r,stats:t,id:i.type})},n)}onFragChanged(e,t){this.flushBackBuffer()}onBufferEos(e,t){let i=this.getSourceBufferTypes().reduce((e,i)=>{let r=this.sourceBuffer[i];return!r||t.type&&t.type!==i||(r.ending=!0,r.ended||(r.ended=!0,M.log(`[buffer-controller]: ${i} sourceBuffer now EOS`))),e&&!!(!r||r.ended)},!0);i&&(M.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(()=>{this.getSourceBufferTypes().forEach(e=>{let t=this.sourceBuffer[e];t&&(t.ending=!1)});let{mediaSource:e}=this;if(!e||"open"!==e.readyState){e&&M.info(`[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: ${e.readyState}`);return}M.log("[buffer-controller]: Calling mediaSource.endOfStream()"),e.endOfStream()}))}onLevelUpdated(e,{details:t}){t.fragments.length&&(this.details=t,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())}flushBackBuffer(){let{hls:e,details:t,media:i,sourceBuffer:r}=this;if(!i||null===t)return;let n=this.getSourceBufferTypes();if(!n.length)return;let a=t.live&&null!==e.config.liveBackBufferLength?e.config.liveBackBufferLength:e.config.backBufferLength;if(!_(a)||a<0)return;let s=i.currentTime,o=t.levelTargetDuration,l=Math.max(a,o),u=Math.floor(s/o)*o-l;n.forEach(i=>{let n=r[i];if(n){let r=tk.getBuffered(n);if(r.length>0&&u>r.start(0)){if(e.trigger(E.BACK_BUFFER_REACHED,{bufferEnd:u}),t.live)e.trigger(E.LIVE_BACK_BUFFER_REACHED,{bufferEnd:u});else if(n.ended&&r.end(r.length-1)-s<2*o){M.info(`[buffer-controller]: Cannot flush ${i} back buffer while SourceBuffer is in ended state`);return}e.trigger(E.BUFFER_FLUSHING,{startOffset:0,endOffset:u,type:i})}}})}updateMediaElementDuration(){if(!this.details||!this.media||!this.mediaSource||"open"!==this.mediaSource.readyState)return;let{details:e,hls:t,media:i,mediaSource:r}=this,n=e.fragments[0].start+e.totalduration,a=i.duration,s=_(r.duration)?r.duration:0;e.live&&t.config.liveDurationInfinity?(M.log("[buffer-controller]: Media Source duration is set to Infinity"),r.duration=1/0,this.updateSeekableRange(e)):(n>s&&n>a||!_(a))&&(M.log(`[buffer-controller]: Updating Media Source duration to ${n.toFixed(3)}`),r.duration=n)}updateSeekableRange(e){let t=this.mediaSource,i=e.fragments,r=i.length;if(r&&e.live&&null!=t&&t.setLiveSeekableRange){let r=Math.max(0,i[0].start),n=Math.max(r,r+e.totalduration);t.setLiveSeekableRange(r,n)}}checkPendingTracks(){let{bufferCodecEventsExpected:e,operationQueue:t,pendingTracks:i}=this,r=Object.keys(i).length;if(r&&!e||2===r){this.createSourceBuffers(i),this.pendingTracks={};let e=this.getSourceBufferTypes();if(e.length)this.hls.trigger(E.BUFFER_CREATED,{tracks:this.tracks}),e.forEach(e=>{t.executeNext(e)});else{let e=Error("could not create source buffer for media codec(s)");this.hls.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,error:e,reason:e.message})}}}createSourceBuffers(e){let{sourceBuffer:t,mediaSource:i}=this;if(!i)throw Error("createSourceBuffers called when mediaSource was null");for(let r in e)if(!t[r]){let n=e[r];if(!n)throw Error(`source buffer exists for track ${r}, however track does not`);let a=n.levelCodec||n.codec,s=`${n.container};codecs=${a}`;M.log(`[buffer-controller]: creating sourceBuffer(${s})`);try{let e=t[r]=i.addSourceBuffer(s);this.addBufferListener(r,"updatestart",this._onSBUpdateStart),this.addBufferListener(r,"updateend",this._onSBUpdateEnd),this.addBufferListener(r,"error",this._onSBUpdateError),this.tracks[r]={buffer:e,codec:a,container:n.container,levelCodec:n.levelCodec,metadata:n.metadata,id:n.id}}catch(e){M.error(`[buffer-controller]: error while trying to add sourceBuffer: ${e.message}`),this.hls.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:e,mimeType:s})}}}_onSBUpdateStart(e){let{operationQueue:t}=this,i=t.current(e);i.onStart()}_onSBUpdateEnd(e){let{operationQueue:t}=this,i=t.current(e);i.onComplete(),t.shiftAndExecuteNext(e)}_onSBUpdateError(e,t){let i=Error(`${e} SourceBuffer error`);M.error(`[buffer-controller]: ${i}`,t),this.hls.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.BUFFER_APPENDING_ERROR,error:i,fatal:!1});let r=this.operationQueue.current(e);r&&r.onError(t)}removeExecutor(e,t,i){let{media:r,mediaSource:n,operationQueue:a,sourceBuffer:s}=this,o=s[e];if(!r||!n||!o){M.warn(`[buffer-controller]: Attempting to remove from the ${e} SourceBuffer, but it does not exist`),a.shiftAndExecuteNext(e);return}let l=_(r.duration)?r.duration:1/0,u=_(n.duration)?n.duration:1/0,c=Math.max(0,t),d=Math.min(i,l,u);d>c&&!o.ending?(o.ended=!1,M.log(`[buffer-controller]: Removing [${c},${d}] from the ${e} SourceBuffer`),o.remove(c,d)):a.shiftAndExecuteNext(e)}appendExecutor(e,t){let{operationQueue:i,sourceBuffer:r}=this,n=r[t];if(!n){M.warn(`[buffer-controller]: Attempting to append to the ${t} SourceBuffer, but it does not exist`),i.shiftAndExecuteNext(t);return}n.ended=!1,n.appendBuffer(e)}blockBuffers(e,t=this.getSourceBufferTypes()){if(!t.length){M.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(e);return}let{operationQueue:i}=this,r=t.map(e=>i.appendBlocker(e));Promise.all(r).then(()=>{e(),t.forEach(e=>{let t=this.sourceBuffer[e];null!=t&&t.updating||i.shiftAndExecuteNext(e)})})}getSourceBufferTypes(){return Object.keys(this.sourceBuffer)}addBufferListener(e,t,i){let r=this.sourceBuffer[e];if(!r)return;let n=i.bind(this,e);this.listeners[e].push({event:t,listener:n}),r.addEventListener(t,n)}removeBufferListeners(e){let t=this.sourceBuffer[e];t&&this.listeners[e].forEach(e=>{t.removeEventListener(e.event,e.listener)})}},capLevelController:rA,errorController:class{constructor(e){this.hls=void 0,this.playlistError=0,this.penalizedRenditions={},this.log=void 0,this.warn=void 0,this.error=void 0,this.hls=e,this.log=M.log.bind(M,"[info]:"),this.warn=M.warn.bind(M,"[warning]:"),this.error=M.error.bind(M,"[error]:"),this.registerListeners()}registerListeners(){let e=this.hls;e.on(E.ERROR,this.onError,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.LEVEL_UPDATED,this.onLevelUpdated,this)}unregisterListeners(){let e=this.hls;e&&(e.off(E.ERROR,this.onError,this),e.off(E.ERROR,this.onErrorOut,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.LEVEL_UPDATED,this.onLevelUpdated,this))}destroy(){this.unregisterListeners(),this.hls=null,this.penalizedRenditions={}}startLoad(e){this.playlistError=0}stopLoad(){}getVariantLevelIndex(e){return(null==e?void 0:e.type)===eq.MAIN?e.level:this.hls.loadLevel}onManifestLoading(){this.playlistError=0,this.penalizedRenditions={}}onLevelUpdated(){this.playlistError=0}onError(e,t){var i,r,n,a;if(t.fatal)return;let s=this.hls,o=t.context;switch(t.details){case x.FRAG_LOAD_ERROR:case x.FRAG_LOAD_TIMEOUT:case x.KEY_LOAD_ERROR:case x.KEY_LOAD_TIMEOUT:t.errorAction=this.getFragRetryOrSwitchAction(t);return;case x.FRAG_PARSING_ERROR:if(null!=(i=t.frag)&&i.gap){t.errorAction={action:tm.DoNothing,flags:tg.None};return}case x.FRAG_GAP:case x.FRAG_DECRYPT_ERROR:t.errorAction=this.getFragRetryOrSwitchAction(t),t.errorAction.action=tm.SendAlternateToPenaltyBox;return;case x.LEVEL_EMPTY_ERROR:case x.LEVEL_PARSING_ERROR:{let e=t.parent===eq.MAIN?t.level:s.loadLevel;t.details===x.LEVEL_EMPTY_ERROR&&null!=(n=t.context)&&null!=(a=n.levelDetails)&&a.live?t.errorAction=this.getPlaylistRetryOrSwitchAction(t,e):(t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e))}return;case x.LEVEL_LOAD_ERROR:case x.LEVEL_LOAD_TIMEOUT:"number"==typeof(null==o?void 0:o.level)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,o.level));return;case x.AUDIO_TRACK_LOAD_ERROR:case x.AUDIO_TRACK_LOAD_TIMEOUT:case x.SUBTITLE_LOAD_ERROR:case x.SUBTITLE_TRACK_LOAD_TIMEOUT:if(o){let e=s.levels[s.loadLevel];e&&(o.type===e$.AUDIO_TRACK&&o.groupId===e.audioGroupId||o.type===e$.SUBTITLE_TRACK&&o.groupId===e.textGroupId)&&(t.errorAction=this.getPlaylistRetryOrSwitchAction(t,s.loadLevel),t.errorAction.action=tm.SendAlternateToPenaltyBox,t.errorAction.flags=tg.MoveAllAlternatesMatchingHost)}return;case x.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:{let e=s.levels[s.loadLevel],i=null==e?void 0:e.attrs["HDCP-LEVEL"];i&&(t.errorAction={action:tm.SendAlternateToPenaltyBox,flags:tg.MoveAllAlternatesMatchingHDCP,hdcpLevel:i})}return;case x.BUFFER_ADD_CODEC_ERROR:case x.REMUX_ALLOC_ERROR:t.errorAction=this.getLevelSwitchAction(t,null!=(r=t.level)?r:s.loadLevel);return;case x.INTERNAL_EXCEPTION:case x.BUFFER_APPENDING_ERROR:case x.BUFFER_APPEND_ERROR:case x.BUFFER_FULL_ERROR:case x.LEVEL_SWITCH_ERROR:case x.BUFFER_STALLED_ERROR:case x.BUFFER_SEEK_OVER_HOLE:case x.BUFFER_NUDGE_ON_STALL:t.errorAction={action:tm.DoNothing,flags:tg.None};return}if(t.type===S.KEY_SYSTEM_ERROR){let e=this.getVariantLevelIndex(t.frag);t.levelRetry=!1,t.errorAction=this.getLevelSwitchAction(t,e);return}}getPlaylistRetryOrSwitchAction(e,t){var i;let r=this.hls,n=tl(r.config.playlistLoadPolicy,e),a=this.playlistError++,s=null==(i=e.response)?void 0:i.code,o=td(n,a,to(e),s);if(o)return{action:tm.RetryRequest,flags:tg.None,retryConfig:n,retryCount:a};let l=this.getLevelSwitchAction(e,t);return n&&(l.retryConfig=n,l.retryCount=a),l}getFragRetryOrSwitchAction(e){let t=this.hls,i=this.getVariantLevelIndex(e.frag),r=t.levels[i],{fragLoadPolicy:n,keyLoadPolicy:a}=t.config,s=tl(e.details.startsWith("key")?a:n,e),o=t.levels.reduce((e,t)=>e+t.fragmentError,0);if(r){var l;e.details!==x.FRAG_GAP&&r.fragmentError++;let t=null==(l=e.response)?void 0:l.code,i=td(s,o,to(e),t);if(i)return{action:tm.RetryRequest,flags:tg.None,retryConfig:s,retryCount:o}}let u=this.getLevelSwitchAction(e,i);return s&&(u.retryConfig=s,u.retryCount=o),u}getLevelSwitchAction(e,t){let i=this.hls;null==t&&(t=i.loadLevel);let r=this.hls.levels[t];if(r&&(r.loadError++,i.autoLevelEnabled)){var n,a;let t=-1,{levels:s,loadLevel:o,minAutoLevel:l,maxAutoLevel:u}=i,c=null==(n=e.frag)?void 0:n.type,{type:d,groupId:h}=null!=(a=e.context)?a:{};for(let i=s.length;i--;){let n=(i+o)%s.length;if(n!==o&&n>=l&&n<=u&&0===s[n].loadError){let i=s[n];if(e.details===x.FRAG_GAP&&e.frag){let t=s[n].details;if(t){let i=tf(e.frag,t.fragments,e.frag.start);if(null!=i&&i.gap)continue}}else if(d===e$.AUDIO_TRACK&&h===i.audioGroupId||d===e$.SUBTITLE_TRACK&&h===i.textGroupId)continue;else if(c===eq.AUDIO&&r.audioGroupId===i.audioGroupId||c===eq.SUBTITLE&&r.textGroupId===i.textGroupId)continue;t=n;break}}if(t>-1&&i.loadLevel!==t)return e.levelRetry=!0,this.playlistError=0,{action:tm.SendAlternateToPenaltyBox,flags:tg.None,nextAutoLevel:t}}return{action:tm.SendAlternateToPenaltyBox,flags:tg.MoveAllAlternatesMatchingHost}}onErrorOut(e,t){var i;switch(null==(i=t.errorAction)?void 0:i.action){case tm.DoNothing:break;case tm.SendAlternateToPenaltyBox:this.sendAlternateToPenaltyBox(t),t.errorAction.resolved||t.details===x.FRAG_GAP||(t.fatal=!0)}if(t.fatal){this.hls.stopLoad();return}}sendAlternateToPenaltyBox(e){let t=this.hls,i=e.errorAction;if(!i)return;let{flags:r,hdcpLevel:n,nextAutoLevel:a}=i;switch(r){case tg.None:this.switchLevel(e,a);break;case tg.MoveAllAlternatesMatchingHost:i.resolved||(i.resolved=this.redundantFailover(e));break;case tg.MoveAllAlternatesMatchingHDCP:n&&(t.maxHdcpLevel=e8[e8.indexOf(n)-1],i.resolved=!0),this.warn(`Restricting playback to HDCP-LEVEL of "${t.maxHdcpLevel}" or lower`)}i.resolved||this.switchLevel(e,a)}switchLevel(e,t){void 0!==t&&e.errorAction&&(this.warn(`switching to level ${t} after ${e.details}`),this.hls.nextAutoLevel=t,e.errorAction.resolved=!0,this.hls.nextLoadLevel=this.hls.nextAutoLevel)}redundantFailover(e){let{hls:t,penalizedRenditions:i}=this,r=e.parent===eq.MAIN?e.level:t.loadLevel,n=t.levels[r],a=n.url.length,s=e.frag?e.frag.urlId:n.urlId;n.urlId===s&&(!e.frag||n.details)&&this.penalizeRendition(n,e);for(let o=1;o<a;o++){let l=(s+o)%a,u=i[l];if(!u||function(e,t,i){if(performance.now()-e.lastErrorPerfMs>3e5)return!0;let r=e.details;if(t.details===x.FRAG_GAP&&r&&t.frag){let e=t.frag.start,i=tf(null,r.fragments,e);if(i&&!i.gap)return!0}if(i&&e.errors.length<i.errors.length){let i=e.errors[e.errors.length-1];if(r&&i.frag&&t.frag&&Math.abs(i.frag.start-t.frag.start)>3*r.targetduration)return!0}return!1}(u,e,i[s]))return this.warn(`Switching to Redundant Stream ${l+1}/${a}: "${n.url[l]}" after ${e.details}`),this.playlistError=0,t.levels.forEach(e=>{e.urlId=l}),t.nextLoadLevel=r,!0}return!1}penalizeRendition(e,t){let{penalizedRenditions:i}=this,r=i[e.urlId]||{lastErrorPerfMs:0,errors:[],details:void 0};r.lastErrorPerfMs=performance.now(),r.errors.push(t),r.details=e.details,i[e.urlId]=r}},fpsController:class{constructor(e){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=e,this.registerListeners()}setStreamController(e){this.streamController=e}registerListeners(){this.hls.on(E.MEDIA_ATTACHING,this.onMediaAttaching,this)}unregisterListeners(){this.hls.off(E.MEDIA_ATTACHING,this.onMediaAttaching,this)}destroy(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null}onMediaAttaching(e,t){let i=this.hls.config;if(i.capLevelOnFPSDrop){let e=t.media instanceof self.HTMLVideoElement?t.media:null;this.media=e,e&&"function"==typeof e.getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),i.fpsDroppedMonitoringPeriod)}}checkFPS(e,t,i){let r=performance.now();if(t){if(this.lastTime){let e=r-this.lastTime,n=i-this.lastDroppedFrames,a=t-this.lastDecodedFrames,s=this.hls;if(s.trigger(E.FPS_DROP,{currentDropped:n,currentDecoded:a,totalDroppedFrames:i}),1e3*n/e>0&&n>s.config.fpsDroppedMonitoringThreshold*a){let e=s.currentLevel;M.warn("drop FPS ratio greater than max allowed value for currentLevel: "+e),e>0&&(-1===s.autoLevelCapping||s.autoLevelCapping>=e)&&(e-=1,s.trigger(E.FPS_DROP_LEVEL_CAPPING,{level:e,droppedLevel:s.currentLevel}),s.autoLevelCapping=e,this.streamController.nextLevelSwitch())}}this.lastTime=r,this.lastDroppedFrames=i,this.lastDecodedFrames=t}}checkFPSInterval(){let e=this.media;if(e){if(this.isVideoPlaybackQualityAvailable){let t=e.getVideoPlaybackQuality();this.checkFPS(e,t.totalVideoFrames,t.droppedVideoFrames)}else this.checkFPS(e,e.webkitDecodedFrameCount,e.webkitDroppedFrameCount)}}},stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:$,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0,certLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:null,errorRetry:null}},keyLoadPolicy:{default:{maxTimeToFirstByteMs:8e3,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"},errorRetry:{maxNumRetry:8,retryDelayMs:1e3,maxRetryDelayMs:2e4,backoff:"linear"}}},manifestLoadPolicy:{default:{maxTimeToFirstByteMs:1/0,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},playlistLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:2,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},fragLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:12e4,timeoutRetry:{maxNumRetry:4,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:6,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},steeringManifestLoadPolicy:{default:{maxTimeToFirstByteMs:1e4,maxLoadTimeMs:2e4,timeoutRetry:{maxNumRetry:2,retryDelayMs:0,maxRetryDelayMs:0},errorRetry:{maxNumRetry:1,retryDelayMs:1e3,maxRetryDelayMs:8e3}}},manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3},{cueHandler:{newCue(e,t,i,r){let n,a,s,o,l;let u=[],c=self.VTTCue||self.TextTrackCue;for(let h=0;h<r.rows.length;h++)if(n=r.rows[h],s=!0,o=0,l="",!n.isEmpty()){var d;for(let e=0;e<n.chars.length;e++)rV.test(n.chars[e].uchar)&&s?o++:(l+=n.chars[e].uchar,s=!1);n.cueStartTime=t,t===i&&(i+=1e-4),o>=16?o--:o++;let r=ro(l.trim()),f=rf(t,i,r);null!=e&&null!=(d=e.cues)&&d.getCueById(f)||((a=new c(t,i,r)).id=f,a.line=h+1,a.align="left",a.position=10+Math.min(80,10*Math.floor(8*o/32)),u.push(a))}return e&&u.length&&(u.sort((e,t)=>"auto"===e.line||"auto"===t.line?0:e.line>8&&t.line>8?t.line-e.line:e.line-t.line),u.forEach(t=>eJ(e,t))),u}},enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:class extends tW{constructor(e,t,i){super(e,t,i,"[subtitle-stream-controller]",eq.SUBTITLE),this.levels=[],this.currentTrackId=-1,this.tracksBuffered=[],this.mainDetails=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null}_registerListeners(){let{hls:e}=this;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.LEVEL_LOADED,this.onLevelLoaded,this),e.on(E.ERROR,this.onError,this),e.on(E.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(E.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.on(E.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(E.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.on(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.on(E.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.LEVEL_LOADED,this.onLevelLoaded,this),e.off(E.ERROR,this.onError,this),e.off(E.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(E.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),e.off(E.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(E.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),e.off(E.BUFFER_FLUSHING,this.onBufferFlushing,this),e.off(E.FRAG_BUFFERED,this.onFragBuffered,this)}startLoad(e){this.stopLoad(),this.state=tG.IDLE,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}onManifestLoading(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()}onMediaDetaching(){this.tracksBuffered=[],super.onMediaDetaching()}onLevelLoaded(e,t){this.mainDetails=t.details}onSubtitleFragProcessed(e,t){let i;let{frag:r,success:n}=t;if(this.fragPrevious=r,this.state=tG.IDLE,!n)return;let a=this.tracksBuffered[this.currentTrackId];if(!a)return;let s=r.start;for(let e=0;e<a.length;e++)if(s>=a[e].start&&s<=a[e].end){i=a[e];break}let o=r.start+r.duration;i?i.end=o:(i={start:s,end:o},a.push(i)),this.fragmentTracker.fragBuffered(r)}onBufferFlushing(e,t){let{startOffset:i,endOffset:r}=t;if(0===i&&r!==Number.POSITIVE_INFINITY){let e=r-1;if(e<=0)return;t.endOffsetSubtitles=Math.max(0,e),this.tracksBuffered.forEach(t=>{for(let i=0;i<t.length;){if(t[i].end<=e){t.shift();continue}if(t[i].start<e)t[i].start=e;else break;i++}}),this.fragmentTracker.removeFragmentsInRange(i,e,eq.SUBTITLE)}}onFragBuffered(e,t){if(!this.loadedmetadata&&t.frag.type===eq.MAIN){var i;null!=(i=this.media)&&i.buffered.length&&(this.loadedmetadata=!0)}}onError(e,t){let i=t.frag;(null==i?void 0:i.type)===eq.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state!==tG.STOPPED&&(this.state=tG.IDLE))}onSubtitleTracksUpdated(e,{subtitleTracks:t}){if(iB(this.levels,t)){this.levels=t.map(e=>new te(e));return}this.tracksBuffered=[],this.levels=t.map(e=>{let t=new te(e);return this.tracksBuffered[t.id]=[],t}),this.fragmentTracker.removeFragmentsInRange(0,Number.POSITIVE_INFINITY,eq.SUBTITLE),this.fragPrevious=null,this.mediaBuffer=null}onSubtitleTrackSwitch(e,t){if(this.currentTrackId=t.id,!this.levels.length||-1===this.currentTrackId){this.clearInterval();return}let i=this.levels[this.currentTrackId];null!=i&&i.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,i&&this.setInterval(500)}onSubtitleTrackLoaded(e,t){var i;let{details:r,id:n}=t,{currentTrackId:a,levels:s}=this;if(!s.length)return;let o=s[a];if(n>=s.length||n!==a||!o)return;this.mediaBuffer=this.mediaBufferTimeRanges;let l=0;if(r.live||null!=(i=o.details)&&i.live){let e=this.mainDetails;if(r.deltaUpdateFailed||!e)return;let t=e.fragments[0];o.details?0===(l=this.alignPlaylists(r,o.details))&&t&&tn(r,l=t.start):r.hasProgramDateTime&&e.hasProgramDateTime?(tF(r,e),l=r.fragments[0].start):t&&tn(r,l=t.start)}if(o.details=r,this.levelLastLoaded=n,this.startFragRequested||!this.mainDetails&&r.live||this.setStartPosition(o.details,l),this.tick(),r.live&&!this.fragCurrent&&this.media&&this.state===tG.IDLE){let e=tf(null,r.fragments,this.media.currentTime,0);e||(this.warn("Subtitle playlist not aligned with playback"),o.details=void 0)}}_handleFragmentLoadComplete(e){let{frag:t,payload:i}=e,r=t.decryptdata,n=this.hls;if(!this.fragContextChanged(t)&&i&&i.byteLength>0&&r&&r.key&&r.iv&&"AES-128"===r.method){let e=performance.now();this.decrypter.decrypt(new Uint8Array(i),r.key.buffer,r.iv.buffer).catch(e=>{throw n.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.FRAG_DECRYPT_ERROR,fatal:!1,error:e,reason:e.message,frag:t}),e}).then(i=>{let r=performance.now();n.trigger(E.FRAG_DECRYPTED,{frag:t,payload:i,stats:{tstart:e,tdecrypt:r}})}).catch(e=>{this.warn(`${e.name}: ${e.message}`),this.state=tG.IDLE})}}doTick(){if(!this.media){this.state=tG.IDLE;return}if(this.state===tG.IDLE){let{currentTrackId:e,levels:t}=this,i=t[e];if(!t.length||!i||!i.details)return;let{config:r}=this,n=this.getLoadPosition(),a=tk.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],n,r.maxBufferHole),{end:s,len:o}=a,l=this.getFwdBufferInfo(this.media,eq.MAIN),u=i.details,c=this.getMaxBufferLength(null==l?void 0:l.len)+u.levelTargetDuration;if(o>c)return;let d=u.fragments,h=d.length,f=u.edge,p=null,m=this.fragPrevious;if(s<f){let e=r.maxFragLookUpTolerance,t=s>f-e?0:e;(p=tf(m,d,Math.max(d[0].start,s),t))||!m||!(m.start<d[0].start)||(p=d[0])}else p=d[h-1];if(!p)return;if("initSegment"!==(p=this.mapToInitFragWhenRequired(p)).sn){let e=p.sn-u.startSN,t=d[e-1];t&&t.cc===p.cc&&this.fragmentTracker.getState(t)===tE.NOT_LOADED&&(p=t)}this.fragmentTracker.getState(p)===tE.NOT_LOADED&&this.loadFragment(p,i,s)}}getMaxBufferLength(e){let t=super.getMaxBufferLength();return e?Math.max(t,e):t}loadFragment(e,t,i){this.fragCurrent=e,"initSegment"===e.sn?this._loadInitSegment(e,t):(this.startFragRequested=!0,super.loadFragment(e,t,i))}get mediaBufferTimeRanges(){return new iV(this.tracksBuffered[this.currentTrackId]||[])}},subtitleTrackController:class extends tv{constructor(e){super(e,"[subtitle-track-controller]"),this.media=null,this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0,this.queuedDefaultTrack=-1,this.trackChangeListener=()=>this.onTextTracksChanged(),this.asyncPollTrackChange=()=>this.pollTrackChange(0),this.useTextTrackPolling=!1,this.subtitlePollingInterval=-1,this._subtitleDisplay=!0,this.registerListeners()}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,super.destroy()}get subtitleDisplay(){return this._subtitleDisplay}set subtitleDisplay(e){this._subtitleDisplay=e,this.trackId>-1&&this.toggleTrackModes(this.trackId)}registerListeners(){let{hls:e}=this;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.LEVEL_LOADING,this.onLevelLoading,this),e.on(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(E.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.on(E.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.LEVEL_LOADING,this.onLevelLoading,this),e.off(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(E.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),e.off(E.ERROR,this.onError,this)}onMediaAttached(e,t){this.media=t.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))}pollTrackChange(e){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,e)}onMediaDetaching(){if(!this.media)return;self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);let e=iz(this.media.textTracks);e.forEach(e=>{eQ(e)}),this.subtitleTrack=-1,this.media=null}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.subtitleTracks}onSubtitleTrackLoaded(e,t){let{id:i,details:r}=t,{trackId:n}=this,a=this.tracksInGroup[n];if(!a){this.warn(`Invalid subtitle track id ${i}`);return}let s=a.details;a.details=t.details,this.log(`subtitle track ${i} loaded [${r.startSN}-${r.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,s)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){let t=this.hls.levels[e];if(!(null!=t&&t.textGroupIds))return;let i=t.textGroupIds[t.urlId],r=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;if(this.groupId!==i){let e=this.tracks.filter(e=>!i||e.groupId===i);this.tracksInGroup=e;let t=this.findTrackId(null==r?void 0:r.name)||this.findTrackId();this.groupId=i||null,this.log(`Updating subtitle tracks, ${e.length} track(s) found in "${i}" group-id`),this.hls.trigger(E.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:e}),-1!==t&&this.setSubtitleTrack(t,r)}else this.shouldReloadPlaylist(r)&&this.setSubtitleTrack(this.trackId,r)}findTrackId(e){let t=this.tracksInGroup;for(let i=0;i<t.length;i++){let r=t[i];if((!this.selectDefaultTrack||r.default)&&(!e||e===r.name))return r.id}return -1}onError(e,t){!t.fatal&&t.context&&t.context.type===e$.SUBTITLE_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&this.checkRetry(t)}get subtitleTracks(){return this.tracksInGroup}get subtitleTrack(){return this.trackId}set subtitleTrack(e){this.selectDefaultTrack=!1;let t=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(e,t)}loadPlaylist(e){super.loadPlaylist();let t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){let i=t.id,r=t.groupId,n=t.url;if(e)try{n=e.addDirectives(n)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`Loading subtitle playlist for id ${i}`),this.hls.trigger(E.SUBTITLE_TRACK_LOADING,{url:n,id:i,groupId:r,deliveryDirectives:e||null})}}toggleTrackModes(e){let{media:t,trackId:i}=this;if(!t)return;let r=iz(t.textTracks),n=r.filter(e=>e.groupId===this.groupId);if(-1===e)[].slice.call(r).forEach(e=>{e.mode="disabled"});else{let e=n[i];e&&(e.mode="disabled")}let a=n[e];a&&(a.mode=this.subtitleDisplay?"showing":"hidden")}setSubtitleTrack(e,t){var i;let r=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=e;return}if(this.trackId!==e&&this.toggleTrackModes(e),this.trackId===e&&(-1===e||null!=(i=r[e])&&i.details)||e<-1||e>=r.length)return;this.clearTimer();let n=r[e];if(this.log(`Switching to subtitle-track ${e}`+(n?` "${n.name}" lang:${n.lang} group:${n.groupId}`:"")),this.trackId=e,n){let{id:e,groupId:i="",name:r,type:a,url:s}=n;this.hls.trigger(E.SUBTITLE_TRACK_SWITCH,{id:e,groupId:i,name:r,type:a,url:s});let o=this.switchParams(n.url,null==t?void 0:t.details);this.loadPlaylist(o)}else this.hls.trigger(E.SUBTITLE_TRACK_SWITCH,{id:e})}onTextTracksChanged(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!this.media||!this.hls.config.renderTextTracksNatively)return;let e=-1,t=iz(this.media.textTracks);for(let i=0;i<t.length;i++)if("hidden"===t[i].mode)e=i;else if("showing"===t[i].mode){e=i;break}this.subtitleTrack!==e&&(this.subtitleTrack=e)}},timelineController:class{constructor(e){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=rw(),this.captionsProperties=void 0,this.hls=e,this.config=e.config,this.Cues=e.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){let e=new i9(this,"textTrack1"),t=new i9(this,"textTrack2"),i=new i9(this,"textTrack3"),r=new i9(this,"textTrack4");this.cea608Parser1=new i4(1,e,t),this.cea608Parser2=new i4(3,i,r)}e.on(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(E.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.on(E.FRAG_LOADING,this.onFragLoading,this),e.on(E.FRAG_LOADED,this.onFragLoaded,this),e.on(E.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.on(E.FRAG_DECRYPTED,this.onFragDecrypted,this),e.on(E.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(E.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.on(E.BUFFER_FLUSHING,this.onBufferFlushing,this)}destroy(){let{hls:e}=this;e.off(E.MEDIA_ATTACHING,this.onMediaAttaching,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(E.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),e.off(E.FRAG_LOADING,this.onFragLoading,this),e.off(E.FRAG_LOADED,this.onFragLoaded,this),e.off(E.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),e.off(E.FRAG_DECRYPTED,this.onFragDecrypted,this),e.off(E.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(E.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),e.off(E.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null}addCues(e,t,i,r,n){let a=!1;for(let e=n.length;e--;){var s;let r=n[e],o=(s=r[0],Math.min(r[1],i)-Math.max(s,t));if(o>=0&&(r[0]=Math.min(r[0],t),r[1]=Math.max(r[1],i),a=!0,o/(i-t)>.5))return}if(a||n.push([t,i]),this.config.renderTextTracksNatively){let n=this.captionsTracks[e];this.Cues.newCue(n,t,i,r)}else{let n=this.Cues.newCue(null,t,i,r);this.hls.trigger(E.CUES_PARSED,{type:"captions",cues:n,track:e})}}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:n}){let{unparsedVttFrags:a}=this;"main"===i&&(this.initPTS[t.cc]={baseTime:r,timescale:n}),a.length&&(this.unparsedVttFrags=[],a.forEach(e=>{this.onFragLoaded(E.FRAG_LOADED,e)}))}getExistingTrack(e){let{media:t}=this;if(t)for(let i=0;i<t.textTracks.length;i++){let r=t.textTracks[i];if(r[e])return r}return null}createCaptionsTrack(e){this.config.renderTextTracksNatively?this.createNativeTrack(e):this.createNonNativeTrack(e)}createNativeTrack(e){if(this.captionsTracks[e])return;let{captionsProperties:t,captionsTracks:i,media:r}=this,{label:n,languageCode:a}=t[e],s=this.getExistingTrack(e);if(s)i[e]=s,eQ(i[e]),eZ(i[e],r);else{let t=this.createTextTrack("captions",n,a);t&&(t[e]=!0,i[e]=t)}}createNonNativeTrack(e){if(this.nonNativeCaptionsTracks[e])return;let t=this.captionsProperties[e];if(!t)return;let i=t.label,r={_id:e,label:i,kind:"captions",default:!!t.media&&!!t.media.default,closedCaptions:t.media};this.nonNativeCaptionsTracks[e]=r,this.hls.trigger(E.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[r]})}createTextTrack(e,t,i){let r=this.media;if(r)return r.addTextTrack(e,t,i)}onMediaAttaching(e,t){this.media=t.media,this._cleanTracks()}onMediaDetaching(){let{captionsTracks:e}=this;Object.keys(e).forEach(t=>{eQ(e[t]),delete e[t]}),this.nonNativeCaptionsTracks={}}onManifestLoading(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=rw(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=[],this.initPTS=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())}_cleanTracks(){let{media:e}=this;if(!e)return;let t=e.textTracks;if(t)for(let e=0;e<t.length;e++)eQ(t[e])}onSubtitleTracksUpdated(e,t){let i=t.subtitleTracks||[],r=i.some(e=>e.textCodec===rm);if(this.config.enableWebVTT||r&&this.config.enableIMSC1){let e=iB(this.tracks,i);if(e){this.tracks=i;return}if(this.textTracks=[],this.tracks=i,this.config.renderTextTracksNatively){let e=this.media?this.media.textTracks:null;this.tracks.forEach((t,i)=>{let r;if(e&&i<e.length){let i=null;for(let r=0;r<e.length;r++){var n;if((n=e[r])&&n.label===t.name&&!(n.textTrack1||n.textTrack2)){i=e[r];break}}i&&(r=i)}if(r)eQ(r);else{let e=this._captionsOrSubtitlesFromCharacteristics(t);(r=this.createTextTrack(e,t.name,t.lang))&&(r.mode="disabled")}r&&(r.groupId=t.groupId,this.textTracks.push(r))})}else if(this.tracks.length){let e=this.tracks.map(e=>({label:e.name,kind:e.type.toLowerCase(),default:e.default,subtitleTrack:e}));this.hls.trigger(E.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:e})}}}_captionsOrSubtitlesFromCharacteristics(e){if(e.attrs.CHARACTERISTICS){let t=/transcribes-spoken-dialog/gi.test(e.attrs.CHARACTERISTICS),i=/describes-music-and-sound/gi.test(e.attrs.CHARACTERISTICS);if(t&&i)return"captions"}return"subtitles"}onManifestLoaded(e,t){this.config.enableCEA708Captions&&t.captions&&t.captions.forEach(e=>{let t=/(?:CC|SERVICE)([1-4])/.exec(e.instreamId);if(!t)return;let i=`textTrack${t[1]}`,r=this.captionsProperties[i];r&&(r.label=e.name,e.lang&&(r.languageCode=e.lang),r.media=e)})}closedCaptionsForLevel(e){let t=this.hls.levels[e.level];return null==t?void 0:t.attrs["CLOSED-CAPTIONS"]}onFragLoading(e,t){let{cea608Parser1:i,cea608Parser2:r,lastSn:n,lastPartIndex:a}=this;if(this.enabled&&i&&r&&t.frag.type===eq.MAIN){var s,o;let e=t.frag.sn,l=null!=(s=null==t?void 0:null==(o=t.part)?void 0:o.index)?s:-1;e===n+1||e===n&&l===a+1||(i.reset(),r.reset()),this.lastSn=e,this.lastPartIndex=l}}onFragLoaded(e,t){let{frag:i,payload:r}=t;if(i.type===eq.SUBTITLE){if(r.byteLength){let e=i.decryptdata,n="stats"in t;if(null==e||!e.encrypted||n){let e=this.tracks[i.level],n=this.vttCCs;n[i.cc]||(n[i.cc]={start:i.start,prevCC:this.prevCC,new:!0},this.prevCC=i.cc),e&&e.textCodec===rm?this._parseIMSC1(i,r):this._parseVTTs(t)}}else this.hls.trigger(E.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:Error("Empty subtitle payload")})}}_parseIMSC1(e,t){let i=this.hls;rb(t,this.initPTS[e.cc],t=>{this._appendCues(t,e.level),i.trigger(E.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:e})},t=>{M.log(`Failed to parse IMSC1: ${t}`),i.trigger(E.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:e,error:t})})}_parseVTTs(e){var t;let{frag:i,payload:r}=e,{initPTS:n,unparsedVttFrags:a}=this,s=n.length-1;if(!n[i.cc]&&-1===s){a.push(e);return}let o=this.hls,l=null!=(t=i.initSegment)&&t.data?e_(i.initSegment.data,new Uint8Array(r)):r;!function(e,t,i,r,n,a,s){let o;let l=new rl,u=el(new Uint8Array(e)).trim().replace(ru,"\n").split("\n"),c=[],d=t?function(e,t=1){return ih(e,9e4,1/t)}(t.baseTime,t.timescale):0,h="00:00.000",f=0,p=0,m=!0;l.oncue=function(e){let a=i[r],s=i.ccOffset,l=(f-d)/9e4;if(null!=a&&a.new&&(void 0!==p?s=i.ccOffset=a.start:rp(i,r,l)),l){if(!t){o=Error("Missing initPTS for VTT MPEGTS");return}s=l-i.presentationOffset}let u=e.endTime-e.startTime,h=iy((e.startTime+s-p)*9e4,9e4*n)/9e4;e.startTime=Math.max(h,0),e.endTime=Math.max(h+u,0);let m=e.text.trim();e.text=decodeURIComponent(encodeURIComponent(m)),e.id||(e.id=rf(e.startTime,e.endTime,m)),e.endTime>0&&c.push(e)},l.onparsingerror=function(e){o=e},l.onflush=function(){if(o){s(o);return}a(c)},u.forEach(e=>{if(m){if(rc(e,"X-TIMESTAMP-MAP=")){m=!1,e.slice(16).split(",").forEach(e=>{rc(e,"LOCAL:")?h=e.slice(6):rc(e,"MPEGTS:")&&(f=parseInt(e.slice(7)))});try{p=rd(h)/1e3}catch(e){o=e}return}""===e&&(m=!1)}l.parse(e+"\n")}),l.flush()}(l,this.initPTS[i.cc],this.vttCCs,i.cc,i.start,e=>{this._appendCues(e,i.level),o.trigger(E.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:i})},t=>{let n="Missing initPTS for VTT MPEGTS"===t.message;n?a.push(e):this._fallbackToIMSC1(i,r),M.log(`Failed to parse VTT cue: ${t}`),n&&s>i.cc||o.trigger(E.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:i,error:t})})}_fallbackToIMSC1(e,t){let i=this.tracks[e.level];i.textCodec||rb(t,this.initPTS[e.cc],()=>{i.textCodec=rm,this._parseIMSC1(e,t)},()=>{i.textCodec="wvtt"})}_appendCues(e,t){let i=this.hls;if(this.config.renderTextTracksNatively){let i=this.textTracks[t];if(!i||"disabled"===i.mode)return;e.forEach(e=>eJ(i,e))}else{let r=this.tracks[t];if(!r)return;let n=r.default?"default":"subtitles"+t;i.trigger(E.CUES_PARSED,{type:"subtitles",cues:e,track:n})}}onFragDecrypted(e,t){let{frag:i}=t;i.type===eq.SUBTITLE&&this.onFragLoaded(E.FRAG_LOADED,t)}onSubtitleTracksCleared(){this.tracks=[],this.captionsTracks={}}onFragParsingUserdata(e,t){let{cea608Parser1:i,cea608Parser2:r}=this;if(!this.enabled||!(i&&r))return;let{frag:n,samples:a}=t;if(n.type!==eq.MAIN||"NONE"!==this.closedCaptionsForLevel(n))for(let e=0;e<a.length;e++){let t=a[e].bytes;if(t){let n=this.extractCea608Data(t);i.addData(a[e].pts,n[0]),r.addData(a[e].pts,n[1])}}}onBufferFlushing(e,{startOffset:t,endOffset:i,endOffsetSubtitles:r,type:n}){let{media:a}=this;if(a&&!(a.currentTime<i)){if(!n||"video"===n){let{captionsTracks:e}=this;Object.keys(e).forEach(r=>e0(e[r],t,i))}if(this.config.renderTextTracksNatively&&0===t&&void 0!==r){let{textTracks:e}=this;Object.keys(e).forEach(i=>e0(e[i],t,r))}}}extractCea608Data(e){let t=[[],[]],i=31&e[0],r=2;for(let n=0;n<i;n++){let i=e[r++],n=127&e[r++],a=127&e[r++];if(0===n&&0===a)continue;let s=(4&i)!=0;if(s){let e=3&i;(0===e||1===e)&&(t[e].push(n),t[e].push(a))}}return t}},audioStreamController:class extends tW{constructor(e,t,i){super(e,t,i,"[audio-stream-controller]",eq.AUDIO),this.videoBuffer=null,this.videoTrackCC=-1,this.waitingVideoCC=-1,this.bufferedTrack=null,this.switchingTrack=null,this.trackId=-1,this.waitingData=null,this.mainDetails=null,this.bufferFlushed=!1,this.cachedTrackLoadedData=null,this._registerListeners()}onHandlerDestroying(){this._unregisterListeners(),this.mainDetails=null,this.bufferedTrack=null,this.switchingTrack=null}_registerListeners(){let{hls:e}=this;e.on(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.on(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.LEVEL_LOADED,this.onLevelLoaded,this),e.on(E.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.on(E.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.on(E.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(E.ERROR,this.onError,this),e.on(E.BUFFER_RESET,this.onBufferReset,this),e.on(E.BUFFER_CREATED,this.onBufferCreated,this),e.on(E.BUFFER_FLUSHED,this.onBufferFlushed,this),e.on(E.INIT_PTS_FOUND,this.onInitPtsFound,this),e.on(E.FRAG_BUFFERED,this.onFragBuffered,this)}_unregisterListeners(){let{hls:e}=this;e.off(E.MEDIA_ATTACHED,this.onMediaAttached,this),e.off(E.MEDIA_DETACHING,this.onMediaDetaching,this),e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.LEVEL_LOADED,this.onLevelLoaded,this),e.off(E.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),e.off(E.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),e.off(E.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(E.ERROR,this.onError,this),e.off(E.BUFFER_RESET,this.onBufferReset,this),e.off(E.BUFFER_CREATED,this.onBufferCreated,this),e.off(E.BUFFER_FLUSHED,this.onBufferFlushed,this),e.off(E.INIT_PTS_FOUND,this.onInitPtsFound,this),e.off(E.FRAG_BUFFERED,this.onFragBuffered,this)}onInitPtsFound(e,{frag:t,id:i,initPTS:r,timescale:n}){if("main"===i){let e=t.cc;this.initPTS[t.cc]={baseTime:r,timescale:n},this.log(`InitPTS for cc: ${e} found from main: ${r}`),this.videoTrackCC=e,this.state===tG.WAITING_INIT_PTS&&this.tick()}}startLoad(e){if(!this.levels){this.startPosition=e,this.state=tG.STOPPED;return}let t=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),t>0&&-1===e?(this.log(`Override startPosition with lastCurrentTime @${t.toFixed(3)}`),e=t,this.state=tG.IDLE):(this.loadedmetadata=!1,this.state=tG.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=e,this.tick()}doTick(){var e,t;switch(this.state){case tG.IDLE:this.doTickIdle();break;case tG.WAITING_TRACK:{let{levels:t,trackId:i}=this,r=null==t?void 0:null==(e=t[i])?void 0:e.details;if(r){if(this.waitForCdnTuneIn(r))break;this.state=tG.WAITING_INIT_PTS}break}case tG.FRAG_LOADING_WAITING_RETRY:{let e=performance.now(),i=this.retryDate;(!i||e>=i||null!=(t=this.media)&&t.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=tG.IDLE);break}case tG.WAITING_INIT_PTS:{let e=this.waitingData;if(e){let{frag:t,part:i,cache:r,complete:n}=e;if(void 0!==this.initPTS[t.cc]){this.waitingData=null,this.waitingVideoCC=-1,this.state=tG.FRAG_LOADING;let e=r.flush(),a={frag:t,part:i,payload:e,networkDetails:null};this._handleFragmentLoadProgress(a),n&&super._handleFragmentLoadComplete(a)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log(`Waiting fragment cc (${t.cc}) cancelled because video is at cc ${this.videoTrackCC}`),this.clearWaitingFragment();else{let e=this.getLoadPosition(),i=tk.bufferInfo(this.mediaBuffer,e,this.config.maxBufferHole),r=tp(i.end,this.config.maxFragLookUpTolerance,t);r<0&&(this.log(`Waiting fragment cc (${t.cc}) @ ${t.start} cancelled because another fragment at ${i.end} is needed`),this.clearWaitingFragment())}}else this.state=tG.IDLE}}this.onTickEnd()}clearWaitingFragment(){let e=this.waitingData;e&&(this.fragmentTracker.removeFragment(e.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=tG.IDLE)}resetLoadingState(){this.clearWaitingFragment(),super.resetLoadingState()}onTickEnd(){let{media:e}=this;null!=e&&e.readyState&&(this.lastCurrentTime=e.currentTime)}doTickIdle(){let{hls:e,levels:t,media:i,trackId:r}=this,n=e.config;if(!(null!=t&&t[r])||!i&&(this.startFragRequested||!n.startFragPrefetch))return;let a=t[r],s=a.details;if(!s||s.live&&this.levelLastLoaded!==r||this.waitForCdnTuneIn(s)){this.state=tG.WAITING_TRACK;return}let o=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&o&&(this.bufferFlushed=!1,this.afterBufferFlushed(o,D.AUDIO,eq.AUDIO));let l=this.getFwdBufferInfo(o,eq.AUDIO);if(null===l)return;let{bufferedTrack:u,switchingTrack:c}=this;if(!c&&this._streamEnded(l,s)){e.trigger(E.BUFFER_EOS,{type:"audio"}),this.state=tG.ENDED;return}let d=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,eq.MAIN),h=l.len,f=this.getMaxBufferLength(null==d?void 0:d.len);if(h>=f&&!c)return;let p=s.fragments[0].start,m=l.end;if(c&&i){let e=this.getLoadPosition();u&&c.attrs!==u.attrs&&(m=e),s.PTSKnown&&e<p&&(l.end>p||l.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=p+.05)}let g=this.getNextFragment(m,s),v=!1;if(g&&this.isLoopLoading(g,m)&&(v=!!g.gap,g=this.getNextFragmentLoopLoading(g,s,l,eq.MAIN,f)),!g){this.bufferFlushed=!0;return}let y=d&&g.start>d.end+s.targetduration;if(y||!(null!=d&&d.len)&&l.len){let e=this.getAppendedFrag(g.start,eq.MAIN);if(null===e||(v||(v=!!e.gap||!!y&&0===d.len),y&&!v||v&&l.nextStart&&l.nextStart<e.end))return}this.loadFragment(g,a,m)}getMaxBufferLength(e){let t=super.getMaxBufferLength();return e?Math.min(Math.max(t,e),this.config.maxMaxBufferLength):t}onMediaDetaching(){this.videoBuffer=null,super.onMediaDetaching()}onAudioTracksUpdated(e,{audioTracks:t}){this.resetTransmuxer(),this.levels=t.map(e=>new te(e))}onAudioTrackSwitching(e,t){let i=!!t.url;this.trackId=t.id;let{fragCurrent:r}=this;r&&(r.abortRequests(),this.removeUnbufferedFrags(r.start)),this.resetLoadingState(),i?this.setInterval(100):this.resetTransmuxer(),i?(this.switchingTrack=t,this.state=tG.IDLE):(this.switchingTrack=null,this.bufferedTrack=t,this.state=tG.STOPPED),this.tick()}onManifestLoading(){this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1,this.levels=this.mainDetails=this.waitingData=this.bufferedTrack=this.cachedTrackLoadedData=this.switchingTrack=null,this.startFragRequested=!1,this.trackId=this.videoTrackCC=this.waitingVideoCC=-1}onLevelLoaded(e,t){this.mainDetails=t.details,null!==this.cachedTrackLoadedData&&(this.hls.trigger(E.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)}onAudioTrackLoaded(e,t){var i;if(null==this.mainDetails){this.cachedTrackLoadedData=t;return}let{levels:r}=this,{details:n,id:a}=t;if(!r){this.warn(`Audio tracks were reset while loading level ${a}`);return}this.log(`Track ${a} loaded [${n.startSN},${n.endSN}]${n.lastPartSn?`[part-${n.lastPartSn}-${n.lastPartIndex}]`:""},duration:${n.totalduration}`);let s=r[a],o=0;if(n.live||null!=(i=s.details)&&i.live){this.checkLiveUpdate(n);let e=this.mainDetails;if(n.deltaUpdateFailed||!e)return;!s.details&&n.hasProgramDateTime&&e.hasProgramDateTime?(tF(n,e),o=n.fragments[0].start):o=this.alignPlaylists(n,s.details)}s.details=n,this.levelLastLoaded=a,this.startFragRequested||!this.mainDetails&&n.live||this.setStartPosition(s.details,o),this.state!==tG.WAITING_TRACK||this.waitForCdnTuneIn(n)||(this.state=tG.IDLE),this.tick()}_handleFragmentLoadProgress(e){var t;let{frag:i,part:r,payload:n}=e,{config:a,trackId:s,levels:o}=this;if(!o){this.warn(`Audio tracks were reset while fragment load was in progress. Fragment ${i.sn} of level ${i.level} will not be buffered`);return}let l=o[s];if(!l){this.warn("Audio track is undefined on fragment load progress");return}let u=l.details;if(!u){this.warn("Audio track details undefined on fragment load progress"),this.removeUnbufferedFrags(i.start);return}let c=a.defaultAudioCodec||l.audioCodec||"mp4a.40.2",d=this.transmuxer;d||(d=this.transmuxer=new iD(this.hls,eq.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));let h=this.initPTS[i.cc],f=null==(t=i.initSegment)?void 0:t.data;if(void 0!==h){let e=r?r.index:-1,t=-1!==e,a=new tD(i.level,i.sn,i.stats.chunkCount,n.byteLength,e,t);d.push(n,f,c,"",i,r,u.totalduration,!1,a,h)}else{this.log(`Unknown video PTS for cc ${i.cc}, waiting for video PTS before demuxing audio frag ${i.sn} of [${u.startSN} ,${u.endSN}],track ${s}`);let{cache:e}=this.waitingData=this.waitingData||{frag:i,part:r,cache:new iF,complete:!1};e.push(new Uint8Array(n)),this.waitingVideoCC=this.videoTrackCC,this.state=tG.WAITING_INIT_PTS}}_handleFragmentLoadComplete(e){if(this.waitingData){this.waitingData.complete=!0;return}super._handleFragmentLoadComplete(e)}onBufferReset(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1}onBufferCreated(e,t){let i=t.tracks.audio;i&&(this.mediaBuffer=i.buffer||null),t.tracks.video&&(this.videoBuffer=t.tracks.video.buffer||null)}onFragBuffered(e,t){let{frag:i,part:r}=t;if(i.type!==eq.AUDIO){if(!this.loadedmetadata&&i.type===eq.MAIN){let e=this.videoBuffer||this.media;if(e){let t=tk.getBuffered(e);t.length&&(this.loadedmetadata=!0)}}return}if(this.fragContextChanged(i)){this.warn(`Fragment ${i.sn}${r?" p: "+r.index:""} of level ${i.level} finished buffering, but was aborted. state: ${this.state}, audioSwitch: ${this.switchingTrack?this.switchingTrack.name:"false"}`);return}if("initSegment"!==i.sn){this.fragPrevious=i;let e=this.switchingTrack;e&&(this.bufferedTrack=e,this.switchingTrack=null,this.hls.trigger(E.AUDIO_TRACK_SWITCHED,y({},e)))}this.fragBufferedComplete(i,r)}onError(e,t){var i;if(t.fatal){this.state=tG.ERROR;return}switch(t.details){case x.FRAG_GAP:case x.FRAG_PARSING_ERROR:case x.FRAG_DECRYPT_ERROR:case x.FRAG_LOAD_ERROR:case x.FRAG_LOAD_TIMEOUT:case x.KEY_LOAD_ERROR:case x.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(eq.AUDIO,t);break;case x.AUDIO_TRACK_LOAD_ERROR:case x.AUDIO_TRACK_LOAD_TIMEOUT:case x.LEVEL_PARSING_ERROR:t.levelRetry||this.state!==tG.WAITING_TRACK||(null==(i=t.context)?void 0:i.type)!==e$.AUDIO_TRACK||(this.state=tG.IDLE);break;case x.BUFFER_FULL_ERROR:if(!t.parent||"audio"!==t.parent)return;this.reduceLengthAndFlushBuffer(t)&&(this.bufferedTrack=null,super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio"));break;case x.INTERNAL_EXCEPTION:this.recoverWorkerError(t)}}onBufferFlushed(e,{type:t}){t===D.AUDIO&&(this.bufferFlushed=!0,this.state===tG.ENDED&&(this.state=tG.IDLE))}_handleTransmuxComplete(e){var t;let i="audio",{hls:r}=this,{remuxResult:n,chunkMeta:a}=e,s=this.getCurrentContext(a);if(!s){this.resetWhenMissingContext(a);return}let{frag:o,part:l,level:u}=s,{details:c}=u,{audio:d,text:h,id3:f,initSegment:p}=n;if(this.fragContextChanged(o)||!c){this.fragmentTracker.removeFragment(o);return}if(this.state=tG.PARSING,this.switchingTrack&&d&&this.completeAudioSwitch(this.switchingTrack),null!=p&&p.tracks){let e=o.initSegment||o;this._bufferInitSegment(p.tracks,e,a),r.trigger(E.FRAG_PARSING_INIT_SEGMENT,{frag:e,id:i,tracks:p.tracks})}if(d){let{startPTS:e,endPTS:t,startDTS:i,endDTS:r}=d;l&&(l.elementaryStreams[D.AUDIO]={startPTS:e,endPTS:t,startDTS:i,endDTS:r}),o.setElementaryStreamInfo(D.AUDIO,e,t,i,r),this.bufferFragmentData(d,o,l,a)}if(null!=f&&null!=(t=f.samples)&&t.length){let e=b({id:i,frag:o,details:c},f);r.trigger(E.FRAG_PARSING_METADATA,e)}if(h){let e=b({id:i,frag:o,details:c},h);r.trigger(E.FRAG_PARSING_USERDATA,e)}}_bufferInitSegment(e,t,i){if(this.state!==tG.PARSING)return;e.video&&delete e.video;let r=e.audio;if(!r)return;r.levelCodec=r.codec,r.id="audio",this.log(`Init audio buffer, container:${r.container}, codecs[parsed]=[${r.codec}]`),this.hls.trigger(E.BUFFER_CODECS,e);let n=r.initSegment;if(null!=n&&n.byteLength){let e={type:"audio",frag:t,part:null,chunkMeta:i,parent:t.type,data:n};this.hls.trigger(E.BUFFER_APPENDING,e)}this.tick()}loadFragment(e,t,i){let r=this.fragmentTracker.getState(e);if(this.fragCurrent=e,this.switchingTrack||r===tE.NOT_LOADED||r===tE.PARTIAL){var n;"initSegment"===e.sn?this._loadInitSegment(e,t):null!=(n=t.details)&&n.live&&!this.initPTS[e.cc]?(this.log(`Waiting for video PTS in continuity counter ${e.cc} of live stream before loading audio fragment ${e.sn} of level ${this.trackId}`),this.state=tG.WAITING_INIT_PTS):(this.startFragRequested=!0,super.loadFragment(e,t,i))}else this.clearTrackerIfNeeded(e)}completeAudioSwitch(e){let{hls:t,media:i,bufferedTrack:r}=this,n=null==r?void 0:r.attrs,a=e.attrs;i&&n&&(n.CHANNELS!==a.CHANNELS||n.NAME!==a.NAME||n.LANGUAGE!==a.LANGUAGE)&&(this.log("Switching audio track : flushing all audio"),super.flushMainBuffer(0,Number.POSITIVE_INFINITY,"audio")),this.bufferedTrack=e,this.switchingTrack=null,t.trigger(E.AUDIO_TRACK_SWITCHED,y({},e))}},audioTrackController:class extends tv{constructor(e){super(e,"[audio-track-controller]"),this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0,this.registerListeners()}registerListeners(){let{hls:e}=this;e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.LEVEL_LOADING,this.onLevelLoading,this),e.on(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.on(E.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.on(E.ERROR,this.onError,this)}unregisterListeners(){let{hls:e}=this;e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.LEVEL_LOADING,this.onLevelLoading,this),e.off(E.LEVEL_SWITCHING,this.onLevelSwitching,this),e.off(E.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),e.off(E.ERROR,this.onError,this)}destroy(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.currentTrack=null,super.destroy()}onManifestLoading(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.currentTrack=null,this.selectDefaultTrack=!0}onManifestParsed(e,t){this.tracks=t.audioTracks||[]}onAudioTrackLoaded(e,t){let{id:i,groupId:r,details:n}=t,a=this.tracksInGroup[i];if(!a||a.groupId!==r){this.warn(`Track with id:${i} and group:${r} not found in active group ${a.groupId}`);return}let s=a.details;a.details=t.details,this.log(`audio-track ${i} "${a.name}" lang:${a.lang} group:${r} loaded [${n.startSN}-${n.endSN}]`),i===this.trackId&&this.playlistLoaded(i,t,s)}onLevelLoading(e,t){this.switchLevel(t.level)}onLevelSwitching(e,t){this.switchLevel(t.level)}switchLevel(e){let t=this.hls.levels[e];if(!(null!=t&&t.audioGroupIds))return;let i=t.audioGroupIds[t.urlId];if(this.groupId!==i){this.groupId=i||null;let e=this.tracks.filter(e=>!i||e.groupId===i);this.selectDefaultTrack&&!e.some(e=>e.default)&&(this.selectDefaultTrack=!1),this.tracksInGroup=e,this.log(`Updating audio tracks, ${e.length} track(s) found in group:${i}`),this.hls.trigger(E.AUDIO_TRACKS_UPDATED,{audioTracks:e}),this.selectInitialTrack()}else this.shouldReloadPlaylist(this.currentTrack)&&this.setAudioTrack(this.trackId)}onError(e,t){!t.fatal&&t.context&&t.context.type===e$.AUDIO_TRACK&&t.context.id===this.trackId&&t.context.groupId===this.groupId&&(this.requestScheduled=-1,this.checkRetry(t))}get audioTracks(){return this.tracksInGroup}get audioTrack(){return this.trackId}set audioTrack(e){this.selectDefaultTrack=!1,this.setAudioTrack(e)}setAudioTrack(e){let t=this.tracksInGroup;if(e<0||e>=t.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();let i=this.currentTrack;t[this.trackId];let r=t[e],{groupId:n,name:a}=r;if(this.log(`Switching to audio-track ${e} "${a}" lang:${r.lang} group:${n}`),this.trackId=e,this.currentTrack=r,this.selectDefaultTrack=!1,this.hls.trigger(E.AUDIO_TRACK_SWITCHING,y({},r)),r.details&&!r.details.live)return;let s=this.switchParams(r.url,null==i?void 0:i.details);this.loadPlaylist(s)}selectInitialTrack(){let e=this.tracksInGroup,t=this.findTrackId(this.currentTrack)|this.findTrackId(null);if(-1!==t)this.setAudioTrack(t);else{let t=Error(`No track found for running audio group-ID: ${this.groupId} track count: ${e.length}`);this.warn(t.message),this.hls.trigger(E.ERROR,{type:S.MEDIA_ERROR,details:x.AUDIO_TRACK_LOAD_ERROR,fatal:!0,error:t})}}findTrackId(e){let t=this.tracksInGroup;for(let i=0;i<t.length;i++){let r=t[i];if((!this.selectDefaultTrack||r.default)&&(!e||void 0!==e.attrs["STABLE-RENDITION-ID"]&&e.attrs["STABLE-RENDITION-ID"]===r.attrs["STABLE-RENDITION-ID"]||e.name===r.name&&e.lang===r.lang))return r.id}return -1}loadPlaylist(e){super.loadPlaylist();let t=this.tracksInGroup[this.trackId];if(this.shouldLoadPlaylist(t)){let i=t.id,r=t.groupId,n=t.url;if(e)try{n=e.addDirectives(n)}catch(e){this.warn(`Could not construct new URL with HLS Delivery Directives: ${e}`)}this.log(`loading audio-track playlist ${i} "${t.name}" lang:${t.lang} group:${r}`),this.clearTimer(),this.hls.trigger(E.AUDIO_TRACK_LOADING,{url:n,id:i,groupId:r,deliveryDirectives:e||null})}}},emeController:rR,cmcdController:rL,contentSteeringController:class{constructor(e){this.hls=void 0,this.log=void 0,this.loader=null,this.uri=null,this.pathwayId=".",this.pathwayPriority=null,this.timeToLoad=300,this.reloadTimer=-1,this.updated=0,this.started=!1,this.enabled=!0,this.levels=null,this.audioTracks=null,this.subtitleTracks=null,this.penalizedPathways={},this.hls=e,this.log=M.log.bind(M,"[content-steering]:"),this.registerListeners()}registerListeners(){let e=this.hls;e.on(E.MANIFEST_LOADING,this.onManifestLoading,this),e.on(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.on(E.MANIFEST_PARSED,this.onManifestParsed,this),e.on(E.ERROR,this.onError,this)}unregisterListeners(){let e=this.hls;e&&(e.off(E.MANIFEST_LOADING,this.onManifestLoading,this),e.off(E.MANIFEST_LOADED,this.onManifestLoaded,this),e.off(E.MANIFEST_PARSED,this.onManifestParsed,this),e.off(E.ERROR,this.onError,this))}startLoad(){if(this.started=!0,self.clearTimeout(this.reloadTimer),this.enabled&&this.uri){if(this.updated){let e=Math.max(1e3*this.timeToLoad-(performance.now()-this.updated),0);this.scheduleRefresh(this.uri,e)}else this.loadSteeringManifest(this.uri)}}stopLoad(){this.started=!1,this.loader&&(this.loader.destroy(),this.loader=null),self.clearTimeout(this.reloadTimer)}destroy(){this.unregisterListeners(),this.stopLoad(),this.hls=null,this.levels=this.audioTracks=this.subtitleTracks=null}removeLevel(e){let t=this.levels;t&&(this.levels=t.filter(t=>t!==e))}onManifestLoading(){this.stopLoad(),this.enabled=!0,this.timeToLoad=300,this.updated=0,this.uri=null,this.pathwayId=".",this.levels=this.audioTracks=this.subtitleTracks=null}onManifestLoaded(e,t){let{contentSteering:i}=t;null!==i&&(this.pathwayId=i.pathwayId,this.uri=i.uri,this.started&&this.startLoad())}onManifestParsed(e,t){this.audioTracks=t.audioTracks,this.subtitleTracks=t.subtitleTracks}onError(e,t){let{errorAction:i}=t;if((null==i?void 0:i.action)===tm.SendAlternateToPenaltyBox&&i.flags===tg.MoveAllAlternatesMatchingHost){let e=this.pathwayPriority,t=this.pathwayId;this.penalizedPathways[t]||(this.penalizedPathways[t]=performance.now()),!e&&this.levels&&(e=this.levels.reduce((e,t)=>(-1===e.indexOf(t.pathwayId)&&e.push(t.pathwayId),e),[])),e&&e.length>1&&(this.updatePathwayPriority(e),i.resolved=this.pathwayId!==t)}}filterParsedLevels(e){this.levels=e;let t=this.getLevelsForPathway(this.pathwayId);if(0===t.length){let i=e[0].pathwayId;this.log(`No levels found in Pathway ${this.pathwayId}. Setting initial Pathway to "${i}"`),t=this.getLevelsForPathway(i),this.pathwayId=i}return t.length!==e.length?(this.log(`Found ${t.length}/${e.length} levels in Pathway "${this.pathwayId}"`),t):e}getLevelsForPathway(e){return null===this.levels?[]:this.levels.filter(t=>e===t.pathwayId)}updatePathwayPriority(e){let t;this.pathwayPriority=e;let i=this.penalizedPathways,r=performance.now();Object.keys(i).forEach(e=>{r-i[e]>3e5&&delete i[e]});for(let r=0;r<e.length;r++){let n=e[r];if(i[n])continue;if(n===this.pathwayId)return;let a=this.hls.nextLoadLevel,s=this.hls.levels[a];if((t=this.getLevelsForPathway(n)).length>0){this.log(`Setting Pathway to "${n}"`),this.pathwayId=n,this.hls.trigger(E.LEVELS_UPDATED,{levels:t});let e=this.hls.levels[a];s&&e&&this.levels&&(e.attrs["STABLE-VARIANT-ID"]!==s.attrs["STABLE-VARIANT-ID"]&&e.bitrate!==s.bitrate&&this.log(`Unstable Pathways change from bitrate ${s.bitrate} to ${e.bitrate}`),this.hls.nextLoadLevel=a);break}}}clonePathways(e){let t=this.levels;if(!t)return;let i={},r={};e.forEach(e=>{let{ID:n,"BASE-ID":a,"URI-REPLACEMENT":s}=e;if(t.some(e=>e.pathwayId===n))return;let o=this.getLevelsForPathway(a).map(e=>{let t=b({},e);t.details=void 0,t.url=rD(e.uri,e.attrs["STABLE-VARIANT-ID"],"PER-VARIANT-URIS",s);let a=new I(e.attrs);a["PATHWAY-ID"]=n;let o=a.AUDIO&&`${a.AUDIO}_clone_${n}`,l=a.SUBTITLES&&`${a.SUBTITLES}_clone_${n}`;o&&(i[a.AUDIO]=o,a.AUDIO=o),l&&(r[a.SUBTITLES]=l,a.SUBTITLES=l),t.attrs=a;let u=new te(t);return tb(u,"audio",o),tb(u,"text",l),u});t.push(...o),rk(this.audioTracks,i,s,n),rk(this.subtitleTracks,r,s,n)})}loadSteeringManifest(e){let t;let i=this.hls.config,r=i.loader;this.loader&&this.loader.destroy(),this.loader=new r(i);try{t=new self.URL(e)}catch(t){this.enabled=!1,this.log(`Failed to parse Steering Manifest URI: ${e}`);return}if("data:"!==t.protocol){let e=0|(this.hls.bandwidthEstimate||i.abrEwmaDefaultEstimate);t.searchParams.set("_HLS_pathway",this.pathwayId),t.searchParams.set("_HLS_throughput",""+e)}let n={responseType:"json",url:t.href},a=i.steeringManifestLoadPolicy.default,s=a.errorRetry||a.timeoutRetry||{},o={loadPolicy:a,timeout:a.maxLoadTimeMs,maxRetry:s.maxNumRetry||0,retryDelay:s.retryDelayMs||0,maxRetryDelay:s.maxRetryDelayMs||0};this.log(`Requesting steering manifest: ${t}`),this.loader.load(n,o,{onSuccess:(e,i,r,n)=>{this.log(`Loaded steering manifest: "${t}"`);let a=e.data;if(1!==a.VERSION){this.log(`Steering VERSION ${a.VERSION} not supported!`);return}this.updated=performance.now(),this.timeToLoad=a.TTL;let{"RELOAD-URI":s,"PATHWAY-CLONES":o,"PATHWAY-PRIORITY":l}=a;if(s)try{this.uri=new self.URL(s,t).href}catch(e){this.enabled=!1,this.log(`Failed to parse Steering Manifest RELOAD-URI: ${s}`);return}this.scheduleRefresh(this.uri||r.url),o&&this.clonePathways(o),l&&this.updatePathwayPriority(l)},onError:(e,t,i,r)=>{if(this.log(`Error loading steering manifest: ${e.code} ${e.text} (${t.url})`),this.stopLoad(),410===e.code){this.enabled=!1,this.log(`Steering manifest ${t.url} no longer available`);return}let n=1e3*this.timeToLoad;if(429===e.code){let e=this.loader;if("function"==typeof(null==e?void 0:e.getResponseHeader)){let t=e.getResponseHeader("Retry-After");t&&(n=1e3*parseFloat(t))}this.log(`Steering manifest ${t.url} rate limited`);return}this.scheduleRefresh(this.uri||t.url,n)},onTimeout:(e,t,i)=>{this.log(`Timeout loading steering manifest (${t.url})`),this.scheduleRefresh(this.uri||t.url)}})}scheduleRefresh(e,t=1e3*this.timeToLoad){self.clearTimeout(this.reloadTimer),this.reloadTimer=self.setTimeout(()=>{this.loadSteeringManifest(e)},t)}}});class rj{static get version(){return"1.4.12"}static isSupported(){return function(){let e=eI();if(!e)return!1;let t=t$(),i=e&&"function"==typeof e.isTypeSupported&&e.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),r=!t||t.prototype&&"function"==typeof t.prototype.appendBuffer&&"function"==typeof t.prototype.remove;return!!i&&!!r}()}static get Events(){return E}static get ErrorTypes(){return S}static get ErrorDetails(){return x}static get DefaultConfig(){return rj.defaultConfig?rj.defaultConfig:rz}static set DefaultConfig(e){rj.defaultConfig=e}constructor(e={}){this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new iL,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null,function(e,t){if(self.console&&!0===e||"object"==typeof e){!function(e,...t){t.forEach(function(t){A[t]=e[t]?e[t].bind(e):function(e){let t=self.console[e];return t?t.bind(self.console,`[${e}] >`):T}(t)})}(e,"debug","log","info","warn","error");try{A.log(`Debug logs enabled for "${t}" in hls.js version 1.4.12`)}catch(e){A=w}}else A=w}(e.debug||!1,"Hls instance");let t=this.config=function(e,t){if((t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(void 0!==t.liveMaxLatencyDurationCount&&(void 0===t.liveSyncDurationCount||t.liveMaxLatencyDurationCount<=t.liveSyncDurationCount))throw Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(void 0!==t.liveMaxLatencyDuration&&(void 0===t.liveSyncDuration||t.liveMaxLatencyDuration<=t.liveSyncDuration))throw Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');let i=function e(t){return t&&"object"==typeof t?Array.isArray(t)?t.map(e):Object.keys(t).reduce((i,r)=>(i[r]=e(t[r]),i),{}):t}(e),r=["TimeOut","MaxRetry","RetryDelay","MaxRetryTimeout"];return["manifest","level","frag"].forEach(e=>{let n=`${"level"===e?"playlist":e}LoadPolicy`,a=void 0===t[n],s=[];r.forEach(r=>{let o=`${e}Loading${r}`,l=t[o];if(void 0!==l&&a){s.push(o);let e=i[n].default;switch(t[n]={default:e},r){case"TimeOut":e.maxLoadTimeMs=l,e.maxTimeToFirstByteMs=l;break;case"MaxRetry":e.errorRetry.maxNumRetry=l,e.timeoutRetry.maxNumRetry=l;break;case"RetryDelay":e.errorRetry.retryDelayMs=l,e.timeoutRetry.retryDelayMs=l;break;case"MaxRetryTimeout":e.errorRetry.maxRetryDelayMs=l,e.timeoutRetry.maxRetryDelayMs=l}}}),s.length&&M.warn(`hls.js config: "${s.join('", "')}" setting(s) are deprecated, use "${n}": ${JSON.stringify(t[n])}`)}),y(y({},i),t)}(rj.DefaultConfig,e);this.userConfig=e,this._autoLevelCapping=-1,t.progressive&&function(e){let t=e.loader;if(t!==rU&&t!==rO)M.log("[config]: Custom loader detected, cannot enable progressive streaming"),e.progressive=!1;else{let t=function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(e){}return!1}();t&&(e.loader=rU,e.progressive=!0,e.enableSoftwareAES=!0,M.log("[config]: Progressive streaming enabled, using FetchLoader"))}}(t);let{abrController:i,bufferController:r,capLevelController:n,errorController:a,fpsController:s}=t,o=new a(this),l=this.abrController=new i(this),u=this.bufferController=new r(this),c=this.capLevelController=new n(this),d=new s(this),h=new eX(this),f=new e4(this),p=t.contentSteeringController,m=p?new p(this):null,g=this.levelController=new ty(this,m),v=new tS(this),b=new tC(this.config),_=this.streamController=new iO(this,v,b);c.setStreamController(_),d.setStreamController(_);let S=[h,g,_];m&&S.splice(1,0,m),this.networkControllers=S;let x=[l,u,c,d,f,v];this.audioTrackController=this.createController(t.audioTrackController,S);let R=t.audioStreamController;R&&S.push(new R(this,v,b)),this.subtitleTrackController=this.createController(t.subtitleTrackController,S);let C=t.subtitleStreamController;C&&S.push(new C(this,v,b)),this.createController(t.timelineController,x),b.emeController=this.emeController=this.createController(t.emeController,x),this.cmcdController=this.createController(t.cmcdController,x),this.latencyController=this.createController(e6,x),this.coreComponents=x,S.push(o);let I=o.onErrorOut;"function"==typeof I&&this.on(E.ERROR,I,o)}createController(e,t){if(e){let i=new e(this);return t&&t.push(i),i}return null}on(e,t,i=this){this._emitter.on(e,t,i)}once(e,t,i=this){this._emitter.once(e,t,i)}removeAllListeners(e){this._emitter.removeAllListeners(e)}off(e,t,i=this,r){this._emitter.off(e,t,i,r)}listeners(e){return this._emitter.listeners(e)}emit(e,t,i){return this._emitter.emit(e,t,i)}trigger(e,t){if(this.config.debug)return this.emit(e,e,t);try{return this.emit(e,e,t)}catch(t){M.error("An internal error happened while handling event "+e+'. Error message: "'+t.message+'". Here is a stacktrace:',t),this.trigger(E.ERROR,{type:S.OTHER_ERROR,details:x.INTERNAL_EXCEPTION,fatal:!1,event:e,error:t})}return!1}listenerCount(e){return this._emitter.listenerCount(e)}destroy(){M.log("destroy"),this.trigger(E.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(e=>e.destroy()),this.networkControllers.length=0,this.coreComponents.forEach(e=>e.destroy()),this.coreComponents.length=0;let e=this.config;e.xhrSetup=e.fetchSetup=void 0,this.userConfig=null}attachMedia(e){M.log("attachMedia"),this._media=e,this.trigger(E.MEDIA_ATTACHING,{media:e})}detachMedia(){M.log("detachMedia"),this.trigger(E.MEDIA_DETACHING,void 0),this._media=null}loadSource(e){this.stopLoad();let t=this.media,i=this.url,r=this.url=g.buildAbsoluteURL(self.location.href,e,{alwaysNormalize:!0});M.log(`loadSource:${r}`),t&&i&&(i!==r||this.bufferController.hasSourceTypes())&&(this.detachMedia(),this.attachMedia(t)),this.trigger(E.MANIFEST_LOADING,{url:e})}startLoad(e=-1){M.log(`startLoad(${e})`),this.networkControllers.forEach(t=>{t.startLoad(e)})}stopLoad(){M.log("stopLoad"),this.networkControllers.forEach(e=>{e.stopLoad()})}swapAudioCodec(){M.log("swapAudioCodec"),this.streamController.swapAudioCodec()}recoverMediaError(){M.log("recoverMediaError");let e=this._media;this.detachMedia(),e&&this.attachMedia(e)}removeLevel(e,t=0){this.levelController.removeLevel(e,t)}get levels(){let e=this.levelController.levels;return e||[]}get currentLevel(){return this.streamController.currentLevel}set currentLevel(e){M.log(`set currentLevel:${e}`),this.loadLevel=e,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}get nextLevel(){return this.streamController.nextLevel}set nextLevel(e){M.log(`set nextLevel:${e}`),this.levelController.manualLevel=e,this.streamController.nextLevelSwitch()}get loadLevel(){return this.levelController.level}set loadLevel(e){M.log(`set loadLevel:${e}`),this.levelController.manualLevel=e}get nextLoadLevel(){return this.levelController.nextLoadLevel}set nextLoadLevel(e){this.levelController.nextLoadLevel=e}get firstLevel(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)}set firstLevel(e){M.log(`set firstLevel:${e}`),this.levelController.firstLevel=e}get startLevel(){return this.levelController.startLevel}set startLevel(e){M.log(`set startLevel:${e}`),-1!==e&&(e=Math.max(e,this.minAutoLevel)),this.levelController.startLevel=e}get capLevelToPlayerSize(){return this.config.capLevelToPlayerSize}set capLevelToPlayerSize(e){let t=!!e;t!==this.config.capLevelToPlayerSize&&(t?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=t)}get autoLevelCapping(){return this._autoLevelCapping}get bandwidthEstimate(){let{bwEstimator:e}=this.abrController;return e?e.getEstimate():NaN}get ttfbEstimate(){let{bwEstimator:e}=this.abrController;return e?e.getEstimateTTFB():NaN}set autoLevelCapping(e){this._autoLevelCapping!==e&&(M.log(`set autoLevelCapping:${e}`),this._autoLevelCapping=e)}get maxHdcpLevel(){return this._maxHdcpLevel}set maxHdcpLevel(e){e8.indexOf(e)>-1&&(this._maxHdcpLevel=e)}get autoLevelEnabled(){return -1===this.levelController.manualLevel}get manualLevel(){return this.levelController.manualLevel}get minAutoLevel(){let{levels:e,config:{minAutoBitrate:t}}=this;if(!e)return 0;let i=e.length;for(let r=0;r<i;r++)if(e[r].maxBitrate>=t)return r;return 0}get maxAutoLevel(){let e;let{levels:t,autoLevelCapping:i,maxHdcpLevel:r}=this;if(e=-1===i&&t&&t.length?t.length-1:i,r)for(let i=e;i--;){let e=t[i].attrs["HDCP-LEVEL"];if(e&&e<=r)return i}return e}get nextAutoLevel(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)}set nextAutoLevel(e){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,e)}get playingDate(){return this.streamController.currentProgramDateTime}get mainForwardBufferInfo(){return this.streamController.getMainFwdBufferInfo()}get audioTracks(){let e=this.audioTrackController;return e?e.audioTracks:[]}get audioTrack(){let e=this.audioTrackController;return e?e.audioTrack:-1}set audioTrack(e){let t=this.audioTrackController;t&&(t.audioTrack=e)}get subtitleTracks(){let e=this.subtitleTrackController;return e?e.subtitleTracks:[]}get subtitleTrack(){let e=this.subtitleTrackController;return e?e.subtitleTrack:-1}get media(){return this._media}set subtitleTrack(e){let t=this.subtitleTrackController;t&&(t.subtitleTrack=e)}get subtitleDisplay(){let e=this.subtitleTrackController;return!!e&&e.subtitleDisplay}set subtitleDisplay(e){let t=this.subtitleTrackController;t&&(t.subtitleDisplay=e)}get lowLatencyMode(){return this.config.lowLatencyMode}set lowLatencyMode(e){this.config.lowLatencyMode=e}get liveSyncPosition(){return this.latencyController.liveSyncPosition}get latency(){return this.latencyController.latency}get maxLatency(){return this.latencyController.maxLatency}get targetLatency(){return this.latencyController.targetLatency}get drift(){return this.latencyController.drift}get forceStartLoad(){return this.streamController.forceStartLoad}}rj.defaultConfig=void 0},42409:function(e,t,i){"use strict";i.d(t,{Bm:function(){return a},Et:function(){return h},Jz:function(){return c},MediaUIAttributes:function(){return o},MediaUIEvents:function(){return r},TP:function(){return l},Xs:function(){return f},ft:function(){return u},lo:function(){return p},m0:function(){return n},t7:function(){return d}});let r={MEDIA_PLAY_REQUEST:"mediaplayrequest",MEDIA_PAUSE_REQUEST:"mediapauserequest",MEDIA_MUTE_REQUEST:"mediamuterequest",MEDIA_UNMUTE_REQUEST:"mediaunmuterequest",MEDIA_VOLUME_REQUEST:"mediavolumerequest",MEDIA_SEEK_REQUEST:"mediaseekrequest",MEDIA_AIRPLAY_REQUEST:"mediaairplayrequest",MEDIA_ENTER_FULLSCREEN_REQUEST:"mediaenterfullscreenrequest",MEDIA_EXIT_FULLSCREEN_REQUEST:"mediaexitfullscreenrequest",MEDIA_PREVIEW_REQUEST:"mediapreviewrequest",MEDIA_ENTER_PIP_REQUEST:"mediaenterpiprequest",MEDIA_EXIT_PIP_REQUEST:"mediaexitpiprequest",MEDIA_ENTER_CAST_REQUEST:"mediaentercastrequest",MEDIA_EXIT_CAST_REQUEST:"mediaexitcastrequest",MEDIA_SHOW_TEXT_TRACKS_REQUEST:"mediashowtexttracksrequest",MEDIA_HIDE_TEXT_TRACKS_REQUEST:"mediahidetexttracksrequest",MEDIA_SHOW_SUBTITLES_REQUEST:"mediashowsubtitlesrequest",MEDIA_DISABLE_SUBTITLES_REQUEST:"mediadisablesubtitlesrequest",MEDIA_PLAYBACK_RATE_REQUEST:"mediaplaybackraterequest",MEDIA_RENDITION_REQUEST:"mediarenditionrequest",MEDIA_AUDIO_TRACK_REQUEST:"mediaaudiotrackrequest",MEDIA_SEEK_TO_LIVE_REQUEST:"mediaseektoliverequest",REGISTER_MEDIA_STATE_RECEIVER:"registermediastatereceiver",UNREGISTER_MEDIA_STATE_RECEIVER:"unregistermediastatereceiver"},n={MEDIA_CHROME_ATTRIBUTES:"mediachromeattributes",MEDIA_CONTROLLER:"mediacontroller"},a={MEDIA_AIRPLAY_UNAVAILABLE:"mediaAirplayUnavailable",MEDIA_FULLSCREEN_UNAVAILABLE:"mediaFullscreenUnavailable",MEDIA_PIP_UNAVAILABLE:"mediaPipUnavailable",MEDIA_CAST_UNAVAILABLE:"mediaCastUnavailable",MEDIA_RENDITION_UNAVAILABLE:"mediaRenditionUnavailable",MEDIA_AUDIO_TRACK_UNAVAILABLE:"mediaAudioTrackUnavailable",MEDIA_PAUSED:"mediaPaused",MEDIA_HAS_PLAYED:"mediaHasPlayed",MEDIA_ENDED:"mediaEnded",MEDIA_MUTED:"mediaMuted",MEDIA_VOLUME_LEVEL:"mediaVolumeLevel",MEDIA_VOLUME:"mediaVolume",MEDIA_VOLUME_UNAVAILABLE:"mediaVolumeUnavailable",MEDIA_IS_PIP:"mediaIsPip",MEDIA_IS_CASTING:"mediaIsCasting",MEDIA_SUBTITLES_LIST:"mediaSubtitlesList",MEDIA_SUBTITLES_SHOWING:"mediaSubtitlesShowing",MEDIA_IS_FULLSCREEN:"mediaIsFullscreen",MEDIA_PLAYBACK_RATE:"mediaPlaybackRate",MEDIA_CURRENT_TIME:"mediaCurrentTime",MEDIA_DURATION:"mediaDuration",MEDIA_SEEKABLE:"mediaSeekable",MEDIA_PREVIEW_TIME:"mediaPreviewTime",MEDIA_PREVIEW_IMAGE:"mediaPreviewImage",MEDIA_PREVIEW_COORDS:"mediaPreviewCoords",MEDIA_LOADING:"mediaLoading",MEDIA_BUFFERED:"mediaBuffered",MEDIA_STREAM_TYPE:"mediaStreamType",MEDIA_TARGET_LIVE_WINDOW:"mediaTargetLiveWindow",MEDIA_TIME_IS_LIVE:"mediaTimeIsLive",MEDIA_RENDITION_LIST:"mediaRenditionList",MEDIA_RENDITION_SELECTED:"mediaRenditionSelected",MEDIA_AUDIO_TRACK_LIST:"mediaAudioTrackList",MEDIA_AUDIO_TRACK_ENABLED:"mediaAudioTrackEnabled"},s=Object.entries(a),o=s.reduce((e,[t,i])=>(e[t]=`${i.toLowerCase()}`,e),{}),l=s.reduce((e,[t,i])=>(e[t]=`${i.toLowerCase()}`,e),{USER_INACTIVE:"userinactivechange",BREAKPOINTS_CHANGE:"breakpointchange",BREAKPOINTS_COMPUTED:"breakpointscomputed"});Object.entries(l).reduce((e,[t,i])=>{let r=o[t];return r&&(e[i]=r),e},{userinactivechange:"userinactive"});let u=Object.entries(o).reduce((e,[t,i])=>{let r=l[t];return r&&(e[i]=r),e},{userinactive:"userinactivechange"}),c={SUBTITLES:"subtitles",CAPTIONS:"captions",DESCRIPTIONS:"descriptions",CHAPTERS:"chapters",METADATA:"metadata"},d={DISABLED:"disabled",HIDDEN:"hidden",SHOWING:"showing"},h={MOUSE:"mouse",PEN:"pen",TOUCH:"touch"},f={UNAVAILABLE:"unavailable",UNSUPPORTED:"unsupported"},p={LIVE:"live",ON_DEMAND:"on-demand",UNKNOWN:"unknown"}},98373:function(e,t,i){"use strict";var r,n,a,s,o,l=i(11861);i(68592);var u=i(45717),c=i(42409),d=i(85222),h=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},f=(e,t,i)=>(h(e,t,"read from private field"),i?i.call(e):t.get(e)),p=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},m=(e,t,i,r)=>(h(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),g=(e,t,i)=>(h(e,t,"access private method"),i);let v=`
<svg aria-hidden="true" viewBox="0 0 26 24" part="captions-indicator indicator">
  <path d="M22.83 5.68a2.58 2.58 0 0 0-2.3-2.5c-3.62-.24-11.44-.24-15.06 0a2.58 2.58 0 0 0-2.3 2.5c-.23 4.21-.23 8.43 0 12.64a2.58 2.58 0 0 0 2.3 2.5c3.62.24 11.44.24 15.06 0a2.58 2.58 0 0 0 2.3-2.5c.23-4.21.23-8.43 0-12.64Zm-11.39 9.45a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.92 3.92 0 0 1 .92-2.77 3.18 3.18 0 0 1 2.43-1 2.94 2.94 0 0 1 2.13.78c.364.359.62.813.74 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.17 1.61 1.61 0 0 0-1.29.58 2.79 2.79 0 0 0-.5 1.89 3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.48 1.48 0 0 0 1-.37 2.1 2.1 0 0 0 .59-1.14l1.4.44a3.23 3.23 0 0 1-1.07 1.69Zm7.22 0a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.88 3.88 0 0 1 .93-2.77 3.14 3.14 0 0 1 2.42-1 3 3 0 0 1 2.16.82 2.8 2.8 0 0 1 .73 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.21 1.61 1.61 0 0 0-1.29.58A2.79 2.79 0 0 0 15 12a3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.44 1.44 0 0 0 1-.37 2.1 2.1 0 0 0 .6-1.15l1.4.44a3.17 3.17 0 0 1-1.1 1.7Z"/>
</svg>`,y=u.tj.createElement("template");y.innerHTML=`
  <slot name="captions-indicator" hidden>${v}</slot>
`;class b extends l.RE{constructor(){super({slotTemplate:y}),p(this,n),p(this,s),p(this,r,void 0)}static get observedAttributes(){return[...super.observedAttributes,"aria-multiselectable",c.MediaUIAttributes.MEDIA_SUBTITLES_LIST,c.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING]}attributeChangedCallback(e,t,i){super.attributeChangedCallback(e,t,i),e===c.MediaUIAttributes.MEDIA_SUBTITLES_LIST&&t!==i?g(this,n,a).call(this):e===c.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING&&t!==i?this.value=i:"aria-multiselectable"===e&&(this.removeAttribute("aria-multiselectable"),console.warn("Captions List doesn't currently support multiple selections. You can enable multiple items via the media.textTrack API."))}connectedCallback(){super.connectedCallback(),this.addEventListener("change",g(this,s,o))}disconnectedCallback(){super.disconnectedCallback(),this.removeEventListener("change",g(this,s,o))}get mediaSubtitlesList(){return _(this,c.MediaUIAttributes.MEDIA_SUBTITLES_LIST)}set mediaSubtitlesList(e){E(this,c.MediaUIAttributes.MEDIA_SUBTITLES_LIST,e)}get mediaSubtitlesShowing(){return _(this,c.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING)}set mediaSubtitlesShowing(e){E(this,c.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING,e)}}r=new WeakMap,n=new WeakSet,a=function(){var e;if(f(this,r)===JSON.stringify(this.mediaSubtitlesList))return;m(this,r,JSON.stringify(this.mediaSubtitlesList));let t=this.shadowRoot.querySelector("#container");t.textContent="";let i=!this.value,n=(0,l.SX)(this.formatOptionText("Off"),"off",i);n.prepend((0,l.sz)(this,"select-indicator")),t.append(n);let a=this.mediaSubtitlesList;for(let i of a){let r=(0,l.SX)(this.formatOptionText(i.label,i),(0,d.Ly)(i),this.value==(0,d.Ly)(i));r.prepend((0,l.sz)(this,"select-indicator"));let n=null!=(e=i.kind)?e:"subs";"captions"===n&&r.append((0,l.sz)(this,"captions-indicator")),t.append(r)}},s=new WeakSet,o=function(){if((0,d.U2)(this,!1),!this.value)return;let e=new u.Mq.CustomEvent(c.MediaUIEvents.MEDIA_SHOW_SUBTITLES_REQUEST,{composed:!0,bubbles:!0,detail:this.value});this.dispatchEvent(e)};let _=(e,t)=>{let i=e.getAttribute(t);return i?(0,d.tm)(i):[]},E=(e,t,i)=>{if(!(null==i?void 0:i.length)){e.removeAttribute(t);return}let r=(0,d.fj)(i),n=e.getAttribute(t);n!==r&&e.setAttribute(t,r)};u.Mq.customElements.get("media-captions-listbox")||u.Mq.customElements.define("media-captions-listbox",b)},18041:function(e,t,i){"use strict";var r=i(12991);i(59468),i(98373);var n=i(45717);class a extends r._{init(){let e=n.tj.createElement("media-captions-button");e.part.add("button"),e.preventClick=!0;let t=n.tj.createElement("media-captions-listbox");t.part.add("listbox"),t.setAttribute("exportparts","option, option-selected, indicator");let i=this.shadowRoot.querySelector("slot[name=button]"),r=this.shadowRoot.querySelector("slot[name=listbox]");i.textContent="",r.textContent="",i.append(e),r.append(t)}}n.Mq.customElements.get("media-captions-selectmenu")||n.Mq.customElements.define("media-captions-selectmenu",a)},11861:function(e,t,i){"use strict";i.d(t,{RE:function(){return L},SX:function(){return R},sz:function(){return C}});var r,n,a,s,o,l,u,c,d,h,f,p,m,g,v,y,b,_=i(42409),E=i(45717),S=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},x=(e,t,i)=>(S(e,t,"read from private field"),i?i.call(e):t.get(e)),T=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},w=(e,t,i,r)=>(S(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),A=(e,t,i)=>(S(e,t,"access private method"),i);let M=`
<svg aria-hidden="true" viewBox="0 1 24 24" part="select-indicator indicator">
  <path d="m10 15.17 9.193-9.191 1.414 1.414-10.606 10.606-6.364-6.364 1.414-1.414 4.95 4.95Z"/>
</svg>`;function R(e,t,i){let r=E.tj.createElement("media-chrome-option");r.part.add("option"),r.value=t,r.selected=i;let n=E.tj.createElement("span");return n.textContent=e,r.append(n),r}function C(e,t){let i=e.querySelector(`:scope > [slot="${t}"]`);return((null==i?void 0:i.nodeName)=="SLOT"&&(i=i.assignedElements({flatten:!0})[0]),i)?((i=i.cloneNode(!0)).removeAttribute("slot"),i):e.shadowRoot.querySelector(`[name="${t}"] > svg`).cloneNode(!0)}let I=E.tj.createElement("template");I.innerHTML=`
<style>
  :host {
    font: var(--media-font,
      var(--media-font-weight, normal)
      var(--media-font-size, 15px) /
      var(--media-text-content-height, var(--media-control-height, 24px))
      var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
    color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
    background: var(--media-listbox-background, var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .8))));
    border-radius: var(--media-listbox-border-radius);
    display: inline-block;
    padding-block: .5em;
  }

  ::slotted([slot="header"]) {
    padding: 0 1.4em .4em;
    margin-bottom: .5em;
    border-bottom: 1px solid rgb(255 255 255 / .25);
  }

  media-chrome-option {
    padding-inline: .7em 1.4em;
  }

  media-chrome-option > span {
    margin-inline: .5ch;
  }

  [part~="indicator"] {
    fill: var(--media-option-indicator-fill, var(--media-icon-color, var(--media-primary-color, rgb(238 238 238))));
    height: var(--media-option-indicator-height, 1.25em);
    vertical-align: var(--media-option-indicator-vertical-align, text-top);
  }

  [part~="select-indicator"] {
    visibility: hidden;
  }

  [aria-selected="true"] > [part~="select-indicator"] {
    visibility: visible;
  }
</style>
<slot name="header"></slot>
<slot id="container"></slot>
<slot name="select-indicator" hidden>${M}</slot>
`;class L extends E.Mq.HTMLElement{constructor(e={}){super(),T(this,l),T(this,h),T(this,p),T(this,g),T(this,y),T(this,r,void 0),T(this,n,""),T(this,a,null),T(this,s,!1),T(this,o,e=>{this.handleClick(e)}),T(this,c,e=>{let{key:t}=e;if("Escape"===t){this.removeEventListener("keyup",x(this,c));return}if("Meta"===t){w(this,s,!1);return}A(this,l,u).call(this,e)}),T(this,d,e=>{let{key:t,altKey:i}=e;if(i){this.removeEventListener("keyup",x(this,c));return}if("Meta"===t){w(this,s,!0);return}if(this.keysUsed.includes(t)&&e.preventDefault(),x(this,s)&&this.keysUsed.includes(t)){A(this,l,u).call(this,e);return}this.addEventListener("keyup",x(this,c),{once:!0})}),this.shadowRoot||(this.attachShadow({mode:"open"}),this.nativeEl=I.content.cloneNode(!0),e.slotTemplate&&this.nativeEl.append(e.slotTemplate.content.cloneNode(!0)),this.shadowRoot.append(this.nativeEl)),this.container=this.shadowRoot.querySelector("#container"),this.container.addEventListener("slotchange",e=>{for(let t of e.target.assignedNodes({flatten:!0}))3===t.nodeType&&""===t.textContent.trim()&&t.remove()})}static get observedAttributes(){return["disabled",_.m0.MEDIA_CONTROLLER]}static formatOptionText(e){return e}formatOptionText(e,t){return this.constructor.formatOptionText(e,t)}get options(){var e;let t=this.querySelectorAll("media-chrome-option");return t.length||(t=null==(e=this.container)?void 0:e.querySelectorAll("media-chrome-option")),Array.from(t)}get selectedOptions(){return this.options.filter(e=>e.selected)}get value(){var e,t;return null!=(t=null==(e=this.selectedOptions[0])?void 0:e.value)?t:""}set value(e){let t=this.options.find(t=>t.value===e);t&&A(this,p,m).call(this,t)}focus(){var e;null==(e=this.selectedOptions[0])||e.focus()}enable(){this.addEventListener("click",x(this,o)),this.addEventListener("keydown",x(this,d))}disable(){this.removeEventListener("click",x(this,o)),this.removeEventListener("keyup",x(this,c))}attributeChangedCallback(e,t,i){var n,a,s,o,l;e===_.m0.MEDIA_CONTROLLER?(t&&(null==(a=null==(n=x(this,r))?void 0:n.unassociateElement)||a.call(n,this),w(this,r,null)),i&&(w(this,r,null==(s=this.getRootNode())?void 0:s.getElementById(i)),null==(l=null==(o=x(this,r))?void 0:o.associateElement)||l.call(o,this))):"disabled"===e&&i!==t&&(null==i?this.enable():this.disable())}connectedCallback(){var e,t,i;this.hasAttribute("disabled")||this.enable(),this.hasAttribute("role")||this.setAttribute("role","listbox");let n=this.getAttribute(_.m0.MEDIA_CONTROLLER);n&&(w(this,r,null==(e=this.getRootNode())?void 0:e.getElementById(n)),null==(i=null==(t=x(this,r))?void 0:t.associateElement)||i.call(t,this))}disconnectedCallback(){var e,t;this.disable(),null==(t=null==(e=x(this,r))?void 0:e.unassociateElement)||t.call(e,this),w(this,r,null)}get keysUsed(){return["Enter"," ","ArrowDown","ArrowUp","Home","End"]}handleSelection(e,t){let i=A(this,h,f).call(this,e);i&&A(this,p,m).call(this,i,t)}handleMovement(e){let t;let{key:i}=e,r=this.options,n=A(this,h,f).call(this,e);switch(n||(n=r.filter(e=>"0"===e.getAttribute("tabindex"))[0]),i){case"ArrowDown":(null==(t=n.nextElementSibling)?void 0:t.hasAttribute("disabled"))&&(t=t.nextElementSibling);break;case"ArrowUp":(null==(t=n.previousElementSibling)?void 0:t.hasAttribute("disabled"))&&(t=t.previousElementSibling);break;case"Home":t=r[0];break;case"End":t=r[r.length-1];break;default:t=A(this,g,v).call(this,i)}t&&(r.forEach(e=>e.setAttribute("tabindex","-1")),t.setAttribute("tabindex","0"),t.focus())}handleClick(e){let t=A(this,h,f).call(this,e);!t||t.hasAttribute("disabled")||(this.options.forEach(e=>e.setAttribute("tabindex","-1")),t.setAttribute("tabindex","0"),this.handleSelection(e,this.hasAttribute("aria-multiselectable")&&"true"===this.getAttribute("aria-multiselectable")))}}r=new WeakMap,n=new WeakMap,a=new WeakMap,s=new WeakMap,o=new WeakMap,l=new WeakSet,u=function(e){let{key:t}=e;"Enter"===t||" "===t?this.handleSelection(e,this.hasAttribute("aria-multiselectable")&&"true"===this.getAttribute("aria-multiselectable")):this.handleMovement(e)},c=new WeakMap,d=new WeakMap,h=new WeakSet,f=function(e){let t=e.composedPath(),i=t.findIndex(e=>"MEDIA-CHROME-OPTION"===e.nodeName);return t[i]},p=new WeakSet,m=function(e,t){let i=[...this.selectedOptions];this.hasAttribute("aria-multiselectable")&&"true"===this.getAttribute("aria-multiselectable")||this.options.forEach(e=>e.selected=!1),t?e.selected=!e.selected:e.selected=!0,this.selectedOptions.some((e,t)=>e!=i[t])&&this.dispatchEvent(new Event("change"))},g=new WeakSet,v=function(e){A(this,y,b).call(this);let t=this.options,i=t.findIndex(e=>"0"===e.getAttribute("tabindex"));w(this,n,x(this,n)+e);let r=x(this,n).split("").every(t=>t===e),a=t.slice(i+(r?1:0)).filter(e=>e.textContent.toLowerCase().startsWith(x(this,n))),s=t.slice(0,i-(r?1:0)).filter(e=>e.textContent.toLowerCase().startsWith(x(this,n))),o=[],l=[];r&&(o=t.slice(i+(r?1:0)).filter(t=>t.textContent.startsWith(e)),l=t.slice(0,i-(r?1:0)).filter(t=>t.textContent.startsWith(e)));let u=[...a,...s,...o,...l];return u[0]},y=new WeakSet,b=function(){clearTimeout(x(this,a)),w(this,a,null),w(this,a,setTimeout(()=>{w(this,n,""),w(this,a,null)},500))},E.Mq.customElements.get("media-chrome-listbox")||E.Mq.customElements.define("media-chrome-listbox",L)},68592:function(e,t,i){"use strict";var r,n,a,s,o=i(45717),l=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},u=(e,t,i)=>(l(e,t,"read from private field"),i?i.call(e):t.get(e)),c=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},d=(e,t,i,r)=>(l(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),h=(e,t,i)=>(l(e,t,"access private method"),i);let f=o.tj.createElement("template");f.innerHTML=`
<style>
  :host {
    cursor: pointer;
    display: block;
    line-height: revert;
    white-space: nowrap;
    white-space-collapse: collapse;
    text-wrap: nowrap;
    min-height: 1.2em;
    padding: .4em .5em;
    transition: var(--media-option-transition);
    outline: var(--media-option-outline, 0);
    outline-offset: var(--media-option-outline-offset, -1px);
  }

  :host(:focus-visible) {
    box-shadow: var(--media-option-focus-shadow, inset 0 0 0 2px rgb(27 127 204 / .9));
    outline: var(--media-option-hover-outline, 0);
    outline-offset: var(--media-option-hover-outline-offset,  var(--media-option-outline-offset, -1px));
  }

  :host(:hover) {
    cursor: pointer;
    background: var(--media-option-hover-background, rgb(82 82 122 / .8));
    outline: var(--media-option-hover-outline);
    outline-offset: var(--media-option-hover-outline-offset,  var(--media-option-outline-offset, -1px));
  }

  :host([aria-selected="true"]) {
    background: var(--media-option-selected-background);
  }

  :host([disabled]) {
    pointer-events: none;
    color: rgba(255, 255, 255, .3);
  }
</style>
<slot></slot>
`;let p={VALUE:"value",SELECTED:"selected",DISABLED:"disabled"};class m extends o.Mq.HTMLElement{constructor(){super(),c(this,a),c(this,r,!1),c(this,n,void 0),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(f.content.cloneNode(!0)))}static get observedAttributes(){return[p.DISABLED,p.SELECTED,p.VALUE]}get value(){var e;return null!=(e=this.getAttribute(p.VALUE))?e:this.text}set value(e){this.setAttribute(p.VALUE,e)}get text(){var e;return(null!=(e=this.textContent)?e:"").trim()}get selected(){return"true"===this.getAttribute("aria-selected")}set selected(e){d(this,r,!0),this.setAttribute("aria-selected",e?"true":"false"),e?this.part.add("option-selected"):this.part.remove("option-selected")}enable(){this.hasAttribute("tabindex")||this.setAttribute("tabindex",-1),this.hasAttribute("aria-selected")||this.setAttribute("aria-selected","false")}disable(){this.removeAttribute("tabindex")}attributeChangedCallback(e,t,i){e!==p.SELECTED||u(this,r)?e===p.DISABLED&&i!==t&&(null==i?this.enable():this.disable()):this.setAttribute("aria-selected",null!=i?"true":"false")}connectedCallback(){this.hasAttribute(p.DISABLED)||this.enable(),this.setAttribute("role","option"),d(this,n,function e(t,i){if(!t)return null;let{host:r}=t.getRootNode();return!i&&r?e(t,r):(null==i?void 0:i.options)?i:e(i,null==i?void 0:i.parentNode)}(this,this.parentNode)),h(this,a,s).call(this)}disconnectedCallback(){this.disable(),h(this,a,s).call(this),d(this,n,null)}handleClick(){}}r=new WeakMap,n=new WeakMap,a=new WeakSet,s=function(){var e;let t=null==(e=u(this,n))?void 0:e.options;if(!t)return;let i=t.filter(e=>"true"===e.getAttribute("aria-selected")).pop();i||(i=t[0]),"true"!==u(this,n).getAttribute("aria-multiselectable")&&t.forEach(e=>{e.setAttribute("tabindex","-1"),e.setAttribute("aria-selected","false")}),null==i||i.setAttribute("tabindex","0"),null==i||i.setAttribute("aria-selected","true")},o.Mq.customElements.get("media-chrome-option")||o.Mq.customElements.define("media-chrome-option",m)},12991:function(e,t,i){"use strict";i.d(t,{_:function(){return P}}),i(8925),i(11861);var r,n,a,s,o,l,u,c,d,h,f,p,m,g,v,y,b,_,E,S,x,T,w=i(45717),A=i(79057),M=i(42409),R=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},C=(e,t,i)=>(R(e,t,"read from private field"),i?i.call(e):t.get(e)),I=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},L=(e,t,i,r)=>(R(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),k=(e,t,i)=>(R(e,t,"access private method"),i);let D=w.tj.createElement("template");D.innerHTML=`
  <style>
  :host {
    font: var(--media-font,
      var(--media-font-weight, normal)
      var(--media-font-size, 15px) /
      var(--media-text-content-height, var(--media-control-height, 24px))
      var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
    color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
    display: inline-flex;
    position: relative;
    flex-shrink: .5;
  }

  [name="listbox"]::slotted(*),
  [part=listbox] {
    position: absolute;
    left: 0;
    bottom: 100%;
    max-height: 300px;
    overflow: hidden auto;
    transition: var(--media-selectmenu-transition-in,
      visibility 0s, transform .15s ease-out, opacity .15s ease-out);
    transform: var(--media-listbox-transform-in, translateY(0) scale(1));
    visibility: visible;
    opacity: 1;
  }

  [name="listbox"][hidden]::slotted(*),
  [hidden] [part=listbox] {
    transition: var(--media-selectmenu-transition-out,
      visibility .15s ease-out, transform .15s ease-out, opacity .15s ease-out);
    transform: var(--media-listbox-transform-out, translateY(2px) scale(.99));
    visibility: hidden;
    opacity: 0;
    pointer-events: none;
  }

  slot[name="listbox"][hidden] {
    display: block;
  }
  </style>

  <slot name="button">
    <media-chrome-button aria-haspopup="listbox" part="button">
      <slot name="button-content"></slot>
    </media-chrome-button>
  </slot>
  <slot name="listbox" hidden>
    <media-chrome-listbox id="listbox" part="listbox">
      <slot></slot>
    </media-chrome-listbox>
  </slot>
`;class P extends w.Mq.HTMLElement{constructor(){var e;super(),I(this,m),I(this,v),I(this,b),I(this,E),I(this,x),I(this,r,void 0),I(this,n,void 0),I(this,a,void 0),I(this,s,!0),I(this,o,void 0),I(this,l,void 0),I(this,u,void 0),I(this,c,void 0),I(this,d,!1),I(this,h,e=>{let{key:t}=e;if(!this.keysUsed.includes(t)){this.removeEventListener("keyup",C(this,h));return}let i=e.composedPath().includes(C(this,o));i&&("Enter"===t||" "===t)?C(this,n).call(this):"Escape"!==t||C(this,c).hidden||k(this,b,_).call(this)}),I(this,f,e=>{let{metaKey:t,altKey:i,key:r}=e;if(t||i||!this.keysUsed.includes(r)){this.removeEventListener("keyup",C(this,h));return}e.preventDefault(),this.addEventListener("keyup",C(this,h),{once:!0})}),I(this,p,e=>{e.composedPath().includes(this)||C(this,c).hidden||k(this,b,_).call(this)}),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(D.content.cloneNode(!0)));let{style:t}=(0,A.R7)(this.shadowRoot,":host");t.setProperty("display",`var(--media-control-display, var(--${this.localName}-display, inline-flex))`),L(this,n,k(this,m,g).bind(this)),L(this,a,k(this,v,y).bind(this)),null==(e=this.init)||e.call(this),L(this,o,this.shadowRoot.querySelector("[part=button]")),L(this,u,this.shadowRoot.querySelector("[part=listbox]")),L(this,l,this.shadowRoot.querySelector("slot[name=button]")),C(this,l).addEventListener("slotchange",()=>{let e=C(this,l).assignedElements()[0];e&&(this.disable(),L(this,o,e),C(this,o).preventClick=!0,C(this,o).hasAttribute("disabled")&&L(this,s,!1),C(this,s)?(this.enable(),C(this,o).setAttribute("aria-haspopup","listbox")):this.disable())}),L(this,c,this.shadowRoot.querySelector("slot[name=listbox]")),C(this,c).addEventListener("slotchange",()=>{this.disable(),L(this,u,C(this,c).assignedElements()[0]||C(this,u)),this.enable()})}static get observedAttributes(){return["disabled",M.m0.MEDIA_CONTROLLER]}enable(){C(this,o).removeAttribute("disabled"),C(this,o).addEventListener("click",C(this,n)),C(this,o).addEventListener("keydown",C(this,f)),C(this,u).addEventListener("keydown",C(this,f)),k(this,x,T).call(this),C(this,u).addEventListener("change",C(this,a)),w.tj.addEventListener("click",C(this,p))}disable(){C(this,o).setAttribute("disabled",""),C(this,o).removeEventListener("click",C(this,n)),C(this,o).removeEventListener("keydown",C(this,f)),C(this,o).removeEventListener("keyup",C(this,h)),C(this,u).removeEventListener("keydown",C(this,f)),C(this,u).removeEventListener("keyup",C(this,h)),C(this,u).addEventListener("change",C(this,a)),w.tj.removeEventListener("click",C(this,p))}attributeChangedCallback(e,t,i){var n,a,o,l,c;e===M.m0.MEDIA_CONTROLLER?(t&&(null==(a=null==(n=C(this,r))?void 0:n.unassociateElement)||a.call(n,this),L(this,r,null),C(this,u).removeAttribute(M.m0.MEDIA_CONTROLLER)),i&&(L(this,r,null==(o=this.getRootNode())?void 0:o.getElementById(i)),null==(c=null==(l=C(this,r))?void 0:l.associateElement)||c.call(l,this),C(this,u).setAttribute(M.m0.MEDIA_CONTROLLER,i))):"disabled"===e&&i!==t&&(null==i?(L(this,s,!0),this.enable()):(L(this,s,!1),this.disable()))}connectedCallback(){var e,t,i;this.hasAttribute("disabled")||this.enable();let n=this.getAttribute(M.m0.MEDIA_CONTROLLER);n&&(L(this,r,null==(e=this.getRootNode())?void 0:e.getElementById(n)),null==(i=null==(t=C(this,r))?void 0:t.associateElement)||i.call(t,this),C(this,u).setAttribute(M.m0.MEDIA_CONTROLLER,n))}disconnectedCallback(){var e,t;this.disable(),null==(t=null==(e=C(this,r))?void 0:e.unassociateElement)||t.call(e,this),L(this,r,null),C(this,u).removeAttribute(M.m0.MEDIA_CONTROLLER)}get keysUsed(){return["Enter","Escape"," ","ArrowUp","ArrowDown","f","c","k","m"]}}r=new WeakMap,n=new WeakMap,a=new WeakMap,s=new WeakMap,o=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakMap,d=new WeakMap,h=new WeakMap,f=new WeakMap,p=new WeakMap,m=new WeakSet,g=function(){k(this,b,_).call(this)},v=new WeakSet,y=function(){k(this,b,_).call(this,!0)},b=new WeakSet,_=function(e){C(this,c).hidden=!C(this,c).hidden||e,k(this,x,T).call(this,e),C(this,c).hidden?(this.shadowRoot.activeElement===C(this,u)||C(this,u).contains(this.shadowRoot.activeElement))&&C(this,o).focus():(C(this,u).focus(),k(this,E,S).call(this))},E=new WeakSet,S=function(){var e;if(0===C(this,u).offsetWidth)return;let t=C(this,o).getBoundingClientRect();if(this.hasAttribute("mediacontroller")||C(this,o).hasAttribute("mediacontroller")||C(this,u).hasAttribute("mediacontroller")){C(this,u).style.zIndex="1",C(this,u).style.bottom="unset",C(this,u).style.top=t.height+"px";return}let i=null!=(e=this.getAttribute("bounds")?(0,A.l5)(this,`#${this.getAttribute("bounds")}`):this.parentElement)?e:this,r=C(this,u).offsetWidth,n=i.getBoundingClientRect(),a=-Math.max(t.x+r-n.right,0);C(this,u).style.left=`${a}px`},x=new WeakSet,T=function(e=!1){L(this,d,!C(this,d)||e),C(this,o).setAttribute("aria-expanded",C(this,d))},w.Mq.customElements.get("media-chrome-selectmenu")||w.Mq.customElements.define("media-chrome-selectmenu",P)},86309:function(e,t,i){"use strict";let r,n;i.d(t,{LZ:function(){return e2}});var a,s,o,l,u,c,d,h,f,p,m,g,v,y,b,_,E,S,x,T,w,A,M,R,C,I,L,k,D,P,O,N,U,F,B,V,z,j,H,G,W=i(42409),$=i(73889),q=i(68995);let Y=[{singular:"hour",plural:"hours"},{singular:"minute",plural:"minutes"},{singular:"second",plural:"seconds"}],K=(e,t)=>{let i=1===e?Y[t].singular:Y[t].plural;return`${e} ${i}`},X=e=>{if(!(0,q.qh)(e))return"";let t=Math.abs(e),i=t!==e,r=new Date(0,0,0,0,0,t,0),n=[r.getHours(),r.getMinutes(),r.getSeconds()],a=n.map((e,t)=>e&&K(e,t)).filter(e=>e).join(", ");return`${a}${i?" remaining":""}`};function Z(e,t){let i=!1;e<0&&(i=!0,e=0-e);let r=Math.floor((e=e<0?0:e)%60),n=Math.floor(e/60%60),a=Math.floor(e/3600);return(isNaN(e)||e===1/0)&&(a=n=r="0"),n=(((a=a>0||Math.floor(t/3600)>0?a+":":"")||Math.floor(t/60%60)>=10)&&n<10?"0"+n:n)+":",(i?"-":"")+a+n+(r=r<10?"0"+r:r)}Object.freeze({length:0,start(e){let t=e>>>0;if(t>=this.length)throw new DOMException(`Failed to execute 'start' on 'TimeRanges': The index provided (${t}) is greater than or equal to the maximum bound (${this.length}).`);return 0},end(e){let t=e>>>0;if(t>=this.length)throw new DOMException(`Failed to execute 'end' on 'TimeRanges': The index provided (${t}) is greater than or equal to the maximum bound (${this.length}).`);return 0}});var J=i(8925),Q=i(45717),ee=i(79057);let et=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M22.13 3H3.87a.87.87 0 0 0-.87.87v13.26a.87.87 0 0 0 .87.87h3.4L9 16H5V5h16v11h-4l1.72 2h3.4a.87.87 0 0 0 .87-.87V3.87a.87.87 0 0 0-.86-.87Zm-8.75 11.44a.5.5 0 0 0-.76 0l-4.91 5.73a.5.5 0 0 0 .38.83h9.82a.501.501 0 0 0 .38-.83l-4.91-5.73Z"/>
</svg>
`,ei=Q.tj.createElement("template");ei.innerHTML=`
  <slot name="icon">${et}</slot>
`;class er extends J.Z{static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_AIRPLAY_UNAVAILABLE]}constructor(e={}){super({slotTemplate:ei,...e})}connectedCallback(){this.setAttribute("aria-label",$.pg.AIRPLAY()),super.connectedCallback()}get mediaAirplayUnavailable(){return(0,ee.ST)(this,W.MediaUIAttributes.MEDIA_AIRPLAY_UNAVAILABLE)}set mediaAirplayUnavailable(e){(0,ee.Lb)(this,W.MediaUIAttributes.MEDIA_AIRPLAY_UNAVAILABLE,e)}handleClick(){let e=new Q.Mq.CustomEvent(W.MediaUIEvents.MEDIA_AIRPLAY_REQUEST,{composed:!0,bubbles:!0});this.dispatchEvent(e)}}Q.Mq.customElements.get("media-airplay-button")||Q.Mq.customElements.define("media-airplay-button",er);let en=Q.tj.createElement("template");en.innerHTML=`
  <style>
  :host([${W.MediaUIAttributes.MEDIA_IS_CASTING}]) slot:not([name=exit]):not([name=icon]) {
    display: none !important;
  }

  
  :host(:not([${W.MediaUIAttributes.MEDIA_IS_CASTING}])) slot:not([name=enter]):not([name=icon]) {
    display: none !important;
  }
  </style>

  <slot name="icon">
    <slot name="enter"><svg aria-hidden="true" viewBox="0 0 24 24"><g><path class="cast_caf_icon_arch0" d="M1,18 L1,21 L4,21 C4,19.3 2.66,18 1,18 L1,18 Z"/><path class="cast_caf_icon_arch1" d="M1,14 L1,16 C3.76,16 6,18.2 6,21 L8,21 C8,17.13 4.87,14 1,14 L1,14 Z"/><path class="cast_caf_icon_arch2" d="M1,10 L1,12 C5.97,12 10,16.0 10,21 L12,21 C12,14.92 7.07,10 1,10 L1,10 Z"/><path class="cast_caf_icon_box" d="M21,3 L3,3 C1.9,3 1,3.9 1,5 L1,8 L3,8 L3,5 L21,5 L21,19 L14,19 L14,21 L21,21 C22.1,21 23,20.1 23,19 L23,5 C23,3.9 22.1,3 21,3 L21,3 Z"/></g></svg></slot>
    <slot name="exit"><svg aria-hidden="true" viewBox="0 0 24 24"><g><path class="cast_caf_icon_arch0" d="M1,18 L1,21 L4,21 C4,19.3 2.66,18 1,18 L1,18 Z"/><path class="cast_caf_icon_arch1" d="M1,14 L1,16 C3.76,16 6,18.2 6,21 L8,21 C8,17.13 4.87,14 1,14 L1,14 Z"/><path class="cast_caf_icon_arch2" d="M1,10 L1,12 C5.97,12 10,16.0 10,21 L12,21 C12,14.92 7.07,10 1,10 L1,10 Z"/><path class="cast_caf_icon_box" d="M21,3 L3,3 C1.9,3 1,3.9 1,5 L1,8 L3,8 L3,5 L21,5 L21,19 L14,19 L14,21 L21,21 C22.1,21 23,20.1 23,19 L23,5 C23,3.9 22.1,3 21,3 L21,3 Z"/><path class="cast_caf_icon_boxfill" d="M5,7 L5,8.63 C8,8.6 13.37,14 13.37,17 L19,17 L19,7 Z"/></g></svg></slot>
  </slot>
`;let ea=e=>{let t=null!=e.getAttribute(W.MediaUIAttributes.MEDIA_IS_CASTING),i=t?$.pg.EXIT_CAST():$.pg.ENTER_CAST();e.setAttribute("aria-label",i)};class es extends J.Z{static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_IS_CASTING,W.MediaUIAttributes.MEDIA_CAST_UNAVAILABLE]}constructor(e={}){super({slotTemplate:en,...e})}connectedCallback(){ea(this),super.connectedCallback()}attributeChangedCallback(e,t,i){e===W.MediaUIAttributes.MEDIA_IS_CASTING&&ea(this),super.attributeChangedCallback(e,t,i)}get mediaIsCasting(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_IS_CASTING)}set mediaIsCasting(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_IS_CASTING,e)}get mediaCastUnavailable(){return(0,ee.ST)(this,W.MediaUIAttributes.MEDIA_CAST_UNAVAILABLE)}set mediaCastUnavailable(e){(0,ee.Lb)(this,W.MediaUIAttributes.MEDIA_CAST_UNAVAILABLE,e)}handleClick(){let e=this.mediaIsCasting?W.MediaUIEvents.MEDIA_EXIT_CAST_REQUEST:W.MediaUIEvents.MEDIA_ENTER_CAST_REQUEST;this.dispatchEvent(new Q.Mq.CustomEvent(e,{composed:!0,bubbles:!0}))}}Q.Mq.customElements.get("media-cast-button")||Q.Mq.customElements.define("media-cast-button",es);var eo=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},el=(e,t,i)=>(eo(e,t,"read from private field"),i?i.call(e):t.get(e)),eu=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},ec=(e,t,i,r)=>(eo(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);let ed=Q.tj.createElement("template");ed.innerHTML=`
<style>
  :host {
    display: var(--media-control-display, var(--media-gesture-receiver-display, inline-block));
    box-sizing: border-box;
  }
</style>
`;class eh extends Q.Mq.HTMLElement{constructor(e={}){if(super(),eu(this,a,void 0),!this.shadowRoot){let t=this.attachShadow({mode:"open"}),i=ed.content.cloneNode(!0);this.nativeEl=i;let r=e.slotTemplate;r||((r=Q.tj.createElement("template")).innerHTML=`<slot>${e.defaultContent||""}</slot>`),this.nativeEl.appendChild(r.content.cloneNode(!0)),t.appendChild(i)}}static get observedAttributes(){return[W.m0.MEDIA_CONTROLLER,W.MediaUIAttributes.MEDIA_PAUSED]}attributeChangedCallback(e,t,i){var r,n,s,o,l;e===W.m0.MEDIA_CONTROLLER&&(t&&(null==(n=null==(r=el(this,a))?void 0:r.unassociateElement)||n.call(r,this),ec(this,a,null)),i&&(ec(this,a,null==(s=this.getRootNode())?void 0:s.getElementById(i)),null==(l=null==(o=el(this,a))?void 0:o.associateElement)||l.call(o,this)))}connectedCallback(){var e,t,i,r;this.tabIndex=-1,this.setAttribute("aria-hidden","true"),ec(this,a,function(e){var t;let i=e.getAttribute(W.m0.MEDIA_CONTROLLER);return i?null==(t=e.getRootNode())?void 0:t.getElementById(i):(0,ee.l5)(e,"media-controller")}(this)),this.getAttribute(W.m0.MEDIA_CONTROLLER)&&(null==(t=null==(e=el(this,a))?void 0:e.associateElement)||t.call(e,this)),null==(i=el(this,a))||i.addEventListener("pointerdown",this),null==(r=el(this,a))||r.addEventListener("click",this)}disconnectedCallback(){var e,t,i,r;this.getAttribute(W.m0.MEDIA_CONTROLLER)&&(null==(t=null==(e=el(this,a))?void 0:e.unassociateElement)||t.call(e,this)),null==(i=el(this,a))||i.removeEventListener("pointerdown",this),null==(r=el(this,a))||r.removeEventListener("click",this),ec(this,a,null)}handleEvent(e){var t;let i=null==(t=e.composedPath())?void 0:t[0];if(["video","media-controller"].includes(null==i?void 0:i.localName)){if("pointerdown"===e.type)this._pointerType=e.pointerType;else if("click"===e.type){let{clientX:t,clientY:i}=e,{left:r,top:n,width:a,height:s}=this.getBoundingClientRect(),o=t-r,l=i-n;if(o<0||l<0||o>a||l>s||0===a&&0===s)return;let{pointerType:u=this._pointerType}=e;if(this._pointerType=void 0,u===W.Et.TOUCH){this.handleTap(e);return}if(u===W.Et.MOUSE){this.handleMouseClick(e);return}}}}get mediaPaused(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_PAUSED)}set mediaPaused(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_PAUSED,e)}handleTap(e){}handleMouseClick(e){let t=this.mediaPaused?W.MediaUIEvents.MEDIA_PLAY_REQUEST:W.MediaUIEvents.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new Q.Mq.CustomEvent(t,{composed:!0,bubbles:!0}))}}a=new WeakMap,Q.Mq.customElements.get("media-gesture-receiver")||Q.Mq.customElements.define("media-gesture-receiver",eh);var ef=Object.defineProperty,ep=(e,t,i)=>t in e?ef(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,em=(e,t,i)=>(ep(e,"symbol"!=typeof t?t+"":t,i),i);let eg={AUDIO:"audio",AUTOHIDE:"autohide",BREAKPOINTS:"breakpoints",GESTURES_DISABLED:"gesturesdisabled",KEYBOARD_CONTROL:"keyboardcontrol",NO_AUTOHIDE:"noautohide",USER_INACTIVE:"userinactive"},ev=Q.tj.createElement("template");ev.innerHTML=`
  <style>
    
    :host([${W.MediaUIAttributes.MEDIA_IS_FULLSCREEN}]) ::slotted([slot=media]) {
      outline: none;
    }

    :host {
      box-sizing: border-box;
      position: relative;
      display: inline-block;
      line-height: 0;
      background-color: var(--media-background-color, #000);
    }

    :host(:not([${eg.AUDIO}])) [part~=layer]:not([part~=media-layer]) {
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      right: 0;
      display: flex;
      flex-flow: column nowrap;
      align-items: start;
      pointer-events: none;
      background: none;
    }

    slot[name=media] {
      display: var(--media-slot-display, contents);
    }

    
    :host([${eg.AUDIO}]) slot[name=media] {
      display: var(--media-slot-display, none);
    }

    
    :host([${eg.AUDIO}]) [part~=layer][part~=gesture-layer] {
      height: 0;
      display: block;
    }

    
    :host(:not([${eg.AUDIO}])[${eg.GESTURES_DISABLED}]) ::slotted([slot=gestures-chrome]),
    :host(:not([${eg.AUDIO}])[${eg.GESTURES_DISABLED}]) media-gesture-receiver[slot=gestures-chrome] {
      display: none;
    }

    
    ::slotted(:not([slot=media]):not([slot=poster]):not(media-loading-indicator)) {
      pointer-events: auto;
    }

    :host(:not([${eg.AUDIO}])) *[part~=layer][part~=centered-layer] {
      align-items: center;
      justify-content: center;
    }

    :host(:not([${eg.AUDIO}])) ::slotted(media-gesture-receiver[slot=gestures-chrome]),
    :host(:not([${eg.AUDIO}])) media-gesture-receiver[slot=gestures-chrome] {
      align-self: stretch;
      flex-grow: 1;
    }

    slot[name=middle-chrome] {
      display: inline;
      flex-grow: 1;
      pointer-events: none;
      background: none;
    }

    
    ::slotted([slot=media]),
    ::slotted([slot=poster]) {
      width: 100%;
      height: 100%;
    }

    
    :host(:not([${eg.AUDIO}])) .spacer {
      flex-grow: 1;
    }

    
    :host(:-webkit-full-screen) {
      
      width: 100% !important;
      height: 100% !important;
    }

    
    ::slotted(:not([slot=media]):not([${eg.NO_AUTOHIDE}])) {
      opacity: 1;
      transition: opacity 0.25s;
    }

    
    :host([${eg.USER_INACTIVE}]:not([${W.MediaUIAttributes.MEDIA_PAUSED}]):not([${W.MediaUIAttributes.MEDIA_IS_CASTING}]):not([${eg.AUDIO}])) ::slotted(:not([slot=media]):not([${eg.NO_AUTOHIDE}])) {
      opacity: 0;
      transition: opacity 1s;
    }

    ::slotted(media-control-bar)  {
      align-self: stretch;
    }

    
    :host(:not([${eg.AUDIO}])[${W.MediaUIAttributes.MEDIA_HAS_PLAYED}]) slot[name=poster] {
      display: none;
    }
  </style>

  <slot name="media" part="layer media-layer"></slot>
  <slot name="poster" part="layer poster-layer"></slot>
  <slot name="gestures-chrome" part="layer gesture-layer">
    <media-gesture-receiver slot="gestures-chrome"></media-gesture-receiver>
  </slot>
  <span part="layer vertical-layer">
    <slot name="top-chrome" part="top chrome"></slot>
    <slot name="middle-chrome" part="middle chrome"></slot>
    <slot name="centered-chrome" part="layer centered-layer center centered chrome"></slot>
    
    <slot part="bottom chrome"></slot>
  </span>
`;let ey=Object.values(W.MediaUIAttributes);class eb extends Q.Mq.HTMLElement{constructor(){super(),em(this,"breakpointsComputed",!1),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(ev.content.cloneNode(!0)));let e=new MutationObserver(e=>{let t=this.media;for(let i of e)"childList"===i.type&&(i.removedNodes.forEach(e=>{if("media"==e.slot&&i.target==this){let r=i.previousSibling&&i.previousSibling.previousElementSibling;if(r&&t){let t="media"!==r.slot;for(;null!==(r=r.previousSibling);)"media"==r.slot&&(t=!1);t&&this.mediaUnsetCallback(e)}else this.mediaUnsetCallback(e)}}),t&&i.addedNodes.forEach(e=>{e==t&&this.handleMediaUpdated(t).then(e=>this.mediaSetCallback(e))}))});e.observe(this,{childList:!0,subtree:!0});let t=!1,i=new ResizeObserver(e=>{t||(setTimeout(()=>{(function(e){for(let t of e)(function(e,t){var i;if(!e.isConnected)return;let r=null!=(i=e.getAttribute(eg.BREAKPOINTS))?i:"sm:384 md:576 lg:768 xl:960",n=function(e){let t=e.split(/\s+/);return Object.fromEntries(t.map(e=>e.split(":")))}(r),a=function(e,t){return Object.keys(e).filter(i=>t>=e[i])}(n,t),s=!1;if(Object.keys(n).forEach(t=>{if(a.includes(t)){e.hasAttribute(`breakpoint${t}`)||(e.setAttribute(`breakpoint${t}`,""),s=!0);return}e.hasAttribute(`breakpoint${t}`)&&(e.removeAttribute(`breakpoint${t}`),s=!0)}),s){let t=new CustomEvent(W.TP.BREAKPOINTS_CHANGE,{detail:a});e.dispatchEvent(t)}})(t.target,t.contentRect.width)})(e),t=!1,this.breakpointsComputed||(this.breakpointsComputed=!0,this.dispatchEvent(new CustomEvent(W.TP.BREAKPOINTS_COMPUTED,{bubbles:!0,composed:!0})))},0),t=!0)});this.resizeObserver=i,i.observe(this);let r=this.media,n=this.querySelector(":scope > slot[slot=media]");n&&n.addEventListener("slotchange",()=>{let e=n.assignedElements({flatten:!0});if(!e.length){this.mediaUnsetCallback(r);return}this.media&&(r=this.media,this.handleMediaUpdated(this.media).then(e=>this.mediaSetCallback(e)))})}static get observedAttributes(){return[eg.AUTOHIDE,eg.GESTURES_DISABLED].concat(ey).filter(e=>![W.MediaUIAttributes.MEDIA_RENDITION_LIST,W.MediaUIAttributes.MEDIA_AUDIO_TRACK_LIST].includes(e))}attributeChangedCallback(e,t,i){e.toLowerCase()==eg.AUTOHIDE&&(this.autohide=i)}get media(){let e=this.querySelector(":scope > [slot=media]");return(null==e?void 0:e.nodeName)=="SLOT"&&(e=e.assignedElements({flatten:!0})[0]),e}mediaSetCallback(e){this._mediaClickPlayToggle=()=>{let t=e.paused?W.MediaUIEvents.MEDIA_PLAY_REQUEST:W.MediaUIEvents.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new Q.Mq.CustomEvent(t,{composed:!0,bubbles:!0}))}}handleMediaUpdated(e){let t=e=>Promise.resolve(e);if(!e)return console.error('<media-chrome>: Media element set with slot="media" does not appear to be compatible.',e),Promise.reject(e);let i=e.nodeName.toLowerCase();return i.includes("-")?Q.Mq.customElements.whenDefined(i).then(()=>t(e)):t(e)}mediaUnsetCallback(e){}connectedCallback(){var e;let t=null!=this.getAttribute(eg.AUDIO),i=t?$.zy.AUDIO_PLAYER():$.zy.VIDEO_PLAYER();this.setAttribute("role","region"),this.setAttribute("aria-label",i),this.media&&this.handleMediaUpdated(this.media).then(e=>this.mediaSetCallback(e)),this.setAttribute(eg.USER_INACTIVE,"");let r=()=>{if(this.autohide<0||this.hasAttribute(eg.USER_INACTIVE))return;this.setAttribute(eg.USER_INACTIVE,"");let e=new Q.Mq.CustomEvent(W.TP.USER_INACTIVE,{composed:!0,bubbles:!0,detail:!0});this.dispatchEvent(e)},n=()=>{if(!this.hasAttribute(eg.USER_INACTIVE))return;this.removeAttribute(eg.USER_INACTIVE);let e=new Q.Mq.CustomEvent(W.TP.USER_INACTIVE,{composed:!0,bubbles:!0,detail:!1});this.dispatchEvent(e)},a=()=>{n(),clearTimeout(this._inactiveTimeout),this.autohide<0||(this._inactiveTimeout=setTimeout(()=>{r()},1e3*this.autohide))};this.addEventListener("keyup",()=>{a()}),this.addEventListener("pointerup",e=>{"touch"===e.pointerType?[this,this.media].includes(e.target)&&!this.hasAttribute(eg.USER_INACTIVE)?r():a():e.composedPath().some(e=>{var t;return["media-play-button","media-fullscreen-button"].includes(null==(t=null==e?void 0:e.nodeName)?void 0:t.toLowerCase())})&&a()}),this.addEventListener("pointermove",e=>{"mouse"===e.pointerType&&(n(),clearTimeout(this._inactiveTimeout),[this,this.media].includes(e.target)&&a())}),this.addEventListener("mouseleave",()=>{r()}),this.addEventListener("keyup",()=>{this.setAttribute(eg.KEYBOARD_CONTROL,"")}),null==(e=Q.Mq.window)||e.addEventListener("mouseup",()=>{this.removeAttribute(eg.KEYBOARD_CONTROL)})}set autohide(e){e=Number(e),this._autohide=isNaN(e)?0:e}get autohide(){return void 0===this._autohide?2:this._autohide}}var e_=i(80401),eE=i(85222);let eS={enter:"requestFullscreen",exit:"exitFullscreen",rootEvents:["fullscreenchange"],mediaEvents:[],element:"fullscreenElement",error:"fullscreenerror",enabled:"fullscreenEnabled"};void 0===Q.tj.fullscreenElement&&(eS.enter="webkitRequestFullScreen",eS.exit=null!=Q.tj.webkitExitFullscreen?"webkitExitFullscreen":"webkitCancelFullScreen",eS.rootEvents=["webkitfullscreenchange"],eS.mediaEvents=["webkitbeginfullscreen","webkitendfullscreen"],eS.element="webkitFullscreenElement",eS.error="webkitfullscreenerror",eS.enabled="webkitFullscreenEnabled");let ex=()=>{var e,t;return r||(r=null==(t=null==(e=Q.tj)?void 0:e.createElement)?void 0:t.call(e,"video"))},eT=async(e=ex())=>{if(!e)return!1;let t=e.volume;return e.volume=t/2+.1,await (0,q.gw)(0),e.volume!==t},ew=((e=ex())=>{let t=Q.tj[eS.enabled];return!t&&e&&(t="webkitSupportsFullscreen"in e),t})(),eA=((e=ex())=>"function"==typeof(null==e?void 0:e.requestPictureInPicture))(),eM=!!Q.Mq.WebKitPlaybackTargetAvailabilityEvent,eR=!!Q.Mq.chrome,eC=eT().then(e=>n=e),eI=Object.values(W.lo),eL=e=>(0,eE.Jc)(e.media,e=>[W.Jz.SUBTITLES,W.Jz.CAPTIONS].includes(e.kind)).sort((e,t)=>e.kind>=t.kind?1:-1),ek=e=>(0,eE.Jc)(e.media,e=>e.mode===W.t7.SHOWING&&[W.Jz.SUBTITLES,W.Jz.CAPTIONS].includes(e.kind)),eD={MEDIA_PAUSED:{get:function(e){let{media:t}=e;return!t||t.paused},mediaEvents:["play","playing","pause","emptied"]},MEDIA_HAS_PLAYED:{get:function(e){let{media:t}=e;return!!t&&!t.paused},mediaEvents:["playing","emptied"]},MEDIA_ENDED:{get:function(e){let{media:t}=e;return!!t&&t.ended},mediaEvents:["seeked","ended","emptied"]},MEDIA_PLAYBACK_RATE:{get:function(e){let{media:t}=e;return t&&void 0!==t.playbackRate?t.playbackRate:1},mediaEvents:["ratechange","loadstart"]},MEDIA_MUTED:{get:function(e){let{media:t}=e;return!!t&&void 0!==t.muted&&t.muted},mediaEvents:["volumechange"]},MEDIA_VOLUME:{get:function(e){let{media:t}=e;return t&&void 0!==t.volume?Number(t.volume):1},mediaEvents:["volumechange"]},MEDIA_VOLUME_LEVEL:{get:function(e){let{media:t}=e,i="high";if(!t||void 0===t.volume)return i;let{muted:r,volume:n}=t;return 0===n||r?i="off":n<.5?i="low":n<.75&&(i="medium"),i},mediaEvents:["volumechange"]},MEDIA_CURRENT_TIME:{get:function(e){let{media:t}=e;return t&&void 0!==t.currentTime?t.currentTime:0},mediaEvents:["timeupdate","loadedmetadata"]},MEDIA_DURATION:{get:function(e){let{media:t}=e;return t&&Number.isFinite(t.duration)?t.duration:NaN},mediaEvents:["durationchange","loadedmetadata","emptied"]},MEDIA_SEEKABLE:{get:function(e){var t;let{media:i}=e;if(!(null==(t=null==i?void 0:i.seekable)?void 0:t.length))return;let r=i.seekable.start(0),n=i.seekable.end(i.seekable.length-1);if(r||n)return[Number(r.toFixed(3)),Number(n.toFixed(3))]},mediaEvents:["loadedmetadata","emptied","progress"]},MEDIA_LOADING:{get:function(e){var t;return(null==(t=e.media)?void 0:t.readyState)<3},mediaEvents:["waiting","playing","emptied"]},MEDIA_BUFFERED:{get:function(e){var t,i,r;let n=null==(t=e.media)?void 0:t.buffered;return Array.from(null!=(r=null==(i=e.media)?void 0:i.buffered)?r:[]).map((e,t)=>[Number(n.start(t)).toFixed(3),Number(n.end(t)).toFixed(3)])},mediaEvents:["progress","emptied"]},MEDIA_STREAM_TYPE:{get:function(e){let{media:t}=e;if(!t)return;let{streamType:i}=t;if(eI.includes(i)){if(i===W.lo.UNKNOWN){let t=e.getAttribute("defaultstreamtype");return[W.lo.LIVE,W.lo.ON_DEMAND].includes(t)?t:void 0}return i}let r=t.duration;if(r===1/0)return W.lo.LIVE;if(Number.isFinite(r))return W.lo.ON_DEMAND;{let t=e.getAttribute("defaultstreamtype");if([W.lo.LIVE,W.lo.ON_DEMAND].includes(t))return t}},mediaEvents:["emptied","durationchange","loadedmetadata","streamtypechange"]},MEDIA_TARGET_LIVE_WINDOW:{get:function(e){let{media:t}=e;if(!t)return Number.NaN;let{targetLiveWindow:i}=t,r=eD.MEDIA_STREAM_TYPE.get(e);return(null==i||Number.isNaN(i))&&r===W.lo.LIVE?0:i},mediaEvents:["emptied","durationchange","loadedmetadata","streamtypechange","targetlivewindowchange"]},MEDIA_TIME_IS_LIVE:{get:function(e){let{media:t}=e;if(!t)return!1;if("number"==typeof t.liveEdgeStart)return!Number.isNaN(t.liveEdgeStart)&&t.currentTime>=t.liveEdgeStart;let i="live"===eD.MEDIA_STREAM_TYPE.get(e);if(!i)return!1;let r=t.seekable;if(!r)return!0;if(!r.length)return!1;let n=e.hasAttribute("liveedgeoffset")?Number(e.getAttribute("liveedgeoffset")):10,a=r.end(r.length-1)-n;return t.currentTime>=a},mediaEvents:["playing","timeupdate","progress","waiting","emptied"]},MEDIA_IS_FULLSCREEN:{get:function(e,t){var i;let r;let n=e.media;if(n&&void 0===Q.tj[eS.element]&&"webkitDisplayingFullscreen"in n)return n.webkitDisplayingFullscreen&&"fullscreen"===n.webkitPresentationMode;if(t){let e=Q.tj[eS.element];r=e?t.target:null}else r=null!=(i=e.getRootNode().fullscreenElement)?i:Q.tj[eS.element];return(0,ee.Mj)(e.fullscreenElement,r)},rootEvents:eS.rootEvents,mediaEvents:eS.mediaEvents},MEDIA_IS_PIP:{get:function(e,t){var i;let r=e.media;if(!r)return!1;if(t)return"enterpictureinpicture"==t.type;{let t=null!=(i=e.getRootNode().pictureInPictureElement)?i:Q.tj.pictureInPictureElement;return(0,ee.Mj)(r,t)}},mediaEvents:["enterpictureinpicture","leavepictureinpicture"]},MEDIA_IS_CASTING:{get:function(e,t){var i;let{media:r}=e;if(!r)return!1;let n=null==(i=Q.Mq.CastableVideoElement)?void 0:i.castElement,a=(0,ee.Mj)(r,n);return(null==t?void 0:t.type)==="castchange"&&(null==t?void 0:t.detail)==="CONNECTING"&&(a="connecting"),a},mediaEvents:["entercast","leavecast","castchange"]},MEDIA_AIRPLAY_UNAVAILABLE:{get:function(e,t){if(!eM)return W.Xs.UNSUPPORTED;if(t){if("available"===t.availability)return;if("not-available"===t.availability)return W.Xs.UNAVAILABLE}},mediaEvents:["webkitplaybacktargetavailabilitychanged"]},MEDIA_CAST_UNAVAILABLE:{get:function(){var e;let t=null==(e=Q.Mq.CastableVideoElement)?void 0:e.castState;return eR&&t?t.includes("CONNECT")?void 0:W.Xs.UNAVAILABLE:W.Xs.UNSUPPORTED},mediaEvents:["castchange"]},MEDIA_FULLSCREEN_UNAVAILABLE:{get:function(){return ew?void 0:W.Xs.UNAVAILABLE}},MEDIA_PIP_UNAVAILABLE:{get:function(){return eA?void 0:W.Xs.UNSUPPORTED}},MEDIA_RENDITION_UNAVAILABLE:{get:function(e){var t;let{media:i}=e;return(null==i?void 0:i.videoRenditions)?(null==(t=i.videoRenditions)?void 0:t.length)?void 0:W.Xs.UNAVAILABLE:W.Xs.UNSUPPORTED},mediaEvents:["emptied","loadstart"],videoRenditionsEvents:["addrendition","removerendition"]},MEDIA_AUDIO_TRACK_UNAVAILABLE:{get:function(e){var t,i;let{media:r}=e;return(null==r?void 0:r.audioTracks)?(null!=(i=null==(t=r.audioTracks)?void 0:t.length)?i:0)<=1?W.Xs.UNAVAILABLE:void 0:W.Xs.UNSUPPORTED},mediaEvents:["emptied","loadstart"],audioTracksEvents:["addtrack","removetrack"]},MEDIA_VOLUME_UNAVAILABLE:{get:function(e){if(void 0!==n&&!n)return W.Xs.UNSUPPORTED;let{media:t}=e;if(t&&void 0===t.volume)return W.Xs.UNAVAILABLE},mediaEvents:["loadstart"]},MEDIA_SUBTITLES_LIST:{get:function(e){return eL(e).map(({kind:e,label:t,language:i})=>({kind:e,label:t,language:i}))},mediaEvents:["loadstart"],textTracksEvents:["addtrack","removetrack"]},MEDIA_SUBTITLES_SHOWING:{get:function(e){return!e.hasAttribute("defaultsubtitles")||e.hasAttribute(W.MediaUIAttributes.MEDIA_HAS_PLAYED)||e.hasAttribute(W.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING)||(0,eE.U2)(e,!0),ek(e).map(({kind:e,label:t,language:i})=>({kind:e,label:t,language:i}))},mediaEvents:["loadstart"],textTracksEvents:["addtrack","removetrack","change"]},MEDIA_RENDITION_LIST:{get:function(e){var t;let{media:i}=e;return[...null!=(t=null==i?void 0:i.videoRenditions)?t:[]]},mediaEvents:["emptied","loadstart"],videoRenditionsEvents:["addrendition","removerendition"]},MEDIA_RENDITION_SELECTED:{get:function(e){var t,i,r;let{media:n}=e;return null==(r=null==(i=null==n?void 0:n.videoRenditions)?void 0:i[null==(t=n.videoRenditions)?void 0:t.selectedIndex])?void 0:r.id},mediaEvents:["emptied"],videoRenditionsEvents:["addrendition","removerendition","change"]},MEDIA_AUDIO_TRACK_LIST:{get:function(e){var t;let{media:i}=e;return[...null!=(t=null==i?void 0:i.audioTracks)?t:[]]},mediaEvents:["emptied","loadstart"],audioTracksEvents:["addtrack","removetrack"]},MEDIA_AUDIO_TRACK_ENABLED:{get:function(e){var t,i;let{media:r}=e;return null==(i=[...null!=(t=null==r?void 0:r.audioTracks)?t:[]].find(e=>e.enabled))?void 0:i.id},mediaEvents:["emptied"],audioTracksEvents:["addtrack","removetrack","change"]}},eP={MEDIA_PLAY_REQUEST:(e,t,i)=>{var r;let n=eD.MEDIA_STREAM_TYPE.get(i),a=null===i.getAttribute("noautoseektolive");n==W.lo.LIVE&&a&&eP.MEDIA_SEEK_TO_LIVE_REQUEST(e),null==(r=e.play())||r.catch(()=>{})},MEDIA_PAUSE_REQUEST:e=>e.pause(),MEDIA_MUTE_REQUEST:e=>e.muted=!0,MEDIA_UNMUTE_REQUEST:e=>{e.muted=!1,0===e.volume&&(e.volume=.25)},MEDIA_VOLUME_REQUEST:(e,t,i)=>{let r=t.detail;if(e.volume=r,r>0&&e.muted&&(e.muted=!1),!i.hasAttribute("novolumepref"))try{Q.Mq.localStorage.setItem("media-chrome-pref-volume",r.toString())}catch(e){}},MEDIA_ENTER_FULLSCREEN_REQUEST:(e,t,i)=>{if(!ew){console.warn("Fullscreen support is unavailable; not entering fullscreen");return}Q.tj.pictureInPictureElement&&Q.tj.exitPictureInPicture(),i[eS.enter]?i.fullscreenElement[eS.enter]():e.webkitEnterFullscreen?e.webkitEnterFullscreen():e.requestFullscreen?e.requestFullscreen():console.warn("MediaChrome: Fullscreen not supported")},MEDIA_EXIT_FULLSCREEN_REQUEST:()=>{Q.tj[eS.exit]()},MEDIA_ENTER_PIP_REQUEST:e=>{if(!Q.tj.pictureInPictureEnabled){console.warn("MediaChrome: Picture-in-picture is not enabled");return}if(!e.requestPictureInPicture){console.warn("MediaChrome: The current media does not support picture-in-picture");return}Q.tj[eS.element]&&Q.tj[eS.exit]();let t=()=>{console.warn("MediaChrome: The media is not ready for picture-in-picture. It must have a readyState > 0.")};e.requestPictureInPicture().catch(i=>{if(11===i.code){if(0===e.readyState&&"none"===e.preload){let i=()=>{e.removeEventListener("loadedmetadata",r),e.preload="none"},r=()=>{e.requestPictureInPicture().catch(t),i()};e.addEventListener("loadedmetadata",r),e.preload="metadata",setTimeout(()=>{0===e.readyState&&t(),i()},1e3)}else throw i}else throw i})},MEDIA_EXIT_PIP_REQUEST:()=>{Q.tj.pictureInPictureElement&&Q.tj.exitPictureInPicture()},MEDIA_ENTER_CAST_REQUEST:e=>{var t;(null==(t=Q.Mq.CastableVideoElement)?void 0:t.castEnabled)&&(Q.tj[eS.element]&&Q.tj[eS.exit](),e.requestCast())},MEDIA_EXIT_CAST_REQUEST:async()=>{var e;(null==(e=Q.Mq.CastableVideoElement)?void 0:e.castElement)&&Q.Mq.CastableVideoElement.exitCast()},MEDIA_SEEK_REQUEST:(e,t)=>{let i=t.detail;(e.readyState>0||void 0===e.readyState)&&(e.currentTime=i)},MEDIA_PLAYBACK_RATE_REQUEST:(e,t)=>{e.playbackRate=t.detail},MEDIA_PREVIEW_REQUEST:(e,t,i)=>{var r;if(!e)return;let n=t.detail;null===n&&i.propagateMediaState(W.MediaUIAttributes.MEDIA_PREVIEW_TIME,void 0),i.propagateMediaState(W.MediaUIAttributes.MEDIA_PREVIEW_TIME,n);let[a]=(0,eE.Jc)(e,{kind:W.Jz.METADATA,label:"thumbnails"});if(!(a&&a.cues))return;if(null===n){i.propagateMediaState(W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE,void 0),i.propagateMediaState(W.MediaUIAttributes.MEDIA_PREVIEW_COORDS,void 0);return}let s=Array.prototype.find.call(a.cues,e=>e.startTime>=n);if(!s)return;let o=/'^(?:[a-z]+:)?\/\//i.test(s.text)?void 0:null==(r=e.querySelector('track[label="thumbnails"]'))?void 0:r.src,l=new URL(s.text,o),u=new URLSearchParams(l.hash).get("#xywh");i.propagateMediaState(W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE,l.href),i.propagateMediaState(W.MediaUIAttributes.MEDIA_PREVIEW_COORDS,u.split(","))},MEDIA_SHOW_SUBTITLES_REQUEST:(e,t,i)=>{let r=eL(i),{detail:n=[]}=t;(0,eE.Bh)(W.t7.SHOWING,r,n)},MEDIA_DISABLE_SUBTITLES_REQUEST:(e,t,i)=>{let r=eL(i),{detail:n=[]}=t;(0,eE.Bh)(W.t7.DISABLED,r,n)},MEDIA_AIRPLAY_REQUEST:e=>{if(e){if(!(e.webkitShowPlaybackTargetPicker&&Q.Mq.WebKitPlaybackTargetAvailabilityEvent)){console.warn("received a request to select AirPlay but AirPlay is not supported in this environment");return}e.webkitShowPlaybackTargetPicker()}},MEDIA_SEEK_TO_LIVE_REQUEST:e=>{let t=e.seekable;if(!t){console.warn("MediaController: Media element does not support seeking to live.");return}if(!t.length){console.warn("MediaController: Media is unable to seek to live.");return}e.currentTime=t.end(t.length-1)},MEDIA_RENDITION_REQUEST:(e,t)=>{if(!(null==e?void 0:e.videoRenditions)){console.warn("MediaController: Rendition selection not supported by this media.");return}let i=t.detail,r=[...e.videoRenditions].findIndex(e=>e.id==i);e.videoRenditions.selectedIndex!=r&&(e.videoRenditions.selectedIndex=r)},MEDIA_AUDIO_TRACK_REQUEST:(e,t)=>{if(!(null==e?void 0:e.audioTracks)){console.warn("MediaController: Audio track selection not supported by this media.");return}let i=t.detail;for(let t of e.audioTracks)t.enabled=i==t.id}};var eO=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},eN=(e,t,i)=>(eO(e,t,"read from private field"),i?i.call(e):t.get(e)),eU=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},eF=(e,t,i,r)=>(eO(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),eB=(e,t,i)=>(eO(e,t,"access private method"),i);let eV=["ArrowLeft","ArrowRight","Enter"," ","f","m","k","c"],ez={DEFAULT_SUBTITLES:"defaultsubtitles",DEFAULT_STREAM_TYPE:"defaultstreamtype",FULLSCREEN_ELEMENT:"fullscreenelement",HOTKEYS:"hotkeys",KEYS_USED:"keysused",NO_HOTKEYS:"nohotkeys"};class ej extends eb{constructor(){super(),eU(this,l),eU(this,c),eU(this,s,new e_.D(this,ez.HOTKEYS)),eU(this,o,void 0),void 0===eD.MEDIA_VOLUME_UNAVAILABLE.get(this)&&eC.then(()=>{this.propagateMediaState(W.MediaUIAttributes.MEDIA_VOLUME_UNAVAILABLE,eD.MEDIA_VOLUME_UNAVAILABLE.get(this))}),this.mediaStateReceivers=[],this.associatedElementSubscriptions=new Map,this.associateElement(this),Object.keys(eP).forEach(e=>{let t=`_handle${(0,q.k7)(e,!0)}`;this[t]=t=>{if(t.stopPropagation(),!this.media){console.warn("MediaController: No media available.");return}eP[e](this.media,t,this)},this.addEventListener(W.MediaUIEvents[e],this[t])}),this._mediaStatePropagators={},Object.keys(eD).forEach(e=>{this._mediaStatePropagators[e]=t=>{this.propagateMediaState(W.Bm[e],eD[e].get(this,t))}}),this.enableHotkeys()}static get observedAttributes(){return super.observedAttributes.concat(ez.NO_HOTKEYS,ez.HOTKEYS,ez.DEFAULT_STREAM_TYPE,ez.DEFAULT_SUBTITLES)}get fullscreenElement(){var e;return null!=(e=eN(this,o))?e:this}set fullscreenElement(e){this.hasAttribute(ez.FULLSCREEN_ELEMENT)&&this.removeAttribute(ez.FULLSCREEN_ELEMENT),eF(this,o,e)}attributeChangedCallback(e,t,i){var r;if(e===ez.NO_HOTKEYS)i!==t&&""===i?(this.hasAttribute(ez.HOTKEYS)&&console.warn("Both `hotkeys` and `nohotkeys` have been set. All hotkeys will be disabled."),this.disableHotkeys()):i!==t&&null===i&&this.enableHotkeys();else if(e===ez.HOTKEYS)eN(this,s).value=i;else if(e===ez.DEFAULT_SUBTITLES&&i!==t&&""===i)(0,eE.U2)(this,!0);else if(e===ez.DEFAULT_STREAM_TYPE)this.propagateMediaState(W.Bm.MEDIA_STREAM_TYPE);else if(e===ez.FULLSCREEN_ELEMENT){let e=i?null==(r=this.getRootNode())?void 0:r.getElementById(i):void 0;eF(this,o,e)}super.attributeChangedCallback(e,t,i)}mediaSetCallback(e){if(super.mediaSetCallback(e),e.hasAttribute("tabindex")||(e.tabIndex=-1),Object.keys(eD).forEach(t=>{let{mediaEvents:i,rootEvents:r,textTracksEvents:n,videoRenditionsEvents:a,audioTracksEvents:s}=eD[t],o=this._mediaStatePropagators[t];null==i||i.forEach(t=>{e.addEventListener(t,o),o()}),null==r||r.forEach(e=>{this.getRootNode().addEventListener(e,o),o()}),null==n||n.forEach(t=>{var i;null==(i=e.textTracks)||i.addEventListener(t,o),o()}),null==a||a.forEach(t=>{var i;null==(i=e.videoRenditions)||i.addEventListener(t,o),o()}),null==s||s.forEach(t=>{var i;null==(i=e.audioTracks)||i.addEventListener(t,o),o()})}),!this.hasAttribute("novolumepref"))try{let t=Q.Mq.localStorage.getItem("media-chrome-pref-volume");null!==t&&(e.volume=t)}catch(e){console.debug("Error getting volume pref",e)}}mediaUnsetCallback(e){super.mediaUnsetCallback(e),Object.keys(eD).forEach(t=>{let{mediaEvents:i,rootEvents:r,textTracksEvents:n,videoRenditionsEvents:a,audioTracksEvents:s}=eD[t],o=this._mediaStatePropagators[t];null==i||i.forEach(t=>{e.removeEventListener(t,o)}),null==r||r.forEach(e=>{this.getRootNode().removeEventListener(e,o)}),null==n||n.forEach(t=>{var i;null==(i=e.textTracks)||i.removeEventListener(t,o)}),null==a||a.forEach(t=>{var i;null==(i=e.videoRenditions)||i.removeEventListener(t,o),o()}),null==s||s.forEach(t=>{var i;null==(i=e.audioTracks)||i.removeEventListener(t,o),o()})}),this.propagateMediaState(W.Bm.MEDIA_PAUSED,!0)}propagateMediaState(e,t){let i=e0(this.mediaStateReceivers,e);if(eQ(this.mediaStateReceivers,e,t),i===e0(this.mediaStateReceivers,e))return;let r=e.toLowerCase(),n=new Q.Mq.CustomEvent(W.ft[r],{composed:!0,bubbles:!0,detail:t});this.dispatchEvent(n)}associateElement(e){if(!e)return;let{associatedElementSubscriptions:t}=this;if(t.has(e))return;let i=this.registerMediaStateReceiver.bind(this),r=this.unregisterMediaStateReceiver.bind(this),n=e1(e,i,r);Object.keys(W.MediaUIEvents).forEach(t=>{e.addEventListener(W.MediaUIEvents[t],this[`_handle${(0,q.k7)(t,!0)}`])}),t.set(e,n)}unassociateElement(e){if(!e)return;let{associatedElementSubscriptions:t}=this;if(!t.has(e))return;let i=t.get(e);i(),t.delete(e),Object.keys(W.MediaUIEvents).forEach(t=>{e.removeEventListener(W.MediaUIEvents[t],this[`_handle${(0,q.k7)(t,!0)}`])})}registerMediaStateReceiver(e){if(!e)return;let t=this.mediaStateReceivers,i=t.indexOf(e);i>-1||(t.push(e),Object.keys(eD).forEach(t=>{let i=eD[t];eQ([e],W.Bm[t],i.get(this))}))}unregisterMediaStateReceiver(e){let t=this.mediaStateReceivers,i=t.indexOf(e);i<0||t.splice(i,1)}enableHotkeys(){this.addEventListener("keydown",eB(this,c,d))}disableHotkeys(){this.removeEventListener("keydown",eB(this,c,d)),this.removeEventListener("keyup",eB(this,l,u))}get hotkeys(){return eN(this,s)}keyboardShortcutHandler(e){var t,i,r,n;let a,o,l,u;let c=(null!=(n=null!=(r=null==(t=e.target.getAttribute(ez.KEYS_USED))?void 0:t.split(" "))?r:null==(i=e.target)?void 0:i.keysUsed)?n:[]).map(e=>"Space"===e?" ":e).filter(Boolean);if(!c.includes(e.key)&&!eN(this,s).contains(`no${e.key.toLowerCase()}`)&&!(" "===e.key&&eN(this,s).contains("nospace")))switch(e.key){case" ":case"k":a=null!=this.getAttribute(W.MediaUIAttributes.MEDIA_PAUSED)?W.MediaUIEvents.MEDIA_PLAY_REQUEST:W.MediaUIEvents.MEDIA_PAUSE_REQUEST,this.dispatchEvent(new Q.Mq.CustomEvent(a,{composed:!0,bubbles:!0}));break;case"m":a="off"===this.getAttribute(W.MediaUIAttributes.MEDIA_VOLUME_LEVEL)?W.MediaUIEvents.MEDIA_UNMUTE_REQUEST:W.MediaUIEvents.MEDIA_MUTE_REQUEST,this.dispatchEvent(new Q.Mq.CustomEvent(a,{composed:!0,bubbles:!0}));break;case"f":a=null!=this.getAttribute(W.MediaUIAttributes.MEDIA_IS_FULLSCREEN)?W.MediaUIEvents.MEDIA_EXIT_FULLSCREEN_REQUEST:W.MediaUIEvents.MEDIA_ENTER_FULLSCREEN_REQUEST,this.dispatchEvent(new Q.Mq.CustomEvent(a,{composed:!0,bubbles:!0}));break;case"c":(0,eE.U2)(this);break;case"ArrowLeft":l=Math.max(((o=this.getAttribute(W.MediaUIAttributes.MEDIA_CURRENT_TIME))&&!Number.isNaN(+o)?+o:0)-10,0),u=new Q.Mq.CustomEvent(W.MediaUIEvents.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:l}),this.dispatchEvent(u);break;case"ArrowRight":l=Math.max(((o=this.getAttribute(W.MediaUIAttributes.MEDIA_CURRENT_TIME))&&!Number.isNaN(+o)?+o:0)+10,0),u=new Q.Mq.CustomEvent(W.MediaUIEvents.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:l}),this.dispatchEvent(u)}}}s=new WeakMap,o=new WeakMap,l=new WeakSet,u=function(e){let{key:t}=e;if(!eV.includes(t)){this.removeEventListener("keyup",eB(this,l,u));return}this.keyboardShortcutHandler(e)},c=new WeakSet,d=function(e){let{metaKey:t,altKey:i,key:r}=e;if(t||i||!eV.includes(r)){this.removeEventListener("keyup",eB(this,l,u));return}[" ","ArrowLeft","ArrowRight"].includes(r)&&!(eN(this,s).contains(`no${r.toLowerCase()}`)||" "===r&&eN(this,s).contains("nospace"))&&e.preventDefault(),this.addEventListener("keyup",eB(this,l,u),{once:!0})};let eH=Object.values(W.MediaUIAttributes),eG=Object.values(W.Bm),eW=e=>{var t,i,r,n;let{observedAttributes:a}=e.constructor;!a&&(null==(t=e.nodeName)?void 0:t.includes("-"))&&(Q.Mq.customElements.upgrade(e),{observedAttributes:a}=e.constructor);let s=null==(n=null==(r=null==(i=null==e?void 0:e.getAttribute)?void 0:i.call(e,W.m0.MEDIA_CHROME_ATTRIBUTES))?void 0:r.split)?void 0:n.call(r,/\s+/);return Array.isArray(a||s)?(a||s).filter(e=>eH.includes(e)):[]},e$=e=>{var t,i;return(null==(t=e.nodeName)?void 0:t.includes("-"))&&Q.Mq.customElements.get(null==(i=e.nodeName)?void 0:i.toLowerCase())&&!(e instanceof Q.Mq.customElements.get(e.nodeName.toLowerCase()))&&Q.Mq.customElements.upgrade(e),eG.some(t=>t in e)},eq=e=>e$(e)||!!eW(e).length,eY=e=>{var t;return null==(t=null==e?void 0:e.join)?void 0:t.call(e,":")},eK={[W.MediaUIAttributes.MEDIA_SUBTITLES_LIST]:eE.fj,[W.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING]:eE.fj,[W.MediaUIAttributes.MEDIA_SEEKABLE]:eY,[W.MediaUIAttributes.MEDIA_BUFFERED]:e=>null==e?void 0:e.map(eY).join(" "),[W.MediaUIAttributes.MEDIA_PREVIEW_COORDS]:e=>null==e?void 0:e.join(" "),[W.MediaUIAttributes.MEDIA_RENDITION_LIST]:q.UO,[W.MediaUIAttributes.MEDIA_AUDIO_TRACK_LIST]:q.Zp},eX=async(e,t,i)=>{var r,n;if(e.isConnected||await (0,q.gw)(0),"boolean"==typeof i||null==i)return(0,ee.Pj)(e,t,i);if("number"==typeof i)return(0,ee.Jv)(e,t,i);if("string"==typeof i)return(0,ee.Lb)(e,t,i);if(Array.isArray(i)&&!i.length)return e.removeAttribute(t);let a=null!=(n=null==(r=eK[t])?void 0:r.call(eK,i))?n:i;return e.setAttribute(t,a)},eZ=e=>{var t;return!!(null==(t=e.closest)?void 0:t.call(e,'*[slot="media"]'))},eJ=(e,t)=>{if(eZ(e))return;let i=(e,t)=>{var i,r;eq(e)&&t(e);let{children:n=[]}=null!=e?e:{},a=null!=(r=null==(i=null==e?void 0:e.shadowRoot)?void 0:i.children)?r:[],s=[...n,...a];s.forEach(e=>eJ(e,t))},r=null==e?void 0:e.nodeName.toLowerCase();if(r.includes("-")&&!eq(e)){Q.Mq.customElements.whenDefined(r).then(()=>{i(e,t)});return}i(e,t)},eQ=(e,t,i)=>{e.forEach(e=>{if(t in e){e[t]=i;return}let r=eW(e),n=t.toLowerCase();r.includes(n)&&eX(e,n,i)})},e0=(e,t)=>{for(let i of e){if(t in i)return i[t];let e=eW(i),r=t.toLowerCase();if(e.includes(r))return i.getAttribute(r)}},e1=(e,t,i)=>{eJ(e,t);let r=e=>{var i;let r=null!=(i=null==e?void 0:e.composedPath()[0])?i:e.target;t(r)},n=e=>{var t;let r=null!=(t=null==e?void 0:e.composedPath()[0])?t:e.target;i(r)};e.addEventListener(W.MediaUIEvents.REGISTER_MEDIA_STATE_RECEIVER,r),e.addEventListener(W.MediaUIEvents.UNREGISTER_MEDIA_STATE_RECEIVER,n);let a=[],s=e=>{let r=e.target;"media"!==r.name&&(a.forEach(e=>eJ(e,i)),(a=[...r.assignedElements({flatten:!0})]).forEach(e=>eJ(e,t)))};e.addEventListener("slotchange",s);let o=new MutationObserver(e=>{e.forEach(e=>{let{addedNodes:r=[],removedNodes:n=[],type:a,target:s,attributeName:o}=e;"childList"===a?(Array.prototype.forEach.call(r,e=>eJ(e,t)),Array.prototype.forEach.call(n,e=>eJ(e,i))):"attributes"===a&&o===W.m0.MEDIA_CHROME_ATTRIBUTES&&(eq(s)?t(s):i(s))})});return o.observe(e,{childList:!0,attributes:!0,subtree:!0}),()=>{eJ(e,i),e.removeEventListener("slotchange",s),o.disconnect(),e.removeEventListener(W.MediaUIEvents.REGISTER_MEDIA_STATE_RECEIVER,r),e.removeEventListener(W.MediaUIEvents.UNREGISTER_MEDIA_STATE_RECEIVER,n)}};Q.Mq.customElements.get("media-controller")||Q.Mq.customElements.define("media-controller",ej);var e2=ej,e3=Object.defineProperty,e5=(e,t,i)=>t in e?e3(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,e4=(e,t,i)=>(e5(e,"symbol"!=typeof t?t+"":t,i),i),e6=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},e8=(e,t,i)=>(e6(e,t,"read from private field"),i?i.call(e):t.get(e)),e7=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},e9=(e,t,i,r)=>(e6(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);let te=Q.tj.createElement("template"),tt=`
  height: var(--thumb-height);
  width: var(--media-range-thumb-width, 10px);
  border: var(--media-range-thumb-border, none);
  border-radius: var(--media-range-thumb-border-radius, 10px);
  background: var(--media-range-thumb-background, var(--media-primary-color, rgb(238 238 238)));
  box-shadow: var(--media-range-thumb-box-shadow, 1px 1px 1px transparent);
  cursor: pointer;
  transition: var(--media-range-thumb-transition, none);
  transform: var(--media-range-thumb-transform, none);
  opacity: var(--media-range-thumb-opacity, 1);
`,ti=`
  min-width: 40px;
  height: var(--track-height);
  border: var(--media-range-track-border, none);
  outline: var(--media-range-track-outline);
  outline-offset: var(--media-range-track-outline-offset);
  border-radius: var(--media-range-track-border-radius, 1px);
  background: var(--media-range-track-progress-internal, var(--media-range-track-background, rgb(255 255 255 / .2)));
  backdrop-filter: var(--media-range-track-backdrop-filter);
  box-shadow: var(--media-range-track-box-shadow, none);
  transition: var(--media-range-track-transition, none);
  transform: translate(var(--media-range-track-translate-x, 0), var(--media-range-track-translate-y, 0));
  cursor: pointer;
`;te.innerHTML=`
  <style>
    :host {
      --thumb-height: var(--media-range-thumb-height, 10px);
      --track-height: var(--media-range-track-height, 4px);
      --_focus-box-shadow: var(--media-focus-box-shadow, inset 0 0 0 2px rgb(27 127 204 / .9));
      --_media-range-padding: var(--media-range-padding, var(--media-control-padding, 10px));

      vertical-align: middle;
      box-sizing: border-box;
      display: inline-block;
      position: relative;
      background: var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)));
      transition: background .15s linear;
      width: 100px;
      height: calc(var(--media-control-height, 24px) + 2 * var(--_media-range-padding));
      padding-left: var(--media-range-padding-left, var(--_media-range-padding));
      padding-right: var(--media-range-padding-right, var(--_media-range-padding));
      pointer-events: auto;
      
      font-size: 0;
      box-shadow: var(--_focus-visible-box-shadow, none);
    }

    
    input[type=range]:focus {
      outline: 0;
    }
    input[type=range]:focus::-webkit-slider-runnable-track {
      outline: 0;
    }

    :host(:hover) {
      background: var(--media-control-hover-background, rgb(50 50 70 / .7));
    }

    #container {
      position: relative;
      height: 100%;
    }

    input[type=range] {
      
      -webkit-appearance: none; 
      background: transparent; 

      
      min-height: 100%;
      width: var(--media-range-track-width, 100%); 

      box-sizing: border-box;
      padding: 0;
      margin: 0;
    }

    
    input[type=range]::-webkit-slider-thumb {
      -webkit-appearance: none;
      ${tt}
      
      margin-top: calc(calc(0px - var(--thumb-height) + var(--track-height)) / 2);
    }

    
    input[type=range]::-moz-range-thumb {
      ${tt}
      translate: var(--media-range-track-translate-x, 0) var(--media-range-track-translate-y, 0);
    }

    input[type=range]::-webkit-slider-runnable-track { ${ti} }
    input[type=range]::-moz-range-track { ${ti} }
    input[type=range]::-ms-track {
      
      width: 100%;
      cursor: pointer;
      
      background: transparent;
      border-color: transparent;
      color: transparent;

      ${ti}
    }

    #background,
    #pointer {
      width: var(--media-range-track-width, 100%);
      height: var(--track-height);
      border-radius: var(--media-range-track-border-radius, 1px);
      position: absolute;
      top: 50%;
      transform: translate(var(--media-range-track-translate-x, 0px), calc(var(--media-range-track-translate-y, 0px) - 50%));
    }

    #background {
      min-width: 40px;
      background: var(--media-range-track-background, rgb(255 255 255 / .2));
      backdrop-filter: var(--media-range-track-background-backdrop-filter);
    }

    #pointer {
      background: var(--media-range-track-pointer-background);
      border-right: var(--media-range-track-pointer-border-right);
      transition: visibility .25s, opacity .25s;
      visibility: hidden;
      opacity: 0;
    }

    :host(:hover) #pointer {
      transition: visibility .5s, opacity .5s;
      visibility: visible;
      opacity: 1;
    }

    #hoverzone {
      
      z-index: 1;
      display: var(--media-time-range-hover-display, none);
      position: absolute;
      width: 100%;
      bottom: var(--media-time-range-hover-bottom, -5px);
      height: var(--media-time-range-hover-height, max(calc(100% + 5px), 20px));
    }

    #range {
      z-index: 2;
      position: relative;
      height: var(--media-range-track-height, 4px);
    }

    input[type=range]:disabled::-webkit-slider-thumb {
      background-color: #777;
    }

    input[type=range]:disabled::-webkit-slider-runnable-track {
      background-color: #777;
    }
  </style>
  <div id="container">
    <div id="background"></div>
    <div id="pointer"></div>
    <div id="hoverzone"></div>
    <input id="range" type="range" min="0" max="1000" step="any" value="0">
  </div>
`;class tr extends Q.Mq.HTMLElement{constructor(){super(),e4(this,"thumbWidth"),e7(this,h,void 0),e7(this,f,()=>{if(this.range.matches(":focus-visible")){let{style:e}=(0,ee.R7)(this.shadowRoot,":host");e.setProperty("--_focus-visible-box-shadow","var(--_focus-box-shadow)")}}),e7(this,p,()=>{let{style:e}=(0,ee.R7)(this.shadowRoot,":host");e.removeProperty("--_focus-visible-box-shadow")}),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(te.content.cloneNode(!0)));let{style:e}=(0,ee.R7)(this.shadowRoot,":host");e.setProperty("display",`var(--media-control-display, var(--${this.localName}-display, inline-block))`),this.container=this.shadowRoot.querySelector("#container"),this.range=this.shadowRoot.querySelector("#range"),this.range.addEventListener("input",this.updateBar.bind(this)),this.thumbWidth=parseInt(getComputedStyle(this).getPropertyValue("--media-range-thumb-width")||"10",10)}static get observedAttributes(){return["disabled","aria-disabled",W.m0.MEDIA_CONTROLLER]}attributeChangedCallback(e,t,i){var r,n,a,s,o;e===W.m0.MEDIA_CONTROLLER?(t&&(null==(n=null==(r=e8(this,h))?void 0:r.unassociateElement)||n.call(r,this),e9(this,h,null)),i&&(e9(this,h,null==(a=this.getRootNode())?void 0:a.getElementById(i)),null==(o=null==(s=e8(this,h))?void 0:s.associateElement)||o.call(s,this))):("disabled"===e||"aria-disabled"===e&&t!==i)&&(null==i?this.range.removeAttribute(e):this.range.setAttribute(e,i))}connectedCallback(){var e,t,i;let r=this.getAttribute(W.m0.MEDIA_CONTROLLER);r&&(e9(this,h,null==(e=this.getRootNode())?void 0:e.getElementById(r)),null==(i=null==(t=e8(this,h))?void 0:t.associateElement)||i.call(t,this)),this.updateBar(),this.shadowRoot.addEventListener("focusin",e8(this,f)),this.shadowRoot.addEventListener("focusout",e8(this,p))}disconnectedCallback(){var e,t;null==(t=null==(e=e8(this,h))?void 0:e.unassociateElement)||t.call(e,this),e9(this,h,null),this.shadowRoot.removeEventListener("focusin",e8(this,f)),this.shadowRoot.removeEventListener("focusout",e8(this,p))}updatePointerBar(e){let t=this.range.getBoundingClientRect(),i=(e.clientX-t.left)/t.width;i=Math.max(0,Math.min(1,i));let{style:r}=(0,ee.R7)(this.shadowRoot,"#pointer");r.setProperty("width",`${i*t.width}px`)}updateBar(){let e=this.getBarColors(),t="linear-gradient(to right, ",i=0;e.forEach(e=>{e[1]<i||(t+=`${e[0]} ${i}%, ${e[0]} ${e[1]}%,`,i=e[1])}),t=t.slice(0,t.length-1)+")";let{style:r}=(0,ee.R7)(this.shadowRoot,"#range");r.setProperty("--media-range-track-progress-internal",t)}getRelativeValues(){let{range:e}=this;return{relativeValue:e.value-e.min,relativeMax:e.max-e.min}}getBarColors(){let e=this.range,{relativeValue:t,relativeMax:i}=this.getRelativeValues(),r=t/i*100,n=0;if(t&&t<i){let t=this.thumbWidth*(.5-r/100);n=t/e.offsetWidth*100}return[["var(--media-range-bar-color, var(--media-primary-color, rgb(238 238 238)))",r+n],["var(--media-range-track-color, transparent)",100]]}get keysUsed(){return["ArrowUp","ArrowRight","ArrowDown","ArrowLeft"]}}h=new WeakMap,f=new WeakMap,p=new WeakMap,Q.Mq.customElements.get("media-chrome-range")||Q.Mq.customElements.define("media-chrome-range",tr);var tn=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},ta=(e,t,i)=>(tn(e,t,"read from private field"),i?i.call(e):t.get(e)),ts=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},to=(e,t,i,r)=>(tn(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);let tl=Q.tj.createElement("template");tl.innerHTML=`
  <style>
    :host {
      
      box-sizing: border-box;
      display: var(--media-control-display, var(--media-control-bar-display, inline-flex));
      color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
      --media-loading-indicator-icon-height: 44px;
    }

    media-time-range,
    ::slotted(media-time-range),
    ::slotted(media-clip-selector) {
      flex-grow: 1;
    }

    media-time-range,
    ::slotted(media-time-range),
    ::slotted(media-clip-selector),
    media-volume-range,
    ::slotted(media-volume-range) {
      height: var(--_range-auto-size, calc(var(--media-control-height, 24px) + 2 * var(--_media-range-padding)));
    }
  </style>

  <slot></slot>
`;class tu extends Q.Mq.HTMLElement{constructor(){super(),ts(this,m,void 0),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(tl.content.cloneNode(!0))),this.shadowRoot.querySelector("slot").addEventListener("slotchange",({target:e})=>{let t=e.assignedElements({flatten:!0}).every(e=>["media-time-range","media-volume-range"].includes(e.nodeName.toLowerCase())),{style:i}=(0,ee.R7)(this.shadowRoot,":host");i.setProperty("--_range-auto-size",t?"unset":"initial")})}static get observedAttributes(){return[W.m0.MEDIA_CONTROLLER]}attributeChangedCallback(e,t,i){var r,n,a,s,o;e===W.m0.MEDIA_CONTROLLER&&(t&&(null==(n=null==(r=ta(this,m))?void 0:r.unassociateElement)||n.call(r,this),to(this,m,null)),i&&(to(this,m,null==(a=this.getRootNode())?void 0:a.getElementById(i)),null==(o=null==(s=ta(this,m))?void 0:s.associateElement)||o.call(s,this)))}connectedCallback(){var e,t,i;let r=this.getAttribute(W.m0.MEDIA_CONTROLLER);r&&(to(this,m,null==(e=this.getRootNode())?void 0:e.getElementById(r)),null==(i=null==(t=ta(this,m))?void 0:t.associateElement)||i.call(t,this))}disconnectedCallback(){var e,t;null==(t=null==(e=ta(this,m))?void 0:e.unassociateElement)||t.call(e,this),to(this,m,null)}}m=new WeakMap,Q.Mq.customElements.get("media-control-bar")||Q.Mq.customElements.define("media-control-bar",tu);var tc=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},td=(e,t,i)=>(tc(e,t,"read from private field"),i?i.call(e):t.get(e)),th=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},tf=(e,t,i,r)=>(tc(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);let tp=Q.tj.createElement("template");tp.innerHTML=`
  <style>
    :host {
      font: var(--media-font,
        var(--media-font-weight, normal)
        var(--media-font-size, 14px) /
        var(--media-text-content-height, var(--media-control-height, 24px))
        var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
      color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
      background: var(--media-text-background, var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7))));
      padding: var(--media-control-padding, 10px);
      display: inline-flex;
      justify-content: center;
      align-items: center;
      vertical-align: middle;
      box-sizing: border-box;
      text-align: center;
      pointer-events: auto;
    }

    
    :host(:focus-visible) {
      box-shadow: inset 0 0 0 2px rgb(27 127 204 / .9);
      outline: 0;
    }

    
    :host(:where(:focus)) {
      box-shadow: none;
      outline: 0;
    }
  </style>
  <slot></slot>
`;class tm extends Q.Mq.HTMLElement{constructor(){super(),th(this,g,void 0),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(tp.content.cloneNode(!0)));let{style:e}=(0,ee.R7)(this.shadowRoot,":host");e.setProperty("display",`var(--media-control-display, var(--${this.localName}-display, inline-flex))`)}static get observedAttributes(){return[W.m0.MEDIA_CONTROLLER]}attributeChangedCallback(e,t,i){var r,n,a,s,o;e===W.m0.MEDIA_CONTROLLER&&(t&&(null==(n=null==(r=td(this,g))?void 0:r.unassociateElement)||n.call(r,this),tf(this,g,null)),i&&(tf(this,g,null==(a=this.getRootNode())?void 0:a.getElementById(i)),null==(o=null==(s=td(this,g))?void 0:s.associateElement)||o.call(s,this)))}connectedCallback(){var e,t,i;let r=this.getAttribute(W.m0.MEDIA_CONTROLLER);r&&(tf(this,g,null==(e=this.getRootNode())?void 0:e.getElementById(r)),null==(i=null==(t=td(this,g))?void 0:t.associateElement)||i.call(t,this))}disconnectedCallback(){var e,t;null==(t=null==(e=td(this,g))?void 0:e.unassociateElement)||t.call(e,this),tf(this,g,null)}}g=new WeakMap,Q.Mq.customElements.get("media-text-display")||Q.Mq.customElements.define("media-text-display",tm);var tg=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},tv=(e,t,i)=>(tg(e,t,"read from private field"),i?i.call(e):t.get(e)),ty=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},tb=(e,t,i,r)=>(tg(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);v=new WeakMap,Q.Mq.customElements.get("media-duration-display")||Q.Mq.customElements.define("media-duration-display",class extends tm{constructor(){super(),ty(this,v,void 0),tb(this,v,this.shadowRoot.querySelector("slot")),tv(this,v).textContent=Z(0)}static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_DURATION]}attributeChangedCallback(e,t,i){e===W.MediaUIAttributes.MEDIA_DURATION&&(tv(this,v).textContent=Z(i)),super.attributeChangedCallback(e,t,i)}get mediaDuration(){return(0,ee.Uf)(this,W.MediaUIAttributes.MEDIA_DURATION)}set mediaDuration(e){(0,ee.Jv)(this,W.MediaUIAttributes.MEDIA_DURATION,e)}});var t_=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},tE=(e,t,i)=>(t_(e,t,"read from private field"),i?i.call(e):t.get(e)),tS=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},tx=(e,t,i,r)=>(t_(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);let tT={REMAINING:"remaining",SHOW_DURATION:"showduration",NO_TOGGLE:"notoggle"},tw=[...Object.values(tT),W.MediaUIAttributes.MEDIA_CURRENT_TIME,W.MediaUIAttributes.MEDIA_DURATION,W.MediaUIAttributes.MEDIA_SEEKABLE],tA=["Enter"," "],tM="&nbsp;/&nbsp;",tR=(e,{timesSep:t=tM}={})=>{var i,r,n,a;let s=e.hasAttribute(tT.REMAINING),o=e.hasAttribute(tT.SHOW_DURATION),l=null!=(i=e.mediaCurrentTime)?i:0,[,u]=null!=(r=e.mediaSeekable)?r:[],c=null!=(a=null!=(n=e.mediaDuration)?n:u)?a:0,d=s?Z(0-(c-l)):Z(l);return o?`${d}${t}${Z(c)}`:d},tC=e=>{var t;let i=e.mediaCurrentTime,[,r]=null!=(t=e.mediaSeekable)?t:[],n=e.mediaDuration||r;if(null==i||null==n){e.setAttribute("aria-valuetext","video not loaded, unknown time.");return}let a=e.hasAttribute(tT.REMAINING),s=e.hasAttribute(tT.SHOW_DURATION),o=a?X(0-(n-i)):X(i);if(!s){e.setAttribute("aria-valuetext",o);return}let l=X(n),u=`${o} of ${l}`;e.setAttribute("aria-valuetext",u)};y=new WeakMap,Q.Mq.customElements.get("media-time-display")||Q.Mq.customElements.define("media-time-display",class extends tm{constructor(){super(),tS(this,y,void 0),tx(this,y,this.shadowRoot.querySelector("slot")),tE(this,y).innerHTML=`${tR(this)}`;let{style:e}=(0,ee.R7)(this.shadowRoot,":host:not([notoggle])");e.setProperty("cursor","pointer");let{style:t}=(0,ee.R7)(this.shadowRoot,":host(:hover:not([notoggle]))");t.setProperty("background","var(--media-control-hover-background, rgba(50 50 70 / .7))")}static get observedAttributes(){return[...super.observedAttributes,...tw,"disabled"]}connectedCallback(){this.hasAttribute("disabled")||this.enable(),this.setAttribute("role","progressbar"),this.setAttribute("aria-label",$.zy.PLAYBACK_TIME());let e=t=>{let{key:i}=t;if(!tA.includes(i)){this.removeEventListener("keyup",e);return}this.toggleTimeDisplay()};this.addEventListener("keydown",t=>{let{metaKey:i,altKey:r,key:n}=t;if(i||r||!tA.includes(n)){this.removeEventListener("keyup",e);return}this.addEventListener("keyup",e)}),this.addEventListener("click",this.toggleTimeDisplay),super.connectedCallback()}toggleTimeDisplay(){this.noToggle||(this.hasAttribute("remaining")?this.removeAttribute("remaining"):this.setAttribute("remaining",""))}disconnectedCallback(){this.disable(),super.disconnectedCallback()}attributeChangedCallback(e,t,i){tw.includes(e)?this.update():"disabled"===e&&i!==t&&(null==i?this.enable():this.disable()),super.attributeChangedCallback(e,t,i)}enable(){this.tabIndex=0}disable(){this.tabIndex=-1}get remaining(){return(0,ee.zc)(this,tT.REMAINING)}set remaining(e){(0,ee.Pj)(this,tT.REMAINING,e)}get showDuration(){return(0,ee.zc)(this,tT.SHOW_DURATION)}set showDuration(e){(0,ee.Pj)(this,tT.SHOW_DURATION,e)}get noToggle(){return(0,ee.zc)(this,tT.NO_TOGGLE)}set noToggle(e){(0,ee.Pj)(this,tT.NO_TOGGLE,e)}get mediaDuration(){return(0,ee.Uf)(this,W.MediaUIAttributes.MEDIA_DURATION)}set mediaDuration(e){(0,ee.Jv)(this,W.MediaUIAttributes.MEDIA_DURATION,e)}get mediaCurrentTime(){return(0,ee.Uf)(this,W.MediaUIAttributes.MEDIA_CURRENT_TIME)}set mediaCurrentTime(e){(0,ee.Jv)(this,W.MediaUIAttributes.MEDIA_CURRENT_TIME,e)}get mediaSeekable(){let e=this.getAttribute(W.MediaUIAttributes.MEDIA_SEEKABLE);if(e)return e.split(":").map(e=>+e)}set mediaSeekable(e){if(null==e){this.removeAttribute(W.MediaUIAttributes.MEDIA_SEEKABLE);return}this.setAttribute(W.MediaUIAttributes.MEDIA_SEEKABLE,e.join(":"))}update(){let e=tR(this);tC(this),e!==tE(this,y).innerHTML&&(tE(this,y).innerHTML=e)}}),i(59468);let tI={SEEK_OFFSET:"seekoffset"},tL=Q.tj.createElement("template");tL.innerHTML=`
  <slot name="icon"><svg aria-hidden="true" viewBox="0 0 20 24"><defs><style>.text{font-size:8px;font-family:Arial-BoldMT, Arial;font-weight:700;}</style></defs><text class="text value" transform="translate(8.9 19.87)">30</text><path d="M10 6V3l5.61 4L10 10.94V8a5.54 5.54 0 0 0-1.9 10.48v2.12A7.5 7.5 0 0 1 10 6Z"/></svg></slot>
`;class tk extends J.Z{static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_CURRENT_TIME,tI.SEEK_OFFSET]}constructor(e={}){super({slotTemplate:tL,...e})}connectedCallback(){this.seekOffset=(0,ee.Uf)(this,tI.SEEK_OFFSET,30),super.connectedCallback()}attributeChangedCallback(e,t,i){e===tI.SEEK_OFFSET&&(this.seekOffset=(0,ee.Uf)(this,tI.SEEK_OFFSET,30)),super.attributeChangedCallback(e,t,i)}get seekOffset(){return(0,ee.Uf)(this,tI.SEEK_OFFSET,30)}set seekOffset(e){(0,ee.Jv)(this,tI.SEEK_OFFSET,e),this.setAttribute("aria-label",$.pg.SEEK_FORWARD_N_SECS({seekOffset:this.seekOffset})),(0,ee.wl)((0,ee.PV)(this,"icon"),this.seekOffset)}get mediaCurrentTime(){return(0,ee.Uf)(this,W.MediaUIAttributes.MEDIA_CURRENT_TIME,0)}set mediaCurrentTime(e){(0,ee.Jv)(this,W.MediaUIAttributes.MEDIA_CURRENT_TIME,e)}handleClick(){let e=this.mediaCurrentTime+this.seekOffset,t=new Q.Mq.CustomEvent(W.MediaUIEvents.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)}}Q.Mq.customElements.get("media-seek-forward-button")||Q.Mq.customElements.define("media-seek-forward-button",tk);let tD=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M16 3v2.5h3.5V9H22V3h-6ZM4 9h2.5V5.5H10V3H4v6Zm15.5 9.5H16V21h6v-6h-2.5v3.5ZM6.5 15H4v6h6v-2.5H6.5V15Z"/>
</svg>`,tP=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M18.5 6.5V3H16v6h6V6.5h-3.5ZM16 21h2.5v-3.5H22V15h-6v6ZM4 17.5h3.5V21H10v-6H4v2.5Zm3.5-11H4V9h6V3H7.5v3.5Z"/>
</svg>`,tO=Q.tj.createElement("template");tO.innerHTML=`
  <style>
  :host([${W.MediaUIAttributes.MEDIA_IS_FULLSCREEN}]) slot:not([name=exit]):not([name=icon]) {
    display: none !important;
  }

  
  :host(:not([${W.MediaUIAttributes.MEDIA_IS_FULLSCREEN}])) slot:not([name=enter]):not([name=icon]) {
    display: none !important;
  }
  </style>

  <slot name="icon">
    <slot name="enter">${tD}</slot>
    <slot name="exit">${tP}</slot>
  </slot>
`;let tN=e=>{let t=e.mediaIsFullscreen?$.pg.EXIT_FULLSCREEN():$.pg.ENTER_FULLSCREEN();e.setAttribute("aria-label",t)};class tU extends J.Z{static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_IS_FULLSCREEN,W.MediaUIAttributes.MEDIA_FULLSCREEN_UNAVAILABLE]}constructor(e={}){super({slotTemplate:tO,...e})}connectedCallback(){tN(this),super.connectedCallback()}attributeChangedCallback(e,t,i){e===W.MediaUIAttributes.MEDIA_IS_FULLSCREEN&&tN(this),super.attributeChangedCallback(e,t,i)}get mediaFullscreenUnavailable(){return(0,ee.ST)(this,W.MediaUIAttributes.MEDIA_FULLSCREEN_UNAVAILABLE)}set mediaFullscreenUnavailable(e){(0,ee.Lb)(this,W.MediaUIAttributes.MEDIA_FULLSCREEN_UNAVAILABLE,e)}get mediaIsFullscreen(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_IS_FULLSCREEN)}set mediaIsFullscreen(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_IS_FULLSCREEN,e)}handleClick(){let e=this.mediaIsFullscreen?W.MediaUIEvents.MEDIA_EXIT_FULLSCREEN_REQUEST:W.MediaUIEvents.MEDIA_ENTER_FULLSCREEN_REQUEST;this.dispatchEvent(new Q.Mq.CustomEvent(e,{composed:!0,bubbles:!0}))}}Q.Mq.customElements.get("media-fullscreen-button")||Q.Mq.customElements.define("media-fullscreen-button",tU);let{MEDIA_TIME_IS_LIVE:tF,MEDIA_PAUSED:tB}=W.MediaUIAttributes,{MEDIA_SEEK_TO_LIVE_REQUEST:tV,MEDIA_PLAY_REQUEST:tz}=W.MediaUIEvents,tj=Q.tj.createElement("template");tj.innerHTML=`
  <style>

  slot[name=indicator] > *,
  :host ::slotted([slot=indicator]) {
    
    min-width: auto;
    fill: var(--media-live-button-icon-color, rgb(140, 140, 140));
    color: var(--media-live-button-icon-color, rgb(140, 140, 140));
  }

  :host([${tF}]:not([${tB}])) slot[name=indicator] > *,
  :host([${tF}]:not([${tB}])) ::slotted([slot=indicator]) {
    fill: var(--media-live-button-indicator-color, rgb(255, 0, 0));
    color: var(--media-live-button-indicator-color, rgb(255, 0, 0));
  }

  :host([${tF}]:not([${tB}])) {
    cursor: not-allowed;
  }

  </style>

  <slot name="indicator"><svg viewBox="0 0 6 12"><circle cx="3" cy="6" r="2"></circle></svg></slot>
  
  <slot name="spacer">&nbsp;</slot><slot name="text">LIVE</slot>
`;let tH=e=>{let t=e.mediaPaused||!e.mediaTimeIsLive,i=t?$.pg.SEEK_LIVE():$.pg.PLAYING_LIVE();e.setAttribute("aria-label",i),t?e.removeAttribute("aria-disabled"):e.setAttribute("aria-disabled","true")};class tG extends J.Z{static get observedAttributes(){return[...super.observedAttributes,tB,tF]}constructor(e={}){super({slotTemplate:tj,...e})}connectedCallback(){tH(this),super.connectedCallback()}attributeChangedCallback(e,t,i){super.attributeChangedCallback(e,t,i),tH(this)}get mediaPaused(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_PAUSED)}set mediaPaused(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_PAUSED,e)}get mediaTimeIsLive(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_TIME_IS_LIVE)}set mediaTimeIsLive(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_TIME_IS_LIVE,e)}handleClick(){(this.mediaPaused||!this.mediaTimeIsLive)&&(this.dispatchEvent(new Q.Mq.CustomEvent(tV,{composed:!0,bubbles:!0})),this.hasAttribute(tB)&&this.dispatchEvent(new Q.Mq.CustomEvent(tz,{composed:!0,bubbles:!0})))}}Q.Mq.customElements.get("media-live-button")||Q.Mq.customElements.define("media-live-button",tG);let{MEDIA_VOLUME_LEVEL:tW}=W.MediaUIAttributes,t$=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M16.5 12A4.5 4.5 0 0 0 14 8v2.18l2.45 2.45a4.22 4.22 0 0 0 .05-.63Zm2.5 0a6.84 6.84 0 0 1-.54 2.64L20 16.15A8.8 8.8 0 0 0 21 12a9 9 0 0 0-7-8.77v2.06A7 7 0 0 1 19 12ZM4.27 3 3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25A6.92 6.92 0 0 1 14 18.7v2.06A9 9 0 0 0 17.69 19l2 2.05L21 19.73l-9-9L4.27 3ZM12 4 9.91 6.09 12 8.18V4Z"/>
</svg>`,tq=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M3 9v6h4l5 5V4L7 9H3Zm13.5 3A4.5 4.5 0 0 0 14 8v8a4.47 4.47 0 0 0 2.5-4Z"/>
</svg>`,tY=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M3 9v6h4l5 5V4L7 9H3Zm13.5 3A4.5 4.5 0 0 0 14 8v8a4.47 4.47 0 0 0 2.5-4ZM14 3.23v2.06a7 7 0 0 1 0 13.42v2.06a9 9 0 0 0 0-17.54Z"/>
</svg>`,tK=Q.tj.createElement("template");tK.innerHTML=`
  <style>
  
  :host(:not([${tW}])) slot:not([name=high]):not([name=icon]), 
  :host([${tW}=high]) slot:not([name=high]):not([name=icon]) {
    display: none !important;
  }

  :host([${tW}=off]) slot:not([name=off]):not([name=icon]) {
    display: none !important;
  }

  :host([${tW}=low]) slot:not([name=low]):not([name=icon]) {
    display: none !important;
  }

  :host([${tW}=medium]) slot:not([name=medium]):not([name=icon]) {
    display: none !important;
  }
  </style>

  <slot name="icon">
    <slot name="off">${t$}</slot>
    <slot name="low">${tq}</slot>
    <slot name="medium">${tq}</slot>
    <slot name="high">${tY}</slot>
  </slot>
`;let tX=e=>{let t="off"===e.mediaVolumeLevel,i=t?$.pg.UNMUTE():$.pg.MUTE();e.setAttribute("aria-label",i)};class tZ extends J.Z{static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_VOLUME_LEVEL]}constructor(e={}){super({slotTemplate:tK,...e})}connectedCallback(){tX(this),super.connectedCallback()}attributeChangedCallback(e,t,i){e===W.MediaUIAttributes.MEDIA_VOLUME_LEVEL&&tX(this),super.attributeChangedCallback(e,t,i)}get mediaVolumeLevel(){return(0,ee.ST)(this,W.MediaUIAttributes.MEDIA_VOLUME_LEVEL)}set mediaVolumeLevel(e){(0,ee.Lb)(this,W.MediaUIAttributes.MEDIA_VOLUME_LEVEL,e)}handleClick(){let e="off"===this.mediaVolumeLevel?W.MediaUIEvents.MEDIA_UNMUTE_REQUEST:W.MediaUIEvents.MEDIA_MUTE_REQUEST;this.dispatchEvent(new Q.Mq.CustomEvent(e,{composed:!0,bubbles:!0}))}}Q.Mq.customElements.get("media-mute-button")||Q.Mq.customElements.define("media-mute-button",tZ);let tJ=`<svg aria-hidden="true" viewBox="0 0 28 24">
  <path d="M24 3H4a1 1 0 0 0-1 1v16a1 1 0 0 0 1 1h20a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1Zm-1 16H5V5h18v14Zm-3-8h-7v5h7v-5Z"/>
</svg>`,tQ=Q.tj.createElement("template");tQ.innerHTML=`
  <style>
  :host([${W.MediaUIAttributes.MEDIA_IS_PIP}]) slot:not([name=exit]):not([name=icon]) {
    display: none !important;
  }

  
  :host(:not([${W.MediaUIAttributes.MEDIA_IS_PIP}])) slot:not([name=enter]):not([name=icon]) {
    display: none !important;
  }
  </style>

  <slot name="icon">
    <slot name="enter">${tJ}</slot>
    <slot name="exit">${tJ}</slot>
  </slot>
`;let t0=e=>{let t=e.mediaIsPip?$.pg.EXIT_PIP():$.pg.ENTER_PIP();e.setAttribute("aria-label",t)};class t1 extends J.Z{static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_IS_PIP,W.MediaUIAttributes.MEDIA_PIP_UNAVAILABLE]}constructor(e={}){super({slotTemplate:tQ,...e})}connectedCallback(){t0(this),super.connectedCallback()}attributeChangedCallback(e,t,i){e===W.MediaUIAttributes.MEDIA_IS_PIP&&t0(this),super.attributeChangedCallback(e,t,i)}get mediaPipUnavailable(){return(0,ee.ST)(this,W.MediaUIAttributes.MEDIA_PIP_UNAVAILABLE)}set mediaPipUnavailable(e){(0,ee.Lb)(this,W.MediaUIAttributes.MEDIA_PIP_UNAVAILABLE,e)}get mediaIsPip(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_IS_PIP)}set mediaIsPip(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_IS_PIP,e)}handleClick(){let e=this.mediaIsPip?W.MediaUIEvents.MEDIA_EXIT_PIP_REQUEST:W.MediaUIEvents.MEDIA_ENTER_PIP_REQUEST;this.dispatchEvent(new Q.Mq.CustomEvent(e,{composed:!0,bubbles:!0}))}}Q.Mq.customElements.get("media-pip-button")||Q.Mq.customElements.define("media-pip-button",t1);let t2=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="m6 21 15-9L6 3v18Z"/>
</svg>`,t3=`<svg aria-hidden="true" viewBox="0 0 24 24">
  <path d="M6 20h4V4H6v16Zm8-16v16h4V4h-4Z"/>
</svg>`,t5=Q.tj.createElement("template");t5.innerHTML=`
  <style>
  :host([${W.MediaUIAttributes.MEDIA_PAUSED}]) slot[name=pause] {
    display: none !important;
  }

  :host(:not([${W.MediaUIAttributes.MEDIA_PAUSED}])) slot[name=play] {
    display: none !important;
  }
  </style>

  <slot name="icon">
    <slot name="play">${t2}</slot>
    <slot name="pause">${t3}</slot>
  </slot>
`;let t4=e=>{let t=e.mediaPaused?$.pg.PLAY():$.pg.PAUSE();e.setAttribute("aria-label",t)};class t6 extends J.Z{static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_PAUSED,W.MediaUIAttributes.MEDIA_ENDED]}constructor(e={}){super({slotTemplate:t5,...e})}connectedCallback(){t4(this),super.connectedCallback()}attributeChangedCallback(e,t,i){e===W.MediaUIAttributes.MEDIA_PAUSED&&t4(this),super.attributeChangedCallback(e,t,i)}get mediaPaused(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_PAUSED)}set mediaPaused(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_PAUSED,e)}handleClick(){let e=this.mediaPaused?W.MediaUIEvents.MEDIA_PLAY_REQUEST:W.MediaUIEvents.MEDIA_PAUSE_REQUEST;this.dispatchEvent(new Q.Mq.CustomEvent(e,{composed:!0,bubbles:!0}))}}Q.Mq.customElements.get("media-play-button")||Q.Mq.customElements.define("media-play-button",t6),i(85076);let t8={PLACEHOLDER_SRC:"placeholdersrc",SRC:"src"},t7=Q.tj.createElement("template");t7.innerHTML=`
  <style>
    :host {
      pointer-events: none;
      display: var(--media-poster-image-display, inline-block);
      box-sizing: border-box;
    }

    img {
      max-width: 100%;
      max-height: 100%;
      min-width: 100%;
      min-height: 100%;
      background-repeat: no-repeat;
      background-position: var(--media-poster-image-background-position, var(--media-object-position, center));
      background-size: var(--media-poster-image-background-size, var(--media-object-fit, contain));
      object-fit: var(--media-object-fit, contain);
      object-position: var(--media-object-position, center);
    }
  </style>

  <img part="poster img" aria-hidden="true" id="image"/>
`;let t9=e=>{e.style.removeProperty("background-image")},ie=(e,t)=>{e.style["background-image"]=`url('${t}')`};class it extends Q.Mq.HTMLElement{static get observedAttributes(){return[t8.PLACEHOLDER_SRC,t8.SRC]}constructor(){super(),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(t7.content.cloneNode(!0))),this.image=this.shadowRoot.querySelector("#image")}attributeChangedCallback(e,t,i){e===t8.SRC&&(null==i?this.image.removeAttribute(t8.SRC):this.image.setAttribute(t8.SRC,i)),e===t8.PLACEHOLDER_SRC&&(null==i?t9(this.image):ie(this.image,i))}get placeholderSrc(){return(0,ee.ST)(this,t8.PLACEHOLDER_SRC)}set placeholderSrc(e){(0,ee.Lb)(this,t8.SRC,e)}get src(){return(0,ee.ST)(this,t8.SRC)}set src(e){(0,ee.Lb)(this,t8.SRC,e)}}Q.Mq.customElements.get("media-poster-image")||Q.Mq.customElements.define("media-poster-image",it);let ii={SEEK_OFFSET:"seekoffset"},ir=Q.tj.createElement("template");ir.innerHTML=`
  <slot name="icon"><svg aria-hidden="true" viewBox="0 0 20 24"><defs><style>.text{font-size:8px;font-family:Arial-BoldMT, Arial;font-weight:700;}</style></defs><text class="text value" transform="translate(2.18 19.87)">30</text><path d="M10 6V3L4.37 7 10 10.94V8a5.54 5.54 0 0 1 1.9 10.48v2.12A7.5 7.5 0 0 0 10 6Z"/></svg></slot>
`;class ia extends J.Z{static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_CURRENT_TIME,ii.SEEK_OFFSET]}constructor(e={}){super({slotTemplate:ir,...e})}connectedCallback(){this.seekOffset=(0,ee.Uf)(this,ii.SEEK_OFFSET,30),super.connectedCallback()}attributeChangedCallback(e,t,i){e===ii.SEEK_OFFSET&&(this.seekOffset=(0,ee.Uf)(this,ii.SEEK_OFFSET,30)),super.attributeChangedCallback(e,t,i)}get seekOffset(){return(0,ee.Uf)(this,ii.SEEK_OFFSET,30)}set seekOffset(e){(0,ee.Jv)(this,ii.SEEK_OFFSET,e),this.setAttribute("aria-label",$.pg.SEEK_BACK_N_SECS({seekOffset:this.seekOffset})),(0,ee.wl)((0,ee.PV)(this,"icon"),this.seekOffset)}get mediaCurrentTime(){return(0,ee.Uf)(this,W.MediaUIAttributes.MEDIA_CURRENT_TIME,0)}set mediaCurrentTime(e){(0,ee.Jv)(this,W.MediaUIAttributes.MEDIA_CURRENT_TIME,e)}handleClick(){let e=Math.max(this.mediaCurrentTime-this.seekOffset,0),t=new Q.Mq.CustomEvent(W.MediaUIEvents.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)}}Q.Mq.customElements.get("media-seek-backward-button")||Q.Mq.customElements.define("media-seek-backward-button",ia);var is=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},io=(e,t,i)=>(is(e,t,"read from private field"),i?i.call(e):t.get(e)),il=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},iu=(e,t,i,r)=>(is(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);b=new WeakMap,Q.Mq.customElements.get("media-preview-time-display")||Q.Mq.customElements.define("media-preview-time-display",class extends tm{constructor(){super(),il(this,b,void 0),iu(this,b,this.shadowRoot.querySelector("slot")),io(this,b).textContent=Z(0)}static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_PREVIEW_TIME]}attributeChangedCallback(e,t,i){e===W.MediaUIAttributes.MEDIA_PREVIEW_TIME&&null!=i&&(io(this,b).textContent=Z(i)),super.attributeChangedCallback(e,t,i)}get mediaPreviewTime(){return(0,ee.Uf)(this,W.MediaUIAttributes.MEDIA_PREVIEW_TIME)}set mediaPreviewTime(e){(0,ee.Jv)(this,W.MediaUIAttributes.MEDIA_PREVIEW_TIME,e)}});var ic=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},id=(e,t,i)=>(ic(e,t,"read from private field"),i?i.call(e):t.get(e)),ih=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},ip=(e,t,i,r)=>(ic(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);let im=Q.tj.createElement("template");im.innerHTML=`
  <style>
    :host {
      box-sizing: border-box;
      display: var(--media-control-display, var(--media-preview-thumbnail-display, inline-block));
      overflow: hidden;
    }

    img {
      display: none;
      position: relative;
    }
  </style>
  <img crossorigin loading="eager" decoding="async">
`;class ig extends Q.Mq.HTMLElement{constructor(){super(),ih(this,_,void 0),this.shadowRoot||(this.attachShadow({mode:"open"}),this.shadowRoot.appendChild(im.content.cloneNode(!0)))}static get observedAttributes(){return[W.m0.MEDIA_CONTROLLER,W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE,W.MediaUIAttributes.MEDIA_PREVIEW_COORDS]}connectedCallback(){var e,t,i;let r=this.getAttribute(W.m0.MEDIA_CONTROLLER);r&&(ip(this,_,null==(e=this.getRootNode())?void 0:e.getElementById(r)),null==(i=null==(t=id(this,_))?void 0:t.associateElement)||i.call(t,this))}disconnectedCallback(){var e,t;null==(t=null==(e=id(this,_))?void 0:e.unassociateElement)||t.call(e,this),ip(this,_,null)}attributeChangedCallback(e,t,i){var r,n,a,s,o;[W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE,W.MediaUIAttributes.MEDIA_PREVIEW_COORDS].includes(e)&&this.update(),e===W.m0.MEDIA_CONTROLLER&&(t&&(null==(n=null==(r=id(this,_))?void 0:r.unassociateElement)||n.call(r,this),ip(this,_,null)),i&&(ip(this,_,null==(a=this.getRootNode())?void 0:a.getElementById(i)),null==(o=null==(s=id(this,_))?void 0:s.associateElement)||o.call(s,this)))}get mediaPreviewImage(){return(0,ee.ST)(this,W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE)}set mediaPreviewImage(e){(0,ee.Lb)(this,W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE,e)}get mediaPreviewCoords(){let e=this.getAttribute(W.MediaUIAttributes.MEDIA_PREVIEW_COORDS);if(e)return e.split(/\s+/).map(e=>+e)}set mediaPreviewCoords(e){if(!e){this.removeAttribute(W.MediaUIAttributes.MEDIA_PREVIEW_COORDS);return}this.setAttribute(W.MediaUIAttributes.MEDIA_PREVIEW_COORDS,e.join(" "))}update(){let e=this.mediaPreviewCoords,t=this.mediaPreviewImage;if(!(e&&t))return;let[i,r,n,a]=e,s=t.split("#")[0],o=getComputedStyle(this),{maxWidth:l,maxHeight:u,minWidth:c,minHeight:d}=o,h=Math.min(parseInt(l)/n,parseInt(u)/a),f=Math.max(parseInt(c)/n,parseInt(d)/a),p=h<1,m=p?h:f>1?f:1,{style:g}=(0,ee.R7)(this.shadowRoot,":host"),v=(0,ee.R7)(this.shadowRoot,"img").style,y=this.shadowRoot.querySelector("img"),b=p?"min":"max";g.setProperty(`${b}-width`,"initial","important"),g.setProperty(`${b}-height`,"initial","important"),g.width=`${n*m}px`,g.height=`${a*m}px`;let _=()=>{v.width=`${this.imgWidth*m}px`,v.height=`${this.imgHeight*m}px`,v.display="block"};y.src!==s&&(y.onload=()=>{this.imgWidth=y.naturalWidth,this.imgHeight=y.naturalHeight,_()},y.src=s,_()),_(),v.transform=`translate(-${i*m}px, -${r*m}px)`}}_=new WeakMap,Q.Mq.customElements.get("media-preview-thumbnail")||Q.Mq.customElements.define("media-preview-thumbnail",ig);var iv=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},iy=(e,t,i)=>(iv(e,t,"read from private field"),i?i.call(e):t.get(e)),ib=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},i_=(e,t,i,r)=>(iv(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),iE=(e,t,i)=>(iv(e,t,"access private method"),i);let iS=e=>{let t=e.range,i=X(+t.value),r=X(+t.max),n=i&&r?`${i} of ${r}`:"video not loaded, unknown time.";t.setAttribute("aria-valuetext",n)},ix=Q.tj.createElement("template");ix.innerHTML=`
  <style>
    :host {
      --media-preview-border-radius: 3px;
      --media-box-padding-left: 10px;
      --media-box-padding-right: 10px;
    }

    #preview-rail,
    #current-rail {
      
      width: 1%;
      position: absolute;
      left: 0;
      bottom: 100%;
      pointer-events: none;
    }

    [part~="box"] {
      
      position: absolute;
      bottom: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      transform: translateX(-50%);
    }

    [part~="preview-box"] {
      transition-property: var(--media-preview-transition-property, visibility, opacity);
      transition-duration: var(--media-preview-transition-duration-out, .25s);
      transition-delay: var(--media-preview-transition-delay-out, 0s);
      visibility: hidden;
      opacity: 0;
    }

    :host([${W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE}]:hover) [part~="preview-box"],
    :host([${W.MediaUIAttributes.MEDIA_PREVIEW_TIME}]:hover) [part~="preview-box"] {
      transition-duration: var(--media-preview-transition-duration-in, .5s);
      transition-delay: var(--media-preview-transition-delay-in, .25s);
      visibility: visible;
      opacity: 1;
    }

    media-preview-thumbnail,
    ::slotted(media-preview-thumbnail) {
      visibility: hidden;
      
      transition: visibility 0s .25s;
      transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));
      background: var(--media-preview-thumbnail-background, var(--media-preview-background, var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)))));
      box-shadow: var(--media-preview-thumbnail-box-shadow, 0 0 4px rgb(0 0 0 / .2));
      max-width: var(--media-preview-thumbnail-max-width, 180px);
      max-height: var(--media-preview-thumbnail-max-height, 160px);
      min-width: var(--media-preview-thumbnail-min-width, 120px);
      min-height: var(--media-preview-thumbnail-min-height, 80px);
      border: var(--media-preview-thumbnail-border);
      border-radius: var(--media-preview-thumbnail-border-radius,
        var(--media-preview-border-radius) var(--media-preview-border-radius) 0 0);
    }

    :host([${W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE}]:hover) media-preview-thumbnail,
    :host([${W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE}]:hover) ::slotted(media-preview-thumbnail) {
      transition-delay: var(--media-preview-transition-delay-in, .25s);
      visibility: visible;
    }

    media-preview-time-display,
    ::slotted(media-preview-time-display) {
      min-width: 0;
      
      transition: min-width 0s, border-radius 0s;
      transition-delay: calc(var(--media-preview-transition-delay-out, 0s) + var(--media-preview-transition-duration-out, .25s));
      background: var(--media-preview-time-background, var(--media-preview-background, var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)))));
      border-radius: var(--media-preview-time-border-radius,
        var(--media-preview-border-radius) var(--media-preview-border-radius)
        var(--media-preview-border-radius) var(--media-preview-border-radius));
      padding: var(--media-preview-time-padding, 1px 10px 0);
      margin: var(--media-preview-time-margin, 0 0 10px);
      text-shadow: var(--media-preview-time-text-shadow, 0 0 4px rgb(0 0 0 / .75));
    }

    :host([${W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE}]) media-preview-time-display,
    :host([${W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE}]) ::slotted(media-preview-time-display) {
      transition-delay: var(--media-preview-transition-delay-in, .25s);
      min-width: 100%;
      border-radius: var(--media-preview-time-border-radius,
        0 0 var(--media-preview-border-radius) var(--media-preview-border-radius));
    }

    :host([${W.MediaUIAttributes.MEDIA_PREVIEW_TIME}]:hover) {
      --media-time-range-hover-display: block;
    }
  </style>
  <div id="preview-rail">
    <slot name="preview" part="box preview-box">
      <media-preview-thumbnail></media-preview-thumbnail>
      <media-preview-time-display></media-preview-time-display>
    </slot>
  </div>
  <div id="current-rail">
    <slot name="current" part="box current-box">
      
    </slot>
  </div>
`,E=new WeakMap,S=new WeakMap,x=new WeakMap,T=new WeakMap,w=new WeakMap,A=new WeakSet,M=function(){var e;let[,t]=null!=(e=this.mediaSeekable)?e:[];return t},R=new WeakSet,C=function(){var e;let[t]=null!=(e=this.mediaSeekable)?e:[];return t},I=new WeakSet,L=function(e,t){var i;let r=`${1e4*t}%`,n=e.offsetWidth;if(!n)return r;let a=null!=(i=this.getAttribute("bounds")?(0,ee.l5)(this,`#${this.getAttribute("bounds")}`):this.parentElement)?i:this,s=this.range.getBoundingClientRect(),o=a.getBoundingClientRect(),l=(iy(this,T)-(s.left-o.left-n/2))/s.width*100,u=(o.right-s.left-n/2-iy(this,w))/s.width*100;return Number.isNaN(l)||(r=`max(${100*l}%, ${r})`),Number.isNaN(u)||(r=`min(${r}, ${100*u}%)`),r},k=new WeakMap,D=new WeakMap,P=new WeakMap,O=new WeakMap,N=new WeakMap,U=new WeakMap,F=new WeakSet,B=function(){this.addEventListener("pointermove",iy(this,U),!1)},V=new WeakSet,z=function(){var e;null==(e=Q.Mq.window)||e.removeEventListener("pointermove",iy(this,P)),this.removeEventListener("pointermove",iy(this,U)),i_(this,D,!1),iy(this,N).call(this)},Q.Mq.customElements.get("media-time-range")||Q.Mq.customElements.define("media-time-range",class extends tr{constructor(){super(),ib(this,A),ib(this,R),ib(this,I),ib(this,F),ib(this,V),ib(this,E,void 0),ib(this,S,void 0),ib(this,x,void 0),ib(this,T,void 0),ib(this,w,void 0),ib(this,k,e=>{if([...iy(this,E)].some(t=>e.composedPath().includes(t)))return;this.updatePointerBar(e);let t=this.mediaDuration;if(!t)return;let i=this.range.getBoundingClientRect(),r=(e.clientX-i.left-this.thumbWidth/2)/(i.width-this.thumbWidth);r=Math.max(0,Math.min(1,r));let n=iE(this,I,L).call(this,iy(this,S),r),{style:a}=(0,ee.R7)(this.shadowRoot,"#preview-rail");a.transform=`translateX(${n})`;let s=r*t,o=new Q.Mq.CustomEvent(W.MediaUIEvents.MEDIA_PREVIEW_REQUEST,{composed:!0,bubbles:!0,detail:s});this.dispatchEvent(o)}),ib(this,D,!1),ib(this,P,e=>{var t;(!e.composedPath().includes(this)||[...iy(this,E)].some(t=>e.composedPath().includes(t)))&&(null==(t=Q.Mq.window)||t.removeEventListener("pointermove",iy(this,P)),i_(this,D,!1),iy(this,N).call(this))}),ib(this,O,()=>{var e;null==(e=Q.Mq.window)||e.addEventListener("pointermove",iy(this,k),!1)}),ib(this,N,()=>{var e;null==(e=Q.Mq.window)||e.removeEventListener("pointermove",iy(this,k));let t=new Q.Mq.CustomEvent(W.MediaUIEvents.MEDIA_PREVIEW_REQUEST,{composed:!0,bubbles:!0,detail:null});this.dispatchEvent(t)}),ib(this,U,()=>{var e;let t=this.getAttribute(W.MediaUIAttributes.MEDIA_DURATION);!iy(this,D)&&t&&(i_(this,D,!0),iy(this,O).call(this),null==(e=Q.Mq.window)||e.addEventListener("pointermove",iy(this,P),!1))}),this.container.appendChild(ix.content.cloneNode(!0)),this.range.addEventListener("input",()=>{cancelAnimationFrame(this._refreshId);let e=this.range.value,t=new Q.Mq.CustomEvent(W.MediaUIEvents.MEDIA_SEEK_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)}),this._refreshBar=()=>{let e=(performance.now()-this._updateTimestamp)/1e3;this.range.value=this.mediaCurrentTime+e*this.mediaPlaybackRate,this.updateBar(),this.updateCurrentBox(),this._refreshId=requestAnimationFrame(this._refreshBar)},i_(this,E,this.shadowRoot.querySelectorAll('[part~="box"]')),i_(this,S,this.shadowRoot.querySelector('[part~="preview-box"]')),i_(this,x,this.shadowRoot.querySelector('[part~="current-box"]'));let e=getComputedStyle(this);i_(this,T,parseInt(e.getPropertyValue("--media-box-padding-left"))),i_(this,w,parseInt(e.getPropertyValue("--media-box-padding-right"))),iE(this,F,B).call(this)}static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_PAUSED,W.MediaUIAttributes.MEDIA_DURATION,W.MediaUIAttributes.MEDIA_SEEKABLE,W.MediaUIAttributes.MEDIA_CURRENT_TIME,W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE,W.MediaUIAttributes.MEDIA_PREVIEW_TIME,W.MediaUIAttributes.MEDIA_BUFFERED,W.MediaUIAttributes.MEDIA_PLAYBACK_RATE,W.MediaUIAttributes.MEDIA_LOADING,W.MediaUIAttributes.MEDIA_ENDED]}connectedCallback(){this.range.setAttribute("aria-label",$.zy.SEEK()),super.connectedCallback()}disconnectedCallback(){cancelAnimationFrame(this._refreshId),super.disconnectedCallback()}attributeChangedCallback(e,t,i){var r,n,a,s,o;e!==W.MediaUIAttributes.MEDIA_CURRENT_TIME&&e!==W.MediaUIAttributes.MEDIA_PAUSED&&e!==W.MediaUIAttributes.MEDIA_ENDED&&e!==W.MediaUIAttributes.MEDIA_LOADING||(this._updateTimestamp=performance.now(),this.range.value=this.mediaCurrentTime,iS(this),this.updateBar(),this.updateCurrentBox(),cancelAnimationFrame(this._refreshId),this.mediaPaused||this.mediaLoading||(this._refreshId=requestAnimationFrame(this._refreshBar))),e===W.MediaUIAttributes.MEDIA_DURATION&&(this.range.max=null!=(n=null!=(r=iy(this,A,M))?r:this.mediaDuration)?n:1e3,iS(this),this.updateBar(),this.updateCurrentBox()),e===W.MediaUIAttributes.MEDIA_SEEKABLE&&(this.range.min=null!=(a=iy(this,R,C))?a:0,this.range.max=null!=(o=null!=(s=iy(this,A,M))?s:this.mediaDuration)?o:1e3,iS(this),this.updateBar()),e===W.MediaUIAttributes.MEDIA_BUFFERED&&this.updateBar(),"disabled"===e&&(null==i?iE(this,F,B).call(this):iE(this,V,z).call(this)),super.attributeChangedCallback(e,t,i)}get mediaPaused(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_PAUSED)}set mediaPaused(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_PAUSED,e)}get mediaLoading(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_LOADING)}set mediaLoading(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_LOADING,e)}get mediaDuration(){return(0,ee.Uf)(this,W.MediaUIAttributes.MEDIA_DURATION)}set mediaDuration(e){(0,ee.Jv)(this,W.MediaUIAttributes.MEDIA_DURATION,e)}get mediaCurrentTime(){return(0,ee.Uf)(this,W.MediaUIAttributes.MEDIA_CURRENT_TIME)}set mediaCurrentTime(e){(0,ee.Jv)(this,W.MediaUIAttributes.MEDIA_CURRENT_TIME,e)}get mediaPlaybackRate(){return(0,ee.Uf)(this,W.MediaUIAttributes.MEDIA_PLAYBACK_RATE,1)}set mediaPlaybackRate(e){(0,ee.Jv)(this,W.MediaUIAttributes.MEDIA_PLAYBACK_RATE,e)}get mediaBuffered(){let e=this.getAttribute(W.MediaUIAttributes.MEDIA_BUFFERED);return e?e.split(" ").map(e=>e.split(":").map(e=>+e)):[]}set mediaBuffered(e){if(!e){this.removeAttribute(W.MediaUIAttributes.MEDIA_BUFFERED);return}let t=e.map(e=>e.join(":")).join(" ");this.setAttribute(W.MediaUIAttributes.MEDIA_BUFFERED,t)}get mediaSeekable(){let e=this.getAttribute(W.MediaUIAttributes.MEDIA_SEEKABLE);if(e)return e.split(":").map(e=>+e)}set mediaSeekable(e){if(null==e){this.removeAttribute(W.MediaUIAttributes.MEDIA_SEEKABLE);return}this.setAttribute(W.MediaUIAttributes.MEDIA_SEEKABLE,e.join(":"))}get mediaPreviewImage(){return(0,ee.ST)(this,W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE)}set mediaPreviewImage(e){(0,ee.Lb)(this,W.MediaUIAttributes.MEDIA_PREVIEW_IMAGE,e)}get mediaPreviewTime(){return(0,ee.Uf)(this,W.MediaUIAttributes.MEDIA_PREVIEW_TIME)}set mediaPreviewTime(e){(0,ee.Jv)(this,W.MediaUIAttributes.MEDIA_PREVIEW_TIME,e)}get mediaEnded(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_ENDED)}set mediaEnded(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_ENDED,e)}getRelativeValues(){let e=super.getRelativeValues();return this.mediaEnded?{...e,relativeValue:e.relativeMax}:e}getBarColors(){var e;let t;let i=super.getBarColors(),{range:r}=this,n=r.max-r.min,a=this.mediaBuffered;if(!a.length||!Number.isFinite(n)||n<=0)return i;if(this.mediaEnded)t=n;else{let i=this.mediaCurrentTime,[,n=r.min]=null!=(e=a.find(([e,t])=>e<=i&&i<=t))?e:[];t=n-r.min}let s=t/n*100;return i.splice(1,0,["var(--media-time-range-buffered-color, rgb(255 255 255 / .4))",s]),i}updateCurrentBox(){if(!iy(this,x).assignedElements().length)return;let e=this.range.value/(this.range.max-this.range.min),t=iE(this,I,L).call(this,iy(this,x),e),{style:i}=(0,ee.R7)(this.shadowRoot,"#current-rail");i.transform=`translateX(${t})`}});var iT=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},iw=(e,t,i)=>(iT(e,t,"read from private field"),i?i.call(e):t.get(e)),iA=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},iM=(e,t,i,r)=>(iT(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);let iR={LOADING_DELAY:"loadingdelay"},iC=Q.tj.createElement("template"),iI=`
<svg aria-hidden="true" viewBox="0 0 100 100">
  <path d="M73,50c0-12.7-10.3-23-23-23S27,37.3,27,50 M30.9,50c0-10.5,8.5-19.1,19.1-19.1S69.1,39.5,69.1,50">
    <animateTransform
       attributeName="transform"
       attributeType="XML"
       type="rotate"
       dur="1s"
       from="0 50 50"
       to="360 50 50"
       repeatCount="indefinite" />
  </path>
</svg>
`;iC.innerHTML=`
<style>
:host {
  display: var(--media-control-display, var(--media-loading-indicator-display, inline-block));
  vertical-align: middle;
  box-sizing: border-box;
  --_loading-indicator-delay: var(--media-loading-indicator-transition-delay, 500ms);
}

#status {
  color: rgba(0,0,0,0);
  width: 0px;
  height: 0px;
}

:host slot[name=icon] > *,
:host ::slotted([slot=icon]) {
  opacity: var(--media-loading-indicator-opacity, 0);
  transition: opacity 0.15s;
}

:host([${W.MediaUIAttributes.MEDIA_LOADING}]:not([${W.MediaUIAttributes.MEDIA_PAUSED}])) slot[name=icon] > *,
:host([${W.MediaUIAttributes.MEDIA_LOADING}]:not([${W.MediaUIAttributes.MEDIA_PAUSED}])) ::slotted([slot=icon]) {
  opacity: var(--media-loading-indicator-opacity, 1);
  transition: opacity 0.15s var(--_loading-indicator-delay);
}

:host #status {
  visibility: var(--media-loading-indicator-opacity, hidden);
  transition: visibility 0.15s;
}

:host([${W.MediaUIAttributes.MEDIA_LOADING}]:not([${W.MediaUIAttributes.MEDIA_PAUSED}])) #status {
  visibility: var(--media-loading-indicator-opacity, visible);
  transition: visibility 0.15s var(--_loading-indicator-delay);
}

svg, img, ::slotted(svg), ::slotted(img) {
  width: var(--media-loading-indicator-icon-width);
  height: var(--media-loading-indicator-icon-height, 100px);
  fill: var(--media-icon-color, var(--media-primary-color, rgb(238 238 238)));
  vertical-align: middle;
}
</style>

<slot name="icon">${iI}</slot>
<div id="status" role="status" aria-live="polite">${$.zy.MEDIA_LOADING()}</div>
`;class iL extends Q.Mq.HTMLElement{constructor(){if(super(),iA(this,j,void 0),iA(this,H,500),iA(this,G,void 0),!this.shadowRoot){let e=this.attachShadow({mode:"open"}),t=iC.content.cloneNode(!0);e.appendChild(t)}let{style:e}=(0,ee.R7)(this.shadowRoot,":host");iM(this,G,e)}static get observedAttributes(){return[W.m0.MEDIA_CONTROLLER,W.MediaUIAttributes.MEDIA_PAUSED,W.MediaUIAttributes.MEDIA_LOADING,iR.LOADING_DELAY]}attributeChangedCallback(e,t,i){var r,n,a,s,o;e===iR.LOADING_DELAY&&t!==i?this.loadingDelay=Number(i):e===W.m0.MEDIA_CONTROLLER&&(t&&(null==(n=null==(r=iw(this,j))?void 0:r.unassociateElement)||n.call(r,this),iM(this,j,null)),i&&(iM(this,j,null==(a=this.getRootNode())?void 0:a.getElementById(i)),null==(o=null==(s=iw(this,j))?void 0:s.associateElement)||o.call(s,this)))}connectedCallback(){var e,t,i;let r=this.getAttribute(W.m0.MEDIA_CONTROLLER);r&&(iM(this,j,null==(e=this.getRootNode())?void 0:e.getElementById(r)),null==(i=null==(t=iw(this,j))?void 0:t.associateElement)||i.call(t,this))}disconnectedCallback(){var e,t;null==(t=null==(e=iw(this,j))?void 0:e.unassociateElement)||t.call(e,this),iM(this,j,null)}get loadingDelay(){return iw(this,H)}set loadingDelay(e){iM(this,H,e),iw(this,G).setProperty("--_loading-indicator-delay",`var(--media-loading-indicator-transition-delay, ${e}ms)`)}get mediaPaused(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_PAUSED)}set mediaPaused(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_PAUSED,e)}get mediaLoading(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_LOADING)}set mediaLoading(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_LOADING,e)}}j=new WeakMap,H=new WeakMap,G=new WeakMap,Q.Mq.customElements.get("media-loading-indicator")||Q.Mq.customElements.define("media-loading-indicator",iL);let ik=e=>e.mediaMuted?0:Math.round(e.mediaVolume*e.range.max),iD=({value:e,max:t})=>`${Math.round(e/t*100)}%`;Q.Mq.customElements.get("media-volume-range")||Q.Mq.customElements.define("media-volume-range",class extends tr{static get observedAttributes(){return[...super.observedAttributes,W.MediaUIAttributes.MEDIA_VOLUME,W.MediaUIAttributes.MEDIA_MUTED,W.MediaUIAttributes.MEDIA_VOLUME_UNAVAILABLE]}constructor(){super(),this.range.max=100,this.range.addEventListener("input",()=>{let e=this.range.value/this.range.max,t=new Q.Mq.CustomEvent(W.MediaUIEvents.MEDIA_VOLUME_REQUEST,{composed:!0,bubbles:!0,detail:e});this.dispatchEvent(t)})}connectedCallback(){this.range.setAttribute("aria-label",$.zy.VOLUME()),super.connectedCallback()}attributeChangedCallback(e,t,i){if(e===W.MediaUIAttributes.MEDIA_VOLUME||e===W.MediaUIAttributes.MEDIA_MUTED){let e=ik(this);this.range.value=e,this.range.setAttribute("aria-valuetext",iD(this.range)),this.updateBar()}super.attributeChangedCallback(e,t,i)}get mediaVolume(){return(0,ee.Uf)(this,W.MediaUIAttributes.MEDIA_VOLUME,1)}set mediaVolume(e){(0,ee.Jv)(this,W.MediaUIAttributes.MEDIA_VOLUME,e)}get mediaMuted(){return(0,ee.zc)(this,W.MediaUIAttributes.MEDIA_MUTED)}set mediaMuted(e){(0,ee.Pj)(this,W.MediaUIAttributes.MEDIA_MUTED,e)}get mediaVolumeUnavailable(){return(0,ee.ST)(this,W.MediaUIAttributes.MEDIA_VOLUME_UNAVAILABLE)}set mediaVolumeUnavailable(e){(0,ee.Lb)(this,W.MediaUIAttributes.MEDIA_VOLUME_UNAVAILABLE,e)}})},73889:function(e,t,i){"use strict";i.d(t,{pg:function(){return n},zy:function(){return r}});let r={AUDIO_PLAYER:()=>"audio player",VIDEO_PLAYER:()=>"video player",VOLUME:()=>"volume",SEEK:()=>"seek",CLOSED_CAPTIONS:()=>"closed captions",PLAYBACK_RATE:({playbackRate:e=1}={})=>`current playback rate ${e}`,PLAYBACK_TIME:()=>"playback time",MEDIA_LOADING:()=>"media loading"},n={PLAY:()=>"play",PAUSE:()=>"pause",MUTE:()=>"mute",UNMUTE:()=>"unmute",AIRPLAY:()=>"air play",ENTER_CAST:()=>"start casting",EXIT_CAST:()=>"stop casting",ENTER_FULLSCREEN:()=>"enter fullscreen mode",EXIT_FULLSCREEN:()=>"exit fullscreen mode",ENTER_PIP:()=>"enter picture in picture mode",EXIT_PIP:()=>"exit picture in picture mode",SEEK_FORWARD_N_SECS:({seekOffset:e=30}={})=>`seek forward ${e} seconds`,SEEK_BACK_N_SECS:({seekOffset:e=30}={})=>`seek back ${e} seconds`,SEEK_LIVE:()=>"seek to live",PLAYING_LIVE:()=>"playing live"};({...r,...n})},59468:function(e,t,i){"use strict";var r=i(8925),n=i(45717),a=i(42409),s=i(73889),o=i(85222);let l=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M22.83 5.68a2.58 2.58 0 0 0-2.3-2.5c-3.62-.24-11.44-.24-15.06 0a2.58 2.58 0 0 0-2.3 2.5c-.23 4.21-.23 8.43 0 12.64a2.58 2.58 0 0 0 2.3 2.5c3.62.24 11.44.24 15.06 0a2.58 2.58 0 0 0 2.3-2.5c.23-4.21.23-8.43 0-12.64Zm-11.39 9.45a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.92 3.92 0 0 1 .92-2.77 3.18 3.18 0 0 1 2.43-1 2.94 2.94 0 0 1 2.13.78c.364.359.62.813.74 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.17 1.61 1.61 0 0 0-1.29.58 2.79 2.79 0 0 0-.5 1.89 3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.48 1.48 0 0 0 1-.37 2.1 2.1 0 0 0 .59-1.14l1.4.44a3.23 3.23 0 0 1-1.07 1.69Zm7.22 0a3.07 3.07 0 0 1-1.91.57 3.06 3.06 0 0 1-2.34-1 3.75 3.75 0 0 1-.92-2.67 3.88 3.88 0 0 1 .93-2.77 3.14 3.14 0 0 1 2.42-1 3 3 0 0 1 2.16.82 2.8 2.8 0 0 1 .73 1.31l-1.43.35a1.49 1.49 0 0 0-1.51-1.21 1.61 1.61 0 0 0-1.29.58A2.79 2.79 0 0 0 15 12a3 3 0 0 0 .49 1.93 1.61 1.61 0 0 0 1.27.58 1.44 1.44 0 0 0 1-.37 2.1 2.1 0 0 0 .6-1.15l1.4.44a3.17 3.17 0 0 1-1.1 1.7Z"/>
</svg>`,u=`<svg aria-hidden="true" viewBox="0 0 26 24">
  <path d="M17.73 14.09a1.4 1.4 0 0 1-1 .37 1.579 1.579 0 0 1-1.27-.58A3 3 0 0 1 15 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34A2.89 2.89 0 0 0 19 9.07a3 3 0 0 0-2.14-.78 3.14 3.14 0 0 0-2.42 1 3.91 3.91 0 0 0-.93 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.17 3.17 0 0 0 1.07-1.74l-1.4-.45c-.083.43-.3.822-.62 1.12Zm-7.22 0a1.43 1.43 0 0 1-1 .37 1.58 1.58 0 0 1-1.27-.58A3 3 0 0 1 7.76 12a2.8 2.8 0 0 1 .5-1.85 1.63 1.63 0 0 1 1.29-.57 1.47 1.47 0 0 1 1.51 1.2l1.43-.34a2.81 2.81 0 0 0-.74-1.32 2.94 2.94 0 0 0-2.13-.78 3.18 3.18 0 0 0-2.43 1 4 4 0 0 0-.92 2.78 3.74 3.74 0 0 0 .92 2.66 3.07 3.07 0 0 0 2.34 1 3.07 3.07 0 0 0 1.91-.57 3.23 3.23 0 0 0 1.07-1.74l-1.4-.45a2.06 2.06 0 0 1-.6 1.07Zm12.32-8.41a2.59 2.59 0 0 0-2.3-2.51C18.72 3.05 15.86 3 13 3c-2.86 0-5.72.05-7.53.17a2.59 2.59 0 0 0-2.3 2.51c-.23 4.207-.23 8.423 0 12.63a2.57 2.57 0 0 0 2.3 2.5c1.81.13 4.67.19 7.53.19 2.86 0 5.72-.06 7.53-.19a2.57 2.57 0 0 0 2.3-2.5c.23-4.207.23-8.423 0-12.63Zm-1.49 12.53a1.11 1.11 0 0 1-.91 1.11c-1.67.11-4.45.18-7.43.18-2.98 0-5.76-.07-7.43-.18a1.11 1.11 0 0 1-.91-1.11c-.21-4.14-.21-8.29 0-12.43a1.11 1.11 0 0 1 .91-1.11C7.24 4.56 10 4.49 13 4.49s5.76.07 7.43.18a1.11 1.11 0 0 1 .91 1.11c.21 4.14.21 8.29 0 12.43Z"/>
</svg>`,c=n.tj.createElement("template");c.innerHTML=`
  <style>
    :host([aria-checked="true"]) slot[name=off] {
      display: none !important;
    }

    
    :host(:not([aria-checked="true"])) slot[name=on] {
      display: none !important;
    }
  </style>

  <slot name="icon">
    <slot name="on">${l}</slot>
    <slot name="off">${u}</slot>
  </slot>
`;let d=e=>{e.setAttribute("aria-checked",(0,o.hi)(e))};class h extends r.Z{static get observedAttributes(){return[...super.observedAttributes,a.MediaUIAttributes.MEDIA_SUBTITLES_LIST,a.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING]}constructor(e={}){super({slotTemplate:c,...e}),this._captionsReady=!1}connectedCallback(){super.connectedCallback(),this.setAttribute("role","switch"),this.setAttribute("aria-label",s.zy.CLOSED_CAPTIONS()),d(this)}attributeChangedCallback(e,t,i){e===a.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING&&d(this),super.attributeChangedCallback(e,t,i)}get mediaSubtitlesList(){return f(this,a.MediaUIAttributes.MEDIA_SUBTITLES_LIST)}set mediaSubtitlesList(e){p(this,a.MediaUIAttributes.MEDIA_SUBTITLES_LIST,e)}get mediaSubtitlesShowing(){return f(this,a.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING)}set mediaSubtitlesShowing(e){p(this,a.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING,e)}handleClick(){(0,o.U2)(this)}}let f=(e,t)=>{let i=e.getAttribute(t);return i?(0,o.tm)(i):[]},p=(e,t,i)=>{if(!(null==i?void 0:i.length)){e.removeAttribute(t);return}let r=(0,o.fj)(i),n=e.getAttribute(t);n!==r&&e.setAttribute(t,r)};n.Mq.customElements.get("media-captions-button")||n.Mq.customElements.define("media-captions-button",h)},8925:function(e,t,i){"use strict";i.d(t,{Z:function(){return y}});var r,n,a,s,o=i(42409),l=i(79057),u=i(45717),c=Object.defineProperty,d=(e,t,i)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,h=(e,t,i)=>(d(e,"symbol"!=typeof t?t+"":t,i),i),f=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},p=(e,t,i)=>(f(e,t,"read from private field"),i?i.call(e):t.get(e)),m=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},g=(e,t,i,r)=>(f(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);let v=u.tj.createElement("template");v.innerHTML=`
<style>
  :host {
    font: var(--media-font,
      var(--media-font-weight, bold)
      var(--media-font-size, 14px) /
      var(--media-text-content-height, var(--media-control-height, 24px))
      var(--media-font-family, helvetica neue, segoe ui, roboto, arial, sans-serif));
    color: var(--media-text-color, var(--media-primary-color, rgb(238 238 238)));
    background: var(--media-control-background, var(--media-secondary-color, rgb(20 20 30 / .7)));
    padding: var(--media-control-padding, 10px);
    display: inline-flex;
    align-items: center;
    justify-content: center;
    vertical-align: middle;
    box-sizing: border-box;
    transition: background .15s linear;
    pointer-events: auto;
    cursor: pointer;
  }

  
  :host(:focus-visible) {
    box-shadow: inset 0 0 0 2px rgb(27 127 204 / .9);
    outline: 0;
  }
  
  :host(:where(:focus)) {
    box-shadow: none;
    outline: 0;
  }

  :host(:hover) {
    background: var(--media-control-hover-background, rgba(50 50 70 / .7));
  }

  svg, img, ::slotted(svg), ::slotted(img) {
    width: var(--media-button-icon-width);
    height: var(--media-button-icon-height, var(--media-control-height, 24px));
    transform: var(--media-button-icon-transform);
    transition: var(--media-button-icon-transition);
    fill: var(--media-icon-color, var(--media-primary-color, rgb(238 238 238)));
    vertical-align: middle;
    max-width: 100%;
    max-height: 100%;
    min-width: 100%;
  }
</style>
`;class y extends u.Mq.HTMLElement{constructor(e={}){if(super(),m(this,r,void 0),h(this,"preventClick",!1),m(this,n,e=>{this.preventClick||this.handleClick(e)}),m(this,a,e=>{let{key:t}=e;if(!this.keysUsed.includes(t)){this.removeEventListener("keyup",p(this,a));return}this.preventClick||this.handleClick(e)}),m(this,s,e=>{let{metaKey:t,altKey:i,key:r}=e;if(t||i||!this.keysUsed.includes(r)){this.removeEventListener("keyup",p(this,a));return}this.addEventListener("keyup",p(this,a),{once:!0})}),!this.shadowRoot){this.attachShadow({mode:"open"});let t=v.content.cloneNode(!0);this.nativeEl=t;let i=e.slotTemplate;i||((i=u.tj.createElement("template")).innerHTML=`<slot>${e.defaultContent||""}</slot>`),this.nativeEl.appendChild(i.content.cloneNode(!0)),this.shadowRoot.appendChild(t)}let{style:t}=(0,l.R7)(this.shadowRoot,":host");t.setProperty("display",`var(--media-control-display, var(--${this.localName}-display, inline-flex))`)}static get observedAttributes(){return["disabled",o.m0.MEDIA_CONTROLLER]}enable(){this.addEventListener("click",p(this,n)),this.addEventListener("keydown",p(this,s)),this.tabIndex=0}disable(){this.removeEventListener("click",p(this,n)),this.removeEventListener("keydown",p(this,s)),this.removeEventListener("keyup",p(this,a)),this.tabIndex=-1}attributeChangedCallback(e,t,i){var n,a,s,l,u;e===o.m0.MEDIA_CONTROLLER?(t&&(null==(a=null==(n=p(this,r))?void 0:n.unassociateElement)||a.call(n,this),g(this,r,null)),i&&(g(this,r,null==(s=this.getRootNode())?void 0:s.getElementById(i)),null==(u=null==(l=p(this,r))?void 0:l.associateElement)||u.call(l,this))):"disabled"===e&&i!==t&&(null==i?this.enable():this.disable())}connectedCallback(){var e,t,i;this.hasAttribute("disabled")||this.enable(),this.setAttribute("role","button");let n=this.getAttribute(o.m0.MEDIA_CONTROLLER);n&&(g(this,r,null==(e=this.getRootNode())?void 0:e.getElementById(n)),null==(i=null==(t=p(this,r))?void 0:t.associateElement)||i.call(t,this))}disconnectedCallback(){var e,t;this.disable(),null==(t=null==(e=p(this,r))?void 0:e.unassociateElement)||t.call(e,this),g(this,r,null)}get keysUsed(){return["Enter"," "]}handleClick(e){}}r=new WeakMap,n=new WeakMap,a=new WeakMap,s=new WeakMap,u.Mq.customElements.get("media-chrome-button")||u.Mq.customElements.define("media-chrome-button",y)},85076:function(e,t,i){"use strict";i.d(t,{DC:function(){return p},_S:function(){return m}});var r,n=i(8925),a=i(45717),s=i(42409),o=i(73889),l=i(79057),u=i(80401),c=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},d=(e,t,i)=>(c(e,t,"read from private field"),i?i.call(e):t.get(e)),h=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)};let f={RATES:"rates"},p=[1,1.25,1.5,1.75,2],m=1,g=a.tj.createElement("template");g.innerHTML=`
  <span id="container"></span>
`;class v extends n.Z{constructor(e={}){super({slotTemplate:g,...e}),h(this,r,new u.D(this,f.RATES,{defaultValue:p})),this.container=this.shadowRoot.querySelector("#container"),this.container.innerHTML=`${m}x`}static get observedAttributes(){return[...super.observedAttributes,s.MediaUIAttributes.MEDIA_PLAYBACK_RATE,f.RATES]}attributeChangedCallback(e,t,i){if(e===f.RATES&&(d(this,r).value=i),e===s.MediaUIAttributes.MEDIA_PLAYBACK_RATE){let e=i?+i:Number.NaN,t=Number.isNaN(e)?m:e;this.container.innerHTML=`${t}x`,this.setAttribute("aria-label",o.zy.PLAYBACK_RATE({playbackRate:t}));return}super.attributeChangedCallback(e,t,i)}get rates(){return d(this,r)}set rates(e){e?Array.isArray(e)&&(d(this,r).value=e.join(" ")):d(this,r).value=""}get mediaPlaybackRate(){return(0,l.Uf)(this,s.MediaUIAttributes.MEDIA_PLAYBACK_RATE,m)}set mediaPlaybackRate(e){(0,l.Jv)(this,s.MediaUIAttributes.MEDIA_PLAYBACK_RATE,e)}handleClick(){var e,t;let i=Array.from(this.rates.values(),e=>+e).sort((e,t)=>e-t),r=null!=(t=null!=(e=i.find(e=>e>this.mediaPlaybackRate))?e:i[0])?t:m,n=new a.Mq.CustomEvent(s.MediaUIEvents.MEDIA_PLAYBACK_RATE_REQUEST,{composed:!0,bubbles:!0,detail:r});this.dispatchEvent(n)}}r=new WeakMap,a.Mq.customElements.get("media-playback-rate-button")||a.Mq.customElements.define("media-playback-rate-button",v)},36488:function(e,t,i){"use strict";i.d(t,{cf:function(){return F},X5:function(){return B},E$:function(){return ec},R:function(){return L}});var r,n,a,s,o,l,u,c,d,h,f,p,m,g,v,y,b,_,E=i(42409),S=i(45717),x=Object.defineProperty,T=(e,t,i)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,w=(e,t,i)=>(T(e,"symbol"!=typeof t?t+"":t,i),i),A=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},M=(e,t,i)=>(A(e,t,"read from private field"),i?i.call(e):t.get(e)),R=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},C=(e,t,i,r)=>(A(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);let I={processCallback(e,t,i){if(i){for(let[e,r]of t)if(e in i){let t=i[e];"boolean"==typeof t&&r instanceof F&&"boolean"==typeof r.element[r.attributeName]?r.booleanValue=t:"function"==typeof t&&r instanceof F?r.element[r.attributeName]=t:r.value=t}}}};class L extends S.Mq.DocumentFragment{constructor(e,t,i=I){var a;super(),R(this,r,void 0),R(this,n,void 0),this.append(e.content.cloneNode(!0)),C(this,r,k(this)),C(this,n,i),null==(a=i.createCallback)||a.call(i,this,M(this,r),t),i.processCallback(this,M(this,r),t)}update(e){M(this,n).processCallback(this,M(this,r),e)}}r=new WeakMap,n=new WeakMap;let k=(e,t=[])=>{let i,r;for(let n of e.attributes||[])if(n.value.includes("{{")){let a=new U;for([i,r]of P(n.value))if(i){let i=new F(e,n.name,n.namespaceURI);a.append(i),t.push([r,i])}else a.append(r);n.value=a.toString()}for(let n of e.childNodes)if(1!==n.nodeType||n instanceof HTMLTemplateElement){if(1===n.nodeType||n.data.includes("{{")){let a=[];if(n.data)for([i,r]of P(n.data))if(i){let i=new B(e);a.push(i),t.push([r,i])}else a.push(new Text(r));else if(n instanceof HTMLTemplateElement){let i=new V(e,n);a.push(i),t.push([i.expression,i])}n.replaceWith(...a.flatMap(e=>e.replacementNodes||[e]))}}else k(n,t);return t},D={},P=e=>{let t="",i=0,r=D[e],n=0,a;if(r)return r;for(r=[];a=e[n];n++)"{"===a&&"{"===e[n+1]&&"\\"!==e[n-1]&&e[n+2]&&1==++i?(t&&r.push([0,t]),t="",n++):"}"!==a||"}"!==e[n+1]||"\\"===e[n-1]||--i?t+=a||"":(r.push([1,t.trim()]),t="",n++);return t&&r.push([0,(i>0?"{{":"")+t]),D[e]=r};class O{get value(){return""}set value(e){}toString(){return this.value}}let N=new WeakMap;class U{constructor(){R(this,a,[])}[Symbol.iterator](){return M(this,a).values()}get length(){return M(this,a).length}item(e){return M(this,a)[e]}append(...e){for(let t of e)t instanceof F&&N.set(t,this),M(this,a).push(t)}toString(){return M(this,a).join("")}}a=new WeakMap;class F extends O{constructor(e,t,i){super(),R(this,c),R(this,s,""),R(this,o,void 0),R(this,l,void 0),R(this,u,void 0),C(this,o,e),C(this,l,t),C(this,u,i)}get attributeName(){return M(this,l)}get attributeNamespace(){return M(this,u)}get element(){return M(this,o)}get value(){return M(this,s)}set value(e){M(this,s)!==e&&(C(this,s,e),M(this,c,d)&&1!==M(this,c,d).length?M(this,o).setAttributeNS(M(this,u),M(this,l),M(this,c,d)):null==e?M(this,o).removeAttributeNS(M(this,u),M(this,l)):M(this,o).setAttributeNS(M(this,u),M(this,l),e))}get booleanValue(){return M(this,o).hasAttributeNS(M(this,u),M(this,l))}set booleanValue(e){if(M(this,c,d)&&1!==M(this,c,d).length)throw new DOMException("Value is not fully templatized");this.value=e?"":null}}s=new WeakMap,o=new WeakMap,l=new WeakMap,u=new WeakMap,c=new WeakSet,d=function(){return N.get(this)};class B extends O{constructor(e,t){super(),R(this,h,void 0),R(this,f,void 0),C(this,h,e),C(this,f,t?[...t]:[new Text])}get replacementNodes(){return M(this,f)}get parentNode(){return M(this,h)}get nextSibling(){return M(this,f)[M(this,f).length-1].nextSibling}get previousSibling(){return M(this,f)[0].previousSibling}get value(){return M(this,f).map(e=>e.textContent).join("")}set value(e){this.replace(e)}replace(...e){let t=e.flat().flatMap(e=>null==e?[new Text]:e.forEach?[...e]:11===e.nodeType?[...e.childNodes]:e.nodeType?[e]:[new Text(e)]);t.length||t.push(new Text),C(this,f,function(e,t,i,r=null){let n=0,a,s,o,l=i.length,u=t.length;for(;n<l&&n<u&&t[n]==i[n];)n++;for(;n<l&&n<u&&i[l-1]==t[u-1];)r=i[--u,--l];if(n==u)for(;n<l;)e.insertBefore(i[n++],r);if(n==l)for(;n<u;)e.removeChild(t[n++]);else{for(a=t[n];n<l;)o=i[n++],s=a?a.nextSibling:r,a==o?a=s:n<l&&i[n]==s?(e.replaceChild(o,a),a=s):e.insertBefore(o,a);for(;a!=r;)s=a.nextSibling,e.removeChild(a),a=s}return i}(M(this,f)[0].parentNode,M(this,f),t,this.nextSibling))}}h=new WeakMap,f=new WeakMap;class V extends B{constructor(e,t){let i=t.getAttribute("directive")||t.getAttribute("type"),r=t.getAttribute("expression")||t.getAttribute(i)||"";r.startsWith("{{")&&(r=r.trim().slice(2,-2).trim()),super(e),w(this,"directive"),this.expression=r,this.template=t,this.directive=i}}var z=i(68995);let j={string:e=>String(e)};class H{constructor(e){this.template=e,this.state=void 0}}let G=new WeakMap,W=new WeakMap,$={partial:(e,t)=>{t[e.expression]=new H(e.template)},if:(e,t)=>{var i;if(X(e.expression,t)){if(G.get(e)!==e.template){G.set(e,e.template);let i=new L(e.template,t,Y);e.replace(i),W.set(e,i)}else null==(i=W.get(e))||i.update(t)}else e.replace(""),G.delete(e),W.delete(e)}},q=Object.keys($),Y={processCallback(e,t,i){var r,n;if(i)for(let[e,a]of t){if(a instanceof V){if(!a.directive){let e=q.find(e=>a.template.hasAttribute(e));e&&(a.directive=e,a.expression=a.template.getAttribute(e))}null==(r=$[a.directive])||r.call($,a,i);continue}let t=X(e,i);if(t instanceof H){G.get(a)!==t.template?(G.set(a,t.template),t=new L(t.template,t.state,Y),a.value=t,W.set(a,t)):null==(n=W.get(a))||n.update(t.state);continue}t?(a instanceof F&&a.attributeName.startsWith("aria-")&&(t=String(t)),a instanceof F?"boolean"==typeof t?a.booleanValue=t:"function"==typeof t?a.element[a.attributeName]=t:a.value=t:(a.value=t,G.delete(a),W.delete(a))):a instanceof F?a.value=void 0:(a.value=void 0,G.delete(a),W.delete(a))}}},K={"!":e=>!e,"!!":e=>!!e,"==":(e,t)=>e==t,"!=":(e,t)=>e!=t,">":(e,t)=>e>t,">=":(e,t)=>e>=t,"<":(e,t)=>e<t,"<=":(e,t)=>e<=t,"??":(e,t)=>null!=e?e:t,"|":(e,t)=>{var i;return null==(i=j[t])?void 0:i.call(j,e)}};function X(e,t={}){var i,r,n,a,s,o,l;let u=(function(e,t){let i,r,n,a=[];for(;e;){for(let a in n=null,i=e.length,t)(r=t[a].exec(e))&&r.index<i&&(n={token:r[0],type:a,matches:r.slice(1)},i=r.index);i&&a.push({token:e.substr(0,i),type:void 0}),n&&a.push(n),e=e.substr(i+(n?n.token.length:0))}return a})(e,{boolean:/true|false/,number:/-?\d+\.?\d*/,string:/(["'])((?:\\.|[^\\])*?)\1/,operator:/[!=><][=!]?|\?\?|\|/,ws:/\s+/,param:/[$a-z_][$\w]*/i}).filter(({type:e})=>"ws"!==e);if(0===u.length||u.some(({type:e})=>!e))return Z(e);if((null==(i=u[0])?void 0:i.token)===">"){let i=t[null==(r=u[1])?void 0:r.token];if(!i)return Z(e);let o={...t};i.state=o;let l=u.slice(2);for(let e=0;e<l.length;e+=3){let i=null==(n=l[e])?void 0:n.token,r=null==(a=l[e+1])?void 0:a.token,u=null==(s=l[e+2])?void 0:s.token;i&&"="===r&&(o[i]=Q(u,t))}return i}if(1===u.length)return J(u[0])?Q(u[0].token,t):Z(e);if(2===u.length){let i=null==(o=u[0])?void 0:o.token,r=K[i];if(!r||!J(u[1]))return Z(e);let n=Q(u[1].token,t);return r(n)}if(3===u.length){let i=null==(l=u[1])?void 0:l.token,r=K[i];if(!r||!J(u[0])||!J(u[2]))return Z(e);let n=Q(u[0].token,t);if("|"===i)return r(n,u[2].token);let a=Q(u[2].token,t);return r(n,a)}}function Z(e){return console.warn(`Warning: invalid expression \`${e}\``),!1}function J({type:e}){return["number","boolean","string","param"].includes(e)}function Q(e,t){let i=e[0],r=e.slice(-1);return"true"===e||"false"===e?"true"===e:i===r&&["'",'"'].includes(i)?e.slice(1,-1):(0,z.Hv)(e)?parseFloat(e):t[e]}var ee=Object.defineProperty,et=(e,t,i)=>t in e?ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,ei=(e,t,i)=>(et(e,"symbol"!=typeof t?t+"":t,i),i),er=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},en=(e,t,i)=>(er(e,t,"read from private field"),i?i.call(e):t.get(e)),ea=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},es=(e,t,i,r)=>(er(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i),eo=(e,t,i)=>(er(e,t,"access private method"),i);let el={mediatargetlivewindow:"targetlivewindow",mediastreamtype:"streamtype"},eu=S.tj.createElement("template");eu.innerHTML=`
  <style>
    :host {
      display: inline-block;
      line-height: 0;
    }

    media-controller {
      width: 100%;
      height: 100%;
    }

    media-controller:not([mediasubtitleslist]) media-captions-selectmenu,
    media-captions-button:not([mediasubtitleslist]),
    media-rendition-selectmenu[mediarenditionunavailable],
    media-audio-track-selectmenu[mediaaudiotrackunavailable],
    media-volume-range[mediavolumeunavailable],
    media-airplay-button[mediaairplayunavailable],
    media-fullscreen-button[mediafullscreenunavailable],
    media-cast-button[mediacastunavailable],
    media-pip-button[mediapipunavailable] {
      display: none;
    }
  </style>
`;class ec extends S.Mq.HTMLElement{constructor(){super(),ea(this,v),ea(this,b),ei(this,"renderRoot"),ei(this,"renderer"),ea(this,p,void 0),ea(this,m,void 0),ea(this,g,void 0),this.shadowRoot?this.renderRoot=this.shadowRoot:(this.renderRoot=this.attachShadow({mode:"open"}),this.createRenderer());let e=new MutationObserver(e=>{var t;(!this.mediaController||(null==(t=this.mediaController)?void 0:t.breakpointsComputed))&&e.some(e=>{let t=e.target;return t===this||"media-controller"===t.localName&&!!(el[e.attributeName]||e.attributeName.startsWith("breakpoint"))})&&this.render()});e.observe(this,{attributes:!0}),e.observe(this.renderRoot,{attributes:!0,subtree:!0}),this.addEventListener(E.TP.BREAKPOINTS_COMPUTED,this.render),eo(this,v,y).call(this,"template")}get mediaController(){return this.renderRoot.querySelector("media-controller")}get template(){var e;return null!=(e=en(this,p))?e:this.constructor.template}set template(e){es(this,g,null),es(this,p,e),this.createRenderer()}get props(){var e,t,i;let r=[...Array.from(null!=(t=null==(e=this.mediaController)?void 0:e.attributes)?t:[]).filter(({name:e})=>el[e]||e.startsWith("breakpoint")),...Array.from(this.attributes)],n={};for(let e of r){let t=null!=(i=el[e.name])?i:(0,z.eV)(e.name),{value:r}=e;null!=r?((0,z.Hv)(r)&&(r=parseFloat(r)),n[t]=""===r||r):n[t]=!1}return n}attributeChangedCallback(e,t,i){"template"===e&&t!=i&&eo(this,b,_).call(this)}connectedCallback(){eo(this,b,_).call(this)}createRenderer(){this.template&&this.template!==en(this,m)&&(es(this,m,this.template),this.renderer=new L(this.template,this.props,this.constructor.processor),this.renderRoot.textContent="",this.renderRoot.append(eu.content.cloneNode(!0),this.renderer))}render(){var e;null==(e=this.renderer)||e.update(this.props)}}async function ed(e){let t=await fetch(e);if(200!==t.status)throw Error(`Failed to load resource: the server responded with a status of ${t.status}`);return t.text()}p=new WeakMap,m=new WeakMap,g=new WeakMap,v=new WeakSet,y=function(e){if(Object.prototype.hasOwnProperty.call(this,e)){let t=this[e];delete this[e],this[e]=t}},b=new WeakSet,_=function(){var e;let t=this.getAttribute("template");if(!t||t===en(this,g))return;let i=this.getRootNode(),r=null==(e=null==i?void 0:i.getElementById)?void 0:e.call(i,t);if(r){es(this,g,t),es(this,p,r),this.createRenderer();return}(function(e){if(!/^(\/|\.\/|https?:\/\/)/.test(e))return!1;let t=/^https?:\/\//.test(e)?void 0:location.origin;try{new URL(e,t)}catch(e){return!1}return!0})(t)&&(es(this,g,t),ed(t).then(e=>{let t=S.tj.createElement("template");t.innerHTML=e,es(this,p,t),this.createRenderer()}).catch(console.error))},ei(ec,"template"),ei(ec,"observedAttributes",["template"]),ei(ec,"processor",Y),S.Mq.customElements.get("media-theme")||S.Mq.customElements.define("media-theme",ec)},80401:function(e,t,i){"use strict";i.d(t,{D:function(){return f}});var r,n,a,s,o,l,u=(e,t,i)=>{if(!t.has(e))throw TypeError("Cannot "+i)},c=(e,t,i)=>(u(e,t,"read from private field"),i?i.call(e):t.get(e)),d=(e,t,i)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,i)},h=(e,t,i,r)=>(u(e,t,"write to private field"),r?r.call(e,i):t.set(e,i),i);class f{constructor(e,t,{defaultValue:i}={defaultValue:void 0}){d(this,o),d(this,r,void 0),d(this,n,void 0),d(this,a,void 0),d(this,s,new Set),h(this,r,e),h(this,n,t),h(this,a,new Set(i))}[Symbol.iterator](){return c(this,o,l).values()}get length(){return c(this,o,l).size}get value(){var e;return null!=(e=[...c(this,o,l)].join(" "))?e:""}set value(e){var t;e!==this.value&&(h(this,s,new Set),this.add(...null!=(t=null==e?void 0:e.split(" "))?t:[]))}toString(){return this.value}item(e){return[...c(this,o,l)][e]}values(){return c(this,o,l).values()}forEach(e){c(this,o,l).forEach(e)}add(...e){var t,i;e.forEach(e=>c(this,s).add(e)),(""!==this.value||(null==(t=c(this,r))?void 0:t.hasAttribute(`${c(this,n)}`)))&&(null==(i=c(this,r))||i.setAttribute(`${c(this,n)}`,`${this.value}`))}remove(...e){var t;e.forEach(e=>c(this,s).delete(e)),null==(t=c(this,r))||t.setAttribute(`${c(this,n)}`,`${this.value}`)}contains(e){return c(this,o,l).has(e)}toggle(e,t){return void 0!==t?t?(this.add(e),!0):(this.remove(e),!1):this.contains(e)?(this.remove(e),!1):(this.add(e),!0)}replace(e,t){return this.remove(e),this.add(t),e===t}}r=new WeakMap,n=new WeakMap,a=new WeakMap,s=new WeakMap,o=new WeakSet,l=function(){return c(this,s).size?c(this,s):c(this,a)}},85222:function(e,t,i){"use strict";i.d(t,{Bh:function(){return f},Jc:function(){return p},Ly:function(){return u},U2:function(){return g},fj:function(){return c},hi:function(){return m},tm:function(){return o}});var r=i(45717),n=i(42409);let a=(e="")=>e.split(/\s+/),s=(e="")=>{let[t,i,r]=e.split(":"),n=r?decodeURIComponent(r):void 0;return{kind:t="cc"===t?"captions":"subtitles",language:i,label:n}},o=(e="",t={})=>a(e).map(e=>{let i=s(e);return{...t,...i}}),l=e=>Array.isArray(e)?e.map(e=>"string"==typeof e?s(e):e):"string"==typeof e?o(e):[e],u=({kind:e,label:t,language:i}={kind:"subtitles"})=>t?`${"captions"===e?"cc":"sb"}:${i}:${encodeURIComponent(t)}`:i,c=(e=[])=>Array.prototype.map.call(e,u).join(" "),d=(e,t)=>i=>i[e]===t,h=e=>{let t=Object.entries(e).map(([e,t])=>d(e,t));return e=>t.every(t=>t(e))},f=(e,t=[],i=[])=>{let r=l(i).map(h);Array.from(t).filter(e=>r.some(t=>t(e))).forEach(t=>{t.mode=e})},p=(e,t=()=>!0)=>{if(!(null==e?void 0:e.textTracks))return[];let i="function"==typeof t?t:h(t);return Array.from(e.textTracks).filter(i)},m=e=>{let t=!!e.getAttribute(n.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING);return t},g=(e,t)=>{var i,s;let o=m(e);if(o||!1===t){let t=e.getAttribute(n.MediaUIAttributes.MEDIA_SUBTITLES_SHOWING);if(t){let i=new r.Mq.CustomEvent(n.MediaUIEvents.MEDIA_DISABLE_SUBTITLES_REQUEST,{composed:!0,bubbles:!0,detail:t});e.dispatchEvent(i)}}else if(o&&!0!==t)console.error("Attempting to enable captions or subtitles but none are available! Please verify your media content if this is unexpected.");else{let[t]=null!=(s=a(null!=(i=e.getAttribute(n.MediaUIAttributes.MEDIA_SUBTITLES_LIST))?i:""))?s:[];if(t){let i=new r.Mq.CustomEvent(n.MediaUIEvents.MEDIA_SHOW_SUBTITLES_REQUEST,{composed:!0,bubbles:!0,detail:t});e.dispatchEvent(i)}}}},79057:function(e,t,i){"use strict";i.d(t,{Jv:function(){return c},Lb:function(){return p},Mj:function(){return s},PV:function(){return a},Pj:function(){return h},R7:function(){return l},ST:function(){return f},Uf:function(){return u},l5:function(){return o},wl:function(){return r},zc:function(){return d}});let r=(e,t,i=".value")=>{let r=e.querySelector(i);r&&(r.textContent=t)},n=(e,t)=>{let i=`slot[name="${t}"]`,r=e.shadowRoot.querySelector(i);return r?r.children:[]},a=(e,t)=>n(e,t)[0],s=(e,t)=>!!e&&!!t&&(!!e.contains(t)||s(e,t.getRootNode().host)),o=(e,t)=>{if(!e)return null;let i=e.closest(t);return i||o(e.getRootNode().host,t)};function l(e,t){var i;let r;for(r of e.querySelectorAll("style")){let e;try{e=null==(i=r.sheet)?void 0:i.cssRules}catch{continue}for(let i of null!=e?e:[])if(i.selectorText===t)return i}return(null==r?void 0:r.sheet)?(r.sheet.insertRule(`${t}{}`,r.sheet.cssRules.length),r.sheet.cssRules[r.sheet.cssRules.length-1]):{style:{setProperty:()=>{},removeProperty:()=>{}}}}function u(e,t,i=Number.NaN){let r=e.getAttribute(t);return null!=r?+r:i}function c(e,t,i){let r=+i;if(null==i||Number.isNaN(r)){e.hasAttribute(t)&&e.removeAttribute(t);return}u(e,t,void 0)!==r&&e.setAttribute(t,`${r}`)}function d(e,t){return e.hasAttribute(t)}function h(e,t,i){if(null==i){e.hasAttribute(t)&&e.removeAttribute(t);return}d(e,t)!=i&&e.toggleAttribute(t,i)}function f(e,t,i=null){var r;return null!=(r=e.getAttribute(t))?r:i}function p(e,t,i){if(null==i){e.hasAttribute(t)&&e.removeAttribute(t);return}let r=`${i}`;f(e,t,void 0)!==r&&e.setAttribute(t,r)}},45717:function(e,t,i){"use strict";i.d(t,{Mq:function(){return l},tj:function(){return u}});class r{addEventListener(){}removeEventListener(){}dispatchEvent(){return!0}}let n={createElement:function(){return new a.HTMLElement},addEventListener(){},removeEventListener(){}},a={ResizeObserver:class{observe(){}},document:n,HTMLElement:class extends r{},DocumentFragment:class extends r{},customElements:{get:function(){},define:function(){},whenDefined:function(){}},CustomEvent:function(){},getComputedStyle:function(){}},s="undefined"==typeof window||void 0===window.customElements,o=Object.keys(a).every(e=>e in globalThis),l=s&&!o?a:globalThis,u=s&&!o?n:globalThis.document},68995:function(e,t,i){"use strict";function r(e){return null==e?void 0:e.map(a).join(" ")}function n(e){return null==e?void 0:e.split(/\s+/).map(s)}function a(e){if(e){let{id:t,width:i,height:r}=e;return[t,i,r].filter(e=>null!=e).join(":")}}function s(e){if(e){let[t,i,r]=e.split(":");return{id:t,width:i,height:r}}}function o(e){return null==e?void 0:e.map(u).join(" ")}function l(e){return null==e?void 0:e.split(/\s+/).map(c)}function u(e){if(e){let{id:t,kind:i,language:r,label:n}=e;return[t,i,r,n].filter(e=>null!=e).join(":")}}function c(e){if(e){let[t,i,r,n]=e.split(":");return{id:t,kind:i,language:r,label:n}}}function d(e,t=!1){return e.split("_").map(function(e,i){return(i||t?e[0].toUpperCase():e[0].toLowerCase())+e.slice(1).toLowerCase()}).join("")}function h(e){return e.replace(/[-_]([a-z])/g,(e,t)=>t.toUpperCase())}function f(e){return"number"==typeof e&&!Number.isNaN(e)&&Number.isFinite(e)}function p(e){return"string"==typeof e&&!isNaN(e)&&!isNaN(parseFloat(e))}i.d(t,{Du:function(){return l},Hv:function(){return p},MS:function(){return n},UO:function(){return r},Zp:function(){return o},eV:function(){return h},gw:function(){return m},k7:function(){return d},qh:function(){return f}});let m=e=>new Promise(t=>setTimeout(t,e))},19095:function(e,t,i){"use strict";let r,n,a,s,o;i.r(t),i.d(t,{ACESFilmicToneMapping:function(){return es},AddEquation:function(){return C},AddOperation:function(){return et},AdditiveAnimationBlendMode:function(){return tM},AdditiveBlending:function(){return w},AlphaFormat:function(){return eF},AlwaysCompare:function(){return it},AlwaysDepth:function(){return $},AlwaysStencilFunc:function(){return t3},AmbientLight:function(){return cC},AmbientLightProbe:function(){return cW},AnimationAction:function(){return dp},AnimationClip:function(){return ce},AnimationLoader:function(){return cl},AnimationMixer:function(){return dg},AnimationObjectGroup:function(){return df},AnimationUtils:function(){return uZ},ArcCurve:function(){return lD},ArrayCamera:function(){return of},ArrowHelper:function(){return d5},Audio:function(){return c3},AudioAnalyser:function(){return c9},AudioContext:function(){return cj},AudioListener:function(){return c2},AudioLoader:function(){return cH},AxesHelper:function(){return d4},BackSide:function(){return _},BasicDepthPacking:function(){return tD},BasicShadowMap:function(){return m},Bone:function(){return o3},BooleanKeyframeTrack:function(){return u3},Box2:function(){return dR},Box3:function(){return rn},Box3Helper:function(){return d1},BoxGeometry:function(){return n5},BoxHelper:function(){return d0},BufferAttribute:function(){return n_},BufferGeometry:function(){return nF},BufferGeometryLoader:function(){return cN},ByteType:function(){return eR},Cache:function(){return ct},Camera:function(){return ae},CameraHelper:function(){return dZ},CanvasTexture:function(){return lI},CapsuleGeometry:function(){return l0},CatmullRomCurve3:function(){return lB},CineonToneMapping:function(){return ea},CircleGeometry:function(){return l1},ClampToEdgeWrapping:function(){return em},Clock:function(){return cX},Color:function(){return nd},ColorKeyframeTrack:function(){return u5},ColorManagement:function(){return iK},CompressedArrayTexture:function(){return lR},CompressedCubeTexture:function(){return lC},CompressedTexture:function(){return lM},CompressedTextureLoader:function(){return cu},ConeGeometry:function(){return l3},CubeCamera:function(){return ai},CubeReflectionMapping:function(){return eu},CubeRefractionMapping:function(){return ec},CubeTexture:function(){return ar},CubeTextureLoader:function(){return cd},CubeUVReflectionMapping:function(){return ef},CubicBezierCurve:function(){return lH},CubicBezierCurve3:function(){return lG},CubicInterpolant:function(){return uQ},CullFaceBack:function(){return h},CullFaceFront:function(){return f},CullFaceFrontBack:function(){return p},CullFaceNone:function(){return d},Curve:function(){return lL},CurvePath:function(){return lZ},CustomBlending:function(){return R},CustomToneMapping:function(){return eo},CylinderGeometry:function(){return l2},Cylindrical:function(){return dA},Data3DTexture:function(){return i8},DataArrayTexture:function(){return i4},DataTexture:function(){return o5},DataTextureLoader:function(){return ch},DataUtils:function(){return nv},DecrementStencilOp:function(){return t$},DecrementWrapStencilOp:function(){return tY},DefaultLoadingManager:function(){return cr},DepthFormat:function(){return ej},DepthStencilFormat:function(){return eH},DepthTexture:function(){return ov},DirectionalLight:function(){return cR},DirectionalLightHelper:function(){return dY},DiscreteInterpolant:function(){return u1},DisplayP3ColorSpace:function(){return tV},DodecahedronGeometry:function(){return l4},DoubleSide:function(){return E},DstAlphaFactor:function(){return V},DstColorFactor:function(){return j},DynamicCopyUsage:function(){return ic},DynamicDrawUsage:function(){return ir},DynamicReadUsage:function(){return io},EdgesGeometry:function(){return ue},EllipseCurve:function(){return lk},EqualCompare:function(){return t6},EqualDepth:function(){return K},EqualStencilFunc:function(){return tJ},EquirectangularReflectionMapping:function(){return ed},EquirectangularRefractionMapping:function(){return eh},Euler:function(){return rz},EventDispatcher:function(){return iy},ExtrudeGeometry:function(){return uE},FileLoader:function(){return co},Float16BufferAttribute:function(){return nR},Float32BufferAttribute:function(){return nC},Float64BufferAttribute:function(){return nI},FloatType:function(){return eD},Fog:function(){return oT},FogExp2:function(){return ox},FramebufferTexture:function(){return lA},FrontSide:function(){return b},Frustum:function(){return ad},GLBufferAttribute:function(){return dE},GLSL1:function(){return ih},GLSL3:function(){return ip},GreaterCompare:function(){return t7},GreaterDepth:function(){return Z},GreaterEqualCompare:function(){return ie},GreaterEqualDepth:function(){return X},GreaterEqualStencilFunc:function(){return t2},GreaterStencilFunc:function(){return t0},GridHelper:function(){return dH},Group:function(){return op},HalfFloatType:function(){return eP},HemisphereLight:function(){return cm},HemisphereLightHelper:function(){return dj},HemisphereLightProbe:function(){return cG},IcosahedronGeometry:function(){return ux},ImageBitmapLoader:function(){return cz},ImageLoader:function(){return cc},ImageUtils:function(){return iX},IncrementStencilOp:function(){return tW},IncrementWrapStencilOp:function(){return tq},InstancedBufferAttribute:function(){return o7},InstancedBufferGeometry:function(){return cO},InstancedInterleavedBuffer:function(){return d_},InstancedMesh:function(){return ls},Int16BufferAttribute:function(){return nT},Int32BufferAttribute:function(){return nA},Int8BufferAttribute:function(){return nE},IntType:function(){return eL},InterleavedBuffer:function(){return oA},InterleavedBufferAttribute:function(){return oR},Interpolant:function(){return uJ},InterpolateDiscrete:function(){return t_},InterpolateLinear:function(){return tE},InterpolateSmooth:function(){return tS},InvertStencilOp:function(){return tK},KeepStencilOp:function(){return tH},KeyframeTrack:function(){return u2},LOD:function(){return o$},LatheGeometry:function(){return lQ},Layers:function(){return rj},LessCompare:function(){return t4},LessDepth:function(){return q},LessEqualCompare:function(){return t8},LessEqualDepth:function(){return Y},LessEqualStencilFunc:function(){return tQ},LessStencilFunc:function(){return tZ},Light:function(){return cp},LightProbe:function(){return ck},Line:function(){return lf},Line3:function(){return dL},LineBasicMaterial:function(){return lo},LineCurve:function(){return lW},LineCurve3:function(){return l$},LineDashedMaterial:function(){return uG},LineLoop:function(){return lv},LineSegments:function(){return lg},LinearDisplayP3ColorSpace:function(){return tz},LinearEncoding:function(){return tL},LinearFilter:function(){return eS},LinearInterpolant:function(){return u0},LinearMipMapLinearFilter:function(){return eA},LinearMipMapNearestFilter:function(){return eT},LinearMipmapLinearFilter:function(){return ew},LinearMipmapNearestFilter:function(){return ex},LinearSRGBColorSpace:function(){return tB},LinearToneMapping:function(){return er},Loader:function(){return cn},LoaderUtils:function(){return cP},LoadingManager:function(){return ci},LoopOnce:function(){return tv},LoopPingPong:function(){return tb},LoopRepeat:function(){return ty},LuminanceAlphaFormat:function(){return ez},LuminanceFormat:function(){return eV},MOUSE:function(){return u},Material:function(){return ns},MaterialLoader:function(){return cD},MathUtils:function(){return ik},Matrix3:function(){return iP},Matrix4:function(){return rL},MaxEquation:function(){return D},Mesh:function(){return n2},MeshBasicMaterial:function(){return nf},MeshDepthMaterial:function(){return oo},MeshDistanceMaterial:function(){return ol},MeshLambertMaterial:function(){return uj},MeshMatcapMaterial:function(){return uH},MeshNormalMaterial:function(){return uz},MeshPhongMaterial:function(){return uB},MeshPhysicalMaterial:function(){return uF},MeshStandardMaterial:function(){return uU},MeshToonMaterial:function(){return uV},MinEquation:function(){return k},MirroredRepeatWrapping:function(){return eg},MixOperation:function(){return ee},MultiplyBlending:function(){return M},MultiplyOperation:function(){return Q},NearestFilter:function(){return ev},NearestMipMapLinearFilter:function(){return eE},NearestMipMapNearestFilter:function(){return eb},NearestMipmapLinearFilter:function(){return e_},NearestMipmapNearestFilter:function(){return ey},NeverCompare:function(){return t5},NeverDepth:function(){return W},NeverStencilFunc:function(){return tX},NoBlending:function(){return x},NoColorSpace:function(){return tU},NoToneMapping:function(){return ei},NormalAnimationBlendMode:function(){return tA},NormalBlending:function(){return T},NotEqualCompare:function(){return t9},NotEqualDepth:function(){return J},NotEqualStencilFunc:function(){return t1},NumberKeyframeTrack:function(){return u4},Object3D:function(){return r2},ObjectLoader:function(){return cU},ObjectSpaceNormalMap:function(){return tN},OctahedronGeometry:function(){return uT},OneFactor:function(){return O},OneMinusDstAlphaFactor:function(){return z},OneMinusDstColorFactor:function(){return H},OneMinusSrcAlphaFactor:function(){return B},OneMinusSrcColorFactor:function(){return U},OrthographicCamera:function(){return aw},PCFShadowMap:function(){return g},PCFSoftShadowMap:function(){return v},PMREMGenerator:function(){return aD},Path:function(){return lJ},PerspectiveCamera:function(){return at},Plane:function(){return al},PlaneGeometry:function(){return ap},PlaneHelper:function(){return d2},PointLight:function(){return cA},PointLightHelper:function(){return dF},Points:function(){return lx},PointsMaterial:function(){return ly},PolarGridHelper:function(){return dG},PolyhedronGeometry:function(){return l5},PositionalAudio:function(){return c7},PropertyBinding:function(){return dh},PropertyMixer:function(){return de},QuadraticBezierCurve:function(){return lq},QuadraticBezierCurve3:function(){return lY},Quaternion:function(){return re},QuaternionKeyframeTrack:function(){return u8},QuaternionLinearInterpolant:function(){return u6},RED_GREEN_RGTC2_Format:function(){return tm},RED_RGTC1_Format:function(){return tf},REVISION:function(){return l},RGBADepthPacking:function(){return tP},RGBAFormat:function(){return eB},RGBAIntegerFormat:function(){return eY},RGBA_ASTC_10x10_Format:function(){return to},RGBA_ASTC_10x5_Format:function(){return tn},RGBA_ASTC_10x6_Format:function(){return ta},RGBA_ASTC_10x8_Format:function(){return ts},RGBA_ASTC_12x10_Format:function(){return tl},RGBA_ASTC_12x12_Format:function(){return tu},RGBA_ASTC_4x4_Format:function(){return e6},RGBA_ASTC_5x4_Format:function(){return e8},RGBA_ASTC_5x5_Format:function(){return e7},RGBA_ASTC_6x5_Format:function(){return e9},RGBA_ASTC_6x6_Format:function(){return te},RGBA_ASTC_8x5_Format:function(){return tt},RGBA_ASTC_8x6_Format:function(){return ti},RGBA_ASTC_8x8_Format:function(){return tr},RGBA_BPTC_Format:function(){return tc},RGBA_ETC2_EAC_Format:function(){return e4},RGBA_PVRTC_2BPPV1_Format:function(){return e2},RGBA_PVRTC_4BPPV1_Format:function(){return e1},RGBA_S3TC_DXT1_Format:function(){return eX},RGBA_S3TC_DXT3_Format:function(){return eZ},RGBA_S3TC_DXT5_Format:function(){return eJ},RGB_BPTC_SIGNED_Format:function(){return td},RGB_BPTC_UNSIGNED_Format:function(){return th},RGB_ETC1_Format:function(){return e3},RGB_ETC2_Format:function(){return e5},RGB_PVRTC_2BPPV1_Format:function(){return e0},RGB_PVRTC_4BPPV1_Format:function(){return eQ},RGB_S3TC_DXT1_Format:function(){return eK},RGFormat:function(){return e$},RGIntegerFormat:function(){return eq},RawShaderMaterial:function(){return uN},Ray:function(){return rI},Raycaster:function(){return dS},RectAreaLight:function(){return cI},RedFormat:function(){return eG},RedIntegerFormat:function(){return eW},ReinhardToneMapping:function(){return en},RenderTarget:function(){return i3},RepeatWrapping:function(){return ep},ReplaceStencilOp:function(){return tG},ReverseSubtractEquation:function(){return L},RingGeometry:function(){return uw},SIGNED_RED_GREEN_RGTC2_Format:function(){return tg},SIGNED_RED_RGTC1_Format:function(){return tp},SRGBColorSpace:function(){return tF},Scene:function(){return ow},ShaderChunk:function(){return am},ShaderLib:function(){return av},ShaderMaterial:function(){return n9},ShadowMaterial:function(){return uO},Shape:function(){return ut},ShapeGeometry:function(){return uA},ShapePath:function(){return d6},ShapeUtils:function(){return uy},ShortType:function(){return eC},Skeleton:function(){return o8},SkeletonHelper:function(){return dU},SkinnedMesh:function(){return o2},Source:function(){return iJ},Sphere:function(){return rS},SphereGeometry:function(){return uM},Spherical:function(){return dw},SphericalHarmonics3:function(){return cL},SplineCurve:function(){return lK},SpotLight:function(){return cE},SpotLightHelper:function(){return dD},Sprite:function(){return oj},SpriteMaterial:function(){return oC},SrcAlphaFactor:function(){return F},SrcAlphaSaturateFactor:function(){return G},SrcColorFactor:function(){return N},StaticCopyUsage:function(){return iu},StaticDrawUsage:function(){return ii},StaticReadUsage:function(){return is},StereoCamera:function(){return cK},StreamCopyUsage:function(){return id},StreamDrawUsage:function(){return ia},StreamReadUsage:function(){return il},StringKeyframeTrack:function(){return u7},SubtractEquation:function(){return I},SubtractiveBlending:function(){return A},TOUCH:function(){return c},TangentSpaceNormalMap:function(){return tO},TetrahedronGeometry:function(){return uR},Texture:function(){return i1},TextureLoader:function(){return cf},TorusGeometry:function(){return uC},TorusKnotGeometry:function(){return uI},Triangle:function(){return nn},TriangleFanDrawMode:function(){return tI},TriangleStripDrawMode:function(){return tC},TrianglesDrawMode:function(){return tR},TubeGeometry:function(){return uL},TwoPassDoubleSide:function(){return S},UVMapping:function(){return el},Uint16BufferAttribute:function(){return nw},Uint32BufferAttribute:function(){return nM},Uint8BufferAttribute:function(){return nS},Uint8ClampedBufferAttribute:function(){return nx},Uniform:function(){return dv},UniformsGroup:function(){return db},UniformsLib:function(){return ag},UniformsUtils:function(){return n7},UnsignedByteType:function(){return eM},UnsignedInt248Type:function(){return eU},UnsignedIntType:function(){return ek},UnsignedShort4444Type:function(){return eO},UnsignedShort5551Type:function(){return eN},UnsignedShortType:function(){return eI},VSMShadowMap:function(){return y},Vector2:function(){return iD},Vector3:function(){return rt},Vector4:function(){return i2},VectorKeyframeTrack:function(){return u9},VideoTexture:function(){return lw},WebGL1Renderer:function(){return oS},WebGL3DRenderTarget:function(){return i7},WebGLArrayRenderTarget:function(){return i6},WebGLCoordinateSystem:function(){return ig},WebGLCubeRenderTarget:function(){return an},WebGLMultipleRenderTargets:function(){return i9},WebGLRenderTarget:function(){return i5},WebGLRenderer:function(){return oE},WebGLUtils:function(){return oh},WebGPUCoordinateSystem:function(){return iv},WireframeGeometry:function(){return uk},WrapAroundEnding:function(){return tw},ZeroCurvatureEnding:function(){return tx},ZeroFactor:function(){return P},ZeroSlopeEnding:function(){return tT},ZeroStencilOp:function(){return tj},_SRGBAFormat:function(){return im},createCanvasElement:function(){return iV},sRGBEncoding:function(){return tk}});/**
 * @license
 * Copyright 2010-2023 Three.js Authors
 * SPDX-License-Identifier: MIT
 */let l="156",u={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},c={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},d=0,h=1,f=2,p=3,m=0,g=1,v=2,y=3,b=0,_=1,E=2,S=2,x=0,T=1,w=2,A=3,M=4,R=5,C=100,I=101,L=102,k=103,D=104,P=200,O=201,N=202,U=203,F=204,B=205,V=206,z=207,j=208,H=209,G=210,W=0,$=1,q=2,Y=3,K=4,X=5,Z=6,J=7,Q=0,ee=1,et=2,ei=0,er=1,en=2,ea=3,es=4,eo=5,el=300,eu=301,ec=302,ed=303,eh=304,ef=306,ep=1e3,em=1001,eg=1002,ev=1003,ey=1004,eb=1004,e_=1005,eE=1005,eS=1006,ex=1007,eT=1007,ew=1008,eA=1008,eM=1009,eR=1010,eC=1011,eI=1012,eL=1013,ek=1014,eD=1015,eP=1016,eO=1017,eN=1018,eU=1020,eF=1021,eB=1023,eV=1024,ez=1025,ej=1026,eH=1027,eG=1028,eW=1029,e$=1030,eq=1031,eY=1033,eK=33776,eX=33777,eZ=33778,eJ=33779,eQ=35840,e0=35841,e1=35842,e2=35843,e3=36196,e5=37492,e4=37496,e6=37808,e8=37809,e7=37810,e9=37811,te=37812,tt=37813,ti=37814,tr=37815,tn=37816,ta=37817,ts=37818,to=37819,tl=37820,tu=37821,tc=36492,td=36494,th=36495,tf=36283,tp=36284,tm=36285,tg=36286,tv=2200,ty=2201,tb=2202,t_=2300,tE=2301,tS=2302,tx=2400,tT=2401,tw=2402,tA=2500,tM=2501,tR=0,tC=1,tI=2,tL=3e3,tk=3001,tD=3200,tP=3201,tO=0,tN=1,tU="",tF="srgb",tB="srgb-linear",tV="display-p3",tz="display-p3-linear",tj=0,tH=7680,tG=7681,tW=7682,t$=7683,tq=34055,tY=34056,tK=5386,tX=512,tZ=513,tJ=514,tQ=515,t0=516,t1=517,t2=518,t3=519,t5=512,t4=513,t6=514,t8=515,t7=516,t9=517,ie=518,it=519,ii=35044,ir=35048,ia=35040,is=35045,io=35049,il=35041,iu=35046,ic=35050,id=35042,ih="100",ip="300 es",im=1035,ig=2e3,iv=2001;class iy{addEventListener(e,t){void 0===this._listeners&&(this._listeners={});let i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){if(void 0===this._listeners)return!1;let i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){if(void 0===this._listeners)return;let i=this._listeners,r=i[e];if(void 0!==r){let e=r.indexOf(t);-1!==e&&r.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;let t=this._listeners,i=t[e.type];if(void 0!==i){e.target=this;let t=i.slice(0);for(let i=0,r=t.length;i<r;i++)t[i].call(this,e);e.target=null}}}let ib=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],i_=1234567,iE=Math.PI/180,iS=180/Math.PI;function ix(){let e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=ib[255&e]+ib[e>>8&255]+ib[e>>16&255]+ib[e>>24&255]+"-"+ib[255&t]+ib[t>>8&255]+"-"+ib[t>>16&15|64]+ib[t>>24&255]+"-"+ib[63&i|128]+ib[i>>8&255]+"-"+ib[i>>16&255]+ib[i>>24&255]+ib[255&r]+ib[r>>8&255]+ib[r>>16&255]+ib[r>>24&255];return n.toLowerCase()}function iT(e,t,i){return Math.max(t,Math.min(i,e))}function iw(e,t){return(e%t+t)%t}function iA(e,t,i){return(1-i)*e+i*t}function iM(e){return(e&e-1)==0&&0!==e}function iR(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))}function iC(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function iI(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw Error("Invalid component type.")}}function iL(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw Error("Invalid component type.")}}let ik={DEG2RAD:iE,RAD2DEG:iS,generateUUID:ix,clamp:iT,euclideanModulo:iw,mapLinear:function(e,t,i,r,n){return r+(e-t)*(n-r)/(i-t)},inverseLerp:function(e,t,i){return e!==t?(i-e)/(t-e):0},lerp:iA,damp:function(e,t,i,r){return iA(e,t,1-Math.exp(-i*r))},pingpong:function(e,t=1){return t-Math.abs(iw(e,2*t)-t)},smoothstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*(3-2*e)},smootherstep:function(e,t,i){return e<=t?0:e>=i?1:(e=(e-t)/(i-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){void 0!==e&&(i_=e);let t=i_+=1831565813;return t=Math.imul(t^t>>>15,1|t),(((t^=t+Math.imul(t^t>>>7,61|t))^t>>>14)>>>0)/4294967296},degToRad:function(e){return e*iE},radToDeg:function(e){return e*iS},isPowerOfTwo:iM,ceilPowerOfTwo:iR,floorPowerOfTwo:iC,setQuaternionFromProperEuler:function(e,t,i,r,n){let a=Math.cos,s=Math.sin,o=a(i/2),l=s(i/2),u=a((t+r)/2),c=s((t+r)/2),d=a((t-r)/2),h=s((t-r)/2),f=a((r-t)/2),p=s((r-t)/2);switch(n){case"XYX":e.set(o*c,l*d,l*h,o*u);break;case"YZY":e.set(l*h,o*c,l*d,o*u);break;case"ZXZ":e.set(l*d,l*h,o*c,o*u);break;case"XZX":e.set(o*c,l*p,l*f,o*u);break;case"YXY":e.set(l*f,o*c,l*p,o*u);break;case"ZYZ":e.set(l*p,l*f,o*c,o*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+n)}},normalize:iL,denormalize:iI};class iD{constructor(e=0,t=0){iD.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let t=this.x,i=this.y,r=e.elements;return this.x=r[0]*t+r[3]*i+r[6],this.y=r[1]*t+r[4]*i+r[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){let e=Math.atan2(-this.y,-this.x)+Math.PI;return e}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(iT(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y;return t*t+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){let i=Math.cos(t),r=Math.sin(t),n=this.x-e.x,a=this.y-e.y;return this.x=n*i-a*r+e.x,this.y=n*r+a*i+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class iP{constructor(e,t,i,r,n,a,s,o,l){iP.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==e&&this.set(e,t,i,r,n,a,s,o,l)}set(e,t,i,r,n,a,s,o,l){let u=this.elements;return u[0]=e,u[1]=r,u[2]=s,u[3]=t,u[4]=n,u[5]=o,u[6]=i,u[7]=a,u[8]=l,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],this}extractBasis(e,t,i){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,r=t.elements,n=this.elements,a=i[0],s=i[3],o=i[6],l=i[1],u=i[4],c=i[7],d=i[2],h=i[5],f=i[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],b=r[7],_=r[2],E=r[5],S=r[8];return n[0]=a*p+s*v+o*_,n[3]=a*m+s*y+o*E,n[6]=a*g+s*b+o*S,n[1]=l*p+u*v+c*_,n[4]=l*m+u*y+c*E,n[7]=l*g+u*b+c*S,n[2]=d*p+h*v+f*_,n[5]=d*m+h*y+f*E,n[8]=d*g+h*b+f*S,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[1],r=e[2],n=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8];return t*a*u-t*s*l-i*n*u+i*s*o+r*n*l-r*a*o}invert(){let e=this.elements,t=e[0],i=e[1],r=e[2],n=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=u*a-s*l,d=s*o-u*n,h=l*n-a*o,f=t*c+i*d+r*h;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);let p=1/f;return e[0]=c*p,e[1]=(r*l-u*i)*p,e[2]=(s*i-r*a)*p,e[3]=d*p,e[4]=(u*t-r*o)*p,e[5]=(r*n-s*t)*p,e[6]=h*p,e[7]=(i*o-l*t)*p,e[8]=(a*t-i*n)*p,this}transpose(){let e;let t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,i,r,n,a,s){let o=Math.cos(n),l=Math.sin(n);return this.set(i*o,i*l,-i*(o*a+l*s)+a+e,-r*l,r*o,-r*(-l*a+o*s)+s+t,0,0,1),this}scale(e,t){return this.premultiply(iO.makeScale(e,t)),this}rotate(e){return this.premultiply(iO.makeRotation(-e)),this}translate(e,t){return this.premultiply(iO.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,i,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){let t=this.elements,i=e.elements;for(let e=0;e<9;e++)if(t[e]!==i[e])return!1;return!0}fromArray(e,t=0){for(let i=0;i<9;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e}clone(){return new this.constructor().fromArray(this.elements)}}let iO=new iP;function iN(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}let iU={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function iF(e,t){return new iU[e](t)}function iB(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function iV(){let e=iB("canvas");return e.style.display="block",e}let iz={};function ij(e){e in iz||(iz[e]=!0,console.warn(e))}function iH(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function iG(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}let iW=new iP().fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-.0000001,1e-7,.9105199]),i$=new iP().fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]),iq={[tB]:e=>e,[tF]:e=>e.convertSRGBToLinear(),[tV]:function(e){return e.convertSRGBToLinear().applyMatrix3(i$)}},iY={[tB]:e=>e,[tF]:e=>e.convertLinearToSRGB(),[tV]:function(e){return e.applyMatrix3(iW).convertLinearToSRGB()}},iK={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(legacyMode){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!legacyMode},get workingColorSpace(){return tB},set workingColorSpace(colorSpace){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,i){if(!1===this.enabled||t===i||!t||!i)return e;let r=iq[t],n=iY[i];if(void 0===r||void 0===n)throw Error(`Unsupported color space conversion, "${t}" to "${i}".`);return n(r(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}};class iX{static getDataURL(e){let t;if(/^data:/i.test(e.src)||"undefined"==typeof HTMLCanvasElement)return e.src;if(e instanceof HTMLCanvasElement)t=e;else{void 0===r&&(r=iB("canvas")),r.width=e.width,r.height=e.height;let i=r.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),t=r}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}static sRGBToLinear(e){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){let t=iB("canvas");t.width=e.width,t.height=e.height;let i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height);let r=i.getImageData(0,0,e.width,e.height),n=r.data;for(let e=0;e<n.length;e++)n[e]=255*iH(n[e]/255);return i.putImageData(r,0,0),t}if(!e.data)return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e;{let t=e.data.slice(0);for(let e=0;e<t.length;e++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[e]=Math.floor(255*iH(t[e]/255)):t[e]=iH(t[e]);return{data:t,width:e.width,height:e.height}}}}let iZ=0;class iJ{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:iZ++}),this.uuid=ix(),this.data=e,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];let i={uuid:this.uuid,url:""},r=this.data;if(null!==r){let e;if(Array.isArray(r)){e=[];for(let t=0,i=r.length;t<i;t++)r[t].isDataTexture?e.push(iQ(r[t].image)):e.push(iQ(r[t]))}else e=iQ(r);i.url=e}return t||(e.images[this.uuid]=i),i}}function iQ(e){return"undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap?iX.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let i0=0;class i1 extends iy{constructor(e=i1.DEFAULT_IMAGE,t=i1.DEFAULT_MAPPING,i=em,r=em,n=eS,a=ew,s=eB,o=eM,l=i1.DEFAULT_ANISOTROPY,u=tU){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:i0++}),this.uuid=ix(),this.name="",this.source=new iJ(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=i,this.wrapT=r,this.magFilter=n,this.minFilter=a,this.anisotropy=l,this.format=s,this.internalFormat=null,this.type=o,this.offset=new iD(0,0),this.repeat=new iD(1,1),this.center=new iD(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new iP,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,"string"==typeof u?this.colorSpace=u:(ij("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=u===tk?tF:tU),this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let t=void 0===e||"string"==typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];let i={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(i.userData=this.userData),t||(e.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==el)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case ep:e.x=e.x-Math.floor(e.x);break;case em:e.x=e.x<0?0:1;break;case eg:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case ep:e.y=e.y-Math.floor(e.y);break;case em:e.y=e.y<0?0:1;break;case eg:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}get encoding(){return ij("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace===tF?tk:tL}set encoding(e){ij("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=e===tk?tF:tU}}i1.DEFAULT_IMAGE=null,i1.DEFAULT_MAPPING=el,i1.DEFAULT_ANISOTROPY=1;class i2{constructor(e=0,t=0,i=0,r=1){i2.prototype.isVector4=!0,this.x=e,this.y=t,this.z=i,this.w=r}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,i,r){return this.x=e,this.y=t,this.z=i,this.w=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let t=this.x,i=this.y,r=this.z,n=this.w,a=e.elements;return this.x=a[0]*t+a[4]*i+a[8]*r+a[12]*n,this.y=a[1]*t+a[5]*i+a[9]*r+a[13]*n,this.z=a[2]*t+a[6]*i+a[10]*r+a[14]*n,this.w=a[3]*t+a[7]*i+a[11]*r+a[15]*n,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,i,r;let n=e.elements,a=n[0],s=n[4],o=n[8],l=n[1],u=n[5],c=n[9],d=n[2],h=n[6],f=n[10];if(.01>Math.abs(s-l)&&.01>Math.abs(o-d)&&.01>Math.abs(c-h)){if(.1>Math.abs(s+l)&&.1>Math.abs(o+d)&&.1>Math.abs(c+h)&&.1>Math.abs(a+u+f-3))return this.set(1,0,0,0),this;let e=(a+1)/2,n=(u+1)/2,p=(f+1)/2,m=(s+l)/4,g=(o+d)/4,v=(c+h)/4;return e>n&&e>p?e<.01?(t=0,i=.707106781,r=.707106781):(i=m/(t=Math.sqrt(e)),r=g/t):n>p?n<.01?(t=.707106781,i=0,r=.707106781):(t=m/(i=Math.sqrt(n)),r=v/i):p<.01?(t=.707106781,i=.707106781,r=0):(t=g/(r=Math.sqrt(p)),i=v/r),this.set(t,i,r,Math.PI),this}let p=Math.sqrt((h-c)*(h-c)+(o-d)*(o-d)+(l-s)*(l-s));return .001>Math.abs(p)&&(p=1),this.x=(h-c)/p,this.y=(o-d)/p,this.z=(l-s)/p,this.w=Math.acos((a+u+f-1)/2),this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this.w=e.w+(t.w-e.w)*i,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class i3 extends iy{constructor(e=1,t=1,i={}){super(),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=1,this.scissor=new i2(0,0,e,t),this.scissorTest=!1,this.viewport=new i2(0,0,e,t),void 0!==i.encoding&&(ij("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),i.colorSpace=i.encoding===tk?tF:tU),this.texture=new i1({width:e,height:t,depth:1},i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==i.generateMipmaps&&i.generateMipmaps,this.texture.internalFormat=void 0!==i.internalFormat?i.internalFormat:null,this.texture.minFilter=void 0!==i.minFilter?i.minFilter:eS,this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0!==i.stencilBuffer&&i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null,this.samples=void 0!==i.samples?i.samples:0}setSize(e,t,i=1){(this.width!==e||this.height!==t||this.depth!==i)&&(this.width=e,this.height=t,this.depth=i,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;let t=Object.assign({},e.texture.image);return this.texture.source=new iJ(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class i5 extends i3{constructor(e=1,t=1,i={}){super(e,t,i),this.isWebGLRenderTarget=!0}}class i4 extends i1{constructor(e=null,t=1,i=1,r=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ev,this.minFilter=ev,this.wrapR=em,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class i6 extends i5{constructor(e=1,t=1,i=1){super(e,t),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new i4(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class i8 extends i1{constructor(e=null,t=1,i=1,r=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:i,depth:r},this.magFilter=ev,this.minFilter=ev,this.wrapR=em,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class i7 extends i5{constructor(e=1,t=1,i=1){super(e,t),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new i8(null,e,t,i),this.texture.isRenderTargetTexture=!0}}class i9 extends i5{constructor(e=1,t=1,i=1,r={}){super(e,t,r),this.isWebGLMultipleRenderTargets=!0;let n=this.texture;this.texture=[];for(let e=0;e<i;e++)this.texture[e]=n.clone(),this.texture[e].isRenderTargetTexture=!0}setSize(e,t,i=1){if(this.width!==e||this.height!==t||this.depth!==i){this.width=e,this.height=t,this.depth=i;for(let r=0,n=this.texture.length;r<n;r++)this.texture[r].image.width=e,this.texture[r].image.height=t,this.texture[r].image.depth=i;this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}copy(e){this.dispose(),this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.texture.length=0;for(let t=0,i=e.texture.length;t<i;t++)this.texture[t]=e.texture[t].clone(),this.texture[t].isRenderTargetTexture=!0;return this}}class re{constructor(e=0,t=0,i=0,r=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=i,this._w=r}static slerpFlat(e,t,i,r,n,a,s){let o=i[r+0],l=i[r+1],u=i[r+2],c=i[r+3],d=n[a+0],h=n[a+1],f=n[a+2],p=n[a+3];if(0===s){e[t+0]=o,e[t+1]=l,e[t+2]=u,e[t+3]=c;return}if(1===s){e[t+0]=d,e[t+1]=h,e[t+2]=f,e[t+3]=p;return}if(c!==p||o!==d||l!==h||u!==f){let e=1-s,t=o*d+l*h+u*f+c*p,i=t>=0?1:-1,r=1-t*t;if(r>Number.EPSILON){let n=Math.sqrt(r),a=Math.atan2(n,t*i);e=Math.sin(e*a)/n,s=Math.sin(s*a)/n}let n=s*i;if(o=o*e+d*n,l=l*e+h*n,u=u*e+f*n,c=c*e+p*n,e===1-s){let e=1/Math.sqrt(o*o+l*l+u*u+c*c);o*=e,l*=e,u*=e,c*=e}}e[t]=o,e[t+1]=l,e[t+2]=u,e[t+3]=c}static multiplyQuaternionsFlat(e,t,i,r,n,a){let s=i[r],o=i[r+1],l=i[r+2],u=i[r+3],c=n[a],d=n[a+1],h=n[a+2],f=n[a+3];return e[t]=s*f+u*c+o*h-l*d,e[t+1]=o*f+u*d+l*c-s*h,e[t+2]=l*f+u*h+s*d-o*c,e[t+3]=u*f-s*c-o*d-l*h,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,i,r){return this._x=e,this._y=t,this._z=i,this._w=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t){let i=e._x,r=e._y,n=e._z,a=e._order,s=Math.cos,o=Math.sin,l=s(i/2),u=s(r/2),c=s(n/2),d=o(i/2),h=o(r/2),f=o(n/2);switch(a){case"XYZ":this._x=d*u*c+l*h*f,this._y=l*h*c-d*u*f,this._z=l*u*f+d*h*c,this._w=l*u*c-d*h*f;break;case"YXZ":this._x=d*u*c+l*h*f,this._y=l*h*c-d*u*f,this._z=l*u*f-d*h*c,this._w=l*u*c+d*h*f;break;case"ZXY":this._x=d*u*c-l*h*f,this._y=l*h*c+d*u*f,this._z=l*u*f+d*h*c,this._w=l*u*c-d*h*f;break;case"ZYX":this._x=d*u*c-l*h*f,this._y=l*h*c+d*u*f,this._z=l*u*f-d*h*c,this._w=l*u*c+d*h*f;break;case"YZX":this._x=d*u*c+l*h*f,this._y=l*h*c+d*u*f,this._z=l*u*f-d*h*c,this._w=l*u*c-d*h*f;break;case"XZY":this._x=d*u*c-l*h*f,this._y=l*h*c-d*u*f,this._z=l*u*f+d*h*c,this._w=l*u*c+d*h*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!1!==t&&this._onChangeCallback(),this}setFromAxisAngle(e,t){let i=t/2,r=Math.sin(i);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(e){let t=e.elements,i=t[0],r=t[4],n=t[8],a=t[1],s=t[5],o=t[9],l=t[2],u=t[6],c=t[10],d=i+s+c;if(d>0){let e=.5/Math.sqrt(d+1);this._w=.25/e,this._x=(u-o)*e,this._y=(n-l)*e,this._z=(a-r)*e}else if(i>s&&i>c){let e=2*Math.sqrt(1+i-s-c);this._w=(u-o)/e,this._x=.25*e,this._y=(r+a)/e,this._z=(n+l)/e}else if(s>c){let e=2*Math.sqrt(1+s-i-c);this._w=(n-l)/e,this._x=(r+a)/e,this._y=.25*e,this._z=(o+u)/e}else{let e=2*Math.sqrt(1+c-i-s);this._w=(a-r)/e,this._x=(n+l)/e,this._y=(o+u)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let i=e.dot(t)+1;return i<Number.EPSILON?(i=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x),this._w=i,this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(iT(this.dot(e),-1,1)))}rotateTowards(e,t){let i=this.angleTo(e);return 0===i||this.slerp(e,Math.min(1,t/i)),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){let i=e._x,r=e._y,n=e._z,a=e._w,s=t._x,o=t._y,l=t._z,u=t._w;return this._x=i*u+a*s+r*l-n*o,this._y=r*u+a*o+n*s-i*l,this._z=n*u+a*l+i*o-r*s,this._w=a*u-i*s-r*o-n*l,this._onChangeCallback(),this}slerp(e,t){if(0===t)return this;if(1===t)return this.copy(e);let i=this._x,r=this._y,n=this._z,a=this._w,s=a*e._w+i*e._x+r*e._y+n*e._z;if(s<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,s=-s):this.copy(e),s>=1)return this._w=a,this._x=i,this._y=r,this._z=n,this;let o=1-s*s;if(o<=Number.EPSILON){let e=1-t;return this._w=e*a+t*this._w,this._x=e*i+t*this._x,this._y=e*r+t*this._y,this._z=e*n+t*this._z,this.normalize(),this._onChangeCallback(),this}let l=Math.sqrt(o),u=Math.atan2(l,s),c=Math.sin((1-t)*u)/l,d=Math.sin(t*u)/l;return this._w=a*c+this._w*d,this._x=i*c+this._x*d,this._y=r*c+this._y*d,this._z=n*c+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,t,i){return this.copy(e).slerp(t,i)}random(){let e=Math.random(),t=Math.sqrt(1-e),i=Math.sqrt(e),r=2*Math.PI*Math.random(),n=2*Math.PI*Math.random();return this.set(t*Math.cos(r),i*Math.sin(n),i*Math.cos(n),t*Math.sin(r))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class rt{constructor(e=0,t=0,i=0){rt.prototype.isVector3=!0,this.x=e,this.y=t,this.z=i}set(e,t,i){return void 0===i&&(i=this.z),this.x=e,this.y=t,this.z=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(rr.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(rr.setFromAxisAngle(e,t))}applyMatrix3(e){let t=this.x,i=this.y,r=this.z,n=e.elements;return this.x=n[0]*t+n[3]*i+n[6]*r,this.y=n[1]*t+n[4]*i+n[7]*r,this.z=n[2]*t+n[5]*i+n[8]*r,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let t=this.x,i=this.y,r=this.z,n=e.elements,a=1/(n[3]*t+n[7]*i+n[11]*r+n[15]);return this.x=(n[0]*t+n[4]*i+n[8]*r+n[12])*a,this.y=(n[1]*t+n[5]*i+n[9]*r+n[13])*a,this.z=(n[2]*t+n[6]*i+n[10]*r+n[14])*a,this}applyQuaternion(e){let t=this.x,i=this.y,r=this.z,n=e.x,a=e.y,s=e.z,o=e.w,l=o*t+a*r-s*i,u=o*i+s*t-n*r,c=o*r+n*i-a*t,d=-n*t-a*i-s*r;return this.x=l*o+-(d*n)+-(u*s)- -(c*a),this.y=u*o+-(d*a)+-(c*n)- -(l*s),this.z=c*o+-(d*s)+-(l*a)- -(u*n),this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let t=this.x,i=this.y,r=this.z,n=e.elements;return this.x=n[0]*t+n[4]*i+n[8]*r,this.y=n[1]*t+n[5]*i+n[9]*r,this.z=n[2]*t+n[6]*i+n[10]*r,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}clampScalar(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}clampLength(e,t){let i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(e,Math.min(t,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,i){return this.x=e.x+(t.x-e.x)*i,this.y=e.y+(t.y-e.y)*i,this.z=e.z+(t.z-e.z)*i,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){let i=e.x,r=e.y,n=e.z,a=t.x,s=t.y,o=t.z;return this.x=r*o-n*s,this.y=n*a-i*o,this.z=i*s-r*a,this}projectOnVector(e){let t=e.lengthSq();if(0===t)return this.set(0,0,0);let i=e.dot(this)/t;return this.copy(e).multiplyScalar(i)}projectOnPlane(e){return ri.copy(this).projectOnVector(e),this.sub(ri)}reflect(e){return this.sub(ri.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;let i=this.dot(e)/t;return Math.acos(iT(i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let t=this.x-e.x,i=this.y-e.y,r=this.z-e.z;return t*t+i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,i){let r=Math.sin(t)*e;return this.x=r*Math.sin(i),this.y=Math.cos(t)*e,this.z=r*Math.cos(i),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,i){return this.x=e*Math.sin(t),this.y=i,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){let t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){let t=this.setFromMatrixColumn(e,0).length(),i=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=i,this.z=r,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,4*t)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,3*t)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=(Math.random()-.5)*2,t=Math.random()*Math.PI*2,i=Math.sqrt(1-e**2);return this.x=i*Math.cos(t),this.y=i*Math.sin(t),this.z=e,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}let ri=new rt,rr=new re;class rn{constructor(e=new rt(Infinity,Infinity,Infinity),t=new rt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t+=3)this.expandByPoint(rs.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,i=e.count;t<i;t++)this.expandByPoint(rs.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=rs.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=Infinity,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),ro.copy(e.boundingBox),ro.applyMatrix4(e.matrixWorld),this.union(ro);else{let i=e.geometry;if(void 0!==i){if(t&&void 0!==i.attributes&&void 0!==i.attributes.position){let t=i.attributes.position;for(let i=0,r=t.count;i<r;i++)rs.fromBufferAttribute(t,i).applyMatrix4(e.matrixWorld),this.expandByPoint(rs)}else null===i.boundingBox&&i.computeBoundingBox(),ro.copy(i.boundingBox),ro.applyMatrix4(e.matrixWorld),this.union(ro)}}let i=e.children;for(let e=0,r=i.length;e<r;e++)this.expandByObject(i[e],t);return this}containsPoint(e){return!(e.x<this.min.x)&&!(e.x>this.max.x)&&!(e.y<this.min.y)&&!(e.y>this.max.y)&&!(e.z<this.min.z)&&!(e.z>this.max.z)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return!(e.max.x<this.min.x)&&!(e.min.x>this.max.x)&&!(e.max.y<this.min.y)&&!(e.min.y>this.max.y)&&!(e.max.z<this.min.z)&&!(e.min.z>this.max.z)}intersectsSphere(e){return this.clampPoint(e.center,rs),rs.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,i;return e.normal.x>0?(t=e.normal.x*this.min.x,i=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,i=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,i+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,i+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,i+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,i+=e.normal.z*this.min.z),t<=-e.constant&&i>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(rp),rm.subVectors(this.max,rp),rl.subVectors(e.a,rp),ru.subVectors(e.b,rp),rc.subVectors(e.c,rp),rd.subVectors(ru,rl),rh.subVectors(rc,ru),rf.subVectors(rl,rc);let t=[0,-rd.z,rd.y,0,-rh.z,rh.y,0,-rf.z,rf.y,rd.z,0,-rd.x,rh.z,0,-rh.x,rf.z,0,-rf.x,-rd.y,rd.x,0,-rh.y,rh.x,0,-rf.y,rf.x,0];return!!(ry(t,rl,ru,rc,rm)&&ry(t=[1,0,0,0,1,0,0,0,1],rl,ru,rc,rm))&&(rg.crossVectors(rd,rh),ry(t=[rg.x,rg.y,rg.z],rl,ru,rc,rm))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,rs).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(rs).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(ra[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ra[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ra[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ra[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ra[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ra[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ra[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ra[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ra)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}let ra=[new rt,new rt,new rt,new rt,new rt,new rt,new rt,new rt],rs=new rt,ro=new rn,rl=new rt,ru=new rt,rc=new rt,rd=new rt,rh=new rt,rf=new rt,rp=new rt,rm=new rt,rg=new rt,rv=new rt;function ry(e,t,i,r,n){for(let a=0,s=e.length-3;a<=s;a+=3){rv.fromArray(e,a);let s=n.x*Math.abs(rv.x)+n.y*Math.abs(rv.y)+n.z*Math.abs(rv.z),o=t.dot(rv),l=i.dot(rv),u=r.dot(rv);if(Math.max(-Math.max(o,l,u),Math.min(o,l,u))>s)return!1}return!0}let rb=new rn,r_=new rt,rE=new rt;class rS{constructor(e=new rt,t=-1){this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){let i=this.center;void 0!==t?i.copy(t):rb.setFromPoints(e).getCenter(i);let r=0;for(let t=0,n=e.length;t<n;t++)r=Math.max(r,i.distanceToSquared(e[t]));return this.radius=Math.sqrt(r),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){let i=this.center.distanceToSquared(e);return t.copy(e),i>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?e.makeEmpty():(e.set(this.center,this.center),e.expandByScalar(this.radius)),e}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;r_.subVectors(e,this.center);let t=r_.lengthSq();if(t>this.radius*this.radius){let e=Math.sqrt(t),i=(e-this.radius)*.5;this.center.addScaledVector(r_,i/e),this.radius+=i}return this}union(e){return e.isEmpty()||(this.isEmpty()?this.copy(e):!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(rE.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(r_.copy(e.center).add(rE)),this.expandByPoint(r_.copy(e.center).sub(rE)))),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}}let rx=new rt,rT=new rt,rw=new rt,rA=new rt,rM=new rt,rR=new rt,rC=new rt;class rI{constructor(e=new rt,t=new rt(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,rx)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);let i=t.dot(this.direction);return i<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,i)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let t=rx.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(rx.copy(this.origin).addScaledVector(this.direction,t),rx.distanceToSquared(e))}distanceSqToSegment(e,t,i,r){let n,a,s,o;rT.copy(e).add(t).multiplyScalar(.5),rw.copy(t).sub(e).normalize(),rA.copy(this.origin).sub(rT);let l=.5*e.distanceTo(t),u=-this.direction.dot(rw),c=rA.dot(this.direction),d=-rA.dot(rw),h=rA.lengthSq(),f=Math.abs(1-u*u);if(f>0){if(n=u*d-c,a=u*c-d,o=l*f,n>=0){if(a>=-o){if(a<=o){let e=1/f;n*=e,a*=e,s=n*(n+u*a+2*c)+a*(u*n+a+2*d)+h}else s=-(n=Math.max(0,-(u*(a=l)+c)))*n+a*(a+2*d)+h}else s=-(n=Math.max(0,-(u*(a=-l)+c)))*n+a*(a+2*d)+h}else a<=-o?(a=(n=Math.max(0,-(-u*l+c)))>0?-l:Math.min(Math.max(-l,-d),l),s=-n*n+a*(a+2*d)+h):a<=o?(n=0,s=(a=Math.min(Math.max(-l,-d),l))*(a+2*d)+h):(a=(n=Math.max(0,-(u*l+c)))>0?l:Math.min(Math.max(-l,-d),l),s=-n*n+a*(a+2*d)+h)}else a=u>0?-l:l,s=-(n=Math.max(0,-(u*a+c)))*n+a*(a+2*d)+h;return i&&i.copy(this.origin).addScaledVector(this.direction,n),r&&r.copy(rT).addScaledVector(rw,a),s}intersectSphere(e,t){rx.subVectors(e.center,this.origin);let i=rx.dot(this.direction),r=rx.dot(rx)-i*i,n=e.radius*e.radius;if(r>n)return null;let a=Math.sqrt(n-r),s=i-a,o=i+a;return o<0?null:s<0?this.at(o,t):this.at(s,t)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;let i=-(this.origin.dot(e.normal)+e.constant)/t;return i>=0?i:null}intersectPlane(e,t){let i=this.distanceToPlane(e);return null===i?null:this.at(i,t)}intersectsPlane(e){let t=e.distanceToPoint(this.origin);if(0===t)return!0;let i=e.normal.dot(this.direction);return i*t<0}intersectBox(e,t){let i,r,n,a,s,o;let l=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,d=this.origin;return(l>=0?(i=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(i=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),u>=0?(n=(e.min.y-d.y)*u,a=(e.max.y-d.y)*u):(n=(e.max.y-d.y)*u,a=(e.min.y-d.y)*u),i>a||n>r)?null:((n>i||isNaN(i))&&(i=n),(a<r||isNaN(r))&&(r=a),c>=0?(s=(e.min.z-d.z)*c,o=(e.max.z-d.z)*c):(s=(e.max.z-d.z)*c,o=(e.min.z-d.z)*c),i>o||s>r)?null:((s>i||i!=i)&&(i=s),(o<r||r!=r)&&(r=o),r<0)?null:this.at(i>=0?i:r,t)}intersectsBox(e){return null!==this.intersectBox(e,rx)}intersectTriangle(e,t,i,r,n){let a;rM.subVectors(t,e),rR.subVectors(i,e),rC.crossVectors(rM,rR);let s=this.direction.dot(rC);if(s>0){if(r)return null;a=1}else{if(!(s<0))return null;a=-1,s=-s}rA.subVectors(this.origin,e);let o=a*this.direction.dot(rR.crossVectors(rA,rR));if(o<0)return null;let l=a*this.direction.dot(rM.cross(rA));if(l<0||o+l>s)return null;let u=-a*rA.dot(rC);return u<0?null:this.at(u/s,n)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class rL{constructor(e,t,i,r,n,a,s,o,l,u,c,d,h,f,p,m){rL.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==e&&this.set(e,t,i,r,n,a,s,o,l,u,c,d,h,f,p,m)}set(e,t,i,r,n,a,s,o,l,u,c,d,h,f,p,m){let g=this.elements;return g[0]=e,g[4]=t,g[8]=i,g[12]=r,g[1]=n,g[5]=a,g[9]=s,g[13]=o,g[2]=l,g[6]=u,g[10]=c,g[14]=d,g[3]=h,g[7]=f,g[11]=p,g[15]=m,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new rL().fromArray(this.elements)}copy(e){let t=this.elements,i=e.elements;return t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15],this}copyPosition(e){let t=this.elements,i=e.elements;return t[12]=i[12],t[13]=i[13],t[14]=i[14],this}setFromMatrix3(e){let t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,i){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(e,t,i){return this.set(e.x,t.x,i.x,0,e.y,t.y,i.y,0,e.z,t.z,i.z,0,0,0,0,1),this}extractRotation(e){let t=this.elements,i=e.elements,r=1/rk.setFromMatrixColumn(e,0).length(),n=1/rk.setFromMatrixColumn(e,1).length(),a=1/rk.setFromMatrixColumn(e,2).length();return t[0]=i[0]*r,t[1]=i[1]*r,t[2]=i[2]*r,t[3]=0,t[4]=i[4]*n,t[5]=i[5]*n,t[6]=i[6]*n,t[7]=0,t[8]=i[8]*a,t[9]=i[9]*a,t[10]=i[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){let t=this.elements,i=e.x,r=e.y,n=e.z,a=Math.cos(i),s=Math.sin(i),o=Math.cos(r),l=Math.sin(r),u=Math.cos(n),c=Math.sin(n);if("XYZ"===e.order){let e=a*u,i=a*c,r=s*u,n=s*c;t[0]=o*u,t[4]=-o*c,t[8]=l,t[1]=i+r*l,t[5]=e-n*l,t[9]=-s*o,t[2]=n-e*l,t[6]=r+i*l,t[10]=a*o}else if("YXZ"===e.order){let e=o*u,i=o*c,r=l*u,n=l*c;t[0]=e+n*s,t[4]=r*s-i,t[8]=a*l,t[1]=a*c,t[5]=a*u,t[9]=-s,t[2]=i*s-r,t[6]=n+e*s,t[10]=a*o}else if("ZXY"===e.order){let e=o*u,i=o*c,r=l*u,n=l*c;t[0]=e-n*s,t[4]=-a*c,t[8]=r+i*s,t[1]=i+r*s,t[5]=a*u,t[9]=n-e*s,t[2]=-a*l,t[6]=s,t[10]=a*o}else if("ZYX"===e.order){let e=a*u,i=a*c,r=s*u,n=s*c;t[0]=o*u,t[4]=r*l-i,t[8]=e*l+n,t[1]=o*c,t[5]=n*l+e,t[9]=i*l-r,t[2]=-l,t[6]=s*o,t[10]=a*o}else if("YZX"===e.order){let e=a*o,i=a*l,r=s*o,n=s*l;t[0]=o*u,t[4]=n-e*c,t[8]=r*c+i,t[1]=c,t[5]=a*u,t[9]=-s*u,t[2]=-l*u,t[6]=i*c+r,t[10]=e-n*c}else if("XZY"===e.order){let e=a*o,i=a*l,r=s*o,n=s*l;t[0]=o*u,t[4]=-c,t[8]=l*u,t[1]=e*c+n,t[5]=a*u,t[9]=i*c-r,t[2]=r*c-i,t[6]=s*u,t[10]=n*c+e}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(rP,e,rO)}lookAt(e,t,i){let r=this.elements;return rF.subVectors(e,t),0===rF.lengthSq()&&(rF.z=1),rF.normalize(),rN.crossVectors(i,rF),0===rN.lengthSq()&&(1===Math.abs(i.z)?rF.x+=1e-4:rF.z+=1e-4,rF.normalize(),rN.crossVectors(i,rF)),rN.normalize(),rU.crossVectors(rF,rN),r[0]=rN.x,r[4]=rU.x,r[8]=rF.x,r[1]=rN.y,r[5]=rU.y,r[9]=rF.y,r[2]=rN.z,r[6]=rU.z,r[10]=rF.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){let i=e.elements,r=t.elements,n=this.elements,a=i[0],s=i[4],o=i[8],l=i[12],u=i[1],c=i[5],d=i[9],h=i[13],f=i[2],p=i[6],m=i[10],g=i[14],v=i[3],y=i[7],b=i[11],_=i[15],E=r[0],S=r[4],x=r[8],T=r[12],w=r[1],A=r[5],M=r[9],R=r[13],C=r[2],I=r[6],L=r[10],k=r[14],D=r[3],P=r[7],O=r[11],N=r[15];return n[0]=a*E+s*w+o*C+l*D,n[4]=a*S+s*A+o*I+l*P,n[8]=a*x+s*M+o*L+l*O,n[12]=a*T+s*R+o*k+l*N,n[1]=u*E+c*w+d*C+h*D,n[5]=u*S+c*A+d*I+h*P,n[9]=u*x+c*M+d*L+h*O,n[13]=u*T+c*R+d*k+h*N,n[2]=f*E+p*w+m*C+g*D,n[6]=f*S+p*A+m*I+g*P,n[10]=f*x+p*M+m*L+g*O,n[14]=f*T+p*R+m*k+g*N,n[3]=v*E+y*w+b*C+_*D,n[7]=v*S+y*A+b*I+_*P,n[11]=v*x+y*M+b*L+_*O,n[15]=v*T+y*R+b*k+_*N,this}multiplyScalar(e){let t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){let e=this.elements,t=e[0],i=e[4],r=e[8],n=e[12],a=e[1],s=e[5],o=e[9],l=e[13],u=e[2],c=e[6],d=e[10],h=e[14],f=e[3],p=e[7],m=e[11],g=e[15];return f*(+n*o*c-r*l*c-n*s*d+i*l*d+r*s*h-i*o*h)+p*(+t*o*h-t*l*d+n*a*d-r*a*h+r*l*u-n*o*u)+m*(+t*l*c-t*s*h-n*a*c+i*a*h+n*s*u-i*l*u)+g*(-r*s*u-t*o*c+t*s*d+r*a*c-i*a*d+i*o*u)}transpose(){let e;let t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}setPosition(e,t,i){let r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=i),this}invert(){let e=this.elements,t=e[0],i=e[1],r=e[2],n=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=e[9],d=e[10],h=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=c*m*l-p*d*l+p*o*h-s*m*h-c*o*g+s*d*g,y=f*d*l-u*m*l-f*o*h+a*m*h+u*o*g-a*d*g,b=u*p*l-f*c*l+f*s*h-a*p*h-u*s*g+a*c*g,_=f*c*o-u*p*o-f*s*d+a*p*d+u*s*m-a*c*m,E=t*v+i*y+r*b+n*_;if(0===E)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let S=1/E;return e[0]=v*S,e[1]=(p*d*n-c*m*n-p*r*h+i*m*h+c*r*g-i*d*g)*S,e[2]=(s*m*n-p*o*n+p*r*l-i*m*l-s*r*g+i*o*g)*S,e[3]=(c*o*n-s*d*n-c*r*l+i*d*l+s*r*h-i*o*h)*S,e[4]=y*S,e[5]=(u*m*n-f*d*n+f*r*h-t*m*h-u*r*g+t*d*g)*S,e[6]=(f*o*n-a*m*n-f*r*l+t*m*l+a*r*g-t*o*g)*S,e[7]=(a*d*n-u*o*n+u*r*l-t*d*l-a*r*h+t*o*h)*S,e[8]=b*S,e[9]=(f*c*n-u*p*n-f*i*h+t*p*h+u*i*g-t*c*g)*S,e[10]=(a*p*n-f*s*n+f*i*l-t*p*l-a*i*g+t*s*g)*S,e[11]=(u*s*n-a*c*n-u*i*l+t*c*l+a*i*h-t*s*h)*S,e[12]=_*S,e[13]=(u*p*r-f*c*r+f*i*d-t*p*d-u*i*m+t*c*m)*S,e[14]=(f*s*r-a*p*r-f*i*o+t*p*o+a*i*m-t*s*m)*S,e[15]=(a*c*r-u*s*r+u*i*o-t*c*o-a*i*d+t*s*d)*S,this}scale(e){let t=this.elements,i=e.x,r=e.y,n=e.z;return t[0]*=i,t[4]*=r,t[8]*=n,t[1]*=i,t[5]*=r,t[9]*=n,t[2]*=i,t[6]*=r,t[10]*=n,t[3]*=i,t[7]*=r,t[11]*=n,this}getMaxScaleOnAxis(){let e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],i=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,i,r))}makeTranslation(e,t,i){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,i,0,0,0,1),this}makeRotationX(e){let t=Math.cos(e),i=Math.sin(e);return this.set(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1),this}makeRotationY(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1),this}makeRotationZ(e){let t=Math.cos(e),i=Math.sin(e);return this.set(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){let i=Math.cos(t),r=Math.sin(t),n=1-i,a=e.x,s=e.y,o=e.z,l=n*a,u=n*s;return this.set(l*a+i,l*s-r*o,l*o+r*s,0,l*s+r*o,u*s+i,u*o-r*a,0,l*o-r*s,u*o+r*a,n*o*o+i,0,0,0,0,1),this}makeScale(e,t,i){return this.set(e,0,0,0,0,t,0,0,0,0,i,0,0,0,0,1),this}makeShear(e,t,i,r,n,a){return this.set(1,i,n,0,e,1,a,0,t,r,1,0,0,0,0,1),this}compose(e,t,i){let r=this.elements,n=t._x,a=t._y,s=t._z,o=t._w,l=n+n,u=a+a,c=s+s,d=n*l,h=n*u,f=n*c,p=a*u,m=a*c,g=s*c,v=o*l,y=o*u,b=o*c,_=i.x,E=i.y,S=i.z;return r[0]=(1-(p+g))*_,r[1]=(h+b)*_,r[2]=(f-y)*_,r[3]=0,r[4]=(h-b)*E,r[5]=(1-(d+g))*E,r[6]=(m+v)*E,r[7]=0,r[8]=(f+y)*S,r[9]=(m-v)*S,r[10]=(1-(d+p))*S,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}decompose(e,t,i){let r=this.elements,n=rk.set(r[0],r[1],r[2]).length(),a=rk.set(r[4],r[5],r[6]).length(),s=rk.set(r[8],r[9],r[10]).length(),o=this.determinant();o<0&&(n=-n),e.x=r[12],e.y=r[13],e.z=r[14],rD.copy(this);let l=1/n,u=1/a,c=1/s;return rD.elements[0]*=l,rD.elements[1]*=l,rD.elements[2]*=l,rD.elements[4]*=u,rD.elements[5]*=u,rD.elements[6]*=u,rD.elements[8]*=c,rD.elements[9]*=c,rD.elements[10]*=c,t.setFromRotationMatrix(rD),i.x=n,i.y=a,i.z=s,this}makePerspective(e,t,i,r,n,a,s=ig){let o,l;let u=this.elements;if(s===ig)o=-(a+n)/(a-n),l=-2*a*n/(a-n);else if(s===iv)o=-a/(a-n),l=-a*n/(a-n);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return u[0]=2*n/(t-e),u[4]=0,u[8]=(t+e)/(t-e),u[12]=0,u[1]=0,u[5]=2*n/(i-r),u[9]=(i+r)/(i-r),u[13]=0,u[2]=0,u[6]=0,u[10]=o,u[14]=l,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(e,t,i,r,n,a,s=ig){let o,l;let u=this.elements,c=1/(t-e),d=1/(i-r),h=1/(a-n);if(s===ig)o=(a+n)*h,l=-2*h;else if(s===iv)o=n*h,l=-1*h;else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return u[0]=2*c,u[4]=0,u[8]=0,u[12]=-((t+e)*c),u[1]=0,u[5]=2*d,u[9]=0,u[13]=-((i+r)*d),u[2]=0,u[6]=0,u[10]=l,u[14]=-o,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(e){let t=this.elements,i=e.elements;for(let e=0;e<16;e++)if(t[e]!==i[e])return!1;return!0}fromArray(e,t=0){for(let i=0;i<16;i++)this.elements[i]=e[i+t];return this}toArray(e=[],t=0){let i=this.elements;return e[t]=i[0],e[t+1]=i[1],e[t+2]=i[2],e[t+3]=i[3],e[t+4]=i[4],e[t+5]=i[5],e[t+6]=i[6],e[t+7]=i[7],e[t+8]=i[8],e[t+9]=i[9],e[t+10]=i[10],e[t+11]=i[11],e[t+12]=i[12],e[t+13]=i[13],e[t+14]=i[14],e[t+15]=i[15],e}}let rk=new rt,rD=new rL,rP=new rt(0,0,0),rO=new rt(1,1,1),rN=new rt,rU=new rt,rF=new rt,rB=new rL,rV=new re;class rz{constructor(e=0,t=0,i=0,r=rz.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=i,this._order=r}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,i,r=this._order){return this._x=e,this._y=t,this._z=i,this._order=r,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,i=!0){let r=e.elements,n=r[0],a=r[4],s=r[8],o=r[1],l=r[5],u=r[9],c=r[2],d=r[6],h=r[10];switch(t){case"XYZ":this._y=Math.asin(iT(s,-1,1)),.9999999>Math.abs(s)?(this._x=Math.atan2(-u,h),this._z=Math.atan2(-a,n)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-iT(u,-1,1)),.9999999>Math.abs(u)?(this._y=Math.atan2(s,h),this._z=Math.atan2(o,l)):(this._y=Math.atan2(-c,n),this._z=0);break;case"ZXY":this._x=Math.asin(iT(d,-1,1)),.9999999>Math.abs(d)?(this._y=Math.atan2(-c,h),this._z=Math.atan2(-a,l)):(this._y=0,this._z=Math.atan2(o,n));break;case"ZYX":this._y=Math.asin(-iT(c,-1,1)),.9999999>Math.abs(c)?(this._x=Math.atan2(d,h),this._z=Math.atan2(o,n)):(this._x=0,this._z=Math.atan2(-a,l));break;case"YZX":this._z=Math.asin(iT(o,-1,1)),.9999999>Math.abs(o)?(this._x=Math.atan2(-u,l),this._y=Math.atan2(-c,n)):(this._x=0,this._y=Math.atan2(s,h));break;case"XZY":this._z=Math.asin(-iT(a,-1,1)),.9999999>Math.abs(a)?(this._x=Math.atan2(d,l),this._y=Math.atan2(s,n)):(this._x=Math.atan2(-u,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===i&&this._onChangeCallback(),this}setFromQuaternion(e,t,i){return rB.makeRotationFromQuaternion(e),this.setFromRotationMatrix(rB,t,i)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return rV.setFromEuler(this),this.setFromQuaternion(rV,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}rz.DEFAULT_ORDER="XYZ";class rj{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}isEnabled(e){return(this.mask&(1<<e|0))!=0}}let rH=0,rG=new rt,rW=new re,r$=new rL,rq=new rt,rY=new rt,rK=new rt,rX=new re,rZ=new rt(1,0,0),rJ=new rt(0,1,0),rQ=new rt(0,0,1),r0={type:"added"},r1={type:"removed"};class r2 extends iy{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:rH++}),this.uuid=ix(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=r2.DEFAULT_UP.clone();let e=new rt,t=new rz,i=new re,r=new rt(1,1,1);t._onChange(function(){i.setFromEuler(t,!1)}),i._onChange(function(){t.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new rL},normalMatrix:{value:new iP}}),this.matrix=new rL,this.matrixWorld=new rL,this.matrixAutoUpdate=r2.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.matrixWorldAutoUpdate=r2.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.layers=new rj,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return rW.setFromAxisAngle(e,t),this.quaternion.multiply(rW),this}rotateOnWorldAxis(e,t){return rW.setFromAxisAngle(e,t),this.quaternion.premultiply(rW),this}rotateX(e){return this.rotateOnAxis(rZ,e)}rotateY(e){return this.rotateOnAxis(rJ,e)}rotateZ(e){return this.rotateOnAxis(rQ,e)}translateOnAxis(e,t){return rG.copy(e).applyQuaternion(this.quaternion),this.position.add(rG.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(rZ,e)}translateY(e){return this.translateOnAxis(rJ,e)}translateZ(e){return this.translateOnAxis(rQ,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(r$.copy(this.matrixWorld).invert())}lookAt(e,t,i){e.isVector3?rq.copy(e):rq.set(e,t,i);let r=this.parent;this.updateWorldMatrix(!0,!1),rY.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?r$.lookAt(rY,rq,this.up):r$.lookAt(rq,rY,this.up),this.quaternion.setFromRotationMatrix(r$),r&&(r$.extractRotation(r.matrixWorld),rW.setFromRotationMatrix(r$),this.quaternion.premultiply(rW.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(r0)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}let t=this.children.indexOf(e);return -1!==t&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(r1)),this}removeFromParent(){let e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),r$.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),r$.multiply(e.parent.matrixWorld)),e.applyMatrix4(r$),this.add(e),e.updateWorldMatrix(!1,!0),this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let i=0,r=this.children.length;i<r;i++){let r=this.children[i],n=r.getObjectByProperty(e,t);if(void 0!==n)return n}}getObjectsByProperty(e,t){let i=[];this[e]===t&&i.push(this);for(let r=0,n=this.children.length;r<n;r++){let n=this.children[r].getObjectsByProperty(e,t);n.length>0&&(i=i.concat(n))}return i}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(rY,e,rK),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(rY,rX,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);let t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);let t=this.children;for(let i=0,r=t.length;i<r;i++)t[i].traverseVisible(e)}traverseAncestors(e){let t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);let t=this.children;for(let i=0,r=t.length;i<r;i++){let r=t[i];(!0===r.matrixWorldAutoUpdate||!0===e)&&r.updateMatrixWorld(e)}}updateWorldMatrix(e,t){let i=this.parent;if(!0===e&&null!==i&&!0===i.matrixWorldAutoUpdate&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t){let e=this.children;for(let t=0,i=e.length;t<i;t++){let i=e[t];!0===i.matrixWorldAutoUpdate&&i.updateWorldMatrix(!1,!0)}}}toJSON(e){let t=void 0===e||"string"==typeof e,i={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let r={};function n(t,i){return void 0===t[i.uuid]&&(t[i.uuid]=i.toJSON(e)),i.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=n(e.geometries,this.geometry);let t=this.geometry.parameters;if(void 0!==t&&void 0!==t.shapes){let i=t.shapes;if(Array.isArray(i))for(let t=0,r=i.length;t<r;t++){let r=i[t];n(e.shapes,r)}else n(e.shapes,i)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(n(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material){if(Array.isArray(this.material)){let t=[];for(let i=0,r=this.material.length;i<r;i++)t.push(n(e.materials,this.material[i]));r.material=t}else r.material=n(e.materials,this.material)}if(this.children.length>0){r.children=[];for(let t=0;t<this.children.length;t++)r.children.push(this.children[t].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(let t=0;t<this.animations.length;t++){let i=this.animations[t];r.animations.push(n(e.animations,i))}}if(t){let t=a(e.geometries),r=a(e.materials),n=a(e.textures),s=a(e.images),o=a(e.shapes),l=a(e.skeletons),u=a(e.animations),c=a(e.nodes);t.length>0&&(i.geometries=t),r.length>0&&(i.materials=r),n.length>0&&(i.textures=n),s.length>0&&(i.images=s),o.length>0&&(i.shapes=o),l.length>0&&(i.skeletons=l),u.length>0&&(i.animations=u),c.length>0&&(i.nodes=c)}return i.object=r,i;function a(e){let t=[];for(let i in e){let r=e[i];delete r.metadata,t.push(r)}return t}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(let t=0;t<e.children.length;t++){let i=e.children[t];this.add(i.clone())}return this}}r2.DEFAULT_UP=new rt(0,1,0),r2.DEFAULT_MATRIX_AUTO_UPDATE=!0,r2.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;let r3=new rt,r5=new rt,r4=new rt,r6=new rt,r8=new rt,r7=new rt,r9=new rt,ne=new rt,nt=new rt,ni=new rt,nr=!1;class nn{constructor(e=new rt,t=new rt,i=new rt){this.a=e,this.b=t,this.c=i}static getNormal(e,t,i,r){r.subVectors(i,t),r3.subVectors(e,t),r.cross(r3);let n=r.lengthSq();return n>0?r.multiplyScalar(1/Math.sqrt(n)):r.set(0,0,0)}static getBarycoord(e,t,i,r,n){r3.subVectors(r,t),r5.subVectors(i,t),r4.subVectors(e,t);let a=r3.dot(r3),s=r3.dot(r5),o=r3.dot(r4),l=r5.dot(r5),u=r5.dot(r4),c=a*l-s*s;if(0===c)return n.set(-2,-1,-1);let d=1/c,h=(l*o-s*u)*d,f=(a*u-s*o)*d;return n.set(1-h-f,f,h)}static containsPoint(e,t,i,r){return this.getBarycoord(e,t,i,r,r6),r6.x>=0&&r6.y>=0&&r6.x+r6.y<=1}static getUV(e,t,i,r,n,a,s,o){return!1===nr&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),nr=!0),this.getInterpolation(e,t,i,r,n,a,s,o)}static getInterpolation(e,t,i,r,n,a,s,o){return this.getBarycoord(e,t,i,r,r6),o.setScalar(0),o.addScaledVector(n,r6.x),o.addScaledVector(a,r6.y),o.addScaledVector(s,r6.z),o}static isFrontFacing(e,t,i,r){return r3.subVectors(i,t),r5.subVectors(e,t),0>r3.cross(r5).dot(r)}set(e,t,i){return this.a.copy(e),this.b.copy(t),this.c.copy(i),this}setFromPointsAndIndices(e,t,i,r){return this.a.copy(e[t]),this.b.copy(e[i]),this.c.copy(e[r]),this}setFromAttributeAndIndices(e,t,i,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,i),this.c.fromBufferAttribute(e,r),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return r3.subVectors(this.c,this.b),r5.subVectors(this.a,this.b),.5*r3.cross(r5).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return nn.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return nn.getBarycoord(e,this.a,this.b,this.c,t)}getUV(e,t,i,r,n){return!1===nr&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),nr=!0),nn.getInterpolation(e,this.a,this.b,this.c,t,i,r,n)}getInterpolation(e,t,i,r,n){return nn.getInterpolation(e,this.a,this.b,this.c,t,i,r,n)}containsPoint(e){return nn.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return nn.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){let i,r;let n=this.a,a=this.b,s=this.c;r8.subVectors(a,n),r7.subVectors(s,n),ne.subVectors(e,n);let o=r8.dot(ne),l=r7.dot(ne);if(o<=0&&l<=0)return t.copy(n);nt.subVectors(e,a);let u=r8.dot(nt),c=r7.dot(nt);if(u>=0&&c<=u)return t.copy(a);let d=o*c-u*l;if(d<=0&&o>=0&&u<=0)return i=o/(o-u),t.copy(n).addScaledVector(r8,i);ni.subVectors(e,s);let h=r8.dot(ni),f=r7.dot(ni);if(f>=0&&h<=f)return t.copy(s);let p=h*l-o*f;if(p<=0&&l>=0&&f<=0)return r=l/(l-f),t.copy(n).addScaledVector(r7,r);let m=u*f-h*c;if(m<=0&&c-u>=0&&h-f>=0)return r9.subVectors(s,a),r=(c-u)/(c-u+(h-f)),t.copy(a).addScaledVector(r9,r);let g=1/(m+p+d);return i=p*g,r=d*g,t.copy(n).addScaledVector(r8,i).addScaledVector(r7,r)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}let na=0;class ns extends iy{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:na++}),this.uuid=ix(),this.name="",this.type="Material",this.blending=T,this.side=b,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=F,this.blendDst=B,this.blendEquation=C,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Y,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=t3,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=tH,this.stencilZFail=tH,this.stencilZPass=tH,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(let t in e){let i=e[t];if(void 0===i){console.warn(`THREE.Material: parameter '${t}' has value of undefined.`);continue}let r=this[t];if(void 0===r){console.warn(`THREE.Material: '${t}' is not a property of THREE.${this.type}.`);continue}r&&r.isColor?r.set(i):r&&r.isVector3&&i&&i.isVector3?r.copy(i):this[t]=i}}toJSON(e){let t=void 0===e||"string"==typeof e;t&&(e={textures:{},images:{}});let i={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(e){let t=[];for(let i in e){let r=e[i];delete r.metadata,t.push(r)}return t}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),void 0!==this.sheen&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearcoat&&(i.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(i.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(i.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(i.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(i.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(i.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(e).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(e).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(e).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(e).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(e).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(i.combine=this.combine)),void 0!==this.envMapIntensity&&(i.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(i.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(i.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(i.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(i.size=this.size),null!==this.shadowSide&&(i.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==T&&(i.blending=this.blending),this.side!==b&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(i.rotation=this.rotation),!0===this.polygonOffset&&(i.polygonOffset=!0),0!==this.polygonOffsetFactor&&(i.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(i.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.alphaHash&&(i.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(i.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(i.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(i.flatShading=this.flatShading),!1===this.visible&&(i.visible=!1),!1===this.toneMapped&&(i.toneMapped=!1),!1===this.fog&&(i.fog=!1),Object.keys(this.userData).length>0&&(i.userData=this.userData),t){let t=r(e.textures),n=r(e.images);t.length>0&&(i.textures=t),n.length>0&&(i.images=n)}return i}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let t=e.clippingPlanes,i=null;if(null!==t){let e=t.length;i=Array(e);for(let r=0;r!==e;++r)i[r]=t[r].clone()}return this.clippingPlanes=i,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}}let no={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},nl={h:0,s:0,l:0},nu={h:0,s:0,l:0};function nc(e,t,i){return(i<0&&(i+=1),i>1&&(i-=1),i<1/6)?e+(t-e)*6*i:i<.5?t:i<2/3?e+(t-e)*6*(2/3-i):e}class nd{constructor(e,t,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,i)}set(e,t,i){return void 0===t&&void 0===i?e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e):this.setRGB(e,t,i),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=tF){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,iK.toWorkingColorSpace(this,t),this}setRGB(e,t,i,r=iK.workingColorSpace){return this.r=e,this.g=t,this.b=i,iK.toWorkingColorSpace(this,r),this}setHSL(e,t,i,r=iK.workingColorSpace){if(e=iw(e,1),t=iT(t,0,1),i=iT(i,0,1),0===t)this.r=this.g=this.b=i;else{let r=i<=.5?i*(1+t):i+t-i*t,n=2*i-r;this.r=nc(n,r,e+1/3),this.g=nc(n,r,e),this.b=nc(n,r,e-1/3)}return iK.toWorkingColorSpace(this,r),this}setStyle(e,t=tF){let i;function r(t){void 0!==t&&1>parseFloat(t)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let n;let a=i[1],s=i[2];switch(a){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(n[4]),this.setRGB(Math.min(255,parseInt(n[1],10))/255,Math.min(255,parseInt(n[2],10))/255,Math.min(255,parseInt(n[3],10))/255,t);if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(n[4]),this.setRGB(Math.min(100,parseInt(n[1],10))/100,Math.min(100,parseInt(n[2],10))/100,Math.min(100,parseInt(n[3],10))/100,t);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return r(n[4]),this.setHSL(parseFloat(n[1])/360,parseFloat(n[2])/100,parseFloat(n[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){let r=i[1],n=r.length;if(3===n)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(6===n)return this.setHex(parseInt(r,16),t);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=tF){let i=no[e.toLowerCase()];return void 0!==i?this.setHex(i,t):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=iH(e.r),this.g=iH(e.g),this.b=iH(e.b),this}copyLinearToSRGB(e){return this.r=iG(e.r),this.g=iG(e.g),this.b=iG(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=tF){return iK.fromWorkingColorSpace(nh.copy(this),e),65536*Math.round(iT(255*nh.r,0,255))+256*Math.round(iT(255*nh.g,0,255))+Math.round(iT(255*nh.b,0,255))}getHexString(e=tF){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=iK.workingColorSpace){let i,r;iK.fromWorkingColorSpace(nh.copy(this),t);let n=nh.r,a=nh.g,s=nh.b,o=Math.max(n,a,s),l=Math.min(n,a,s),u=(l+o)/2;if(l===o)i=0,r=0;else{let e=o-l;switch(r=u<=.5?e/(o+l):e/(2-o-l),o){case n:i=(a-s)/e+(a<s?6:0);break;case a:i=(s-n)/e+2;break;case s:i=(n-a)/e+4}i/=6}return e.h=i,e.s=r,e.l=u,e}getRGB(e,t=iK.workingColorSpace){return iK.fromWorkingColorSpace(nh.copy(this),t),e.r=nh.r,e.g=nh.g,e.b=nh.b,e}getStyle(e=tF){iK.fromWorkingColorSpace(nh.copy(this),e);let t=nh.r,i=nh.g,r=nh.b;return e!==tF?`color(${e} ${t.toFixed(3)} ${i.toFixed(3)} ${r.toFixed(3)})`:`rgb(${Math.round(255*t)},${Math.round(255*i)},${Math.round(255*r)})`}offsetHSL(e,t,i){return this.getHSL(nl),nl.h+=e,nl.s+=t,nl.l+=i,this.setHSL(nl.h,nl.s,nl.l),this}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,i){return this.r=e.r+(t.r-e.r)*i,this.g=e.g+(t.g-e.g)*i,this.b=e.b+(t.b-e.b)*i,this}lerpHSL(e,t){this.getHSL(nl),e.getHSL(nu);let i=iA(nl.h,nu.h,t),r=iA(nl.s,nu.s,t),n=iA(nl.l,nu.l,t);return this.setHSL(i,r,n),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let t=this.r,i=this.g,r=this.b,n=e.elements;return this.r=n[0]*t+n[3]*i+n[6]*r,this.g=n[1]*t+n[4]*i+n[7]*r,this.b=n[2]*t+n[5]*i+n[8]*r,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}let nh=new nd;nd.NAMES=no;class nf extends ns{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new nd(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}let np=function(){let e=new ArrayBuffer(4),t=new Float32Array(e),i=new Uint32Array(e),r=new Uint32Array(512),n=new Uint32Array(512);for(let e=0;e<256;++e){let t=e-127;t<-27?(r[e]=0,r[256|e]=32768,n[e]=24,n[256|e]=24):t<-14?(r[e]=1024>>-t-14,r[256|e]=1024>>-t-14|32768,n[e]=-t-1,n[256|e]=-t-1):t<=15?(r[e]=t+15<<10,r[256|e]=t+15<<10|32768,n[e]=13,n[256|e]=13):t<128?(r[e]=31744,r[256|e]=64512,n[e]=24,n[256|e]=24):(r[e]=31744,r[256|e]=64512,n[e]=13,n[256|e]=13)}let a=new Uint32Array(2048),s=new Uint32Array(64),o=new Uint32Array(64);for(let e=1;e<1024;++e){let t=e<<13,i=0;for(;(8388608&t)==0;)t<<=1,i-=8388608;t&=-8388609,i+=947912704,a[e]=t|i}for(let e=1024;e<2048;++e)a[e]=939524096+(e-1024<<13);for(let e=1;e<31;++e)s[e]=e<<23;s[31]=1199570944,s[32]=2147483648;for(let e=33;e<63;++e)s[e]=2147483648+(e-32<<23);s[63]=3347054592;for(let e=1;e<64;++e)32!==e&&(o[e]=1024);return{floatView:t,uint32View:i,baseTable:r,shiftTable:n,mantissaTable:a,exponentTable:s,offsetTable:o}}();function nm(e){Math.abs(e)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),e=iT(e,-65504,65504),np.floatView[0]=e;let t=np.uint32View[0],i=t>>23&511;return np.baseTable[i]+((8388607&t)>>np.shiftTable[i])}function ng(e){let t=e>>10;return np.uint32View[0]=np.mantissaTable[np.offsetTable[t]+(1023&e)]+np.exponentTable[t],np.floatView[0]}let nv={toHalfFloat:nm,fromHalfFloat:ng},ny=new rt,nb=new iD;class n_{constructor(e,t,i=!1){if(Array.isArray(e))throw TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=i,this.usage=ii,this.updateRange={offset:0,count:-1},this.gpuType=eD,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,i){e*=this.itemSize,i*=t.itemSize;for(let r=0,n=this.itemSize;r<n;r++)this.array[e+r]=t.array[i+r];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let t=0,i=this.count;t<i;t++)nb.fromBufferAttribute(this,t),nb.applyMatrix3(e),this.setXY(t,nb.x,nb.y);else if(3===this.itemSize)for(let t=0,i=this.count;t<i;t++)ny.fromBufferAttribute(this,t),ny.applyMatrix3(e),this.setXYZ(t,ny.x,ny.y,ny.z);return this}applyMatrix4(e){for(let t=0,i=this.count;t<i;t++)ny.fromBufferAttribute(this,t),ny.applyMatrix4(e),this.setXYZ(t,ny.x,ny.y,ny.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)ny.fromBufferAttribute(this,t),ny.applyNormalMatrix(e),this.setXYZ(t,ny.x,ny.y,ny.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)ny.fromBufferAttribute(this,t),ny.transformDirection(e),this.setXYZ(t,ny.x,ny.y,ny.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let i=this.array[e*this.itemSize+t];return this.normalized&&(i=iI(i,this.array)),i}setComponent(e,t,i){return this.normalized&&(i=iL(i,this.array)),this.array[e*this.itemSize+t]=i,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=iI(t,this.array)),t}setX(e,t){return this.normalized&&(t=iL(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=iI(t,this.array)),t}setY(e,t){return this.normalized&&(t=iL(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=iI(t,this.array)),t}setZ(e,t){return this.normalized&&(t=iL(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=iI(t,this.array)),t}setW(e,t){return this.normalized&&(t=iL(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=iL(t,this.array),i=iL(i,this.array)),this.array[e+0]=t,this.array[e+1]=i,this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=iL(t,this.array),i=iL(i,this.array),r=iL(r,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this}setXYZW(e,t,i,r,n){return e*=this.itemSize,this.normalized&&(t=iL(t,this.array),i=iL(i,this.array),r=iL(r,this.array),n=iL(n,this.array)),this.array[e+0]=t,this.array[e+1]=i,this.array[e+2]=r,this.array[e+3]=n,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==ii&&(e.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(e.updateRange=this.updateRange),e}}class nE extends n_{constructor(e,t,i){super(new Int8Array(e),t,i)}}class nS extends n_{constructor(e,t,i){super(new Uint8Array(e),t,i)}}class nx extends n_{constructor(e,t,i){super(new Uint8ClampedArray(e),t,i)}}class nT extends n_{constructor(e,t,i){super(new Int16Array(e),t,i)}}class nw extends n_{constructor(e,t,i){super(new Uint16Array(e),t,i)}}class nA extends n_{constructor(e,t,i){super(new Int32Array(e),t,i)}}class nM extends n_{constructor(e,t,i){super(new Uint32Array(e),t,i)}}class nR extends n_{constructor(e,t,i){super(new Uint16Array(e),t,i),this.isFloat16BufferAttribute=!0}getX(e){let t=ng(this.array[e*this.itemSize]);return this.normalized&&(t=iI(t,this.array)),t}setX(e,t){return this.normalized&&(t=iL(t,this.array)),this.array[e*this.itemSize]=nm(t),this}getY(e){let t=ng(this.array[e*this.itemSize+1]);return this.normalized&&(t=iI(t,this.array)),t}setY(e,t){return this.normalized&&(t=iL(t,this.array)),this.array[e*this.itemSize+1]=nm(t),this}getZ(e){let t=ng(this.array[e*this.itemSize+2]);return this.normalized&&(t=iI(t,this.array)),t}setZ(e,t){return this.normalized&&(t=iL(t,this.array)),this.array[e*this.itemSize+2]=nm(t),this}getW(e){let t=ng(this.array[e*this.itemSize+3]);return this.normalized&&(t=iI(t,this.array)),t}setW(e,t){return this.normalized&&(t=iL(t,this.array)),this.array[e*this.itemSize+3]=nm(t),this}setXY(e,t,i){return e*=this.itemSize,this.normalized&&(t=iL(t,this.array),i=iL(i,this.array)),this.array[e+0]=nm(t),this.array[e+1]=nm(i),this}setXYZ(e,t,i,r){return e*=this.itemSize,this.normalized&&(t=iL(t,this.array),i=iL(i,this.array),r=iL(r,this.array)),this.array[e+0]=nm(t),this.array[e+1]=nm(i),this.array[e+2]=nm(r),this}setXYZW(e,t,i,r,n){return e*=this.itemSize,this.normalized&&(t=iL(t,this.array),i=iL(i,this.array),r=iL(r,this.array),n=iL(n,this.array)),this.array[e+0]=nm(t),this.array[e+1]=nm(i),this.array[e+2]=nm(r),this.array[e+3]=nm(n),this}}class nC extends n_{constructor(e,t,i){super(new Float32Array(e),t,i)}}class nI extends n_{constructor(e,t,i){super(new Float64Array(e),t,i)}}let nL=0,nk=new rL,nD=new r2,nP=new rt,nO=new rn,nN=new rn,nU=new rt;class nF extends iy{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:nL++}),this.uuid=ix(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(iN(e)?nM:nw)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,t,i=0){this.groups.push({start:e,count:t,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){let t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);let i=this.attributes.normal;if(void 0!==i){let t=new iP().getNormalMatrix(e);i.applyNormalMatrix(t),i.needsUpdate=!0}let r=this.attributes.tangent;return void 0!==r&&(r.transformDirection(e),r.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return nk.makeRotationFromQuaternion(e),this.applyMatrix4(nk),this}rotateX(e){return nk.makeRotationX(e),this.applyMatrix4(nk),this}rotateY(e){return nk.makeRotationY(e),this.applyMatrix4(nk),this}rotateZ(e){return nk.makeRotationZ(e),this.applyMatrix4(nk),this}translate(e,t,i){return nk.makeTranslation(e,t,i),this.applyMatrix4(nk),this}scale(e,t,i){return nk.makeScale(e,t,i),this.applyMatrix4(nk),this}lookAt(e){return nD.lookAt(e),nD.updateMatrix(),this.applyMatrix4(nD.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(nP).negate(),this.translate(nP.x,nP.y,nP.z),this}setFromPoints(e){let t=[];for(let i=0,r=e.length;i<r;i++){let r=e[i];t.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new nC(t,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new rn);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new rt(-1/0,-1/0,-1/0),new rt(Infinity,Infinity,Infinity));return}if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){let i=t[e];nO.setFromBufferAttribute(i),this.morphTargetsRelative?(nU.addVectors(this.boundingBox.min,nO.min),this.boundingBox.expandByPoint(nU),nU.addVectors(this.boundingBox.max,nO.max),this.boundingBox.expandByPoint(nU)):(this.boundingBox.expandByPoint(nO.min),this.boundingBox.expandByPoint(nO.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new rS);let e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new rt,1/0);return}if(e){let i=this.boundingSphere.center;if(nO.setFromBufferAttribute(e),t)for(let e=0,i=t.length;e<i;e++){let i=t[e];nN.setFromBufferAttribute(i),this.morphTargetsRelative?(nU.addVectors(nO.min,nN.min),nO.expandByPoint(nU),nU.addVectors(nO.max,nN.max),nO.expandByPoint(nU)):(nO.expandByPoint(nN.min),nO.expandByPoint(nN.max))}nO.getCenter(i);let r=0;for(let t=0,n=e.count;t<n;t++)nU.fromBufferAttribute(e,t),r=Math.max(r,i.distanceToSquared(nU));if(t)for(let n=0,a=t.length;n<a;n++){let a=t[n],s=this.morphTargetsRelative;for(let t=0,n=a.count;t<n;t++)nU.fromBufferAttribute(a,t),s&&(nP.fromBufferAttribute(e,t),nU.add(nP)),r=Math.max(r,i.distanceToSquared(nU))}this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,t=this.attributes;if(null===e||void 0===t.position||void 0===t.normal||void 0===t.uv){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let i=e.array,r=t.position.array,n=t.normal.array,a=t.uv.array,s=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new n_(new Float32Array(4*s),4));let o=this.getAttribute("tangent").array,l=[],u=[];for(let e=0;e<s;e++)l[e]=new rt,u[e]=new rt;let c=new rt,d=new rt,h=new rt,f=new iD,p=new iD,m=new iD,g=new rt,v=new rt,y=this.groups;0===y.length&&(y=[{start:0,count:i.length}]);for(let e=0,t=y.length;e<t;++e){let t=y[e],n=t.start,s=t.count;for(let e=n,t=n+s;e<t;e+=3)!function(e,t,i){c.fromArray(r,3*e),d.fromArray(r,3*t),h.fromArray(r,3*i),f.fromArray(a,2*e),p.fromArray(a,2*t),m.fromArray(a,2*i),d.sub(c),h.sub(c),p.sub(f),m.sub(f);let n=1/(p.x*m.y-m.x*p.y);isFinite(n)&&(g.copy(d).multiplyScalar(m.y).addScaledVector(h,-p.y).multiplyScalar(n),v.copy(h).multiplyScalar(p.x).addScaledVector(d,-m.x).multiplyScalar(n),l[e].add(g),l[t].add(g),l[i].add(g),u[e].add(v),u[t].add(v),u[i].add(v))}(i[e+0],i[e+1],i[e+2])}let b=new rt,_=new rt,E=new rt,S=new rt;function x(e){E.fromArray(n,3*e),S.copy(E);let t=l[e];b.copy(t),b.sub(E.multiplyScalar(E.dot(t))).normalize(),_.crossVectors(S,t);let i=_.dot(u[e]);o[4*e]=b.x,o[4*e+1]=b.y,o[4*e+2]=b.z,o[4*e+3]=i<0?-1:1}for(let e=0,t=y.length;e<t;++e){let t=y[e],r=t.start,n=t.count;for(let e=r,t=r+n;e<t;e+=3)x(i[e+0]),x(i[e+1]),x(i[e+2])}}computeVertexNormals(){let e=this.index,t=this.getAttribute("position");if(void 0!==t){let i=this.getAttribute("normal");if(void 0===i)i=new n_(new Float32Array(3*t.count),3),this.setAttribute("normal",i);else for(let e=0,t=i.count;e<t;e++)i.setXYZ(e,0,0,0);let r=new rt,n=new rt,a=new rt,s=new rt,o=new rt,l=new rt,u=new rt,c=new rt;if(e)for(let d=0,h=e.count;d<h;d+=3){let h=e.getX(d+0),f=e.getX(d+1),p=e.getX(d+2);r.fromBufferAttribute(t,h),n.fromBufferAttribute(t,f),a.fromBufferAttribute(t,p),u.subVectors(a,n),c.subVectors(r,n),u.cross(c),s.fromBufferAttribute(i,h),o.fromBufferAttribute(i,f),l.fromBufferAttribute(i,p),s.add(u),o.add(u),l.add(u),i.setXYZ(h,s.x,s.y,s.z),i.setXYZ(f,o.x,o.y,o.z),i.setXYZ(p,l.x,l.y,l.z)}else for(let e=0,s=t.count;e<s;e+=3)r.fromBufferAttribute(t,e+0),n.fromBufferAttribute(t,e+1),a.fromBufferAttribute(t,e+2),u.subVectors(a,n),c.subVectors(r,n),u.cross(c),i.setXYZ(e+0,u.x,u.y,u.z),i.setXYZ(e+1,u.x,u.y,u.z),i.setXYZ(e+2,u.x,u.y,u.z);this.normalizeNormals(),i.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let t=0,i=e.count;t<i;t++)nU.fromBufferAttribute(e,t),nU.normalize(),e.setXYZ(t,nU.x,nU.y,nU.z)}toNonIndexed(){function e(e,t){let i=e.array,r=e.itemSize,n=e.normalized,a=new i.constructor(t.length*r),s=0,o=0;for(let n=0,l=t.length;n<l;n++){s=e.isInterleavedBufferAttribute?t[n]*e.data.stride+e.offset:t[n]*r;for(let e=0;e<r;e++)a[o++]=i[s++]}return new n_(a,r,n)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let t=new nF,i=this.index.array,r=this.attributes;for(let n in r){let a=r[n],s=e(a,i);t.setAttribute(n,s)}let n=this.morphAttributes;for(let r in n){let a=[],s=n[r];for(let t=0,r=s.length;t<r;t++){let r=s[t],n=e(r,i);a.push(n)}t.morphAttributes[r]=a}t.morphTargetsRelative=this.morphTargetsRelative;let a=this.groups;for(let e=0,i=a.length;e<i;e++){let i=a[e];t.addGroup(i.start,i.count,i.materialIndex)}return t}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){let t=this.parameters;for(let i in t)void 0!==t[i]&&(e[i]=t[i]);return e}e.data={attributes:{}};let t=this.index;null!==t&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});let i=this.attributes;for(let t in i){let r=i[t];e.data.attributes[t]=r.toJSON(e.data)}let r={},n=!1;for(let t in this.morphAttributes){let i=this.morphAttributes[t],a=[];for(let t=0,r=i.length;t<r;t++){let r=i[t];a.push(r.toJSON(e.data))}a.length>0&&(r[t]=a,n=!0)}n&&(e.data.morphAttributes=r,e.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));let s=this.boundingSphere;return null!==s&&(e.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let t={};this.name=e.name;let i=e.index;null!==i&&this.setIndex(i.clone(t));let r=e.attributes;for(let e in r){let i=r[e];this.setAttribute(e,i.clone(t))}let n=e.morphAttributes;for(let e in n){let i=[],r=n[e];for(let e=0,n=r.length;e<n;e++)i.push(r[e].clone(t));this.morphAttributes[e]=i}this.morphTargetsRelative=e.morphTargetsRelative;let a=e.groups;for(let e=0,t=a.length;e<t;e++){let t=a[e];this.addGroup(t.start,t.count,t.materialIndex)}let s=e.boundingBox;null!==s&&(this.boundingBox=s.clone());let o=e.boundingSphere;return null!==o&&(this.boundingSphere=o.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}let nB=new rL,nV=new rI,nz=new rS,nj=new rt,nH=new rt,nG=new rt,nW=new rt,n$=new rt,nq=new rt,nY=new iD,nK=new iD,nX=new iD,nZ=new rt,nJ=new rt,nQ=new rt,n0=new rt,n1=new rt;class n2 extends r2{constructor(e=new nF,t=new nf){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry,t=e.morphAttributes,i=Object.keys(t);if(i.length>0){let e=t[i[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,i=e.length;t<i;t++){let i=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}}}getVertexPosition(e,t){let i=this.geometry,r=i.attributes.position,n=i.morphAttributes.position,a=i.morphTargetsRelative;t.fromBufferAttribute(r,e);let s=this.morphTargetInfluences;if(n&&s){nq.set(0,0,0);for(let i=0,r=n.length;i<r;i++){let r=s[i],o=n[i];0!==r&&(n$.fromBufferAttribute(o,e),a?nq.addScaledVector(n$,r):nq.addScaledVector(n$.sub(t),r))}t.add(nq)}return t}raycast(e,t){let i=this.geometry,r=this.material,n=this.matrixWorld;if(void 0!==r){if(null===i.boundingSphere&&i.computeBoundingSphere(),nz.copy(i.boundingSphere),nz.applyMatrix4(n),nV.copy(e.ray).recast(e.near),!1===nz.containsPoint(nV.origin)&&(null===nV.intersectSphere(nz,nj)||nV.origin.distanceToSquared(nj)>(e.far-e.near)**2)||(nB.copy(n).invert(),nV.copy(e.ray).applyMatrix4(nB),null!==i.boundingBox&&!1===nV.intersectsBox(i.boundingBox)))return;this._computeIntersections(e,t,nV)}}_computeIntersections(e,t,i){let r;let n=this.geometry,a=this.material,s=n.index,o=n.attributes.position,l=n.attributes.uv,u=n.attributes.uv1,c=n.attributes.normal,d=n.groups,h=n.drawRange;if(null!==s){if(Array.isArray(a))for(let n=0,o=d.length;n<o;n++){let o=d[n],f=a[o.materialIndex],p=Math.max(o.start,h.start),m=Math.min(s.count,Math.min(o.start+o.count,h.start+h.count));for(let n=p;n<m;n+=3){let a=s.getX(n),d=s.getX(n+1),h=s.getX(n+2);(r=n3(this,f,e,i,l,u,c,a,d,h))&&(r.faceIndex=Math.floor(n/3),r.face.materialIndex=o.materialIndex,t.push(r))}}else{let n=Math.max(0,h.start),o=Math.min(s.count,h.start+h.count);for(let d=n;d<o;d+=3){let n=s.getX(d),o=s.getX(d+1),h=s.getX(d+2);(r=n3(this,a,e,i,l,u,c,n,o,h))&&(r.faceIndex=Math.floor(d/3),t.push(r))}}}else if(void 0!==o){if(Array.isArray(a))for(let n=0,s=d.length;n<s;n++){let s=d[n],f=a[s.materialIndex],p=Math.max(s.start,h.start),m=Math.min(o.count,Math.min(s.start+s.count,h.start+h.count));for(let n=p;n<m;n+=3){let a=n,o=n+1,d=n+2;(r=n3(this,f,e,i,l,u,c,a,o,d))&&(r.faceIndex=Math.floor(n/3),r.face.materialIndex=s.materialIndex,t.push(r))}}else{let n=Math.max(0,h.start),s=Math.min(o.count,h.start+h.count);for(let o=n;o<s;o+=3){let n=o,s=o+1,d=o+2;(r=n3(this,a,e,i,l,u,c,n,s,d))&&(r.faceIndex=Math.floor(o/3),t.push(r))}}}}}function n3(e,t,i,r,n,a,s,o,l,u){e.getVertexPosition(o,nH),e.getVertexPosition(l,nG),e.getVertexPosition(u,nW);let c=function(e,t,i,r,n,a,s,o){if(null===(t.side===_?r.intersectTriangle(s,a,n,!0,o):r.intersectTriangle(n,a,s,t.side===b,o)))return null;n1.copy(o),n1.applyMatrix4(e.matrixWorld);let l=i.ray.origin.distanceTo(n1);return l<i.near||l>i.far?null:{distance:l,point:n1.clone(),object:e}}(e,t,i,r,nH,nG,nW,n0);if(c){n&&(nY.fromBufferAttribute(n,o),nK.fromBufferAttribute(n,l),nX.fromBufferAttribute(n,u),c.uv=nn.getInterpolation(n0,nH,nG,nW,nY,nK,nX,new iD)),a&&(nY.fromBufferAttribute(a,o),nK.fromBufferAttribute(a,l),nX.fromBufferAttribute(a,u),c.uv1=nn.getInterpolation(n0,nH,nG,nW,nY,nK,nX,new iD),c.uv2=c.uv1),s&&(nZ.fromBufferAttribute(s,o),nJ.fromBufferAttribute(s,l),nQ.fromBufferAttribute(s,u),c.normal=nn.getInterpolation(n0,nH,nG,nW,nZ,nJ,nQ,new rt),c.normal.dot(r.direction)>0&&c.normal.multiplyScalar(-1));let e={a:o,b:l,c:u,normal:new rt,materialIndex:0};nn.getNormal(nH,nG,nW,e.normal),c.face=e}return c}class n5 extends nF{constructor(e=1,t=1,i=1,r=1,n=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:i,widthSegments:r,heightSegments:n,depthSegments:a};let s=this;r=Math.floor(r),n=Math.floor(n),a=Math.floor(a);let o=[],l=[],u=[],c=[],d=0,h=0;function f(e,t,i,r,n,a,f,p,m,g,v){let y=a/m,b=f/g,_=a/2,E=f/2,S=p/2,x=m+1,T=g+1,w=0,A=0,M=new rt;for(let a=0;a<T;a++){let s=a*b-E;for(let o=0;o<x;o++){let d=o*y-_;M[e]=d*r,M[t]=s*n,M[i]=S,l.push(M.x,M.y,M.z),M[e]=0,M[t]=0,M[i]=p>0?1:-1,u.push(M.x,M.y,M.z),c.push(o/m),c.push(1-a/g),w+=1}}for(let e=0;e<g;e++)for(let t=0;t<m;t++){let i=d+t+x*e,r=d+t+x*(e+1),n=d+(t+1)+x*(e+1),a=d+(t+1)+x*e;o.push(i,r,a),o.push(r,n,a),A+=6}s.addGroup(h,A,v),h+=A,d+=w}f("z","y","x",-1,-1,i,t,e,a,n,0),f("z","y","x",1,-1,i,t,-e,a,n,1),f("x","z","y",1,1,e,i,t,r,a,2),f("x","z","y",1,-1,e,i,-t,r,a,3),f("x","y","z",1,-1,e,t,i,r,n,4),f("x","y","z",-1,-1,e,t,-i,r,n,5),this.setIndex(o),this.setAttribute("position",new nC(l,3)),this.setAttribute("normal",new nC(u,3)),this.setAttribute("uv",new nC(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new n5(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function n4(e){let t={};for(let i in e)for(let r in t[i]={},e[i]){let n=e[i][r];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?n.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[i][r]=null):t[i][r]=n.clone():Array.isArray(n)?t[i][r]=n.slice():t[i][r]=n}return t}function n6(e){let t={};for(let i=0;i<e.length;i++){let r=n4(e[i]);for(let e in r)t[e]=r[e]}return t}function n8(e){return null===e.getRenderTarget()?e.outputColorSpace:tB}let n7={clone:n4,merge:n6};class n9 extends ns{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader="void main() {\n	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=n4(e.uniforms),this.uniformsGroups=function(e){let t=[];for(let i=0;i<e.length;i++)t.push(e[i].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}toJSON(e){let t=super.toJSON(e);for(let i in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){let r=this.uniforms[i],n=r.value;n&&n.isTexture?t.uniforms[i]={type:"t",value:n.toJSON(e).uuid}:n&&n.isColor?t.uniforms[i]={type:"c",value:n.getHex()}:n&&n.isVector2?t.uniforms[i]={type:"v2",value:n.toArray()}:n&&n.isVector3?t.uniforms[i]={type:"v3",value:n.toArray()}:n&&n.isVector4?t.uniforms[i]={type:"v4",value:n.toArray()}:n&&n.isMatrix3?t.uniforms[i]={type:"m3",value:n.toArray()}:n&&n.isMatrix4?t.uniforms[i]={type:"m4",value:n.toArray()}:t.uniforms[i]={value:n}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;let i={};for(let e in this.extensions)!0===this.extensions[e]&&(i[e]=!0);return Object.keys(i).length>0&&(t.extensions=i),t}}class ae extends r2{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new rL,this.projectionMatrix=new rL,this.projectionMatrixInverse=new rL,this.coordinateSystem=ig}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class at extends ae{constructor(e=50,t=1,i=.1,r=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=i,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let t=.5*this.getFilmHeight()/e;this.fov=2*iS*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(.5*iE*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*iS*Math.atan(Math.tan(.5*iE*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(e,t,i,r,n,a){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,t=e*Math.tan(.5*iE*this.fov)/this.zoom,i=2*t,r=this.aspect*i,n=-.5*r,a=this.view;if(null!==this.view&&this.view.enabled){let e=a.fullWidth,s=a.fullHeight;n+=a.offsetX*r/e,t-=a.offsetY*i/s,r*=a.width/e,i*=a.height/s}let s=this.filmOffset;0!==s&&(n+=e*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(n,n+r,t,t-i,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}class ai extends r2{constructor(e,t,i){super(),this.type="CubeCamera",this.renderTarget=i,this.coordinateSystem=null;let r=new at(-90,1,e,t);r.layers=this.layers,this.add(r);let n=new at(-90,1,e,t);n.layers=this.layers,this.add(n);let a=new at(-90,1,e,t);a.layers=this.layers,this.add(a);let s=new at(-90,1,e,t);s.layers=this.layers,this.add(s);let o=new at(-90,1,e,t);o.layers=this.layers,this.add(o);let l=new at(-90,1,e,t);l.layers=this.layers,this.add(l)}updateCoordinateSystem(){let e=this.coordinateSystem,t=this.children.concat(),[i,r,n,a,s,o]=t;for(let e of t)this.remove(e);if(e===ig)i.up.set(0,1,0),i.lookAt(1,0,0),r.up.set(0,1,0),r.lookAt(-1,0,0),n.up.set(0,0,-1),n.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),o.up.set(0,1,0),o.lookAt(0,0,-1);else if(e===iv)i.up.set(0,-1,0),i.lookAt(-1,0,0),r.up.set(0,-1,0),r.lookAt(1,0,0),n.up.set(0,0,1),n.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),o.up.set(0,-1,0),o.lookAt(0,0,-1);else throw Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(let e of t)this.add(e),e.updateMatrixWorld()}update(e,t){null===this.parent&&this.updateMatrixWorld();let i=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());let[r,n,a,s,o,l]=this.children,u=e.getRenderTarget(),c=e.xr.enabled;e.xr.enabled=!1;let d=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,e.setRenderTarget(i,0),e.render(t,r),e.setRenderTarget(i,1),e.render(t,n),e.setRenderTarget(i,2),e.render(t,a),e.setRenderTarget(i,3),e.render(t,s),e.setRenderTarget(i,4),e.render(t,o),i.texture.generateMipmaps=d,e.setRenderTarget(i,5),e.render(t,l),e.setRenderTarget(u),e.xr.enabled=c,i.texture.needsPMREMUpdate=!0}}class ar extends i1{constructor(e,t,i,r,n,a,s,o,l,u){super(e=void 0!==e?e:[],t=void 0!==t?t:eu,i,r,n,a,s,o,l,u),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class an extends i5{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;let i={width:e,height:e,depth:1},r=[i,i,i,i,i,i];void 0!==t.encoding&&(ij("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),t.colorSpace=t.encoding===tk?tF:tU),this.texture=new ar(r,t.mapping,t.wrapS,t.wrapT,t.magFilter,t.minFilter,t.format,t.type,t.anisotropy,t.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==t.generateMipmaps&&t.generateMipmaps,this.texture.minFilter=void 0!==t.minFilter?t.minFilter:eS}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;let i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},r=new n5(5,5,5),n=new n9({name:"CubemapFromEquirect",uniforms:n4(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:_,blending:x});n.uniforms.tEquirect.value=t;let a=new n2(r,n),s=t.minFilter;t.minFilter===ew&&(t.minFilter=eS);let o=new ai(1,10,this);return o.update(e,a),t.minFilter=s,a.geometry.dispose(),a.material.dispose(),this}clear(e,t,i,r){let n=e.getRenderTarget();for(let n=0;n<6;n++)e.setRenderTarget(this,n),e.clear(t,i,r);e.setRenderTarget(n)}}let aa=new rt,as=new rt,ao=new iP;class al{constructor(e=new rt(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,i,r){return this.normal.set(e,t,i),this.constant=r,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,i){let r=aa.subVectors(i,t).cross(as.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){let i=e.delta(aa),r=this.normal.dot(i);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;let n=-(e.start.dot(this.normal)+this.constant)/r;return n<0||n>1?null:t.copy(e.start).addScaledVector(i,n)}intersectsLine(e){let t=this.distanceToPoint(e.start),i=this.distanceToPoint(e.end);return t<0&&i>0||i<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){let i=t||ao.getNormalMatrix(e),r=this.coplanarPoint(aa).applyMatrix4(e),n=this.normal.applyMatrix3(i).normalize();return this.constant=-r.dot(n),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}let au=new rS,ac=new rt;class ad{constructor(e=new al,t=new al,i=new al,r=new al,n=new al,a=new al){this.planes=[e,t,i,r,n,a]}set(e,t,i,r,n,a){let s=this.planes;return s[0].copy(e),s[1].copy(t),s[2].copy(i),s[3].copy(r),s[4].copy(n),s[5].copy(a),this}copy(e){let t=this.planes;for(let i=0;i<6;i++)t[i].copy(e.planes[i]);return this}setFromProjectionMatrix(e,t=ig){let i=this.planes,r=e.elements,n=r[0],a=r[1],s=r[2],o=r[3],l=r[4],u=r[5],c=r[6],d=r[7],h=r[8],f=r[9],p=r[10],m=r[11],g=r[12],v=r[13],y=r[14],b=r[15];if(i[0].setComponents(o-n,d-l,m-h,b-g).normalize(),i[1].setComponents(o+n,d+l,m+h,b+g).normalize(),i[2].setComponents(o+a,d+u,m+f,b+v).normalize(),i[3].setComponents(o-a,d-u,m-f,b-v).normalize(),i[4].setComponents(o-s,d-c,m-p,b-y).normalize(),t===ig)i[5].setComponents(o+s,d+c,m+p,b+y).normalize();else if(t===iv)i[5].setComponents(s,c,p,y).normalize();else throw Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),au.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),au.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(au)}intersectsSprite(e){return au.center.set(0,0,0),au.radius=.7071067811865476,au.applyMatrix4(e.matrixWorld),this.intersectsSphere(au)}intersectsSphere(e){let t=this.planes,i=e.center,r=-e.radius;for(let e=0;e<6;e++){let n=t[e].distanceToPoint(i);if(n<r)return!1}return!0}intersectsBox(e){let t=this.planes;for(let i=0;i<6;i++){let r=t[i];if(ac.x=r.normal.x>0?e.max.x:e.min.x,ac.y=r.normal.y>0?e.max.y:e.min.y,ac.z=r.normal.z>0?e.max.z:e.min.z,0>r.distanceToPoint(ac))return!1}return!0}containsPoint(e){let t=this.planes;for(let i=0;i<6;i++)if(0>t[i].distanceToPoint(e))return!1;return!0}clone(){return new this.constructor().copy(this)}}function ah(){let e=null,t=!1,i=null,r=null;function n(t,a){i(t,a),r=e.requestAnimationFrame(n)}return{start:function(){!0!==t&&null!==i&&(r=e.requestAnimationFrame(n),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){i=e},setContext:function(t){e=t}}}function af(e,t){let i=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);let i=r.get(t);i&&(e.deleteBuffer(i.buffer),r.delete(t))},update:function(t,n){if(t.isGLBufferAttribute){let e=r.get(t);(!e||e.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version});return}t.isInterleavedBufferAttribute&&(t=t.data);let a=r.get(t);void 0===a?r.set(t,function(t,r){let n;let a=t.array,s=t.usage,o=e.createBuffer();if(e.bindBuffer(r,o),e.bufferData(r,a,s),t.onUploadCallback(),a instanceof Float32Array)n=e.FLOAT;else if(a instanceof Uint16Array){if(t.isFloat16BufferAttribute){if(i)n=e.HALF_FLOAT;else throw Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.")}else n=e.UNSIGNED_SHORT}else if(a instanceof Int16Array)n=e.SHORT;else if(a instanceof Uint32Array)n=e.UNSIGNED_INT;else if(a instanceof Int32Array)n=e.INT;else if(a instanceof Int8Array)n=e.BYTE;else if(a instanceof Uint8Array)n=e.UNSIGNED_BYTE;else if(a instanceof Uint8ClampedArray)n=e.UNSIGNED_BYTE;else throw Error("THREE.WebGLAttributes: Unsupported buffer data format: "+a);return{buffer:o,type:n,bytesPerElement:a.BYTES_PER_ELEMENT,version:t.version}}(t,n)):a.version<t.version&&(!function(t,r,n){let a=r.array,s=r.updateRange;e.bindBuffer(n,t),-1===s.count?e.bufferSubData(n,0,a):(i?e.bufferSubData(n,s.offset*a.BYTES_PER_ELEMENT,a,s.offset,s.count):e.bufferSubData(n,s.offset*a.BYTES_PER_ELEMENT,a.subarray(s.offset,s.offset+s.count)),s.count=-1),r.onUploadCallback()}(a.buffer,t,n),a.version=t.version)}}}class ap extends nF{constructor(e=1,t=1,i=1,r=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:i,heightSegments:r};let n=e/2,a=t/2,s=Math.floor(i),o=Math.floor(r),l=s+1,u=o+1,c=e/s,d=t/o,h=[],f=[],p=[],m=[];for(let e=0;e<u;e++){let t=e*d-a;for(let i=0;i<l;i++){let r=i*c-n;f.push(r,-t,0),p.push(0,0,1),m.push(i/s),m.push(1-e/o)}}for(let e=0;e<o;e++)for(let t=0;t<s;t++){let i=t+l*e,r=t+l*(e+1),n=t+1+l*(e+1),a=t+1+l*e;h.push(i,r,a),h.push(r,n,a)}this.setIndex(h),this.setAttribute("position",new nC(f,3)),this.setAttribute("normal",new nC(p,3)),this.setAttribute("uv",new nC(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new ap(e.width,e.height,e.widthSegments,e.heightSegments)}}let am={alphahash_fragment:"#ifdef USE_ALPHAHASH\n	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n	const float ALPHA_HASH_SCALE = 0.05;\n	float hash2D( vec2 value ) {\n		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n	}\n	float hash3D( vec3 value ) {\n		return hash2D( vec2( hash2D( value.xy ), value.z ) );\n	}\n	float getAlphaHashThreshold( vec3 position ) {\n		float maxDeriv = max(\n			length( dFdx( position.xyz ) ),\n			length( dFdy( position.xyz ) )\n		);\n		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n		vec2 pixScales = vec2(\n			exp2( floor( log2( pixScale ) ) ),\n			exp2( ceil( log2( pixScale ) ) )\n		);\n		vec2 alpha = vec2(\n			hash3D( floor( pixScales.x * position.xyz ) ),\n			hash3D( floor( pixScales.y * position.xyz ) )\n		);\n		float lerpFactor = fract( log2( pixScale ) );\n		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n		float a = min( lerpFactor, 1.0 - lerpFactor );\n		vec3 cases = vec3(\n			x * x / ( 2.0 * a * ( 1.0 - a ) ),\n			( x - 0.5 * a ) / ( 1.0 - a ),\n			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n		);\n		float threshold = ( x < ( 1.0 - a ) )\n			? ( ( x < a ) ? cases.x : cases.y )\n			: cases.z;\n		return clamp( threshold , 1.0e-6, 1.0 );\n	}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n	if ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n	uniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n	reflectedLight.indirectDiffuse *= ambientOcclusion;\n	#if defined( USE_ENVMAP ) && defined( STANDARD )\n		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n	#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n	uniform sampler2D aoMap;\n	uniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n	vPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n	vec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n	return 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( specularColor, 1.0, dotVH );\n	float G = G_BlinnPhong_Implicit( );\n	float D = D_BlinnPhong( shininess, dotNH );\n	return F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n	const mat3 XYZ_TO_REC709 = mat3(\n		 3.2404542, -0.9692660,  0.0556434,\n		-1.5371385,  1.8760108, -0.2040259,\n		-0.4985314,  0.0415560,  1.0572252\n	);\n	vec3 Fresnel0ToIor( vec3 fresnel0 ) {\n		vec3 sqrtF0 = sqrt( fresnel0 );\n		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n	}\n	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n	}\n	float IorToFresnel0( float transmittedIor, float incidentIor ) {\n		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n	}\n	vec3 evalSensitivity( float OPD, vec3 shift ) {\n		float phase = 2.0 * PI * OPD * 1.0e-9;\n		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n		xyz /= 1.0685e-7;\n		vec3 rgb = XYZ_TO_REC709 * xyz;\n		return rgb;\n	}\n	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n		vec3 I;\n		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n		float cosTheta2Sq = 1.0 - sinTheta2Sq;\n		if ( cosTheta2Sq < 0.0 ) {\n			return vec3( 1.0 );\n		}\n		float cosTheta2 = sqrt( cosTheta2Sq );\n		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n		float R12 = F_Schlick( R0, 1.0, cosTheta1 );\n		float T121 = 1.0 - R12;\n		float phi12 = 0.0;\n		if ( iridescenceIOR < outsideIOR ) phi12 = PI;\n		float phi21 = PI - phi12;\n		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n		vec3 phi23 = vec3( 0.0 );\n		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n		vec3 phi = vec3( phi21 ) + phi23;\n		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n		vec3 r123 = sqrt( R123 );\n		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n		vec3 C0 = R12 + Rs;\n		I = C0;\n		vec3 Cm = Rs - T121;\n		for ( int m = 1; m <= 2; ++ m ) {\n			Cm *= r123;\n			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n			I += Cm * Sm;\n		}\n		return max( I, vec3( 0.0 ) );\n	}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n	uniform sampler2D bumpMap;\n	uniform float bumpScale;\n	vec2 dHdxy_fwd() {\n		vec2 dSTdx = dFdx( vBumpMapUv );\n		vec2 dSTdy = dFdy( vBumpMapUv );\n		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n		return vec2( dBx, dBy );\n	}\n	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n		vec3 vSigmaX = dFdx( surf_pos.xyz );\n		vec3 vSigmaY = dFdy( surf_pos.xyz );\n		vec3 vN = surf_norm;\n		vec3 R1 = cross( vSigmaY, vN );\n		vec3 R2 = cross( vN, vSigmaX );\n		float fDet = dot( vSigmaX, R1 ) * faceDirection;\n		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n		return normalize( abs( fDet ) * surf_norm - vGrad );\n	}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n	vec4 plane;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n		plane = clippingPlanes[ i ];\n		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n	}\n	#pragma unroll_loop_end\n	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n		bool clipped = true;\n		#pragma unroll_loop_start\n		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n			plane = clippingPlanes[ i ];\n			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n		}\n		#pragma unroll_loop_end\n		if ( clipped ) discard;\n	#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n	varying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n	vClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n	diffuseColor *= vColor;\n#elif defined( USE_COLOR )\n	diffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR )\n	varying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n	varying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n	varying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n	vColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n	vColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n	vColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n	vColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n	const highp float a = 12.9898, b = 78.233, c = 43758.5453;\n	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n	return fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n	float precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n	float precisionSafeLength( vec3 v ) {\n		float maxComponent = max3( abs( v ) );\n		return length( v / maxComponent ) * maxComponent;\n	}\n#endif\nstruct IncidentLight {\n	vec3 color;\n	vec3 direction;\n	bool visible;\n};\nstruct ReflectedLight {\n	vec3 directDiffuse;\n	vec3 directSpecular;\n	vec3 indirectDiffuse;\n	vec3 indirectSpecular;\n};\nstruct GeometricContext {\n	vec3 position;\n	vec3 normal;\n	vec3 viewDir;\n#ifdef USE_CLEARCOAT\n	vec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n	varying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n	mat3 tmp;\n	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n	return tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n	const vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n	return dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n	return m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n	return vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n	return RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n	#define cubeUV_minMipLevel 4.0\n	#define cubeUV_minTileSize 16.0\n	float getFace( vec3 direction ) {\n		vec3 absDirection = abs( direction );\n		float face = - 1.0;\n		if ( absDirection.x > absDirection.z ) {\n			if ( absDirection.x > absDirection.y )\n				face = direction.x > 0.0 ? 0.0 : 3.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		} else {\n			if ( absDirection.z > absDirection.y )\n				face = direction.z > 0.0 ? 2.0 : 5.0;\n			else\n				face = direction.y > 0.0 ? 1.0 : 4.0;\n		}\n		return face;\n	}\n	vec2 getUV( vec3 direction, float face ) {\n		vec2 uv;\n		if ( face == 0.0 ) {\n			uv = vec2( direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 1.0 ) {\n			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n		} else if ( face == 2.0 ) {\n			uv = vec2( - direction.x, direction.y ) / abs( direction.z );\n		} else if ( face == 3.0 ) {\n			uv = vec2( - direction.z, direction.y ) / abs( direction.x );\n		} else if ( face == 4.0 ) {\n			uv = vec2( - direction.x, direction.z ) / abs( direction.y );\n		} else {\n			uv = vec2( direction.x, direction.y ) / abs( direction.z );\n		}\n		return 0.5 * ( uv + 1.0 );\n	}\n	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n		float face = getFace( direction );\n		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n		mipInt = max( mipInt, cubeUV_minMipLevel );\n		float faceSize = exp2( mipInt );\n		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n		if ( face > 2.0 ) {\n			uv.y += faceSize;\n			face -= 3.0;\n		}\n		uv.x += face * faceSize;\n		uv.x += filterInt * 3.0 * cubeUV_minTileSize;\n		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n		uv.x *= CUBEUV_TEXEL_WIDTH;\n		uv.y *= CUBEUV_TEXEL_HEIGHT;\n		#ifdef texture2DGradEXT\n			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n		#else\n			return texture2D( envMap, uv ).rgb;\n		#endif\n	}\n	#define cubeUV_r0 1.0\n	#define cubeUV_v0 0.339\n	#define cubeUV_m0 - 2.0\n	#define cubeUV_r1 0.8\n	#define cubeUV_v1 0.276\n	#define cubeUV_m1 - 1.0\n	#define cubeUV_r4 0.4\n	#define cubeUV_v4 0.046\n	#define cubeUV_m4 2.0\n	#define cubeUV_r5 0.305\n	#define cubeUV_v5 0.016\n	#define cubeUV_m5 3.0\n	#define cubeUV_r6 0.21\n	#define cubeUV_v6 0.0038\n	#define cubeUV_m6 4.0\n	float roughnessToMip( float roughness ) {\n		float mip = 0.0;\n		if ( roughness >= cubeUV_r1 ) {\n			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n		} else if ( roughness >= cubeUV_r4 ) {\n			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n		} else if ( roughness >= cubeUV_r5 ) {\n			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n		} else if ( roughness >= cubeUV_r6 ) {\n			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n		} else {\n			mip = - 2.0 * log2( 1.16 * roughness );		}\n		return mip;\n	}\n	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n		float mipF = fract( mip );\n		float mipInt = floor( mip );\n		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n		if ( mipF == 0.0 ) {\n			return vec4( color0, 1.0 );\n		} else {\n			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n			return vec4( mix( color0, color1, mipF ), 1.0 );\n		}\n	}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n	mat3 m = mat3( instanceMatrix );\n	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n	transformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n	transformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#ifdef FLIP_SIDED\n		transformedTangent = - transformedTangent;\n	#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n	uniform sampler2D displacementMap;\n	uniform float displacementScale;\n	uniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n	totalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n	uniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n	return value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vec3 cameraToFrag;\n		if ( isOrthographic ) {\n			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToFrag = normalize( vWorldPosition - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vec3 reflectVec = reflect( cameraToFrag, worldNormal );\n		#else\n			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n		#endif\n	#else\n		vec3 reflectVec = vReflect;\n	#endif\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n	#else\n		vec4 envColor = vec4( 0.0 );\n	#endif\n	#ifdef ENVMAP_BLENDING_MULTIPLY\n		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_MIX )\n		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n	#elif defined( ENVMAP_BLENDING_ADD )\n		outgoingLight += envColor.xyz * specularStrength * reflectivity;\n	#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float envMapIntensity;\n	uniform float flipEnvMap;\n	#ifdef ENVMAP_TYPE_CUBE\n		uniform samplerCube envMap;\n	#else\n		uniform sampler2D envMap;\n	#endif\n	\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n	uniform float reflectivity;\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		varying vec3 vWorldPosition;\n		uniform float refractionRatio;\n	#else\n		varying vec3 vReflect;\n	#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n		#define ENV_WORLDPOS\n	#endif\n	#ifdef ENV_WORLDPOS\n		\n		varying vec3 vWorldPosition;\n	#else\n		varying vec3 vReflect;\n		uniform float refractionRatio;\n	#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n	vec3 getIBLIrradiance( const in vec3 normal ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n			return PI * envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n		#ifdef ENVMAP_TYPE_CUBE_UV\n			vec3 reflectVec = reflect( - viewDir, normal );\n			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n			return envMapColor.rgb * envMapIntensity;\n		#else\n			return vec3( 0.0 );\n		#endif\n	}\n	#ifdef USE_ANISOTROPY\n		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n			#ifdef ENVMAP_TYPE_CUBE_UV\n				vec3 bentNormal = cross( bitangent, viewDir );\n				bentNormal = normalize( cross( bentNormal, bitangent ) );\n				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n				return getIBLRadiance( viewDir, bentNormal, roughness );\n			#else\n				return vec3( 0.0 );\n			#endif\n		}\n	#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n	#ifdef ENV_WORLDPOS\n		vWorldPosition = worldPosition.xyz;\n	#else\n		vec3 cameraToVertex;\n		if ( isOrthographic ) {\n			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n		} else {\n			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n		}\n		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n		#ifdef ENVMAP_MODE_REFLECTION\n			vReflect = reflect( cameraToVertex, worldNormal );\n		#else\n			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n		#endif\n	#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n	vFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n	varying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n	#ifdef FOG_EXP2\n		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n	#else\n		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n	#endif\n	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n	uniform vec3 fogColor;\n	varying float vFogDepth;\n	#ifdef FOG_EXP2\n		uniform float fogDensity;\n	#else\n		uniform float fogNear;\n		uniform float fogFar;\n	#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n	uniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n	float dotNL = dot( normal, lightDirection );\n	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n	#ifdef USE_GRADIENTMAP\n		return vec3( texture2D( gradientMap, coord ).r );\n	#else\n		vec2 fw = fwidth( coord ) * 0.5;\n		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n	#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n	vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n	reflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n	uniform sampler2D lightMap;\n	uniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n	vec3 diffuseColor;\n	float specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Lambert\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n	float x = normal.x, y = normal.y, z = normal.z;\n	vec3 result = shCoefficients[ 0 ] * 0.886227;\n	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n	return result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n	return irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n	vec3 irradiance = ambientLightColor;\n	return irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n	#if defined ( LEGACY_LIGHTS )\n		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n		}\n		return 1.0;\n	#else\n		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n		if ( cutoffDistance > 0.0 ) {\n			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n		}\n		return distanceFalloff;\n	#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n	return smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n	struct DirectionalLight {\n		vec3 direction;\n		vec3 color;\n	};\n	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n		light.color = directionalLight.color;\n		light.direction = directionalLight.direction;\n		light.visible = true;\n	}\n#endif\n#if NUM_POINT_LIGHTS > 0\n	struct PointLight {\n		vec3 position;\n		vec3 color;\n		float distance;\n		float decay;\n	};\n	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n		vec3 lVector = pointLight.position - geometry.position;\n		light.direction = normalize( lVector );\n		float lightDistance = length( lVector );\n		light.color = pointLight.color;\n		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n		light.visible = ( light.color != vec3( 0.0 ) );\n	}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n	struct SpotLight {\n		vec3 position;\n		vec3 direction;\n		vec3 color;\n		float distance;\n		float decay;\n		float coneCos;\n		float penumbraCos;\n	};\n	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n		vec3 lVector = spotLight.position - geometry.position;\n		light.direction = normalize( lVector );\n		float angleCos = dot( light.direction, spotLight.direction );\n		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n		if ( spotAttenuation > 0.0 ) {\n			float lightDistance = length( lVector );\n			light.color = spotLight.color * spotAttenuation;\n			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n			light.visible = ( light.color != vec3( 0.0 ) );\n		} else {\n			light.color = vec3( 0.0 );\n			light.visible = false;\n		}\n	}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n	struct RectAreaLight {\n		vec3 color;\n		vec3 position;\n		vec3 halfWidth;\n		vec3 halfHeight;\n	};\n	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;\n	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n	struct HemisphereLight {\n		vec3 direction;\n		vec3 skyColor;\n		vec3 groundColor;\n	};\n	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n		float dotNL = dot( normal, hemiLight.direction );\n		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n		return irradiance;\n	}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n	vec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_Toon\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n	vec3 diffuseColor;\n	vec3 specularColor;\n	float specularShininess;\n	float specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct				RE_Direct_BlinnPhong\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n	material.ior = ior;\n	#ifdef USE_SPECULAR\n		float specularIntensityFactor = specularIntensity;\n		vec3 specularColorFactor = specularColor;\n		#ifdef USE_SPECULAR_COLORMAP\n			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n		#endif\n		#ifdef USE_SPECULAR_INTENSITYMAP\n			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n		#endif\n		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n	#else\n		float specularIntensityFactor = 1.0;\n		vec3 specularColorFactor = vec3( 1.0 );\n		material.specularF90 = 1.0;\n	#endif\n	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n	material.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n	material.clearcoat = clearcoat;\n	material.clearcoatRoughness = clearcoatRoughness;\n	material.clearcoatF0 = vec3( 0.04 );\n	material.clearcoatF90 = 1.0;\n	#ifdef USE_CLEARCOATMAP\n		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n	#endif\n	#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n	#endif\n	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n	material.clearcoatRoughness += geometryRoughness;\n	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n	material.iridescence = iridescence;\n	material.iridescenceIOR = iridescenceIOR;\n	#ifdef USE_IRIDESCENCEMAP\n		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n	#endif\n	#ifdef USE_IRIDESCENCE_THICKNESSMAP\n		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n	#else\n		material.iridescenceThickness = iridescenceThicknessMaximum;\n	#endif\n#endif\n#ifdef USE_SHEEN\n	material.sheenColor = sheenColor;\n	#ifdef USE_SHEEN_COLORMAP\n		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n	#endif\n	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	#ifdef USE_ANISOTROPYMAP\n		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n	#else\n		vec2 anisotropyV = anisotropyVector;\n	#endif\n	material.anisotropy = length( anisotropyV );\n	anisotropyV /= material.anisotropy;\n	material.anisotropy = saturate( material.anisotropy );\n	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n	material.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n	material.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n	vec3 diffuseColor;\n	float roughness;\n	vec3 specularColor;\n	float specularF90;\n	#ifdef USE_CLEARCOAT\n		float clearcoat;\n		float clearcoatRoughness;\n		vec3 clearcoatF0;\n		float clearcoatF90;\n	#endif\n	#ifdef USE_IRIDESCENCE\n		float iridescence;\n		float iridescenceIOR;\n		float iridescenceThickness;\n		vec3 iridescenceFresnel;\n		vec3 iridescenceF0;\n	#endif\n	#ifdef USE_SHEEN\n		vec3 sheenColor;\n		float sheenRoughness;\n	#endif\n	#ifdef IOR\n		float ior;\n	#endif\n	#ifdef USE_TRANSMISSION\n		float transmission;\n		float transmissionAlpha;\n		float thickness;\n		float attenuationDistance;\n		vec3 attenuationColor;\n	#endif\n	#ifdef USE_ANISOTROPY\n		float anisotropy;\n		float alphaT;\n		vec3 anisotropyT;\n		vec3 anisotropyB;\n	#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n	float a2 = pow2( alpha );\n	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n	return 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n	float a2 = pow2( alpha );\n	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n	return RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n		float v = 0.5 / ( gv + gl );\n		return saturate(v);\n	}\n	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n		float a2 = alphaT * alphaB;\n		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n		highp float v2 = dot( v, v );\n		float w2 = a2 / v2;\n		return RECIPROCAL_PI * a2 * pow2 ( w2 );\n	}\n#endif\n#ifdef USE_CLEARCOAT\n	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n		vec3 f0 = material.clearcoatF0;\n		float f90 = material.clearcoatF90;\n		float roughness = material.clearcoatRoughness;\n		float alpha = pow2( roughness );\n		vec3 halfDir = normalize( lightDir + viewDir );\n		float dotNL = saturate( dot( normal, lightDir ) );\n		float dotNV = saturate( dot( normal, viewDir ) );\n		float dotNH = saturate( dot( normal, halfDir ) );\n		float dotVH = saturate( dot( viewDir, halfDir ) );\n		vec3 F = F_Schlick( f0, f90, dotVH );\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n		return F * ( V * D );\n	}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n	vec3 f0 = material.specularColor;\n	float f90 = material.specularF90;\n	float roughness = material.roughness;\n	float alpha = pow2( roughness );\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float dotVH = saturate( dot( viewDir, halfDir ) );\n	vec3 F = F_Schlick( f0, f90, dotVH );\n	#ifdef USE_IRIDESCENCE\n		F = mix( F, material.iridescenceFresnel, material.iridescence );\n	#endif\n	#ifdef USE_ANISOTROPY\n		float dotTL = dot( material.anisotropyT, lightDir );\n		float dotTV = dot( material.anisotropyT, viewDir );\n		float dotTH = dot( material.anisotropyT, halfDir );\n		float dotBL = dot( material.anisotropyB, lightDir );\n		float dotBV = dot( material.anisotropyB, viewDir );\n		float dotBH = dot( material.anisotropyB, halfDir );\n		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n	#else\n		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n		float D = D_GGX( alpha, dotNH );\n	#endif\n	return F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n	const float LUT_SIZE = 64.0;\n	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n	const float LUT_BIAS = 0.5 / LUT_SIZE;\n	float dotNV = saturate( dot( N, V ) );\n	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n	uv = uv * LUT_SCALE + LUT_BIAS;\n	return uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n	float l = length( f );\n	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n	float x = dot( v1, v2 );\n	float y = abs( x );\n	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n	float b = 3.4175940 + ( 4.1616724 + y ) * y;\n	float v = a / b;\n	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n	return cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n	vec3 lightNormal = cross( v1, v2 );\n	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n	vec3 T1, T2;\n	T1 = normalize( V - N * dot( V, N ) );\n	T2 = - cross( N, T1 );\n	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n	vec3 coords[ 4 ];\n	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n	coords[ 0 ] = normalize( coords[ 0 ] );\n	coords[ 1 ] = normalize( coords[ 1 ] );\n	coords[ 2 ] = normalize( coords[ 2 ] );\n	coords[ 3 ] = normalize( coords[ 3 ] );\n	vec3 vectorFormFactor = vec3( 0.0 );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n	return vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n	float alpha = pow2( roughness );\n	float invAlpha = 1.0 / alpha;\n	float cos2h = dotNH * dotNH;\n	float sin2h = max( 1.0 - cos2h, 0.0078125 );\n	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n	vec3 halfDir = normalize( lightDir + viewDir );\n	float dotNL = saturate( dot( normal, lightDir ) );\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float dotNH = saturate( dot( normal, halfDir ) );\n	float D = D_Charlie( sheenRoughness, dotNH );\n	float V = V_Neubelt( dotNV, dotNL );\n	return sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	float r2 = roughness * roughness;\n	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n	return saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n	float dotNV = saturate( dot( normal, viewDir ) );\n	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n	vec4 r = roughness * c0 + c1;\n	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n	return fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	return specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n	vec2 fab = DFGApprox( normal, viewDir, roughness );\n	#ifdef USE_IRIDESCENCE\n		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n	#else\n		vec3 Fr = specularColor;\n	#endif\n	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n	float Ess = fab.x + fab.y;\n	float Ems = 1.0 - Ess;\n	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n	singleScatter += FssEss;\n	multiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n		vec3 normal = geometry.normal;\n		vec3 viewDir = geometry.viewDir;\n		vec3 position = geometry.position;\n		vec3 lightPos = rectAreaLight.position;\n		vec3 halfWidth = rectAreaLight.halfWidth;\n		vec3 halfHeight = rectAreaLight.halfHeight;\n		vec3 lightColor = rectAreaLight.color;\n		float roughness = material.roughness;\n		vec3 rectCoords[ 4 ];\n		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n		vec2 uv = LTC_Uv( normal, viewDir, roughness );\n		vec4 t1 = texture2D( ltc_1, uv );\n		vec4 t2 = texture2D( ltc_2, uv );\n		mat3 mInv = mat3(\n			vec3( t1.x, 0, t1.y ),\n			vec3(    0, 1,    0 ),\n			vec3( t1.z, 0, t1.w )\n		);\n		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n	}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n	vec3 irradiance = dotNL * directLight.color;\n	#ifdef USE_CLEARCOAT\n		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n		vec3 ccIrradiance = dotNLcc * directLight.color;\n		clearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n	#endif\n	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n	#ifdef USE_CLEARCOAT\n		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n	#endif\n	#ifdef USE_SHEEN\n		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n	#endif\n	vec3 singleScattering = vec3( 0.0 );\n	vec3 multiScattering = vec3( 0.0 );\n	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n	#ifdef USE_IRIDESCENCE\n		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n	#else\n		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n	#endif\n	vec3 totalScattering = singleScattering + multiScattering;\n	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n	reflectedLight.indirectSpecular += radiance * singleScattering;\n	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct				RE_Direct_Physical\n#define RE_Direct_RectArea		RE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular		RE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n	geometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n	float dotNVi = saturate( dot( normal, geometry.viewDir ) );\n	if ( material.iridescenceThickness == 0.0 ) {\n		material.iridescence = 0.0;\n	} else {\n		material.iridescence = saturate( material.iridescence );\n	}\n	if ( material.iridescence > 0.0 ) {\n		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n	}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n	PointLight pointLight;\n	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n		pointLight = pointLights[ i ];\n		getPointLightInfo( pointLight, geometry, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n		pointLightShadow = pointLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n	SpotLight spotLight;\n	vec4 spotColor;\n	vec3 spotLightCoord;\n	bool inSpotLightMap;\n	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n		spotLight = spotLights[ i ];\n		getSpotLightInfo( spotLight, geometry, directLight );\n		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n		#else\n		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n		#endif\n		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n		#endif\n		#undef SPOT_LIGHT_MAP_INDEX\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n		spotLightShadow = spotLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n	DirectionalLight directionalLight;\n	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLightShadow;\n	#endif\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n		directionalLight = directionalLights[ i ];\n		getDirectionalLightInfo( directionalLight, geometry, directLight );\n		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n		directionalLightShadow = directionalLightShadows[ i ];\n		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n		#endif\n		RE_Direct( directLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n	RectAreaLight rectAreaLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n		rectAreaLight = rectAreaLights[ i ];\n		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n	}\n	#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n	vec3 iblIrradiance = vec3( 0.0 );\n	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n	#if ( NUM_HEMI_LIGHTS > 0 )\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if defined( RE_IndirectSpecular )\n	vec3 radiance = vec3( 0.0 );\n	vec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n		irradiance += lightMapIrradiance;\n	#endif\n	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n		iblIrradiance += getIBLIrradiance( geometry.normal );\n	#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n	#ifdef USE_ANISOTROPY\n		radiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n	#else\n		radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n	#endif\n	#ifdef USE_CLEARCOAT\n		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n	#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n	uniform float logDepthBufFC;\n	varying float vFragDepth;\n	varying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		varying float vFragDepth;\n		varying float vIsPerspective;\n	#else\n		uniform float logDepthBufFC;\n	#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n	#ifdef USE_LOGDEPTHBUF_EXT\n		vFragDepth = 1.0 + gl_Position.w;\n		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n	#else\n		if ( isPerspectiveMatrix( projectionMatrix ) ) {\n			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n			gl_Position.z *= gl_Position.w;\n		}\n	#endif\n#endif",map_fragment:"#ifdef USE_MAP\n	vec4 sampledDiffuseColor = texture2D( map, vMapUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n	\n	#endif\n	diffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n	uniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n	#if defined( USE_POINTS_UV )\n		vec2 uv = vUv;\n	#else\n		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n	#endif\n#endif\n#ifdef USE_MAP\n	diffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n	diffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n	varying vec2 vUv;\n#else\n	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n		uniform mat3 uvTransform;\n	#endif\n#endif\n#ifdef USE_MAP\n	uniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n	metalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n	uniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n	vColor *= morphTargetBaseInfluence;\n	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n		#if defined( USE_COLOR_ALPHA )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n		#elif defined( USE_COLOR )\n			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n		#endif\n	}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n	objectNormal *= morphTargetBaseInfluence;\n	#ifdef MORPHTARGETS_TEXTURE\n		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n		}\n	#else\n		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n	#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n	uniform float morphTargetBaseInfluence;\n	#ifdef MORPHTARGETS_TEXTURE\n		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n		uniform sampler2DArray morphTargetsTexture;\n		uniform ivec2 morphTargetsTextureSize;\n		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n			int y = texelIndex / morphTargetsTextureSize.x;\n			int x = texelIndex - y * morphTargetsTextureSize.x;\n			ivec3 morphUV = ivec3( x, y, morphTargetIndex );\n			return texelFetch( morphTargetsTexture, morphUV, 0 );\n		}\n	#else\n		#ifndef USE_MORPHNORMALS\n			uniform float morphTargetInfluences[ 8 ];\n		#else\n			uniform float morphTargetInfluences[ 4 ];\n		#endif\n	#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n	transformed *= morphTargetBaseInfluence;\n	#ifdef MORPHTARGETS_TEXTURE\n		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n		}\n	#else\n		transformed += morphTarget0 * morphTargetInfluences[ 0 ];\n		transformed += morphTarget1 * morphTargetInfluences[ 1 ];\n		transformed += morphTarget2 * morphTargetInfluences[ 2 ];\n		transformed += morphTarget3 * morphTargetInfluences[ 3 ];\n		#ifndef USE_MORPHNORMALS\n			transformed += morphTarget4 * morphTargetInfluences[ 4 ];\n			transformed += morphTarget5 * morphTargetInfluences[ 5 ];\n			transformed += morphTarget6 * morphTargetInfluences[ 6 ];\n			transformed += morphTarget7 * morphTargetInfluences[ 7 ];\n		#endif\n	#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n	vec3 fdx = dFdx( vViewPosition );\n	vec3 fdy = dFdy( vViewPosition );\n	vec3 normal = normalize( cross( fdx, fdy ) );\n#else\n	vec3 normal = normalize( vNormal );\n	#ifdef DOUBLE_SIDED\n		normal *= faceDirection;\n	#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n	#ifdef USE_TANGENT\n		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn = getTangentFrame( - vViewPosition, normal,\n		#if defined( USE_NORMALMAP )\n			vNormalMapUv\n		#elif defined( USE_CLEARCOAT_NORMALMAP )\n			vClearcoatNormalMapUv\n		#else\n			vUv\n		#endif\n		);\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn[0] *= faceDirection;\n		tbn[1] *= faceDirection;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	#ifdef USE_TANGENT\n		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n	#else\n		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n	#endif\n	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n		tbn2[0] *= faceDirection;\n		tbn2[1] *= faceDirection;\n	#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	#ifdef FLIP_SIDED\n		normal = - normal;\n	#endif\n	#ifdef DOUBLE_SIDED\n		normal = normal * faceDirection;\n	#endif\n	normal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n	mapN.xy *= normalScale;\n	normal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n	#ifdef USE_TANGENT\n		varying vec3 vTangent;\n		varying vec3 vBitangent;\n	#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n	vNormal = normalize( transformedNormal );\n	#ifdef USE_TANGENT\n		vTangent = normalize( transformedTangent );\n		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n	#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n	uniform sampler2D normalMap;\n	uniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n	uniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n		vec3 q0 = dFdx( eye_pos.xyz );\n		vec3 q1 = dFdy( eye_pos.xyz );\n		vec2 st0 = dFdx( uv.st );\n		vec2 st1 = dFdy( uv.st );\n		vec3 N = surf_norm;\n		vec3 q1perp = cross( q1, N );\n		vec3 q0perp = cross( N, q0 );\n		vec3 T = q1perp * st0.x + q0perp * st1.x;\n		vec3 B = q1perp * st0.y + q0perp * st1.y;\n		float det = max( dot( T, T ), dot( B, B ) );\n		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n		return mat3( T * scale, B * scale, N );\n	}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n	vec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n	clearcoatMapN.xy *= clearcoatNormalScale;\n	clearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n	uniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform sampler2D clearcoatNormalMap;\n	uniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n	uniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n	return normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n	return 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n	vec4 r = vec4( fract( v * PackFactors ), v );\n	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n	return dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n	return packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n	return unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n	return ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n	gl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n	mvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n	gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n	vec3 dithering( vec3 color ) {\n		float grid_position = rand( gl_FragCoord.xy );\n		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n		return color + dither_shift_RGB;\n	}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n	roughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n	uniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n		struct SpotLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n	}\n	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n		return unpackRGBATo2Half( texture2D( shadow, uv ) );\n	}\n	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n		float occlusion = 1.0;\n		vec2 distribution = texture2DDistribution( shadow, uv );\n		float hard_shadow = step( compare , distribution.x );\n		if (hard_shadow != 1.0 ) {\n			float distance = compare - distribution.x ;\n			float variance = max( 0.00000, distribution.y * distribution.y );\n			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n		}\n		return occlusion;\n	}\n	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n		float shadow = 1.0;\n		shadowCoord.xyz /= shadowCoord.w;\n		shadowCoord.z += shadowBias;\n		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n		if ( frustumTest ) {\n		#if defined( SHADOWMAP_TYPE_PCF )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx0 = - texelSize.x * shadowRadius;\n			float dy0 = - texelSize.y * shadowRadius;\n			float dx1 = + texelSize.x * shadowRadius;\n			float dy1 = + texelSize.y * shadowRadius;\n			float dx2 = dx0 / 2.0;\n			float dy2 = dy0 / 2.0;\n			float dx3 = dx1 / 2.0;\n			float dy3 = dy1 / 2.0;\n			shadow = (\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n			) * ( 1.0 / 17.0 );\n		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n			float dx = texelSize.x;\n			float dy = texelSize.y;\n			vec2 uv = shadowCoord.xy;\n			vec2 f = fract( uv * shadowMapSize + 0.5 );\n			uv -= f * texelSize;\n			shadow = (\n				texture2DCompare( shadowMap, uv, shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n					 f.x ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n					 f.y ) +\n				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n						  f.x ),\n					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n						  f.x ),\n					 f.y )\n			) * ( 1.0 / 9.0 );\n		#elif defined( SHADOWMAP_TYPE_VSM )\n			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#else\n			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n		#endif\n		}\n		return shadow;\n	}\n	vec2 cubeToUV( vec3 v, float texelSizeY ) {\n		vec3 absV = abs( v );\n		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n		absV *= scaleToCube;\n		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n		vec2 planar = v.xy;\n		float almostATexel = 1.5 * texelSizeY;\n		float almostOne = 1.0 - almostATexel;\n		if ( absV.z >= almostOne ) {\n			if ( v.z > 0.0 )\n				planar.x = 4.0 - v.x;\n		} else if ( absV.x >= almostOne ) {\n			float signX = sign( v.x );\n			planar.x = v.z * signX + 2.0 * signX;\n		} else if ( absV.y >= almostOne ) {\n			float signY = sign( v.y );\n			planar.x = v.x + 2.0 * signY + 2.0;\n			planar.y = v.z * signY - 2.0;\n		}\n		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n	}\n	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n		vec3 lightToPosition = shadowCoord.xyz;\n		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;\n		vec3 bd3D = normalize( lightToPosition );\n		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n			return (\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n			) * ( 1.0 / 9.0 );\n		#else\n			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n		#endif\n	}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n		struct DirectionalLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n		struct SpotLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n		};\n		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n		struct PointLightShadow {\n			float shadowBias;\n			float shadowNormalBias;\n			float shadowRadius;\n			vec2 shadowMapSize;\n			float shadowCameraNear;\n			float shadowCameraFar;\n		};\n		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n	#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n	vec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n		#pragma unroll_loop_start\n		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n		}\n		#pragma unroll_loop_end\n	#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n		shadowWorldPosition = worldPosition;\n		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n		#endif\n		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n	}\n	#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n	float shadow = 1.0;\n	#ifdef USE_SHADOWMAP\n	#if NUM_DIR_LIGHT_SHADOWS > 0\n	DirectionalLightShadow directionalLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n		directionalLight = directionalLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_SPOT_LIGHT_SHADOWS > 0\n	SpotLightShadow spotLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n		spotLight = spotLightShadows[ i ];\n		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#if NUM_POINT_LIGHT_SHADOWS > 0\n	PointLightShadow pointLight;\n	#pragma unroll_loop_start\n	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n		pointLight = pointLightShadows[ i ];\n		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n	}\n	#pragma unroll_loop_end\n	#endif\n	#endif\n	return shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n	mat4 boneMatX = getBoneMatrix( skinIndex.x );\n	mat4 boneMatY = getBoneMatrix( skinIndex.y );\n	mat4 boneMatZ = getBoneMatrix( skinIndex.z );\n	mat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n	uniform mat4 bindMatrix;\n	uniform mat4 bindMatrixInverse;\n	uniform highp sampler2D boneTexture;\n	uniform int boneTextureSize;\n	mat4 getBoneMatrix( const in float i ) {\n		float j = i * 4.0;\n		float x = mod( j, float( boneTextureSize ) );\n		float y = floor( j / float( boneTextureSize ) );\n		float dx = 1.0 / float( boneTextureSize );\n		float dy = 1.0 / float( boneTextureSize );\n		y = dy * ( y + 0.5 );\n		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n		mat4 bone = mat4( v1, v2, v3, v4 );\n		return bone;\n	}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n	vec4 skinned = vec4( 0.0 );\n	skinned += boneMatX * skinVertex * skinWeight.x;\n	skinned += boneMatY * skinVertex * skinWeight.y;\n	skinned += boneMatZ * skinVertex * skinWeight.z;\n	skinned += boneMatW * skinVertex * skinWeight.w;\n	transformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n	mat4 skinMatrix = mat4( 0.0 );\n	skinMatrix += skinWeight.x * boneMatX;\n	skinMatrix += skinWeight.y * boneMatY;\n	skinMatrix += skinWeight.z * boneMatZ;\n	skinMatrix += skinWeight.w * boneMatW;\n	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n	#ifdef USE_TANGENT\n		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n	#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n	specularStrength = texelSpecular.r;\n#else\n	specularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n	uniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n	return saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	return saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n	color *= toneMappingExposure;\n	color = max( vec3( 0.0 ), color - 0.004 );\n	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n	return a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n	const mat3 ACESInputMat = mat3(\n		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),\n		vec3( 0.04823, 0.01566, 0.83777 )\n	);\n	const mat3 ACESOutputMat = mat3(\n		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),\n		vec3( -0.07367, -0.00605,  1.07602 )\n	);\n	color *= toneMappingExposure / 0.6;\n	color = ACESInputMat * color;\n	color = RRTAndODTFit( color );\n	color = ACESOutputMat * color;\n	return saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n	material.transmission = transmission;\n	material.transmissionAlpha = 1.0;\n	material.thickness = thickness;\n	material.attenuationDistance = attenuationDistance;\n	material.attenuationColor = attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n	#endif\n	vec3 pos = vWorldPosition;\n	vec3 v = normalize( cameraPosition - pos );\n	vec3 n = inverseTransformDirection( normal, viewMatrix );\n	vec4 transmitted = getIBLVolumeRefraction(\n		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n		pos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n		material.attenuationColor, material.attenuationDistance );\n	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n	uniform float transmission;\n	uniform float thickness;\n	uniform float attenuationDistance;\n	uniform vec3 attenuationColor;\n	#ifdef USE_TRANSMISSIONMAP\n		uniform sampler2D transmissionMap;\n	#endif\n	#ifdef USE_THICKNESSMAP\n		uniform sampler2D thicknessMap;\n	#endif\n	uniform vec2 transmissionSamplerSize;\n	uniform sampler2D transmissionSamplerMap;\n	uniform mat4 modelMatrix;\n	uniform mat4 projectionMatrix;\n	varying vec3 vWorldPosition;\n	float w0( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n	}\n	float w1( float a ) {\n		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n	}\n	float w2( float a ){\n		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n	}\n	float w3( float a ) {\n		return ( 1.0 / 6.0 ) * ( a * a * a );\n	}\n	float g0( float a ) {\n		return w0( a ) + w1( a );\n	}\n	float g1( float a ) {\n		return w2( a ) + w3( a );\n	}\n	float h0( float a ) {\n		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n	}\n	float h1( float a ) {\n		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n	}\n	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n		uv = uv * texelSize.zw + 0.5;\n		vec2 iuv = floor( uv );\n		vec2 fuv = fract( uv );\n		float g0x = g0( fuv.x );\n		float g1x = g1( fuv.x );\n		float h0x = h0( fuv.x );\n		float h1x = h1( fuv.x );\n		float h0y = h0( fuv.y );\n		float h1y = h1( fuv.y );\n		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n	}\n	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n		vec2 fLodSizeInv = 1.0 / fLodSize;\n		vec2 cLodSizeInv = 1.0 / cLodSize;\n		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n		return mix( fSample, cSample, fract( lod ) );\n	}\n	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n		vec3 modelScale;\n		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n		return normalize( refractionVector ) * thickness * modelScale;\n	}\n	float applyIorToRoughness( const in float roughness, const in float ior ) {\n		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n	}\n	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n	}\n	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n		if ( isinf( attenuationDistance ) ) {\n			return vec3( 1.0 );\n		} else {\n			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;\n		}\n	}\n	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n		const in vec3 attenuationColor, const in float attenuationDistance ) {\n		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n		vec3 refractedRayExit = position + transmissionRay;\n		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n		vec2 refractionCoords = ndcPos.xy / ndcPos.w;\n		refractionCoords += 1.0;\n		refractionCoords /= 2.0;\n		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n		vec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n		vec3 attenuatedColor = transmittance * transmittedLight.rgb;\n		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n	}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	varying vec2 vUv;\n#endif\n#ifdef USE_MAP\n	uniform mat3 mapTransform;\n	varying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n	uniform mat3 alphaMapTransform;\n	varying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n	uniform mat3 lightMapTransform;\n	varying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n	uniform mat3 aoMapTransform;\n	varying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n	uniform mat3 bumpMapTransform;\n	varying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n	uniform mat3 normalMapTransform;\n	varying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	uniform mat3 displacementMapTransform;\n	varying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n	uniform mat3 emissiveMapTransform;\n	varying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n	uniform mat3 metalnessMapTransform;\n	varying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	uniform mat3 roughnessMapTransform;\n	varying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	uniform mat3 anisotropyMapTransform;\n	varying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n	uniform mat3 clearcoatMapTransform;\n	varying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	uniform mat3 clearcoatNormalMapTransform;\n	varying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	uniform mat3 clearcoatRoughnessMapTransform;\n	varying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	uniform mat3 sheenColorMapTransform;\n	varying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	uniform mat3 sheenRoughnessMapTransform;\n	varying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	uniform mat3 iridescenceMapTransform;\n	varying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	uniform mat3 iridescenceThicknessMapTransform;\n	varying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n	uniform mat3 specularMapTransform;\n	varying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	uniform mat3 specularColorMapTransform;\n	varying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	uniform mat3 specularIntensityMapTransform;\n	varying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	uniform mat3 transmissionMapTransform;\n	varying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n	uniform mat3 thicknessMapTransform;\n	varying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n	vUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n	vec4 worldPosition = vec4( transformed, 1.0 );\n	#ifdef USE_INSTANCING\n		worldPosition = instanceMatrix * worldPosition;\n	#endif\n	worldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	gl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n	vec4 texColor = texture2D( t2D, vUv );\n	#ifdef DECODE_VIDEO_TEXTURE\n		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n	uniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n	uniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n	#ifdef ENVMAP_TYPE_CUBE\n		vec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n	#elif defined( ENVMAP_TYPE_CUBE_UV )\n		vec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n	#else\n		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n	#endif\n	texColor.rgb *= backgroundIntensity;\n	gl_FragColor = texColor;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n	gl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n	gl_FragColor = texColor;\n	gl_FragColor.a *= opacity;\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n	uniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#if DEPTH_PACKING == 3200\n		diffuseColor.a = opacity;\n	#endif\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <logdepthbuf_fragment>\n	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n	#if DEPTH_PACKING == 3200\n		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n	#elif DEPTH_PACKING == 3201\n		gl_FragColor = packDepthToRGBA( fragCoordZ );\n	#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <skinbase_vertex>\n	#ifdef USE_DISPLACEMENTMAP\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <worldpos_vertex>\n	#include <clipping_planes_vertex>\n	vWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( 1.0 );\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	float dist = length( vWorldPosition - referencePosition );\n	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n	dist = saturate( dist );\n	gl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vWorldDirection = transformDirection( position, modelMatrix );\n	#include <begin_vertex>\n	#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n	vec3 direction = normalize( vWorldDirection );\n	vec2 sampleUV = equirectUv( direction );\n	gl_FragColor = texture2D( tEquirect, sampleUV );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	vLineDistance = scale * lineDistance;\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	if ( mod( vLineDistance, totalSize ) > dashSize ) {\n		discard;\n	}\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n		#include <beginnormal_vertex>\n		#include <morphnormal_vertex>\n		#include <skinbase_vertex>\n		#include <skinnormal_vertex>\n		#include <defaultnormal_vertex>\n	#endif\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n	varying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	#ifdef USE_LIGHTMAP\n		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n	#else\n		reflectedLight.indirectDiffuse += vec3( 1.0 );\n	#endif\n	#include <aomap_fragment>\n	reflectedLight.indirectDiffuse *= diffuseColor.rgb;\n	vec3 outgoingLight = reflectedLight.indirectDiffuse;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_lambert_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n	vViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	vec3 viewDir = normalize( vViewPosition );\n	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n	vec3 y = cross( viewDir, x );\n	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n	#ifdef USE_MATCAP\n		vec4 matcapColor = texture2D( matcap, uv );\n	#else\n		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n	#endif\n	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	vViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n	varying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	#include <logdepthbuf_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n	#ifdef OPAQUE\n		gl_FragColor.a = 1.0;\n	#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <envmap_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <specularmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_phong_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n	#include <envmap_fragment>\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n	varying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n	vWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n	#define IOR\n	#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n	uniform float ior;\n#endif\n#ifdef USE_SPECULAR\n	uniform float specularIntensity;\n	uniform vec3 specularColor;\n	#ifdef USE_SPECULAR_COLORMAP\n		uniform sampler2D specularColorMap;\n	#endif\n	#ifdef USE_SPECULAR_INTENSITYMAP\n		uniform sampler2D specularIntensityMap;\n	#endif\n#endif\n#ifdef USE_CLEARCOAT\n	uniform float clearcoat;\n	uniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n	uniform float iridescence;\n	uniform float iridescenceIOR;\n	uniform float iridescenceThicknessMinimum;\n	uniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n	uniform vec3 sheenColor;\n	uniform float sheenRoughness;\n	#ifdef USE_SHEEN_COLORMAP\n		uniform sampler2D sheenColorMap;\n	#endif\n	#ifdef USE_SHEEN_ROUGHNESSMAP\n		uniform sampler2D sheenRoughnessMap;\n	#endif\n#endif\n#ifdef USE_ANISOTROPY\n	uniform vec2 anisotropyVector;\n	#ifdef USE_ANISOTROPYMAP\n		uniform sampler2D anisotropyMap;\n	#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <roughnessmap_fragment>\n	#include <metalnessmap_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <clearcoat_normal_fragment_begin>\n	#include <clearcoat_normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_physical_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n	#include <transmission_fragment>\n	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n	#ifdef USE_SHEEN\n		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n	#endif\n	#ifdef USE_CLEARCOAT\n		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n	#endif\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <normal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <displacementmap_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	vViewPosition = - mvPosition.xyz;\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n	vec3 totalEmissiveRadiance = emissive;\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <color_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	#include <normal_fragment_begin>\n	#include <normal_fragment_maps>\n	#include <emissivemap_fragment>\n	#include <lights_toon_fragment>\n	#include <lights_fragment_begin>\n	#include <lights_fragment_maps>\n	#include <lights_fragment_end>\n	#include <aomap_fragment>\n	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n	#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n	varying vec2 vUv;\n	uniform mat3 uvTransform;\n#endif\nvoid main() {\n	#ifdef USE_POINTS_UV\n		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n	#endif\n	#include <color_vertex>\n	#include <morphcolor_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <project_vertex>\n	gl_PointSize = size;\n	#ifdef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n	#endif\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <worldpos_vertex>\n	#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_particle_fragment>\n	#include <color_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n	#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n	#include <beginnormal_vertex>\n	#include <morphnormal_vertex>\n	#include <skinbase_vertex>\n	#include <skinnormal_vertex>\n	#include <defaultnormal_vertex>\n	#include <begin_vertex>\n	#include <morphtarget_vertex>\n	#include <skinning_vertex>\n	#include <project_vertex>\n	#include <logdepthbuf_vertex>\n	#include <worldpos_vertex>\n	#include <shadowmap_vertex>\n	#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n	#include <logdepthbuf_fragment>\n	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n	#include <uv_vertex>\n	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n	vec2 scale;\n	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n	#ifndef USE_SIZEATTENUATION\n		bool isPerspective = isPerspectiveMatrix( projectionMatrix );\n		if ( isPerspective ) scale *= - mvPosition.z;\n	#endif\n	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n	vec2 rotatedPosition;\n	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n	mvPosition.xy += rotatedPosition;\n	gl_Position = projectionMatrix * mvPosition;\n	#include <logdepthbuf_vertex>\n	#include <clipping_planes_vertex>\n	#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n	#include <clipping_planes_fragment>\n	vec3 outgoingLight = vec3( 0.0 );\n	vec4 diffuseColor = vec4( diffuse, opacity );\n	#include <logdepthbuf_fragment>\n	#include <map_fragment>\n	#include <alphamap_fragment>\n	#include <alphatest_fragment>\n	#include <alphahash_fragment>\n	outgoingLight = diffuseColor.rgb;\n	#include <opaque_fragment>\n	#include <tonemapping_fragment>\n	#include <colorspace_fragment>\n	#include <fog_fragment>\n}"},ag={common:{diffuse:{value:new nd(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new iP},alphaMap:{value:null},alphaMapTransform:{value:new iP},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new iP}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new iP}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new iP}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new iP},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new iP},normalScale:{value:new iD(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new iP},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new iP}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new iP}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new iP}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new nd(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new nd(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new iP},alphaTest:{value:0},uvTransform:{value:new iP}},sprite:{diffuse:{value:new nd(16777215)},opacity:{value:1},center:{value:new iD(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new iP},alphaMap:{value:null},alphaMapTransform:{value:new iP},alphaTest:{value:0}}},av={basic:{uniforms:n6([ag.common,ag.specularmap,ag.envmap,ag.aomap,ag.lightmap,ag.fog]),vertexShader:am.meshbasic_vert,fragmentShader:am.meshbasic_frag},lambert:{uniforms:n6([ag.common,ag.specularmap,ag.envmap,ag.aomap,ag.lightmap,ag.emissivemap,ag.bumpmap,ag.normalmap,ag.displacementmap,ag.fog,ag.lights,{emissive:{value:new nd(0)}}]),vertexShader:am.meshlambert_vert,fragmentShader:am.meshlambert_frag},phong:{uniforms:n6([ag.common,ag.specularmap,ag.envmap,ag.aomap,ag.lightmap,ag.emissivemap,ag.bumpmap,ag.normalmap,ag.displacementmap,ag.fog,ag.lights,{emissive:{value:new nd(0)},specular:{value:new nd(1118481)},shininess:{value:30}}]),vertexShader:am.meshphong_vert,fragmentShader:am.meshphong_frag},standard:{uniforms:n6([ag.common,ag.envmap,ag.aomap,ag.lightmap,ag.emissivemap,ag.bumpmap,ag.normalmap,ag.displacementmap,ag.roughnessmap,ag.metalnessmap,ag.fog,ag.lights,{emissive:{value:new nd(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:am.meshphysical_vert,fragmentShader:am.meshphysical_frag},toon:{uniforms:n6([ag.common,ag.aomap,ag.lightmap,ag.emissivemap,ag.bumpmap,ag.normalmap,ag.displacementmap,ag.gradientmap,ag.fog,ag.lights,{emissive:{value:new nd(0)}}]),vertexShader:am.meshtoon_vert,fragmentShader:am.meshtoon_frag},matcap:{uniforms:n6([ag.common,ag.bumpmap,ag.normalmap,ag.displacementmap,ag.fog,{matcap:{value:null}}]),vertexShader:am.meshmatcap_vert,fragmentShader:am.meshmatcap_frag},points:{uniforms:n6([ag.points,ag.fog]),vertexShader:am.points_vert,fragmentShader:am.points_frag},dashed:{uniforms:n6([ag.common,ag.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:am.linedashed_vert,fragmentShader:am.linedashed_frag},depth:{uniforms:n6([ag.common,ag.displacementmap]),vertexShader:am.depth_vert,fragmentShader:am.depth_frag},normal:{uniforms:n6([ag.common,ag.bumpmap,ag.normalmap,ag.displacementmap,{opacity:{value:1}}]),vertexShader:am.meshnormal_vert,fragmentShader:am.meshnormal_frag},sprite:{uniforms:n6([ag.sprite,ag.fog]),vertexShader:am.sprite_vert,fragmentShader:am.sprite_frag},background:{uniforms:{uvTransform:{value:new iP},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:am.background_vert,fragmentShader:am.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:am.backgroundCube_vert,fragmentShader:am.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:am.cube_vert,fragmentShader:am.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:am.equirect_vert,fragmentShader:am.equirect_frag},distanceRGBA:{uniforms:n6([ag.common,ag.displacementmap,{referencePosition:{value:new rt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:am.distanceRGBA_vert,fragmentShader:am.distanceRGBA_frag},shadow:{uniforms:n6([ag.lights,ag.fog,{color:{value:new nd(0)},opacity:{value:1}}]),vertexShader:am.shadow_vert,fragmentShader:am.shadow_frag}};av.physical={uniforms:n6([av.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new iP},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new iP},clearcoatNormalScale:{value:new iD(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new iP},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new iP},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new iP},sheen:{value:0},sheenColor:{value:new nd(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new iP},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new iP},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new iP},transmissionSamplerSize:{value:new iD},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new iP},attenuationDistance:{value:0},attenuationColor:{value:new nd(0)},specularColor:{value:new nd(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new iP},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new iP},anisotropyVector:{value:new iD},anisotropyMap:{value:null},anisotropyMapTransform:{value:new iP}}]),vertexShader:am.meshphysical_vert,fragmentShader:am.meshphysical_frag};let ay={r:0,b:0,g:0};function ab(e,t,i,r,n,a,s){let o,l;let u=new nd(0),c=!0===a?0:1,d=null,h=0,f=null;function p(t,i){t.getRGB(ay,n8(e)),r.buffers.color.setClear(ay.r,ay.g,ay.b,i,s)}return{getClearColor:function(){return u},setClearColor:function(e,t=1){u.set(e),p(u,c=t)},getClearAlpha:function(){return c},setClearAlpha:function(e){p(u,c=e)},render:function(a,m){let g=!1,v=!0===m.isScene?m.background:null;if(v&&v.isTexture){let e=m.backgroundBlurriness>0;v=(e?i:t).get(v)}null===v?p(u,c):v&&v.isColor&&(p(v,1),g=!0);let y=e.xr.getEnvironmentBlendMode();"additive"===y?r.buffers.color.setClear(0,0,0,1,s):"alpha-blend"===y&&r.buffers.color.setClear(0,0,0,0,s),(e.autoClear||g)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),v&&(v.isCubeTexture||v.mapping===ef)?(void 0===l&&((l=new n2(new n5(1,1,1),new n9({name:"BackgroundCubeMaterial",uniforms:n4(av.backgroundCube.uniforms),vertexShader:av.backgroundCube.vertexShader,fragmentShader:av.backgroundCube.fragmentShader,side:_,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,i){this.matrixWorld.copyPosition(i.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),n.update(l)),l.material.uniforms.envMap.value=v,l.material.uniforms.flipEnvMap.value=v.isCubeTexture&&!1===v.isRenderTargetTexture?-1:1,l.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,l.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,l.material.toneMapped=v.colorSpace!==tF,(d!==v||h!==v.version||f!==e.toneMapping)&&(l.material.needsUpdate=!0,d=v,h=v.version,f=e.toneMapping),l.layers.enableAll(),a.unshift(l,l.geometry,l.material,0,0,null)):v&&v.isTexture&&(void 0===o&&((o=new n2(new ap(2,2),new n9({name:"BackgroundMaterial",uniforms:n4(av.background.uniforms),vertexShader:av.background.vertexShader,fragmentShader:av.background.fragmentShader,side:b,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(o.material,"map",{get:function(){return this.uniforms.t2D.value}}),n.update(o)),o.material.uniforms.t2D.value=v,o.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,o.material.toneMapped=v.colorSpace!==tF,!0===v.matrixAutoUpdate&&v.updateMatrix(),o.material.uniforms.uvTransform.value.copy(v.matrix),(d!==v||h!==v.version||f!==e.toneMapping)&&(o.material.needsUpdate=!0,d=v,h=v.version,f=e.toneMapping),o.layers.enableAll(),a.unshift(o,o.geometry,o.material,0,0,null))}}}function a_(e,t,i,r){let n=e.getParameter(e.MAX_VERTEX_ATTRIBS),a=r.isWebGL2?null:t.get("OES_vertex_array_object"),s=r.isWebGL2||null!==a,o={},l=f(null),u=l,c=!1;function d(t){return r.isWebGL2?e.bindVertexArray(t):a.bindVertexArrayOES(t)}function h(t){return r.isWebGL2?e.deleteVertexArray(t):a.deleteVertexArrayOES(t)}function f(e){let t=[],i=[],r=[];for(let e=0;e<n;e++)t[e]=0,i[e]=0,r[e]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:i,attributeDivisors:r,object:e,attributes:{},index:null}}function p(){let e=u.newAttributes;for(let t=0,i=e.length;t<i;t++)e[t]=0}function m(e){g(e,0)}function g(i,n){let a=u.newAttributes,s=u.enabledAttributes,o=u.attributeDivisors;if(a[i]=1,0===s[i]&&(e.enableVertexAttribArray(i),s[i]=1),o[i]!==n){let a=r.isWebGL2?e:t.get("ANGLE_instanced_arrays");a[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](i,n),o[i]=n}}function v(){let t=u.newAttributes,i=u.enabledAttributes;for(let r=0,n=i.length;r<n;r++)i[r]!==t[r]&&(e.disableVertexAttribArray(r),i[r]=0)}function y(t,i,r,n,a,s,o){!0===o?e.vertexAttribIPointer(t,i,r,a,s):e.vertexAttribPointer(t,i,r,n,a,s)}function b(){_(),c=!0,u!==l&&d((u=l).object)}function _(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(n,l,h,b,_){let E=!1;if(s){let t=function(t,i,n){let s=!0===n.wireframe,l=o[t.id];void 0===l&&(l={},o[t.id]=l);let u=l[i.id];void 0===u&&(u={},l[i.id]=u);let c=u[s];return void 0===c&&(c=f(r.isWebGL2?e.createVertexArray():a.createVertexArrayOES()),u[s]=c),c}(b,h,l);u!==t&&d((u=t).object),(E=function(e,t,i,r){let n=u.attributes,a=t.attributes,s=0,o=i.getAttributes();for(let t in o){let i=o[t];if(i.location>=0){let i=n[t],r=a[t];if(void 0===r&&("instanceMatrix"===t&&e.instanceMatrix&&(r=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(r=e.instanceColor)),void 0===i||i.attribute!==r||r&&i.data!==r.data)return!0;s++}}return u.attributesNum!==s||u.index!==r}(n,b,h,_))&&function(e,t,i,r){let n={},a=t.attributes,s=0,o=i.getAttributes();for(let t in o){let i=o[t];if(i.location>=0){let i=a[t];void 0===i&&("instanceMatrix"===t&&e.instanceMatrix&&(i=e.instanceMatrix),"instanceColor"===t&&e.instanceColor&&(i=e.instanceColor));let r={};r.attribute=i,i&&i.data&&(r.data=i.data),n[t]=r,s++}}u.attributes=n,u.attributesNum=s,u.index=r}(n,b,h,_)}else{let e=!0===l.wireframe;(u.geometry!==b.id||u.program!==h.id||u.wireframe!==e)&&(u.geometry=b.id,u.program=h.id,u.wireframe=e,E=!0)}null!==_&&i.update(_,e.ELEMENT_ARRAY_BUFFER),(E||c)&&(c=!1,function(n,a,s,o){if(!1===r.isWebGL2&&(n.isInstancedMesh||o.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;p();let l=o.attributes,u=s.getAttributes(),c=a.defaultAttributeValues;for(let t in u){let a=u[t];if(a.location>=0){let s=l[t];if(void 0===s&&("instanceMatrix"===t&&n.instanceMatrix&&(s=n.instanceMatrix),"instanceColor"===t&&n.instanceColor&&(s=n.instanceColor)),void 0!==s){let t=s.normalized,l=s.itemSize,u=i.get(s);if(void 0===u)continue;let c=u.buffer,d=u.type,h=u.bytesPerElement,f=!0===r.isWebGL2&&(d===e.INT||d===e.UNSIGNED_INT||s.gpuType===eL);if(s.isInterleavedBufferAttribute){let i=s.data,r=i.stride,u=s.offset;if(i.isInstancedInterleavedBuffer){for(let e=0;e<a.locationSize;e++)g(a.location+e,i.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=i.meshPerAttribute*i.count)}else for(let e=0;e<a.locationSize;e++)m(a.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<a.locationSize;e++)y(a.location+e,l/a.locationSize,d,t,r*h,(u+l/a.locationSize*e)*h,f)}else{if(s.isInstancedBufferAttribute){for(let e=0;e<a.locationSize;e++)g(a.location+e,s.meshPerAttribute);!0!==n.isInstancedMesh&&void 0===o._maxInstanceCount&&(o._maxInstanceCount=s.meshPerAttribute*s.count)}else for(let e=0;e<a.locationSize;e++)m(a.location+e);e.bindBuffer(e.ARRAY_BUFFER,c);for(let e=0;e<a.locationSize;e++)y(a.location+e,l/a.locationSize,d,t,l*h,l/a.locationSize*e*h,f)}}else if(void 0!==c){let i=c[t];if(void 0!==i)switch(i.length){case 2:e.vertexAttrib2fv(a.location,i);break;case 3:e.vertexAttrib3fv(a.location,i);break;case 4:e.vertexAttrib4fv(a.location,i);break;default:e.vertexAttrib1fv(a.location,i)}}}}v()}(n,l,h,b),null!==_&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,i.get(_).buffer))},reset:b,resetDefaultState:_,dispose:function(){for(let e in b(),o){let t=o[e];for(let e in t){let i=t[e];for(let e in i)h(i[e].object),delete i[e];delete t[e]}delete o[e]}},releaseStatesOfGeometry:function(e){if(void 0===o[e.id])return;let t=o[e.id];for(let e in t){let i=t[e];for(let e in i)h(i[e].object),delete i[e];delete t[e]}delete o[e.id]},releaseStatesOfProgram:function(e){for(let t in o){let i=o[t];if(void 0===i[e.id])continue;let r=i[e.id];for(let e in r)h(r[e].object),delete r[e];delete i[e.id]}},initAttributes:p,enableAttribute:m,disableUnusedAttributes:v}}function aE(e,t,i,r){let n;let a=r.isWebGL2;this.setMode=function(e){n=e},this.render=function(t,r){e.drawArrays(n,t,r),i.update(r,n,1)},this.renderInstances=function(r,s,o){let l,u;if(0!==o){if(a)l=e,u="drawArraysInstanced";else if(l=t.get("ANGLE_instanced_arrays"),u="drawArraysInstancedANGLE",null===l){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}l[u](n,r,s,o),i.update(s,n,o)}}}function aS(e,t,i){let r;function n(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let a="undefined"!=typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===e.constructor.name,s=void 0!==i.precision?i.precision:"highp",o=n(s);o!==s&&(console.warn("THREE.WebGLRenderer:",s,"not supported, using",o,"instead."),s=o);let l=a||t.has("WEBGL_draw_buffers"),u=!0===i.logarithmicDepthBuffer,c=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),f=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),p=e.getParameter(e.MAX_VERTEX_ATTRIBS),m=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),g=e.getParameter(e.MAX_VARYING_VECTORS),v=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),y=d>0,b=a||t.has("OES_texture_float"),_=a?e.getParameter(e.MAX_SAMPLES):0;return{isWebGL2:a,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){let i=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:n,precision:s,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:d,maxTextureSize:h,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:m,maxVaryings:g,maxFragmentUniforms:v,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:_}}function ax(e){let t=this,i=null,r=0,n=!1,a=!1,s=new al,o=new iP,l={value:null,needsUpdate:!1};function u(e,i,r,n){let a=null!==e?e.length:0,u=null;if(0!==a){if(u=l.value,!0!==n||null===u){let t=r+4*a,n=i.matrixWorldInverse;o.getNormalMatrix(n),(null===u||u.length<t)&&(u=new Float32Array(t));for(let t=0,i=r;t!==a;++t,i+=4)s.copy(e[t]).applyMatrix4(n,o),s.normal.toArray(u,i),u[i+3]=s.constant}l.value=u,l.needsUpdate=!0}return t.numPlanes=a,t.numIntersection=0,u}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){let i=0!==e.length||t||0!==r||n;return n=t,r=e.length,i},this.beginShadows=function(){a=!0,u(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(e,t){i=u(e,t,0)},this.setState=function(s,o,c){let d=s.clippingPlanes,h=s.clipIntersection,f=s.clipShadows,p=e.get(s);if(n&&null!==d&&0!==d.length&&(!a||f)){let e=a?0:r,t=4*e,n=p.clippingState||null;l.value=n,n=u(d,o,t,c);for(let e=0;e!==t;++e)n[e]=i[e];p.clippingState=n,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=e}else a?u(null):(l.value!==i&&(l.value=i,l.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0)}}function aT(e){let t=new WeakMap;function i(e,t){return t===ed?e.mapping=eu:t===eh&&(e.mapping=ec),e}function r(e){let i=e.target;i.removeEventListener("dispose",r);let n=t.get(i);void 0!==n&&(t.delete(i),n.dispose())}return{get:function(n){if(n&&n.isTexture&&!1===n.isRenderTargetTexture){let a=n.mapping;if(a===ed||a===eh){if(t.has(n)){let e=t.get(n).texture;return i(e,n.mapping)}{let a=n.image;if(!a||!(a.height>0))return null;{let s=new an(a.height/2);return s.fromEquirectangularTexture(e,n),t.set(n,s),n.addEventListener("dispose",r),i(s.texture,n.mapping)}}}}return n},dispose:function(){t=new WeakMap}}}class aw extends ae{constructor(e=-1,t=1,i=1,r=-1,n=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=i,this.bottom=r,this.near=n,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,t,i,r,n,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=i,this.view.offsetY=r,this.view.width=n,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,r=(this.top+this.bottom)/2,n=i-e,a=i+e,s=r+t,o=r-t;if(null!==this.view&&this.view.enabled){let e=(this.right-this.left)/this.view.fullWidth/this.zoom,t=(this.top-this.bottom)/this.view.fullHeight/this.zoom;n+=e*this.view.offsetX,a=n+e*this.view.width,s-=t*this.view.offsetY,o=s-t*this.view.height}this.projectionMatrix.makeOrthographic(n,a,s,o,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}let aA=[.125,.215,.35,.446,.526,.582],aM=new aw,aR=new nd,aC=null,aI=(1+Math.sqrt(5))/2,aL=1/aI,ak=[new rt(1,1,1),new rt(-1,1,1),new rt(1,1,-1),new rt(-1,1,-1),new rt(0,aI,aL),new rt(0,aI,-aL),new rt(aL,0,aI),new rt(-aL,0,aI),new rt(aI,aL,0),new rt(-aI,aL,0)];class aD{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(e,t=0,i=.1,r=100){aC=this._renderer.getRenderTarget(),this._setSize(256);let n=this._allocateTargets();return n.depthBuffer=!0,this._sceneToCubeUV(e,i,r,n),t>0&&this._blur(n,0,0,t),this._applyPMREM(n),this._cleanup(n),n}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=aU(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=aN(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}_cleanup(e){this._renderer.setRenderTarget(aC),e.scissorTest=!1,aO(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===eu||e.mapping===ec?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),aC=this._renderer.getRenderTarget();let i=t||this._allocateTargets();return this._textureToCubeUV(e,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){let e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,i={magFilter:eS,minFilter:eS,generateMipmaps:!1,type:eP,format:eB,colorSpace:tB,depthBuffer:!1},r=aP(e,t,i);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=aP(e,t,i);let{_lodMax:r}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function(e){let t=[],i=[],r=[],n=e,a=e-4+1+aA.length;for(let s=0;s<a;s++){let a=Math.pow(2,n);i.push(a);let o=1/a;s>e-4?o=aA[s-e+4-1]:0===s&&(o=0),r.push(o);let l=1/(a-2),u=-l,c=1+l,d=[u,u,c,u,c,c,u,u,c,c,u,c],h=new Float32Array(108),f=new Float32Array(72),p=new Float32Array(36);for(let e=0;e<6;e++){let t=e%3*2/3-1,i=e>2?0:-1,r=[t,i,0,t+2/3,i,0,t+2/3,i+1,0,t,i,0,t+2/3,i+1,0,t,i+1,0];h.set(r,18*e),f.set(d,12*e);let n=[e,e,e,e,e,e];p.set(n,6*e)}let m=new nF;m.setAttribute("position",new n_(h,3)),m.setAttribute("uv",new n_(f,2)),m.setAttribute("faceIndex",new n_(p,1)),t.push(m),n>4&&n--}return{lodPlanes:t,sizeLods:i,sigmas:r}}(r)),this._blurMaterial=function(e,t,i){let r=new Float32Array(20),n=new rt(0,1,0),a=new n9({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/i,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n}},vertexShader:aF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:x,depthTest:!1,depthWrite:!1});return a}(r,e,t)}return r}_compileMaterial(e){let t=new n2(this._lodPlanes[0],e);this._renderer.compile(t,aM)}_sceneToCubeUV(e,t,i,r){let n=new at(90,1,t,i),a=[1,-1,1,1,1,1],s=[1,1,1,-1,-1,-1],o=this._renderer,l=o.autoClear,u=o.toneMapping;o.getClearColor(aR),o.toneMapping=ei,o.autoClear=!1;let c=new nf({name:"PMREM.Background",side:_,depthWrite:!1,depthTest:!1}),d=new n2(new n5,c),h=!1,f=e.background;f?f.isColor&&(c.color.copy(f),e.background=null,h=!0):(c.color.copy(aR),h=!0);for(let t=0;t<6;t++){let i=t%3;0===i?(n.up.set(0,a[t],0),n.lookAt(s[t],0,0)):1===i?(n.up.set(0,0,a[t]),n.lookAt(0,s[t],0)):(n.up.set(0,a[t],0),n.lookAt(0,0,s[t]));let l=this._cubeSize;aO(r,i*l,t>2?l:0,l,l),o.setRenderTarget(r),h&&o.render(d,n),o.render(e,n)}d.geometry.dispose(),d.material.dispose(),o.toneMapping=u,o.autoClear=l,e.background=f}_textureToCubeUV(e,t){let i=this._renderer,r=e.mapping===eu||e.mapping===ec;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=aU()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=aN());let n=r?this._cubemapMaterial:this._equirectMaterial,a=new n2(this._lodPlanes[0],n),s=n.uniforms;s.envMap.value=e;let o=this._cubeSize;aO(t,0,0,3*o,2*o),i.setRenderTarget(t),i.render(a,aM)}_applyPMREM(e){let t=this._renderer,i=t.autoClear;t.autoClear=!1;for(let t=1;t<this._lodPlanes.length;t++){let i=Math.sqrt(this._sigmas[t]*this._sigmas[t]-this._sigmas[t-1]*this._sigmas[t-1]),r=ak[(t-1)%ak.length];this._blur(e,t-1,t,i,r)}t.autoClear=i}_blur(e,t,i,r,n){let a=this._pingPongRenderTarget;this._halfBlur(e,a,t,i,r,"latitudinal",n),this._halfBlur(a,e,i,i,r,"longitudinal",n)}_halfBlur(e,t,i,r,n,a,s){let o=this._renderer,l=this._blurMaterial;"latitudinal"!==a&&"longitudinal"!==a&&console.error("blur direction must be either latitudinal or longitudinal!");let u=new n2(this._lodPlanes[r],l),c=l.uniforms,d=this._sizeLods[i]-1,h=isFinite(n)?Math.PI/(2*d):2*Math.PI/39,f=n/h,p=isFinite(n)?1+Math.floor(3*f):20;p>20&&console.warn(`sigmaRadians, ${n}, is too large and will clip, as it requested ${p} samples when the maximum is set to 20`);let m=[],g=0;for(let e=0;e<20;++e){let t=e/f,i=Math.exp(-t*t/2);m.push(i),0===e?g+=i:e<p&&(g+=2*i)}for(let e=0;e<m.length;e++)m[e]=m[e]/g;c.envMap.value=e.texture,c.samples.value=p,c.weights.value=m,c.latitudinal.value="latitudinal"===a,s&&(c.poleAxis.value=s);let{_lodMax:v}=this;c.dTheta.value=h,c.mipInt.value=v-i;let y=this._sizeLods[r],b=3*y*(r>v-4?r-v+4:0),_=4*(this._cubeSize-y);aO(t,b,_,3*y,2*y),o.setRenderTarget(t),o.render(u,aM)}}function aP(e,t,i){let r=new i5(e,t,i);return r.texture.mapping=ef,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function aO(e,t,i,r,n){e.viewport.set(t,i,r,n),e.scissor.set(t,i,r,n)}function aN(){return new n9({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:aF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:x,depthTest:!1,depthWrite:!1})}function aU(){return new n9({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:aF(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:x,depthTest:!1,depthWrite:!1})}function aF(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function aB(e){let t=new WeakMap,i=null;function r(e){let i=e.target;i.removeEventListener("dispose",r);let n=t.get(i);void 0!==n&&(t.delete(i),n.dispose())}return{get:function(n){if(n&&n.isTexture){let a=n.mapping,s=a===ed||a===eh,o=a===eu||a===ec;if(s||o){if(n.isRenderTargetTexture&&!0===n.needsPMREMUpdate){n.needsPMREMUpdate=!1;let r=t.get(n);return null===i&&(i=new aD(e)),r=s?i.fromEquirectangular(n,r):i.fromCubemap(n,r),t.set(n,r),r.texture}if(t.has(n))return t.get(n).texture;{let a=n.image;if(!(s&&a&&a.height>0||o&&a&&function(e){let t=0;for(let i=0;i<6;i++)void 0!==e[i]&&t++;return 6===t}(a)))return null;{null===i&&(i=new aD(e));let a=s?i.fromEquirectangular(n):i.fromCubemap(n);return t.set(n,a),n.addEventListener("dispose",r),a.texture}}}}return n},dispose:function(){t=new WeakMap,null!==i&&(i.dispose(),i=null)}}}function aV(e){let t={};function i(i){let r;if(void 0!==t[i])return t[i];switch(i){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(i)}return t[i]=r,r}return{has:function(e){return null!==i(e)},init:function(e){e.isWebGL2?i("EXT_color_buffer_float"):(i("WEBGL_depth_texture"),i("OES_texture_float"),i("OES_texture_half_float"),i("OES_texture_half_float_linear"),i("OES_standard_derivatives"),i("OES_element_index_uint"),i("OES_vertex_array_object"),i("ANGLE_instanced_arrays")),i("OES_texture_float_linear"),i("EXT_color_buffer_half_float"),i("WEBGL_multisampled_render_to_texture")},get:function(e){let t=i(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function az(e,t,i,r){let n={},a=new WeakMap;function s(e){let o=e.target;for(let e in null!==o.index&&t.remove(o.index),o.attributes)t.remove(o.attributes[e]);for(let e in o.morphAttributes){let i=o.morphAttributes[e];for(let e=0,r=i.length;e<r;e++)t.remove(i[e])}o.removeEventListener("dispose",s),delete n[o.id];let l=a.get(o);l&&(t.remove(l),a.delete(o)),r.releaseStatesOfGeometry(o),!0===o.isInstancedBufferGeometry&&delete o._maxInstanceCount,i.memory.geometries--}function o(e){let i=[],r=e.index,n=e.attributes.position,s=0;if(null!==r){let e=r.array;s=r.version;for(let t=0,r=e.length;t<r;t+=3){let r=e[t+0],n=e[t+1],a=e[t+2];i.push(r,n,n,a,a,r)}}else{if(void 0===n)return;let e=n.array;s=n.version;for(let t=0,r=e.length/3-1;t<r;t+=3){let e=t+0,r=t+1,n=t+2;i.push(e,r,r,n,n,e)}}let o=new(iN(i)?nM:nw)(i,1);o.version=s;let l=a.get(e);l&&t.remove(l),a.set(e,o)}return{get:function(e,t){return!0===n[t.id]||(t.addEventListener("dispose",s),n[t.id]=!0,i.memory.geometries++),t},update:function(i){let r=i.attributes;for(let i in r)t.update(r[i],e.ARRAY_BUFFER);let n=i.morphAttributes;for(let i in n){let r=n[i];for(let i=0,n=r.length;i<n;i++)t.update(r[i],e.ARRAY_BUFFER)}},getWireframeAttribute:function(e){let t=a.get(e);if(t){let i=e.index;null!==i&&t.version<i.version&&o(e)}else o(e);return a.get(e)}}}function aj(e,t,i,r){let n,a,s;let o=r.isWebGL2;this.setMode=function(e){n=e},this.setIndex=function(e){a=e.type,s=e.bytesPerElement},this.render=function(t,r){e.drawElements(n,r,a,t*s),i.update(r,n,1)},this.renderInstances=function(r,l,u){let c,d;if(0!==u){if(o)c=e,d="drawElementsInstanced";else if(c=t.get("ANGLE_instanced_arrays"),d="drawElementsInstancedANGLE",null===c){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}c[d](n,l,a,r*s,u),i.update(l,n,u)}}}function aH(e){let t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(i,r,n){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=n*(i/3);break;case e.LINES:t.lines+=n*(i/2);break;case e.LINE_STRIP:t.lines+=n*(i-1);break;case e.LINE_LOOP:t.lines+=n*i;break;case e.POINTS:t.points+=n*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function aG(e,t){return e[0]-t[0]}function aW(e,t){return Math.abs(t[1])-Math.abs(e[1])}function a$(e,t,i){let r={},n=new Float32Array(8),a=new WeakMap,s=new i2,o=[];for(let e=0;e<8;e++)o[e]=[e,0];return{update:function(l,u,c){let d=l.morphTargetInfluences;if(!0===t.isWebGL2){let r=u.morphAttributes.position||u.morphAttributes.normal||u.morphAttributes.color,n=void 0!==r?r.length:0,o=a.get(u);if(void 0===o||o.count!==n){void 0!==o&&o.texture.dispose();let e=void 0!==u.morphAttributes.position,i=void 0!==u.morphAttributes.normal,r=void 0!==u.morphAttributes.color,l=u.morphAttributes.position||[],c=u.morphAttributes.normal||[],d=u.morphAttributes.color||[],h=0;!0===e&&(h=1),!0===i&&(h=2),!0===r&&(h=3);let f=u.attributes.position.count*h,p=1;f>t.maxTextureSize&&(p=Math.ceil(f/t.maxTextureSize),f=t.maxTextureSize);let m=new Float32Array(f*p*4*n),g=new i4(m,f,p,n);g.type=eD,g.needsUpdate=!0;let v=4*h;for(let t=0;t<n;t++){let n=l[t],a=c[t],o=d[t],u=f*p*4*t;for(let t=0;t<n.count;t++){let l=t*v;!0===e&&(s.fromBufferAttribute(n,t),m[u+l+0]=s.x,m[u+l+1]=s.y,m[u+l+2]=s.z,m[u+l+3]=0),!0===i&&(s.fromBufferAttribute(a,t),m[u+l+4]=s.x,m[u+l+5]=s.y,m[u+l+6]=s.z,m[u+l+7]=0),!0===r&&(s.fromBufferAttribute(o,t),m[u+l+8]=s.x,m[u+l+9]=s.y,m[u+l+10]=s.z,m[u+l+11]=4===o.itemSize?s.w:1)}}o={count:n,texture:g,size:new iD(f,p)},a.set(u,o),u.addEventListener("dispose",function e(){g.dispose(),a.delete(u),u.removeEventListener("dispose",e)})}let l=0;for(let e=0;e<d.length;e++)l+=d[e];let h=u.morphTargetsRelative?1:1-l;c.getUniforms().setValue(e,"morphTargetBaseInfluence",h),c.getUniforms().setValue(e,"morphTargetInfluences",d),c.getUniforms().setValue(e,"morphTargetsTexture",o.texture,i),c.getUniforms().setValue(e,"morphTargetsTextureSize",o.size)}else{let t=void 0===d?0:d.length,i=r[u.id];if(void 0===i||i.length!==t){i=[];for(let e=0;e<t;e++)i[e]=[e,0];r[u.id]=i}for(let e=0;e<t;e++){let t=i[e];t[0]=e,t[1]=d[e]}i.sort(aW);for(let e=0;e<8;e++)e<t&&i[e][1]?(o[e][0]=i[e][0],o[e][1]=i[e][1]):(o[e][0]=Number.MAX_SAFE_INTEGER,o[e][1]=0);o.sort(aG);let a=u.morphAttributes.position,s=u.morphAttributes.normal,l=0;for(let e=0;e<8;e++){let t=o[e],i=t[0],r=t[1];i!==Number.MAX_SAFE_INTEGER&&r?(a&&u.getAttribute("morphTarget"+e)!==a[i]&&u.setAttribute("morphTarget"+e,a[i]),s&&u.getAttribute("morphNormal"+e)!==s[i]&&u.setAttribute("morphNormal"+e,s[i]),n[e]=r,l+=r):(a&&!0===u.hasAttribute("morphTarget"+e)&&u.deleteAttribute("morphTarget"+e),s&&!0===u.hasAttribute("morphNormal"+e)&&u.deleteAttribute("morphNormal"+e),n[e]=0)}let h=u.morphTargetsRelative?1:1-l;c.getUniforms().setValue(e,"morphTargetBaseInfluence",h),c.getUniforms().setValue(e,"morphTargetInfluences",n)}}}}function aq(e,t,i,r){let n=new WeakMap;function a(e){let t=e.target;t.removeEventListener("dispose",a),i.remove(t.instanceMatrix),null!==t.instanceColor&&i.remove(t.instanceColor)}return{update:function(s){let o=r.render.frame,l=s.geometry,u=t.get(s,l);if(n.get(u)!==o&&(t.update(u),n.set(u,o)),s.isInstancedMesh&&(!1===s.hasEventListener("dispose",a)&&s.addEventListener("dispose",a),n.get(s)!==o&&(i.update(s.instanceMatrix,e.ARRAY_BUFFER),null!==s.instanceColor&&i.update(s.instanceColor,e.ARRAY_BUFFER),n.set(s,o))),s.isSkinnedMesh){let e=s.skeleton;n.get(e)!==o&&(e.update(),n.set(e,o))}return u},dispose:function(){n=new WeakMap}}}let aY=new i1,aK=new i4,aX=new i8,aZ=new ar,aJ=[],aQ=[],a0=new Float32Array(16),a1=new Float32Array(9),a2=new Float32Array(4);function a3(e,t,i){let r=e[0];if(r<=0||r>0)return e;let n=t*i,a=aJ[n];if(void 0===a&&(a=new Float32Array(n),aJ[n]=a),0!==t){r.toArray(a,0);for(let r=1,n=0;r!==t;++r)n+=i,e[r].toArray(a,n)}return a}function a5(e,t){if(e.length!==t.length)return!1;for(let i=0,r=e.length;i<r;i++)if(e[i]!==t[i])return!1;return!0}function a4(e,t){for(let i=0,r=t.length;i<r;i++)e[i]=t[i]}function a6(e,t){let i=aQ[t];void 0===i&&(i=new Int32Array(t),aQ[t]=i);for(let r=0;r!==t;++r)i[r]=e.allocateTextureUnit();return i}function a8(e,t){let i=this.cache;i[0]!==t&&(e.uniform1f(this.addr,t),i[0]=t)}function a7(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(a5(i,t))return;e.uniform2fv(this.addr,t),a4(i,t)}}function a9(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else if(void 0!==t.r)(i[0]!==t.r||i[1]!==t.g||i[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),i[0]=t.r,i[1]=t.g,i[2]=t.b);else{if(a5(i,t))return;e.uniform3fv(this.addr,t),a4(i,t)}}function se(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(a5(i,t))return;e.uniform4fv(this.addr,t),a4(i,t)}}function st(e,t){let i=this.cache,r=t.elements;if(void 0===r){if(a5(i,t))return;e.uniformMatrix2fv(this.addr,!1,t),a4(i,t)}else{if(a5(i,r))return;a2.set(r),e.uniformMatrix2fv(this.addr,!1,a2),a4(i,r)}}function si(e,t){let i=this.cache,r=t.elements;if(void 0===r){if(a5(i,t))return;e.uniformMatrix3fv(this.addr,!1,t),a4(i,t)}else{if(a5(i,r))return;a1.set(r),e.uniformMatrix3fv(this.addr,!1,a1),a4(i,r)}}function sr(e,t){let i=this.cache,r=t.elements;if(void 0===r){if(a5(i,t))return;e.uniformMatrix4fv(this.addr,!1,t),a4(i,t)}else{if(a5(i,r))return;a0.set(r),e.uniformMatrix4fv(this.addr,!1,a0),a4(i,r)}}function sn(e,t){let i=this.cache;i[0]!==t&&(e.uniform1i(this.addr,t),i[0]=t)}function sa(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(a5(i,t))return;e.uniform2iv(this.addr,t),a4(i,t)}}function ss(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(a5(i,t))return;e.uniform3iv(this.addr,t),a4(i,t)}}function so(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(a5(i,t))return;e.uniform4iv(this.addr,t),a4(i,t)}}function sl(e,t){let i=this.cache;i[0]!==t&&(e.uniform1ui(this.addr,t),i[0]=t)}function su(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),i[0]=t.x,i[1]=t.y);else{if(a5(i,t))return;e.uniform2uiv(this.addr,t),a4(i,t)}}function sc(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),i[0]=t.x,i[1]=t.y,i[2]=t.z);else{if(a5(i,t))return;e.uniform3uiv(this.addr,t),a4(i,t)}}function sd(e,t){let i=this.cache;if(void 0!==t.x)(i[0]!==t.x||i[1]!==t.y||i[2]!==t.z||i[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=t.w);else{if(a5(i,t))return;e.uniform4uiv(this.addr,t),a4(i,t)}}function sh(e,t,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTexture2D(t||aY,n)}function sf(e,t,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTexture3D(t||aX,n)}function sp(e,t,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTextureCube(t||aZ,n)}function sm(e,t,i){let r=this.cache,n=i.allocateTextureUnit();r[0]!==n&&(e.uniform1i(this.addr,n),r[0]=n),i.setTexture2DArray(t||aK,n)}function sg(e,t){e.uniform1fv(this.addr,t)}function sv(e,t){let i=a3(t,this.size,2);e.uniform2fv(this.addr,i)}function sy(e,t){let i=a3(t,this.size,3);e.uniform3fv(this.addr,i)}function sb(e,t){let i=a3(t,this.size,4);e.uniform4fv(this.addr,i)}function s_(e,t){let i=a3(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,i)}function sE(e,t){let i=a3(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,i)}function sS(e,t){let i=a3(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,i)}function sx(e,t){e.uniform1iv(this.addr,t)}function sT(e,t){e.uniform2iv(this.addr,t)}function sw(e,t){e.uniform3iv(this.addr,t)}function sA(e,t){e.uniform4iv(this.addr,t)}function sM(e,t){e.uniform1uiv(this.addr,t)}function sR(e,t){e.uniform2uiv(this.addr,t)}function sC(e,t){e.uniform3uiv(this.addr,t)}function sI(e,t){e.uniform4uiv(this.addr,t)}function sL(e,t,i){let r=this.cache,n=t.length,a=a6(i,n);a5(r,a)||(e.uniform1iv(this.addr,a),a4(r,a));for(let e=0;e!==n;++e)i.setTexture2D(t[e]||aY,a[e])}function sk(e,t,i){let r=this.cache,n=t.length,a=a6(i,n);a5(r,a)||(e.uniform1iv(this.addr,a),a4(r,a));for(let e=0;e!==n;++e)i.setTexture3D(t[e]||aX,a[e])}function sD(e,t,i){let r=this.cache,n=t.length,a=a6(i,n);a5(r,a)||(e.uniform1iv(this.addr,a),a4(r,a));for(let e=0;e!==n;++e)i.setTextureCube(t[e]||aZ,a[e])}function sP(e,t,i){let r=this.cache,n=t.length,a=a6(i,n);a5(r,a)||(e.uniform1iv(this.addr,a),a4(r,a));for(let e=0;e!==n;++e)i.setTexture2DArray(t[e]||aK,a[e])}class sO{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.setValue=function(e){switch(e){case 5126:return a8;case 35664:return a7;case 35665:return a9;case 35666:return se;case 35674:return st;case 35675:return si;case 35676:return sr;case 5124:case 35670:return sn;case 35667:case 35671:return sa;case 35668:case 35672:return ss;case 35669:case 35673:return so;case 5125:return sl;case 36294:return su;case 36295:return sc;case 36296:return sd;case 35678:case 36198:case 36298:case 36306:case 35682:return sh;case 35679:case 36299:case 36307:return sf;case 35680:case 36300:case 36308:case 36293:return sp;case 36289:case 36303:case 36311:case 36292:return sm}}(t.type)}}class sN{constructor(e,t,i){this.id=e,this.addr=i,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return sg;case 35664:return sv;case 35665:return sy;case 35666:return sb;case 35674:return s_;case 35675:return sE;case 35676:return sS;case 5124:case 35670:return sx;case 35667:case 35671:return sT;case 35668:case 35672:return sw;case 35669:case 35673:return sA;case 5125:return sM;case 36294:return sR;case 36295:return sC;case 36296:return sI;case 35678:case 36198:case 36298:case 36306:case 35682:return sL;case 35679:case 36299:case 36307:return sk;case 35680:case 36300:case 36308:case 36293:return sD;case 36289:case 36303:case 36311:case 36292:return sP}}(t.type)}}class sU{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,i){let r=this.seq;for(let n=0,a=r.length;n!==a;++n){let a=r[n];a.setValue(e,t[a.id],i)}}}let sF=/(\w+)(\])?(\[|\.)?/g;function sB(e,t){e.seq.push(t),e.map[t.id]=t}class sV{constructor(e,t){this.seq=[],this.map={};let i=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let r=0;r<i;++r){let i=e.getActiveUniform(t,r),n=e.getUniformLocation(t,i.name);!function(e,t,i){let r=e.name,n=r.length;for(sF.lastIndex=0;;){let a=sF.exec(r),s=sF.lastIndex,o=a[1],l="]"===a[2],u=a[3];if(l&&(o|=0),void 0===u||"["===u&&s+2===n){sB(i,void 0===u?new sO(o,e,t):new sN(o,e,t));break}{let e=i.map,t=e[o];void 0===t&&sB(i,t=new sU(o)),i=t}}}(i,n,this)}}setValue(e,t,i,r){let n=this.map[t];void 0!==n&&n.setValue(e,i,r)}setOptional(e,t,i){let r=t[i];void 0!==r&&this.setValue(e,i,r)}static upload(e,t,i,r){for(let n=0,a=t.length;n!==a;++n){let a=t[n],s=i[a.id];!1!==s.needsUpdate&&a.setValue(e,s.value,r)}}static seqWithValue(e,t){let i=[];for(let r=0,n=e.length;r!==n;++r){let n=e[r];n.id in t&&i.push(n)}return i}}function sz(e,t,i){let r=e.createShader(t);return e.shaderSource(r,i),e.compileShader(r),r}let sj=0;function sH(e,t,i){let r=e.getShaderParameter(t,e.COMPILE_STATUS),n=e.getShaderInfoLog(t).trim();if(r&&""===n)return"";let a=/ERROR: 0:(\d+)/.exec(n);if(!a)return n;{let r=parseInt(a[1]);return i.toUpperCase()+"\n\n"+n+"\n\n"+function(e,t){let i=e.split("\n"),r=[],n=Math.max(t-6,0),a=Math.min(t+6,i.length);for(let e=n;e<a;e++){let n=e+1;r.push(`${n===t?">":" "} ${n}: ${i[e]}`)}return r.join("\n")}(e.getShaderSource(t),r)}}function sG(e){return""!==e}function sW(e,t){let i=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,i).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function s$(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}let sq=/^[ \t]*#include +<([\w\d./]+)>/gm;function sY(e){return e.replace(sq,sX)}let sK=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function sX(e,t){let i=am[t];if(void 0===i){let e=sK.get(t);if(void 0!==e)i=am[e],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,e);else throw Error("Can not resolve #include <"+t+">")}return sY(i)}let sZ=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function sJ(e){return e.replace(sZ,sQ)}function sQ(e,t,i,r){let n="";for(let e=parseInt(t);e<parseInt(i);e++)n+=r.replace(/\[\s*i\s*\]/g,"[ "+e+" ]").replace(/UNROLLED_LOOP_INDEX/g,e);return n}function s0(e){let t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function s1(e,t,i,r){let n,a,s,o,l,u;let c=e.getContext(),d=i.defines,h=i.vertexShader,f=i.fragmentShader,p=(l="SHADOWMAP_TYPE_BASIC",i.shadowMapType===g?l="SHADOWMAP_TYPE_PCF":i.shadowMapType===v?l="SHADOWMAP_TYPE_PCF_SOFT":i.shadowMapType===y&&(l="SHADOWMAP_TYPE_VSM"),l),m=function(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case eu:case ec:t="ENVMAP_TYPE_CUBE";break;case ef:t="ENVMAP_TYPE_CUBE_UV"}return t}(i),b=(u="ENVMAP_MODE_REFLECTION",i.envMap&&i.envMapMode===ec&&(u="ENVMAP_MODE_REFRACTION"),u),_=function(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case Q:t="ENVMAP_BLENDING_MULTIPLY";break;case ee:t="ENVMAP_BLENDING_MIX";break;case et:t="ENVMAP_BLENDING_ADD"}return t}(i),E=function(e){let t=e.envMapCubeUVHeight;if(null===t)return null;let i=Math.log2(t)-2;return{texelWidth:1/(3*Math.max(Math.pow(2,i),112)),texelHeight:1/t,maxMip:i}}(i),S=i.isWebGL2?"":function(e){let t=[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.normalMapTangentSpace||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""];return t.filter(sG).join("\n")}(i),x=function(e){let t=[];for(let i in e){let r=e[i];!1!==r&&t.push("#define "+i+" "+r)}return t.join("\n")}(d),T=c.createProgram(),w=i.glslVersion?"#version "+i.glslVersion+"\n":"";i.isRawShaderMaterial?((n=["#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,x].filter(sG).join("\n")).length>0&&(n+="\n"),(a=[S,"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,x].filter(sG).join("\n")).length>0&&(a+="\n")):(n=[s0(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,x,i.instancing?"#define USE_INSTANCING":"",i.instancingColor?"#define USE_INSTANCING_COLOR":"",i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+b:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.displacementMap?"#define USE_DISPLACEMENTMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.mapUv?"#define MAP_UV "+i.mapUv:"",i.alphaMapUv?"#define ALPHAMAP_UV "+i.alphaMapUv:"",i.lightMapUv?"#define LIGHTMAP_UV "+i.lightMapUv:"",i.aoMapUv?"#define AOMAP_UV "+i.aoMapUv:"",i.emissiveMapUv?"#define EMISSIVEMAP_UV "+i.emissiveMapUv:"",i.bumpMapUv?"#define BUMPMAP_UV "+i.bumpMapUv:"",i.normalMapUv?"#define NORMALMAP_UV "+i.normalMapUv:"",i.displacementMapUv?"#define DISPLACEMENTMAP_UV "+i.displacementMapUv:"",i.metalnessMapUv?"#define METALNESSMAP_UV "+i.metalnessMapUv:"",i.roughnessMapUv?"#define ROUGHNESSMAP_UV "+i.roughnessMapUv:"",i.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+i.anisotropyMapUv:"",i.clearcoatMapUv?"#define CLEARCOATMAP_UV "+i.clearcoatMapUv:"",i.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+i.clearcoatNormalMapUv:"",i.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+i.clearcoatRoughnessMapUv:"",i.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+i.iridescenceMapUv:"",i.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+i.iridescenceThicknessMapUv:"",i.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+i.sheenColorMapUv:"",i.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+i.sheenRoughnessMapUv:"",i.specularMapUv?"#define SPECULARMAP_UV "+i.specularMapUv:"",i.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+i.specularColorMapUv:"",i.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+i.specularIntensityMapUv:"",i.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+i.transmissionMapUv:"",i.thicknessMapUv?"#define THICKNESSMAP_UV "+i.thicknessMapUv:"",i.vertexTangents&&!1===i.flatShading?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&!1===i.flatShading?"#define USE_MORPHNORMALS":"",i.morphColors&&i.isWebGL2?"#define USE_MORPHCOLORS":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+i.morphTextureStride:"",i.morphTargetsCount>0&&i.isWebGL2?"#define MORPHTARGETS_COUNT "+i.morphTargetsCount:"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+p:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif","\n"].filter(sG).join("\n"),a=[S,s0(i),"#define SHADER_TYPE "+i.shaderType,"#define SHADER_NAME "+i.shaderName,x,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+m:"",i.envMap?"#define "+b:"",i.envMap?"#define "+_:"",E?"#define CUBEUV_TEXEL_WIDTH "+E.texelWidth:"",E?"#define CUBEUV_TEXEL_HEIGHT "+E.texelHeight:"",E?"#define CUBEUV_MAX_MIP "+E.maxMip+".0":"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",i.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.anisotropy?"#define USE_ANISOTROPY":"",i.anisotropyMap?"#define USE_ANISOTROPYMAP":"",i.clearcoat?"#define USE_CLEARCOAT":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.iridescence?"#define USE_IRIDESCENCE":"",i.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",i.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",i.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.alphaTest?"#define USE_ALPHATEST":"",i.alphaHash?"#define USE_ALPHAHASH":"",i.sheen?"#define USE_SHEEN":"",i.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",i.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",i.transmission?"#define USE_TRANSMISSION":"",i.transmissionMap?"#define USE_TRANSMISSIONMAP":"",i.thicknessMap?"#define USE_THICKNESSMAP":"",i.vertexTangents&&!1===i.flatShading?"#define USE_TANGENT":"",i.vertexColors||i.instancingColor?"#define USE_COLOR":"",i.vertexAlphas?"#define USE_COLOR_ALPHA":"",i.vertexUv1s?"#define USE_UV1":"",i.vertexUv2s?"#define USE_UV2":"",i.vertexUv3s?"#define USE_UV3":"",i.pointsUvs?"#define USE_POINTS_UV":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+p:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.useLegacyLights?"#define LEGACY_LIGHTS":"",i.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==ei?"#define TONE_MAPPING":"",i.toneMapping!==ei?am.tonemapping_pars_fragment:"",i.toneMapping!==ei?function(e,t){let i;switch(t){case er:i="Linear";break;case en:i="Reinhard";break;case ea:i="OptimizedCineon";break;case es:i="ACESFilmic";break;case eo:i="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),i="Linear"}return"vec3 "+e+"( vec3 color ) { return "+i+"ToneMapping( color ); }"}("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.opaque?"#define OPAQUE":"",am.colorspace_pars_fragment,function(e,t){let i=function(e){switch(e){case tB:return["Linear","( value )"];case tF:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}("linearToOutputTexel",i.outputColorSpace),i.useDepthPacking?"#define DEPTH_PACKING "+i.depthPacking:"","\n"].filter(sG).join("\n")),h=s$(h=sW(h=sY(h),i),i),f=s$(f=sW(f=sY(f),i),i),h=sJ(h),f=sJ(f),i.isWebGL2&&!0!==i.isRawShaderMaterial&&(w="#version 300 es\n",n="precision mediump sampler2DArray;\n#define attribute in\n#define varying out\n#define texture2D texture\n"+n,a=["#define varying in",i.glslVersion===ip?"":"layout(location = 0) out highp vec4 pc_fragColor;",i.glslVersion===ip?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+a);let A=w+n+h,M=w+a+f,R=sz(c,c.VERTEX_SHADER,A),C=sz(c,c.FRAGMENT_SHADER,M);if(c.attachShader(T,R),c.attachShader(T,C),void 0!==i.index0AttributeName?c.bindAttribLocation(T,0,i.index0AttributeName):!0===i.morphTargets&&c.bindAttribLocation(T,0,"position"),c.linkProgram(T),e.debug.checkShaderErrors){let t=c.getProgramInfoLog(T).trim(),i=c.getShaderInfoLog(R).trim(),r=c.getShaderInfoLog(C).trim(),s=!0,o=!0;if(!1===c.getProgramParameter(T,c.LINK_STATUS)){if(s=!1,"function"==typeof e.debug.onShaderError)e.debug.onShaderError(c,T,R,C);else{let e=sH(c,R,"vertex"),i=sH(c,C,"fragment");console.error("THREE.WebGLProgram: Shader Error "+c.getError()+" - VALIDATE_STATUS "+c.getProgramParameter(T,c.VALIDATE_STATUS)+"\n\nProgram Info Log: "+t+"\n"+e+"\n"+i)}}else""!==t?console.warn("THREE.WebGLProgram: Program Info Log:",t):(""===i||""===r)&&(o=!1);o&&(this.diagnostics={runnable:s,programLog:t,vertexShader:{log:i,prefix:n},fragmentShader:{log:r,prefix:a}})}return c.deleteShader(R),c.deleteShader(C),this.getUniforms=function(){return void 0===s&&(s=new sV(c,T)),s},this.getAttributes=function(){return void 0===o&&(o=function(e,t){let i={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let n=0;n<r;n++){let r=e.getActiveAttrib(t,n),a=r.name,s=1;r.type===e.FLOAT_MAT2&&(s=2),r.type===e.FLOAT_MAT3&&(s=3),r.type===e.FLOAT_MAT4&&(s=4),i[a]={type:r.type,location:e.getAttribLocation(t,a),locationSize:s}}return i}(c,T)),o},this.destroy=function(){r.releaseStatesOfProgram(this),c.deleteProgram(T),this.program=void 0},this.type=i.shaderType,this.name=i.shaderName,this.id=sj++,this.cacheKey=t,this.usedTimes=1,this.program=T,this.vertexShader=R,this.fragmentShader=C,this}let s2=0;class s3{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){let t=e.vertexShader,i=e.fragmentShader,r=this._getShaderStage(t),n=this._getShaderStage(i),a=this._getShaderCacheForMaterial(e);return!1===a.has(r)&&(a.add(r),r.usedTimes++),!1===a.has(n)&&(a.add(n),n.usedTimes++),this}remove(e){let t=this.materialCache.get(e);for(let e of t)e.usedTimes--,0===e.usedTimes&&this.shaderCache.delete(e.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){let t=this.materialCache,i=t.get(e);return void 0===i&&(i=new Set,t.set(e,i)),i}_getShaderStage(e){let t=this.shaderCache,i=t.get(e);return void 0===i&&(i=new s5(e),t.set(e,i)),i}}class s5{constructor(e){this.id=s2++,this.code=e,this.usedTimes=0}}function s4(e,t,i,r,n,a,s){let o=new rj,l=new s3,u=[],c=n.isWebGL2,d=n.logarithmicDepthBuffer,h=n.vertexTextures,f=n.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(e){return 0===e?"uv":`uv${e}`}return{getParameters:function(a,o,u,g,v){let y,b,S,x;let w=g.fog,A=v.geometry,M=a.isMeshStandardMaterial?g.environment:null,R=(a.isMeshStandardMaterial?i:t).get(a.envMap||M),C=R&&R.mapping===ef?R.image.height:null,I=p[a.type];null!==a.precision&&(f=n.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",f,"instead.");let L=A.morphAttributes.position||A.morphAttributes.normal||A.morphAttributes.color,k=void 0!==L?L.length:0,D=0;if(void 0!==A.morphAttributes.position&&(D=1),void 0!==A.morphAttributes.normal&&(D=2),void 0!==A.morphAttributes.color&&(D=3),I){let e=av[I];y=e.vertexShader,b=e.fragmentShader}else y=a.vertexShader,b=a.fragmentShader,l.update(a),S=l.getVertexShaderID(a),x=l.getFragmentShaderID(a);let P=e.getRenderTarget(),O=!0===v.isInstancedMesh,N=!!a.map,U=!!a.matcap,F=!!R,B=!!a.aoMap,V=!!a.lightMap,z=!!a.bumpMap,j=!!a.normalMap,H=!!a.displacementMap,G=!!a.emissiveMap,W=!!a.metalnessMap,$=!!a.roughnessMap,q=a.anisotropy>0,Y=a.clearcoat>0,K=a.iridescence>0,X=a.sheen>0,Z=a.transmission>0,J=q&&!!a.anisotropyMap,Q=Y&&!!a.clearcoatMap,ee=Y&&!!a.clearcoatNormalMap,et=Y&&!!a.clearcoatRoughnessMap,er=K&&!!a.iridescenceMap,en=K&&!!a.iridescenceThicknessMap,ea=X&&!!a.sheenColorMap,es=X&&!!a.sheenRoughnessMap,eo=!!a.specularMap,el=!!a.specularColorMap,eu=!!a.specularIntensityMap,ec=Z&&!!a.transmissionMap,ed=Z&&!!a.thicknessMap,eh=!!a.gradientMap,ep=!!a.alphaMap,em=a.alphaTest>0,eg=!!a.alphaHash,ev=!!a.extensions,ey=!!A.attributes.uv1,eb=!!A.attributes.uv2,e_=!!A.attributes.uv3,eE=ei;a.toneMapped&&(null===P||!0===P.isXRRenderTarget)&&(eE=e.toneMapping);let eS={isWebGL2:c,shaderID:I,shaderType:a.type,shaderName:a.name,vertexShader:y,fragmentShader:b,defines:a.defines,customVertexShaderID:S,customFragmentShaderID:x,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:f,instancing:O,instancingColor:O&&null!==v.instanceColor,supportsVertexTextures:h,outputColorSpace:null===P?e.outputColorSpace:!0===P.isXRRenderTarget?P.texture.colorSpace:tB,map:N,matcap:U,envMap:F,envMapMode:F&&R.mapping,envMapCubeUVHeight:C,aoMap:B,lightMap:V,bumpMap:z,normalMap:j,displacementMap:h&&H,emissiveMap:G,normalMapObjectSpace:j&&a.normalMapType===tN,normalMapTangentSpace:j&&a.normalMapType===tO,metalnessMap:W,roughnessMap:$,anisotropy:q,anisotropyMap:J,clearcoat:Y,clearcoatMap:Q,clearcoatNormalMap:ee,clearcoatRoughnessMap:et,iridescence:K,iridescenceMap:er,iridescenceThicknessMap:en,sheen:X,sheenColorMap:ea,sheenRoughnessMap:es,specularMap:eo,specularColorMap:el,specularIntensityMap:eu,transmission:Z,transmissionMap:ec,thicknessMap:ed,gradientMap:eh,opaque:!1===a.transparent&&a.blending===T,alphaMap:ep,alphaTest:em,alphaHash:eg,combine:a.combine,mapUv:N&&m(a.map.channel),aoMapUv:B&&m(a.aoMap.channel),lightMapUv:V&&m(a.lightMap.channel),bumpMapUv:z&&m(a.bumpMap.channel),normalMapUv:j&&m(a.normalMap.channel),displacementMapUv:H&&m(a.displacementMap.channel),emissiveMapUv:G&&m(a.emissiveMap.channel),metalnessMapUv:W&&m(a.metalnessMap.channel),roughnessMapUv:$&&m(a.roughnessMap.channel),anisotropyMapUv:J&&m(a.anisotropyMap.channel),clearcoatMapUv:Q&&m(a.clearcoatMap.channel),clearcoatNormalMapUv:ee&&m(a.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:et&&m(a.clearcoatRoughnessMap.channel),iridescenceMapUv:er&&m(a.iridescenceMap.channel),iridescenceThicknessMapUv:en&&m(a.iridescenceThicknessMap.channel),sheenColorMapUv:ea&&m(a.sheenColorMap.channel),sheenRoughnessMapUv:es&&m(a.sheenRoughnessMap.channel),specularMapUv:eo&&m(a.specularMap.channel),specularColorMapUv:el&&m(a.specularColorMap.channel),specularIntensityMapUv:eu&&m(a.specularIntensityMap.channel),transmissionMapUv:ec&&m(a.transmissionMap.channel),thicknessMapUv:ed&&m(a.thicknessMap.channel),alphaMapUv:ep&&m(a.alphaMap.channel),vertexTangents:!!A.attributes.tangent&&(j||q),vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&!!A.attributes.color&&4===A.attributes.color.itemSize,vertexUv1s:ey,vertexUv2s:eb,vertexUv3s:e_,pointsUvs:!0===v.isPoints&&!!A.attributes.uv&&(N||ep),fog:!!w,useFog:!0===a.fog,fogExp2:w&&w.isFogExp2,flatShading:!0===a.flatShading,sizeAttenuation:!0===a.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===v.isSkinnedMesh,morphTargets:void 0!==A.morphAttributes.position,morphNormals:void 0!==A.morphAttributes.normal,morphColors:void 0!==A.morphAttributes.color,morphTargetsCount:k,morphTextureStride:D,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numSpotLightMaps:o.spotLightMap.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numSpotLightShadowsWithMaps:o.numSpotLightShadowsWithMaps,numClippingPlanes:s.numPlanes,numClipIntersection:s.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&u.length>0,shadowMapType:e.shadowMap.type,toneMapping:eE,useLegacyLights:e._useLegacyLights,decodeVideoTexture:N&&!0===a.map.isVideoTexture&&a.map.colorSpace===tF,premultipliedAlpha:a.premultipliedAlpha,doubleSided:a.side===E,flipSided:a.side===_,useDepthPacking:a.depthPacking>=0,depthPacking:a.depthPacking||0,index0AttributeName:a.index0AttributeName,extensionDerivatives:ev&&!0===a.extensions.derivatives,extensionFragDepth:ev&&!0===a.extensions.fragDepth,extensionDrawBuffers:ev&&!0===a.extensions.drawBuffers,extensionShaderTextureLOD:ev&&!0===a.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:c||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:c||r.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()};return eS},getProgramCacheKey:function(t){let i=[];if(t.shaderID?i.push(t.shaderID):(i.push(t.customVertexShaderID),i.push(t.customFragmentShaderID)),void 0!==t.defines)for(let e in t.defines)i.push(e),i.push(t.defines[e]);return!1===t.isRawShaderMaterial&&(i.push(t.precision),i.push(t.outputColorSpace),i.push(t.envMapMode),i.push(t.envMapCubeUVHeight),i.push(t.mapUv),i.push(t.alphaMapUv),i.push(t.lightMapUv),i.push(t.aoMapUv),i.push(t.bumpMapUv),i.push(t.normalMapUv),i.push(t.displacementMapUv),i.push(t.emissiveMapUv),i.push(t.metalnessMapUv),i.push(t.roughnessMapUv),i.push(t.anisotropyMapUv),i.push(t.clearcoatMapUv),i.push(t.clearcoatNormalMapUv),i.push(t.clearcoatRoughnessMapUv),i.push(t.iridescenceMapUv),i.push(t.iridescenceThicknessMapUv),i.push(t.sheenColorMapUv),i.push(t.sheenRoughnessMapUv),i.push(t.specularMapUv),i.push(t.specularColorMapUv),i.push(t.specularIntensityMapUv),i.push(t.transmissionMapUv),i.push(t.thicknessMapUv),i.push(t.combine),i.push(t.fogExp2),i.push(t.sizeAttenuation),i.push(t.morphTargetsCount),i.push(t.morphAttributeCount),i.push(t.numDirLights),i.push(t.numPointLights),i.push(t.numSpotLights),i.push(t.numSpotLightMaps),i.push(t.numHemiLights),i.push(t.numRectAreaLights),i.push(t.numDirLightShadows),i.push(t.numPointLightShadows),i.push(t.numSpotLightShadows),i.push(t.numSpotLightShadowsWithMaps),i.push(t.shadowMapType),i.push(t.toneMapping),i.push(t.numClippingPlanes),i.push(t.numClipIntersection),i.push(t.depthPacking),o.disableAll(),t.isWebGL2&&o.enable(0),t.supportsVertexTextures&&o.enable(1),t.instancing&&o.enable(2),t.instancingColor&&o.enable(3),t.matcap&&o.enable(4),t.envMap&&o.enable(5),t.normalMapObjectSpace&&o.enable(6),t.normalMapTangentSpace&&o.enable(7),t.clearcoat&&o.enable(8),t.iridescence&&o.enable(9),t.alphaTest&&o.enable(10),t.vertexColors&&o.enable(11),t.vertexAlphas&&o.enable(12),t.vertexUv1s&&o.enable(13),t.vertexUv2s&&o.enable(14),t.vertexUv3s&&o.enable(15),t.vertexTangents&&o.enable(16),t.anisotropy&&o.enable(17),i.push(o.mask),o.disableAll(),t.fog&&o.enable(0),t.useFog&&o.enable(1),t.flatShading&&o.enable(2),t.logarithmicDepthBuffer&&o.enable(3),t.skinning&&o.enable(4),t.morphTargets&&o.enable(5),t.morphNormals&&o.enable(6),t.morphColors&&o.enable(7),t.premultipliedAlpha&&o.enable(8),t.shadowMapEnabled&&o.enable(9),t.useLegacyLights&&o.enable(10),t.doubleSided&&o.enable(11),t.flipSided&&o.enable(12),t.useDepthPacking&&o.enable(13),t.dithering&&o.enable(14),t.transmission&&o.enable(15),t.sheen&&o.enable(16),t.opaque&&o.enable(17),t.pointsUvs&&o.enable(18),t.decodeVideoTexture&&o.enable(19),i.push(o.mask),i.push(e.outputColorSpace)),i.push(t.customProgramCacheKey),i.join()},getUniforms:function(e){let t;let i=p[e.type];if(i){let e=av[i];t=n7.clone(e.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,i){let r;for(let e=0,t=u.length;e<t;e++){let t=u[e];if(t.cacheKey===i){r=t,++r.usedTimes;break}}return void 0===r&&(r=new s1(e,i,t,a),u.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){let t=u.indexOf(e);u[t]=u[u.length-1],u.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:u,dispose:function(){l.dispose()}}}function s6(){let e=new WeakMap;return{get:function(t){let i=e.get(t);return void 0===i&&(i={},e.set(t,i)),i},remove:function(t){e.delete(t)},update:function(t,i,r){e.get(t)[i]=r},dispose:function(){e=new WeakMap}}}function s8(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function s7(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function s9(){let e=[],t=0,i=[],r=[],n=[];function a(i,r,n,a,s,o){let l=e[t];return void 0===l?(l={id:i.id,object:i,geometry:r,material:n,groupOrder:a,renderOrder:i.renderOrder,z:s,group:o},e[t]=l):(l.id=i.id,l.object=i,l.geometry=r,l.material=n,l.groupOrder=a,l.renderOrder=i.renderOrder,l.z=s,l.group=o),t++,l}return{opaque:i,transmissive:r,transparent:n,init:function(){t=0,i.length=0,r.length=0,n.length=0},push:function(e,t,s,o,l,u){let c=a(e,t,s,o,l,u);s.transmission>0?r.push(c):!0===s.transparent?n.push(c):i.push(c)},unshift:function(e,t,s,o,l,u){let c=a(e,t,s,o,l,u);s.transmission>0?r.unshift(c):!0===s.transparent?n.unshift(c):i.unshift(c)},finish:function(){for(let i=t,r=e.length;i<r;i++){let t=e[i];if(null===t.id)break;t.id=null,t.object=null,t.geometry=null,t.material=null,t.group=null}},sort:function(e,t){i.length>1&&i.sort(e||s8),r.length>1&&r.sort(t||s7),n.length>1&&n.sort(t||s7)}}}function oe(){let e=new WeakMap;return{get:function(t,i){let r;let n=e.get(t);return void 0===n?(r=new s9,e.set(t,[r])):i>=n.length?(r=new s9,n.push(r)):r=n[i],r},dispose:function(){e=new WeakMap}}}function ot(){let e={};return{get:function(t){let i;if(void 0!==e[t.id])return e[t.id];switch(t.type){case"DirectionalLight":i={direction:new rt,color:new nd};break;case"SpotLight":i={position:new rt,direction:new rt,color:new nd,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new rt,color:new nd,distance:0,decay:0};break;case"HemisphereLight":i={direction:new rt,skyColor:new nd,groundColor:new nd};break;case"RectAreaLight":i={color:new nd,position:new rt,halfWidth:new rt,halfHeight:new rt}}return e[t.id]=i,i}}}let oi=0;function or(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function on(e,t){let i=new ot,r=function(){let e={};return{get:function(t){let i;if(void 0!==e[t.id])return e[t.id];switch(t.type){case"DirectionalLight":case"SpotLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new iD};break;case"PointLight":i={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new iD,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=i,i}}}(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0};for(let e=0;e<9;e++)n.probe.push(new rt);let a=new rt,s=new rL,o=new rL;return{setup:function(a,s){let o=0,l=0,u=0;for(let e=0;e<9;e++)n.probe[e].set(0,0,0);let c=0,d=0,h=0,f=0,p=0,m=0,g=0,v=0,y=0,b=0;a.sort(or);let _=!0===s?Math.PI:1;for(let e=0,t=a.length;e<t;e++){let t=a[e],s=t.color,E=t.intensity,S=t.distance,x=t.shadow&&t.shadow.map?t.shadow.map.texture:null;if(t.isAmbientLight)o+=s.r*E*_,l+=s.g*E*_,u+=s.b*E*_;else if(t.isLightProbe)for(let e=0;e<9;e++)n.probe[e].addScaledVector(t.sh.coefficients[e],E);else if(t.isDirectionalLight){let e=i.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*_),t.castShadow){let e=t.shadow,i=r.get(t);i.shadowBias=e.bias,i.shadowNormalBias=e.normalBias,i.shadowRadius=e.radius,i.shadowMapSize=e.mapSize,n.directionalShadow[c]=i,n.directionalShadowMap[c]=x,n.directionalShadowMatrix[c]=t.shadow.matrix,m++}n.directional[c]=e,c++}else if(t.isSpotLight){let e=i.get(t);e.position.setFromMatrixPosition(t.matrixWorld),e.color.copy(s).multiplyScalar(E*_),e.distance=S,e.coneCos=Math.cos(t.angle),e.penumbraCos=Math.cos(t.angle*(1-t.penumbra)),e.decay=t.decay,n.spot[h]=e;let a=t.shadow;if(t.map&&(n.spotLightMap[y]=t.map,y++,a.updateMatrices(t),t.castShadow&&b++),n.spotLightMatrix[h]=a.matrix,t.castShadow){let e=r.get(t);e.shadowBias=a.bias,e.shadowNormalBias=a.normalBias,e.shadowRadius=a.radius,e.shadowMapSize=a.mapSize,n.spotShadow[h]=e,n.spotShadowMap[h]=x,v++}h++}else if(t.isRectAreaLight){let e=i.get(t);e.color.copy(s).multiplyScalar(E),e.halfWidth.set(.5*t.width,0,0),e.halfHeight.set(0,.5*t.height,0),n.rectArea[f]=e,f++}else if(t.isPointLight){let e=i.get(t);if(e.color.copy(t.color).multiplyScalar(t.intensity*_),e.distance=t.distance,e.decay=t.decay,t.castShadow){let e=t.shadow,i=r.get(t);i.shadowBias=e.bias,i.shadowNormalBias=e.normalBias,i.shadowRadius=e.radius,i.shadowMapSize=e.mapSize,i.shadowCameraNear=e.camera.near,i.shadowCameraFar=e.camera.far,n.pointShadow[d]=i,n.pointShadowMap[d]=x,n.pointShadowMatrix[d]=t.shadow.matrix,g++}n.point[d]=e,d++}else if(t.isHemisphereLight){let e=i.get(t);e.skyColor.copy(t.color).multiplyScalar(E*_),e.groundColor.copy(t.groundColor).multiplyScalar(E*_),n.hemi[p]=e,p++}}f>0&&(t.isWebGL2?(n.rectAreaLTC1=ag.LTC_FLOAT_1,n.rectAreaLTC2=ag.LTC_FLOAT_2):!0===e.has("OES_texture_float_linear")?(n.rectAreaLTC1=ag.LTC_FLOAT_1,n.rectAreaLTC2=ag.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(n.rectAreaLTC1=ag.LTC_HALF_1,n.rectAreaLTC2=ag.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),n.ambient[0]=o,n.ambient[1]=l,n.ambient[2]=u;let E=n.hash;(E.directionalLength!==c||E.pointLength!==d||E.spotLength!==h||E.rectAreaLength!==f||E.hemiLength!==p||E.numDirectionalShadows!==m||E.numPointShadows!==g||E.numSpotShadows!==v||E.numSpotMaps!==y)&&(n.directional.length=c,n.spot.length=h,n.rectArea.length=f,n.point.length=d,n.hemi.length=p,n.directionalShadow.length=m,n.directionalShadowMap.length=m,n.pointShadow.length=g,n.pointShadowMap.length=g,n.spotShadow.length=v,n.spotShadowMap.length=v,n.directionalShadowMatrix.length=m,n.pointShadowMatrix.length=g,n.spotLightMatrix.length=v+y-b,n.spotLightMap.length=y,n.numSpotLightShadowsWithMaps=b,E.directionalLength=c,E.pointLength=d,E.spotLength=h,E.rectAreaLength=f,E.hemiLength=p,E.numDirectionalShadows=m,E.numPointShadows=g,E.numSpotShadows=v,E.numSpotMaps=y,n.version=oi++)},setupView:function(e,t){let i=0,r=0,l=0,u=0,c=0,d=t.matrixWorldInverse;for(let t=0,h=e.length;t<h;t++){let h=e[t];if(h.isDirectionalLight){let e=n.directional[i];e.direction.setFromMatrixPosition(h.matrixWorld),a.setFromMatrixPosition(h.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(d),i++}else if(h.isSpotLight){let e=n.spot[l];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(d),e.direction.setFromMatrixPosition(h.matrixWorld),a.setFromMatrixPosition(h.target.matrixWorld),e.direction.sub(a),e.direction.transformDirection(d),l++}else if(h.isRectAreaLight){let e=n.rectArea[u];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(d),o.identity(),s.copy(h.matrixWorld),s.premultiply(d),o.extractRotation(s),e.halfWidth.set(.5*h.width,0,0),e.halfHeight.set(0,.5*h.height,0),e.halfWidth.applyMatrix4(o),e.halfHeight.applyMatrix4(o),u++}else if(h.isPointLight){let e=n.point[r];e.position.setFromMatrixPosition(h.matrixWorld),e.position.applyMatrix4(d),r++}else if(h.isHemisphereLight){let e=n.hemi[c];e.direction.setFromMatrixPosition(h.matrixWorld),e.direction.transformDirection(d),c++}}},state:n}}function oa(e,t){let i=new on(e,t),r=[],n=[];return{init:function(){r.length=0,n.length=0},state:{lightsArray:r,shadowsArray:n,lights:i},setupLights:function(e){i.setup(r,e)},setupLightsView:function(e){i.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){n.push(e)}}}function os(e,t){let i=new WeakMap;return{get:function(r,n=0){let a;let s=i.get(r);return void 0===s?(a=new oa(e,t),i.set(r,[a])):n>=s.length?(a=new oa(e,t),s.push(a)):a=s[n],a},dispose:function(){i=new WeakMap}}}class oo extends ns{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=tD,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class ol extends ns{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}function ou(e,t,i){let r=new ad,n=new iD,a=new iD,s=new i2,o=new oo({depthPacking:tP}),l=new ol,u={},c=i.maxTextureSize,d={[b]:_,[_]:b,[E]:E},h=new n9({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new iD},radius:{value:4}},vertexShader:"void main() {\n	gl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n	const float samples = float( VSM_SAMPLES );\n	float mean = 0.0;\n	float squared_mean = 0.0;\n	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n	for ( float i = 0.0; i < samples; i ++ ) {\n		float uvOffset = uvStart + i * uvStride;\n		#ifdef HORIZONTAL_PASS\n			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n			mean += distribution.x;\n			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n		#else\n			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n			mean += depth;\n			squared_mean += depth * depth;\n		#endif\n	}\n	mean = mean / samples;\n	squared_mean = squared_mean / samples;\n	float std_dev = sqrt( squared_mean - mean * mean );\n	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;let p=new nF;p.setAttribute("position",new n_(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));let m=new n2(p,h),v=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=g;let S=this.type;function T(t,i,r,n){let a=null,s=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==s)a=s;else if(a=!0===r.isPointLight?l:o,e.localClippingEnabled&&!0===i.clipShadows&&Array.isArray(i.clippingPlanes)&&0!==i.clippingPlanes.length||i.displacementMap&&0!==i.displacementScale||i.alphaMap&&i.alphaTest>0||i.map&&i.alphaTest>0){let e=a.uuid,t=i.uuid,r=u[e];void 0===r&&(r={},u[e]=r);let n=r[t];void 0===n&&(n=a.clone(),r[t]=n),a=n}if(a.visible=i.visible,a.wireframe=i.wireframe,n===y?a.side=null!==i.shadowSide?i.shadowSide:i.side:a.side=null!==i.shadowSide?i.shadowSide:d[i.side],a.alphaMap=i.alphaMap,a.alphaTest=i.alphaTest,a.map=i.map,a.clipShadows=i.clipShadows,a.clippingPlanes=i.clippingPlanes,a.clipIntersection=i.clipIntersection,a.displacementMap=i.displacementMap,a.displacementScale=i.displacementScale,a.displacementBias=i.displacementBias,a.wireframeLinewidth=i.wireframeLinewidth,a.linewidth=i.linewidth,!0===r.isPointLight&&!0===a.isMeshDistanceMaterial){let t=e.properties.get(a);t.light=r}return a}this.render=function(i,o,l){if(!1===v.enabled||!1===v.autoUpdate&&!1===v.needsUpdate||0===i.length)return;let u=e.getRenderTarget(),d=e.getActiveCubeFace(),p=e.getActiveMipmapLevel(),g=e.state;g.setBlending(x),g.buffers.color.setClear(1,1,1,1),g.buffers.depth.setTest(!0),g.setScissorTest(!1);let b=S!==y&&this.type===y,_=S===y&&this.type!==y;for(let u=0,d=i.length;u<d;u++){let d=i[u],p=d.shadow;if(void 0===p){console.warn("THREE.WebGLShadowMap:",d,"has no shadow.");continue}if(!1===p.autoUpdate&&!1===p.needsUpdate)continue;n.copy(p.mapSize);let v=p.getFrameExtents();if(n.multiply(v),a.copy(p.mapSize),(n.x>c||n.y>c)&&(n.x>c&&(a.x=Math.floor(c/v.x),n.x=a.x*v.x,p.mapSize.x=a.x),n.y>c&&(a.y=Math.floor(c/v.y),n.y=a.y*v.y,p.mapSize.y=a.y)),null===p.map||!0===b||!0===_){let e=this.type!==y?{minFilter:ev,magFilter:ev}:{};null!==p.map&&p.map.dispose(),p.map=new i5(n.x,n.y,e),p.map.texture.name=d.name+".shadowMap",p.camera.updateProjectionMatrix()}e.setRenderTarget(p.map),e.clear();let E=p.getViewportCount();for(let i=0;i<E;i++){let n=p.getViewport(i);s.set(a.x*n.x,a.y*n.y,a.x*n.z,a.y*n.w),g.viewport(s),p.updateMatrices(d,i),r=p.getFrustum(),function i(n,a,s,o,l){if(!1===n.visible)return;let u=n.layers.test(a.layers);if(u&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&l===y)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,n.matrixWorld);let i=t.update(n),r=n.material;if(Array.isArray(r)){let t=i.groups;for(let a=0,u=t.length;a<u;a++){let u=t[a],c=r[u.materialIndex];if(c&&c.visible){let t=T(n,c,o,l);e.renderBufferDirect(s,null,i,t,n,u)}}}else if(r.visible){let t=T(n,r,o,l);e.renderBufferDirect(s,null,i,t,n,null)}}let c=n.children;for(let e=0,t=c.length;e<t;e++)i(c[e],a,s,o,l)}(o,l,p.camera,d,this.type)}!0!==p.isPointLightShadow&&this.type===y&&function(i,r){let a=t.update(m);h.defines.VSM_SAMPLES!==i.blurSamples&&(h.defines.VSM_SAMPLES=i.blurSamples,f.defines.VSM_SAMPLES=i.blurSamples,h.needsUpdate=!0,f.needsUpdate=!0),null===i.mapPass&&(i.mapPass=new i5(n.x,n.y)),h.uniforms.shadow_pass.value=i.map.texture,h.uniforms.resolution.value=i.mapSize,h.uniforms.radius.value=i.radius,e.setRenderTarget(i.mapPass),e.clear(),e.renderBufferDirect(r,null,a,h,m,null),f.uniforms.shadow_pass.value=i.mapPass.texture,f.uniforms.resolution.value=i.mapSize,f.uniforms.radius.value=i.radius,e.setRenderTarget(i.map),e.clear(),e.renderBufferDirect(r,null,a,f,m,null)}(p,l),p.needsUpdate=!1}S=this.type,v.needsUpdate=!1,e.setRenderTarget(u,d,p)}}function oc(e,t,i){let r=i.isWebGL2,n=new function(){let t=!1,i=new i2,r=null,n=new i2(0,0,0,0);return{setMask:function(i){r===i||t||(e.colorMask(i,i,i,i),r=i)},setLocked:function(e){t=e},setClear:function(t,r,a,s,o){!0===o&&(t*=s,r*=s,a*=s),i.set(t,r,a,s),!1===n.equals(i)&&(e.clearColor(t,r,a,s),n.copy(i))},reset:function(){t=!1,r=null,n.set(-1,0,0,0)}}},a=new function(){let t=!1,i=null,r=null,n=null;return{setTest:function(t){t?e_(e.DEPTH_TEST):eE(e.DEPTH_TEST)},setMask:function(r){i===r||t||(e.depthMask(r),i=r)},setFunc:function(t){if(r!==t){switch(t){case W:e.depthFunc(e.NEVER);break;case $:e.depthFunc(e.ALWAYS);break;case q:e.depthFunc(e.LESS);break;case Y:e.depthFunc(e.LEQUAL);break;case K:e.depthFunc(e.EQUAL);break;case X:e.depthFunc(e.GEQUAL);break;case Z:e.depthFunc(e.GREATER);break;case J:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}r=t}},setLocked:function(e){t=e},setClear:function(t){n!==t&&(e.clearDepth(t),n=t)},reset:function(){t=!1,i=null,r=null,n=null}}},s=new function(){let t=!1,i=null,r=null,n=null,a=null,s=null,o=null,l=null,u=null;return{setTest:function(i){t||(i?e_(e.STENCIL_TEST):eE(e.STENCIL_TEST))},setMask:function(r){i===r||t||(e.stencilMask(r),i=r)},setFunc:function(t,i,s){(r!==t||n!==i||a!==s)&&(e.stencilFunc(t,i,s),r=t,n=i,a=s)},setOp:function(t,i,r){(s!==t||o!==i||l!==r)&&(e.stencilOp(t,i,r),s=t,o=i,l=r)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,i=null,r=null,n=null,a=null,s=null,o=null,l=null,u=null}}},o=new WeakMap,l=new WeakMap,u={},c={},p=new WeakMap,m=[],g=null,v=!1,y=null,b=null,S=null,Q=null,ee=null,et=null,ei=null,er=!1,en=null,ea=null,es=null,eo=null,el=null,eu=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),ec=!1,ed=e.getParameter(e.VERSION);-1!==ed.indexOf("WebGL")?ec=parseFloat(/^WebGL (\d)/.exec(ed)[1])>=1:-1!==ed.indexOf("OpenGL ES")&&(ec=parseFloat(/^OpenGL ES (\d)/.exec(ed)[1])>=2);let eh=null,ef={},ep=e.getParameter(e.SCISSOR_BOX),em=e.getParameter(e.VIEWPORT),eg=new i2().fromArray(ep),ev=new i2().fromArray(em);function ey(t,i,n,a){let s=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let o=0;o<n;o++)r&&(t===e.TEXTURE_3D||t===e.TEXTURE_2D_ARRAY)?e.texImage3D(i,0,e.RGBA,1,1,a,0,e.RGBA,e.UNSIGNED_BYTE,s):e.texImage2D(i+o,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,s);return o}let eb={};function e_(t){!0!==u[t]&&(e.enable(t),u[t]=!0)}function eE(t){!1!==u[t]&&(e.disable(t),u[t]=!1)}eb[e.TEXTURE_2D]=ey(e.TEXTURE_2D,e.TEXTURE_2D,1),eb[e.TEXTURE_CUBE_MAP]=ey(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),r&&(eb[e.TEXTURE_2D_ARRAY]=ey(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),eb[e.TEXTURE_3D]=ey(e.TEXTURE_3D,e.TEXTURE_3D,1,1)),n.setClear(0,0,0,1),a.setClear(1),s.setClear(0),e_(e.DEPTH_TEST),a.setFunc(Y),ew(!1),eA(h),e_(e.CULL_FACE),eT(x);let eS={[C]:e.FUNC_ADD,[I]:e.FUNC_SUBTRACT,[L]:e.FUNC_REVERSE_SUBTRACT};if(r)eS[k]=e.MIN,eS[D]=e.MAX;else{let e=t.get("EXT_blend_minmax");null!==e&&(eS[k]=e.MIN_EXT,eS[D]=e.MAX_EXT)}let ex={[P]:e.ZERO,[O]:e.ONE,[N]:e.SRC_COLOR,[F]:e.SRC_ALPHA,[G]:e.SRC_ALPHA_SATURATE,[j]:e.DST_COLOR,[V]:e.DST_ALPHA,[U]:e.ONE_MINUS_SRC_COLOR,[B]:e.ONE_MINUS_SRC_ALPHA,[H]:e.ONE_MINUS_DST_COLOR,[z]:e.ONE_MINUS_DST_ALPHA};function eT(t,i,r,n,a,s,o,l){if(t===x){!0===v&&(eE(e.BLEND),v=!1);return}if(!1===v&&(e_(e.BLEND),v=!0),t!==R){if(t!==y||l!==er){if((b!==C||ee!==C)&&(e.blendEquation(e.FUNC_ADD),b=C,ee=C),l)switch(t){case T:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case w:e.blendFunc(e.ONE,e.ONE);break;case A:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case M:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case T:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case w:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case A:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case M:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}S=null,Q=null,et=null,ei=null,y=t,er=l}return}a=a||i,s=s||r,o=o||n,(i!==b||a!==ee)&&(e.blendEquationSeparate(eS[i],eS[a]),b=i,ee=a),(r!==S||n!==Q||s!==et||o!==ei)&&(e.blendFuncSeparate(ex[r],ex[n],ex[s],ex[o]),S=r,Q=n,et=s,ei=o),y=t,er=!1}function ew(t){en!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),en=t)}function eA(t){t!==d?(e_(e.CULL_FACE),t!==ea&&(t===h?e.cullFace(e.BACK):t===f?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):eE(e.CULL_FACE),ea=t}function eM(t,i,r){t?(e_(e.POLYGON_OFFSET_FILL),(eo!==i||el!==r)&&(e.polygonOffset(i,r),eo=i,el=r)):eE(e.POLYGON_OFFSET_FILL)}return{buffers:{color:n,depth:a,stencil:s},enable:e_,disable:eE,bindFramebuffer:function(t,i){return c[t]!==i&&(e.bindFramebuffer(t,i),c[t]=i,r&&(t===e.DRAW_FRAMEBUFFER&&(c[e.FRAMEBUFFER]=i),t===e.FRAMEBUFFER&&(c[e.DRAW_FRAMEBUFFER]=i)),!0)},drawBuffers:function(r,n){let a=m,s=!1;if(r){if(void 0===(a=p.get(n))&&(a=[],p.set(n,a)),r.isWebGLMultipleRenderTargets){let t=r.texture;if(a.length!==t.length||a[0]!==e.COLOR_ATTACHMENT0){for(let i=0,r=t.length;i<r;i++)a[i]=e.COLOR_ATTACHMENT0+i;a.length=t.length,s=!0}}else a[0]!==e.COLOR_ATTACHMENT0&&(a[0]=e.COLOR_ATTACHMENT0,s=!0)}else a[0]!==e.BACK&&(a[0]=e.BACK,s=!0);s&&(i.isWebGL2?e.drawBuffers(a):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(a))},useProgram:function(t){return g!==t&&(e.useProgram(t),g=t,!0)},setBlending:eT,setMaterial:function(t,i){t.side===E?eE(e.CULL_FACE):e_(e.CULL_FACE);let r=t.side===_;i&&(r=!r),ew(r),t.blending===T&&!1===t.transparent?eT(x):eT(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),a.setFunc(t.depthFunc),a.setTest(t.depthTest),a.setMask(t.depthWrite),n.setMask(t.colorWrite);let o=t.stencilWrite;s.setTest(o),o&&(s.setMask(t.stencilWriteMask),s.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),s.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),eM(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?e_(e.SAMPLE_ALPHA_TO_COVERAGE):eE(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:ew,setCullFace:eA,setLineWidth:function(t){t!==es&&(ec&&e.lineWidth(t),es=t)},setPolygonOffset:eM,setScissorTest:function(t){t?e_(e.SCISSOR_TEST):eE(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+eu-1),eh!==t&&(e.activeTexture(t),eh=t)},bindTexture:function(t,i,r){void 0===r&&(r=null===eh?e.TEXTURE0+eu-1:eh);let n=ef[r];void 0===n&&(n={type:void 0,texture:void 0},ef[r]=n),(n.type!==t||n.texture!==i)&&(eh!==r&&(e.activeTexture(r),eh=r),e.bindTexture(t,i||eb[t]),n.type=t,n.texture=i)},unbindTexture:function(){let t=ef[eh];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},updateUBOMapping:function(t,i){let r=l.get(i);void 0===r&&(r=new WeakMap,l.set(i,r));let n=r.get(t);void 0===n&&(n=e.getUniformBlockIndex(i,t.name),r.set(t,n))},uniformBlockBinding:function(t,i){let r=l.get(i),n=r.get(t);o.get(i)!==n&&(e.uniformBlockBinding(i,n,t.__bindingPointIndex),o.set(i,n))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===eg.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),eg.copy(t))},viewport:function(t){!1===ev.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),ev.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),!0===r&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),u={},eh=null,ef={},c={},p=new WeakMap,m=[],g=null,v=!1,y=null,b=null,S=null,Q=null,ee=null,et=null,ei=null,er=!1,en=null,ea=null,es=null,eo=null,el=null,eg.set(0,0,e.canvas.width,e.canvas.height),ev.set(0,0,e.canvas.width,e.canvas.height),n.reset(),a.reset(),s.reset()}}}function od(e,t,i,r,n,a,s){let o;let l=n.isWebGL2,u=n.maxTextures,c=n.maxCubemapSize,d=n.maxTextureSize,h=n.maxSamples,f=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,p="undefined"!=typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),m=new WeakMap,g=new WeakMap,v=!1;try{v="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function y(e,t){return v?new OffscreenCanvas(e,t):iB("canvas")}function b(e,t,i,r){let n=1;if((e.width>r||e.height>r)&&(n=r/Math.max(e.width,e.height)),n<1||!0===t){if("undefined"!=typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&e instanceof ImageBitmap){let r=t?iC:Math.floor,a=r(n*e.width),s=r(n*e.height);void 0===o&&(o=y(a,s));let l=i?y(a,s):o;l.width=a,l.height=s;let u=l.getContext("2d");return u.drawImage(e,0,0,a,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+a+"x"+s+")."),l}"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+").")}return e}function _(e){return iM(e.width)&&iM(e.height)}function E(e,t){return e.generateMipmaps&&t&&e.minFilter!==ev&&e.minFilter!==eS}function S(t){e.generateMipmap(t)}function x(i,r,n,a,s=!1){if(!1===l)return r;if(null!==i){if(void 0!==e[i])return e[i];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+i+"'")}let o=r;return r===e.RED&&(n===e.FLOAT&&(o=e.R32F),n===e.HALF_FLOAT&&(o=e.R16F),n===e.UNSIGNED_BYTE&&(o=e.R8)),r===e.RED_INTEGER&&(n===e.UNSIGNED_BYTE&&(o=e.R8UI),n===e.UNSIGNED_SHORT&&(o=e.R16UI),n===e.UNSIGNED_INT&&(o=e.R32UI),n===e.BYTE&&(o=e.R8I),n===e.SHORT&&(o=e.R16I),n===e.INT&&(o=e.R32I)),r===e.RG&&(n===e.FLOAT&&(o=e.RG32F),n===e.HALF_FLOAT&&(o=e.RG16F),n===e.UNSIGNED_BYTE&&(o=e.RG8)),r===e.RGBA&&(n===e.FLOAT&&(o=e.RGBA32F),n===e.HALF_FLOAT&&(o=e.RGBA16F),n===e.UNSIGNED_BYTE&&(o=a===tF&&!1===s?e.SRGB8_ALPHA8:e.RGBA8),n===e.UNSIGNED_SHORT_4_4_4_4&&(o=e.RGBA4),n===e.UNSIGNED_SHORT_5_5_5_1&&(o=e.RGB5_A1)),(o===e.R16F||o===e.R32F||o===e.RG16F||o===e.RG32F||o===e.RGBA16F||o===e.RGBA32F)&&t.get("EXT_color_buffer_float"),o}function T(e,t,i){return!0===E(e,i)||e.isFramebufferTexture&&e.minFilter!==ev&&e.minFilter!==eS?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function w(t){return t===ev||t===ey||t===e_?e.NEAREST:e.LINEAR}function A(e){let t=e.target;t.removeEventListener("dispose",A),function(e){let t=r.get(e);if(void 0===t.__webglInit)return;let i=e.source,n=g.get(i);if(n){let r=n[t.__cacheKey];r.usedTimes--,0===r.usedTimes&&R(e),0===Object.keys(n).length&&g.delete(i)}r.remove(e)}(t),t.isVideoTexture&&m.delete(t)}function M(t){let i=t.target;i.removeEventListener("dispose",M),function(t){let i=t.texture,n=r.get(t),a=r.get(i);if(void 0!==a.__webglTexture&&(e.deleteTexture(a.__webglTexture),s.memory.textures--),t.depthTexture&&t.depthTexture.dispose(),t.isWebGLCubeRenderTarget)for(let t=0;t<6;t++){if(Array.isArray(n.__webglFramebuffer[t]))for(let i=0;i<n.__webglFramebuffer[t].length;i++)e.deleteFramebuffer(n.__webglFramebuffer[t][i]);else e.deleteFramebuffer(n.__webglFramebuffer[t]);n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer[t])}else{if(Array.isArray(n.__webglFramebuffer))for(let t=0;t<n.__webglFramebuffer.length;t++)e.deleteFramebuffer(n.__webglFramebuffer[t]);else e.deleteFramebuffer(n.__webglFramebuffer);if(n.__webglDepthbuffer&&e.deleteRenderbuffer(n.__webglDepthbuffer),n.__webglMultisampledFramebuffer&&e.deleteFramebuffer(n.__webglMultisampledFramebuffer),n.__webglColorRenderbuffer)for(let t=0;t<n.__webglColorRenderbuffer.length;t++)n.__webglColorRenderbuffer[t]&&e.deleteRenderbuffer(n.__webglColorRenderbuffer[t]);n.__webglDepthRenderbuffer&&e.deleteRenderbuffer(n.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(let t=0,n=i.length;t<n;t++){let n=r.get(i[t]);n.__webglTexture&&(e.deleteTexture(n.__webglTexture),s.memory.textures--),r.remove(i[t])}r.remove(i),r.remove(t)}(i)}function R(t){let i=r.get(t);e.deleteTexture(i.__webglTexture);let n=t.source,a=g.get(n);delete a[i.__cacheKey],s.memory.textures--}let C=0;function I(t,n){let a=r.get(t);if(t.isVideoTexture&&function(e){let t=s.render.frame;m.get(e)!==t&&(m.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&a.__version!==t.version){let e=t.image;if(null===e)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(!1===e.complete)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{N(a,t,n);return}}i.bindTexture(e.TEXTURE_2D,a.__webglTexture,e.TEXTURE0+n)}let L={[ep]:e.REPEAT,[em]:e.CLAMP_TO_EDGE,[eg]:e.MIRRORED_REPEAT},k={[ev]:e.NEAREST,[ey]:e.NEAREST_MIPMAP_NEAREST,[e_]:e.NEAREST_MIPMAP_LINEAR,[eS]:e.LINEAR,[ex]:e.LINEAR_MIPMAP_NEAREST,[ew]:e.LINEAR_MIPMAP_LINEAR},D={[t5]:e.NEVER,[it]:e.ALWAYS,[t4]:e.LESS,[t8]:e.LEQUAL,[t6]:e.EQUAL,[ie]:e.GEQUAL,[t7]:e.GREATER,[t9]:e.NOTEQUAL};function P(i,a,s){if(s?(e.texParameteri(i,e.TEXTURE_WRAP_S,L[a.wrapS]),e.texParameteri(i,e.TEXTURE_WRAP_T,L[a.wrapT]),(i===e.TEXTURE_3D||i===e.TEXTURE_2D_ARRAY)&&e.texParameteri(i,e.TEXTURE_WRAP_R,L[a.wrapR]),e.texParameteri(i,e.TEXTURE_MAG_FILTER,k[a.magFilter]),e.texParameteri(i,e.TEXTURE_MIN_FILTER,k[a.minFilter])):(e.texParameteri(i,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(i,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),(i===e.TEXTURE_3D||i===e.TEXTURE_2D_ARRAY)&&e.texParameteri(i,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),(a.wrapS!==em||a.wrapT!==em)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(i,e.TEXTURE_MAG_FILTER,w(a.magFilter)),e.texParameteri(i,e.TEXTURE_MIN_FILTER,w(a.minFilter)),a.minFilter!==ev&&a.minFilter!==eS&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),a.compareFunction&&(e.texParameteri(i,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(i,e.TEXTURE_COMPARE_FUNC,D[a.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){let s=t.get("EXT_texture_filter_anisotropic");a.magFilter!==ev&&(a.minFilter===e_||a.minFilter===ew)&&(a.type!==eD||!1!==t.has("OES_texture_float_linear"))&&(!1!==l||a.type!==eP||!1!==t.has("OES_texture_half_float_linear"))&&(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(e.texParameterf(i,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,n.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function O(t,i){let r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,i.addEventListener("dispose",A));let n=i.source,a=g.get(n);void 0===a&&(a={},g.set(n,a));let o=function(e){let t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(i);if(o!==t.__cacheKey){void 0===a[o]&&(a[o]={texture:e.createTexture(),usedTimes:0},s.memory.textures++,r=!0),a[o].usedTimes++;let n=a[t.__cacheKey];void 0!==n&&(a[t.__cacheKey].usedTimes--,0===n.usedTimes&&R(i)),t.__cacheKey=o,t.__webglTexture=a[o].texture}return r}function N(t,n,s){let o=e.TEXTURE_2D;(n.isDataArrayTexture||n.isCompressedArrayTexture)&&(o=e.TEXTURE_2D_ARRAY),n.isData3DTexture&&(o=e.TEXTURE_3D);let u=O(t,n),c=n.source;i.bindTexture(o,t.__webglTexture,e.TEXTURE0+s);let h=r.get(c);if(c.version!==h.__version||!0===u){let t;i.activeTexture(e.TEXTURE0+s),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);let r=!l&&(n.wrapS!==em||n.wrapT!==em||n.minFilter!==ev&&n.minFilter!==eS)&&!1===_(n.image),f=b(n.image,r,!1,d);f=j(n,f);let p=_(f)||l,m=a.convert(n.format,n.colorSpace),g=a.convert(n.type),v=x(n.internalFormat,m,g,n.colorSpace,n.isVideoTexture);P(o,n,p);let y=n.mipmaps,w=l&&!0!==n.isVideoTexture,A=void 0===h.__version||!0===u,M=T(n,f,p);if(n.isDepthTexture)v=e.DEPTH_COMPONENT,l?v=n.type===eD?e.DEPTH_COMPONENT32F:n.type===ek?e.DEPTH_COMPONENT24:n.type===eU?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT16:n.type===eD&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),n.format===ej&&v===e.DEPTH_COMPONENT&&n.type!==eI&&n.type!==ek&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=ek,g=a.convert(n.type)),n.format===eH&&v===e.DEPTH_COMPONENT&&(v=e.DEPTH_STENCIL,n.type!==eU&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=eU,g=a.convert(n.type))),A&&(w?i.texStorage2D(e.TEXTURE_2D,1,v,f.width,f.height):i.texImage2D(e.TEXTURE_2D,0,v,f.width,f.height,0,m,g,null));else if(n.isDataTexture){if(y.length>0&&p){w&&A&&i.texStorage2D(e.TEXTURE_2D,M,v,y[0].width,y[0].height);for(let r=0,n=y.length;r<n;r++)t=y[r],w?i.texSubImage2D(e.TEXTURE_2D,r,0,0,t.width,t.height,m,g,t.data):i.texImage2D(e.TEXTURE_2D,r,v,t.width,t.height,0,m,g,t.data);n.generateMipmaps=!1}else w?(A&&i.texStorage2D(e.TEXTURE_2D,M,v,f.width,f.height),i.texSubImage2D(e.TEXTURE_2D,0,0,0,f.width,f.height,m,g,f.data)):i.texImage2D(e.TEXTURE_2D,0,v,f.width,f.height,0,m,g,f.data)}else if(n.isCompressedTexture){if(n.isCompressedArrayTexture){w&&A&&i.texStorage3D(e.TEXTURE_2D_ARRAY,M,v,y[0].width,y[0].height,f.depth);for(let r=0,a=y.length;r<a;r++)t=y[r],n.format!==eB?null!==m?w?i.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,r,0,0,0,t.width,t.height,f.depth,m,t.data,0,0):i.compressedTexImage3D(e.TEXTURE_2D_ARRAY,r,v,t.width,t.height,f.depth,0,t.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):w?i.texSubImage3D(e.TEXTURE_2D_ARRAY,r,0,0,0,t.width,t.height,f.depth,m,g,t.data):i.texImage3D(e.TEXTURE_2D_ARRAY,r,v,t.width,t.height,f.depth,0,m,g,t.data)}else{w&&A&&i.texStorage2D(e.TEXTURE_2D,M,v,y[0].width,y[0].height);for(let r=0,a=y.length;r<a;r++)t=y[r],n.format!==eB?null!==m?w?i.compressedTexSubImage2D(e.TEXTURE_2D,r,0,0,t.width,t.height,m,t.data):i.compressedTexImage2D(e.TEXTURE_2D,r,v,t.width,t.height,0,t.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):w?i.texSubImage2D(e.TEXTURE_2D,r,0,0,t.width,t.height,m,g,t.data):i.texImage2D(e.TEXTURE_2D,r,v,t.width,t.height,0,m,g,t.data)}}else if(n.isDataArrayTexture)w?(A&&i.texStorage3D(e.TEXTURE_2D_ARRAY,M,v,f.width,f.height,f.depth),i.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,f.width,f.height,f.depth,m,g,f.data)):i.texImage3D(e.TEXTURE_2D_ARRAY,0,v,f.width,f.height,f.depth,0,m,g,f.data);else if(n.isData3DTexture)w?(A&&i.texStorage3D(e.TEXTURE_3D,M,v,f.width,f.height,f.depth),i.texSubImage3D(e.TEXTURE_3D,0,0,0,0,f.width,f.height,f.depth,m,g,f.data)):i.texImage3D(e.TEXTURE_3D,0,v,f.width,f.height,f.depth,0,m,g,f.data);else if(n.isFramebufferTexture){if(A){if(w)i.texStorage2D(e.TEXTURE_2D,M,v,f.width,f.height);else{let t=f.width,r=f.height;for(let n=0;n<M;n++)i.texImage2D(e.TEXTURE_2D,n,v,t,r,0,m,g,null),t>>=1,r>>=1}}}else if(y.length>0&&p){w&&A&&i.texStorage2D(e.TEXTURE_2D,M,v,y[0].width,y[0].height);for(let r=0,n=y.length;r<n;r++)t=y[r],w?i.texSubImage2D(e.TEXTURE_2D,r,0,0,m,g,t):i.texImage2D(e.TEXTURE_2D,r,v,m,g,t);n.generateMipmaps=!1}else w?(A&&i.texStorage2D(e.TEXTURE_2D,M,v,f.width,f.height),i.texSubImage2D(e.TEXTURE_2D,0,0,0,m,g,f)):i.texImage2D(e.TEXTURE_2D,0,v,m,g,f);E(n,p)&&S(o),h.__version=c.version,n.onUpdate&&n.onUpdate(n)}t.__version=n.version}function U(t,n,s,o,l,u){let c=a.convert(s.format,s.colorSpace),d=a.convert(s.type),h=x(s.internalFormat,c,d,s.colorSpace),p=r.get(n);if(!p.__hasExternalTextures){let t=Math.max(1,n.width>>u),r=Math.max(1,n.height>>u);l===e.TEXTURE_3D||l===e.TEXTURE_2D_ARRAY?i.texImage3D(l,u,h,t,r,n.depth,0,c,d,null):i.texImage2D(l,u,h,t,r,0,c,d,null)}i.bindFramebuffer(e.FRAMEBUFFER,t),z(n)?f.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,o,l,r.get(s).__webglTexture,0,V(n)):(l===e.TEXTURE_2D||l>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&l<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,o,l,r.get(s).__webglTexture,u),i.bindFramebuffer(e.FRAMEBUFFER,null)}function F(t,i,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),i.depthBuffer&&!i.stencilBuffer){let n=e.DEPTH_COMPONENT16;if(r||z(i)){let t=i.depthTexture;t&&t.isDepthTexture&&(t.type===eD?n=e.DEPTH_COMPONENT32F:t.type===ek&&(n=e.DEPTH_COMPONENT24));let r=V(i);z(i)?f.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,r,n,i.width,i.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,r,n,i.width,i.height)}else e.renderbufferStorage(e.RENDERBUFFER,n,i.width,i.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(i.depthBuffer&&i.stencilBuffer){let n=V(i);r&&!1===z(i)?e.renderbufferStorageMultisample(e.RENDERBUFFER,n,e.DEPTH24_STENCIL8,i.width,i.height):z(i)?f.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,n,e.DEPTH24_STENCIL8,i.width,i.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,i.width,i.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else{let t=!0===i.isWebGLMultipleRenderTargets?i.texture:[i.texture];for(let n=0;n<t.length;n++){let s=t[n],o=a.convert(s.format,s.colorSpace),l=a.convert(s.type),u=x(s.internalFormat,o,l,s.colorSpace),c=V(i);r&&!1===z(i)?e.renderbufferStorageMultisample(e.RENDERBUFFER,c,u,i.width,i.height):z(i)?f.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,c,u,i.width,i.height):e.renderbufferStorage(e.RENDERBUFFER,u,i.width,i.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function B(t){let n=r.get(t),a=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!n.__autoAllocateDepthBuffer){if(a)throw Error("target.depthTexture not supported in Cube render targets");!function(t,n){let a=n&&n.isWebGLCubeRenderTarget;if(a)throw Error("Depth Texture with cube render targets is not supported");if(i.bindFramebuffer(e.FRAMEBUFFER,t),!(n.depthTexture&&n.depthTexture.isDepthTexture))throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),I(n.depthTexture,0);let s=r.get(n.depthTexture).__webglTexture,o=V(n);if(n.depthTexture.format===ej)z(n)?f.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,s,0);else if(n.depthTexture.format===eH)z(n)?f.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,s,0);else throw Error("Unknown depthTexture format")}(n.__webglFramebuffer,t)}else if(a){n.__webglDepthbuffer=[];for(let r=0;r<6;r++)i.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer[r]),n.__webglDepthbuffer[r]=e.createRenderbuffer(),F(n.__webglDepthbuffer[r],t,!1)}else i.bindFramebuffer(e.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=e.createRenderbuffer(),F(n.__webglDepthbuffer,t,!1);i.bindFramebuffer(e.FRAMEBUFFER,null)}function V(e){return Math.min(h,e.samples)}function z(e){let i=r.get(e);return l&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==i.__useRenderToTexture}function j(e,i){let r=e.colorSpace,n=e.format,a=e.type;return!0===e.isCompressedTexture||!0===e.isVideoTexture||e.format===im||r!==tB&&r!==tU&&(r===tF||r===tV?!1===l?!0===t.has("EXT_sRGB")&&n===eB?(e.format=im,e.minFilter=eS,e.generateMipmaps=!1):i=iX.sRGBToLinear(i):(n!==eB||a!==eM)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",r)),i}this.allocateTextureUnit=function(){let e=C;return e>=u&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+u),C+=1,e},this.resetTextureUnits=function(){C=0},this.setTexture2D=I,this.setTexture2DArray=function(t,n){let a=r.get(t);if(t.version>0&&a.__version!==t.version){N(a,t,n);return}i.bindTexture(e.TEXTURE_2D_ARRAY,a.__webglTexture,e.TEXTURE0+n)},this.setTexture3D=function(t,n){let a=r.get(t);if(t.version>0&&a.__version!==t.version){N(a,t,n);return}i.bindTexture(e.TEXTURE_3D,a.__webglTexture,e.TEXTURE0+n)},this.setTextureCube=function(t,n){let s=r.get(t);if(t.version>0&&s.__version!==t.version){(function(t,n,s){if(6!==n.image.length)return;let o=O(t,n),u=n.source;i.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+s);let d=r.get(u);if(u.version!==d.__version||!0===o){let t;i.activeTexture(e.TEXTURE0+s),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,n.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,n.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);let r=n.isCompressedTexture||n.image[0].isCompressedTexture,h=n.image[0]&&n.image[0].isDataTexture,f=[];for(let e=0;e<6;e++)r||h?f[e]=h?n.image[e].image:n.image[e]:f[e]=b(n.image[e],!1,!0,c),f[e]=j(n,f[e]);let p=f[0],m=_(p)||l,g=a.convert(n.format,n.colorSpace),v=a.convert(n.type),y=x(n.internalFormat,g,v,n.colorSpace),w=l&&!0!==n.isVideoTexture,A=void 0===d.__version||!0===o,M=T(n,p,m);if(P(e.TEXTURE_CUBE_MAP,n,m),r){w&&A&&i.texStorage2D(e.TEXTURE_CUBE_MAP,M,y,p.width,p.height);for(let r=0;r<6;r++){t=f[r].mipmaps;for(let a=0;a<t.length;a++){let s=t[a];n.format!==eB?null!==g?w?i.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,a,0,0,s.width,s.height,g,s.data):i.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,a,y,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):w?i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,a,0,0,s.width,s.height,g,v,s.data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,a,y,s.width,s.height,0,g,v,s.data)}}}else{t=n.mipmaps,w&&A&&(t.length>0&&M++,i.texStorage2D(e.TEXTURE_CUBE_MAP,M,y,f[0].width,f[0].height));for(let r=0;r<6;r++)if(h){w?i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,0,0,f[r].width,f[r].height,g,v,f[r].data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,y,f[r].width,f[r].height,0,g,v,f[r].data);for(let n=0;n<t.length;n++){let a=t[n],s=a.image[r].image;w?i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,n+1,0,0,s.width,s.height,g,v,s.data):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,n+1,y,s.width,s.height,0,g,v,s.data)}}else{w?i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,0,0,g,v,f[r]):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,y,g,v,f[r]);for(let n=0;n<t.length;n++){let a=t[n];w?i.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,n+1,0,0,g,v,a.image[r]):i.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+r,n+1,y,g,v,a.image[r])}}}E(n,m)&&S(e.TEXTURE_CUBE_MAP),d.__version=u.version,n.onUpdate&&n.onUpdate(n)}t.__version=n.version})(s,t,n);return}i.bindTexture(e.TEXTURE_CUBE_MAP,s.__webglTexture,e.TEXTURE0+n)},this.rebindTextures=function(t,i,n){let a=r.get(t);void 0!==i&&U(a.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==n&&B(t)},this.setupRenderTarget=function(t){let o=t.texture,u=r.get(t),c=r.get(o);t.addEventListener("dispose",M),!0!==t.isWebGLMultipleRenderTargets&&(void 0===c.__webglTexture&&(c.__webglTexture=e.createTexture()),c.__version=o.version,s.memory.textures++);let d=!0===t.isWebGLCubeRenderTarget,h=!0===t.isWebGLMultipleRenderTargets,f=_(t)||l;if(d){u.__webglFramebuffer=[];for(let t=0;t<6;t++)if(l&&o.mipmaps&&o.mipmaps.length>0){u.__webglFramebuffer[t]=[];for(let i=0;i<o.mipmaps.length;i++)u.__webglFramebuffer[t][i]=e.createFramebuffer()}else u.__webglFramebuffer[t]=e.createFramebuffer()}else{if(l&&o.mipmaps&&o.mipmaps.length>0){u.__webglFramebuffer=[];for(let t=0;t<o.mipmaps.length;t++)u.__webglFramebuffer[t]=e.createFramebuffer()}else u.__webglFramebuffer=e.createFramebuffer();if(h){if(n.drawBuffers){let i=t.texture;for(let t=0,n=i.length;t<n;t++){let n=r.get(i[t]);void 0===n.__webglTexture&&(n.__webglTexture=e.createTexture(),s.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.")}if(l&&t.samples>0&&!1===z(t)){let r=h?o:[o];u.__webglMultisampledFramebuffer=e.createFramebuffer(),u.__webglColorRenderbuffer=[],i.bindFramebuffer(e.FRAMEBUFFER,u.__webglMultisampledFramebuffer);for(let i=0;i<r.length;i++){let n=r[i];u.__webglColorRenderbuffer[i]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,u.__webglColorRenderbuffer[i]);let s=a.convert(n.format,n.colorSpace),o=a.convert(n.type),l=x(n.internalFormat,s,o,n.colorSpace,!0===t.isXRRenderTarget),c=V(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,c,l,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+i,e.RENDERBUFFER,u.__webglColorRenderbuffer[i])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(u.__webglDepthRenderbuffer=e.createRenderbuffer(),F(u.__webglDepthRenderbuffer,t,!0)),i.bindFramebuffer(e.FRAMEBUFFER,null)}}if(d){i.bindTexture(e.TEXTURE_CUBE_MAP,c.__webglTexture),P(e.TEXTURE_CUBE_MAP,o,f);for(let i=0;i<6;i++)if(l&&o.mipmaps&&o.mipmaps.length>0)for(let r=0;r<o.mipmaps.length;r++)U(u.__webglFramebuffer[i][r],t,o,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+i,r);else U(u.__webglFramebuffer[i],t,o,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+i,0);E(o,f)&&S(e.TEXTURE_CUBE_MAP),i.unbindTexture()}else if(h){let n=t.texture;for(let a=0,s=n.length;a<s;a++){let s=n[a],o=r.get(s);i.bindTexture(e.TEXTURE_2D,o.__webglTexture),P(e.TEXTURE_2D,s,f),U(u.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0+a,e.TEXTURE_2D,0),E(s,f)&&S(e.TEXTURE_2D)}i.unbindTexture()}else{let r=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l?r=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),i.bindTexture(r,c.__webglTexture),P(r,o,f),l&&o.mipmaps&&o.mipmaps.length>0)for(let i=0;i<o.mipmaps.length;i++)U(u.__webglFramebuffer[i],t,o,e.COLOR_ATTACHMENT0,r,i);else U(u.__webglFramebuffer,t,o,e.COLOR_ATTACHMENT0,r,0);E(o,f)&&S(r),i.unbindTexture()}t.depthBuffer&&B(t)},this.updateRenderTargetMipmap=function(t){let n=_(t)||l,a=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture];for(let s=0,o=a.length;s<o;s++){let o=a[s];if(E(o,n)){let n=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,a=r.get(o).__webglTexture;i.bindTexture(n,a),S(n),i.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(l&&t.samples>0&&!1===z(t)){let n=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],a=t.width,s=t.height,o=e.COLOR_BUFFER_BIT,l=[],u=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,c=r.get(t),d=!0===t.isWebGLMultipleRenderTargets;if(d)for(let t=0;t<n.length;t++)i.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,null),i.bindFramebuffer(e.FRAMEBUFFER,c.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,null,0);i.bindFramebuffer(e.READ_FRAMEBUFFER,c.__webglMultisampledFramebuffer),i.bindFramebuffer(e.DRAW_FRAMEBUFFER,c.__webglFramebuffer);for(let i=0;i<n.length;i++){l.push(e.COLOR_ATTACHMENT0+i),t.depthBuffer&&l.push(u);let h=void 0!==c.__ignoreDepthValues&&c.__ignoreDepthValues;if(!1===h&&(t.depthBuffer&&(o|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(o|=e.STENCIL_BUFFER_BIT)),d&&e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,c.__webglColorRenderbuffer[i]),!0===h&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[u]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[u])),d){let t=r.get(n[i]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}e.blitFramebuffer(0,0,a,s,0,0,a,s,o,e.NEAREST),p&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,l)}if(i.bindFramebuffer(e.READ_FRAMEBUFFER,null),i.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),d)for(let t=0;t<n.length;t++){i.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.RENDERBUFFER,c.__webglColorRenderbuffer[t]);let a=r.get(n[t]).__webglTexture;i.bindFramebuffer(e.FRAMEBUFFER,c.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+t,e.TEXTURE_2D,a,0)}i.bindFramebuffer(e.DRAW_FRAMEBUFFER,c.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=B,this.setupFrameBufferTexture=U,this.useMultisampledRTT=z}function oh(e,t,i){let r=i.isWebGL2;return{convert:function(i,n=tU){let a;let s=n===tF||n===tV?1:0;if(i===eM)return e.UNSIGNED_BYTE;if(i===eO)return e.UNSIGNED_SHORT_4_4_4_4;if(i===eN)return e.UNSIGNED_SHORT_5_5_5_1;if(i===eR)return e.BYTE;if(i===eC)return e.SHORT;if(i===eI)return e.UNSIGNED_SHORT;if(i===eL)return e.INT;if(i===ek)return e.UNSIGNED_INT;if(i===eD)return e.FLOAT;if(i===eP)return r?e.HALF_FLOAT:null!==(a=t.get("OES_texture_half_float"))?a.HALF_FLOAT_OES:null;if(i===eF)return e.ALPHA;if(i===eB)return e.RGBA;if(i===eV)return e.LUMINANCE;if(i===ez)return e.LUMINANCE_ALPHA;if(i===ej)return e.DEPTH_COMPONENT;if(i===eH)return e.DEPTH_STENCIL;if(i===im)return null!==(a=t.get("EXT_sRGB"))?a.SRGB_ALPHA_EXT:null;if(i===eG)return e.RED;if(i===eW)return e.RED_INTEGER;if(i===e$)return e.RG;if(i===eq)return e.RG_INTEGER;if(i===eY)return e.RGBA_INTEGER;if(i===eK||i===eX||i===eZ||i===eJ){if(1===s){if(null===(a=t.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(i===eK)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(i===eX)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(i===eZ)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(i===eJ)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(a=t.get("WEBGL_compressed_texture_s3tc")))return null;if(i===eK)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===eX)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===eZ)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===eJ)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}}if(i===eQ||i===e0||i===e1||i===e2){if(null===(a=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(i===eQ)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===e0)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===e1)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===e2)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(i===e3)return null!==(a=t.get("WEBGL_compressed_texture_etc1"))?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(i===e5||i===e4){if(null===(a=t.get("WEBGL_compressed_texture_etc")))return null;if(i===e5)return 1===s?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(i===e4)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(i===e6||i===e8||i===e7||i===e9||i===te||i===tt||i===ti||i===tr||i===tn||i===ta||i===ts||i===to||i===tl||i===tu){if(null===(a=t.get("WEBGL_compressed_texture_astc")))return null;if(i===e6)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(i===e8)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(i===e7)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(i===e9)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(i===te)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(i===tt)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(i===ti)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(i===tr)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(i===tn)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(i===ta)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(i===ts)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(i===to)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(i===tl)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(i===tu)return 1===s?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(i===tc||i===td||i===th){if(null===(a=t.get("EXT_texture_compression_bptc")))return null;if(i===tc)return 1===s?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(i===td)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(i===th)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}if(i===tf||i===tp||i===tm||i===tg){if(null===(a=t.get("EXT_texture_compression_rgtc")))return null;if(i===tc)return a.COMPRESSED_RED_RGTC1_EXT;if(i===tp)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(i===tm)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(i===tg)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return i===eU?r?e.UNSIGNED_INT_24_8:null!==(a=t.get("WEBGL_depth_texture"))?a.UNSIGNED_INT_24_8_WEBGL:null:void 0!==e[i]?e[i]:null}}}class of extends at{constructor(e=[]){super(),this.isArrayCamera=!0,this.cameras=e}}class op extends r2{constructor(){super(),this.isGroup=!0,this.type="Group"}}let om={type:"move"};class og{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new op,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new op,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new rt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new rt),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new op,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new rt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new rt),this._grip}dispatchEvent(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){let t=this._hand;if(t)for(let i of e.hand.values())this._getHandJoint(t,i)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(e,t,i){let r=null,n=null,a=null,s=this._targetRay,o=this._grip,l=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(l&&e.hand){for(let r of(a=!0,e.hand.values())){let e=t.getJointPose(r,i),n=this._getHandJoint(l,r);null!==e&&(n.matrix.fromArray(e.transform.matrix),n.matrix.decompose(n.position,n.rotation,n.scale),n.matrixWorldNeedsUpdate=!0,n.jointRadius=e.radius),n.visible=null!==e}let r=l.joints["index-finger-tip"],n=l.joints["thumb-tip"],s=r.position.distanceTo(n.position);l.inputState.pinching&&s>.025?(l.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!l.inputState.pinching&&s<=.015&&(l.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==o&&e.gripSpace&&null!==(n=t.getPose(e.gripSpace,i))&&(o.matrix.fromArray(n.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,n.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(n.linearVelocity)):o.hasLinearVelocity=!1,n.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(n.angularVelocity)):o.hasAngularVelocity=!1);null!==s&&(null===(r=t.getPose(e.targetRaySpace,i))&&null!==n&&(r=n),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(om)))}return null!==s&&(s.visible=null!==r),null!==o&&(o.visible=null!==n),null!==l&&(l.visible=null!==a),this}_getHandJoint(e,t){if(void 0===e.joints[t.jointName]){let i=new op;i.matrixAutoUpdate=!1,i.visible=!1,e.joints[t.jointName]=i,e.add(i)}return e.joints[t.jointName]}}class ov extends i1{constructor(e,t,i,r,n,a,s,o,l,u){if((u=void 0!==u?u:ej)!==ej&&u!==eH)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&u===ej&&(i=ek),void 0===i&&u===eH&&(i=eU),super(null,r,n,a,s,o,u,i,l),this.isDepthTexture=!0,this.image={width:e,height:t},this.magFilter=void 0!==s?s:ev,this.minFilter=void 0!==o?o:ev,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.compareFunction=e.compareFunction,this}toJSON(e){let t=super.toJSON(e);return null!==this.compareFunction&&(t.compareFunction=this.compareFunction),t}}class oy extends iy{constructor(e,t){super();let i=this,r=null,n=1,a=null,s="local-floor",o=1,l=null,u=null,c=null,d=null,h=null,f=null,p=t.getContextAttributes(),m=null,g=null,v=[],y=[],b=new at;b.layers.enable(1),b.viewport=new i2;let _=new at;_.layers.enable(2),_.viewport=new i2;let E=[b,_],S=new of;S.layers.enable(1),S.layers.enable(2);let x=null,T=null;function w(e){let t=y.indexOf(e.inputSource);if(-1===t)return;let i=v[t];void 0!==i&&(i.update(e.inputSource,e.frame,l||a),i.dispatchEvent({type:e.type,data:e.inputSource}))}function A(){r.removeEventListener("select",w),r.removeEventListener("selectstart",w),r.removeEventListener("selectend",w),r.removeEventListener("squeeze",w),r.removeEventListener("squeezestart",w),r.removeEventListener("squeezeend",w),r.removeEventListener("end",A),r.removeEventListener("inputsourceschange",M);for(let e=0;e<v.length;e++){let t=y[e];null!==t&&(y[e]=null,v[e].disconnect(t))}x=null,T=null,e.setRenderTarget(m),h=null,d=null,c=null,r=null,g=null,k.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}function M(e){for(let t=0;t<e.removed.length;t++){let i=e.removed[t],r=y.indexOf(i);r>=0&&(y[r]=null,v[r].disconnect(i))}for(let t=0;t<e.added.length;t++){let i=e.added[t],r=y.indexOf(i);if(-1===r){for(let e=0;e<v.length;e++){if(e>=y.length){y.push(i),r=e;break}if(null===y[e]){y[e]=i,r=e;break}}if(-1===r)break}let n=v[r];n&&n.connect(i)}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(e){let t=v[e];return void 0===t&&(t=new og,v[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){let t=v[e];return void 0===t&&(t=new og,v[e]=t),t.getGripSpace()},this.getHand=function(e){let t=v[e];return void 0===t&&(t=new og,v[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){n=e,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){s=e,!0===i.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return l||a},this.setReferenceSpace=function(e){l=e},this.getBaseLayer=function(){return null!==d?d:h},this.getBinding=function(){return c},this.getFrame=function(){return f},this.getSession=function(){return r},this.setSession=async function(u){if(null!==(r=u)){if(m=e.getRenderTarget(),r.addEventListener("select",w),r.addEventListener("selectstart",w),r.addEventListener("selectend",w),r.addEventListener("squeeze",w),r.addEventListener("squeezestart",w),r.addEventListener("squeezeend",w),r.addEventListener("end",A),r.addEventListener("inputsourceschange",M),!0!==p.xrCompatible&&await t.makeXRCompatible(),void 0===r.renderState.layers||!1===e.capabilities.isWebGL2){let i={antialias:void 0!==r.renderState.layers||p.antialias,alpha:!0,depth:p.depth,stencil:p.stencil,framebufferScaleFactor:n};h=new XRWebGLLayer(r,t,i),r.updateRenderState({baseLayer:h}),g=new i5(h.framebufferWidth,h.framebufferHeight,{format:eB,type:eM,colorSpace:e.outputColorSpace,stencilBuffer:p.stencil})}else{let i=null,a=null,s=null;p.depth&&(s=p.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,i=p.stencil?eH:ej,a=p.stencil?eU:ek);let o={colorFormat:t.RGBA8,depthFormat:s,scaleFactor:n};d=(c=new XRWebGLBinding(r,t)).createProjectionLayer(o),r.updateRenderState({layers:[d]}),g=new i5(d.textureWidth,d.textureHeight,{format:eB,type:eM,depthTexture:new ov(d.textureWidth,d.textureHeight,a,void 0,void 0,void 0,void 0,void 0,void 0,i),stencilBuffer:p.stencil,colorSpace:e.outputColorSpace,samples:p.antialias?4:0});let l=e.properties.get(g);l.__ignoreDepthValues=d.ignoreDepthValues}g.isXRRenderTarget=!0,this.setFoveation(o),l=null,a=await r.requestReferenceSpace(s),k.setContext(r),k.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(null!==r)return r.environmentBlendMode};let R=new rt,C=new rt;function I(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.updateCamera=function(e){if(null===r)return;S.near=_.near=b.near=e.near,S.far=_.far=b.far=e.far,(x!==S.near||T!==S.far)&&(r.updateRenderState({depthNear:S.near,depthFar:S.far}),x=S.near,T=S.far);let t=e.parent,i=S.cameras;I(S,t);for(let e=0;e<i.length;e++)I(i[e],t);2===i.length?function(e,t,i){R.setFromMatrixPosition(t.matrixWorld),C.setFromMatrixPosition(i.matrixWorld);let r=R.distanceTo(C),n=t.projectionMatrix.elements,a=i.projectionMatrix.elements,s=n[14]/(n[10]-1),o=n[14]/(n[10]+1),l=(n[9]+1)/n[5],u=(n[9]-1)/n[5],c=(n[8]-1)/n[0],d=(a[8]+1)/a[0],h=r/(-c+d),f=-(h*c);t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(f),e.translateZ(h),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();let p=s+h,m=o+h,g=s*c-f,v=s*d+(r-f),y=l*o/m*p,b=u*o/m*p;e.projectionMatrix.makePerspective(g,v,y,b,p,m),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}(S,b,_):S.projectionMatrix.copy(b.projectionMatrix),null===t?e.matrix.copy(S.matrixWorld):(e.matrix.copy(t.matrixWorld),e.matrix.invert(),e.matrix.multiply(S.matrixWorld)),e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0),e.projectionMatrix.copy(S.projectionMatrix),e.projectionMatrixInverse.copy(S.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*iS*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)},this.getCamera=function(){return S},this.getFoveation=function(){if(null!==d||null!==h)return o},this.setFoveation=function(e){o=e,null!==d&&(d.fixedFoveation=e),null!==h&&void 0!==h.fixedFoveation&&(h.fixedFoveation=e)};let L=null,k=new ah;k.setAnimationLoop(function(t,r){if(u=r.getViewerPose(l||a),f=r,null!==u){let t=u.views;null!==h&&(e.setRenderTargetFramebuffer(g,h.framebuffer),e.setRenderTarget(g));let i=!1;t.length!==S.cameras.length&&(S.cameras.length=0,i=!0);for(let r=0;r<t.length;r++){let n=t[r],a=null;if(null!==h)a=h.getViewport(n);else{let t=c.getViewSubImage(d,n);a=t.viewport,0===r&&(e.setRenderTargetTextures(g,t.colorTexture,d.ignoreDepthValues?void 0:t.depthStencilTexture),e.setRenderTarget(g))}let s=E[r];void 0===s&&((s=new at).layers.enable(r),s.viewport=new i2,E[r]=s),s.matrix.fromArray(n.transform.matrix),s.matrix.decompose(s.position,s.quaternion,s.scale),s.projectionMatrix.fromArray(n.projectionMatrix),s.projectionMatrixInverse.copy(s.projectionMatrix).invert(),s.viewport.set(a.x,a.y,a.width,a.height),0===r&&(S.matrix.copy(s.matrix),S.matrix.decompose(S.position,S.quaternion,S.scale)),!0===i&&S.cameras.push(s)}}for(let e=0;e<v.length;e++){let t=y[e],i=v[e];null!==t&&void 0!==i&&i.update(t,r,l||a)}L&&L(t,r),r.detectedPlanes&&i.dispatchEvent({type:"planesdetected",data:r}),f=null}),this.setAnimationLoop=function(e){L=e},this.dispose=function(){}}}function ob(e,t){function i(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(r,n){r.opacity.value=n.opacity,n.color&&r.diffuse.value.copy(n.color),n.emissive&&r.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(r.map.value=n.map,i(n.map,r.mapTransform)),n.alphaMap&&(r.alphaMap.value=n.alphaMap,i(n.alphaMap,r.alphaMapTransform)),n.bumpMap&&(r.bumpMap.value=n.bumpMap,i(n.bumpMap,r.bumpMapTransform),r.bumpScale.value=n.bumpScale,n.side===_&&(r.bumpScale.value*=-1)),n.normalMap&&(r.normalMap.value=n.normalMap,i(n.normalMap,r.normalMapTransform),r.normalScale.value.copy(n.normalScale),n.side===_&&r.normalScale.value.negate()),n.displacementMap&&(r.displacementMap.value=n.displacementMap,i(n.displacementMap,r.displacementMapTransform),r.displacementScale.value=n.displacementScale,r.displacementBias.value=n.displacementBias),n.emissiveMap&&(r.emissiveMap.value=n.emissiveMap,i(n.emissiveMap,r.emissiveMapTransform)),n.specularMap&&(r.specularMap.value=n.specularMap,i(n.specularMap,r.specularMapTransform)),n.alphaTest>0&&(r.alphaTest.value=n.alphaTest);let a=t.get(n).envMap;if(a&&(r.envMap.value=a,r.flipEnvMap.value=a.isCubeTexture&&!1===a.isRenderTargetTexture?-1:1,r.reflectivity.value=n.reflectivity,r.ior.value=n.ior,r.refractionRatio.value=n.refractionRatio),n.lightMap){r.lightMap.value=n.lightMap;let t=!0===e._useLegacyLights?Math.PI:1;r.lightMapIntensity.value=n.lightMapIntensity*t,i(n.lightMap,r.lightMapTransform)}n.aoMap&&(r.aoMap.value=n.aoMap,r.aoMapIntensity.value=n.aoMapIntensity,i(n.aoMap,r.aoMapTransform))}return{refreshFogUniforms:function(t,i){i.color.getRGB(t.fogColor.value,n8(e)),i.isFog?(t.fogNear.value=i.near,t.fogFar.value=i.far):i.isFogExp2&&(t.fogDensity.value=i.density)},refreshMaterialUniforms:function(e,n,a,s,o){n.isMeshBasicMaterial?r(e,n):n.isMeshLambertMaterial?r(e,n):n.isMeshToonMaterial?(r(e,n),n.gradientMap&&(e.gradientMap.value=n.gradientMap)):n.isMeshPhongMaterial?(r(e,n),e.specular.value.copy(n.specular),e.shininess.value=Math.max(n.shininess,1e-4)):n.isMeshStandardMaterial?(r(e,n),function(e,r){e.metalness.value=r.metalness,r.metalnessMap&&(e.metalnessMap.value=r.metalnessMap,i(r.metalnessMap,e.metalnessMapTransform)),e.roughness.value=r.roughness,r.roughnessMap&&(e.roughnessMap.value=r.roughnessMap,i(r.roughnessMap,e.roughnessMapTransform));let n=t.get(r).envMap;n&&(e.envMapIntensity.value=r.envMapIntensity)}(e,n),n.isMeshPhysicalMaterial&&(e.ior.value=n.ior,n.sheen>0&&(e.sheenColor.value.copy(n.sheenColor).multiplyScalar(n.sheen),e.sheenRoughness.value=n.sheenRoughness,n.sheenColorMap&&(e.sheenColorMap.value=n.sheenColorMap,i(n.sheenColorMap,e.sheenColorMapTransform)),n.sheenRoughnessMap&&(e.sheenRoughnessMap.value=n.sheenRoughnessMap,i(n.sheenRoughnessMap,e.sheenRoughnessMapTransform))),n.clearcoat>0&&(e.clearcoat.value=n.clearcoat,e.clearcoatRoughness.value=n.clearcoatRoughness,n.clearcoatMap&&(e.clearcoatMap.value=n.clearcoatMap,i(n.clearcoatMap,e.clearcoatMapTransform)),n.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=n.clearcoatRoughnessMap,i(n.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),n.clearcoatNormalMap&&(e.clearcoatNormalMap.value=n.clearcoatNormalMap,i(n.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(n.clearcoatNormalScale),n.side===_&&e.clearcoatNormalScale.value.negate())),n.iridescence>0&&(e.iridescence.value=n.iridescence,e.iridescenceIOR.value=n.iridescenceIOR,e.iridescenceThicknessMinimum.value=n.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=n.iridescenceThicknessRange[1],n.iridescenceMap&&(e.iridescenceMap.value=n.iridescenceMap,i(n.iridescenceMap,e.iridescenceMapTransform)),n.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=n.iridescenceThicknessMap,i(n.iridescenceThicknessMap,e.iridescenceThicknessMapTransform))),n.transmission>0&&(e.transmission.value=n.transmission,e.transmissionSamplerMap.value=o.texture,e.transmissionSamplerSize.value.set(o.width,o.height),n.transmissionMap&&(e.transmissionMap.value=n.transmissionMap,i(n.transmissionMap,e.transmissionMapTransform)),e.thickness.value=n.thickness,n.thicknessMap&&(e.thicknessMap.value=n.thicknessMap,i(n.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=n.attenuationDistance,e.attenuationColor.value.copy(n.attenuationColor)),n.anisotropy>0&&(e.anisotropyVector.value.set(n.anisotropy*Math.cos(n.anisotropyRotation),n.anisotropy*Math.sin(n.anisotropyRotation)),n.anisotropyMap&&(e.anisotropyMap.value=n.anisotropyMap,i(n.anisotropyMap,e.anisotropyMapTransform))),e.specularIntensity.value=n.specularIntensity,e.specularColor.value.copy(n.specularColor),n.specularColorMap&&(e.specularColorMap.value=n.specularColorMap,i(n.specularColorMap,e.specularColorMapTransform)),n.specularIntensityMap&&(e.specularIntensityMap.value=n.specularIntensityMap,i(n.specularIntensityMap,e.specularIntensityMapTransform)))):n.isMeshMatcapMaterial?(r(e,n),n.matcap&&(e.matcap.value=n.matcap)):n.isMeshDepthMaterial?r(e,n):n.isMeshDistanceMaterial?(r(e,n),function(e,i){let r=t.get(i).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,n)):n.isMeshNormalMaterial?r(e,n):n.isLineBasicMaterial?(e.diffuse.value.copy(n.color),e.opacity.value=n.opacity,n.map&&(e.map.value=n.map,i(n.map,e.mapTransform)),n.isLineDashedMaterial&&(e.dashSize.value=n.dashSize,e.totalSize.value=n.dashSize+n.gapSize,e.scale.value=n.scale)):n.isPointsMaterial?(e.diffuse.value.copy(n.color),e.opacity.value=n.opacity,e.size.value=n.size*a,e.scale.value=.5*s,n.map&&(e.map.value=n.map,i(n.map,e.uvTransform)),n.alphaMap&&(e.alphaMap.value=n.alphaMap,i(n.alphaMap,e.alphaMapTransform)),n.alphaTest>0&&(e.alphaTest.value=n.alphaTest)):n.isSpriteMaterial?(e.diffuse.value.copy(n.color),e.opacity.value=n.opacity,e.rotation.value=n.rotation,n.map&&(e.map.value=n.map,i(n.map,e.mapTransform)),n.alphaMap&&(e.alphaMap.value=n.alphaMap,i(n.alphaMap,e.alphaMapTransform)),n.alphaTest>0&&(e.alphaTest.value=n.alphaTest)):n.isShadowMaterial?(e.color.value.copy(n.color),e.opacity.value=n.opacity):n.isShaderMaterial&&(n.uniformsNeedUpdate=!1)}}}function o_(e,t,i,r){let n={},a={},s=[],o=i.isWebGL2?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(e){let t={boundary:0,storage:0};return"number"==typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){let i=t.target;i.removeEventListener("dispose",u);let r=s.indexOf(i.__bindingPointIndex);s.splice(r,1),e.deleteBuffer(n[i.id]),delete n[i.id],delete a[i.id]}return{bind:function(e,t){let i=t.program;r.uniformBlockBinding(e,i)},update:function(i,c){let d=n[i.id];void 0===d&&(function(e){let t=e.uniforms,i=0,r=0;for(let e=0,n=t.length;e<n;e++){let n=t[e],a={boundary:0,storage:0},s=Array.isArray(n.value)?n.value:[n.value];for(let e=0,t=s.length;e<t;e++){let t=s[e],i=l(t);a.boundary+=i.boundary,a.storage+=i.storage}if(n.__data=new Float32Array(a.storage/Float32Array.BYTES_PER_ELEMENT),n.__offset=i,e>0){r=i%16;let e=16-r;0!==r&&e-a.boundary<0&&(i+=16-r,n.__offset=i)}i+=a.storage}(r=i%16)>0&&(i+=16-r),e.__size=i,e.__cache={}}(i),d=function(t){let i=function(){for(let e=0;e<o;e++)if(-1===s.indexOf(e))return s.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=i;let r=e.createBuffer(),n=t.__size,a=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,n,a),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,i,r),r}(i),n[i.id]=d,i.addEventListener("dispose",u));let h=c.program;r.updateUBOMapping(i,h);let f=t.render.frame;a[i.id]!==f&&(function(t){let i=n[t.id],r=t.uniforms,a=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,i);for(let t=0,i=r.length;t<i;t++){let i=r[t];if(!0===function(e,t,i){let r=e.value;if(void 0===i[t]){if("number"==typeof r)i[t]=r;else{let e=Array.isArray(r)?r:[r],n=[];for(let t=0;t<e.length;t++)n.push(e[t].clone());i[t]=n}return!0}if("number"==typeof r){if(i[t]!==r)return i[t]=r,!0}else{let e=Array.isArray(i[t])?i[t]:[i[t]],n=Array.isArray(r)?r:[r];for(let t=0;t<e.length;t++){let i=e[t];if(!1===i.equals(n[t]))return i.copy(n[t]),!0}}return!1}(i,t,a)){let t=i.__offset,r=Array.isArray(i.value)?i.value:[i.value],n=0;for(let a=0;a<r.length;a++){let s=r[a],o=l(s);"number"==typeof s?(i.__data[0]=s,e.bufferSubData(e.UNIFORM_BUFFER,t+n,i.__data)):s.isMatrix3?(i.__data[0]=s.elements[0],i.__data[1]=s.elements[1],i.__data[2]=s.elements[2],i.__data[3]=s.elements[0],i.__data[4]=s.elements[3],i.__data[5]=s.elements[4],i.__data[6]=s.elements[5],i.__data[7]=s.elements[0],i.__data[8]=s.elements[6],i.__data[9]=s.elements[7],i.__data[10]=s.elements[8],i.__data[11]=s.elements[0]):(s.toArray(i.__data,n),n+=o.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,t,i.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(i),a[i.id]=f)},dispose:function(){for(let t in n)e.deleteBuffer(n[t]);s=[],n={},a={}}}}class oE{constructor(e={}){let t,i,r,n,a,s,o,u,c,d,h,f,p,m,g,v,y,S,x,T,w,A,M,R,C;let{canvas:I=iV(),context:L=null,depth:k=!0,stencil:D=!0,alpha:P=!1,antialias:O=!1,premultipliedAlpha:N=!0,preserveDrawingBuffer:U=!1,powerPreference:F="default",failIfMajorPerformanceCaveat:B=!1}=e;this.isWebGLRenderer=!0,t=null!==L?L.getContextAttributes().alpha:P;let V=new Uint32Array(4),z=new Int32Array(4),j=null,H=null,G=[],W=[];this.domElement=I,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace=tF,this._useLegacyLights=!1,this.toneMapping=ei,this.toneMappingExposure=1;let $=this,q=!1,Y=0,K=0,X=null,Z=-1,J=null,Q=new i2,ee=new i2,et=null,er=new nd(0),en=0,ea=I.width,es=I.height,eo=1,el=null,eu=null,ec=new i2(0,0,ea,es),ed=new i2(0,0,ea,es),eh=!1,ef=new ad,ep=!1,em=!1,eg=null,ev=new rL,ey=new iD,eb=new rt,e_={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function eE(){return null===X?eo:1}let eS=L;function ex(e,t){for(let i=0;i<e.length;i++){let r=e[i],n=I.getContext(r,t);if(null!==n)return n}return null}try{if("setAttribute"in I&&I.setAttribute("data-engine",`three.js r${l}`),I.addEventListener("webglcontextlost",eR,!1),I.addEventListener("webglcontextrestored",eC,!1),I.addEventListener("webglcontextcreationerror",eL,!1),null===eS){let e=["webgl2","webgl","experimental-webgl"];if(!0===$.isWebGL1Renderer&&e.shift(),eS=ex(e,{alpha:!0,depth:k,stencil:D,antialias:O,premultipliedAlpha:N,preserveDrawingBuffer:U,powerPreference:F,failIfMajorPerformanceCaveat:B}),null===eS){if(ex(e))throw Error("Error creating WebGL context with your selected attributes.");throw Error("Error creating WebGL context.")}}"undefined"!=typeof WebGLRenderingContext&&eS instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===eS.getShaderPrecisionFormat&&(eS.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function eT(){i=new aV(eS),r=new aS(eS,i,e),i.init(r),M=new oh(eS,i,r),n=new oc(eS,i,r),a=new aH(eS),s=new s6,o=new od(eS,i,n,s,r,M,a),u=new aT($),c=new aB($),d=new af(eS,r),R=new a_(eS,i,d,r),h=new az(eS,d,a,R),f=new aq(eS,h,d,a),T=new a$(eS,r,o),y=new ax(s),p=new s4($,u,c,i,r,R,y),m=new ob($,s),g=new oe,v=new os(i,r),x=new ab($,u,c,n,f,t,N),S=new ou($,f,r),C=new o_(eS,a,r,n),w=new aE(eS,i,a,r),A=new aj(eS,i,a,r),a.programs=p.programs,$.capabilities=r,$.extensions=i,$.properties=s,$.renderLists=g,$.shadowMap=S,$.state=n,$.info=a}eT();let eA=new oy($,eS);function eR(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),q=!0}function eC(){console.log("THREE.WebGLRenderer: Context Restored."),q=!1;let e=a.autoReset,t=S.enabled,i=S.autoUpdate,r=S.needsUpdate,n=S.type;eT(),a.autoReset=e,S.enabled=t,S.autoUpdate=i,S.needsUpdate=r,S.type=n}function eL(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function eF(e){let t=e.target;t.removeEventListener("dispose",eF),function(e){let t=s.get(e).programs;void 0!==t&&(t.forEach(function(e){p.releaseProgram(e)}),e.isShaderMaterial&&p.releaseShaderCache(e))}(t),s.remove(t)}this.xr=eA,this.getContext=function(){return eS},this.getContextAttributes=function(){return eS.getContextAttributes()},this.forceContextLoss=function(){let e=i.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){let e=i.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return eo},this.setPixelRatio=function(e){void 0!==e&&(eo=e,this.setSize(ea,es,!1))},this.getSize=function(e){return e.set(ea,es)},this.setSize=function(e,t,i=!0){if(eA.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}ea=e,es=t,I.width=Math.floor(e*eo),I.height=Math.floor(t*eo),!0===i&&(I.style.width=e+"px",I.style.height=t+"px"),this.setViewport(0,0,e,t)},this.getDrawingBufferSize=function(e){return e.set(ea*eo,es*eo).floor()},this.setDrawingBufferSize=function(e,t,i){ea=e,es=t,eo=i,I.width=Math.floor(e*i),I.height=Math.floor(t*i),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(Q)},this.getViewport=function(e){return e.copy(ec)},this.setViewport=function(e,t,i,r){e.isVector4?ec.set(e.x,e.y,e.z,e.w):ec.set(e,t,i,r),n.viewport(Q.copy(ec).multiplyScalar(eo).floor())},this.getScissor=function(e){return e.copy(ed)},this.setScissor=function(e,t,i,r){e.isVector4?ed.set(e.x,e.y,e.z,e.w):ed.set(e,t,i,r),n.scissor(ee.copy(ed).multiplyScalar(eo).floor())},this.getScissorTest=function(){return eh},this.setScissorTest=function(e){n.setScissorTest(eh=e)},this.setOpaqueSort=function(e){el=e},this.setTransparentSort=function(e){eu=e},this.getClearColor=function(e){return e.copy(x.getClearColor())},this.setClearColor=function(){x.setClearColor.apply(x,arguments)},this.getClearAlpha=function(){return x.getClearAlpha()},this.setClearAlpha=function(){x.setClearAlpha.apply(x,arguments)},this.clear=function(e=!0,t=!0,i=!0){let r=0;if(e){let e=!1;if(null!==X){let t=X.texture.format;e=t===eY||t===eq||t===eW}if(e){let e=X.texture.type,t=e===eM||e===ek||e===eI||e===eU||e===eO||e===eN,i=x.getClearColor(),r=x.getClearAlpha(),n=i.r,a=i.g,s=i.b;t?(V[0]=n,V[1]=a,V[2]=s,V[3]=r,eS.clearBufferuiv(eS.COLOR,0,V)):(z[0]=n,z[1]=a,z[2]=s,z[3]=r,eS.clearBufferiv(eS.COLOR,0,z))}else r|=eS.COLOR_BUFFER_BIT}t&&(r|=eS.DEPTH_BUFFER_BIT),i&&(r|=eS.STENCIL_BUFFER_BIT),eS.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){I.removeEventListener("webglcontextlost",eR,!1),I.removeEventListener("webglcontextrestored",eC,!1),I.removeEventListener("webglcontextcreationerror",eL,!1),g.dispose(),v.dispose(),s.dispose(),u.dispose(),c.dispose(),f.dispose(),R.dispose(),C.dispose(),p.dispose(),eA.dispose(),eA.removeEventListener("sessionstart",ez),eA.removeEventListener("sessionend",ej),eg&&(eg.dispose(),eg=null),eH.stop()},this.renderBufferDirect=function(e,t,i,a,l,f){let p;null===t&&(t=e_);let g=l.isMesh&&0>l.matrixWorld.determinant(),v=function(e,t,i,a,l){var d;!0!==t.isScene&&(t=e_),o.resetTextureUnits();let h=t.fog,f=a.isMeshStandardMaterial?t.environment:null,p=null===X?$.outputColorSpace:!0===X.isXRRenderTarget?X.texture.colorSpace:tB,g=(a.isMeshStandardMaterial?c:u).get(a.envMap||f),v=!0===a.vertexColors&&!!i.attributes.color&&4===i.attributes.color.itemSize,b=!!i.attributes.tangent&&(!!a.normalMap||a.anisotropy>0),_=!!i.morphAttributes.position,E=!!i.morphAttributes.normal,S=!!i.morphAttributes.color,x=ei;a.toneMapped&&(null===X||!0===X.isXRRenderTarget)&&(x=$.toneMapping);let w=i.morphAttributes.position||i.morphAttributes.normal||i.morphAttributes.color,A=void 0!==w?w.length:0,M=s.get(a),R=H.state.lights;if(!0===ep&&(!0===em||e!==J)){let t=e===J&&a.id===Z;y.setState(a,e,t)}let I=!1;a.version===M.__version?M.needsLights&&M.lightsStateVersion!==R.state.version?I=!0:M.outputColorSpace!==p?I=!0:l.isInstancedMesh&&!1===M.instancing?I=!0:l.isInstancedMesh||!0!==M.instancing?l.isSkinnedMesh&&!1===M.skinning?I=!0:l.isSkinnedMesh||!0!==M.skinning?l.isInstancedMesh&&!0===M.instancingColor&&null===l.instanceColor?I=!0:l.isInstancedMesh&&!1===M.instancingColor&&null!==l.instanceColor?I=!0:M.envMap!==g?I=!0:!0===a.fog&&M.fog!==h?I=!0:void 0!==M.numClippingPlanes&&(M.numClippingPlanes!==y.numPlanes||M.numIntersection!==y.numIntersection)?I=!0:M.vertexAlphas!==v?I=!0:M.vertexTangents!==b?I=!0:M.morphTargets!==_?I=!0:M.morphNormals!==E?I=!0:M.morphColors!==S?I=!0:M.toneMapping!==x?I=!0:!0===r.isWebGL2&&M.morphTargetsCount!==A&&(I=!0):I=!0:I=!0:(I=!0,M.__version=a.version);let L=M.currentProgram;!0===I&&(L=eX(a,t,l));let k=!1,D=!1,P=!1,O=L.getUniforms(),N=M.uniforms;if(n.useProgram(L.program)&&(k=!0,D=!0,P=!0),a.id!==Z&&(Z=a.id,D=!0),k||J!==e){O.setValue(eS,"projectionMatrix",e.projectionMatrix),O.setValue(eS,"viewMatrix",e.matrixWorldInverse);let t=O.map.cameraPosition;void 0!==t&&t.setValue(eS,eb.setFromMatrixPosition(e.matrixWorld)),r.logarithmicDepthBuffer&&O.setValue(eS,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),(a.isMeshPhongMaterial||a.isMeshToonMaterial||a.isMeshLambertMaterial||a.isMeshBasicMaterial||a.isMeshStandardMaterial||a.isShaderMaterial)&&O.setValue(eS,"isOrthographic",!0===e.isOrthographicCamera),J!==e&&(J=e,D=!0,P=!0)}if(l.isSkinnedMesh){O.setOptional(eS,l,"bindMatrix"),O.setOptional(eS,l,"bindMatrixInverse");let e=l.skeleton;e&&(r.floatVertexTextures?(null===e.boneTexture&&e.computeBoneTexture(),O.setValue(eS,"boneTexture",e.boneTexture,o),O.setValue(eS,"boneTextureSize",e.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}let U=i.morphAttributes;if((void 0!==U.position||void 0!==U.normal||void 0!==U.color&&!0===r.isWebGL2)&&T.update(l,i,L),(D||M.receiveShadow!==l.receiveShadow)&&(M.receiveShadow=l.receiveShadow,O.setValue(eS,"receiveShadow",l.receiveShadow)),a.isMeshGouraudMaterial&&null!==a.envMap&&(N.envMap.value=g,N.flipEnvMap.value=g.isCubeTexture&&!1===g.isRenderTargetTexture?-1:1),D&&(O.setValue(eS,"toneMappingExposure",$.toneMappingExposure),M.needsLights&&(d=P,N.ambientLightColor.needsUpdate=d,N.lightProbe.needsUpdate=d,N.directionalLights.needsUpdate=d,N.directionalLightShadows.needsUpdate=d,N.pointLights.needsUpdate=d,N.pointLightShadows.needsUpdate=d,N.spotLights.needsUpdate=d,N.spotLightShadows.needsUpdate=d,N.rectAreaLights.needsUpdate=d,N.hemisphereLights.needsUpdate=d),h&&!0===a.fog&&m.refreshFogUniforms(N,h),m.refreshMaterialUniforms(N,a,eo,es,eg),sV.upload(eS,M.uniformsList,N,o)),a.isShaderMaterial&&!0===a.uniformsNeedUpdate&&(sV.upload(eS,M.uniformsList,N,o),a.uniformsNeedUpdate=!1),a.isSpriteMaterial&&O.setValue(eS,"center",l.center),O.setValue(eS,"modelViewMatrix",l.modelViewMatrix),O.setValue(eS,"normalMatrix",l.normalMatrix),O.setValue(eS,"modelMatrix",l.matrixWorld),a.isShaderMaterial||a.isRawShaderMaterial){let e=a.uniformsGroups;for(let t=0,i=e.length;t<i;t++)if(r.isWebGL2){let i=e[t];C.update(i,L),C.bind(i,L)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.")}return L}(e,t,i,a,l);n.setMaterial(a,g);let b=i.index,_=1;if(!0===a.wireframe){if(void 0===(b=h.getWireframeAttribute(i)))return;_=2}let E=i.drawRange,S=i.attributes.position,x=E.start*_,M=(E.start+E.count)*_;null!==f&&(x=Math.max(x,f.start*_),M=Math.min(M,(f.start+f.count)*_)),null!==b?(x=Math.max(x,0),M=Math.min(M,b.count)):null!=S&&(x=Math.max(x,0),M=Math.min(M,S.count));let I=M-x;if(I<0||I===1/0)return;R.setup(l,a,v,i,b);let L=w;if(null!==b&&(p=d.get(b),(L=A).setIndex(p)),l.isMesh)!0===a.wireframe?(n.setLineWidth(a.wireframeLinewidth*eE()),L.setMode(eS.LINES)):L.setMode(eS.TRIANGLES);else if(l.isLine){let e=a.linewidth;void 0===e&&(e=1),n.setLineWidth(e*eE()),l.isLineSegments?L.setMode(eS.LINES):l.isLineLoop?L.setMode(eS.LINE_LOOP):L.setMode(eS.LINE_STRIP)}else l.isPoints?L.setMode(eS.POINTS):l.isSprite&&L.setMode(eS.TRIANGLES);if(l.isInstancedMesh)L.renderInstances(x,I,l.count);else if(i.isInstancedBufferGeometry){let e=void 0!==i._maxInstanceCount?i._maxInstanceCount:1/0,t=Math.min(i.instanceCount,e);L.renderInstances(x,I,t)}else L.render(x,I)},this.compile=function(e,t){function i(e,t,i){!0===e.transparent&&e.side===E&&!1===e.forceSinglePass?(e.side=_,e.needsUpdate=!0,eX(e,t,i),e.side=b,e.needsUpdate=!0,eX(e,t,i),e.side=E):eX(e,t,i)}(H=v.get(e)).init(),W.push(H),e.traverseVisible(function(e){e.isLight&&e.layers.test(t.layers)&&(H.pushLight(e),e.castShadow&&H.pushShadow(e))}),H.setupLights($._useLegacyLights),e.traverse(function(t){let r=t.material;if(r){if(Array.isArray(r))for(let n=0;n<r.length;n++){let a=r[n];i(a,e,t)}else i(r,e,t)}}),W.pop(),H=null};let eV=null;function ez(){eH.stop()}function ej(){eH.start()}let eH=new ah;function eG(e,t,a,s){let l=e.opaque,u=e.transmissive,c=e.transparent;H.setupLightsView(a),!0===ep&&y.setGlobalState($.clippingPlanes,a),u.length>0&&function(e,t,n,a){let s=r.isWebGL2;null===eg&&(eg=new i5(1,1,{generateMipmaps:!0,type:i.has("EXT_color_buffer_half_float")?eP:eM,minFilter:ew,samples:s?4:0})),$.getDrawingBufferSize(ey),s?eg.setSize(ey.x,ey.y):eg.setSize(iC(ey.x),iC(ey.y));let l=$.getRenderTarget();$.setRenderTarget(eg),$.getClearColor(er),(en=$.getClearAlpha())<1&&$.setClearColor(16777215,.5),$.clear();let u=$.toneMapping;$.toneMapping=ei,e$(e,n,a),o.updateMultisampleRenderTarget(eg),o.updateRenderTargetMipmap(eg);let c=!1;for(let e=0,i=t.length;e<i;e++){let i=t[e],r=i.object,s=i.geometry,o=i.material,l=i.group;if(o.side===E&&r.layers.test(a.layers)){let e=o.side;o.side=_,o.needsUpdate=!0,eK(r,n,a,s,o,l),o.side=e,o.needsUpdate=!0,c=!0}}!0===c&&(o.updateMultisampleRenderTarget(eg),o.updateRenderTargetMipmap(eg)),$.setRenderTarget(l),$.setClearColor(er,en),$.toneMapping=u}(l,u,t,a),s&&n.viewport(Q.copy(s)),l.length>0&&e$(l,t,a),u.length>0&&e$(u,t,a),c.length>0&&e$(c,t,a),n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),n.setPolygonOffset(!1)}function e$(e,t,i){let r=!0===t.isScene?t.overrideMaterial:null;for(let n=0,a=e.length;n<a;n++){let a=e[n],s=a.object,o=a.geometry,l=null===r?a.material:r,u=a.group;s.layers.test(i.layers)&&eK(s,t,i,o,l,u)}}function eK(e,t,i,r,n,a){e.onBeforeRender($,t,i,r,n,a),e.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),n.onBeforeRender($,t,i,r,e,a),!0===n.transparent&&n.side===E&&!1===n.forceSinglePass?(n.side=_,n.needsUpdate=!0,$.renderBufferDirect(i,t,r,n,e,a),n.side=b,n.needsUpdate=!0,$.renderBufferDirect(i,t,r,n,e,a),n.side=E):$.renderBufferDirect(i,t,r,n,e,a),e.onAfterRender($,t,i,r,n,a)}function eX(e,t,i){!0!==t.isScene&&(t=e_);let r=s.get(e),n=H.state.lights,a=H.state.shadowsArray,o=n.state.version,l=p.getParameters(e,n.state,a,t,i),d=p.getProgramCacheKey(l),h=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?c:u).get(e.envMap||r.environment),void 0===h&&(e.addEventListener("dispose",eF),h=new Map,r.programs=h);let f=h.get(d);if(void 0!==f){if(r.currentProgram===f&&r.lightsStateVersion===o)return eZ(e,l),f}else l.uniforms=p.getUniforms(e),e.onBuild(i,l,$),e.onBeforeCompile(l,$),f=p.acquireProgram(l,d),h.set(d,f),r.uniforms=l.uniforms;let m=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(m.clippingPlanes=y.uniform),eZ(e,l),r.needsLights=e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights,r.lightsStateVersion=o,r.needsLights&&(m.ambientLightColor.value=n.state.ambient,m.lightProbe.value=n.state.probe,m.directionalLights.value=n.state.directional,m.directionalLightShadows.value=n.state.directionalShadow,m.spotLights.value=n.state.spot,m.spotLightShadows.value=n.state.spotShadow,m.rectAreaLights.value=n.state.rectArea,m.ltc_1.value=n.state.rectAreaLTC1,m.ltc_2.value=n.state.rectAreaLTC2,m.pointLights.value=n.state.point,m.pointLightShadows.value=n.state.pointShadow,m.hemisphereLights.value=n.state.hemi,m.directionalShadowMap.value=n.state.directionalShadowMap,m.directionalShadowMatrix.value=n.state.directionalShadowMatrix,m.spotShadowMap.value=n.state.spotShadowMap,m.spotLightMatrix.value=n.state.spotLightMatrix,m.spotLightMap.value=n.state.spotLightMap,m.pointShadowMap.value=n.state.pointShadowMap,m.pointShadowMatrix.value=n.state.pointShadowMatrix);let g=f.getUniforms(),v=sV.seqWithValue(g.seq,m);return r.currentProgram=f,r.uniformsList=v,f}function eZ(e,t){let i=s.get(e);i.outputColorSpace=t.outputColorSpace,i.instancing=t.instancing,i.instancingColor=t.instancingColor,i.skinning=t.skinning,i.morphTargets=t.morphTargets,i.morphNormals=t.morphNormals,i.morphColors=t.morphColors,i.morphTargetsCount=t.morphTargetsCount,i.numClippingPlanes=t.numClippingPlanes,i.numIntersection=t.numClipIntersection,i.vertexAlphas=t.vertexAlphas,i.vertexTangents=t.vertexTangents,i.toneMapping=t.toneMapping}eH.setAnimationLoop(function(e){eV&&eV(e)}),"undefined"!=typeof self&&eH.setContext(self),this.setAnimationLoop=function(e){eV=e,eA.setAnimationLoop(e),null===e?eH.stop():eH.start()},eA.addEventListener("sessionstart",ez),eA.addEventListener("sessionend",ej),this.render=function(e,t){if(void 0!==t&&!0!==t.isCamera){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(!0===q)return;!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===eA.enabled&&!0===eA.isPresenting&&(!0===eA.cameraAutoUpdate&&eA.updateCamera(t),t=eA.getCamera()),!0===e.isScene&&e.onBeforeRender($,e,t,X),(H=v.get(e,W.length)).init(),W.push(H),ev.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),ef.setFromProjectionMatrix(ev),em=this.localClippingEnabled,ep=y.init(this.clippingPlanes,em),(j=g.get(e,G.length)).init(),G.push(j),function e(t,i,r,n){if(!1===t.visible)return;let a=t.layers.test(i.layers);if(a){if(t.isGroup)r=t.renderOrder;else if(t.isLOD)!0===t.autoUpdate&&t.update(i);else if(t.isLight)H.pushLight(t),t.castShadow&&H.pushShadow(t);else if(t.isSprite){if(!t.frustumCulled||ef.intersectsSprite(t)){n&&eb.setFromMatrixPosition(t.matrixWorld).applyMatrix4(ev);let e=f.update(t),i=t.material;i.visible&&j.push(t,e,i,r,eb.z,null)}}else if((t.isMesh||t.isLine||t.isPoints)&&(!t.frustumCulled||ef.intersectsObject(t))){let e=f.update(t),i=t.material;if(n&&(void 0!==t.boundingSphere?(null===t.boundingSphere&&t.computeBoundingSphere(),eb.copy(t.boundingSphere.center)):(null===e.boundingSphere&&e.computeBoundingSphere(),eb.copy(e.boundingSphere.center)),eb.applyMatrix4(t.matrixWorld).applyMatrix4(ev)),Array.isArray(i)){let n=e.groups;for(let a=0,s=n.length;a<s;a++){let s=n[a],o=i[s.materialIndex];o&&o.visible&&j.push(t,e,o,r,eb.z,s)}}else i.visible&&j.push(t,e,i,r,eb.z,null)}}let s=t.children;for(let t=0,a=s.length;t<a;t++)e(s[t],i,r,n)}(e,t,0,$.sortObjects),j.finish(),!0===$.sortObjects&&j.sort(el,eu),this.info.render.frame++,!0===ep&&y.beginShadows();let i=H.state.shadowsArray;if(S.render(i,e,t),!0===ep&&y.endShadows(),!0===this.info.autoReset&&this.info.reset(),x.render(j,e),H.setupLights($._useLegacyLights),t.isArrayCamera){let i=t.cameras;for(let t=0,r=i.length;t<r;t++){let r=i[t];eG(j,e,r,r.viewport)}}else eG(j,e,t);null!==X&&(o.updateMultisampleRenderTarget(X),o.updateRenderTargetMipmap(X)),!0===e.isScene&&e.onAfterRender($,e,t),R.resetDefaultState(),Z=-1,J=null,W.pop(),H=W.length>0?W[W.length-1]:null,G.pop(),j=G.length>0?G[G.length-1]:null},this.getActiveCubeFace=function(){return Y},this.getActiveMipmapLevel=function(){return K},this.getRenderTarget=function(){return X},this.setRenderTargetTextures=function(e,t,r){s.get(e.texture).__webglTexture=t,s.get(e.depthTexture).__webglTexture=r;let n=s.get(e);n.__hasExternalTextures=!0,n.__hasExternalTextures&&(n.__autoAllocateDepthBuffer=void 0===r,n.__autoAllocateDepthBuffer||!0!==i.has("WEBGL_multisampled_render_to_texture")||(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),n.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){let i=s.get(e);i.__webglFramebuffer=t,i.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e,t=0,i=0){X=e,Y=t,K=i;let a=!0,l=null,u=!1,c=!1;if(e){let d=s.get(e);void 0!==d.__useDefaultFramebuffer?(n.bindFramebuffer(eS.FRAMEBUFFER,null),a=!1):void 0===d.__webglFramebuffer?o.setupRenderTarget(e):d.__hasExternalTextures&&o.rebindTextures(e,s.get(e.texture).__webglTexture,s.get(e.depthTexture).__webglTexture);let h=e.texture;(h.isData3DTexture||h.isDataArrayTexture||h.isCompressedArrayTexture)&&(c=!0);let f=s.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(l=Array.isArray(f[t])?f[t][i]:f[t],u=!0):l=r.isWebGL2&&e.samples>0&&!1===o.useMultisampledRTT(e)?s.get(e).__webglMultisampledFramebuffer:Array.isArray(f)?f[i]:f,Q.copy(e.viewport),ee.copy(e.scissor),et=e.scissorTest}else Q.copy(ec).multiplyScalar(eo).floor(),ee.copy(ed).multiplyScalar(eo).floor(),et=eh;let d=n.bindFramebuffer(eS.FRAMEBUFFER,l);if(d&&r.drawBuffers&&a&&n.drawBuffers(e,l),n.viewport(Q),n.scissor(ee),n.setScissorTest(et),u){let r=s.get(e.texture);eS.framebufferTexture2D(eS.FRAMEBUFFER,eS.COLOR_ATTACHMENT0,eS.TEXTURE_CUBE_MAP_POSITIVE_X+t,r.__webglTexture,i)}else if(c){let r=s.get(e.texture),n=t||0;eS.framebufferTextureLayer(eS.FRAMEBUFFER,eS.COLOR_ATTACHMENT0,r.__webglTexture,i||0,n)}Z=-1},this.readRenderTargetPixels=function(e,t,a,o,l,u,c){if(!(e&&e.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let d=s.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==c&&(d=d[c]),d){n.bindFramebuffer(eS.FRAMEBUFFER,d);try{let n=e.texture,s=n.format,c=n.type;if(s!==eB&&M.convert(s)!==eS.getParameter(eS.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}let d=c===eP&&(i.has("EXT_color_buffer_half_float")||r.isWebGL2&&i.has("EXT_color_buffer_float"));if(c!==eM&&M.convert(c)!==eS.getParameter(eS.IMPLEMENTATION_COLOR_READ_TYPE)&&!(c===eD&&(r.isWebGL2||i.has("OES_texture_float")||i.has("WEBGL_color_buffer_float")))&&!d){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}t>=0&&t<=e.width-o&&a>=0&&a<=e.height-l&&eS.readPixels(t,a,o,l,M.convert(s),M.convert(c),u)}finally{let e=null!==X?s.get(X).__webglFramebuffer:null;n.bindFramebuffer(eS.FRAMEBUFFER,e)}}},this.copyFramebufferToTexture=function(e,t,i=0){let r=Math.pow(2,-i),a=Math.floor(t.image.width*r),s=Math.floor(t.image.height*r);o.setTexture2D(t,0),eS.copyTexSubImage2D(eS.TEXTURE_2D,i,0,0,e.x,e.y,a,s),n.unbindTexture()},this.copyTextureToTexture=function(e,t,i,r=0){let a=t.image.width,s=t.image.height,l=M.convert(i.format),u=M.convert(i.type);o.setTexture2D(i,0),eS.pixelStorei(eS.UNPACK_FLIP_Y_WEBGL,i.flipY),eS.pixelStorei(eS.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i.premultiplyAlpha),eS.pixelStorei(eS.UNPACK_ALIGNMENT,i.unpackAlignment),t.isDataTexture?eS.texSubImage2D(eS.TEXTURE_2D,r,e.x,e.y,a,s,l,u,t.image.data):t.isCompressedTexture?eS.compressedTexSubImage2D(eS.TEXTURE_2D,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,l,t.mipmaps[0].data):eS.texSubImage2D(eS.TEXTURE_2D,r,e.x,e.y,l,u,t.image),0===r&&i.generateMipmaps&&eS.generateMipmap(eS.TEXTURE_2D),n.unbindTexture()},this.copyTextureToTexture3D=function(e,t,i,r,a=0){let s;if($.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}let l=e.max.x-e.min.x+1,u=e.max.y-e.min.y+1,c=e.max.z-e.min.z+1,d=M.convert(r.format),h=M.convert(r.type);if(r.isData3DTexture)o.setTexture3D(r,0),s=eS.TEXTURE_3D;else if(r.isDataArrayTexture)o.setTexture2DArray(r,0),s=eS.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}eS.pixelStorei(eS.UNPACK_FLIP_Y_WEBGL,r.flipY),eS.pixelStorei(eS.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),eS.pixelStorei(eS.UNPACK_ALIGNMENT,r.unpackAlignment);let f=eS.getParameter(eS.UNPACK_ROW_LENGTH),p=eS.getParameter(eS.UNPACK_IMAGE_HEIGHT),m=eS.getParameter(eS.UNPACK_SKIP_PIXELS),g=eS.getParameter(eS.UNPACK_SKIP_ROWS),v=eS.getParameter(eS.UNPACK_SKIP_IMAGES),y=i.isCompressedTexture?i.mipmaps[0]:i.image;eS.pixelStorei(eS.UNPACK_ROW_LENGTH,y.width),eS.pixelStorei(eS.UNPACK_IMAGE_HEIGHT,y.height),eS.pixelStorei(eS.UNPACK_SKIP_PIXELS,e.min.x),eS.pixelStorei(eS.UNPACK_SKIP_ROWS,e.min.y),eS.pixelStorei(eS.UNPACK_SKIP_IMAGES,e.min.z),i.isDataTexture||i.isData3DTexture?eS.texSubImage3D(s,a,t.x,t.y,t.z,l,u,c,d,h,y.data):i.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),eS.compressedTexSubImage3D(s,a,t.x,t.y,t.z,l,u,c,d,y.data)):eS.texSubImage3D(s,a,t.x,t.y,t.z,l,u,c,d,h,y),eS.pixelStorei(eS.UNPACK_ROW_LENGTH,f),eS.pixelStorei(eS.UNPACK_IMAGE_HEIGHT,p),eS.pixelStorei(eS.UNPACK_SKIP_PIXELS,m),eS.pixelStorei(eS.UNPACK_SKIP_ROWS,g),eS.pixelStorei(eS.UNPACK_SKIP_IMAGES,v),0===a&&r.generateMipmaps&&eS.generateMipmap(s),n.unbindTexture()},this.initTexture=function(e){e.isCubeTexture?o.setTextureCube(e,0):e.isData3DTexture?o.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?o.setTexture2DArray(e,0):o.setTexture2D(e,0),n.unbindTexture()},this.resetState=function(){Y=0,K=0,X=null,n.reset(),R.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return ig}get physicallyCorrectLights(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights}set physicallyCorrectLights(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}get outputEncoding(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace===tF?tk:tL}set outputEncoding(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=e===tk?tF:tB}get useLegacyLights(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights}set useLegacyLights(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}class oS extends oE{}oS.prototype.isWebGL1Renderer=!0;class ox{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new nd(e),this.density=t}clone(){return new ox(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class oT{constructor(e,t=1,i=1e3){this.isFog=!0,this.name="",this.color=new nd(e),this.near=t,this.far=i}clone(){return new oT(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class ow extends r2{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.overrideMaterial=null,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){let t=super.toJSON(e);return null!==this.fog&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(t.object.backgroundIntensity=this.backgroundIntensity),t}}class oA{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=ii,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ix()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}setUsage(e){return this.usage=e,this}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,i){e*=this.stride,i*=t.stride;for(let r=0,n=this.stride;r<n;r++)this.array[e+r]=t.array[i+r];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ix()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(t,this.stride);return i.setUsage(this.usage),i}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=ix()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}let oM=new rt;class oR{constructor(e,t,i,r=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=i,this.normalized=r}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,i=this.data.count;t<i;t++)oM.fromBufferAttribute(this,t),oM.applyMatrix4(e),this.setXYZ(t,oM.x,oM.y,oM.z);return this}applyNormalMatrix(e){for(let t=0,i=this.count;t<i;t++)oM.fromBufferAttribute(this,t),oM.applyNormalMatrix(e),this.setXYZ(t,oM.x,oM.y,oM.z);return this}transformDirection(e){for(let t=0,i=this.count;t<i;t++)oM.fromBufferAttribute(this,t),oM.transformDirection(e),this.setXYZ(t,oM.x,oM.y,oM.z);return this}setX(e,t){return this.normalized&&(t=iL(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=iL(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=iL(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=iL(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=iI(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=iI(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=iI(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=iI(t,this.array)),t}setXY(e,t,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=iL(t,this.array),i=iL(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this}setXYZ(e,t,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(t=iL(t,this.array),i=iL(i,this.array),r=iL(r,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this}setXYZW(e,t,i,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=iL(t,this.array),i=iL(i,this.array),r=iL(r,this.array),n=iL(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=i,this.data.array[e+2]=r,this.data.array[e+3]=n,this}clone(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new oR(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);{console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let i=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[i+t])}return new n_(new this.array.constructor(e),this.itemSize,this.normalized)}}toJSON(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};{console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let t=0;t<this.count;t++){let i=t*this.data.stride+this.offset;for(let t=0;t<this.itemSize;t++)e.push(this.data.array[i+t])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}}}class oC extends ns{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new nd(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let oI=new rt,oL=new rt,ok=new rt,oD=new iD,oP=new iD,oO=new rL,oN=new rt,oU=new rt,oF=new rt,oB=new iD,oV=new iD,oz=new iD;class oj extends r2{constructor(e){if(super(),this.isSprite=!0,this.type="Sprite",void 0===n){n=new nF;let e=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),t=new oA(e,5);n.setIndex([0,1,2,0,2,3]),n.setAttribute("position",new oR(t,3,0,!1)),n.setAttribute("uv",new oR(t,2,3,!1))}this.geometry=n,this.material=void 0!==e?e:new oC,this.center=new iD(.5,.5)}raycast(e,t){let i,r;null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),oL.setFromMatrixScale(this.matrixWorld),oO.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),ok.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&oL.multiplyScalar(-ok.z);let n=this.material.rotation;0!==n&&(r=Math.cos(n),i=Math.sin(n));let a=this.center;oH(oN.set(-.5,-.5,0),ok,a,oL,i,r),oH(oU.set(.5,-.5,0),ok,a,oL,i,r),oH(oF.set(.5,.5,0),ok,a,oL,i,r),oB.set(0,0),oV.set(1,0),oz.set(1,1);let s=e.ray.intersectTriangle(oN,oU,oF,!1,oI);if(null===s&&(oH(oU.set(-.5,.5,0),ok,a,oL,i,r),oV.set(0,1),null===(s=e.ray.intersectTriangle(oN,oF,oU,!1,oI))))return;let o=e.ray.origin.distanceTo(oI);o<e.near||o>e.far||t.push({distance:o,point:oI.clone(),uv:nn.getInterpolation(oI,oN,oU,oF,oB,oV,oz,new iD),face:null,object:this})}copy(e,t){return super.copy(e,t),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}function oH(e,t,i,r,n,a){oD.subVectors(e,i).addScalar(.5).multiply(r),void 0!==n?(oP.x=a*oD.x-n*oD.y,oP.y=n*oD.x+a*oD.y):oP.copy(oD),e.copy(t),e.x+=oP.x,e.y+=oP.y,e.applyMatrix4(oO)}let oG=new rt,oW=new rt;class o$ extends r2{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);let t=e.levels;for(let e=0,i=t.length;e<i;e++){let i=t[e];this.addLevel(i.object.clone(),i.distance,i.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,i=0){let r;t=Math.abs(t);let n=this.levels;for(r=0;r<n.length&&!(t<n[r].distance);r++);return n.splice(r,0,{distance:t,hysteresis:i,object:e}),this.add(e),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){let t=this.levels;if(t.length>0){let i,r;for(i=1,r=t.length;i<r;i++){let r=t[i].distance;if(t[i].object.visible&&(r-=r*t[i].hysteresis),e<r)break}return t[i-1].object}return null}raycast(e,t){let i=this.levels;if(i.length>0){oG.setFromMatrixPosition(this.matrixWorld);let i=e.ray.origin.distanceTo(oG);this.getObjectForDistance(i).raycast(e,t)}}update(e){let t=this.levels;if(t.length>1){let i,r;oG.setFromMatrixPosition(e.matrixWorld),oW.setFromMatrixPosition(this.matrixWorld);let n=oG.distanceTo(oW)/e.zoom;for(i=1,t[0].object.visible=!0,r=t.length;i<r;i++){let e=t[i].distance;if(t[i].object.visible&&(e-=e*t[i].hysteresis),n>=e)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<r;i++)t[i].object.visible=!1}}toJSON(e){let t=super.toJSON(e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];let i=this.levels;for(let e=0,r=i.length;e<r;e++){let r=i[e];t.object.levels.push({object:r.object.uuid,distance:r.distance,hysteresis:r.hysteresis})}return t}}let oq=new rt,oY=new i2,oK=new i2,oX=new rt,oZ=new rL,oJ=new rt,oQ=new rS,o0=new rL,o1=new rI;class o2 extends n2{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new rL,this.bindMatrixInverse=new rL,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;null===this.boundingBox&&(this.boundingBox=new rn),this.boundingBox.makeEmpty();let t=e.getAttribute("position");for(let e=0;e<t.count;e++)oJ.fromBufferAttribute(t,e),this.applyBoneTransform(e,oJ),this.boundingBox.expandByPoint(oJ)}computeBoundingSphere(){let e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new rS),this.boundingSphere.makeEmpty();let t=e.getAttribute("position");for(let e=0;e<t.count;e++)oJ.fromBufferAttribute(t,e),this.applyBoneTransform(e,oJ),this.boundingSphere.expandByPoint(oJ)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){let i=this.material,r=this.matrixWorld;if(void 0!==i&&(null===this.boundingSphere&&this.computeBoundingSphere(),oQ.copy(this.boundingSphere),oQ.applyMatrix4(r),!1!==e.ray.intersectsSphere(oQ))){if(o0.copy(r).invert(),o1.copy(e.ray).applyMatrix4(o0),null!==this.boundingBox&&!1===o1.intersectsBox(this.boundingBox))return;this._computeIntersections(e,t,o1)}}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new i2,t=this.geometry.attributes.skinWeight;for(let i=0,r=t.count;i<r;i++){e.fromBufferAttribute(t,i);let r=1/e.manhattanLength();r!==1/0?e.multiplyScalar(r):e.set(1,0,0,0),t.setXYZW(i,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){let i=this.skeleton,r=this.geometry;oY.fromBufferAttribute(r.attributes.skinIndex,e),oK.fromBufferAttribute(r.attributes.skinWeight,e),oq.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let e=0;e<4;e++){let r=oK.getComponent(e);if(0!==r){let n=oY.getComponent(e);oZ.multiplyMatrices(i.bones[n].matrixWorld,i.boneInverses[n]),t.addScaledVector(oX.copy(oq).applyMatrix4(oZ),r)}}return t.applyMatrix4(this.bindMatrixInverse)}boneTransform(e,t){return console.warn("THREE.SkinnedMesh: .boneTransform() was renamed to .applyBoneTransform() in r151."),this.applyBoneTransform(e,t)}}class o3 extends r2{constructor(){super(),this.isBone=!0,this.type="Bone"}}class o5 extends i1{constructor(e=null,t=1,i=1,r,n,a,s,o,l=ev,u=ev,c,d){super(null,a,s,o,l,u,r,n,c,d),this.isDataTexture=!0,this.image={data:e,width:t,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}let o4=new rL,o6=new rL;class o8{constructor(e=[],t=[]){this.uuid=ix(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.init()}init(){let e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,t=this.bones.length;e<t;e++)this.boneInverses.push(new rL)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){let t=new rL;this.bones[e]&&t.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(t)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&t.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){let t=this.bones[e];t&&(t.parent&&t.parent.isBone?(t.matrix.copy(t.parent.matrixWorld).invert(),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))}}update(){let e=this.bones,t=this.boneInverses,i=this.boneMatrices,r=this.boneTexture;for(let r=0,n=e.length;r<n;r++){let n=e[r]?e[r].matrixWorld:o6;o4.multiplyMatrices(n,t[r]),o4.toArray(i,16*r)}null!==r&&(r.needsUpdate=!0)}clone(){return new o8(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length);e=Math.max(e=iR(e),4);let t=new Float32Array(e*e*4);t.set(this.boneMatrices);let i=new o5(t,e,e,eB,eD);return i.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=i,this.boneTextureSize=e,this}getBoneByName(e){for(let t=0,i=this.bones.length;t<i;t++){let i=this.bones[t];if(i.name===e)return i}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let i=0,r=e.bones.length;i<r;i++){let r=e.bones[i],n=t[r];void 0===n&&(console.warn("THREE.Skeleton: No bone found with UUID:",r),n=new o3),this.bones.push(n),this.boneInverses.push(new rL().fromArray(e.boneInverses[i]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let t=this.bones,i=this.boneInverses;for(let r=0,n=t.length;r<n;r++){let n=t[r];e.bones.push(n.uuid);let a=i[r];e.boneInverses.push(a.toArray())}return e}}class o7 extends n_{constructor(e,t,i,r=1){super(e,t,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=r}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}let o9=new rL,le=new rL,lt=[],li=new rn,lr=new rL,ln=new n2,la=new rS;class ls extends n2{constructor(e,t,i){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new o7(new Float32Array(16*i),16),this.instanceColor=null,this.count=i,this.boundingBox=null,this.boundingSphere=null;for(let e=0;e<i;e++)this.setMatrixAt(e,lr)}computeBoundingBox(){let e=this.geometry,t=this.count;null===this.boundingBox&&(this.boundingBox=new rn),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,o9),li.copy(e.boundingBox).applyMatrix4(o9),this.boundingBox.union(li)}computeBoundingSphere(){let e=this.geometry,t=this.count;null===this.boundingSphere&&(this.boundingSphere=new rS),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let i=0;i<t;i++)this.getMatrixAt(i,o9),la.copy(e.boundingSphere).applyMatrix4(o9),this.boundingSphere.union(la)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,16*e)}raycast(e,t){let i=this.matrixWorld,r=this.count;if(ln.geometry=this.geometry,ln.material=this.material,void 0!==ln.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),la.copy(this.boundingSphere),la.applyMatrix4(i),!1!==e.ray.intersectsSphere(la)))for(let n=0;n<r;n++){this.getMatrixAt(n,o9),le.multiplyMatrices(i,o9),ln.matrixWorld=le,ln.raycast(e,lt);for(let e=0,i=lt.length;e<i;e++){let i=lt[e];i.instanceId=n,i.object=this,t.push(i)}lt.length=0}}setColorAt(e,t){null===this.instanceColor&&(this.instanceColor=new o7(new Float32Array(3*this.instanceMatrix.count),3)),t.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,16*e)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class lo extends ns{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new nd(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}let ll=new rt,lu=new rt,lc=new rL,ld=new rI,lh=new rS;class lf extends r2{constructor(e=new nF,t=new lo){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,i=[0];for(let e=1,r=t.count;e<r;e++)ll.fromBufferAttribute(t,e-1),lu.fromBufferAttribute(t,e),i[e]=i[e-1],i[e]+=ll.distanceTo(lu);e.setAttribute("lineDistance",new nC(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){let i=this.geometry,r=this.matrixWorld,n=e.params.Line.threshold,a=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),lh.copy(i.boundingSphere),lh.applyMatrix4(r),lh.radius+=n,!1===e.ray.intersectsSphere(lh))return;lc.copy(r).invert(),ld.copy(e.ray).applyMatrix4(lc);let s=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=new rt,u=new rt,c=new rt,d=new rt,h=this.isLineSegments?2:1,f=i.index,p=i.attributes,m=p.position;if(null!==f){let i=Math.max(0,a.start),r=Math.min(f.count,a.start+a.count);for(let n=i,a=r-1;n<a;n+=h){let i=f.getX(n),r=f.getX(n+1);l.fromBufferAttribute(m,i),u.fromBufferAttribute(m,r);let a=ld.distanceSqToSegment(l,u,d,c);if(a>o)continue;d.applyMatrix4(this.matrixWorld);let s=e.ray.origin.distanceTo(d);s<e.near||s>e.far||t.push({distance:s,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}else{let i=Math.max(0,a.start),r=Math.min(m.count,a.start+a.count);for(let n=i,a=r-1;n<a;n+=h){l.fromBufferAttribute(m,n),u.fromBufferAttribute(m,n+1);let i=ld.distanceSqToSegment(l,u,d,c);if(i>o)continue;d.applyMatrix4(this.matrixWorld);let r=e.ray.origin.distanceTo(d);r<e.near||r>e.far||t.push({distance:r,point:c.clone().applyMatrix4(this.matrixWorld),index:n,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){let e=this.geometry,t=e.morphAttributes,i=Object.keys(t);if(i.length>0){let e=t[i[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,i=e.length;t<i;t++){let i=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}}}}let lp=new rt,lm=new rt;class lg extends lf{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(null===e.index){let t=e.attributes.position,i=[];for(let e=0,r=t.count;e<r;e+=2)lp.fromBufferAttribute(t,e),lm.fromBufferAttribute(t,e+1),i[e]=0===e?0:i[e-1],i[e+1]=i[e]+lp.distanceTo(lm);e.setAttribute("lineDistance",new nC(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class lv extends lf{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class ly extends ns{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new nd(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let lb=new rL,l_=new rI,lE=new rS,lS=new rt;class lx extends r2{constructor(e=new nF,t=new ly){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){let i=this.geometry,r=this.matrixWorld,n=e.params.Points.threshold,a=i.drawRange;if(null===i.boundingSphere&&i.computeBoundingSphere(),lE.copy(i.boundingSphere),lE.applyMatrix4(r),lE.radius+=n,!1===e.ray.intersectsSphere(lE))return;lb.copy(r).invert(),l_.copy(e.ray).applyMatrix4(lb);let s=n/((this.scale.x+this.scale.y+this.scale.z)/3),o=s*s,l=i.index,u=i.attributes,c=u.position;if(null!==l){let i=Math.max(0,a.start),n=Math.min(l.count,a.start+a.count);for(let a=i;a<n;a++){let i=l.getX(a);lS.fromBufferAttribute(c,i),lT(lS,i,o,r,e,t,this)}}else{let i=Math.max(0,a.start),n=Math.min(c.count,a.start+a.count);for(let a=i;a<n;a++)lS.fromBufferAttribute(c,a),lT(lS,a,o,r,e,t,this)}}updateMorphTargets(){let e=this.geometry,t=e.morphAttributes,i=Object.keys(t);if(i.length>0){let e=t[i[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let t=0,i=e.length;t<i;t++){let i=e[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}}}}function lT(e,t,i,r,n,a,s){let o=l_.distanceSqToPoint(e);if(o<i){let i=new rt;l_.closestPointToPoint(e,i),i.applyMatrix4(r);let l=n.ray.origin.distanceTo(i);if(l<n.near||l>n.far)return;a.push({distance:l,distanceToRay:Math.sqrt(o),point:i,index:t,face:null,object:s})}}class lw extends i1{constructor(e,t,i,r,n,a,s,o,l){super(e,t,i,r,n,a,s,o,l),this.isVideoTexture=!0,this.minFilter=void 0!==a?a:eS,this.magFilter=void 0!==n?n:eS,this.generateMipmaps=!1;let u=this;"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback(function t(){u.needsUpdate=!0,e.requestVideoFrameCallback(t)})}clone(){return new this.constructor(this.image).copy(this)}update(){let e=this.image;!1=="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class lA extends i1{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=ev,this.minFilter=ev,this.generateMipmaps=!1,this.needsUpdate=!0}}class lM extends i1{constructor(e,t,i,r,n,a,s,o,l,u,c,d){super(null,a,s,o,l,u,r,n,c,d),this.isCompressedTexture=!0,this.image={width:t,height:i},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class lR extends lM{constructor(e,t,i,r,n,a){super(e,t,i,n,a),this.isCompressedArrayTexture=!0,this.image.depth=r,this.wrapR=em}}class lC extends lM{constructor(e,t,i){super(void 0,e[0].width,e[0].height,t,i,eu),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class lI extends i1{constructor(e,t,i,r,n,a,s,o,l){super(e,t,i,r,n,a,s,o,l),this.isCanvasTexture=!0,this.needsUpdate=!0}}class lL{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,t){let i=this.getUtoTmapping(e);return this.getPoint(i,t)}getPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return t}getSpacedPoints(e=5){let t=[];for(let i=0;i<=e;i++)t.push(this.getPointAt(i/e));return t}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let t=[],i,r=this.getPoint(0),n=0;t.push(0);for(let a=1;a<=e;a++)t.push(n+=(i=this.getPoint(a/e)).distanceTo(r)),r=i;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t){let i;let r=this.getLengths(),n=0,a=r.length;i=t||e*r[a-1];let s=0,o=a-1,l;for(;s<=o;)if((l=r[n=Math.floor(s+(o-s)/2)]-i)<0)s=n+1;else if(l>0)o=n-1;else{o=n;break}if(r[n=o]===i)return n/(a-1);let u=r[n],c=r[n+1],d=(n+(i-u)/(c-u))/(a-1);return d}getTangent(e,t){let i=e-1e-4,r=e+1e-4;i<0&&(i=0),r>1&&(r=1);let n=this.getPoint(i),a=this.getPoint(r),s=t||(n.isVector2?new iD:new rt);return s.copy(a).sub(n).normalize(),s}getTangentAt(e,t){let i=this.getUtoTmapping(e);return this.getTangent(i,t)}computeFrenetFrames(e,t){let i=new rt,r=[],n=[],a=[],s=new rt,o=new rL;for(let t=0;t<=e;t++){let i=t/e;r[t]=this.getTangentAt(i,new rt)}n[0]=new rt,a[0]=new rt;let l=Number.MAX_VALUE,u=Math.abs(r[0].x),c=Math.abs(r[0].y),d=Math.abs(r[0].z);u<=l&&(l=u,i.set(1,0,0)),c<=l&&(l=c,i.set(0,1,0)),d<=l&&i.set(0,0,1),s.crossVectors(r[0],i).normalize(),n[0].crossVectors(r[0],s),a[0].crossVectors(r[0],n[0]);for(let t=1;t<=e;t++){if(n[t]=n[t-1].clone(),a[t]=a[t-1].clone(),s.crossVectors(r[t-1],r[t]),s.length()>Number.EPSILON){s.normalize();let e=Math.acos(iT(r[t-1].dot(r[t]),-1,1));n[t].applyMatrix4(o.makeRotationAxis(s,e))}a[t].crossVectors(r[t],n[t])}if(!0===t){let t=Math.acos(iT(n[0].dot(n[e]),-1,1));t/=e,r[0].dot(s.crossVectors(n[0],n[e]))>0&&(t=-t);for(let i=1;i<=e;i++)n[i].applyMatrix4(o.makeRotationAxis(r[i],t*i)),a[i].crossVectors(r[i],n[i])}return{tangents:r,normals:n,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class lk extends lL{constructor(e=0,t=0,i=1,r=1,n=0,a=2*Math.PI,s=!1,o=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=i,this.yRadius=r,this.aStartAngle=n,this.aEndAngle=a,this.aClockwise=s,this.aRotation=o}getPoint(e,t){let i=t||new iD,r=2*Math.PI,n=this.aEndAngle-this.aStartAngle,a=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(n=a?0:r),!0!==this.aClockwise||a||(n===r?n=-r:n-=r);let s=this.aStartAngle+e*n,o=this.aX+this.xRadius*Math.cos(s),l=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){let e=Math.cos(this.aRotation),t=Math.sin(this.aRotation),i=o-this.aX,r=l-this.aY;o=i*e-r*t+this.aX,l=i*t+r*e+this.aY}return i.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class lD extends lk{constructor(e,t,i,r,n,a){super(e,t,i,i,r,n,a),this.isArcCurve=!0,this.type="ArcCurve"}}function lP(){let e=0,t=0,i=0,r=0;function n(n,a,s,o){e=n,t=s,i=-3*n+3*a-2*s-o,r=2*n-2*a+s+o}return{initCatmullRom:function(e,t,i,r,a){n(t,i,a*(i-e),a*(r-t))},initNonuniformCatmullRom:function(e,t,i,r,a,s,o){let l=(t-e)/a-(i-e)/(a+s)+(i-t)/s,u=(i-t)/s-(r-t)/(s+o)+(r-i)/o;n(t,i,l*=s,u*=s)},calc:function(n){let a=n*n;return e+t*n+i*a+r*(a*n)}}}let lO=new rt,lN=new lP,lU=new lP,lF=new lP;class lB extends lL{constructor(e=[],t=!1,i="centripetal",r=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=i,this.tension=r}getPoint(e,t=new rt){let i,r;let n=this.points,a=n.length,s=(a-(this.closed?0:1))*e,o=Math.floor(s),l=s-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/a)+1)*a:0===l&&o===a-1&&(o=a-2,l=1),this.closed||o>0?i=n[(o-1)%a]:(lO.subVectors(n[0],n[1]).add(n[0]),i=lO);let u=n[o%a],c=n[(o+1)%a];if(this.closed||o+2<a?r=n[(o+2)%a]:(lO.subVectors(n[a-1],n[a-2]).add(n[a-1]),r=lO),"centripetal"===this.curveType||"chordal"===this.curveType){let e="chordal"===this.curveType?.5:.25,t=Math.pow(i.distanceToSquared(u),e),n=Math.pow(u.distanceToSquared(c),e),a=Math.pow(c.distanceToSquared(r),e);n<1e-4&&(n=1),t<1e-4&&(t=n),a<1e-4&&(a=n),lN.initNonuniformCatmullRom(i.x,u.x,c.x,r.x,t,n,a),lU.initNonuniformCatmullRom(i.y,u.y,c.y,r.y,t,n,a),lF.initNonuniformCatmullRom(i.z,u.z,c.z,r.z,t,n,a)}else"catmullrom"===this.curveType&&(lN.initCatmullRom(i.x,u.x,c.x,r.x,this.tension),lU.initCatmullRom(i.y,u.y,c.y,r.y,this.tension),lF.initCatmullRom(i.z,u.z,c.z,r.z,this.tension));return t.set(lN.calc(l),lU.calc(l),lF.calc(l)),t}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let i=e.points[t];this.points.push(new rt().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function lV(e,t,i,r,n){let a=(r-t)*.5,s=(n-i)*.5,o=e*e;return(2*i-2*r+a+s)*(e*o)+(-3*i+3*r-2*a-s)*o+a*e+i}function lz(e,t,i,r){return function(e,t){let i=1-e;return i*i*t}(e,t)+2*(1-e)*e*i+e*e*r}function lj(e,t,i,r,n){return function(e,t){let i=1-e;return i*i*i*t}(e,t)+function(e,t){let i=1-e;return 3*i*i*e*t}(e,i)+3*(1-e)*e*e*r+e*e*e*n}class lH extends lL{constructor(e=new iD,t=new iD,i=new iD,r=new iD){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new iD){let i=this.v0,r=this.v1,n=this.v2,a=this.v3;return t.set(lj(e,i.x,r.x,n.x,a.x),lj(e,i.y,r.y,n.y,a.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class lG extends lL{constructor(e=new rt,t=new rt,i=new rt,r=new rt){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=i,this.v3=r}getPoint(e,t=new rt){let i=this.v0,r=this.v1,n=this.v2,a=this.v3;return t.set(lj(e,i.x,r.x,n.x,a.x),lj(e,i.y,r.y,n.y,a.y),lj(e,i.z,r.z,n.z,a.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class lW extends lL{constructor(e=new iD,t=new iD){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new iD){return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new iD){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class l$ extends lL{constructor(e=new rt,t=new rt){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new rt){return 1===e?t.copy(this.v2):(t.copy(this.v2).sub(this.v1),t.multiplyScalar(e).add(this.v1)),t}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new rt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class lq extends lL{constructor(e=new iD,t=new iD,i=new iD){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new iD){let i=this.v0,r=this.v1,n=this.v2;return t.set(lz(e,i.x,r.x,n.x),lz(e,i.y,r.y,n.y)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class lY extends lL{constructor(e=new rt,t=new rt,i=new rt){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=i}getPoint(e,t=new rt){let i=this.v0,r=this.v1,n=this.v2;return t.set(lz(e,i.x,r.x,n.x),lz(e,i.y,r.y,n.y),lz(e,i.z,r.z,n.z)),t}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class lK extends lL{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new iD){let i=this.points,r=(i.length-1)*e,n=Math.floor(r),a=r-n,s=i[0===n?n:n-1],o=i[n],l=i[n>i.length-2?i.length-1:n+1],u=i[n>i.length-3?i.length-1:n+2];return t.set(lV(a,s.x,o.x,l.x,u.x),lV(a,s.y,o.y,l.y,u.y)),t}copy(e){super.copy(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let i=e.points[t];this.points.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let t=0,i=this.points.length;t<i;t++){let i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,i=e.points.length;t<i;t++){let i=e.points[t];this.points.push(new iD().fromArray(i))}return this}}var lX=Object.freeze({__proto__:null,ArcCurve:lD,CatmullRomCurve3:lB,CubicBezierCurve:lH,CubicBezierCurve3:lG,EllipseCurve:lk,LineCurve:lW,LineCurve3:l$,QuadraticBezierCurve:lq,QuadraticBezierCurve3:lY,SplineCurve:lK});class lZ extends lL{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){let e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new lW(t,e))}getPoint(e,t){let i=e*this.getLength(),r=this.getCurveLengths(),n=0;for(;n<r.length;){if(r[n]>=i){let e=r[n]-i,a=this.curves[n],s=a.getLength(),o=0===s?0:1-e/s;return a.getPointAt(o,t)}n++}return null}getLength(){let e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;let e=[],t=0;for(let i=0,r=this.curves.length;i<r;i++)e.push(t+=this.curves[i].getLength());return this.cacheLengths=e,e}getSpacedPoints(e=40){let t=[];for(let i=0;i<=e;i++)t.push(this.getPoint(i/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){let t;let i=[];for(let r=0,n=this.curves;r<n.length;r++){let a=n[r],s=a.isEllipseCurve?2*e:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,o=a.getPoints(s);for(let e=0;e<o.length;e++){let r=o[e];t&&t.equals(r)||(i.push(r),t=r)}}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i}copy(e){super.copy(e),this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){let e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,i=this.curves.length;t<i;t++){let i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,i=e.curves.length;t<i;t++){let i=e.curves[t];this.curves.push(new lX[i.type]().fromJSON(i))}return this}}class lJ extends lZ{constructor(e){super(),this.type="Path",this.currentPoint=new iD,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,i=e.length;t<i;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){let i=new lW(this.currentPoint.clone(),new iD(e,t));return this.curves.push(i),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,i,r){let n=new lq(this.currentPoint.clone(),new iD(e,t),new iD(i,r));return this.curves.push(n),this.currentPoint.set(i,r),this}bezierCurveTo(e,t,i,r,n,a){let s=new lH(this.currentPoint.clone(),new iD(e,t),new iD(i,r),new iD(n,a));return this.curves.push(s),this.currentPoint.set(n,a),this}splineThru(e){let t=[this.currentPoint.clone()].concat(e),i=new lK(t);return this.curves.push(i),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,i,r,n,a){let s=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(e+s,t+o,i,r,n,a),this}absarc(e,t,i,r,n,a){return this.absellipse(e,t,i,i,r,n,a),this}ellipse(e,t,i,r,n,a,s,o){let l=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+l,t+u,i,r,n,a,s,o),this}absellipse(e,t,i,r,n,a,s,o){let l=new lk(e,t,i,r,n,a,s,o);if(this.curves.length>0){let e=l.getPoint(0);e.equals(this.currentPoint)||this.lineTo(e.x,e.y)}this.curves.push(l);let u=l.getPoint(1);return this.currentPoint.copy(u),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){let e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class lQ extends nF{constructor(e=[new iD(0,-.5),new iD(.5,0),new iD(0,.5)],t=12,i=0,r=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:i,phiLength:r},t=Math.floor(t),r=iT(r,0,2*Math.PI);let n=[],a=[],s=[],o=[],l=[],u=1/t,c=new rt,d=new iD,h=new rt,f=new rt,p=new rt,m=0,g=0;for(let t=0;t<=e.length-1;t++)switch(t){case 0:m=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,h.x=1*g,h.y=-m,h.z=0*g,p.copy(h),h.normalize(),o.push(h.x,h.y,h.z);break;case e.length-1:o.push(p.x,p.y,p.z);break;default:m=e[t+1].x-e[t].x,g=e[t+1].y-e[t].y,h.x=1*g,h.y=-m,h.z=0*g,f.copy(h),h.x+=p.x,h.y+=p.y,h.z+=p.z,h.normalize(),o.push(h.x,h.y,h.z),p.copy(f)}for(let n=0;n<=t;n++){let h=i+n*u*r,f=Math.sin(h),p=Math.cos(h);for(let i=0;i<=e.length-1;i++){c.x=e[i].x*f,c.y=e[i].y,c.z=e[i].x*p,a.push(c.x,c.y,c.z),d.x=n/t,d.y=i/(e.length-1),s.push(d.x,d.y);let r=o[3*i+0]*f,u=o[3*i+1],h=o[3*i+0]*p;l.push(r,u,h)}}for(let i=0;i<t;i++)for(let t=0;t<e.length-1;t++){let r=t+i*e.length,a=r+e.length,s=r+e.length+1,o=r+1;n.push(r,a,o),n.push(s,o,a)}this.setIndex(n),this.setAttribute("position",new nC(a,3)),this.setAttribute("uv",new nC(s,2)),this.setAttribute("normal",new nC(l,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new lQ(e.points,e.segments,e.phiStart,e.phiLength)}}class l0 extends lQ{constructor(e=1,t=1,i=4,r=8){let n=new lJ;n.absarc(0,-t/2,e,1.5*Math.PI,0),n.absarc(0,t/2,e,0,.5*Math.PI),super(n.getPoints(i),r),this.type="CapsuleGeometry",this.parameters={radius:e,length:t,capSegments:i,radialSegments:r}}static fromJSON(e){return new l0(e.radius,e.length,e.capSegments,e.radialSegments)}}class l1 extends nF{constructor(e=1,t=32,i=0,r=2*Math.PI){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:i,thetaLength:r},t=Math.max(3,t);let n=[],a=[],s=[],o=[],l=new rt,u=new iD;a.push(0,0,0),s.push(0,0,1),o.push(.5,.5);for(let n=0,c=3;n<=t;n++,c+=3){let d=i+n/t*r;l.x=e*Math.cos(d),l.y=e*Math.sin(d),a.push(l.x,l.y,l.z),s.push(0,0,1),u.x=(a[c]/e+1)/2,u.y=(a[c+1]/e+1)/2,o.push(u.x,u.y)}for(let e=1;e<=t;e++)n.push(e,e+1,0);this.setIndex(n),this.setAttribute("position",new nC(a,3)),this.setAttribute("normal",new nC(s,3)),this.setAttribute("uv",new nC(o,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new l1(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class l2 extends nF{constructor(e=1,t=1,i=1,r=32,n=1,a=!1,s=0,o=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:i,radialSegments:r,heightSegments:n,openEnded:a,thetaStart:s,thetaLength:o};let l=this;r=Math.floor(r),n=Math.floor(n);let u=[],c=[],d=[],h=[],f=0,p=[],m=i/2,g=0;function v(i){let n=f,a=new iD,p=new rt,v=0,y=!0===i?e:t,b=!0===i?1:-1;for(let e=1;e<=r;e++)c.push(0,m*b,0),d.push(0,b,0),h.push(.5,.5),f++;let _=f;for(let e=0;e<=r;e++){let t=e/r,i=t*o+s,n=Math.cos(i),l=Math.sin(i);p.x=y*l,p.y=m*b,p.z=y*n,c.push(p.x,p.y,p.z),d.push(0,b,0),a.x=.5*n+.5,a.y=.5*l*b+.5,h.push(a.x,a.y),f++}for(let e=0;e<r;e++){let t=n+e,r=_+e;!0===i?u.push(r,r+1,t):u.push(r+1,r,t),v+=3}l.addGroup(g,v,!0===i?1:2),g+=v}(function(){let a=new rt,v=new rt,y=0,b=(t-e)/i;for(let l=0;l<=n;l++){let u=[],g=l/n,y=g*(t-e)+e;for(let e=0;e<=r;e++){let t=e/r,n=t*o+s,l=Math.sin(n),p=Math.cos(n);v.x=y*l,v.y=-g*i+m,v.z=y*p,c.push(v.x,v.y,v.z),a.set(l,b,p).normalize(),d.push(a.x,a.y,a.z),h.push(t,1-g),u.push(f++)}p.push(u)}for(let e=0;e<r;e++)for(let t=0;t<n;t++){let i=p[t][e],r=p[t+1][e],n=p[t+1][e+1],a=p[t][e+1];u.push(i,r,a),u.push(r,n,a),y+=6}l.addGroup(g,y,0),g+=y})(),!1===a&&(e>0&&v(!0),t>0&&v(!1)),this.setIndex(u),this.setAttribute("position",new nC(c,3)),this.setAttribute("normal",new nC(d,3)),this.setAttribute("uv",new nC(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new l2(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class l3 extends l2{constructor(e=1,t=1,i=32,r=1,n=!1,a=0,s=2*Math.PI){super(0,e,t,i,r,n,a,s),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:i,heightSegments:r,openEnded:n,thetaStart:a,thetaLength:s}}static fromJSON(e){return new l3(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class l5 extends nF{constructor(e=[],t=[],i=1,r=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:i,detail:r};let n=[],a=[];function s(e){n.push(e.x,e.y,e.z)}function o(t,i){let r=3*t;i.x=e[r+0],i.y=e[r+1],i.z=e[r+2]}function l(e,t,i,r){r<0&&1===e.x&&(a[t]=e.x-1),0===i.x&&0===i.z&&(a[t]=r/2/Math.PI+.5)}function u(e){return Math.atan2(e.z,-e.x)}(function(e){let i=new rt,r=new rt,n=new rt;for(let a=0;a<t.length;a+=3)o(t[a+0],i),o(t[a+1],r),o(t[a+2],n),function(e,t,i,r){let n=r+1,a=[];for(let r=0;r<=n;r++){a[r]=[];let s=e.clone().lerp(i,r/n),o=t.clone().lerp(i,r/n),l=n-r;for(let e=0;e<=l;e++)0===e&&r===n?a[r][e]=s:a[r][e]=s.clone().lerp(o,e/l)}for(let e=0;e<n;e++)for(let t=0;t<2*(n-e)-1;t++){let i=Math.floor(t/2);t%2==0?(s(a[e][i+1]),s(a[e+1][i]),s(a[e][i])):(s(a[e][i+1]),s(a[e+1][i+1]),s(a[e+1][i]))}}(i,r,n,e)})(r),function(e){let t=new rt;for(let i=0;i<n.length;i+=3)t.x=n[i+0],t.y=n[i+1],t.z=n[i+2],t.normalize().multiplyScalar(e),n[i+0]=t.x,n[i+1]=t.y,n[i+2]=t.z}(i),function(){let e=new rt;for(let t=0;t<n.length;t+=3){e.x=n[t+0],e.y=n[t+1],e.z=n[t+2];let i=u(e)/2/Math.PI+.5,r=Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))/Math.PI+.5;a.push(i,1-r)}(function(){let e=new rt,t=new rt,i=new rt,r=new rt,s=new iD,o=new iD,c=new iD;for(let d=0,h=0;d<n.length;d+=9,h+=6){e.set(n[d+0],n[d+1],n[d+2]),t.set(n[d+3],n[d+4],n[d+5]),i.set(n[d+6],n[d+7],n[d+8]),s.set(a[h+0],a[h+1]),o.set(a[h+2],a[h+3]),c.set(a[h+4],a[h+5]),r.copy(e).add(t).add(i).divideScalar(3);let f=u(r);l(s,h+0,e,f),l(o,h+2,t,f),l(c,h+4,i,f)}})(),function(){for(let e=0;e<a.length;e+=6){let t=a[e+0],i=a[e+2],r=a[e+4],n=Math.max(t,i,r),s=Math.min(t,i,r);n>.9&&s<.1&&(t<.2&&(a[e+0]+=1),i<.2&&(a[e+2]+=1),r<.2&&(a[e+4]+=1))}}()}(),this.setAttribute("position",new nC(n,3)),this.setAttribute("normal",new nC(n.slice(),3)),this.setAttribute("uv",new nC(a,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new l5(e.vertices,e.indices,e.radius,e.details)}}class l4 extends l5{constructor(e=1,t=0){let i=(1+Math.sqrt(5))/2,r=1/i,n=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-i,0,-r,i,0,r,-i,0,r,i,-r,-i,0,-r,i,0,r,-i,0,r,i,0,-i,0,-r,i,0,-r,-i,0,r,i,0,r];super(n,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new l4(e.radius,e.detail)}}let l6=new rt,l8=new rt,l7=new rt,l9=new nn;class ue extends nF{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},null!==e){let i=Math.cos(iE*t),r=e.getIndex(),n=e.getAttribute("position"),a=r?r.count:n.count,s=[0,0,0],o=["a","b","c"],l=[,,,],u={},c=[];for(let e=0;e<a;e+=3){r?(s[0]=r.getX(e),s[1]=r.getX(e+1),s[2]=r.getX(e+2)):(s[0]=e,s[1]=e+1,s[2]=e+2);let{a:t,b:a,c:d}=l9;if(t.fromBufferAttribute(n,s[0]),a.fromBufferAttribute(n,s[1]),d.fromBufferAttribute(n,s[2]),l9.getNormal(l7),l[0]=`${Math.round(1e4*t.x)},${Math.round(1e4*t.y)},${Math.round(1e4*t.z)}`,l[1]=`${Math.round(1e4*a.x)},${Math.round(1e4*a.y)},${Math.round(1e4*a.z)}`,l[2]=`${Math.round(1e4*d.x)},${Math.round(1e4*d.y)},${Math.round(1e4*d.z)}`,l[0]!==l[1]&&l[1]!==l[2]&&l[2]!==l[0])for(let e=0;e<3;e++){let t=(e+1)%3,r=l[e],n=l[t],a=l9[o[e]],d=l9[o[t]],h=`${r}_${n}`,f=`${n}_${r}`;f in u&&u[f]?(l7.dot(u[f].normal)<=i&&(c.push(a.x,a.y,a.z),c.push(d.x,d.y,d.z)),u[f]=null):h in u||(u[h]={index0:s[e],index1:s[t],normal:l7.clone()})}}for(let e in u)if(u[e]){let{index0:t,index1:i}=u[e];l6.fromBufferAttribute(n,t),l8.fromBufferAttribute(n,i),c.push(l6.x,l6.y,l6.z),c.push(l8.x,l8.y,l8.z)}this.setAttribute("position",new nC(c,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class ut extends lJ{constructor(e){super(e),this.uuid=ix(),this.type="Shape",this.holes=[]}getPointsHoles(e){let t=[];for(let i=0,r=this.holes.length;i<r;i++)t[i]=this.holes[i].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){let e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,i=this.holes.length;t<i;t++){let i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,i=e.holes.length;t<i;t++){let i=e.holes[t];this.holes.push(new lJ().fromJSON(i))}return this}}let ui={triangulate:function(e,t,i=2){let r,n,a,s,o,l,u;let c=t&&t.length,d=c?t[0]*i:e.length,h=ur(e,0,d,i,!0),f=[];if(!h||h.next===h.prev)return f;if(c&&(h=function(e,t,i,r){let n,a,s,o,l;let u=[];for(n=0,a=t.length;n<a;n++)s=t[n]*r,o=n<a-1?t[n+1]*r:e.length,(l=ur(e,s,o,r,!1))===l.next&&(l.steiner=!0),u.push(function(e){let t=e,i=e;do(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next;while(t!==e);return i}(l));for(u.sort(ua),n=0;n<u.length;n++)i=function(e,t){let i=function(e,t){let i=t,r=-1/0,n,a=e.x,s=e.y;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){let e=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(e<=a&&e>r&&(r=e,n=i.x<i.next.x?i:i.next,e===a))return n}i=i.next}while(i!==t);if(!n)return null;let o=n,l=n.x,u=n.y,c=1/0,d;i=n;do{var h,f;a>=i.x&&i.x>=l&&a!==i.x&&uo(s<u?a:r,s,l,u,s<u?r:a,s,i.x,i.y)&&(d=Math.abs(s-i.y)/(a-i.x),uf(i,e)&&(d<c||d===c&&(i.x>n.x||i.x===n.x&&(h=n,f=i,0>ul(h.prev,h,f.prev)&&0>ul(f.next,h,h.next))))&&(n=i,c=d)),i=i.next}while(i!==o);return n}(e,t);if(!i)return t;let r=up(i,e);return un(r,r.next),un(i,i.next)}(u[n],i);return i}(e,t,h,i)),e.length>80*i){r=a=e[0],n=s=e[1];for(let t=i;t<d;t+=i)o=e[t],l=e[t+1],o<r&&(r=o),l<n&&(n=l),o>a&&(a=o),l>s&&(s=l);u=0!==(u=Math.max(a-r,s-n))?32767/u:0}return function e(t,i,r,n,a,s,o){if(!t)return;!o&&s&&function(e,t,i,r){let n=e;do 0===n.z&&(n.z=us(n.x,n.y,t,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next;while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){let t,i,r,n,a,s,o,l,u=1;do{for(i=e,e=null,a=null,s=0;i;){for(s++,r=i,o=0,t=0;t<u&&(o++,r=r.nextZ);t++);for(l=u;o>0||l>0&&r;)0!==o&&(0===l||!r||i.z<=r.z)?(n=i,i=i.nextZ,o--):(n=r,r=r.nextZ,l--),a?a.nextZ=n:e=n,n.prevZ=a,a=n;i=r}a.nextZ=null,u*=2}while(s>1)}(n)}(t,n,a,s);let l=t,u,c;for(;t.prev!==t.next;){if(u=t.prev,c=t.next,s?function(e,t,i,r){let n=e.prev,a=e.next;if(ul(n,e,a)>=0)return!1;let s=n.x,o=e.x,l=a.x,u=n.y,c=e.y,d=a.y,h=s<o?s<l?s:l:o<l?o:l,f=u<c?u<d?u:d:c<d?c:d,p=s>o?s>l?s:l:o>l?o:l,m=u>c?u>d?u:d:c>d?c:d,g=us(h,f,t,i,r),v=us(p,m,t,i,r),y=e.prevZ,b=e.nextZ;for(;y&&y.z>=g&&b&&b.z<=v;){if(y.x>=h&&y.x<=p&&y.y>=f&&y.y<=m&&y!==n&&y!==a&&uo(s,u,o,c,l,d,y.x,y.y)&&ul(y.prev,y,y.next)>=0||(y=y.prevZ,b.x>=h&&b.x<=p&&b.y>=f&&b.y<=m&&b!==n&&b!==a&&uo(s,u,o,c,l,d,b.x,b.y)&&ul(b.prev,b,b.next)>=0))return!1;b=b.nextZ}for(;y&&y.z>=g;){if(y.x>=h&&y.x<=p&&y.y>=f&&y.y<=m&&y!==n&&y!==a&&uo(s,u,o,c,l,d,y.x,y.y)&&ul(y.prev,y,y.next)>=0)return!1;y=y.prevZ}for(;b&&b.z<=v;){if(b.x>=h&&b.x<=p&&b.y>=f&&b.y<=m&&b!==n&&b!==a&&uo(s,u,o,c,l,d,b.x,b.y)&&ul(b.prev,b,b.next)>=0)return!1;b=b.nextZ}return!0}(t,n,a,s):function(e){let t=e.prev,i=e.next;if(ul(t,e,i)>=0)return!1;let r=t.x,n=e.x,a=i.x,s=t.y,o=e.y,l=i.y,u=r<n?r<a?r:a:n<a?n:a,c=s<o?s<l?s:l:o<l?o:l,d=r>n?r>a?r:a:n>a?n:a,h=s>o?s>l?s:l:o>l?o:l,f=i.next;for(;f!==t;){if(f.x>=u&&f.x<=d&&f.y>=c&&f.y<=h&&uo(r,s,n,o,a,l,f.x,f.y)&&ul(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}(t)){i.push(u.i/r|0),i.push(t.i/r|0),i.push(c.i/r|0),ug(t),t=c.next,l=c.next;continue}if((t=c)===l){o?1===o?e(t=function(e,t,i){let r=e;do{let n=r.prev,a=r.next.next;!uu(n,a)&&uc(n,r,r.next,a)&&uf(n,a)&&uf(a,n)&&(t.push(n.i/i|0),t.push(r.i/i|0),t.push(a.i/i|0),ug(r),ug(r.next),r=e=a),r=r.next}while(r!==e);return un(r)}(un(t),i,r),i,r,n,a,s,2):2===o&&function(t,i,r,n,a,s){let o=t;do{let t=o.next.next;for(;t!==o.prev;){var l,u;if(o.i!==t.i&&(l=o,u=t,l.next.i!==u.i&&l.prev.i!==u.i&&!function(e,t){let i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&uc(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(l,u)&&(uf(l,u)&&uf(u,l)&&function(e,t){let i=e,r=!1,n=(e.x+t.x)/2,a=(e.y+t.y)/2;do i.y>a!=i.next.y>a&&i.next.y!==i.y&&n<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==e);return r}(l,u)&&(ul(l.prev,l,u.prev)||ul(l,u.prev,u))||uu(l,u)&&ul(l.prev,l,l.next)>0&&ul(u.prev,u,u.next)>0))){let l=up(o,t);o=un(o,o.next),l=un(l,l.next),e(o,i,r,n,a,s,0),e(l,i,r,n,a,s,0);return}t=t.next}o=o.next}while(o!==t)}(t,i,r,n,a,s):e(un(t),i,r,n,a,s,1);break}}}(h,f,i,r,n,u,0),f}};function ur(e,t,i,r,n){let a,s;if(n===function(e,t,i,r){let n=0;for(let a=t,s=i-r;a<i;a+=r)n+=(e[s]-e[a])*(e[a+1]+e[s+1]),s=a;return n}(e,t,i,r)>0)for(a=t;a<i;a+=r)s=um(a,e[a],e[a+1],s);else for(a=i-r;a>=t;a-=r)s=um(a,e[a],e[a+1],s);return s&&uu(s,s.next)&&(ug(s),s=s.next),s}function un(e,t){if(!e)return e;t||(t=e);let i=e,r;do if(r=!1,!i.steiner&&(uu(i,i.next)||0===ul(i.prev,i,i.next))){if(ug(i),(i=t=i.prev)===i.next)break;r=!0}else i=i.next;while(r||i!==t);return t}function ua(e,t){return e.x-t.x}function us(e,t,i,r,n){return(e=((e=((e=((e=((e=(e-i)*n|0)|e<<8)&16711935)|e<<4)&252645135)|e<<2)&858993459)|e<<1)&1431655765)|(t=((t=((t=((t=((t=(t-r)*n|0)|t<<8)&16711935)|t<<4)&252645135)|t<<2)&858993459)|t<<1)&1431655765)<<1}function uo(e,t,i,r,n,a,s,o){return(n-s)*(t-o)>=(e-s)*(a-o)&&(e-s)*(r-o)>=(i-s)*(t-o)&&(i-s)*(a-o)>=(n-s)*(r-o)}function ul(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function uu(e,t){return e.x===t.x&&e.y===t.y}function uc(e,t,i,r){let n=uh(ul(e,t,i)),a=uh(ul(e,t,r)),s=uh(ul(i,r,e)),o=uh(ul(i,r,t));return!!(n!==a&&s!==o||0===n&&ud(e,i,t)||0===a&&ud(e,r,t)||0===s&&ud(i,e,r)||0===o&&ud(i,t,r))}function ud(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function uh(e){return e>0?1:e<0?-1:0}function uf(e,t){return 0>ul(e.prev,e,e.next)?ul(e,t,e.next)>=0&&ul(e,e.prev,t)>=0:0>ul(e,t,e.prev)||0>ul(e,e.next,t)}function up(e,t){let i=new uv(e.i,e.x,e.y),r=new uv(t.i,t.x,t.y),n=e.next,a=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,r.next=i,i.prev=r,a.next=r,r.prev=a,r}function um(e,t,i,r){let n=new uv(e,t,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function ug(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function uv(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}class uy{static area(e){let t=e.length,i=0;for(let r=t-1,n=0;n<t;r=n++)i+=e[r].x*e[n].y-e[n].x*e[r].y;return .5*i}static isClockWise(e){return 0>uy.area(e)}static triangulateShape(e,t){let i=[],r=[],n=[];ub(e),u_(i,e);let a=e.length;t.forEach(ub);for(let e=0;e<t.length;e++)r.push(a),a+=t[e].length,u_(i,t[e]);let s=ui.triangulate(i,r);for(let e=0;e<s.length;e+=3)n.push(s.slice(e,e+3));return n}}function ub(e){let t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function u_(e,t){for(let i=0;i<t.length;i++)e.push(t[i].x),e.push(t[i].y)}class uE extends nF{constructor(e=new ut([new iD(.5,.5),new iD(-.5,.5),new iD(-.5,-.5),new iD(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];let i=this,r=[],n=[];for(let a=0,s=e.length;a<s;a++){let s=e[a];!function(e){let a,s,o,l;let u=[],c=void 0!==t.curveSegments?t.curveSegments:12,d=void 0!==t.steps?t.steps:1,h=void 0!==t.depth?t.depth:1,f=void 0===t.bevelEnabled||t.bevelEnabled,p=void 0!==t.bevelThickness?t.bevelThickness:.2,m=void 0!==t.bevelSize?t.bevelSize:p-.1,g=void 0!==t.bevelOffset?t.bevelOffset:0,v=void 0!==t.bevelSegments?t.bevelSegments:3,y=t.extrudePath,b=void 0!==t.UVGenerator?t.UVGenerator:uS,_,E=!1;y&&(_=y.getSpacedPoints(d),E=!0,f=!1,a=y.computeFrenetFrames(d,!1),s=new rt,o=new rt,l=new rt),f||(v=0,p=0,m=0,g=0);let S=e.extractPoints(c),x=S.shape,T=S.holes,w=!uy.isClockWise(x);if(w){x=x.reverse();for(let e=0,t=T.length;e<t;e++){let t=T[e];uy.isClockWise(t)&&(T[e]=t.reverse())}}let A=uy.triangulateShape(x,T),M=x;for(let e=0,t=T.length;e<t;e++){let t=T[e];x=x.concat(t)}function R(e,t,i){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().addScaledVector(t,i)}let C=x.length,I=A.length;function L(e,t,i){let r,n,a;let s=e.x-t.x,o=e.y-t.y,l=i.x-e.x,u=i.y-e.y,c=s*s+o*o,d=s*u-o*l;if(Math.abs(d)>Number.EPSILON){let d=Math.sqrt(c),h=Math.sqrt(l*l+u*u),f=t.x-o/d,p=t.y+s/d,m=i.x-u/h,g=i.y+l/h,v=((m-f)*u-(g-p)*l)/(s*u-o*l);r=f+s*v-e.x,n=p+o*v-e.y;let y=r*r+n*n;if(y<=2)return new iD(r,n);a=Math.sqrt(y/2)}else{let e=!1;s>Number.EPSILON?l>Number.EPSILON&&(e=!0):s<-Number.EPSILON?l<-Number.EPSILON&&(e=!0):Math.sign(o)===Math.sign(u)&&(e=!0),e?(r=-o,n=s,a=Math.sqrt(c)):(r=s,n=o,a=Math.sqrt(c/2))}return new iD(r/a,n/a)}let k=[];for(let e=0,t=M.length,i=t-1,r=e+1;e<t;e++,i++,r++)i===t&&(i=0),r===t&&(r=0),k[e]=L(M[e],M[i],M[r]);let D=[],P,O=k.concat();for(let e=0,t=T.length;e<t;e++){let t=T[e];P=[];for(let e=0,i=t.length,r=i-1,n=e+1;e<i;e++,r++,n++)r===i&&(r=0),n===i&&(n=0),P[e]=L(t[e],t[r],t[n]);D.push(P),O=O.concat(P)}for(let e=0;e<v;e++){let t=e/v,i=p*Math.cos(t*Math.PI/2),r=m*Math.sin(t*Math.PI/2)+g;for(let e=0,t=M.length;e<t;e++){let t=R(M[e],k[e],r);F(t.x,t.y,-i)}for(let e=0,t=T.length;e<t;e++){let t=T[e];P=D[e];for(let e=0,n=t.length;e<n;e++){let n=R(t[e],P[e],r);F(n.x,n.y,-i)}}}let N=m+g;for(let e=0;e<C;e++){let t=f?R(x[e],O[e],N):x[e];E?(o.copy(a.normals[0]).multiplyScalar(t.x),s.copy(a.binormals[0]).multiplyScalar(t.y),l.copy(_[0]).add(o).add(s),F(l.x,l.y,l.z)):F(t.x,t.y,0)}for(let e=1;e<=d;e++)for(let t=0;t<C;t++){let i=f?R(x[t],O[t],N):x[t];E?(o.copy(a.normals[e]).multiplyScalar(i.x),s.copy(a.binormals[e]).multiplyScalar(i.y),l.copy(_[e]).add(o).add(s),F(l.x,l.y,l.z)):F(i.x,i.y,h/d*e)}for(let e=v-1;e>=0;e--){let t=e/v,i=p*Math.cos(t*Math.PI/2),r=m*Math.sin(t*Math.PI/2)+g;for(let e=0,t=M.length;e<t;e++){let t=R(M[e],k[e],r);F(t.x,t.y,h+i)}for(let e=0,t=T.length;e<t;e++){let t=T[e];P=D[e];for(let e=0,n=t.length;e<n;e++){let n=R(t[e],P[e],r);E?F(n.x,n.y+_[d-1].y,_[d-1].x+i):F(n.x,n.y,h+i)}}}function U(e,t){let n=e.length;for(;--n>=0;){let a=n,s=n-1;s<0&&(s=e.length-1);for(let e=0,n=d+2*v;e<n;e++){let n=C*e,o=C*(e+1),l=t+a+n,u=t+s+n,c=t+s+o,d=t+a+o;!function(e,t,n,a){V(e),V(t),V(a),V(t),V(n),V(a);let s=r.length/3,o=b.generateSideWallUV(i,r,s-6,s-3,s-2,s-1);z(o[0]),z(o[1]),z(o[3]),z(o[1]),z(o[2]),z(o[3])}(l,u,c,d)}}}function F(e,t,i){u.push(e),u.push(t),u.push(i)}function B(e,t,n){V(e),V(t),V(n);let a=r.length/3,s=b.generateTopUV(i,r,a-3,a-2,a-1);z(s[0]),z(s[1]),z(s[2])}function V(e){r.push(u[3*e+0]),r.push(u[3*e+1]),r.push(u[3*e+2])}function z(e){n.push(e.x),n.push(e.y)}(function(){let e=r.length/3;if(f){let e=0*C;for(let t=0;t<I;t++){let i=A[t];B(i[2]+e,i[1]+e,i[0]+e)}e=C*(d+2*v);for(let t=0;t<I;t++){let i=A[t];B(i[0]+e,i[1]+e,i[2]+e)}}else{for(let e=0;e<I;e++){let t=A[e];B(t[2],t[1],t[0])}for(let e=0;e<I;e++){let t=A[e];B(t[0]+C*d,t[1]+C*d,t[2]+C*d)}}i.addGroup(e,r.length/3-e,0)})(),function(){let e=r.length/3,t=0;U(M,0),t+=M.length;for(let e=0,i=T.length;e<i;e++){let i=T[e];U(i,t),t+=i.length}i.addGroup(e,r.length/3-e,1)}()}(s)}this.setAttribute("position",new nC(r,3)),this.setAttribute("uv",new nC(n,2)),this.computeVertexNormals()}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes,i=this.parameters.options;return function(e,t,i){if(i.shapes=[],Array.isArray(e))for(let t=0,r=e.length;t<r;t++){let r=e[t];i.shapes.push(r.uuid)}else i.shapes.push(e.uuid);return i.options=Object.assign({},t),void 0!==t.extrudePath&&(i.options.extrudePath=t.extrudePath.toJSON()),i}(t,i,e)}static fromJSON(e,t){let i=[];for(let r=0,n=e.shapes.length;r<n;r++){let n=t[e.shapes[r]];i.push(n)}let r=e.options.extrudePath;return void 0!==r&&(e.options.extrudePath=new lX[r.type]().fromJSON(r)),new uE(i,e.options)}}let uS={generateTopUV:function(e,t,i,r,n){let a=t[3*i],s=t[3*i+1],o=t[3*r],l=t[3*r+1],u=t[3*n],c=t[3*n+1];return[new iD(a,s),new iD(o,l),new iD(u,c)]},generateSideWallUV:function(e,t,i,r,n,a){let s=t[3*i],o=t[3*i+1],l=t[3*i+2],u=t[3*r],c=t[3*r+1],d=t[3*r+2],h=t[3*n],f=t[3*n+1],p=t[3*n+2],m=t[3*a],g=t[3*a+1],v=t[3*a+2];return Math.abs(o-c)<Math.abs(s-u)?[new iD(s,1-l),new iD(u,1-d),new iD(h,1-p),new iD(m,1-v)]:[new iD(o,1-l),new iD(c,1-d),new iD(f,1-p),new iD(g,1-v)]}};class ux extends l5{constructor(e=1,t=0){let i=(1+Math.sqrt(5))/2,r=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];super(r,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new ux(e.radius,e.detail)}}class uT extends l5{constructor(e=1,t=0){super([1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new uT(e.radius,e.detail)}}class uw extends nF{constructor(e=.5,t=1,i=32,r=1,n=0,a=2*Math.PI){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:i,phiSegments:r,thetaStart:n,thetaLength:a},i=Math.max(3,i),r=Math.max(1,r);let s=[],o=[],l=[],u=[],c=e,d=(t-e)/r,h=new rt,f=new iD;for(let e=0;e<=r;e++){for(let e=0;e<=i;e++){let r=n+e/i*a;h.x=c*Math.cos(r),h.y=c*Math.sin(r),o.push(h.x,h.y,h.z),l.push(0,0,1),f.x=(h.x/t+1)/2,f.y=(h.y/t+1)/2,u.push(f.x,f.y)}c+=d}for(let e=0;e<r;e++){let t=e*(i+1);for(let e=0;e<i;e++){let r=e+t,n=r+i+1,a=r+i+2,o=r+1;s.push(r,n,o),s.push(n,a,o)}}this.setIndex(s),this.setAttribute("position",new nC(o,3)),this.setAttribute("normal",new nC(l,3)),this.setAttribute("uv",new nC(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uw(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class uA extends nF{constructor(e=new ut([new iD(0,.5),new iD(-.5,-.5),new iD(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};let i=[],r=[],n=[],a=[],s=0,o=0;if(!1===Array.isArray(e))l(e);else for(let t=0;t<e.length;t++)l(e[t]),this.addGroup(s,o,t),s+=o,o=0;function l(e){let s=r.length/3,l=e.extractPoints(t),u=l.shape,c=l.holes;!1===uy.isClockWise(u)&&(u=u.reverse());for(let e=0,t=c.length;e<t;e++){let t=c[e];!0===uy.isClockWise(t)&&(c[e]=t.reverse())}let d=uy.triangulateShape(u,c);for(let e=0,t=c.length;e<t;e++){let t=c[e];u=u.concat(t)}for(let e=0,t=u.length;e<t;e++){let t=u[e];r.push(t.x,t.y,0),n.push(0,0,1),a.push(t.x,t.y)}for(let e=0,t=d.length;e<t;e++){let t=d[e],r=t[0]+s,n=t[1]+s,a=t[2]+s;i.push(r,n,a),o+=3}}this.setIndex(i),this.setAttribute("position",new nC(r,3)),this.setAttribute("normal",new nC(n,3)),this.setAttribute("uv",new nC(a,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON(),t=this.parameters.shapes;return function(e,t){if(t.shapes=[],Array.isArray(e))for(let i=0,r=e.length;i<r;i++){let r=e[i];t.shapes.push(r.uuid)}else t.shapes.push(e.uuid);return t}(t,e)}static fromJSON(e,t){let i=[];for(let r=0,n=e.shapes.length;r<n;r++){let n=t[e.shapes[r]];i.push(n)}return new uA(i,e.curveSegments)}}class uM extends nF{constructor(e=1,t=32,i=16,r=0,n=2*Math.PI,a=0,s=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:i,phiStart:r,phiLength:n,thetaStart:a,thetaLength:s},t=Math.max(3,Math.floor(t)),i=Math.max(2,Math.floor(i));let o=Math.min(a+s,Math.PI),l=0,u=[],c=new rt,d=new rt,h=[],f=[],p=[],m=[];for(let h=0;h<=i;h++){let g=[],v=h/i,y=0;0===h&&0===a?y=.5/t:h===i&&o===Math.PI&&(y=-.5/t);for(let i=0;i<=t;i++){let o=i/t;c.x=-e*Math.cos(r+o*n)*Math.sin(a+v*s),c.y=e*Math.cos(a+v*s),c.z=e*Math.sin(r+o*n)*Math.sin(a+v*s),f.push(c.x,c.y,c.z),d.copy(c).normalize(),p.push(d.x,d.y,d.z),m.push(o+y,1-v),g.push(l++)}u.push(g)}for(let e=0;e<i;e++)for(let r=0;r<t;r++){let t=u[e][r+1],n=u[e][r],s=u[e+1][r],l=u[e+1][r+1];(0!==e||a>0)&&h.push(t,n,l),(e!==i-1||o<Math.PI)&&h.push(n,s,l)}this.setIndex(h),this.setAttribute("position",new nC(f,3)),this.setAttribute("normal",new nC(p,3)),this.setAttribute("uv",new nC(m,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uM(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class uR extends l5{constructor(e=1,t=0){super([1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new uR(e.radius,e.detail)}}class uC extends nF{constructor(e=1,t=.4,i=12,r=48,n=2*Math.PI){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:i,tubularSegments:r,arc:n},i=Math.floor(i),r=Math.floor(r);let a=[],s=[],o=[],l=[],u=new rt,c=new rt,d=new rt;for(let a=0;a<=i;a++)for(let h=0;h<=r;h++){let f=h/r*n,p=a/i*Math.PI*2;c.x=(e+t*Math.cos(p))*Math.cos(f),c.y=(e+t*Math.cos(p))*Math.sin(f),c.z=t*Math.sin(p),s.push(c.x,c.y,c.z),u.x=e*Math.cos(f),u.y=e*Math.sin(f),d.subVectors(c,u).normalize(),o.push(d.x,d.y,d.z),l.push(h/r),l.push(a/i)}for(let e=1;e<=i;e++)for(let t=1;t<=r;t++){let i=(r+1)*e+t-1,n=(r+1)*(e-1)+t-1,s=(r+1)*(e-1)+t,o=(r+1)*e+t;a.push(i,n,o),a.push(n,s,o)}this.setIndex(a),this.setAttribute("position",new nC(s,3)),this.setAttribute("normal",new nC(o,3)),this.setAttribute("uv",new nC(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uC(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class uI extends nF{constructor(e=1,t=.4,i=64,r=8,n=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:i,radialSegments:r,p:n,q:a},i=Math.floor(i),r=Math.floor(r);let s=[],o=[],l=[],u=[],c=new rt,d=new rt,h=new rt,f=new rt,p=new rt,m=new rt,g=new rt;for(let s=0;s<=i;++s){let y=s/i*n*Math.PI*2;v(y,n,a,e,h),v(y+.01,n,a,e,f),m.subVectors(f,h),g.addVectors(f,h),p.crossVectors(m,g),g.crossVectors(p,m),p.normalize(),g.normalize();for(let e=0;e<=r;++e){let n=e/r*Math.PI*2,a=-t*Math.cos(n),f=t*Math.sin(n);c.x=h.x+(a*g.x+f*p.x),c.y=h.y+(a*g.y+f*p.y),c.z=h.z+(a*g.z+f*p.z),o.push(c.x,c.y,c.z),d.subVectors(c,h).normalize(),l.push(d.x,d.y,d.z),u.push(s/i),u.push(e/r)}}for(let e=1;e<=i;e++)for(let t=1;t<=r;t++){let i=(r+1)*(e-1)+(t-1),n=(r+1)*e+(t-1),a=(r+1)*e+t,o=(r+1)*(e-1)+t;s.push(i,n,o),s.push(n,a,o)}function v(e,t,i,r,n){let a=i/t*e,s=Math.cos(a);n.x=r*(2+s)*.5*Math.cos(e),n.y=r*(2+s)*Math.sin(e)*.5,n.z=r*Math.sin(a)*.5}this.setIndex(s),this.setAttribute("position",new nC(o,3)),this.setAttribute("normal",new nC(l,3)),this.setAttribute("uv",new nC(u,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new uI(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class uL extends nF{constructor(e=new lY(new rt(-1,-1,0),new rt(-1,1,0),new rt(1,1,0)),t=64,i=1,r=8,n=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:i,radialSegments:r,closed:n};let a=e.computeFrenetFrames(t,n);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;let s=new rt,o=new rt,l=new iD,u=new rt,c=[],d=[],h=[],f=[];function p(n){u=e.getPointAt(n/t,u);let l=a.normals[n],h=a.binormals[n];for(let e=0;e<=r;e++){let t=e/r*Math.PI*2,n=Math.sin(t),a=-Math.cos(t);o.x=a*l.x+n*h.x,o.y=a*l.y+n*h.y,o.z=a*l.z+n*h.z,o.normalize(),d.push(o.x,o.y,o.z),s.x=u.x+i*o.x,s.y=u.y+i*o.y,s.z=u.z+i*o.z,c.push(s.x,s.y,s.z)}}(function(){for(let e=0;e<t;e++)p(e);p(!1===n?t:0),function(){for(let e=0;e<=t;e++)for(let i=0;i<=r;i++)l.x=e/t,l.y=i/r,h.push(l.x,l.y)}(),function(){for(let e=1;e<=t;e++)for(let t=1;t<=r;t++){let i=(r+1)*(e-1)+(t-1),n=(r+1)*e+(t-1),a=(r+1)*e+t,s=(r+1)*(e-1)+t;f.push(i,n,s),f.push(n,a,s)}}()})(),this.setIndex(f),this.setAttribute("position",new nC(c,3)),this.setAttribute("normal",new nC(d,3)),this.setAttribute("uv",new nC(h,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new uL(new lX[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class uk extends nF{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},null!==e){let t=[],i=new Set,r=new rt,n=new rt;if(null!==e.index){let a=e.attributes.position,s=e.index,o=e.groups;0===o.length&&(o=[{start:0,count:s.count,materialIndex:0}]);for(let e=0,l=o.length;e<l;++e){let l=o[e],u=l.start,c=l.count;for(let e=u,o=u+c;e<o;e+=3)for(let o=0;o<3;o++){let l=s.getX(e+o),u=s.getX(e+(o+1)%3);r.fromBufferAttribute(a,l),n.fromBufferAttribute(a,u),!0===uD(r,n,i)&&(t.push(r.x,r.y,r.z),t.push(n.x,n.y,n.z))}}}else{let a=e.attributes.position;for(let e=0,s=a.count/3;e<s;e++)for(let s=0;s<3;s++){let o=3*e+s,l=3*e+(s+1)%3;r.fromBufferAttribute(a,o),n.fromBufferAttribute(a,l),!0===uD(r,n,i)&&(t.push(r.x,r.y,r.z),t.push(n.x,n.y,n.z))}}this.setAttribute("position",new nC(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function uD(e,t,i){let r=`${e.x},${e.y},${e.z}-${t.x},${t.y},${t.z}`,n=`${t.x},${t.y},${t.z}-${e.x},${e.y},${e.z}`;return!0!==i.has(r)&&!0!==i.has(n)&&(i.add(r),i.add(n),!0)}var uP=Object.freeze({__proto__:null,BoxGeometry:n5,CapsuleGeometry:l0,CircleGeometry:l1,ConeGeometry:l3,CylinderGeometry:l2,DodecahedronGeometry:l4,EdgesGeometry:ue,ExtrudeGeometry:uE,IcosahedronGeometry:ux,LatheGeometry:lQ,OctahedronGeometry:uT,PlaneGeometry:ap,PolyhedronGeometry:l5,RingGeometry:uw,ShapeGeometry:uA,SphereGeometry:uM,TetrahedronGeometry:uR,TorusGeometry:uC,TorusKnotGeometry:uI,TubeGeometry:uL,WireframeGeometry:uk});class uO extends ns{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new nd(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class uN extends n9{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class uU extends ns{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new nd(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nd(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tO,this.normalScale=new iD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uF extends uU{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new iD(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return iT(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new nd(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new nd(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new nd(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class uB extends ns{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new nd(16777215),this.specular=new nd(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nd(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tO,this.normalScale=new iD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uV extends ns{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new nd(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nd(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tO,this.normalScale=new iD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class uz extends ns{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tO,this.normalScale=new iD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class uj extends ns{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new nd(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new nd(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tO,this.normalScale=new iD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Q,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uH extends ns{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new nd(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=tO,this.normalScale=new iD(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.flatShading=e.flatShading,this.fog=e.fog,this}}class uG extends lo{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function uW(e,t,i){return uq(e)?new e.constructor(e.subarray(t,void 0!==i?i:e.length)):e.slice(t,i)}function u$(e,t,i){return e&&(i||e.constructor!==t)?"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e):e}function uq(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function uY(e){let t=e.length,i=Array(t);for(let e=0;e!==t;++e)i[e]=e;return i.sort(function(t,i){return e[t]-e[i]}),i}function uK(e,t,i){let r=e.length,n=new e.constructor(r);for(let a=0,s=0;s!==r;++a){let r=i[a]*t;for(let i=0;i!==t;++i)n[s++]=e[r+i]}return n}function uX(e,t,i,r){let n=1,a=e[0];for(;void 0!==a&&void 0===a[r];)a=e[n++];if(void 0===a)return;let s=a[r];if(void 0!==s){if(Array.isArray(s))do void 0!==(s=a[r])&&(t.push(a.time),i.push.apply(i,s)),a=e[n++];while(void 0!==a);else if(void 0!==s.toArray)do void 0!==(s=a[r])&&(t.push(a.time),s.toArray(i,i.length)),a=e[n++];while(void 0!==a);else do void 0!==(s=a[r])&&(t.push(a.time),i.push(s)),a=e[n++];while(void 0!==a)}}let uZ={arraySlice:uW,convertArray:u$,isTypedArray:uq,getKeyframeOrder:uY,sortedArray:uK,flattenJSON:uX,subclip:function(e,t,i,r,n=30){let a=e.clone();a.name=t;let s=[];for(let e=0;e<a.tracks.length;++e){let t=a.tracks[e],o=t.getValueSize(),l=[],u=[];for(let e=0;e<t.times.length;++e){let a=t.times[e]*n;if(!(a<i)&&!(a>=r)){l.push(t.times[e]);for(let i=0;i<o;++i)u.push(t.values[e*o+i])}}0!==l.length&&(t.times=u$(l,t.times.constructor),t.values=u$(u,t.values.constructor),s.push(t))}a.tracks=s;let o=1/0;for(let e=0;e<a.tracks.length;++e)o>a.tracks[e].times[0]&&(o=a.tracks[e].times[0]);for(let e=0;e<a.tracks.length;++e)a.tracks[e].shift(-1*o);return a.resetDuration(),a},makeClipAdditive:function(e,t=0,i=e,r=30){r<=0&&(r=30);let n=i.tracks.length,a=t/r;for(let t=0;t<n;++t){let r;let n=i.tracks[t],s=n.ValueTypeName;if("bool"===s||"string"===s)continue;let o=e.tracks.find(function(e){return e.name===n.name&&e.ValueTypeName===s});if(void 0===o)continue;let l=0,u=n.getValueSize();n.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(l=u/3);let c=0,d=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(c=d/3);let h=n.times.length-1;if(a<=n.times[0]){let e=l,t=u-l;r=uW(n.values,e,t)}else if(a>=n.times[h]){let e=h*u+l,t=e+u-l;r=uW(n.values,e,t)}else{let e=n.createInterpolant(),t=l,i=u-l;e.evaluate(a),r=uW(e.resultBuffer,t,i)}if("quaternion"===s){let e=new re().fromArray(r).normalize().conjugate();e.toArray(r)}let f=o.times.length;for(let e=0;e<f;++e){let t=e*d+c;if("quaternion"===s)re.multiplyQuaternionsFlat(o.values,t,r,0,o.values,t);else{let e=d-2*c;for(let i=0;i<e;++i)o.values[t+i]-=r[i]}}}return e.blendMode=tM,e}};class uJ{constructor(e,t,i,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(i),this.sampleValues=t,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(e){let t=this.parameterPositions,i=this._cachedIndex,r=t[i],n=t[i-1];i:{r:{let a;n:{a:if(!(e<r)){for(let a=i+2;;){if(void 0===r){if(e<n)break a;return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===a)break;if(n=r,e<(r=t[++i]))break r}a=t.length;break n}if(!(e>=n)){let s=t[1];e<s&&(i=2,n=s);for(let a=i-2;;){if(void 0===n)return this._cachedIndex=0,this.copySampleValue_(0);if(i===a)break;if(r=n,e>=(n=t[--i-1]))break r}a=i,i=0;break n}break i}for(;i<a;){let r=i+a>>>1;e<t[r]?a=r:i=r+1}if(r=t[i],void 0===(n=t[i-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return i=t.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,n,r)}return this.interpolate_(i,n,e,r)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let t=this.resultBuffer,i=this.sampleValues,r=this.valueSize,n=e*r;for(let e=0;e!==r;++e)t[e]=i[n+e];return t}interpolate_(){throw Error("call to abstract method")}intervalChanged_(){}}class uQ extends uJ{constructor(e,t,i,r){super(e,t,i,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:tx,endingEnd:tx}}intervalChanged_(e,t,i){let r=this.parameterPositions,n=e-2,a=e+1,s=r[n],o=r[a];if(void 0===s)switch(this.getSettings_().endingStart){case tT:n=e,s=2*t-i;break;case tw:n=r.length-2,s=t+r[n]-r[n+1];break;default:n=e,s=i}if(void 0===o)switch(this.getSettings_().endingEnd){case tT:a=e,o=2*i-t;break;case tw:a=1,o=i+r[1]-r[0];break;default:a=e-1,o=t}let l=(i-t)*.5,u=this.valueSize;this._weightPrev=l/(t-s),this._weightNext=l/(o-i),this._offsetPrev=n*u,this._offsetNext=a*u}interpolate_(e,t,i,r){let n=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,u=this._offsetPrev,c=this._offsetNext,d=this._weightPrev,h=this._weightNext,f=(i-t)/(r-t),p=f*f,m=p*f,g=-d*m+2*d*p-d*f,v=(1+d)*m+(-1.5-2*d)*p+(-.5+d)*f+1,y=(-1-h)*m+(1.5+h)*p+.5*f,b=h*m-h*p;for(let e=0;e!==s;++e)n[e]=g*a[u+e]+v*a[l+e]+y*a[o+e]+b*a[c+e];return n}}class u0 extends uJ{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){let n=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=e*s,l=o-s,u=(i-t)/(r-t),c=1-u;for(let e=0;e!==s;++e)n[e]=a[l+e]*c+a[o+e]*u;return n}}class u1 extends uJ{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e){return this.copySampleValue_(e-1)}}class u2{constructor(e,t,i,r){if(void 0===e)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===t||0===t.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=u$(t,this.TimeBufferType),this.values=u$(i,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation)}static toJSON(e){let t;let i=e.constructor;if(i.toJSON!==this.toJSON)t=i.toJSON(e);else{t={name:e.name,times:u$(e.times,Array),values:u$(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(t.interpolation=i)}return t.type=e.ValueTypeName,t}InterpolantFactoryMethodDiscrete(e){return new u1(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new u0(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new uQ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case t_:t=this.InterpolantFactoryMethodDiscrete;break;case tE:t=this.InterpolantFactoryMethodLinear;break;case tS:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){let t="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(t)}return console.warn("THREE.KeyframeTrack:",t),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return t_;case this.InterpolantFactoryMethodLinear:return tE;case this.InterpolantFactoryMethodSmooth:return tS}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){let t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]+=e}return this}scale(e){if(1!==e){let t=this.times;for(let i=0,r=t.length;i!==r;++i)t[i]*=e}return this}trim(e,t){let i=this.times,r=i.length,n=0,a=r-1;for(;n!==r&&i[n]<e;)++n;for(;-1!==a&&i[a]>t;)--a;if(++a,0!==n||a!==r){n>=a&&(n=(a=Math.max(a,1))-1);let e=this.getValueSize();this.times=uW(i,n,a),this.values=uW(this.values,n*e,a*e)}return this}validate(){let e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);let i=this.times,r=this.values,n=i.length;0===n&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let t=0;t!==n;t++){let r=i[t];if("number"==typeof r&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,t,r),e=!1;break}if(null!==a&&a>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,t,r,a),e=!1;break}a=r}if(void 0!==r&&uq(r))for(let t=0,i=r.length;t!==i;++t){let i=r[t];if(isNaN(i)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,t,i),e=!1;break}}return e}optimize(){let e=uW(this.times),t=uW(this.values),i=this.getValueSize(),r=this.getInterpolation()===tS,n=e.length-1,a=1;for(let s=1;s<n;++s){let n=!1,o=e[s],l=e[s+1];if(o!==l&&(1!==s||o!==e[0])){if(r)n=!0;else{let e=s*i,r=e-i,a=e+i;for(let s=0;s!==i;++s){let i=t[e+s];if(i!==t[r+s]||i!==t[a+s]){n=!0;break}}}}if(n){if(s!==a){e[a]=e[s];let r=s*i,n=a*i;for(let e=0;e!==i;++e)t[n+e]=t[r+e]}++a}}if(n>0){e[a]=e[n];for(let e=n*i,r=a*i,s=0;s!==i;++s)t[r+s]=t[e+s];++a}return a!==e.length?(this.times=uW(e,0,a),this.values=uW(t,0,a*i)):(this.times=e,this.values=t),this}clone(){let e=uW(this.times,0),t=uW(this.values,0),i=this.constructor,r=new i(this.name,e,t);return r.createInterpolant=this.createInterpolant,r}}u2.prototype.TimeBufferType=Float32Array,u2.prototype.ValueBufferType=Float32Array,u2.prototype.DefaultInterpolation=tE;class u3 extends u2{}u3.prototype.ValueTypeName="bool",u3.prototype.ValueBufferType=Array,u3.prototype.DefaultInterpolation=t_,u3.prototype.InterpolantFactoryMethodLinear=void 0,u3.prototype.InterpolantFactoryMethodSmooth=void 0;class u5 extends u2{}u5.prototype.ValueTypeName="color";class u4 extends u2{}u4.prototype.ValueTypeName="number";class u6 extends uJ{constructor(e,t,i,r){super(e,t,i,r)}interpolate_(e,t,i,r){let n=this.resultBuffer,a=this.sampleValues,s=this.valueSize,o=(i-t)/(r-t),l=e*s;for(let e=l+s;l!==e;l+=4)re.slerpFlat(n,0,a,l-s,a,l,o);return n}}class u8 extends u2{InterpolantFactoryMethodLinear(e){return new u6(this.times,this.values,this.getValueSize(),e)}}u8.prototype.ValueTypeName="quaternion",u8.prototype.DefaultInterpolation=tE,u8.prototype.InterpolantFactoryMethodSmooth=void 0;class u7 extends u2{}u7.prototype.ValueTypeName="string",u7.prototype.ValueBufferType=Array,u7.prototype.DefaultInterpolation=t_,u7.prototype.InterpolantFactoryMethodLinear=void 0,u7.prototype.InterpolantFactoryMethodSmooth=void 0;class u9 extends u2{}u9.prototype.ValueTypeName="vector";class ce{constructor(e,t=-1,i,r=tA){this.name=e,this.tracks=i,this.duration=t,this.blendMode=r,this.uuid=ix(),this.duration<0&&this.resetDuration()}static parse(e){let t=[],i=e.tracks,r=1/(e.fps||1);for(let e=0,n=i.length;e!==n;++e)t.push((function(e){if(void 0===e.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");let t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return u4;case"vector":case"vector2":case"vector3":case"vector4":return u9;case"color":return u5;case"quaternion":return u8;case"bool":case"boolean":return u3;case"string":return u7}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){let t=[],i=[];uX(e.keys,t,i,"value"),e.times=t,e.values=i}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)})(i[e]).scale(r));let n=new this(e.name,e.duration,t,e.blendMode);return n.uuid=e.uuid,n}static toJSON(e){let t=[],i=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,r=i.length;e!==r;++e)t.push(u2.toJSON(i[e]));return r}static CreateFromMorphTargetSequence(e,t,i,r){let n=t.length,a=[];for(let e=0;e<n;e++){let s=[],o=[];s.push((e+n-1)%n,e,(e+1)%n),o.push(0,1,0);let l=uY(s);s=uK(s,1,l),o=uK(o,1,l),r||0!==s[0]||(s.push(n),o.push(o[0])),a.push(new u4(".morphTargetInfluences["+t[e].name+"]",s,o).scale(1/i))}return new this(e,-1,a)}static findByName(e,t){let i=e;Array.isArray(e)||(i=e.geometry&&e.geometry.animations||e.animations);for(let e=0;e<i.length;e++)if(i[e].name===t)return i[e];return null}static CreateClipsFromMorphTargetSequences(e,t,i){let r={},n=/^([\w-]*?)([\d]+)$/;for(let t=0,i=e.length;t<i;t++){let i=e[t],a=i.name.match(n);if(a&&a.length>1){let e=a[1],t=r[e];t||(r[e]=t=[]),t.push(i)}}let a=[];for(let e in r)a.push(this.CreateFromMorphTargetSequence(e,r[e],t,i));return a}static parseAnimation(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let i=function(e,t,i,r,n){if(0!==i.length){let a=[],s=[];uX(i,a,s,r),0!==a.length&&n.push(new e(t,a,s))}},r=[],n=e.name||"default",a=e.fps||30,s=e.blendMode,o=e.length||-1,l=e.hierarchy||[];for(let e=0;e<l.length;e++){let n=l[e].keys;if(n&&0!==n.length){if(n[0].morphTargets){let e;let t={};for(e=0;e<n.length;e++)if(n[e].morphTargets)for(let i=0;i<n[e].morphTargets.length;i++)t[n[e].morphTargets[i]]=-1;for(let i in t){let t=[],a=[];for(let r=0;r!==n[e].morphTargets.length;++r){let r=n[e];t.push(r.time),a.push(r.morphTarget===i?1:0)}r.push(new u4(".morphTargetInfluence["+i+"]",t,a))}o=t.length*a}else{let a=".bones["+t[e].name+"]";i(u9,a+".position",n,"pos",r),i(u8,a+".quaternion",n,"rot",r),i(u9,a+".scale",n,"scl",r)}}}if(0===r.length)return null;let u=new this(n,o,r,s);return u}resetDuration(){let e=this.tracks,t=0;for(let i=0,r=e.length;i!==r;++i){let e=this.tracks[i];t=Math.max(t,e.times[e.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}let ct={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};class ci{constructor(e,t,i){let r;let n=this,a=!1,s=0,o=0,l=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=i,this.itemStart=function(e){o++,!1===a&&void 0!==n.onStart&&n.onStart(e,s,o),a=!0},this.itemEnd=function(e){s++,void 0!==n.onProgress&&n.onProgress(e,s,o),s===o&&(a=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return r?r(e):e},this.setURLModifier=function(e){return r=e,this},this.addHandler=function(e,t){return l.push(e,t),this},this.removeHandler=function(e){let t=l.indexOf(e);return -1!==t&&l.splice(t,2),this},this.getHandler=function(e){for(let t=0,i=l.length;t<i;t+=2){let i=l[t],r=l[t+1];if(i.global&&(i.lastIndex=0),i.test(e))return r}return null}}}let cr=new ci;class cn{constructor(e){this.manager=void 0!==e?e:cr,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){let i=this;return new Promise(function(r,n){i.load(e,r,t,n)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}}cn.DEFAULT_MATERIAL_NAME="__DEFAULT";let ca={};class cs extends Error{constructor(e,t){super(e),this.response=t}}class co extends cn{constructor(e){super(e)}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let n=ct.get(e);if(void 0!==n)return this.manager.itemStart(e),setTimeout(()=>{t&&t(n),this.manager.itemEnd(e)},0),n;if(void 0!==ca[e]){ca[e].push({onLoad:t,onProgress:i,onError:r});return}ca[e]=[],ca[e].push({onLoad:t,onProgress:i,onError:r});let a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),s=this.mimeType,o=this.responseType;fetch(a).then(t=>{if(200===t.status||0===t.status){if(0===t.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===t.body||void 0===t.body.getReader)return t;let i=ca[e],r=t.body.getReader(),n=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),a=n?parseInt(n):0,s=0!==a,o=0,l=new ReadableStream({start(e){(function t(){r.read().then(({done:r,value:n})=>{if(r)e.close();else{o+=n.byteLength;let r=new ProgressEvent("progress",{lengthComputable:s,loaded:o,total:a});for(let e=0,t=i.length;e<t;e++){let t=i[e];t.onProgress&&t.onProgress(r)}e.enqueue(n),t()}})})()}});return new Response(l)}throw new cs(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`,t)}).then(e=>{switch(o){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>{let t=new DOMParser;return t.parseFromString(e,s)});case"json":return e.json();default:if(void 0===s)return e.text();{let t=/charset="?([^;"\s]*)"?/i.exec(s),i=t&&t[1]?t[1].toLowerCase():void 0,r=new TextDecoder(i);return e.arrayBuffer().then(e=>r.decode(e))}}}).then(t=>{ct.add(e,t);let i=ca[e];delete ca[e];for(let e=0,r=i.length;e<r;e++){let r=i[e];r.onLoad&&r.onLoad(t)}}).catch(t=>{let i=ca[e];if(void 0===i)throw this.manager.itemError(e),t;delete ca[e];for(let e=0,r=i.length;e<r;e++){let r=i[e];r.onError&&r.onError(t)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}}class cl extends cn{constructor(e){super(e)}load(e,t,i,r){let n=this,a=new co(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(i){try{t(n.parse(JSON.parse(i)))}catch(t){r?r(t):console.error(t),n.manager.itemError(e)}},i,r)}parse(e){let t=[];for(let i=0;i<e.length;i++){let r=ce.parse(e[i]);t.push(r)}return t}}class cu extends cn{constructor(e){super(e)}load(e,t,i,r){let n=this,a=[],s=new lM,o=new co(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(n.withCredentials);let l=0;if(Array.isArray(e))for(let u=0,c=e.length;u<c;++u)!function(u){o.load(e[u],function(e){let i=n.parse(e,!0);a[u]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},6===(l+=1)&&(1===i.mipmapCount&&(s.minFilter=eS),s.image=a,s.format=i.format,s.needsUpdate=!0,t&&t(s))},i,r)}(u);else o.load(e,function(e){let i=n.parse(e,!0);if(i.isCubemap){let e=i.mipmaps.length/i.mipmapCount;for(let t=0;t<e;t++){a[t]={mipmaps:[]};for(let e=0;e<i.mipmapCount;e++)a[t].mipmaps.push(i.mipmaps[t*i.mipmapCount+e]),a[t].format=i.format,a[t].width=i.width,a[t].height=i.height}s.image=a}else s.image.width=i.width,s.image.height=i.height,s.mipmaps=i.mipmaps;1===i.mipmapCount&&(s.minFilter=eS),s.format=i.format,s.needsUpdate=!0,t&&t(s)},i,r);return s}}class cc extends cn{constructor(e){super(e)}load(e,t,i,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let n=this,a=ct.get(e);if(void 0!==a)return n.manager.itemStart(e),setTimeout(function(){t&&t(a),n.manager.itemEnd(e)},0),a;let s=iB("img");function o(){u(),ct.add(e,this),t&&t(this),n.manager.itemEnd(e)}function l(t){u(),r&&r(t),n.manager.itemError(e),n.manager.itemEnd(e)}function u(){s.removeEventListener("load",o,!1),s.removeEventListener("error",l,!1)}return s.addEventListener("load",o,!1),s.addEventListener("error",l,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(s.crossOrigin=this.crossOrigin),n.manager.itemStart(e),s.src=e,s}}class cd extends cn{constructor(e){super(e)}load(e,t,i,r){let n=new ar;n.colorSpace=tF;let a=new cc(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let s=0;for(let i=0;i<e.length;++i)!function(i){a.load(e[i],function(e){n.images[i]=e,6==++s&&(n.needsUpdate=!0,t&&t(n))},void 0,r)}(i);return n}}class ch extends cn{constructor(e){super(e)}load(e,t,i,r){let n=this,a=new o5,s=new co(this.manager);return s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setPath(this.path),s.setWithCredentials(n.withCredentials),s.load(e,function(e){let i;try{i=n.parse(e)}catch(e){if(void 0!==r)r(e);else{console.error(e);return}}void 0!==i.image?a.image=i.image:void 0!==i.data&&(a.image.width=i.width,a.image.height=i.height,a.image.data=i.data),a.wrapS=void 0!==i.wrapS?i.wrapS:em,a.wrapT=void 0!==i.wrapT?i.wrapT:em,a.magFilter=void 0!==i.magFilter?i.magFilter:eS,a.minFilter=void 0!==i.minFilter?i.minFilter:eS,a.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.colorSpace?a.colorSpace=i.colorSpace:void 0!==i.encoding&&(a.encoding=i.encoding),void 0!==i.flipY&&(a.flipY=i.flipY),void 0!==i.format&&(a.format=i.format),void 0!==i.type&&(a.type=i.type),void 0!==i.mipmaps&&(a.mipmaps=i.mipmaps,a.minFilter=ew),1===i.mipmapCount&&(a.minFilter=eS),void 0!==i.generateMipmaps&&(a.generateMipmaps=i.generateMipmaps),a.needsUpdate=!0,t&&t(a,i)},i,r),a}}class cf extends cn{constructor(e){super(e)}load(e,t,i,r){let n=new i1,a=new cc(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(e){n.image=e,n.needsUpdate=!0,void 0!==t&&t(n)},i,r),n}}class cp extends r2{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new nd(e),this.intensity=t}dispose(){}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}class cm extends cp{constructor(e,t,i){super(e,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(r2.DEFAULT_UP),this.updateMatrix(),this.groundColor=new nd(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}}let cg=new rL,cv=new rt,cy=new rt;class cb{constructor(e){this.camera=e,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new iD(512,512),this.map=null,this.mapPass=null,this.matrix=new rL,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new ad,this._frameExtents=new iD(1,1),this._viewportCount=1,this._viewports=[new i2(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let t=this.camera,i=this.matrix;cv.setFromMatrixPosition(e.matrixWorld),t.position.copy(cv),cy.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(cy),t.updateMatrixWorld(),cg.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(cg),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(cg)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class c_ extends cb{constructor(){super(new at(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let t=this.camera,i=2*iS*e.angle*this.focus,r=this.mapSize.width/this.mapSize.height,n=e.distance||t.far;(i!==t.fov||r!==t.aspect||n!==t.far)&&(t.fov=i,t.aspect=r,t.far=n,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class cE extends cp{constructor(e,t,i=0,r=Math.PI/3,n=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(r2.DEFAULT_UP),this.updateMatrix(),this.target=new r2,this.distance=i,this.angle=r,this.penumbra=n,this.decay=a,this.map=null,this.shadow=new c_}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}let cS=new rL,cx=new rt,cT=new rt;class cw extends cb{constructor(){super(new at(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new iD(4,2),this._viewportCount=6,this._viewports=[new i2(2,1,1,1),new i2(0,1,1,1),new i2(3,1,1,1),new i2(1,1,1,1),new i2(3,0,1,1),new i2(1,0,1,1)],this._cubeDirections=[new rt(1,0,0),new rt(-1,0,0),new rt(0,0,1),new rt(0,0,-1),new rt(0,1,0),new rt(0,-1,0)],this._cubeUps=[new rt(0,1,0),new rt(0,1,0),new rt(0,1,0),new rt(0,1,0),new rt(0,0,1),new rt(0,0,-1)]}updateMatrices(e,t=0){let i=this.camera,r=this.matrix,n=e.distance||i.far;n!==i.far&&(i.far=n,i.updateProjectionMatrix()),cx.setFromMatrixPosition(e.matrixWorld),i.position.copy(cx),cT.copy(i.position),cT.add(this._cubeDirections[t]),i.up.copy(this._cubeUps[t]),i.lookAt(cT),i.updateMatrixWorld(),r.makeTranslation(-cx.x,-cx.y,-cx.z),cS.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(cS)}}class cA extends cp{constructor(e,t,i=0,r=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=r,this.shadow=new cw}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}class cM extends cb{constructor(){super(new aw(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class cR extends cp{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(r2.DEFAULT_UP),this.updateMatrix(),this.target=new r2,this.shadow=new cM}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}class cC extends cp{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class cI extends cp{constructor(e,t,i=10,r=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=r}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){let t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class cL{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new rt)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){let i=e.x,r=e.y,n=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*r),t.addScaledVector(a[2],.488603*n),t.addScaledVector(a[3],.488603*i),t.addScaledVector(a[4],1.092548*(i*r)),t.addScaledVector(a[5],1.092548*(r*n)),t.addScaledVector(a[6],.315392*(3*n*n-1)),t.addScaledVector(a[7],1.092548*(i*n)),t.addScaledVector(a[8],.546274*(i*i-r*r)),t}getIrradianceAt(e,t){let i=e.x,r=e.y,n=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],1.023328*r),t.addScaledVector(a[2],1.023328*n),t.addScaledVector(a[3],1.023328*i),t.addScaledVector(a[4],.858086*i*r),t.addScaledVector(a[5],.858086*r*n),t.addScaledVector(a[6],.743125*n*n-.247708),t.addScaledVector(a[7],.858086*i*n),t.addScaledVector(a[8],.429043*(i*i-r*r)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(e.coefficients[i],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let i=0;i<9;i++)this.coefficients[i].lerp(e.coefficients[i],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){let i=this.coefficients;for(let r=0;r<9;r++)i[r].fromArray(e,t+3*r);return this}toArray(e=[],t=0){let i=this.coefficients;for(let r=0;r<9;r++)i[r].toArray(e,t+3*r);return e}static getBasisAt(e,t){let i=e.x,r=e.y,n=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*n,t[3]=.488603*i,t[4]=1.092548*i*r,t[5]=1.092548*r*n,t[6]=.315392*(3*n*n-1),t[7]=1.092548*i*n,t[8]=.546274*(i*i-r*r)}}class ck extends cp{constructor(e=new cL,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}fromJSON(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}toJSON(e){let t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class cD extends cn{constructor(e){super(e),this.textures={}}load(e,t,i,r){let n=this,a=new co(n.manager);a.setPath(n.path),a.setRequestHeader(n.requestHeader),a.setWithCredentials(n.withCredentials),a.load(e,function(i){try{t(n.parse(JSON.parse(i)))}catch(t){r?r(t):console.error(t),n.manager.itemError(e)}},i,r)}parse(e){let t=this.textures;function i(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}let r=cD.createMaterialFromType(e.type);if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=e.sheen),void 0!==e.sheenColor&&(r.sheenColor=new nd().setHex(e.sheenColor)),void 0!==e.sheenRoughness&&(r.sheenRoughness=e.sheenRoughness),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.specularIntensity&&(r.specularIntensity=e.specularIntensity),void 0!==e.specularColor&&void 0!==r.specularColor&&r.specularColor.setHex(e.specularColor),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.iridescence&&(r.iridescence=e.iridescence),void 0!==e.iridescenceIOR&&(r.iridescenceIOR=e.iridescenceIOR),void 0!==e.iridescenceThicknessRange&&(r.iridescenceThicknessRange=e.iridescenceThicknessRange),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.thickness&&(r.thickness=e.thickness),void 0!==e.attenuationDistance&&(r.attenuationDistance=e.attenuationDistance),void 0!==e.attenuationColor&&void 0!==r.attenuationColor&&r.attenuationColor.setHex(e.attenuationColor),void 0!==e.anisotropy&&(r.anisotropy=e.anisotropy),void 0!==e.anisotropyRotation&&(r.anisotropyRotation=e.anisotropyRotation),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.alphaHash&&(r.alphaHash=e.alphaHash),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.forceSinglePass&&(r.forceSinglePass=e.forceSinglePass),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"==typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(let t in e.uniforms){let n=e.uniforms[t];switch(r.uniforms[t]={},n.type){case"t":r.uniforms[t].value=i(n.value);break;case"c":r.uniforms[t].value=new nd().setHex(n.value);break;case"v2":r.uniforms[t].value=new iD().fromArray(n.value);break;case"v3":r.uniforms[t].value=new rt().fromArray(n.value);break;case"v4":r.uniforms[t].value=new i2().fromArray(n.value);break;case"m3":r.uniforms[t].value=new iP().fromArray(n.value);break;case"m4":r.uniforms[t].value=new rL().fromArray(n.value);break;default:r.uniforms[t].value=n.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.glslVersion&&(r.glslVersion=e.glslVersion),void 0!==e.extensions)for(let t in e.extensions)r.extensions[t]=e.extensions[t];if(void 0!==e.lights&&(r.lights=e.lights),void 0!==e.clipping&&(r.clipping=e.clipping),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=i(e.map)),void 0!==e.matcap&&(r.matcap=i(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=i(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=i(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=i(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){let t=e.normalScale;!1===Array.isArray(t)&&(t=[t,t]),r.normalScale=new iD().fromArray(t)}return void 0!==e.displacementMap&&(r.displacementMap=i(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=i(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=i(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=i(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=i(e.specularMap)),void 0!==e.specularIntensityMap&&(r.specularIntensityMap=i(e.specularIntensityMap)),void 0!==e.specularColorMap&&(r.specularColorMap=i(e.specularColorMap)),void 0!==e.envMap&&(r.envMap=i(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=i(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=i(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=i(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=i(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=i(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=i(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=new iD().fromArray(e.clearcoatNormalScale)),void 0!==e.iridescenceMap&&(r.iridescenceMap=i(e.iridescenceMap)),void 0!==e.iridescenceThicknessMap&&(r.iridescenceThicknessMap=i(e.iridescenceThicknessMap)),void 0!==e.transmissionMap&&(r.transmissionMap=i(e.transmissionMap)),void 0!==e.thicknessMap&&(r.thicknessMap=i(e.thicknessMap)),void 0!==e.anisotropyMap&&(r.anisotropyMap=i(e.anisotropyMap)),void 0!==e.sheenColorMap&&(r.sheenColorMap=i(e.sheenColorMap)),void 0!==e.sheenRoughnessMap&&(r.sheenRoughnessMap=i(e.sheenRoughnessMap)),r}setTextures(e){return this.textures=e,this}static createMaterialFromType(e){return new({ShadowMaterial:uO,SpriteMaterial:oC,RawShaderMaterial:uN,ShaderMaterial:n9,PointsMaterial:ly,MeshPhysicalMaterial:uF,MeshStandardMaterial:uU,MeshPhongMaterial:uB,MeshToonMaterial:uV,MeshNormalMaterial:uz,MeshLambertMaterial:uj,MeshDepthMaterial:oo,MeshDistanceMaterial:ol,MeshBasicMaterial:nf,MeshMatcapMaterial:uH,LineDashedMaterial:uG,LineBasicMaterial:lo,Material:ns})[e]}}class cP{static decodeText(e){if("undefined"!=typeof TextDecoder)return new TextDecoder().decode(e);let t="";for(let i=0,r=e.length;i<r;i++)t+=String.fromCharCode(e[i]);try{return decodeURIComponent(escape(t))}catch(e){return t}}static extractUrlBase(e){let t=e.lastIndexOf("/");return -1===t?"./":e.slice(0,t+1)}static resolveURL(e,t){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e))?e:t+e}}class cO extends nF{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){let e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class cN extends cn{constructor(e){super(e)}load(e,t,i,r){let n=this,a=new co(n.manager);a.setPath(n.path),a.setRequestHeader(n.requestHeader),a.setWithCredentials(n.withCredentials),a.load(e,function(i){try{t(n.parse(JSON.parse(i)))}catch(t){r?r(t):console.error(t),n.manager.itemError(e)}},i,r)}parse(e){let t={},i={};function r(e,r){if(void 0!==t[r])return t[r];let n=e.interleavedBuffers,a=n[r],s=function(e,t){if(void 0!==i[t])return i[t];let r=e.arrayBuffers,n=r[t],a=new Uint32Array(n).buffer;return i[t]=a,a}(e,a.buffer),o=iF(a.type,s),l=new oA(o,a.stride);return l.uuid=a.uuid,t[r]=l,l}let n=e.isInstancedBufferGeometry?new cO:new nF,a=e.data.index;if(void 0!==a){let e=iF(a.type,a.array);n.setIndex(new n_(e,1))}let s=e.data.attributes;for(let t in s){let i;let a=s[t];if(a.isInterleavedBufferAttribute){let t=r(e.data,a.data);i=new oR(t,a.itemSize,a.offset,a.normalized)}else{let e=iF(a.type,a.array),t=a.isInstancedBufferAttribute?o7:n_;i=new t(e,a.itemSize,a.normalized)}void 0!==a.name&&(i.name=a.name),void 0!==a.usage&&i.setUsage(a.usage),void 0!==a.updateRange&&(i.updateRange.offset=a.updateRange.offset,i.updateRange.count=a.updateRange.count),n.setAttribute(t,i)}let o=e.data.morphAttributes;if(o)for(let t in o){let i=o[t],a=[];for(let t=0,n=i.length;t<n;t++){let n;let s=i[t];if(s.isInterleavedBufferAttribute){let t=r(e.data,s.data);n=new oR(t,s.itemSize,s.offset,s.normalized)}else{let e=iF(s.type,s.array);n=new n_(e,s.itemSize,s.normalized)}void 0!==s.name&&(n.name=s.name),a.push(n)}n.morphAttributes[t]=a}let l=e.data.morphTargetsRelative;l&&(n.morphTargetsRelative=!0);let u=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==u)for(let e=0,t=u.length;e!==t;++e){let t=u[e];n.addGroup(t.start,t.count,t.materialIndex)}let c=e.data.boundingSphere;if(void 0!==c){let e=new rt;void 0!==c.center&&e.fromArray(c.center),n.boundingSphere=new rS(e,c.radius)}return e.name&&(n.name=e.name),e.userData&&(n.userData=e.userData),n}}class cU extends cn{constructor(e){super(e)}load(e,t,i,r){let n=this,a=""===this.path?cP.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;let s=new co(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials),s.load(e,function(i){let a=null;try{a=JSON.parse(i)}catch(t){void 0!==r&&r(t),console.error("THREE:ObjectLoader: Can't parse "+e+".",t.message);return}let s=a.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase()){void 0!==r&&r(Error("THREE.ObjectLoader: Can't load "+e)),console.error("THREE.ObjectLoader: Can't load "+e);return}n.parse(a,t)},i,r)}async loadAsync(e,t){let i=""===this.path?cP.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;let r=new co(this.manager);r.setPath(this.path),r.setRequestHeader(this.requestHeader),r.setWithCredentials(this.withCredentials);let n=await r.loadAsync(e,t),a=JSON.parse(n),s=a.metadata;if(void 0===s||void 0===s.type||"geometry"===s.type.toLowerCase())throw Error("THREE.ObjectLoader: Can't load "+e);return await this.parseAsync(a)}parse(e,t){let i=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),n=this.parseGeometries(e.geometries,r),a=this.parseImages(e.images,function(){void 0!==t&&t(l)}),s=this.parseTextures(e.textures,a),o=this.parseMaterials(e.materials,s),l=this.parseObject(e.object,n,o,s,i),u=this.parseSkeletons(e.skeletons,l);if(this.bindSkeletons(l,u),void 0!==t){let e=!1;for(let t in a)if(a[t].data instanceof HTMLImageElement){e=!0;break}!1===e&&t(l)}return l}async parseAsync(e){let t=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),r=this.parseGeometries(e.geometries,i),n=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,n),s=this.parseMaterials(e.materials,a),o=this.parseObject(e.object,r,s,a,t),l=this.parseSkeletons(e.skeletons,o);return this.bindSkeletons(o,l),o}parseShapes(e){let t={};if(void 0!==e)for(let i=0,r=e.length;i<r;i++){let r=new ut().fromJSON(e[i]);t[r.uuid]=r}return t}parseSkeletons(e,t){let i={},r={};if(t.traverse(function(e){e.isBone&&(r[e.uuid]=e)}),void 0!==e)for(let t=0,n=e.length;t<n;t++){let n=new o8().fromJSON(e[t],r);i[n.uuid]=n}return i}parseGeometries(e,t){let i={};if(void 0!==e){let r=new cN;for(let n=0,a=e.length;n<a;n++){let a;let s=e[n];switch(s.type){case"BufferGeometry":case"InstancedBufferGeometry":a=r.parse(s);break;default:s.type in uP?a=uP[s.type].fromJSON(s,t):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${s.type}"`)}a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.userData&&(a.userData=s.userData),i[s.uuid]=a}}return i}parseMaterials(e,t){let i={},r={};if(void 0!==e){let n=new cD;n.setTextures(t);for(let t=0,a=e.length;t<a;t++){let a=e[t];void 0===i[a.uuid]&&(i[a.uuid]=n.parse(a)),r[a.uuid]=i[a.uuid]}}return r}parseAnimations(e){let t={};if(void 0!==e)for(let i=0;i<e.length;i++){let r=e[i],n=ce.parse(r);t[n.uuid]=n}return t}parseImages(e,t){let i;let r=this,n={};function a(e){if("string"==typeof e){let t=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:r.resourcePath+e;return r.manager.itemStart(t),i.load(t,function(){r.manager.itemEnd(t)},void 0,function(){r.manager.itemError(t),r.manager.itemEnd(t)})}return e.data?{data:iF(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){let r=new ci(t);(i=new cc(r)).setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){let i=e[t],r=i.url;if(Array.isArray(r)){let e=[];for(let t=0,i=r.length;t<i;t++){let i=r[t],n=a(i);null!==n&&(n instanceof HTMLImageElement?e.push(n):e.push(new o5(n.data,n.width,n.height)))}n[i.uuid]=new iJ(e)}else{let e=a(i.url);n[i.uuid]=new iJ(e)}}}return n}async parseImagesAsync(e){let t;let i=this,r={};async function n(e){if("string"==typeof e){let r=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(e)?e:i.resourcePath+e;return await t.loadAsync(r)}return e.data?{data:iF(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){(t=new cc(this.manager)).setCrossOrigin(this.crossOrigin);for(let t=0,i=e.length;t<i;t++){let i=e[t],a=i.url;if(Array.isArray(a)){let e=[];for(let t=0,i=a.length;t<i;t++){let i=a[t],r=await n(i);null!==r&&(r instanceof HTMLImageElement?e.push(r):e.push(new o5(r.data,r.width,r.height)))}r[i.uuid]=new iJ(e)}else{let e=await n(i.url);r[i.uuid]=new iJ(e)}}}return r}parseTextures(e,t){function i(e,t){return"number"==typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}let r={};if(void 0!==e)for(let n=0,a=e.length;n<a;n++){let a;let s=e[n];void 0===s.image&&console.warn('THREE.ObjectLoader: No "image" specified for',s.uuid),void 0===t[s.image]&&console.warn("THREE.ObjectLoader: Undefined image",s.image);let o=t[s.image],l=o.data;Array.isArray(l)?(a=new ar,6===l.length&&(a.needsUpdate=!0)):(a=l&&l.data?new o5:new i1,l&&(a.needsUpdate=!0)),a.source=o,a.uuid=s.uuid,void 0!==s.name&&(a.name=s.name),void 0!==s.mapping&&(a.mapping=i(s.mapping,cF)),void 0!==s.channel&&(a.channel=s.channel),void 0!==s.offset&&a.offset.fromArray(s.offset),void 0!==s.repeat&&a.repeat.fromArray(s.repeat),void 0!==s.center&&a.center.fromArray(s.center),void 0!==s.rotation&&(a.rotation=s.rotation),void 0!==s.wrap&&(a.wrapS=i(s.wrap[0],cB),a.wrapT=i(s.wrap[1],cB)),void 0!==s.format&&(a.format=s.format),void 0!==s.internalFormat&&(a.internalFormat=s.internalFormat),void 0!==s.type&&(a.type=s.type),void 0!==s.colorSpace&&(a.colorSpace=s.colorSpace),void 0!==s.encoding&&(a.encoding=s.encoding),void 0!==s.minFilter&&(a.minFilter=i(s.minFilter,cV)),void 0!==s.magFilter&&(a.magFilter=i(s.magFilter,cV)),void 0!==s.anisotropy&&(a.anisotropy=s.anisotropy),void 0!==s.flipY&&(a.flipY=s.flipY),void 0!==s.generateMipmaps&&(a.generateMipmaps=s.generateMipmaps),void 0!==s.premultiplyAlpha&&(a.premultiplyAlpha=s.premultiplyAlpha),void 0!==s.unpackAlignment&&(a.unpackAlignment=s.unpackAlignment),void 0!==s.compareFunction&&(a.compareFunction=s.compareFunction),void 0!==s.userData&&(a.userData=s.userData),r[s.uuid]=a}return r}parseObject(e,t,i,r,n){let a,s,o;function l(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function u(e){if(void 0!==e){if(Array.isArray(e)){let t=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];void 0===i[n]&&console.warn("THREE.ObjectLoader: Undefined material",n),t.push(i[n])}return t}return void 0===i[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),i[e]}}function c(e){return void 0===r[e]&&console.warn("THREE.ObjectLoader: Undefined texture",e),r[e]}switch(e.type){case"Scene":a=new ow,void 0!==e.background&&(Number.isInteger(e.background)?a.background=new nd(e.background):a.background=c(e.background)),void 0!==e.environment&&(a.environment=c(e.environment)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new oT(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new ox(e.fog.color,e.fog.density))),void 0!==e.backgroundBlurriness&&(a.backgroundBlurriness=e.backgroundBlurriness),void 0!==e.backgroundIntensity&&(a.backgroundIntensity=e.backgroundIntensity);break;case"PerspectiveCamera":a=new at(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new aw(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new cC(e.color,e.intensity);break;case"DirectionalLight":a=new cR(e.color,e.intensity);break;case"PointLight":a=new cA(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new cI(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new cE(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new cm(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=new ck().fromJSON(e);break;case"SkinnedMesh":s=l(e.geometry),o=u(e.material),a=new o2(s,o),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":s=l(e.geometry),o=u(e.material),a=new n2(s,o);break;case"InstancedMesh":s=l(e.geometry),o=u(e.material);let d=e.count,h=e.instanceMatrix,f=e.instanceColor;(a=new ls(s,o,d)).instanceMatrix=new o7(new Float32Array(h.array),16),void 0!==f&&(a.instanceColor=new o7(new Float32Array(f.array),f.itemSize));break;case"LOD":a=new o$;break;case"Line":a=new lf(l(e.geometry),u(e.material));break;case"LineLoop":a=new lv(l(e.geometry),u(e.material));break;case"LineSegments":a=new lg(l(e.geometry),u(e.material));break;case"PointCloud":case"Points":a=new lx(l(e.geometry),u(e.material));break;case"Sprite":a=new oj(u(e.material));break;case"Group":a=new op;break;case"Bone":a=new o3;break;default:a=new r2}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.up&&a.up.fromArray(e.up),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children){let s=e.children;for(let e=0;e<s.length;e++)a.add(this.parseObject(s[e],t,i,r,n))}if(void 0!==e.animations){let t=e.animations;for(let e=0;e<t.length;e++){let i=t[e];a.animations.push(n[i])}}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);let t=e.levels;for(let e=0;e<t.length;e++){let i=t[e],r=a.getObjectByProperty("uuid",i.object);void 0!==r&&a.addLevel(r,i.distance,i.hysteresis)}}return a}bindSkeletons(e,t){0!==Object.keys(t).length&&e.traverse(function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){let i=t[e.skeleton];void 0===i?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(i,e.bindMatrix)}})}}let cF={UVMapping:el,CubeReflectionMapping:eu,CubeRefractionMapping:ec,EquirectangularReflectionMapping:ed,EquirectangularRefractionMapping:eh,CubeUVReflectionMapping:ef},cB={RepeatWrapping:ep,ClampToEdgeWrapping:em,MirroredRepeatWrapping:eg},cV={NearestFilter:ev,NearestMipmapNearestFilter:ey,NearestMipmapLinearFilter:e_,LinearFilter:eS,LinearMipmapNearestFilter:ex,LinearMipmapLinearFilter:ew};class cz extends cn{constructor(e){super(e),this.isImageBitmapLoader=!0,"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,t,i,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let n=this,a=ct.get(e);if(void 0!==a)return n.manager.itemStart(e),setTimeout(function(){t&&t(a),n.manager.itemEnd(e)},0),a;let s={};s.credentials="anonymous"===this.crossOrigin?"same-origin":"include",s.headers=this.requestHeader,fetch(e,s).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(n.options,{colorSpaceConversion:"none"}))}).then(function(i){ct.add(e,i),t&&t(i),n.manager.itemEnd(e)}).catch(function(t){r&&r(t),n.manager.itemError(e),n.manager.itemEnd(e)}),n.manager.itemStart(e)}}class cj{static getContext(){return void 0===a&&(a=new(window.AudioContext||window.webkitAudioContext)),a}static setContext(e){a=e}}class cH extends cn{constructor(e){super(e)}load(e,t,i,r){let n=this,a=new co(this.manager);function s(t){r?r(t):console.error(t),n.manager.itemError(e)}a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(e){try{let i=e.slice(0),r=cj.getContext();r.decodeAudioData(i,function(e){t(e)},s)}catch(e){s(e)}},i,r)}}class cG extends ck{constructor(e,t,i=1){super(void 0,i),this.isHemisphereLightProbe=!0;let r=new nd().set(e),n=new nd().set(t),a=new rt(r.r,r.g,r.b),s=new rt(n.r,n.g,n.b),o=Math.sqrt(Math.PI),l=o*Math.sqrt(.75);this.sh.coefficients[0].copy(a).add(s).multiplyScalar(o),this.sh.coefficients[1].copy(a).sub(s).multiplyScalar(l)}}class cW extends ck{constructor(e,t=1){super(void 0,t),this.isAmbientLightProbe=!0;let i=new nd().set(e);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}let c$=new rL,cq=new rL,cY=new rL;class cK{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new at,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new at,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){let t=this._cache,i=t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep;if(i){let i,r;t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,cY.copy(e.projectionMatrix);let n=t.eyeSep/2,a=n*t.near/t.focus,s=t.near*Math.tan(iE*t.fov*.5)/t.zoom;cq.elements[12]=-n,c$.elements[12]=n,i=-s*t.aspect+a,r=s*t.aspect+a,cY.elements[0]=2*t.near/(r-i),cY.elements[8]=(r+i)/(r-i),this.cameraL.projectionMatrix.copy(cY),i=-s*t.aspect-a,r=s*t.aspect-a,cY.elements[0]=2*t.near/(r-i),cY.elements[8]=(r+i)/(r-i),this.cameraR.projectionMatrix.copy(cY)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(cq),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(c$)}}class cX{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=cZ(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let t=cZ();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}function cZ(){return("undefined"==typeof performance?Date:performance).now()}let cJ=new rt,cQ=new re,c0=new rt,c1=new rt;class c2 extends r2{constructor(){super(),this.type="AudioListener",this.context=cj.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new cX}getInput(){return this.gain}removeFilter(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);let t=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(cJ,cQ,c0),c1.set(0,0,-1).applyQuaternion(cQ),t.positionX){let e=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(cJ.x,e),t.positionY.linearRampToValueAtTime(cJ.y,e),t.positionZ.linearRampToValueAtTime(cJ.z,e),t.forwardX.linearRampToValueAtTime(c1.x,e),t.forwardY.linearRampToValueAtTime(c1.y,e),t.forwardZ.linearRampToValueAtTime(c1.z,e),t.upX.linearRampToValueAtTime(i.x,e),t.upY.linearRampToValueAtTime(i.y,e),t.upZ.linearRampToValueAtTime(i.z,e)}else t.setPosition(cJ.x,cJ.y,cJ.z),t.setOrientation(c1.x,c1.y,c1.z,i.x,i.y,i.z)}}class c3 extends r2{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(!0===this.isPlaying){console.warn("THREE.Audio: Audio is already playing.");return}if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;let t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,null!==this.source&&(this.source.stop(),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(!1!==this._connected){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(!1===this.hasPlaybackControl){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}let c5=new rt,c4=new re,c6=new rt,c8=new rt;class c7 extends c3{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){super.connect(),this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,i){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=i,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),!0===this.hasPlaybackControl&&!1===this.isPlaying)return;this.matrixWorld.decompose(c5,c4,c6),c8.set(0,0,1).applyQuaternion(c4);let t=this.panner;if(t.positionX){let e=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(c5.x,e),t.positionY.linearRampToValueAtTime(c5.y,e),t.positionZ.linearRampToValueAtTime(c5.z,e),t.orientationX.linearRampToValueAtTime(c8.x,e),t.orientationY.linearRampToValueAtTime(c8.y,e),t.orientationZ.linearRampToValueAtTime(c8.z,e)}else t.setPosition(c5.x,c5.y,c5.z),t.setOrientation(c8.x,c8.y,c8.z)}}class c9{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0,t=this.getFrequencyData();for(let i=0;i<t.length;i++)e+=t[i];return e/t.length}}class de{constructor(e,t,i){let r,n,a;switch(this.binding=e,this.valueSize=i,t){case"quaternion":r=this._slerp,n=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=this._select,n=this._select,a=this._setAdditiveIdentityOther,this.buffer=Array(5*i);break;default:r=this._lerp,n=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=r,this._mixBufferRegionAdditive=n,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){let i=this.buffer,r=this.valueSize,n=e*r+r,a=this.cumulativeWeight;if(0===a){for(let e=0;e!==r;++e)i[n+e]=i[e];a=t}else{a+=t;let e=t/a;this._mixBufferRegion(i,n,0,e,r)}this.cumulativeWeight=a}accumulateAdditive(e){let t=this.buffer,i=this.valueSize,r=i*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,i),this.cumulativeWeightAdditive+=e}apply(e){let t=this.valueSize,i=this.buffer,r=e*t+t,n=this.cumulativeWeight,a=this.cumulativeWeightAdditive,s=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,n<1){let e=t*this._origIndex;this._mixBufferRegion(i,r,e,1-n,t)}a>0&&this._mixBufferRegionAdditive(i,r,this._addIndex*t,1,t);for(let e=t,n=t+t;e!==n;++e)if(i[e]!==i[e+t]){s.setValue(i,r);break}}saveOriginalState(){let e=this.binding,t=this.buffer,i=this.valueSize,r=i*this._origIndex;e.getValue(t,r);for(let e=i;e!==r;++e)t[e]=t[r+e%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let i=e;i<t;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[t+i]=this.buffer[e+i]}_select(e,t,i,r,n){if(r>=.5)for(let r=0;r!==n;++r)e[t+r]=e[i+r]}_slerp(e,t,i,r){re.slerpFlat(e,t,e,t,e,i,r)}_slerpAdditive(e,t,i,r,n){let a=this._workIndex*n;re.multiplyQuaternionsFlat(e,a,e,t,e,i),re.slerpFlat(e,t,e,t,e,a,r)}_lerp(e,t,i,r,n){let a=1-r;for(let s=0;s!==n;++s){let n=t+s;e[n]=e[n]*a+e[i+s]*r}}_lerpAdditive(e,t,i,r,n){for(let a=0;a!==n;++a){let n=t+a;e[n]=e[n]+e[i+a]*r}}}let dt="\\[\\]\\.:\\/",di=RegExp("["+dt+"]","g"),dr="[^"+dt+"]",dn="[^"+dt.replace("\\.","")+"]",da=/((?:WC+[\/:])*)/.source.replace("WC",dr),ds=/(WCOD+)?/.source.replace("WCOD",dn),dl=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",dr),du=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",dr),dc=RegExp("^"+da+ds+dl+du+"$"),dd=["material","materials","bones","map"];class dh{constructor(e,t,i){this.path=t,this.parsedPath=i||dh.parseTrackName(t),this.node=dh.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,i){return e&&e.isAnimationObjectGroup?new dh.Composite(e,t,i):new dh(e,t,i)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(di,"")}static parseTrackName(e){let t=dc.exec(e);if(null===t)throw Error("PropertyBinding: Cannot parse trackName: "+e);let i={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){let e=i.nodeName.substring(r+1);-1!==dd.indexOf(e)&&(i.nodeName=i.nodeName.substring(0,r),i.objectName=e)}if(null===i.propertyName||0===i.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+e);return i}static findNode(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){let i=e.skeleton.getBoneByName(t);if(void 0!==i)return i}if(e.children){let i=function(e){for(let r=0;r<e.length;r++){let n=e[r];if(n.name===t||n.uuid===t)return n;let a=i(n.children);if(a)return a}return null},r=i(e.children);if(r)return r}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)e[t++]=i[r]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)i[r]=e[t++]}_setValue_array_setNeedsUpdate(e,t){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)i[r]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){let i=this.resolvedProperty;for(let r=0,n=i.length;r!==n;++r)i[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node,t=this.parsedPath,i=t.objectName,r=t.propertyName,n=t.propertyIndex;if(e||(e=dh.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(i){let r=t.objectIndex;switch(i){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let t=0;t<e.length;t++)if(e[t].name===r){r=t;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(void 0===e[i]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[i]}if(void 0!==r){if(void 0===e[r]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[r]}}let a=e[r];if(void 0===a){let i=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+i+"."+r+" but it wasn't found.",e);return}let s=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?s=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(s=this.Versioning.MatrixWorldNeedsUpdate);let o=this.BindingType.Direct;if(void 0!==n){if("morphTargetInfluences"===r){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}void 0!==e.morphTargetDictionary[n]&&(n=e.morphTargetDictionary[n])}o=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=n}else void 0!==a.fromArray&&void 0!==a.toArray?(o=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(o=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=r;this.getValue=this.GetterByBindingType[o],this.setValue=this.SetterByBindingTypeAndVersioning[o][s]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}dh.Composite=class{constructor(e,t,i){let r=i||dh.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}getValue(e,t){this.bind();let i=this._targetGroup.nCachedObjects_,r=this._bindings[i];void 0!==r&&r.getValue(e,t)}setValue(e,t){let i=this._bindings;for(let r=this._targetGroup.nCachedObjects_,n=i.length;r!==n;++r)i[r].setValue(e,t)}bind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].bind()}unbind(){let e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,i=e.length;t!==i;++t)e[t].unbind()}},dh.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},dh.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},dh.prototype.GetterByBindingType=[dh.prototype._getValue_direct,dh.prototype._getValue_array,dh.prototype._getValue_arrayElement,dh.prototype._getValue_toArray],dh.prototype.SetterByBindingTypeAndVersioning=[[dh.prototype._setValue_direct,dh.prototype._setValue_direct_setNeedsUpdate,dh.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[dh.prototype._setValue_array,dh.prototype._setValue_array_setNeedsUpdate,dh.prototype._setValue_array_setMatrixWorldNeedsUpdate],[dh.prototype._setValue_arrayElement,dh.prototype._setValue_arrayElement_setNeedsUpdate,dh.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[dh.prototype._setValue_fromArray,dh.prototype._setValue_fromArray_setNeedsUpdate,dh.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class df{constructor(){this.isAnimationObjectGroup=!0,this.uuid=ix(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;let e={};this._indicesByUUID=e;for(let t=0,i=arguments.length;t!==i;++t)e[arguments[t].uuid]=t;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};let t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){let e=this._objects,t=this._indicesByUUID,i=this._paths,r=this._parsedPaths,n=this._bindings,a=n.length,s,o=e.length,l=this.nCachedObjects_;for(let u=0,c=arguments.length;u!==c;++u){let c=arguments[u],d=c.uuid,h=t[d];if(void 0===h){h=o++,t[d]=h,e.push(c);for(let e=0;e!==a;++e)n[e].push(new dh(c,i[e],r[e]))}else if(h<l){s=e[h];let o=--l,u=e[o];t[u.uuid]=h,e[h]=u,t[d]=o,e[o]=c;for(let e=0;e!==a;++e){let t=n[e],a=t[o],s=t[h];t[h]=a,void 0===s&&(s=new dh(c,i[e],r[e])),t[o]=s}}else e[h]!==s&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=l}remove(){let e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length,n=this.nCachedObjects_;for(let a=0,s=arguments.length;a!==s;++a){let s=arguments[a],o=s.uuid,l=t[o];if(void 0!==l&&l>=n){let a=n++,u=e[a];t[u.uuid]=l,e[l]=u,t[o]=a,e[a]=s;for(let e=0;e!==r;++e){let t=i[e],r=t[a],n=t[l];t[l]=r,t[a]=n}}}this.nCachedObjects_=n}uncache(){let e=this._objects,t=this._indicesByUUID,i=this._bindings,r=i.length,n=this.nCachedObjects_,a=e.length;for(let s=0,o=arguments.length;s!==o;++s){let o=arguments[s],l=o.uuid,u=t[l];if(void 0!==u){if(delete t[l],u<n){let s=--n,o=e[s],l=--a,c=e[l];t[o.uuid]=u,e[u]=o,t[c.uuid]=s,e[s]=c,e.pop();for(let e=0;e!==r;++e){let t=i[e],r=t[s],n=t[l];t[u]=r,t[s]=n,t.pop()}}else{let n=--a,s=e[n];n>0&&(t[s.uuid]=u),e[u]=s,e.pop();for(let e=0;e!==r;++e){let t=i[e];t[u]=t[n],t.pop()}}}}this.nCachedObjects_=n}subscribe_(e,t){let i=this._bindingsIndicesByPath,r=i[e],n=this._bindings;if(void 0!==r)return n[r];let a=this._paths,s=this._parsedPaths,o=this._objects,l=o.length,u=this.nCachedObjects_,c=Array(l);r=n.length,i[e]=r,a.push(e),s.push(t),n.push(c);for(let i=u,r=o.length;i!==r;++i){let r=o[i];c[i]=new dh(r,e,t)}return c}unsubscribe_(e){let t=this._bindingsIndicesByPath,i=t[e];if(void 0!==i){let r=this._paths,n=this._parsedPaths,a=this._bindings,s=a.length-1,o=a[s],l=e[s];t[l]=i,a[i]=o,a.pop(),n[i]=n[s],n.pop(),r[i]=r[s],r.pop()}}}class dp{constructor(e,t,i=null,r=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=i,this.blendMode=r;let n=t.tracks,a=n.length,s=Array(a),o={endingStart:tx,endingEnd:tx};for(let e=0;e!==a;++e){let t=n[e].createInterpolant(null);s[e]=t,t.settings=o}this._interpolantSettings=o,this._interpolants=s,this._propertyBindings=Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=ty,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,i){if(e.fadeOut(t),this.fadeIn(t),i){let i=this._clip.duration,r=e._clip.duration;e.warp(1,r/i,t),this.warp(i/r,1,t)}return this}crossFadeTo(e,t,i){return e.crossFadeFrom(this,t,i)}stopFading(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,i){let r=this._mixer,n=r.time,a=this.timeScale,s=this._timeScaleInterpolant;null===s&&(s=r._lendControlInterpolant(),this._timeScaleInterpolant=s);let o=s.parameterPositions,l=s.sampleValues;return o[0]=n,o[1]=n+i,l[0]=e/a,l[1]=t/a,this}stopWarping(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,i,r){if(!this.enabled){this._updateWeight(e);return}let n=this._startTime;if(null!==n){let r=(e-n)*i;r<0||0===i?t=0:(this._startTime=null,t=i*r)}t*=this._updateTimeScale(e);let a=this._updateTime(t),s=this._updateWeight(e);if(s>0){let e=this._interpolants,t=this._propertyBindings;if(this.blendMode===tM)for(let i=0,r=e.length;i!==r;++i)e[i].evaluate(a),t[i].accumulateAdditive(s);else for(let i=0,n=e.length;i!==n;++i)e[i].evaluate(a),t[i].accumulate(r,s)}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;let i=this._weightInterpolant;if(null!==i){let r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;let i=this._timeScaleInterpolant;if(null!==i){let r=i.evaluate(e)[0];t*=r,e>i.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){let t=this._clip.duration,i=this.loop,r=this.time+e,n=this._loopCount,a=i===tb;if(0===e)return -1===n?r:a&&(1&n)==1?t-r:r;if(i===tv){-1===n&&(this._loopCount=0,this._setEndings(!0,!0,!1));s:{if(r>=t)r=t;else if(r<0)r=0;else{this.time=r;break s}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===n&&(e>=0?(n=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),r>=t||r<0){let i=Math.floor(r/t);r-=t*i,n+=Math.abs(i);let s=this.repetitions-n;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){let t=e<0;this._setEndings(t,!t,a)}else this._setEndings(!1,!1,a);this._loopCount=n,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:i})}}else this.time=r;if(a&&(1&n)==1)return t-r}return r}_setEndings(e,t,i){let r=this._interpolantSettings;i?(r.endingStart=tT,r.endingEnd=tT):(e?r.endingStart=this.zeroSlopeAtStart?tT:tx:r.endingStart=tw,t?r.endingEnd=this.zeroSlopeAtEnd?tT:tx:r.endingEnd=tw)}_scheduleFading(e,t,i){let r=this._mixer,n=r.time,a=this._weightInterpolant;null===a&&(a=r._lendControlInterpolant(),this._weightInterpolant=a);let s=a.parameterPositions,o=a.sampleValues;return s[0]=n,o[0]=t,s[1]=n+e,o[1]=i,this}}let dm=new Float32Array(1);class dg extends iy{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){let i=e._localRoot||this._root,r=e._clip.tracks,n=r.length,a=e._propertyBindings,s=e._interpolants,o=i.uuid,l=this._bindingsByRootAndName,u=l[o];void 0===u&&(u={},l[o]=u);for(let e=0;e!==n;++e){let n=r[e],l=n.name,c=u[l];if(void 0!==c)++c.referenceCount,a[e]=c;else{if(void 0!==(c=a[e])){null===c._cacheIndex&&(++c.referenceCount,this._addInactiveBinding(c,o,l));continue}let r=t&&t._propertyBindings[e].binding.parsedPath;c=new de(dh.create(i,l,r),n.ValueTypeName,n.getValueSize()),++c.referenceCount,this._addInactiveBinding(c,o,l),a[e]=c}s[e].resultBuffer=c.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){let t=(e._localRoot||this._root).uuid,i=e._clip.uuid,r=this._actionsByClip[i];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,i,t)}let t=e._propertyBindings;for(let e=0,i=t.length;e!==i;++e){let i=t[e];0==i.useCount++&&(this._lendBinding(i),i.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let t=e._propertyBindings;for(let e=0,i=t.length;e!==i;++e){let i=t[e];0==--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let t=e._cacheIndex;return null!==t&&t<this._nActiveActions}_addInactiveAction(e,t,i){let r=this._actions,n=this._actionsByClip,a=n[t];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,n[t]=a;else{let t=a.knownActions;e._byClipCacheIndex=t.length,t.push(e)}e._cacheIndex=r.length,r.push(e),a.actionByRoot[i]=e}_removeInactiveAction(e){let t=this._actions,i=t[t.length-1],r=e._cacheIndex;i._cacheIndex=r,t[r]=i,t.pop(),e._cacheIndex=null;let n=e._clip.uuid,a=this._actionsByClip,s=a[n],o=s.knownActions,l=o[o.length-1],u=e._byClipCacheIndex;l._byClipCacheIndex=u,o[u]=l,o.pop(),e._byClipCacheIndex=null;let c=(e._localRoot||this._root).uuid;delete s.actionByRoot[c],0===o.length&&delete a[n],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let t=e._propertyBindings;for(let e=0,i=t.length;e!==i;++e){let i=t[e];0==--i.referenceCount&&this._removeInactiveBinding(i)}}_lendAction(e){let t=this._actions,i=e._cacheIndex,r=this._nActiveActions++,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n}_takeBackAction(e){let t=this._actions,i=e._cacheIndex,r=--this._nActiveActions,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n}_addInactiveBinding(e,t,i){let r=this._bindingsByRootAndName,n=this._bindings,a=r[t];void 0===a&&(a={},r[t]=a),a[i]=e,e._cacheIndex=n.length,n.push(e)}_removeInactiveBinding(e){let t=this._bindings,i=e.binding,r=i.rootNode.uuid,n=i.path,a=this._bindingsByRootAndName,s=a[r],o=t[t.length-1],l=e._cacheIndex;o._cacheIndex=l,t[l]=o,t.pop(),delete s[n],0===Object.keys(s).length&&delete a[r]}_lendBinding(e){let t=this._bindings,i=e._cacheIndex,r=this._nActiveBindings++,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n}_takeBackBinding(e){let t=this._bindings,i=e._cacheIndex,r=--this._nActiveBindings,n=t[r];e._cacheIndex=r,t[r]=e,n._cacheIndex=i,t[i]=n}_lendControlInterpolant(){let e=this._controlInterpolants,t=this._nActiveControlInterpolants++,i=e[t];return void 0===i&&((i=new u0(new Float32Array(2),new Float32Array(2),1,dm)).__cacheIndex=t,e[t]=i),i}_takeBackControlInterpolant(e){let t=this._controlInterpolants,i=e.__cacheIndex,r=--this._nActiveControlInterpolants,n=t[r];e.__cacheIndex=r,t[r]=e,n.__cacheIndex=i,t[i]=n}clipAction(e,t,i){let r=t||this._root,n=r.uuid,a="string"==typeof e?ce.findByName(r,e):e,s=null!==a?a.uuid:e,o=this._actionsByClip[s],l=null;if(void 0===i&&(i=null!==a?a.blendMode:tA),void 0!==o){let e=o.actionByRoot[n];if(void 0!==e&&e.blendMode===i)return e;l=o.knownActions[0],null===a&&(a=l._clip)}if(null===a)return null;let u=new dp(this,a,t,i);return this._bindAction(u,l),this._addInactiveAction(u,s,n),u}existingAction(e,t){let i=t||this._root,r=i.uuid,n="string"==typeof e?ce.findByName(i,e):e,a=n?n.uuid:e,s=this._actionsByClip[a];return void 0!==s&&s.actionByRoot[r]||null}stopAllAction(){let e=this._actions,t=this._nActiveActions;for(let i=t-1;i>=0;--i)e[i].stop();return this}update(e){e*=this.timeScale;let t=this._actions,i=this._nActiveActions,r=this.time+=e,n=Math.sign(e),a=this._accuIndex^=1;for(let s=0;s!==i;++s){let i=t[s];i._update(r,e,n,a)}let s=this._bindings,o=this._nActiveBindings;for(let e=0;e!==o;++e)s[e].apply(a);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let t=this._actions,i=e.uuid,r=this._actionsByClip,n=r[i];if(void 0!==n){let e=n.knownActions;for(let i=0,r=e.length;i!==r;++i){let r=e[i];this._deactivateAction(r);let n=r._cacheIndex,a=t[t.length-1];r._cacheIndex=null,r._byClipCacheIndex=null,a._cacheIndex=n,t[n]=a,t.pop(),this._removeInactiveBindingsForAction(r)}delete r[i]}}uncacheRoot(e){let t=e.uuid,i=this._actionsByClip;for(let e in i){let r=i[e].actionByRoot,n=r[t];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}let r=this._bindingsByRootAndName[t];if(void 0!==r)for(let e in r){let t=r[e];t.restoreOriginalState(),this._removeInactiveBinding(t)}}uncacheAction(e,t){let i=this.existingAction(e,t);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class dv{constructor(e){this.value=e}clone(){return new dv(void 0===this.value.clone?this.value:this.value.clone())}}let dy=0;class db extends iy{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:dy++}),this.name="",this.usage=ii,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){let t=this.uniforms.indexOf(e);return -1!==t&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){return this.dispatchEvent({type:"dispose"}),this}copy(e){this.name=e.name,this.usage=e.usage;let t=e.uniforms;this.uniforms.length=0;for(let e=0,i=t.length;e<i;e++)this.uniforms.push(t[e].clone());return this}clone(){return new this.constructor().copy(this)}}class d_ extends oA{constructor(e,t,i=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){let t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){let t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class dE{constructor(e,t,i,r,n){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=i,this.elementSize=r,this.count=n,this.version=0}set needsUpdate(e){!0===e&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}class dS{constructor(e,t,i=0,r=1/0){this.ray=new rI(e,t),this.near=i,this.far=r,this.camera=null,this.layers=new rj,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)}intersectObject(e,t=!0,i=[]){return dT(e,this,i,t),i.sort(dx),i}intersectObjects(e,t=!0,i=[]){for(let r=0,n=e.length;r<n;r++)dT(e[r],this,i,t);return i.sort(dx),i}}function dx(e,t){return e.distance-t.distance}function dT(e,t,i,r){if(e.layers.test(t.layers)&&e.raycast(t,i),!0===r){let r=e.children;for(let e=0,n=r.length;e<n;e++)dT(r[e],t,i,!0)}}class dw{constructor(e=1,t=0,i=0){return this.radius=e,this.phi=t,this.theta=i,this}set(e,t,i){return this.radius=e,this.phi=t,this.theta=i,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+t*t+i*i),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,i),this.phi=Math.acos(iT(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class dA{constructor(e=1,t=0,i=0){return this.radius=e,this.theta=t,this.y=i,this}set(e,t,i){return this.radius=e,this.theta=t,this.y=i,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,i){return this.radius=Math.sqrt(e*e+i*i),this.theta=Math.atan2(e,i),this.y=t,this}clone(){return new this.constructor().copy(this)}}let dM=new iD;class dR{constructor(e=new iD(Infinity,Infinity),t=new iD(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){let i=dM.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(i),this.max.copy(e).add(i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=Infinity,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return!(e.x<this.min.x)&&!(e.x>this.max.x)&&!(e.y<this.min.y)&&!(e.y>this.max.y)}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return!(e.max.x<this.min.x)&&!(e.min.x>this.max.x)&&!(e.max.y<this.min.y)&&!(e.min.y>this.max.y)}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,dM).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}let dC=new rt,dI=new rt;class dL{constructor(e=new rt,t=new rt){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){dC.subVectors(e,this.start),dI.subVectors(this.end,this.start);let i=dI.dot(dI),r=dI.dot(dC),n=r/i;return t&&(n=iT(n,0,1)),n}closestPointToPoint(e,t,i){let r=this.closestPointToPointParameter(e,t);return this.delta(i).multiplyScalar(r).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}let dk=new rt;class dD extends r2{constructor(e,t){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";let i=new nF,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let e=0,t=1;e<32;e++,t++){let i=e/32*Math.PI*2,n=t/32*Math.PI*2;r.push(Math.cos(i),Math.sin(i),1,Math.cos(n),Math.sin(n),1)}i.setAttribute("position",new nC(r,3));let n=new lo({fog:!1,toneMapped:!1});this.cone=new lg(i,n),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1);let e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),dk.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(dk),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}let dP=new rt,dO=new rL,dN=new rL;class dU extends lg{constructor(e){let t=function e(t){let i=[];!0===t.isBone&&i.push(t);for(let r=0;r<t.children.length;r++)i.push.apply(i,e(t.children[r]));return i}(e),i=new nF,r=[],n=[],a=new nd(0,0,1),s=new nd(0,1,0);for(let e=0;e<t.length;e++){let i=t[e];i.parent&&i.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),n.push(a.r,a.g,a.b),n.push(s.r,s.g,s.b))}i.setAttribute("position",new nC(r,3)),i.setAttribute("color",new nC(n,3));let o=new lo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,o),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(e){let t=this.bones,i=this.geometry,r=i.getAttribute("position");dN.copy(this.root.matrixWorld).invert();for(let e=0,i=0;e<t.length;e++){let n=t[e];n.parent&&n.parent.isBone&&(dO.multiplyMatrices(dN,n.matrixWorld),dP.setFromMatrixPosition(dO),r.setXYZ(i,dP.x,dP.y,dP.z),dO.multiplyMatrices(dN,n.parent.matrixWorld),dP.setFromMatrixPosition(dO),r.setXYZ(i+1,dP.x,dP.y,dP.z),i+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose()}}class dF extends n2{constructor(e,t,i){let r=new uM(t,4,2),n=new nf({wireframe:!0,fog:!1,toneMapped:!1});super(r,n),this.light=e,this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}let dB=new rt,dV=new nd,dz=new nd;class dj extends r2{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="HemisphereLightHelper";let r=new uT(t);r.rotateY(.5*Math.PI),this.material=new nf({wireframe:!0,fog:!1,toneMapped:!1}),void 0===this.color&&(this.material.vertexColors=!0);let n=r.getAttribute("position"),a=new Float32Array(3*n.count);r.setAttribute("color",new n_(a,3)),this.add(new n2(r,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){let e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{let t=e.geometry.getAttribute("color");dV.copy(this.light.color),dz.copy(this.light.groundColor);for(let e=0,i=t.count;e<i;e++){let r=e<i/2?dV:dz;t.setXYZ(e,r.r,r.g,r.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(dB.setFromMatrixPosition(this.light.matrixWorld).negate())}}class dH extends lg{constructor(e=10,t=10,i=4473924,r=8947848){i=new nd(i),r=new nd(r);let n=t/2,a=e/t,s=e/2,o=[],l=[];for(let e=0,u=0,c=-s;e<=t;e++,c+=a){o.push(-s,0,c,s,0,c),o.push(c,0,-s,c,0,s);let t=e===n?i:r;t.toArray(l,u),u+=3,t.toArray(l,u),u+=3,t.toArray(l,u),u+=3,t.toArray(l,u),u+=3}let u=new nF;u.setAttribute("position",new nC(o,3)),u.setAttribute("color",new nC(l,3));let c=new lo({vertexColors:!0,toneMapped:!1});super(u,c),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class dG extends lg{constructor(e=10,t=16,i=8,r=64,n=4473924,a=8947848){n=new nd(n),a=new nd(a);let s=[],o=[];if(t>1)for(let i=0;i<t;i++){let r=i/t*(2*Math.PI),l=Math.sin(r)*e,u=Math.cos(r)*e;s.push(0,0,0),s.push(l,0,u);let c=1&i?n:a;o.push(c.r,c.g,c.b),o.push(c.r,c.g,c.b)}for(let t=0;t<i;t++){let l=1&t?n:a,u=e-e/i*t;for(let e=0;e<r;e++){let t=e/r*(2*Math.PI),i=Math.sin(t)*u,n=Math.cos(t)*u;s.push(i,0,n),o.push(l.r,l.g,l.b),i=Math.sin(t=(e+1)/r*(2*Math.PI))*u,n=Math.cos(t)*u,s.push(i,0,n),o.push(l.r,l.g,l.b)}}let l=new nF;l.setAttribute("position",new nC(s,3)),l.setAttribute("color",new nC(o,3));let u=new lo({vertexColors:!0,toneMapped:!1});super(l,u),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}let dW=new rt,d$=new rt,dq=new rt;class dY extends r2{constructor(e,t,i){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,this.type="DirectionalLightHelper",void 0===t&&(t=1);let r=new nF;r.setAttribute("position",new nC([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));let n=new lo({fog:!1,toneMapped:!1});this.lightPlane=new lf(r,n),this.add(this.lightPlane),(r=new nF).setAttribute("position",new nC([0,0,0,0,0,1],3)),this.targetLine=new lf(r,n),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),dW.setFromMatrixPosition(this.light.matrixWorld),d$.setFromMatrixPosition(this.light.target.matrixWorld),dq.subVectors(d$,dW),this.lightPlane.lookAt(d$),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(d$),this.targetLine.scale.z=dq.length()}}let dK=new rt,dX=new ae;class dZ extends lg{constructor(e){let t=new nF,i=new lo({color:16777215,vertexColors:!0,toneMapped:!1}),r=[],n=[],a={};function s(e,t){o(e),o(t)}function o(e){r.push(0,0,0),n.push(0,0,0),void 0===a[e]&&(a[e]=[]),a[e].push(r.length/3-1)}s("n1","n2"),s("n2","n4"),s("n4","n3"),s("n3","n1"),s("f1","f2"),s("f2","f4"),s("f4","f3"),s("f3","f1"),s("n1","f1"),s("n2","f2"),s("n3","f3"),s("n4","f4"),s("p","n1"),s("p","n2"),s("p","n3"),s("p","n4"),s("u1","u2"),s("u2","u3"),s("u3","u1"),s("c","t"),s("p","c"),s("cn1","cn2"),s("cn3","cn4"),s("cf1","cf2"),s("cf3","cf4"),t.setAttribute("position",new nC(r,3)),t.setAttribute("color",new nC(n,3)),super(t,i),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();let l=new nd(16755200),u=new nd(16711680),c=new nd(43775),d=new nd(16777215),h=new nd(3355443);this.setColors(l,u,c,d,h)}setColors(e,t,i,r,n){let a=this.geometry,s=a.getAttribute("color");s.setXYZ(0,e.r,e.g,e.b),s.setXYZ(1,e.r,e.g,e.b),s.setXYZ(2,e.r,e.g,e.b),s.setXYZ(3,e.r,e.g,e.b),s.setXYZ(4,e.r,e.g,e.b),s.setXYZ(5,e.r,e.g,e.b),s.setXYZ(6,e.r,e.g,e.b),s.setXYZ(7,e.r,e.g,e.b),s.setXYZ(8,e.r,e.g,e.b),s.setXYZ(9,e.r,e.g,e.b),s.setXYZ(10,e.r,e.g,e.b),s.setXYZ(11,e.r,e.g,e.b),s.setXYZ(12,e.r,e.g,e.b),s.setXYZ(13,e.r,e.g,e.b),s.setXYZ(14,e.r,e.g,e.b),s.setXYZ(15,e.r,e.g,e.b),s.setXYZ(16,e.r,e.g,e.b),s.setXYZ(17,e.r,e.g,e.b),s.setXYZ(18,e.r,e.g,e.b),s.setXYZ(19,e.r,e.g,e.b),s.setXYZ(20,e.r,e.g,e.b),s.setXYZ(21,e.r,e.g,e.b),s.setXYZ(22,e.r,e.g,e.b),s.setXYZ(23,e.r,e.g,e.b),s.setXYZ(24,t.r,t.g,t.b),s.setXYZ(25,t.r,t.g,t.b),s.setXYZ(26,t.r,t.g,t.b),s.setXYZ(27,t.r,t.g,t.b),s.setXYZ(28,t.r,t.g,t.b),s.setXYZ(29,t.r,t.g,t.b),s.setXYZ(30,t.r,t.g,t.b),s.setXYZ(31,t.r,t.g,t.b),s.setXYZ(32,i.r,i.g,i.b),s.setXYZ(33,i.r,i.g,i.b),s.setXYZ(34,i.r,i.g,i.b),s.setXYZ(35,i.r,i.g,i.b),s.setXYZ(36,i.r,i.g,i.b),s.setXYZ(37,i.r,i.g,i.b),s.setXYZ(38,r.r,r.g,r.b),s.setXYZ(39,r.r,r.g,r.b),s.setXYZ(40,n.r,n.g,n.b),s.setXYZ(41,n.r,n.g,n.b),s.setXYZ(42,n.r,n.g,n.b),s.setXYZ(43,n.r,n.g,n.b),s.setXYZ(44,n.r,n.g,n.b),s.setXYZ(45,n.r,n.g,n.b),s.setXYZ(46,n.r,n.g,n.b),s.setXYZ(47,n.r,n.g,n.b),s.setXYZ(48,n.r,n.g,n.b),s.setXYZ(49,n.r,n.g,n.b),s.needsUpdate=!0}update(){let e=this.geometry,t=this.pointMap;dX.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),dJ("c",t,e,dX,0,0,-1),dJ("t",t,e,dX,0,0,1),dJ("n1",t,e,dX,-1,-1,-1),dJ("n2",t,e,dX,1,-1,-1),dJ("n3",t,e,dX,-1,1,-1),dJ("n4",t,e,dX,1,1,-1),dJ("f1",t,e,dX,-1,-1,1),dJ("f2",t,e,dX,1,-1,1),dJ("f3",t,e,dX,-1,1,1),dJ("f4",t,e,dX,1,1,1),dJ("u1",t,e,dX,.7,1.1,-1),dJ("u2",t,e,dX,-.7,1.1,-1),dJ("u3",t,e,dX,0,2,-1),dJ("cf1",t,e,dX,-1,0,1),dJ("cf2",t,e,dX,1,0,1),dJ("cf3",t,e,dX,0,-1,1),dJ("cf4",t,e,dX,0,1,1),dJ("cn1",t,e,dX,-1,0,-1),dJ("cn2",t,e,dX,1,0,-1),dJ("cn3",t,e,dX,0,-1,-1),dJ("cn4",t,e,dX,0,1,-1),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function dJ(e,t,i,r,n,a,s){dK.set(n,a,s).unproject(r);let o=t[e];if(void 0!==o){let e=i.getAttribute("position");for(let t=0,i=o.length;t<i;t++)e.setXYZ(o[t],dK.x,dK.y,dK.z)}}let dQ=new rn;class d0 extends lg{constructor(e,t=16776960){let i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),n=new nF;n.setIndex(new n_(i,1)),n.setAttribute("position",new n_(r,3)),super(n,new lo({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&dQ.setFromObject(this.object),dQ.isEmpty())return;let t=dQ.min,i=dQ.max,r=this.geometry.attributes.position,n=r.array;n[0]=i.x,n[1]=i.y,n[2]=i.z,n[3]=t.x,n[4]=i.y,n[5]=i.z,n[6]=t.x,n[7]=t.y,n[8]=i.z,n[9]=i.x,n[10]=t.y,n[11]=i.z,n[12]=i.x,n[13]=i.y,n[14]=t.z,n[15]=t.x,n[16]=i.y,n[17]=t.z,n[18]=t.x,n[19]=t.y,n[20]=t.z,n[21]=i.x,n[22]=t.y,n[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class d1 extends lg{constructor(e,t=16776960){let i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new nF;r.setIndex(new n_(i,1)),r.setAttribute("position",new nC([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),super(r,new lo({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){let t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class d2 extends lf{constructor(e,t=1,i=16776960){let r=new nF;r.setAttribute("position",new nC([1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],3)),r.computeBoundingSphere(),super(r,new lo({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;let n=new nF;n.setAttribute("position",new nC([1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],3)),n.computeBoundingSphere(),this.add(new n2(n,new nf({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}let d3=new rt;class d5 extends r2{constructor(e=new rt(0,0,1),t=new rt(0,0,0),i=1,r=16776960,n=.2*i,a=.2*n){super(),this.type="ArrowHelper",void 0===s&&((s=new nF).setAttribute("position",new nC([0,0,0,0,1,0],3)),(o=new l2(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(t),this.line=new lf(s,new lo({color:r,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new n2(o,new nf({color:r,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(i,n,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{d3.set(e.z,0,-e.x).normalize();let t=Math.acos(e.y);this.quaternion.setFromAxisAngle(d3,t)}}setLength(e,t=.2*e,i=.2*t){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(i,t,i),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class d4 extends lg{constructor(e=1){let t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],i=new nF;i.setAttribute("position",new nC(t,3)),i.setAttribute("color",new nC([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));let r=new lo({vertexColors:!0,toneMapped:!1});super(i,r),this.type="AxesHelper"}setColors(e,t,i){let r=new nd,n=this.geometry.attributes.color.array;return r.set(e),r.toArray(n,0),r.toArray(n,3),r.set(t),r.toArray(n,6),r.toArray(n,9),r.set(i),r.toArray(n,12),r.toArray(n,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class d6{constructor(){this.type="ShapePath",this.color=new nd,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new lJ,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,i,r){return this.currentPath.quadraticCurveTo(e,t,i,r),this}bezierCurveTo(e,t,i,r,n,a){return this.currentPath.bezierCurveTo(e,t,i,r,n,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){let t,i,r,n,a;let s=uy.isClockWise,o=this.subPaths;if(0===o.length)return[];let l=[];if(1===o.length)return i=o[0],(r=new ut).curves=i.curves,l.push(r),l;let u=!s(o[0].getPoints());u=e?!u:u;let c=[],d=[],h=[],f=0;d[0]=void 0,h[f]=[];for(let r=0,a=o.length;r<a;r++)t=s(n=(i=o[r]).getPoints()),(t=e?!t:t)?(!u&&d[f]&&f++,d[f]={s:new ut,p:n},d[f].s.curves=i.curves,u&&f++,h[f]=[]):h[f].push({h:i,p:n[0]});if(!d[0])return function(e){let t=[];for(let i=0,r=e.length;i<r;i++){let r=e[i],n=new ut;n.curves=r.curves,t.push(n)}return t}(o);if(d.length>1){let e=!1,t=0;for(let e=0,t=d.length;e<t;e++)c[e]=[];for(let i=0,r=d.length;i<r;i++){let r=h[i];for(let n=0;n<r.length;n++){let a=r[n],s=!0;for(let r=0;r<d.length;r++)(function(e,t){let i=t.length,r=!1;for(let n=i-1,a=0;a<i;n=a++){let i=t[n],s=t[a],o=s.x-i.x,l=s.y-i.y;if(Math.abs(l)>Number.EPSILON){if(l<0&&(i=t[a],o=-o,s=t[n],l=-l),e.y<i.y||e.y>s.y)continue;if(e.y===i.y){if(e.x===i.x)return!0}else{let t=l*(e.x-i.x)-o*(e.y-i.y);if(0===t)return!0;if(t<0)continue;r=!r}}else{if(e.y!==i.y)continue;if(s.x<=e.x&&e.x<=i.x||i.x<=e.x&&e.x<=s.x)return!0}}return r})(a.p,d[r].p)&&(i!==r&&t++,s?(s=!1,c[r].push(a)):e=!0);s&&c[i].push(a)}}t>0&&!1===e&&(h=c)}for(let e=0,t=d.length;e<t;e++){r=d[e].s,l.push(r),a=h[e];for(let e=0,t=a.length;e<t;e++)r.holes.push(a[e].h)}return l}}"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:l}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=l)},99938:function(e,t,i){"use strict";i.d(t,{CR:function(){return u},FC:function(){return f},Jh:function(){return o},KL:function(){return p},XA:function(){return l},ZT:function(){return n},ev:function(){return d},fl:function(){return c},mG:function(){return s},pi:function(){return a},qq:function(){return h}});var r=function(e,t){return(r=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};function n(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Class extends value "+String(t)+" is not a constructor or null");function i(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}var a=function(){return(a=Object.assign||function(e){for(var t,i=1,r=arguments.length;i<r;i++)for(var n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)};function s(e,t,i,r){return new(i||(i=Promise))(function(n,a){function s(e){try{l(r.next(e))}catch(e){a(e)}}function o(e){try{l(r.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(s,o)}l((r=r.apply(e,t||[])).next())})}function o(e,t){var i,r,n,a,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(o){return function(l){return function(o){if(i)throw TypeError("Generator is already executing.");for(;a&&(a=0,o[0]&&(s=0)),s;)try{if(i=1,r&&(n=2&o[0]?r.return:o[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,o[1])).done)return n;switch(r=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,r=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(n=(n=s.trys).length>0&&n[n.length-1])&&(6===o[0]||2===o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],r=0}finally{i=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}function l(e){var t="function"==typeof Symbol&&Symbol.iterator,i=t&&e[t],r=0;if(i)return i.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function u(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var r,n,a=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=a.next()).done;)s.push(r.value)}catch(e){n={error:e}}finally{try{r&&!r.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}return s}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(u(arguments[t]));return e}function d(e,t,i){if(i||2==arguments.length)for(var r,n=0,a=t.length;n<a;n++)!r&&n in t||(r||(r=Array.prototype.slice.call(t,0,n)),r[n]=t[n]);return e.concat(r||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function f(e,t,i){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var r,n=i.apply(e,t||[]),a=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){n[e]&&(r[e]=function(t){return new Promise(function(i,r){a.push([e,t,i,r])>1||o(e,t)})})}function o(e,t){try{var i;(i=n[e](t)).value instanceof h?Promise.resolve(i.value.v).then(l,u):c(a[0][2],i)}catch(e){c(a[0][3],e)}}function l(e){o("next",e)}function u(e){o("throw",e)}function c(e,t){e(t),a.shift(),a.length&&o(a[0][0],a[0][1])}}function p(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,i=e[Symbol.asyncIterator];return i?i.call(e):(e=l(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(i){t[i]=e[i]&&function(t){return new Promise(function(r,n){!function(e,t,i,r){Promise.resolve(r).then(function(t){e({value:t,done:i})},t)}(r,n,(t=e[i](t)).done,t.value)})}}}"function"==typeof SuppressedError&&SuppressedError}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[9774,179],function(){return t(6079),t(43128)}),_N_E=e.O()}]);